/*! For license information please see main.a7980a40.js.LICENSE.txt */
!function(){var e={7228:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},2858:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3646:function(e,t,n){var r=n(7228);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},1506:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},8926:function(e){function t(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(r,i)}e.exports=function(e){return function(){var n=this,r=arguments;return new Promise((function(i,a){var o=e.apply(n,r);function s(e){t(o,i,a,s,u,"next",e)}function u(e){t(o,i,a,s,u,"throw",e)}s(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},4575:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},3913:function(e){function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},3269:function(e,t,n){var r=n(379);e.exports=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}},e.exports.__esModule=!0,e.exports.default=e.exports},9842:function(e,t,n){var r=n(9754),i=n(7067),a=n(8585);e.exports=function(e){var t=i();return function(){var n,i=r(e);if(t){var o=r(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return a(this,n)}},e.exports.__esModule=!0,e.exports.default=e.exports},6525:function(e,t,n){var r=n(8331);function i(){return"undefined"!==typeof Reflect&&Reflect.get?(e.exports=i=Reflect.get,e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,n){var i=r(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(this,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},9754:function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},2205:function(e,t,n){var r=n(9489);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},7067:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},6860:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},3884:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}},e.exports.__esModule=!0,e.exports.default=e.exports},521:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},8206:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},8585:function(e,t,n){var r=n(8).default,i=n(1506);e.exports=function(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},9489:function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3038:function(e,t,n){var r=n(2858),i=n(3884),a=n(379),o=n(521);e.exports=function(e,t){return r(e)||i(e,t)||a(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},8331:function(e,t,n){var r=n(9754);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},319:function(e,t,n){var r=n(3646),i=n(6860),a=n(379),o=n(8206);e.exports=function(e){return r(e)||i(e)||a(e)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},8:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},379:function(e,t,n){var r=n(7228);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},7757:function(e,t,n){e.exports=n(9780)},9465:function(e,t,n){"use strict";n.r(t),n.d(t,{ResizeObserver:function(){return Y},ResizeObserverEntry:function(){return B},ResizeObserverSize:function(){return u}});var r,i=[],a="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(r||(r={}));var o,s=function(e){return Object.freeze(e)},u=function(e,t){this.inlineSize=e,this.blockSize=t,s(this)},l=function(){function e(e,t,n,r){return this.x=e,this.y=t,this.width=n,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,s(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),c=function(e){return e instanceof SVGElement&&"getBBox"in e},g=function(e){if(c(e)){var t=e.getBBox(),n=t.width,r=t.height;return!n&&!r}var i=e,a=i.offsetWidth,o=i.offsetHeight;return!(a||o||e.getClientRects().length)},d=function(e){var t,n;if(e instanceof Element)return!0;var r=null===(n=null===(t=e)||void 0===t?void 0:t.ownerDocument)||void 0===n?void 0:n.defaultView;return!!(r&&e instanceof r.Element)},I="undefined"!==typeof window?window:{},C=new WeakMap,h=/auto|scroll/,f=/^tb|vertical/,p=/msie|trident/i.test(I.navigator&&I.navigator.userAgent),A=function(e){return parseFloat(e||"0")},m=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=!1),new u((n?t:e)||0,(n?e:t)||0)},v=s({devicePixelContentBoxSize:m(),borderBoxSize:m(),contentBoxSize:m(),contentRect:new l(0,0,0,0)}),b=function(e,t){if(void 0===t&&(t=!1),C.has(e)&&!t)return C.get(e);if(g(e))return C.set(e,v),v;var n=getComputedStyle(e),r=c(e)&&e.ownerSVGElement&&e.getBBox(),i=!p&&"border-box"===n.boxSizing,a=f.test(n.writingMode||""),o=!r&&h.test(n.overflowY||""),u=!r&&h.test(n.overflowX||""),d=r?0:A(n.paddingTop),I=r?0:A(n.paddingRight),b=r?0:A(n.paddingBottom),y=r?0:A(n.paddingLeft),B=r?0:A(n.borderTopWidth),G=r?0:A(n.borderRightWidth),Z=r?0:A(n.borderBottomWidth),w=y+I,_=d+b,x=(r?0:A(n.borderLeftWidth))+G,S=B+Z,R=u?e.offsetHeight-S-e.clientHeight:0,M=o?e.offsetWidth-x-e.clientWidth:0,W=i?w+x:0,k=i?_+S:0,V=r?r.width:A(n.width)-W-M,F=r?r.height:A(n.height)-k-R,E=V+w+M+x,X=F+_+R+S,H=s({devicePixelContentBoxSize:m(Math.round(V*devicePixelRatio),Math.round(F*devicePixelRatio),a),borderBoxSize:m(E,X,a),contentBoxSize:m(V,F,a),contentRect:new l(y,d,V,F)});return C.set(e,H),H},y=function(e,t,n){var i=b(e,n),a=i.borderBoxSize,o=i.contentBoxSize,s=i.devicePixelContentBoxSize;switch(t){case r.DEVICE_PIXEL_CONTENT_BOX:return s;case r.BORDER_BOX:return a;default:return o}},B=function(e){var t=b(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=s([t.borderBoxSize]),this.contentBoxSize=s([t.contentBoxSize]),this.devicePixelContentBoxSize=s([t.devicePixelContentBoxSize])},G=function(e){if(g(e))return 1/0;for(var t=0,n=e.parentNode;n;)t+=1,n=n.parentNode;return t},Z=function(){var e=1/0,t=[];i.forEach((function(n){if(0!==n.activeTargets.length){var r=[];n.activeTargets.forEach((function(t){var n=new B(t.target),i=G(t.target);r.push(n),t.lastReportedSize=y(t.target,t.observedBox),i<e&&(e=i)})),t.push((function(){n.callback.call(n.observer,r,n.observer)})),n.activeTargets.splice(0,n.activeTargets.length)}}));for(var n=0,r=t;n<r.length;n++){(0,r[n])()}return e},w=function(e){i.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(n){n.isActive()&&(G(n.target)>e?t.activeTargets.push(n):t.skippedTargets.push(n))}))}))},_=function(){var e=0;for(w(e);i.some((function(e){return e.activeTargets.length>0}));)e=Z(),w(e);return i.some((function(e){return e.skippedTargets.length>0}))&&function(){var e;"function"===typeof ErrorEvent?e=new ErrorEvent("error",{message:a}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=a),window.dispatchEvent(e)}(),e>0},x=[],S=function(e){if(!o){var t=0,n=document.createTextNode("");new MutationObserver((function(){return x.splice(0).forEach((function(e){return e()}))})).observe(n,{characterData:!0}),o=function(){n.textContent=""+(t?t--:t++)}}x.push(e),o()},R=0,M={attributes:!0,characterData:!0,childList:!0,subtree:!0},W=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],k=function(e){return void 0===e&&(e=0),Date.now()+e},V=!1,F=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t=this;if(void 0===e&&(e=250),!V){V=!0;var n,r=k(e);n=function(){var n=!1;try{n=_()}finally{if(V=!1,e=r-k(),!R)return;n?t.run(1e3):e>0?t.run(e):t.start()}},S((function(){requestAnimationFrame(n)}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,M)};document.body?t():I.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),W.forEach((function(t){return I.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),W.forEach((function(t){return I.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}()),E=function(e){!R&&e>0&&F.start(),!(R+=e)&&F.stop()},X=function(){function e(e,t){this.target=e,this.observedBox=t||r.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=y(this.target,this.observedBox,!0);return e=this.target,c(e)||function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)||"inline"!==getComputedStyle(e).display||(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),H=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},L=new WeakMap,z=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n].target===t)return n;return-1},N=function(){function e(){}return e.connect=function(e,t){var n=new H(e,t);L.set(e,n)},e.observe=function(e,t,n){var r=L.get(e),a=0===r.observationTargets.length;z(r.observationTargets,t)<0&&(a&&i.push(r),r.observationTargets.push(new X(t,n&&n.box)),E(1),F.schedule())},e.unobserve=function(e,t){var n=L.get(e),r=z(n.observationTargets,t),a=1===n.observationTargets.length;r>=0&&(a&&i.splice(i.indexOf(n),1),n.observationTargets.splice(r,1),E(-1))},e.disconnect=function(e){var t=this,n=L.get(e);n.observationTargets.slice().forEach((function(n){return t.unobserve(e,n.target)})),n.activeTargets.splice(0,n.activeTargets.length)},e}(),Y=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!==typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");N.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!d(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");N.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!d(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");N.unobserve(this,e)},e.prototype.disconnect=function(){N.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}()},1292:function(e,t,n){"use strict";n.r(t),n.d(t,{AdaptiveDpr:function(){return lh},AdaptiveEvents:function(){return ch},ArcballControls:function(){return rs},Backdrop:function(){return zI},BakeShadows:function(){return rh},Billboard:function(){return Ki},Bounds:function(){return yI},Box:function(){return Od},CameraShake:function(){return ZI},Center:function(){return mI},Circle:function(){return Jd},Cloud:function(){return rC},Cone:function(){return Qd},ContactShadows:function(){return VI},CubeCamera:function(){return Ro},CubicBezierLine:function(){return ra},CurveModifier:function(){return Rd},CycleRaycast:function(){return u},Cylinder:function(){return jd},DepthBuffer:function(){return cc},Detailed:function(){return th},DeviceOrientationControls:function(){return ko},Dodecahedron:function(){return uI},Effects:function(){return fo},Environment:function(){return RI},Extrude:function(){return lI},FirstPersonControls:function(){return ms},Float:function(){return _I},FlyControls:function(){return Xo},GizmoHelper:function(){return Rs},GizmoViewcube:function(){return Ks},GizmoViewport:function(){return Js},GradientTexture:function(){return Ao},Html:function(){return i.V},Icosahedron:function(){return oI},Image:function(){return Go},Instance:function(){return KC},Instances:function(){return DC},IsObject:function(){return vo},Lathe:function(){return cI},Line:function(){return qi},Loader:function(){return p},MapControls:function(){return Yo},Merged:function(){return PC},MeshDistortMaterial:function(){return kd},MeshReflectorMaterial:function(){return Nd},MeshWobbleMaterial:function(){return Ed},Octahedron:function(){return sI},OrbitControls:function(){return Ko},OrthographicCamera:function(){return wo},Parametric:function(){return gI},PerspectiveCamera:function(){return xo},Plane:function(){return $d},Point:function(){return GC},PointMaterial:function(){return Td},PointMaterialImpl:function(){return Yd},PointerLockControls:function(){return ps},Points:function(){return wC},PointsBuffer:function(){return ZC},Polyhedron:function(){return aI},PositionalAudio:function(){return aa},Preload:function(){return nh},PresentationControls:function(){return Yi},QuadraticBezierLine:function(){return ta},Reflector:function(){return KI},Ring:function(){return iI},RoundedBox:function(){return CI},ScreenQuad:function(){return pI},Scroll:function(){return R},ScrollControls:function(){return _},Segment:function(){return $C},Segments:function(){return jC},Shadow:function(){return YI},Sky:function(){return qI},Sphere:function(){return qd},SpotLight:function(){return OI},Stage:function(){return XI},Stars:function(){return tC},Stats:function(){return sc},Tetrahedron:function(){return rI},Text:function(){return ro},Torus:function(){return tI},TorusKnot:function(){return nI},TrackballControls:function(){return Uo},TransformControls:function(){return Is},Tube:function(){return eI},calcPosFromAngles:function(){return jI},isWebGL2Available:function(){return ho},meshBounds:function(){return uh},shaderMaterial:function(){return mo},softShadows:function(){return Dd},useAnimations:function(){return rd},useAspect:function(){return dc},useBVH:function(){return td},useBounds:function(){return BI},useCamera:function(){return vs},useContextBridge:function(){return nd},useCubeTexture:function(){return Qs},useCursor:function(){return l},useDepthBuffer:function(){return gc},useDetectGPU:function(){return Bc},useEdgeSplit:function(){return Bd},useFBO:function(){return lc},useFBX:function(){return Qu},useGLTF:function(){return rc},useGizmoContext:function(){return ys},useHelper:function(){return Gc},useIntersect:function(){return id},useMatcapTexture:function(){return uC},useNormalTexture:function(){return dC},useProgress:function(){return h},useScroll:function(){return w},useSimplification:function(){return md},useTessellation:function(){return bd},useTexture:function(){return bo}});var r={};n.r(r),n.d(r,{computeMorphedAttributes:function(){return dd},estimateBytesUsed:function(){return ld},interleaveAttributes:function(){return ud},mergeBufferAttributes:function(){return sd},mergeBufferGeometries:function(){return od},mergeVertices:function(){return cd},toTrianglesDrawMode:function(){return gd}});var i=n(1539),a=n(3433),o=n(4519),s=n(5112);function u(e){var t=e.onChanged,n=e.portal,r=e.preventDefault,i=void 0===r||r,u=e.scroll,l=void 0===u||u,c=e.keyCode,g=void 0===c?9:c,d=o.useRef(0),I=(0,s.useThree)((function(e){return e.raycaster})),C=(0,s.useThree)((function(e){return e.get})),h=(0,s.useThree)((function(e){return e.gl}));return o.useEffect((function(){var e,r=[],o=void 0,s=I.filter,u=null!==(e=null==n?void 0:n.current)&&void 0!==e?e:h.domElement.parentNode,c=function(){return u&&t&&t(r,Math.round(d.current)%r.length)};I.filter=function(e,t){var n=(0,a.Z)(e);n.length===r.length&&r.every((function(e){return n.map((function(e){return e.object.uuid})).includes(e.object.uuid)}))||(d.current=0,r=n,c()),s&&(n=s(n,t));for(var i=0;i<Math.round(d.current)%n.length;i++){var o=n.shift();n=[].concat((0,a.Z)(n),[o])}return n};var f=function(e){var t,n;d.current=e(d.current),null==(t=C().events.handlers)||t.onPointerCancel(void 0),null==(n=C().events.handlers)||n.onPointerMove(o),c()},p=function(e){(e.keyCode||e.which===g)&&(i&&e.preventDefault(),r.length>1&&f((function(e){return e+1})))},A=function(e){i&&e.preventDefault();var t=0;e||(e=window.event),e.wheelDelta?t=e.wheelDelta/120:e.detail&&(t=-e.detail/3),r.length>1&&f((function(e){return Math.abs(e-t)}))},m=function(e){return o=e};return document.addEventListener("pointermove",m,{passive:!0}),l&&document.addEventListener("wheel",A),void 0!==g&&document.addEventListener("keydown",p),function(){I.filter=s,void 0!==g&&document.removeEventListener("keydown",p),l&&document.removeEventListener("wheel",A),document.removeEventListener("pointermove",m)}}),[h,C,I,i,l,g]),null}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pointer",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto";o.useEffect((function(){if(e)return document.body.style.cursor=t,function(){document.body.style.cursor=n}}),[e])}var c=n(1413),g=n(9439),d=n(4911),I=n(5401),C=0,h=(0,I.Z)((function(e){return d.DefaultLoadingManager.onStart=function(t,n,r){e({active:!0,item:t,loaded:n,total:r,progress:(n-C)/(r-C)*100})},d.DefaultLoadingManager.onLoad=function(){e({active:!1})},d.DefaultLoadingManager.onError=function(t){return e((function(e){return{errors:[].concat((0,a.Z)(e.errors),[t])}}))},d.DefaultLoadingManager.onProgress=function(t,n,r){n===r&&(C=r),e({active:!0,item:t,loaded:n,total:r,progress:(n-C)/(r-C)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}})),f=function(e){return"Loading ".concat(e.toFixed(2),"%")};function p(e){var t=e.containerStyles,n=e.innerStyles,r=e.barStyles,i=e.dataStyles,a=e.dataInterpolation,s=void 0===a?f:a,u=e.initialState,l=void 0===u?function(e){return e}:u,d=h(),I=d.active,C=d.progress,p=o.useRef(0),m=o.useRef(0),v=o.useRef(null),b=o.useState(l(I)),y=(0,g.Z)(b,2),B=y[0],G=y[1];o.useEffect((function(){var e;return I!==B&&(e=setTimeout((function(){return G(I)}),300)),function(){return clearTimeout(e)}}),[B,I]);var Z=o.useCallback((function(){v.current&&(p.current+=(C-p.current)/2,(p.current>.95*C||100===C)&&(p.current=C),v.current.innerText=s(p.current),p.current<C&&(m.current=requestAnimationFrame(Z)))}),[s,C]);return o.useEffect((function(){return Z(),function(){return cancelAnimationFrame(m.current)}}),[Z]),B?o.createElement("div",{style:(0,c.Z)((0,c.Z)({},A.container),{},{opacity:I?1:0},t)},o.createElement("div",null,o.createElement("div",{style:(0,c.Z)((0,c.Z)({},A.inner),n)},o.createElement("div",{style:(0,c.Z)((0,c.Z)({},A.bar),{},{transform:"scaleX(".concat(C/100,")")},r)}),o.createElement("span",{ref:v,style:(0,c.Z)((0,c.Z)({},A.data),i)})))):null}var A={container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#171717",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 300ms ease",zIndex:1e3},inner:{width:100,height:3,background:"#272727",textAlign:"center"},bar:{height:3,width:"100%",background:"white",transition:"transform 200ms",transformOrigin:"left center"},data:{display:"inline-block",position:"relative",fontVariantNumeric:"tabular-nums",marginTop:"0.8em",color:"#f0f0f0",fontSize:"0.6em",fontFamily:'-apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", "Helvetica Neue", Helvetica, Arial, Roboto, Ubuntu, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',whiteSpace:"nowrap"}},m=n(4925),v=n(7462),b=n(4453),y=n(936),B=["children","style"],G=["html"],Z=o.createContext(null);function w(){return o.useContext(Z)}function _(e){var t=e.eps,n=void 0===t?1e-5:t,r=e.enabled,i=void 0===r||r,a=e.infinite,u=e.horizontal,l=e.pages,c=void 0===l?1:l,I=e.distance,C=void 0===I?1:I,h=e.damping,f=void 0===h?4:h,p=e.style,A=void 0===p?{}:p,m=e.children,v=(0,s.useThree)(),b=v.gl,y=v.size,B=v.invalidate,G=v.events,w=v.raycaster,_=o.useState((function(){return document.createElement("div")})),x=(0,g.Z)(_,1)[0],S=o.useState((function(){return document.createElement("div")})),R=(0,g.Z)(S,1)[0],M=o.useState((function(){return document.createElement("div")})),W=(0,g.Z)(M,1)[0],k=b.domElement.parentNode,V=o.useRef(0),F=o.useMemo((function(){var e={el:x,eps:n,fill:R,fixed:W,horizontal:u,damping:f,offset:0,delta:0,scroll:V,pages:c,range:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e-n,i=r+t+2*n;return this.offset<r?0:this.offset>i?1:(this.offset-r)/(i-r)},curve:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.sin(this.range(e,t,n)*Math.PI)},visible:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e-n,i=r+t+2*n;return this.offset>=r&&this.offset<=i}};return e}),[n,f,u,c]);o.useEffect((function(){for(var e in x.style.position="absolute",x.style.width="100%",x.style.height="100%",x.style[u?"overflowX":"overflowY"]="auto",x.style[u?"overflowY":"overflowX"]="hidden",x.style.top="0px",x.style.left="0px",A)x.style[e]=A[e];W.style.position="sticky",W.style.top="0px",W.style.left="0px",W.style.width="100%",W.style.height="100%",W.style.overflow="hidden",x.appendChild(W),R.style.height=u?"100%":"".concat(c*C*100,"%"),R.style.width=u?"".concat(c*C*100,"%"):"100%",R.style.pointerEvents="none",x.appendChild(R),k.appendChild(x),x[u?"scrollLeft":"scrollTop"]=1;var t="boolean"!==typeof G.connected?G.connected:b.domElement;requestAnimationFrame((function(){return null==G.connect?void 0:G.connect(x)}));var n=w.computeOffsets;return w.computeOffsets=function(e){var t=e.clientX,n=e.clientY;return{offsetX:t-k.offsetLeft,offsetY:n-k.offsetTop}},function(){k.removeChild(x),w.computeOffsets=n,null==G.connect||G.connect(t)}}),[c,C,u,x,R,W,k]),o.useEffect((function(){var e=y[u?"width":"height"],t=x[u?"scrollWidth":"scrollHeight"],n=t-e,r=0,o=!0,s=!0,l=function(){if(i&&!s&&(B(),r=x[u?"scrollLeft":"scrollTop"],V.current=r/n,a)){if(!o)if(r>=n){var e=1-F.offset;x[u?"scrollLeft":"scrollTop"]=1,V.current=F.offset=-e,o=!0}else if(r<=0){var l=1+F.offset;x[u?"scrollLeft":"scrollTop"]=t,V.current=F.offset=l,o=!0}o&&setTimeout((function(){return o=!1}),40)}};x.addEventListener("scroll",l,{passive:!0}),requestAnimationFrame((function(){return s=!1}));var c=function(e){return x.scrollLeft+=e.deltaY/2};return u&&x.addEventListener("wheel",c,{passive:!0}),function(){x.removeEventListener("scroll",l),u&&x.removeEventListener("wheel",c)}}),[x,y,a,F,B,u]);var E=0;return(0,s.useFrame)((function(e,t){F.offset=d.MathUtils.damp(E=F.offset,V.current,f,t),F.delta=d.MathUtils.damp(F.delta,Math.abs(E-F.offset),f,t),F.delta>n&&B()})),o.createElement(Z.Provider,{value:F},m)}var x=o.forwardRef((function(e,t){var n=e.children,r=o.useRef(null),i=w(),a=(0,s.useThree)((function(e){return e.viewport})),u=a.width,l=a.height;return(0,s.useFrame)((function(){r.current.position.x=i.horizontal?-u*(i.pages-1)*i.offset:0,r.current.position.y=i.horizontal?0:l*(i.pages-1)*i.offset})),o.createElement("group",{ref:(0,y.default)([t,r])},n)})),S=o.forwardRef((function(e,t){var n=e.children,r=e.style,i=(0,m.Z)(e,B),a=w(),u=o.useRef(null),l=(0,s.useThree)((function(e){return e.size})),g=l.width,d=l.height,I=o.useContext(s.context);return(0,s.useFrame)((function(){a.delta>a.eps&&(u.current.style.transform="translate3d(".concat(a.horizontal?-g*(a.pages-1)*a.offset:0,"px,").concat(a.horizontal?0:d*(a.pages-1)*-a.offset,"px,0)"))})),b.render(o.createElement("div",(0,v.Z)({ref:(0,y.default)([t,u]),style:(0,c.Z)((0,c.Z)({},r),{},{position:"absolute",top:0,left:0,willChange:"transform"})},i),o.createElement(Z.Provider,{value:a},o.createElement(s.context.Provider,{value:I},n))),a.fixed),null})),R=o.forwardRef((function(e,t){var n=e.html,r=(0,m.Z)(e,G),i=n?S:x;return o.createElement(i,(0,v.Z)({ref:t},r))})),M=n(7326),W=n(1752),k=n(1120),V=n(136),F=n(9388),E=n(9611);var X=n(5647);function H(e){var t="function"===typeof Map?new Map:void 0;return H=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return(0,X.Z)(e,arguments,(0,k.Z)(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),(0,E.Z)(r,e)},H(e)}var L=n(5861),z=n(3144),N=n(5671),Y=n(7762),T=n(7757),K=n.n(T),D=se(),P=function(e){return re(e,D)},U=se();P.write=function(e){return re(e,U)};var O=se();P.onStart=function(e){return re(e,O)};var J=se();P.onFrame=function(e){return re(e,J)};var Q=se();P.onFinish=function(e){return re(e,Q)};var j=[];P.setTimeout=function(e,t){var n=P.now()+t,r={time:n,handler:e,cancel:function e(){var t=j.findIndex((function(t){return t.cancel==e}));~t&&j.splice(t,1),te-=~t?1:0}};return j.splice(q(n),0,r),te+=1,ie(),r};var q=function(e){return~(~j.findIndex((function(t){return t.time>e}))||~j.length)};P.cancel=function(e){O.delete(e),J.delete(e),D.delete(e),U.delete(e),Q.delete(e)},P.sync=function(e){ne=!0,P.batchedUpdates(e),ne=!1},P.throttle=function(e){var t;function n(){try{e.apply(void 0,(0,a.Z)(t))}finally{t=null}}function r(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];t=r,P.onStart(n)}return r.handler=e,r.cancel=function(){O.delete(n),t=null},r};var $="undefined"!=typeof window?window.requestAnimationFrame:function(){};P.use=function(e){return $=e},P.now="undefined"!=typeof performance?function(){return performance.now()}:Date.now,P.batchedUpdates=function(e){return e()},P.catch=console.error,P.frameLoop="always",P.advance=function(){"demand"!==P.frameLoop?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):oe()};var ee=-1,te=0,ne=!1;function re(e,t){ne?(t.delete(e),e(0)):(t.add(e),ie())}function ie(){ee<0&&(ee=0,"demand"!==P.frameLoop&&$(ae))}function ae(){~ee&&($(ae),P.batchedUpdates(oe))}function oe(){var e=ee;ee=P.now();var t=q(ee);t&&(ue(j.splice(0,t),(function(e){return e.handler()})),te-=t),O.flush(),D.flush(e?Math.min(64,ee-e):16.667),J.flush(),U.flush(),Q.flush(),te||(ee=-1)}function se(){var e=new Set,t=e;return{add:function(n){te+=t!=e||e.has(n)?0:1,e.add(n)},delete:function(n){return te-=t==e&&e.has(n)?1:0,e.delete(n)},flush:function(n){t.size&&(e=new Set,te-=t.size,ue(t,(function(t){return t(n)&&e.add(t)})),te+=e.size,t=e)}}}function ue(e,t){e.forEach((function(e){try{t(e)}catch(Ic){P.catch(Ic)}}))}function le(){}var ce={arr:Array.isArray,obj:function(e){return!!e&&"Object"===e.constructor.name},fun:function(e){return"function"===typeof e},str:function(e){return"string"===typeof e},num:function(e){return"number"===typeof e},und:function(e){return void 0===e}};function ge(e,t){if(ce.arr(e)){if(!ce.arr(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return e===t}var de=function(e,t){return e.forEach(t)};function Ie(e,t,n){if(ce.arr(e))for(var r=0;r<e.length;r++)t.call(n,e[r],"".concat(r));else for(var i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i)}var Ce=function(e){return ce.und(e)?[]:ce.arr(e)?e:[e]};function he(e,t){if(e.size){var n=Array.from(e);e.clear(),de(n,t)}}var fe,pe,Ae=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return he(e,(function(e){return e.apply(void 0,n)}))},me=function(){return"undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)},ve=null,be=!1,ye=le,Be=Object.freeze({__proto__:null,get createStringInterpolator(){return fe},get to(){return pe},get colors(){return ve},get skipAnimation(){return be},get willAdvance(){return ye},assign:function(e){e.to&&(pe=e.to),e.now&&(P.now=e.now),void 0!==e.colors&&(ve=e.colors),null!=e.skipAnimation&&(be=e.skipAnimation),e.createStringInterpolator&&(fe=e.createStringInterpolator),e.requestAnimationFrame&&P.use(e.requestAnimationFrame),e.batchedUpdates&&(P.batchedUpdates=e.batchedUpdates),e.willAdvance&&(ye=e.willAdvance),e.frameLoop&&(P.frameLoop=e.frameLoop)}}),Ge=new Set,Ze=[],we=[],_e=0,xe={get idle(){return!Ge.size&&!Ze.length},start:function(e){_e>e.priority?(Ge.add(e),P.onStart(Se)):(Re(e),P(We))},advance:We,sort:function(e){if(_e)P.onFrame((function(){return xe.sort(e)}));else{var t=Ze.indexOf(e);~t&&(Ze.splice(t,1),Me(e))}},clear:function(){Ze=[],Ge.clear()}};function Se(){Ge.forEach(Re),Ge.clear(),P(We)}function Re(e){Ze.includes(e)||Me(e)}function Me(e){Ze.splice(function(e,t){var n=e.findIndex(t);return n<0?e.length:n}(Ze,(function(t){return t.priority>e.priority})),0,e)}function We(e){for(var t=we,n=0;n<Ze.length;n++){var r=Ze[n];_e=r.priority,r.idle||(ye(r),r.advance(e),r.idle||t.push(r))}return _e=0,(we=Ze).length=0,(Ze=t).length>0}var ke="[-+]?\\d*\\.?\\d+",Ve=ke+"%";function Fe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var Ee=new RegExp("rgb"+Fe(ke,ke,ke)),Xe=new RegExp("rgba"+Fe(ke,ke,ke,ke)),He=new RegExp("hsl"+Fe(ke,Ve,Ve)),Le=new RegExp("hsla"+Fe(ke,Ve,Ve,ke)),ze=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Ne=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Ye=/^#([0-9a-fA-F]{6})$/,Te=/^#([0-9a-fA-F]{8})$/;function Ke(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function De(e,t,n){var r=n<.5?n*(1+t):n+t-n*t,i=2*n-r,a=Ke(i,r,e+1/3),o=Ke(i,r,e),s=Ke(i,r,e-1/3);return Math.round(255*a)<<24|Math.round(255*o)<<16|Math.round(255*s)<<8}function Pe(e){var t=parseInt(e,10);return t<0?0:t>255?255:t}function Ue(e){return(parseFloat(e)%360+360)%360/360}function Oe(e){var t=parseFloat(e);return t<0?0:t>1?255:Math.round(255*t)}function Je(e){var t=parseFloat(e);return t<0?0:t>100?1:t/100}function Qe(e){var t=function(e){var t;return"number"===typeof e?e>>>0===e&&e>=0&&e<=4294967295?e:null:(t=Ye.exec(e))?parseInt(t[1]+"ff",16)>>>0:ve&&void 0!==ve[e]?ve[e]:(t=Ee.exec(e))?(Pe(t[1])<<24|Pe(t[2])<<16|Pe(t[3])<<8|255)>>>0:(t=Xe.exec(e))?(Pe(t[1])<<24|Pe(t[2])<<16|Pe(t[3])<<8|Oe(t[4]))>>>0:(t=ze.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0:(t=Te.exec(e))?parseInt(t[1],16)>>>0:(t=Ne.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0:(t=He.exec(e))?(255|De(Ue(t[1]),Je(t[2]),Je(t[3])))>>>0:(t=Le.exec(e))?(De(Ue(t[1]),Je(t[2]),Je(t[3]))|Oe(t[4]))>>>0:null}(e);if(null===t)return e;var n=(16711680&(t=t||0))>>>16,r=(65280&t)>>>8,i=(255&t)/255;return"rgba(".concat((4278190080&t)>>>24,", ").concat(n,", ").concat(r,", ").concat(i,")")}var je=function e(t,n,r){if(ce.fun(t))return t;if(ce.arr(t))return e({range:t,output:n,extrapolate:r});if(ce.str(t.output[0]))return fe(t);var i=t,a=i.output,o=i.range||[0,1],s=i.extrapolateLeft||i.extrapolate||"extend",u=i.extrapolateRight||i.extrapolate||"extend",l=i.easing||function(e){return e};return function(e){var t=function(e,t){for(var n=1;n<t.length-1&&!(t[n]>=e);++n);return n-1}(e,o);return function(e,t,n,r,i,a,o,s,u){var l=u?u(e):e;if(l<t){if("identity"===o)return l;"clamp"===o&&(l=t)}if(l>n){if("identity"===s)return l;"clamp"===s&&(l=n)}if(r===i)return r;if(t===n)return e<=t?r:i;t===-1/0?l=-l:n===1/0?l-=t:l=(l-t)/(n-t);l=a(l),r===-1/0?l=-l:i===1/0?l+=r:l=l*(i-r)+r;return l}(e,o[t],o[t+1],a[t],a[t+1],l,s,u,i.map)}};function qe(){return qe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qe.apply(this,arguments)}var $e=Symbol.for("FluidValue.get"),et=Symbol.for("FluidValue.observers"),tt=function(e){return Boolean(e&&e[$e])},nt=function(e){return e&&e[$e]?e[$e]():e},rt=function(e){return e[et]||null};function it(e,t){var n=e[et];n&&n.forEach((function(e){!function(e,t){e.eventObserved?e.eventObserved(t):e(t)}(e,t)}))}var at=(0,z.Z)((function e(t){if((0,N.Z)(this,e),this[$e]=void 0,this[et]=void 0,!t&&!(t=this.get))throw Error("Unknown getter");ot(this,t)})),ot=function(e,t){return ct(e,$e,t)};function st(e,t){if(e[$e]){var n=e[et];n||ct(e,et,n=new Set),n.has(t)||(n.add(t),e.observerAdded&&e.observerAdded(n.size,t))}return t}function ut(e,t){var n=e[et];if(n&&n.has(t)){var r=n.size-1;r?n.delete(t):e[et]=null,e.observerRemoved&&e.observerRemoved(r,t)}}var lt,ct=function(e,t,n){return Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})},gt=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,dt=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,It=new RegExp("(".concat(gt.source,")(%|[a-z]+)"),"i"),Ct=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,ht=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,ft=function e(t){var n=pt(t),r=(0,g.Z)(n,2),i=r[0],a=r[1];if(!i||me())return t;var o=window.getComputedStyle(document.documentElement).getPropertyValue(i);if(o)return o.trim();if(a&&a.startsWith("--")){var s=window.getComputedStyle(document.documentElement).getPropertyValue(a);return s||t}return a&&ht.test(a)?e(a):a||t},pt=function(e){var t=ht.exec(e);if(!t)return[,];var n=(0,g.Z)(t,3);return[n[1],n[2]]},At=function(e,t,n,r,i){return"rgba(".concat(Math.round(t),", ").concat(Math.round(n),", ").concat(Math.round(r),", ").concat(i,")")},mt=function(e){lt||(lt=ve?new RegExp("(".concat(Object.keys(ve).join("|"),")(?!\\w)"),"g"):/^\b$/);var t=e.output.map((function(e){return nt(e).replace(ht,ft).replace(dt,Qe).replace(lt,Qe)})),n=t.map((function(e){return e.match(gt).map(Number)})),r=n[0].map((function(e,t){return n.map((function(e){if(!(t in e))throw Error('The arity of each "output" value must be equal');return e[t]}))})),i=r.map((function(t){return je(qe({},e,{output:t}))}));return function(e){var n,r=!It.test(t[0])&&(null==(n=t.find((function(e){return It.test(e)})))?void 0:n.replace(gt,"")),a=0;return t[0].replace(gt,(function(){return"".concat(i[a++](e)).concat(r||"")})).replace(Ct,At)}},vt="react-spring: ",bt=function(e){var t=e,n=!1;if("function"!=typeof t)throw new TypeError("".concat(vt,"once requires a function parameter"));return function(){n||(t.apply(void 0,arguments),n=!0)}},yt=bt(console.warn);function Bt(){yt("".concat(vt,'The "interpolate" function is deprecated in v9 (use "to" instead)'))}var Gt=bt(console.warn);function Zt(e){return ce.str(e)&&("#"==e[0]||/\d/.test(e)||!me()&&ht.test(e)||e in(ve||{}))}var wt=function(e){return(0,o.useEffect)(e,_t)},_t=[];function xt(){var e=(0,o.useState)()[1],t=(0,o.useState)(St)[0];return wt(t.unmount),function(){t.current&&e({})}}function St(){var e={current:!0,unmount:function(){return function(){e.current=!1}}};return e}function Rt(e){var t=(0,o.useRef)();return(0,o.useEffect)((function(){t.current=e})),t.current}var Mt="undefined"!==typeof window&&window.document&&window.document.createElement?o.useLayoutEffect:o.useEffect,Wt=Symbol.for("Animated:node"),kt=function(e){return e&&e[Wt]},Vt=function(e,t){return n=e,r=Wt,i=t,Object.defineProperty(n,r,{value:i,writable:!0,configurable:!0});var n,r,i},Ft=function(e){return e&&e[Wt]&&e[Wt].getPayload()},Et=function(){function e(){(0,N.Z)(this,e),this.payload=void 0,Vt(this,this)}return(0,z.Z)(e,[{key:"getPayload",value:function(){return this.payload||[]}}]),e}(),Xt=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e){var r;return(0,N.Z)(this,n),(r=t.call(this)).done=!0,r.elapsedTime=void 0,r.lastPosition=void 0,r.lastVelocity=void 0,r.v0=void 0,r.durationProgress=0,r._value=e,ce.num(r._value)&&(r.lastPosition=r._value),r}return(0,z.Z)(n,[{key:"getPayload",value:function(){return[this]}},{key:"getValue",value:function(){return this._value}},{key:"setValue",value:function(e,t){return ce.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value!==e&&(this._value=e,!0)}},{key:"reset",value:function(){var e=this.done;this.done=!1,ce.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(Et),Ht=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e){var r;return(0,N.Z)(this,n),(r=t.call(this,0))._string=null,r._toString=void 0,r._toString=je({output:[e,e]}),r}return(0,z.Z)(n,[{key:"getValue",value:function(){var e=this._string;return null==e?this._string=this._toString(this._value):e}},{key:"setValue",value:function(e){if(ce.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else{if(!(0,W.Z)((0,k.Z)(n.prototype),"setValue",this).call(this,e))return!1;this._string=null}return!0}},{key:"reset",value:function(e){e&&(this._toString=je({output:[this.getValue(),e]})),this._value=0,(0,W.Z)((0,k.Z)(n.prototype),"reset",this).call(this)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(Xt),Lt={dependencies:null},zt=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e){var r;return(0,N.Z)(this,n),(r=t.call(this)).source=e,r.setValue(e),r}return(0,z.Z)(n,[{key:"getValue",value:function(e){var t={};return Ie(this.source,(function(n,r){var i;(i=n)&&i[Wt]===i?t[r]=n.getValue(e):tt(n)?t[r]=nt(n):e||(t[r]=n)})),t}},{key:"setValue",value:function(e){this.source=e,this.payload=this._makePayload(e)}},{key:"reset",value:function(){this.payload&&de(this.payload,(function(e){return e.reset()}))}},{key:"_makePayload",value:function(e){if(e){var t=new Set;return Ie(e,this._addToPayload,t),Array.from(t)}}},{key:"_addToPayload",value:function(e){var t=this;Lt.dependencies&&tt(e)&&Lt.dependencies.add(e);var n=Ft(e);n&&de(n,(function(e){return t.add(e)}))}}]),n}(Et),Nt=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e){return(0,N.Z)(this,n),t.call(this,e)}return(0,z.Z)(n,[{key:"getValue",value:function(){return this.source.map((function(e){return e.getValue()}))}},{key:"setValue",value:function(e){var t=this.getPayload();return e.length==t.length?t.map((function(t,n){return t.setValue(e[n])})).some(Boolean):((0,W.Z)((0,k.Z)(n.prototype),"setValue",this).call(this,e.map(Yt)),!0)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(zt);function Yt(e){return(Zt(e)?Ht:Xt).create(e)}function Tt(e){var t=kt(e);return t?t.constructor:ce.arr(e)?Nt:Zt(e)?Ht:Xt}function Kt(){return Kt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kt.apply(this,arguments)}var Dt=function(e,t){var n=!ce.fun(e)||e.prototype&&e.prototype.isReactComponent;return(0,o.forwardRef)((function(r,i){var a=(0,o.useRef)(null),s=n&&(0,o.useCallback)((function(e){a.current=function(e,t){e&&(ce.fun(e)?e(t):e.current=t);return t}(i,e)}),[i]),u=function(e,t){var n=new Set;Lt.dependencies=n,e.style&&(e=Kt({},e,{style:t.createAnimatedStyle(e.style)}));return e=new zt(e),Lt.dependencies=null,[e,n]}(r,t),l=(0,g.Z)(u,2),c=l[0],d=l[1],I=xt(),C=function(){var e=a.current;n&&!e||!1===(!!e&&t.applyAnimatedValues(e,c.getValue(!0)))&&I()},h=new Pt(C,d),f=(0,o.useRef)();Mt((function(){var e=f.current;f.current=h,de(d,(function(e){return st(e,h)})),e&&(de(e.deps,(function(t){return ut(t,e)})),P.cancel(e.update))})),(0,o.useEffect)(C,[]),wt((function(){return function(){var e=f.current;de(e.deps,(function(t){return ut(t,e)}))}}));var p=t.getComponentProps(c.getValue());return o.createElement(e,Kt({},p,{ref:s}))}))},Pt=function(){function e(t,n){(0,N.Z)(this,e),this.update=t,this.deps=n}return(0,z.Z)(e,[{key:"eventObserved",value:function(e){"change"==e.type&&P.write(this.update)}}]),e}();var Ut=Symbol.for("AnimatedComponent"),Ot=function(e){return ce.str(e)?e:e&&ce.str(e.displayName)?e.displayName:ce.fun(e)&&e.name||null};function Jt(){return Jt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jt.apply(this,arguments)}function Qt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ce.fun(e)?e.apply(void 0,n):e}var jt=function(e,t){return!0===e||!!(t&&e&&(ce.fun(e)?e(t):Ce(e).includes(t)))},qt=function(e,t){return ce.obj(e)?t&&e[t]:e},$t=function(e,t){return!0===e.default?e[t]:e.default?e.default[t]:void 0},en=function(e){return e},tn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:en,n=nn;e.default&&!0!==e.default&&(e=e.default,n=Object.keys(e));var r,i={},a=(0,Y.Z)(n);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=t(e[o],o);ce.und(s)||(i[o]=s)}}catch(u){a.e(u)}finally{a.f()}return i},nn=["config","onProps","onStart","onChange","onPause","onResume","onRest"],rn={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function an(e){var t=function(e){var t={},n=0;if(Ie(e,(function(e,r){rn[r]||(t[r]=e,n++)})),n)return t}(e);if(t){var n={to:t};return Ie(e,(function(e,r){return r in t||(n[r]=e)})),n}return Jt({},e)}function on(e){return e=nt(e),ce.arr(e)?e.map(on):Zt(e)?Be.createStringInterpolator({range:[0,1],output:[e,e]})(1):e}function sn(e){for(var t in e)return!0;return!1}function un(e){return ce.fun(e)||ce.arr(e)&&ce.obj(e[0])}function ln(e,t){var n;null==(n=e.ref)||n.delete(e),null==t||t.delete(e)}function cn(e,t){var n;t&&e.ref!==t&&(null==(n=e.ref)||n.delete(e),t.add(e),e.ref=t)}var gn=1.70158,dn=1.525*gn,In=gn+1,Cn=2*Math.PI/3,hn=2*Math.PI/4.5,fn=function(e){var t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},pn={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return 1-(1-e)*(1-e)},easeInOutQuad:function(e){return e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1-Math.pow(1-e,3)},easeInOutCubic:function(e){return e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1-Math.pow(1-e,4)},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-Math.pow(-2*e+2,4)/2},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1-Math.pow(1-e,5)},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2},easeInSine:function(e){return 1-Math.cos(e*Math.PI/2)},easeOutSine:function(e){return Math.sin(e*Math.PI/2)},easeInOutSine:function(e){return-(Math.cos(Math.PI*e)-1)/2},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*e-10)},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2},easeInCirc:function(e){return 1-Math.sqrt(1-Math.pow(e,2))},easeOutCirc:function(e){return Math.sqrt(1-Math.pow(e-1,2))},easeInOutCirc:function(e){return e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2},easeInBack:function(e){return In*e*e*e-gn*e*e},easeOutBack:function(e){return 1+In*Math.pow(e-1,3)+gn*Math.pow(e-1,2)},easeInOutBack:function(e){return e<.5?Math.pow(2*e,2)*(7.189819*e-dn)/2:(Math.pow(2*e-2,2)*((dn+1)*(2*e-2)+dn)+2)/2},easeInElastic:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*e-10)*Math.sin((10*e-10.75)*Cn)},easeOutElastic:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*Cn)+1},easeInOutElastic:function(e){return 0===e?0:1===e?1:e<.5?-Math.pow(2,20*e-10)*Math.sin((20*e-11.125)*hn)/2:Math.pow(2,-20*e+10)*Math.sin((20*e-11.125)*hn)/2+1},easeInBounce:function(e){return 1-fn(1-e)},easeOutBounce:fn,easeInOutBounce:function(e){return e<.5?(1-fn(1-2*e))/2:(1+fn(2*e-1))/2}},An=Jt({},{tension:170,friction:26},{mass:1,damping:1,easing:pn.linear,clamp:!1}),mn=(0,z.Z)((function e(){(0,N.Z)(this,e),this.tension=void 0,this.friction=void 0,this.frequency=void 0,this.damping=void 0,this.mass=void 0,this.velocity=0,this.restVelocity=void 0,this.precision=void 0,this.progress=void 0,this.duration=void 0,this.easing=void 0,this.clamp=void 0,this.bounce=void 0,this.decay=void 0,this.round=void 0,Object.assign(this,An)}));function vn(e,t){if(ce.und(t.decay)){var n=!ce.und(t.tension)||!ce.und(t.friction);!n&&ce.und(t.frequency)&&ce.und(t.damping)&&ce.und(t.mass)||(e.duration=void 0,e.decay=void 0),n&&(e.frequency=void 0)}else e.duration=void 0}var bn=[],yn=(0,z.Z)((function e(){(0,N.Z)(this,e),this.changed=!1,this.values=bn,this.toValues=null,this.fromValues=bn,this.to=void 0,this.from=void 0,this.config=new mn,this.immediate=!1}));function Bn(e,t){var n=t.key,r=t.props,i=t.defaultProps,a=t.state,o=t.actions;return new Promise((function(t,s){var u,l,c,g=jt(null!=(u=r.cancel)?u:null==i?void 0:i.cancel,n);if(g)h();else{ce.und(r.pause)||(a.paused=jt(r.pause,n));var d=null==i?void 0:i.pause;!0!==d&&(d=a.paused||jt(d,n)),l=Qt(r.delay||0,n),d?(a.resumeQueue.add(C),o.pause()):(o.resume(),C())}function I(){a.resumeQueue.add(C),a.timeouts.delete(c),c.cancel(),l=c.time-P.now()}function C(){l>0&&!Be.skipAnimation?(a.delayed=!0,c=P.setTimeout(h,l),a.pauseQueue.add(I),a.timeouts.add(c)):h()}function h(){a.delayed&&(a.delayed=!1),a.pauseQueue.delete(I),a.timeouts.delete(c),e<=(a.cancelId||0)&&(g=!0);try{o.start(Jt({},r,{callId:e,cancel:g}),t)}catch(n){s(n)}}}))}var Gn=function(e,t){return 1==t.length?t[0]:t.some((function(e){return e.cancelled}))?_n(e.get()):t.every((function(e){return e.noop}))?Zn(e.get()):wn(e.get(),t.every((function(e){return e.finished})))},Zn=function(e){return{value:e,noop:!0,finished:!0,cancelled:!1}},wn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{value:e,finished:t,cancelled:n}},_n=function(e){return{value:e,cancelled:!0,finished:!1}};function xn(e,t,n,r){var i=t.callId,a=t.parentId,o=t.onRest,s=n.asyncTo,u=n.promise;return a||e!==s||t.reset?n.promise=(0,L.Z)(K().mark((function l(){var c,g,d,I,C,h,f,p;return K().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(n.asyncId=i,n.asyncTo=e,c=tn(t,(function(e,t){return"onRest"===t?void 0:e})),I=new Promise((function(e,t){return g=e,d=t})),C=function(e){var t=i<=(n.cancelId||0)&&_n(r)||i!==n.asyncId&&wn(r,!1);if(t)throw e.result=t,d(e),e},h=function(e,t){var a=new Rn,o=new Mn;return(0,L.Z)(K().mark((function s(){var u,l;return K().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(!Be.skipAnimation){s.next=5;break}throw Sn(n),o.result=wn(r,!1),d(o),o;case 5:return C(a),(u=ce.obj(e)?Jt({},e):Jt({},t,{to:e})).parentId=i,Ie(c,(function(e,t){ce.und(u[t])&&(u[t]=e)})),s.next=11,r.start(u);case 11:if(l=s.sent,C(a),!n.paused){s.next=16;break}return s.next=16,new Promise((function(e){n.resumeQueue.add(e)}));case 16:return s.abrupt("return",l);case 17:case"end":return s.stop()}}),s)})))()},!Be.skipAnimation){l.next=9;break}return Sn(n),l.abrupt("return",wn(r,!1));case 9:return l.prev=9,p=ce.arr(e)?function(){var e=(0,L.Z)(K().mark((function e(t){var n,r,i;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,Y.Z)(t),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,h(i);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})));return function(t){return e.apply(this,arguments)}}()(e):Promise.resolve(e(h,r.stop.bind(r))),l.next=13,Promise.all([p.then(g),I]);case 13:f=wn(r.get(),!0,!1),l.next=27;break;case 16:if(l.prev=16,l.t0=l.catch(9),!(l.t0 instanceof Rn)){l.next=22;break}f=l.t0.result,l.next=27;break;case 22:if(!(l.t0 instanceof Mn)){l.next=26;break}f=l.t0.result,l.next=27;break;case 26:throw l.t0;case 27:return l.prev=27,i==n.asyncId&&(n.asyncId=a,n.asyncTo=a?s:void 0,n.promise=a?u:void 0),l.finish(27);case 30:return ce.fun(o)&&P.batchedUpdates((function(){o(f,r,r.item)})),l.abrupt("return",f);case 32:case"end":return l.stop()}}),l,null,[[9,16,27,30]])})))():u}function Sn(e,t){he(e.timeouts,(function(e){return e.cancel()})),e.pauseQueue.clear(),e.resumeQueue.clear(),e.asyncId=e.asyncTo=e.promise=void 0,t&&(e.cancelId=t)}var Rn=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;return(0,N.Z)(this,n),(e=t.call(this,"An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")).result=void 0,e}return(0,z.Z)(n)}(H(Error)),Mn=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;return(0,N.Z)(this,n),(e=t.call(this,"SkipAnimationSignal")).result=void 0,e}return(0,z.Z)(n)}(H(Error)),Wn=function(e){return e instanceof Vn},kn=1,Vn=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;(0,N.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).id=kn++,e.key=void 0,e._priority=0,e}return(0,z.Z)(n,[{key:"priority",get:function(){return this._priority},set:function(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}},{key:"get",value:function(){var e=kt(this);return e&&e.getValue()}},{key:"to",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Be.to(this,t)}},{key:"interpolate",value:function(){Bt();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Be.to(this,t)}},{key:"toJSON",value:function(){return this.get()}},{key:"observerAdded",value:function(e){1==e&&this._attach()}},{key:"observerRemoved",value:function(e){0==e&&this._detach()}},{key:"_attach",value:function(){}},{key:"_detach",value:function(){}},{key:"_onChange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];it(this,{type:"change",parent:this,value:e,idle:t})}},{key:"_onPriorityChange",value:function(e){this.idle||xe.sort(this),it(this,{type:"priority",parent:this,priority:e})}}]),n}(at),Fn=Symbol.for("SpringPhase"),En=function(e){return(1&e[Fn])>0},Xn=function(e){return(2&e[Fn])>0},Hn=function(e){return(4&e[Fn])>0},Ln=function(e,t){return t?e[Fn]|=3:e[Fn]&=-3},zn=function(e,t){return t?e[Fn]|=4:e[Fn]&=-5},Nn=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r){var i;if((0,N.Z)(this,n),(i=t.call(this)).key=void 0,i.animation=new yn,i.queue=void 0,i.defaultProps={},i._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},i._pendingCalls=new Set,i._lastCallId=0,i._lastToId=0,i._memoizedDuration=0,!ce.und(e)||!ce.und(r)){var a=ce.obj(e)?Jt({},e):Jt({},r,{from:e});ce.und(a.default)&&(a.default=!0),i.start(a)}return i}return(0,z.Z)(n,[{key:"idle",get:function(){return!(Xn(this)||this._state.asyncTo)||Hn(this)}},{key:"goal",get:function(){return nt(this.animation.to)}},{key:"velocity",get:function(){var e=kt(this);return e instanceof Xt?e.lastVelocity||0:e.getPayload().map((function(e){return e.lastVelocity||0}))}},{key:"hasAnimated",get:function(){return En(this)}},{key:"isAnimating",get:function(){return Xn(this)}},{key:"isPaused",get:function(){return Hn(this)}},{key:"isDelayed",get:function(){return this._state.delayed}},{key:"advance",value:function(e){var t=this,n=!0,r=!1,i=this.animation,a=i.config,o=i.toValues,s=Ft(i.to);!s&&tt(i.to)&&(o=Ce(nt(i.to))),i.values.forEach((function(u,l){if(!u.done){var c=u.constructor==Ht?1:s?s[l].lastPosition:o[l],g=i.immediate,d=c;if(!g){if(d=u.lastPosition,a.tension<=0)return void(u.done=!0);var I,C=u.elapsedTime+=e,h=i.fromValues[l],f=null!=u.v0?u.v0:u.v0=ce.arr(a.velocity)?a.velocity[l]:a.velocity;if(ce.und(a.duration))if(a.decay){var p=!0===a.decay?.998:a.decay,A=Math.exp(-(1-p)*C);d=h+f/(1-p)*(1-A),g=Math.abs(u.lastPosition-d)<.1,I=f*A}else{I=null==u.lastVelocity?f:u.lastVelocity;for(var m=a.precision||(h==c?.005:Math.min(1,.001*Math.abs(c-h))),v=a.restVelocity||m/10,b=a.clamp?0:a.bounce,y=!ce.und(b),B=h==c?u.v0>0:h<c,G=Math.ceil(e/1),Z=0;Z<G&&(Math.abs(I)>v||!(g=Math.abs(c-d)<=m));++Z){y&&(d==c||d>c==B)&&(I=-I*b,d=c),d+=1*(I+=1*((1e-6*-a.tension*(d-c)+.001*-a.friction*I)/a.mass))}}else{var w=1;a.duration>0&&(t._memoizedDuration!==a.duration&&(t._memoizedDuration=a.duration,u.durationProgress>0&&(u.elapsedTime=a.duration*u.durationProgress,C=u.elapsedTime+=e)),w=(w=(a.progress||0)+C/t._memoizedDuration)>1?1:w<0?0:w,u.durationProgress=w),I=((d=h+a.easing(w)*(c-h))-u.lastPosition)/e,g=1==w}u.lastVelocity=I,Number.isNaN(d)&&(console.warn("Got NaN while animating:",t),g=!0)}s&&!s[l].done&&(g=!1),g?u.done=!0:n=!1,u.setValue(d,a.round)&&(r=!0)}}));var u=kt(this),l=u.getValue();if(n){var c=nt(i.to);l===c&&!r||a.decay?r&&a.decay&&this._onChange(l):(u.setValue(c),this._onChange(c)),this._stop()}else r&&this._onChange(l)}},{key:"set",value:function(e){var t=this;return P.batchedUpdates((function(){t._stop(),t._focus(e),t._set(e)})),this}},{key:"pause",value:function(){this._update({pause:!0})}},{key:"resume",value:function(){this._update({pause:!1})}},{key:"finish",value:function(){var e=this;if(Xn(this)){var t=this.animation,n=t.to,r=t.config;P.batchedUpdates((function(){e._onStart(),r.decay||e._set(n,!1),e._stop()}))}return this}},{key:"update",value:function(e){return(this.queue||(this.queue=[])).push(e),this}},{key:"start",value:function(e,t){var n,r=this;return ce.und(e)?(n=this.queue||[],this.queue=[]):n=[ce.obj(e)?e:Jt({},t,{to:e})],Promise.all(n.map((function(e){return r._update(e)}))).then((function(e){return Gn(r,e)}))}},{key:"stop",value:function(e){var t=this,n=this.animation.to;return this._focus(this.get()),Sn(this._state,e&&this._lastCallId),P.batchedUpdates((function(){return t._stop(n,e)})),this}},{key:"reset",value:function(){this._update({reset:!0})}},{key:"eventObserved",value:function(e){"change"==e.type?this._start():"priority"==e.type&&(this.priority=e.priority+1)}},{key:"_prepareNode",value:function(e){var t=this.key||"",n=e.to,r=e.from;(null==(n=ce.obj(n)?n[t]:n)||un(n))&&(n=void 0),null==(r=ce.obj(r)?r[t]:r)&&(r=void 0);var i={to:n,from:r};if(!En(this)){if(e.reverse){var a=[r,n];n=a[0],r=a[1]}r=nt(r),ce.und(r)?kt(this)||this._set(n):this._set(r)}return i}},{key:"_update",value:function(e,t){var n=this,r=Jt({},e),i=this.key,a=this.defaultProps;r.default&&Object.assign(a,tn(r,(function(e,t){return/^on/.test(t)?qt(e,i):e}))),On(this,r,"onProps"),Jn(this,"onProps",r,this);var o=this._prepareNode(r);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");var s=this._state;return Bn(++this._lastCallId,{key:i,props:r,defaultProps:a,state:s,actions:{pause:function(){Hn(n)||(zn(n,!0),Ae(s.pauseQueue),Jn(n,"onPause",wn(n,Yn(n,n.animation.to)),n))},resume:function(){Hn(n)&&(zn(n,!1),Xn(n)&&n._resume(),Ae(s.resumeQueue),Jn(n,"onResume",wn(n,Yn(n,n.animation.to)),n))},start:this._merge.bind(this,o)}}).then((function(e){if(r.loop&&e.finished&&(!t||!e.noop)){var i=Tn(r);if(i)return n._update(i,!0)}return e}))}},{key:"_merge",value:function(e,t,n){var r=this;if(t.cancel)return this.stop(!0),n(_n(this));var i=!ce.und(e.to),a=!ce.und(e.from);if(i||a){if(!(t.callId>this._lastToId))return n(_n(this));this._lastToId=t.callId}var o=this.key,s=this.defaultProps,u=this.animation,l=u.to,c=u.from,g=e.to,d=void 0===g?l:g,I=e.from,C=void 0===I?c:I;if(!a||i||t.default&&!ce.und(d)||(d=C),t.reverse){var h=[C,d];d=h[0],C=h[1]}var f=!ge(C,c);f&&(u.from=C),C=nt(C);var p=!ge(d,l);p&&this._focus(d);var A=un(t.to),m=u.config,v=m.decay,b=m.velocity;(i||a)&&(m.velocity=0),t.config&&!A&&function(e,t,n){for(var r in n&&(vn(n=Jt({},n),t),t=Jt({},n,t)),vn(e,t),Object.assign(e,t),An)null==e[r]&&(e[r]=An[r]);var i=e.mass,a=e.frequency,o=e.damping;ce.und(a)||(a<.01&&(a=.01),o<0&&(o=0),e.tension=Math.pow(2*Math.PI/a,2)*i,e.friction=4*Math.PI*o*i/a)}(m,Qt(t.config,o),t.config!==s.config?Qt(s.config,o):void 0);var y=kt(this);if(!y||ce.und(d))return n(wn(this,!0));var B=ce.und(t.reset)?a&&!t.default:!ce.und(C)&&jt(t.reset,o),G=B?C:this.get(),Z=on(d),w=ce.num(Z)||ce.arr(Z)||Zt(Z),_=!A&&(!w||jt(s.immediate||t.immediate,o));if(p){var x=Tt(d);if(x!==y.constructor){if(!_)throw Error("Cannot animate between ".concat(y.constructor.name," and ").concat(x.name,', as the "to" prop suggests'));y=this._set(Z)}}var S=y.constructor,R=tt(d),M=!1;if(!R){var W=B||!En(this)&&f;(p||W)&&(R=!(M=ge(on(G),Z))),(ge(u.immediate,_)||_)&&ge(m.decay,v)&&ge(m.velocity,b)||(R=!0)}if(M&&Xn(this)&&(u.changed&&!B?R=!0:R||this._stop(l)),!A&&((R||tt(l))&&(u.values=y.getPayload(),u.toValues=tt(d)?null:S==Ht?[1]:Ce(Z)),u.immediate!=_&&(u.immediate=_,_||B||this._set(l)),R)){var k=u.onRest;de(Un,(function(e){return On(r,t,e)}));var V=wn(this,Yn(this,l));Ae(this._pendingCalls,V),this._pendingCalls.add(n),u.changed&&P.batchedUpdates((function(){u.changed=!B,null==k||k(V,r),B?Qt(s.onRest,V):null==u.onStart||u.onStart(V,r)}))}B&&this._set(G),A?n(xn(t.to,t,this._state,this)):R?this._start():Xn(this)&&!p?this._pendingCalls.add(n):n(Zn(G))}},{key:"_focus",value:function(e){var t=this.animation;e!==t.to&&(rt(this)&&this._detach(),t.to=e,rt(this)&&this._attach())}},{key:"_attach",value:function(){var e=0,t=this.animation.to;tt(t)&&(st(t,this),Wn(t)&&(e=t.priority+1)),this.priority=e}},{key:"_detach",value:function(){var e=this.animation.to;tt(e)&&ut(e,this)}},{key:"_set",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=nt(e);if(!ce.und(r)){var i=kt(this);if(!i||!ge(r,i.getValue())){var a=Tt(r);i&&i.constructor==a?i.setValue(r):Vt(this,a.create(r)),i&&P.batchedUpdates((function(){t._onChange(r,n)}))}}return kt(this)}},{key:"_onStart",value:function(){var e=this.animation;e.changed||(e.changed=!0,Jn(this,"onStart",wn(this,Yn(this,e.to)),this))}},{key:"_onChange",value:function(e,t){t||(this._onStart(),Qt(this.animation.onChange,e,this)),Qt(this.defaultProps.onChange,e,this),(0,W.Z)((0,k.Z)(n.prototype),"_onChange",this).call(this,e,t)}},{key:"_start",value:function(){var e=this.animation;kt(this).reset(nt(e.to)),e.immediate||(e.fromValues=e.values.map((function(e){return e.lastPosition}))),Xn(this)||(Ln(this,!0),Hn(this)||this._resume())}},{key:"_resume",value:function(){Be.skipAnimation?this.finish():xe.start(this)}},{key:"_stop",value:function(e,t){if(Xn(this)){Ln(this,!1);var n=this.animation;de(n.values,(function(e){e.done=!0})),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),it(this,{type:"idle",parent:this});var r=t?_n(this.get()):wn(this.get(),Yn(this,null!=e?e:n.to));Ae(this._pendingCalls,r),n.changed&&(n.changed=!1,Jn(this,"onRest",r,this))}}}]),n}(Vn);function Yn(e,t){var n=on(t);return ge(on(e.get()),n)}function Tn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.loop,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.to,r=Qt(t);if(r){var i=!0!==r&&an(r),a=(i||e).reverse,o=!i||i.reset;return Kn(Jt({},e,{loop:t,default:!1,pause:void 0,to:!a||un(n)?n:void 0,from:o?e.from:void 0,reset:o},i))}}function Kn(e){var t=e=an(e),n=t.to,r=t.from,i=new Set;return ce.obj(n)&&Pn(n,i),ce.obj(r)&&Pn(r,i),e.keys=i.size?Array.from(i):null,e}function Dn(e){var t=Kn(e);return ce.und(t.default)&&(t.default=tn(t)),t}function Pn(e,t){Ie(e,(function(e,n){return null!=e&&t.add(n)}))}var Un=["onStart","onRest","onChange","onPause","onResume"];function On(e,t,n){e.animation[n]=t[n]!==$t(t,n)?qt(t[n],e.key):void 0}function Jn(e,t){for(var n,r,i,a,o,s,u=arguments.length,l=new Array(u>2?u-2:0),c=2;c<u;c++)l[c-2]=arguments[c];null==(i=(a=e.animation)[t])||(n=i).call.apply(n,[a].concat(l)),null==(o=(s=e.defaultProps)[t])||(r=o).call.apply(r,[s].concat(l))}var Qn=["onStart","onChange","onRest"],jn=1,qn=function(){function e(t,n){(0,N.Z)(this,e),this.id=jn++,this.springs={},this.queue=[],this.ref=void 0,this._flush=void 0,this._initialProps=void 0,this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._item=void 0,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),n&&(this._flush=n),t&&this.start(Jt({default:!0},t))}return(0,z.Z)(e,[{key:"idle",get:function(){return!this._state.asyncTo&&Object.values(this.springs).every((function(e){return e.idle&&!e.isDelayed&&!e.isPaused}))}},{key:"item",get:function(){return this._item},set:function(e){this._item=e}},{key:"get",value:function(){var e={};return this.each((function(t,n){return e[n]=t.get()})),e}},{key:"set",value:function(e){for(var t in e){var n=e[t];ce.und(n)||this.springs[t].set(n)}}},{key:"update",value:function(e){return e&&this.queue.push(Kn(e)),this}},{key:"start",value:function(e){var t=this.queue;return e?t=Ce(e).map(Kn):this.queue=[],this._flush?this._flush(this,t):(or(this,t),$n(this,t))}},{key:"stop",value:function(e,t){if(e!==!!e&&(t=e),t){var n=this.springs;de(Ce(t),(function(t){return n[t].stop(!!e)}))}else Sn(this._state,this._lastAsyncId),this.each((function(t){return t.stop(!!e)}));return this}},{key:"pause",value:function(e){if(ce.und(e))this.start({pause:!0});else{var t=this.springs;de(Ce(e),(function(e){return t[e].pause()}))}return this}},{key:"resume",value:function(e){if(ce.und(e))this.start({pause:!1});else{var t=this.springs;de(Ce(e),(function(e){return t[e].resume()}))}return this}},{key:"each",value:function(e){Ie(this.springs,e)}},{key:"_onFrame",value:function(){var e=this,t=this._events,n=t.onStart,r=t.onChange,i=t.onRest,a=this._active.size>0,o=this._changed.size>0;(a&&!this._started||o&&!this._started)&&(this._started=!0,he(n,(function(t){var n=(0,g.Z)(t,2),r=n[0],i=n[1];i.value=e.get(),r(i,e,e._item)})));var s=!a&&this._started,u=o||s&&i.size?this.get():null;o&&r.size&&he(r,(function(t){var n=(0,g.Z)(t,2),r=n[0],i=n[1];i.value=u,r(i,e,e._item)})),s&&(this._started=!1,he(i,(function(t){var n=(0,g.Z)(t,2),r=n[0],i=n[1];i.value=u,r(i,e,e._item)})))}},{key:"eventObserved",value:function(e){if("change"==e.type)this._changed.add(e.parent),e.idle||this._active.add(e.parent);else{if("idle"!=e.type)return;this._active.delete(e.parent)}P.onFrame(this._onFrame)}}]),e}();function $n(e,t){return Promise.all(t.map((function(t){return er(e,t)}))).then((function(t){return Gn(e,t)}))}function er(e,t,n){return tr.apply(this,arguments)}function tr(){return tr=(0,L.Z)(K().mark((function e(t,n,r){var i,a,o,s,u,l,c,g,d,I,C,h,f;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.keys,a=n.to,o=n.from,s=n.loop,u=n.onRest,l=n.onResolve,c=ce.obj(n.default)&&n.default,s&&(n.loop=!1),!1===a&&(n.to=null),!1===o&&(n.from=null),(g=ce.arr(a)||ce.fun(a)?a:void 0)?(n.to=void 0,n.onRest=void 0,c&&(c.onRest=void 0)):de(Qn,(function(e){var r=n[e];if(ce.fun(r)){var i=t._events[e];n[e]=function(e){var t=e.finished,n=e.cancelled,a=i.get(r);a?(t||(a.finished=!1),n&&(a.cancelled=!0)):i.set(r,{value:null,finished:t||!1,cancelled:n||!1})},c&&(c[e]=n[e])}})),d=t._state,n.pause===!d.paused?(d.paused=n.pause,Ae(n.pause?d.pauseQueue:d.resumeQueue)):d.paused&&(n.pause=!0),I=(i||Object.keys(t.springs)).map((function(e){return t.springs[e].start(n)})),C=!0===n.cancel||!0===$t(n,"cancel"),(g||C&&d.asyncId)&&I.push(Bn(++t._lastAsyncId,{props:n,state:d,actions:{pause:le,resume:le,start:function(e,n){C?(Sn(d,t._lastAsyncId),n(_n(t))):(e.onRest=u,n(xn(g,e,d,t)))}}})),!d.paused){e.next=15;break}return e.next=15,new Promise((function(e){d.resumeQueue.add(e)}));case 15:return e.t0=Gn,e.t1=t,e.next=19,Promise.all(I);case 19:if(e.t2=e.sent,h=(0,e.t0)(e.t1,e.t2),!s||!h.finished||r&&h.noop){e.next=26;break}if(!(f=Tn(n,s,a))){e.next=26;break}return or(t,[f]),e.abrupt("return",er(t,f,!0));case 26:return l&&P.batchedUpdates((function(){return l(h,t,t.item)})),e.abrupt("return",h);case 28:case"end":return e.stop()}}),e)}))),tr.apply(this,arguments)}function nr(e,t){var n=Jt({},e.springs);return t&&de(Ce(t),(function(e){ce.und(e.keys)&&(e=Kn(e)),ce.obj(e.to)||(e=Jt({},e,{to:void 0})),ar(n,e,(function(e){return ir(e)}))})),rr(e,n),n}function rr(e,t){Ie(t,(function(t,n){e.springs[n]||(e.springs[n]=t,st(t,e))}))}function ir(e,t){var n=new Nn;return n.key=e,t&&st(n,t),n}function ar(e,t,n){t.keys&&de(t.keys,(function(r){(e[r]||(e[r]=n(r)))._prepareNode(t)}))}function or(e,t){de(t,(function(t){ar(e.springs,t,(function(t){return ir(t,e)}))}))}function sr(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}var ur=["children"],lr=function(e){var t=e.children,n=sr(e,ur),r=(0,o.useContext)(cr),i=n.pause||!!r.pause,a=n.immediate||!!r.immediate;n=function(e,t){var n=(0,o.useState)((function(){return{inputs:t,result:e()}})),r=(0,g.Z)(n,1)[0],i=(0,o.useRef)(),a=i.current,s=a;if(s){var u=Boolean(t&&s.inputs&&function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(t,s.inputs));u||(s={inputs:t,result:e()})}else s=r;return(0,o.useEffect)((function(){i.current=s,a==r&&(r.inputs=r.result=void 0)}),[s]),s.result}((function(){return{pause:i,immediate:a}}),[i,a]);var s=cr.Provider;return o.createElement(s,{value:n},t)},cr=function(e,t){return Object.assign(e,o.createContext(t)),e.Provider._context=e,e.Consumer._context=e,e}(lr,{});lr.Provider=cr.Provider,lr.Consumer=cr.Consumer;var gr=function(){var e=[],t=function(t){Gt("".concat(vt,'Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions'));var r=[];return de(e,(function(e,i){if(ce.und(t))r.push(e.start());else{var a=n(t,e,i);a&&r.push(e.start(a))}})),r};t.current=e,t.add=function(t){e.includes(t)||e.push(t)},t.delete=function(t){var n=e.indexOf(t);~n&&e.splice(n,1)},t.pause=function(){var t=arguments;return de(e,(function(e){return e.pause.apply(e,(0,a.Z)(t))})),this},t.resume=function(){var t=arguments;return de(e,(function(e){return e.resume.apply(e,(0,a.Z)(t))})),this},t.set=function(t){de(e,(function(e){return e.set(t)}))},t.start=function(t){var n=this,r=[];return de(e,(function(e,i){if(ce.und(t))r.push(e.start());else{var a=n._getProps(t,e,i);a&&r.push(e.start(a))}})),r},t.stop=function(){var t=arguments;return de(e,(function(e){return e.stop.apply(e,(0,a.Z)(t))})),this},t.update=function(t){var n=this;return de(e,(function(e,r){return e.update(n._getProps(t,e,r))})),this};var n=function(e,t,n){return ce.fun(e)?e(n,t):e};return t._getProps=n,t};function dr(e,t,n){var r=arguments,i=ce.fun(t)&&t;i&&!n&&(n=[]);var s=(0,o.useMemo)((function(){return i||3==r.length?gr():void 0}),[]),u=(0,o.useRef)(0),l=xt(),c=(0,o.useMemo)((function(){return{ctrls:[],queue:[],flush:function(e,t){var n=nr(e,t);return u.current>0&&!c.queue.length&&!Object.keys(n).some((function(t){return!e.springs[t]}))?$n(e,t):new Promise((function(r){rr(e,n),c.queue.push((function(){r($n(e,t))})),l()}))}}}),[]),g=(0,o.useRef)((0,a.Z)(c.ctrls)),d=[],I=Rt(e)||0;function C(e,n){for(var r=e;r<n;r++){var a=g.current[r]||(g.current[r]=new qn(null,c.flush)),o=i?i(r,a):t[r];o&&(d[r]=Dn(o))}}(0,o.useMemo)((function(){de(g.current.slice(e,I),(function(e){ln(e,s),e.stop(!0)})),g.current.length=e,C(I,e)}),[e]),(0,o.useMemo)((function(){C(0,Math.min(I,e))}),n);var h=g.current.map((function(e,t){return nr(e,d[t])})),f=(0,o.useContext)(lr),p=Rt(f),A=f!==p&&sn(f);Mt((function(){u.current++,c.ctrls=g.current;var e=c.queue;e.length&&(c.queue=[],de(e,(function(e){return e()}))),de(g.current,(function(e,t){null==s||s.add(e),A&&e.start({default:f});var n=d[t];n&&(cn(e,n.ref),e.ref?e.queue.push(n):e.start(n))}))})),wt((function(){return function(){de(c.ctrls,(function(e){return e.stop(!0)}))}}));var m=h.map((function(e){return Jt({},e)}));return s?[m,s]:m}function Ir(e,t){var n=ce.fun(e),r=dr(1,n?e:[e],n?t||[]:t),i=(0,g.Z)(r,2),a=(0,g.Z)(i[0],1),o=a[0],s=i[1];return n||2==arguments.length?[o,s]:o}var Cr;!function(e){e.MOUNT="mount",e.ENTER="enter",e.UPDATE="update",e.LEAVE="leave"}(Cr||(Cr={}));var hr=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r){var i;(0,N.Z)(this,n),(i=t.call(this)).key=void 0,i.idle=!0,i.calc=void 0,i._active=new Set,i.source=e,i.calc=je.apply(void 0,(0,a.Z)(r));var o=i._get(),s=Tt(o);return Vt((0,M.Z)(i),s.create(o)),i}return(0,z.Z)(n,[{key:"advance",value:function(e){var t=this._get();ge(t,this.get())||(kt(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&pr(this._active)&&Ar(this)}},{key:"_get",value:function(){var e=ce.arr(this.source)?this.source.map(nt):Ce(nt(this.source));return this.calc.apply(this,(0,a.Z)(e))}},{key:"_start",value:function(){var e=this;this.idle&&!pr(this._active)&&(this.idle=!1,de(Ft(this),(function(e){e.done=!1})),Be.skipAnimation?(P.batchedUpdates((function(){return e.advance()})),Ar(this)):xe.start(this))}},{key:"_attach",value:function(){var e=this,t=1;de(Ce(this.source),(function(n){tt(n)&&st(n,e),Wn(n)&&(n.idle||e._active.add(n),t=Math.max(t,n.priority+1))})),this.priority=t,this._start()}},{key:"_detach",value:function(){var e=this;de(Ce(this.source),(function(t){tt(t)&&ut(t,e)})),this._active.clear(),Ar(this)}},{key:"eventObserved",value:function(e){"change"==e.type?e.idle?this.advance():(this._active.add(e.parent),this._start()):"idle"==e.type?this._active.delete(e.parent):"priority"==e.type&&(this.priority=Ce(this.source).reduce((function(e,t){return Math.max(e,(Wn(t)?t.priority:0)+1)}),0))}}]),n}(Vn);function fr(e){return!1!==e.idle}function pr(e){return!e.size||Array.from(e).every(fr)}function Ar(e){e.idle||(e.idle=!0,de(Ft(e),(function(e){e.done=!0})),it(e,{type:"idle",parent:e}))}Be.assign({createStringInterpolator:mt,to:function(e,t){return new hr(e,t)}});xe.advance;var mr=["primitive"].concat(Object.keys(d).filter((function(e){return/^[A-Z]/.test(e)})).map((function(e){return e[0].toLowerCase()+e.slice(1)})));Be.assign({createStringInterpolator:mt,colors:{transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},frameLoop:"demand"}),(0,s.addEffect)((function(){P.advance()}));var vr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.applyAnimatedValues,r=void 0===n?function(){return!1}:n,i=t.createAnimatedStyle,a=void 0===i?function(e){return new zt(e)}:i,o=t.getComponentProps,s=void 0===o?function(e){return e}:o,u={applyAnimatedValues:r,createAnimatedStyle:a,getComponentProps:s},l=function e(t){var n=Ot(t)||"Anonymous";return(t=ce.str(t)?e[t]||(e[t]=Dt(t,u)):t[Ut]||(t[Ut]=Dt(t,u))).displayName="Animated(".concat(n,")"),t};return Ie(e,(function(t,n){ce.arr(e)&&(n=Ot(t)),l[n]=l(t)})),{animated:l}}(mr,{applyAnimatedValues:s.applyProps}),br=vr.animated,yr=n(4942);function Br(e,t,n){return Math.max(t,Math.min(e,n))}var Gr=function(e,t){return void 0===e&&(e=t),Array.isArray(e)?e:[e,e]},Zr=function(e,t){return[e[0]+t[0],e[1]+t[1]]},wr=function(e,t){return[e[0]-t[0],e[1]-t[1]]},_r=function(e,t){e[0]+=t[0],e[1]+=t[1]};function xr(e,t,n){return 0===t||Math.abs(t)===1/0?Math.pow(e,5*n):e*t*n/(t+n*e)}function Sr(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.15;return 0===r?Br(e,t,n):e<t?-xr(t-e,n-t,r)+t:e>n?+xr(e-n,n-t,r)+n:e}function Rr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mr(Object(n),!0).forEach((function(t){Rr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var kr={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function Vr(e){return e?e[0].toUpperCase()+e.slice(1):""}function Fr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=kr[e],i=r&&r[t]||t;return"on"+Vr(e)+Vr(i)+(n?"Capture":"")}var Er=["gotpointercapture","lostpointercapture"];function Xr(e){var t=e.substring(2).toLowerCase(),n=!!~t.indexOf("passive");n&&(t=t.replace("passive",""));var r=Er.includes(t)?"capturecapture":"capture",i=!!~t.indexOf(r);return i&&(t=t.replace("capture","")),{device:t,capture:i,passive:n}}function Hr(e){return"touches"in e}function Lr(e){return Hr(e)?function(e){return"touchend"===e.type||"touchcancel"===e.type?e.changedTouches:e.targetTouches}(e)[0]:e}function zr(e,t){var n=t.clientX-e.clientX,r=t.clientY-e.clientY,i=(t.clientX+e.clientX)/2,a=(t.clientY+e.clientY)/2,o=Math.hypot(n,r);return{angle:-180*Math.atan2(n,r)/Math.PI,distance:o,origin:[i,a]}}function Nr(e){return function(e){return Array.from(e.touches).filter((function(t){var n,r;return t.target===e.currentTarget||(null===(n=e.currentTarget)||void 0===n||null===(r=n.contains)||void 0===r?void 0:r.call(n,t.target))}))}(e).map((function(e){return e.identifier}))}function Yr(e,t){var n=Array.from(e.touches).filter((function(e){return t.includes(e.identifier)})),r=(0,g.Z)(n,2);return zr(r[0],r[1])}function Tr(e){var t=Lr(e);return Hr(e)?t.identifier:t.pointerId}function Kr(e){var t=Lr(e);return[t.clientX,t.clientY]}function Dr(e){var t=e.deltaX,n=e.deltaY,r=e.deltaMode;return 1===r?(t*=40,n*=40):2===r&&(t*=800,n*=800),[t,n]}function Pr(e){if("function"===typeof e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.apply(void 0,n)}return e}function Ur(){}function Or(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?Ur:1===t.length?t[0]:function(){var e,n,r=(0,Y.Z)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;e=i.apply(this,arguments)||e}}catch(a){r.e(a)}finally{r.f()}return e}}function Jr(e,t){return Object.assign({},t,e||{})}var Qr=function(){function e(t,n,r){(0,N.Z)(this,e),this.ctrl=t,this.args=n,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}return(0,z.Z)(e,[{key:"state",get:function(){return this.ctrl.state[this.key]},set:function(e){this.ctrl.state[this.key]=e}},{key:"shared",get:function(){return this.ctrl.state.shared}},{key:"eventStore",get:function(){return this.ctrl.gestureEventStores[this.key]}},{key:"timeoutStore",get:function(){return this.ctrl.gestureTimeoutStores[this.key]}},{key:"config",get:function(){return this.ctrl.config[this.key]}},{key:"sharedConfig",get:function(){return this.ctrl.config.shared}},{key:"handler",get:function(){return this.ctrl.handlers[this.key]}},{key:"reset",value:function(){var e=this.state,t=this.shared,n=this.ingKey,r=this.args;t[n]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=r,e.axis=void 0,e.memo=void 0,e.elapsedTime=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}},{key:"start",value:function(e){var t=this.state,n=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=n.from?Pr(n.from,t):t.offset,t.offset=t.lastOffset),t.startTime=t.timeStamp=e.timeStamp}},{key:"computeValues",value:function(e){var t=this.state;t._values=e,t.values=this.config.transform(e)}},{key:"computeInitial",value:function(){var e=this.state;e._initial=e._values,e.initial=e.values}},{key:"compute",value:function(e){var t=this.state,n=this.config,r=this.shared;t.args=this.args;var i=0;if(e&&(t.event=e,n.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,r.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,r.locked=!!document.pointerLockElement,Object.assign(r,function(e){var t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){var n=e.shiftKey,r=e.altKey,i=e.metaKey,a=e.ctrlKey;Object.assign(t,{shiftKey:n,altKey:r,metaKey:i,ctrlKey:a})}return t}(e)),r.down=r.pressed=r.buttons%2===1||r.touches>0,i=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){var a=t._delta.map(Math.abs);_r(t._distance,a)}var o=(0,g.Z)(t._movement,2),s=o[0],u=o[1],l=(0,g.Z)(n.threshold,2),c=l[0],d=l[1],I=t._step,C=t.values;if(n.hasCustomTransform?(!1===I[0]&&(I[0]=Math.abs(s)>=c&&C[0]),!1===I[1]&&(I[1]=Math.abs(u)>=d&&C[1])):(!1===I[0]&&(I[0]=Math.abs(s)>=c&&Math.sign(s)*c),!1===I[1]&&(I[1]=Math.abs(u)>=d&&Math.sign(u)*d)),t.intentional=!1!==I[0]||!1!==I[1],t.intentional){var h=[0,0];if(n.hasCustomTransform){var f=(0,g.Z)(C,2),p=f[0],A=f[1];h[0]=!1!==I[0]?p-I[0]:0,h[1]=!1!==I[1]?A-I[1]:0}else h[0]=!1!==I[0]?s-I[0]:0,h[1]=!1!==I[1]?u-I[1]:0;this.intent&&this.intent(h);var m=t.offset,v=t._active&&!t._blocked||t.active;v&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=r[this.ingKey]=t._active,e&&(t.first&&("bounds"in n&&(t._bounds=Pr(n.bounds,t)),this.setup&&this.setup()),t.movement=h,this.computeOffset()));var b=(0,g.Z)(t.offset,2),y=b[0],B=b[1],G=(0,g.Z)(t._bounds,2),Z=(0,g.Z)(G[0],2),w=Z[0],_=Z[1],x=(0,g.Z)(G[1],2),S=x[0],R=x[1];t.overflow=[y<w?-1:y>_?1:0,B<S?-1:B>R?1:0],t._movementBound[0]=!!t.overflow[0]&&(!1===t._movementBound[0]?t._movement[0]:t._movementBound[0]),t._movementBound[1]=!!t.overflow[1]&&(!1===t._movementBound[1]?t._movement[1]:t._movementBound[1]);var M=t._active&&n.rubberband||[0,0];if(t.offset=function(e,t,n){var r=(0,g.Z)(t,2),i=r[0],a=r[1],o=(0,g.Z)(n,2),s=o[0],u=o[1],l=(0,g.Z)(e,2),c=(0,g.Z)(l[0],2),d=c[0],I=c[1],C=(0,g.Z)(l[1],2),h=C[0],f=C[1];return[Sr(i,d,I,s),Sr(a,h,f,u)]}(t._bounds,t.offset,M),t.delta=wr(t.offset,m),this.computeMovement(),v&&(!t.last||i>32)){t.delta=wr(t.offset,m);var W=t.delta.map(Math.abs);_r(t.distance,W),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&i>0&&(t.velocity=[W[0]/i,W[1]/i])}}}},{key:"emit",value:function(){var e=this.state,t=this.shared,n=this.config;if(e._active||this.clean(),!e._blocked&&e.intentional||e._force||n.triggerAllEvents){var r=this.handler(Wr(Wr(Wr({},t),e),{},(0,yr.Z)({},this.aliasKey,e.values)));void 0!==r&&(e.memo=r)}}},{key:"clean",value:function(){this.eventStore.clean(),this.timeoutStore.clean()}}]),e}();var jr=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;(0,N.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),Rr((0,M.Z)(e),"aliasKey","xy"),e}return(0,z.Z)(n,[{key:"reset",value:function(){(0,W.Z)((0,k.Z)(n.prototype),"reset",this).call(this),this.state.axis=void 0}},{key:"init",value:function(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}},{key:"computeOffset",value:function(){this.state.offset=Zr(this.state.lastOffset,this.state.movement)}},{key:"computeMovement",value:function(){this.state.movement=wr(this.state.offset,this.state.lastOffset)}},{key:"intent",value:function(e){this.state.axis=this.state.axis||function(e){var t=(0,g.Z)(e,2),n=t[0],r=t[1],i=Math.abs(n)-Math.abs(r);return i>0?"x":i<0?"y":void 0}(e),this.state._blocked=(this.config.lockDirection||!!this.config.axis)&&!this.state.axis||!!this.config.axis&&this.config.axis!==this.state.axis,this.state._blocked||(this.config.axis||this.config.lockDirection)&&function(e,t){switch(t){case"x":e[1]=0;break;case"y":e[0]=0}}(e,this.state.axis)}}]),n}(Qr),qr=function(e){return e},$r=.15,ei={enabled:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e},preventDefault:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e},triggerAllEvents:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e},rubberband:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case!0:return[$r,$r];case!1:return[0,0];default:return Gr(e)}},from:function(e){return"function"===typeof e?e:null!=e?Gr(e):void 0},transform:function(e,t,n){var r=e||n.shared.transform;return this.hasCustomTransform=!!r,r||qr},threshold:function(e){return Gr(e,0)}};var ti=Wr(Wr({},ei),{},{axis:function(e,t,n){var r=n.axis;if(this.lockDirection="lock"===r,!this.lockDirection)return r},bounds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("function"===typeof e)return function(t){return ti.bounds(e(t))};if("current"in e)return function(){return e.current};if("function"===typeof HTMLElement&&e instanceof HTMLElement)return e;var t=e.left,n=void 0===t?-1/0:t,r=e.right,i=void 0===r?1/0:r,a=e.top,o=void 0===a?-1/0:a,s=e.bottom,u=void 0===s?1/0:s;return[[n,i],[o,u]]}}),ni=10,ri={ArrowRight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return[ni*e,0]},ArrowLeft:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return[-10*e,0]},ArrowUp:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return[0,-10*e]},ArrowDown:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return[0,ni*e]}},ii=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;(0,N.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),Rr((0,M.Z)(e),"ingKey","dragging"),e}return(0,z.Z)(n,[{key:"reset",value:function(){(0,W.Z)((0,k.Z)(n.prototype),"reset",this).call(this);var e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}},{key:"setup",value:function(){var e=this.state;if(e._bounds instanceof HTMLElement){var t=e._bounds.getBoundingClientRect(),n=e.currentTarget.getBoundingClientRect(),r={left:t.left-n.left+e.offset[0],right:t.right-n.right+e.offset[0],top:t.top-n.top+e.offset[1],bottom:t.bottom-n.bottom+e.offset[1]};e._bounds=ti.bounds(r)}}},{key:"cancel",value:function(){var e=this,t=this.state;t.canceled||(t.canceled=!0,t._active=!1,setTimeout((function(){e.compute(),e.emit()}),0))}},{key:"setActive",value:function(){this.state._active=this.state._pointerActive||this.state._keyboardActive}},{key:"clean",value:function(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,(0,W.Z)((0,k.Z)(n.prototype),"clean",this).call(this)}},{key:"pointerDown",value:function(e){var t=this.config,n=this.state;(null==e.buttons||(Array.isArray(t.pointerButtons)?t.pointerButtons.includes(e.buttons):-1===t.pointerButtons||t.pointerButtons===e.buttons))&&(this.ctrl.setEventIds(e),t.pointerCapture&&e.target.setPointerCapture(e.pointerId),n._pointerActive||(this.start(e),this.setupPointer(e),n._pointerId=Tr(e),n._pointerActive=!0,this.computeValues(Kr(e)),this.computeInitial(),t.preventScrollAxis?(n._active=!1,this.setupScrollPrevention(e)):t.delay>0?this.setupDelayTrigger(e):this.startPointerDrag(e)))}},{key:"startPointerDrag",value:function(e){var t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}},{key:"pointerMove",value:function(e){var t=this.state,n=this.config;if(t._pointerActive&&(t.type!==e.type||e.timeStamp!==t.timeStamp)){var r=Tr(e);if(void 0===t._pointerId||r===t._pointerId){var i=Kr(e);return document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=wr(i,t._values),this.computeValues(i)),_r(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional?(this.timeoutStore.remove("dragDelay"),t.active=!1,void this.startPointerDrag(e)):n.preventScrollAxis&&!t._preventScroll?t.axis?t.axis===n.preventScrollAxis||"xy"===n.preventScrollAxis?(t._active=!1,void this.clean()):(this.timeoutStore.remove("startPointerDrag"),void this.startPointerDrag(e)):void 0:void this.emit()}}}},{key:"pointerUp",value:function(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch(G){0}var t=this.state,n=this.config;if(t._active&&t._pointerActive){var r=Tr(e);if(void 0===t._pointerId||r===t._pointerId){this.state._pointerActive=!1,this.setActive(),this.compute(e);var i=(0,g.Z)(t._distance,2),a=i[0],o=i[1];if(t.tap=a<=n.tapsThreshold&&o<=n.tapsThreshold,t.tap&&n.filterTaps)t._force=!0;else{var s=(0,g.Z)(t.direction,2),u=s[0],l=s[1],c=(0,g.Z)(t.velocity,2),d=c[0],I=c[1],C=(0,g.Z)(t.movement,2),h=C[0],f=C[1],p=(0,g.Z)(n.swipe.velocity,2),A=p[0],m=p[1],v=(0,g.Z)(n.swipe.distance,2),b=v[0],y=v[1],B=n.swipe.duration;t.elapsedTime<B&&(Math.abs(d)>A&&Math.abs(h)>b&&(t.swipe[0]=u),Math.abs(I)>m&&Math.abs(f)>y&&(t.swipe[1]=l))}this.emit()}}}},{key:"pointerClick",value:function(e){this.state.tap||(e.preventDefault(),e.stopPropagation())}},{key:"setupPointer",value:function(e){var t=this.config,n=t.device;t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,n,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,n,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,n,"cancel",this.pointerUp.bind(this)))}},{key:"pointerClean",value:function(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}},{key:"preventScroll",value:function(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}},{key:"setupScrollPrevention",value:function(e){!function(e){"persist"in e&&"function"===typeof e.persist&&e.persist()}(e),this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1}),this.eventStore.add(this.sharedConfig.window,"touch","end",this.clean.bind(this)),this.eventStore.add(this.sharedConfig.window,"touch","cancel",this.clean.bind(this)),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}},{key:"setupDelayTrigger",value:function(e){var t=this;this.state._delayed=!0,this.timeoutStore.add("dragDelay",(function(){t.state._step=[0,0],t.startPointerDrag(e)}),this.config.delay)}},{key:"keyDown",value:function(e){var t=ri[e.key];if(t){var n=this.state,r=e.shiftKey?10:e.altKey?.1:1;n._delta=t(r),this.start(e),n._keyboardActive=!0,_r(n._movement,n._delta),this.compute(e),this.emit()}}},{key:"keyUp",value:function(e){e.key in ri&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}},{key:"bind",value:function(e){var t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this)),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}]),n}(jr);var ai="undefined"!==typeof window&&window.document&&window.document.createElement;function oi(){return ai&&"ontouchstart"in window||ai&&window.navigator.maxTouchPoints>1}var si={isBrowser:ai,gesture:function(){try{return"constructor"in GestureEvent}catch(Ic){return!1}}(),touch:oi(),touchscreen:oi(),pointer:ai&&"onpointerdown"in window,pointerLock:ai&&"exitPointerLock"in window.document},ui=Wr(Wr({},ti),{},{device:function(e,t,n){var r=n.pointer,i=(r=void 0===r?{}:r).touch,a=void 0!==i&&i,o=r.lock,s=void 0!==o&&o,u=r.mouse,l=void 0!==u&&u;return this.pointerLock=s&&si.pointerLock,si.touch&&a?"touch":this.pointerLock?"mouse":si.pointer&&!l?"pointer":si.touch?"touch":"mouse"},preventScrollAxis:function(e,t,n){var r=n.preventScroll;if(this.preventScrollDelay="number"===typeof r?r:r||void 0===r&&e?250:void 0,si.touchscreen&&!1!==r)return e||(void 0!==r?"y":void 0)},pointerCapture:function(e,t,n){var r=n.pointer,i=(r=void 0===r?{}:r).capture,a=void 0===i||i,o=r.buttons,s=void 0===o?1:o;return this.pointerButtons=s,!this.pointerLock&&"pointer"===this.device&&a},threshold:function(e,t,n){var r=n.filterTaps,i=void 0!==r&&r,a=n.tapsThreshold,o=void 0===a?3:a,s=n.axis,u=Gr(e,i?o:(void 0===s?void 0:s)?1:0);return this.filterTaps=i,this.tapsThreshold=o,u},swipe:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.velocity,n=void 0===t?.5:t,r=e.distance,i=void 0===r?50:r,a=e.duration,o=void 0===a?250:a;return{velocity:this.transform(Gr(n)),distance:this.transform(Gr(i)),duration:o}},delay:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case!0:return 180;case!1:return 0;default:return e}}});var li=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;(0,N.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),Rr((0,M.Z)(e),"ingKey","pinching"),Rr((0,M.Z)(e),"aliasKey","da"),e}return(0,z.Z)(n,[{key:"init",value:function(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}},{key:"reset",value:function(){(0,W.Z)((0,k.Z)(n.prototype),"reset",this).call(this);var e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}},{key:"computeOffset",value:function(){var e=this.state,t=e.type,n=e.movement,r=e.lastOffset;this.state.offset="wheel"===t?Zr(n,r):[(1+n[0])*r[0],n[1]+r[1]]}},{key:"computeMovement",value:function(){var e=this.state,t=e.offset,n=e.lastOffset;this.state.movement=[t[0]/n[0],t[1]-n[1]]}},{key:"intent",value:function(e){var t=this.state;if(!t.axis){var n=30*Math.abs(e[0])-Math.abs(e[1]);n<0?t.axis="angle":n>0&&(t.axis="scale")}this.config.lockDirection&&("scale"===t.axis?e[1]=0:"angle"===t.axis&&(e[0]=0))}},{key:"cancel",value:function(){var e=this,t=this.state;t.canceled||setTimeout((function(){t.canceled=!0,t._active=!1,e.compute(),e.emit()}),0)}},{key:"touchStart",value:function(e){this.ctrl.setEventIds(e);var t=this.state,n=this.ctrl.touchIds;if((!t._active||!t._touchIds.every((function(e){return n.has(e)})))&&!(n.size<2)){this.start(e),t._touchIds=Array.from(n).slice(0,2);var r=Yr(e,t._touchIds);this.pinchStart(e,r)}}},{key:"pointerStart",value:function(e){if(null==e.buttons||e.buttons%2===1){this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);var t=this.state,n=t._pointerEvents,r=this.ctrl.pointerIds;if((!t._active||!Array.from(n.keys()).every((function(e){return r.has(e)})))&&(n.size<2&&n.set(e.pointerId,e),!(t._pointerEvents.size<2))){this.start(e);var i=zr.apply(void 0,(0,a.Z)(Array.from(n.values())));this.pinchStart(e,i)}}}},{key:"pinchStart",value:function(e,t){this.state.origin=t.origin,this.computeValues([t.distance,t.angle]),this.computeInitial(),this.compute(e),this.emit()}},{key:"touchMove",value:function(e){if(this.state._active){var t=Yr(e,this.state._touchIds);this.pinchMove(e,t)}}},{key:"pointerMove",value:function(e){var t=this.state._pointerEvents;if(t.has(e.pointerId)&&t.set(e.pointerId,e),this.state._active){var n=zr.apply(void 0,(0,a.Z)(Array.from(t.values())));this.pinchMove(e,n)}}},{key:"pinchMove",value:function(e,t){var n=this.state,r=n._values[1],i=t.angle-r,a=0;Math.abs(i)>270&&(a+=Math.sign(i)),this.computeValues([t.distance,t.angle-360*a]),n.origin=t.origin,n.turns=a,n._movement=[n._values[0]/n._initial[0]-1,n._values[1]-n._initial[1]],this.compute(e),this.emit()}},{key:"touchEnd",value:function(e){var t=this;this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some((function(e){return!t.ctrl.touchIds.has(e)}))&&(this.state._active=!1,this.compute(e),this.emit())}},{key:"pointerEnd",value:function(e){var t=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch(n){}t._pointerEvents.has(e.pointerId)&&t._pointerEvents.delete(e.pointerId),t._active&&t._pointerEvents.size<2&&(t._active=!1,this.compute(e),this.emit())}},{key:"gestureStart",value:function(e){e.cancelable&&e.preventDefault();var t=this.state;t._active||(this.start(e),this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}},{key:"gestureMove",value:function(e){if(e.cancelable&&e.preventDefault(),this.state._active){var t=this.state;this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY];var n=t._movement;t._movement=[e.scale-1,e.rotation],t._delta=wr(t._movement,n),this.compute(e),this.emit()}}},{key:"gestureEnd",value:function(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}},{key:"wheel",value:function(e){e.ctrlKey&&(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}},{key:"wheelStart",value:function(e){this.start(e),this.wheelChange(e)}},{key:"wheelChange",value:function(e){"uv"in e||e.cancelable&&e.preventDefault();var t=this.state;t._delta=[-Dr(e)[1]/100*t.offset[0],0],_r(t._movement,t._delta),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}},{key:"wheelEnd",value:function(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}},{key:"bind",value:function(e){var t=this.config.device;t?(e(t,"start",this[t+"Start"].bind(this)),e(t,"change",this[t+"Move"].bind(this)),e(t,"end",this[t+"End"].bind(this)),e(t,"cancel",this[t+"End"].bind(this))):e("wheel","",this.wheel.bind(this),{passive:!1})}}]),n}(Qr),ci=Wr(Wr({},ei),{},{device:function(e,t,n){var r=n.shared,i=n.pointer,a=(i=void 0===i?{}:i).touch,o=void 0!==a&&a;if(r.target&&!si.touch&&si.gesture)return"gesture";if(si.touch&&o)return"touch";if(si.touchscreen){if(si.pointer)return"pointer";if(si.touch)return"touch"}},bounds:function(e,t,n){var r=n.scaleBounds,i=void 0===r?{}:r,a=n.angleBounds,o=void 0===a?{}:a,s=function(e){var t=Jr(Pr(i,e),{min:-1/0,max:1/0});return[t.min,t.max]},u=function(e){var t=Jr(Pr(o,e),{min:-1/0,max:1/0});return[t.min,t.max]};return"function"!==typeof i&&"function"!==typeof o?[s(),u()]:function(e){return[s(e),u(e)]}},threshold:function(e,t,n){this.lockDirection="lock"===n.axis;var r=Gr(e,this.lockDirection?[.1,3]:0);return r}}),gi=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;(0,N.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),Rr((0,M.Z)(e),"ingKey","moving"),e}return(0,z.Z)(n,[{key:"move",value:function(e){this.config.mouseOnly&&"mouse"!==e.pointerType||(this.state._active?this.moveChange(e):this.moveStart(e),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}},{key:"moveStart",value:function(e){this.start(e),this.computeValues(Kr(e)),this.compute(e),this.computeInitial(),this.emit()}},{key:"moveChange",value:function(e){if(this.state._active){var t=Kr(e),n=this.state;n._delta=wr(t,n._values),_r(n._movement,n._delta),this.computeValues(t),this.compute(e),this.emit()}}},{key:"moveEnd",value:function(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}},{key:"bind",value:function(e){e("pointer","change",this.move.bind(this)),e("pointer","leave",this.moveEnd.bind(this))}}]),n}(jr),di=Wr(Wr({},ti),{},{mouseOnly:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e}}),Ii=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;(0,N.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),Rr((0,M.Z)(e),"ingKey","scrolling"),e}return(0,z.Z)(n,[{key:"scroll",value:function(e){this.state._active||this.start(e),this.scrollChange(e),this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}},{key:"scrollChange",value:function(e){e.cancelable&&e.preventDefault();var t=this.state,n=function(e){var t,n,r=e.currentTarget,i=r.scrollX,a=r.scrollY,o=r.scrollLeft,s=r.scrollTop;return[null!==(t=null!==i&&void 0!==i?i:o)&&void 0!==t?t:0,null!==(n=null!==a&&void 0!==a?a:s)&&void 0!==n?n:0]}(e);t._delta=wr(n,t._values),_r(t._movement,t._delta),this.computeValues(n),this.compute(e),this.emit()}},{key:"scrollEnd",value:function(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}},{key:"bind",value:function(e){e("scroll","",this.scroll.bind(this))}}]),n}(jr),Ci=ti,hi=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;(0,N.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),Rr((0,M.Z)(e),"ingKey","wheeling"),e}return(0,z.Z)(n,[{key:"wheel",value:function(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}},{key:"wheelChange",value:function(e){var t=this.state;t._delta=Dr(e),_r(t._movement,t._delta);var n=(0,g.Z)(t.overflow,2),r=n[0],i=n[1],a=(0,g.Z)(t._delta,2),o=a[0],s=a[1],u=(0,g.Z)(t._direction,2),l=u[0],c=u[1];(r<0&&o>0&&l<0||r>0&&o<0&&l>0)&&(t._movement[0]=t._movementBound[0]),(i<0&&s>0&&c<0||i>0&&s<0&&c>0)&&(t._movement[1]=t._movementBound[1]),this.compute(e),this.emit()}},{key:"wheelEnd",value:function(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}},{key:"bind",value:function(e){e("wheel","",this.wheel.bind(this))}}]),n}(jr),fi=ti,pi=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;(0,N.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),Rr((0,M.Z)(e),"ingKey","hovering"),e}return(0,z.Z)(n,[{key:"enter",value:function(e){this.config.mouseOnly&&"mouse"!==e.pointerType||(this.start(e),this.computeValues(Kr(e)),this.compute(e),this.emit())}},{key:"leave",value:function(e){if(!this.config.mouseOnly||"mouse"===e.pointerType){var t=this.state;if(t._active){t._active=!1;var n=Kr(e);t._movement=t._delta=wr(n,t._values),this.computeValues(n),this.compute(e),t.delta=t.movement,this.emit()}}}},{key:"bind",value:function(e){e("pointer","enter",this.enter.bind(this)),e("pointer","leave",this.leave.bind(this))}}]),n}(jr),Ai=Wr(Wr({},ti),{},{mouseOnly:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e}}),mi=new Map,vi=new Map;function bi(e){mi.set(e.key,e.engine),vi.set(e.key,e.resolver)}var yi={key:"drag",engine:ii,resolver:ui},Bi={key:"hover",engine:pi,resolver:Ai},Gi={key:"move",engine:gi,resolver:di},Zi={key:"pinch",engine:li,resolver:ci},wi={key:"scroll",engine:Ii,resolver:Ci},_i={key:"wheel",engine:hi,resolver:fi};function xi(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var Si={target:function(e){if(e)return function(){return"current"in e?e.current:e}},enabled:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e},window:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:si.isBrowser?window:void 0;return e})),eventOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.passive,n=void 0===t||t,r=e.capture,i=void 0!==r&&r;return{passive:n,capture:i}},transform:function(e){return e}},Ri=["target","eventOptions","window","enabled","transform"];function Mi(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n={},r=0,i=Object.entries(t);r<i.length;r++){var a=(0,g.Z)(i[r],2),o=a[0],s=a[1];switch(typeof s){case"function":n[o]=s.call(n,e[o],o,e);break;case"object":n[o]=Mi(e[o],s);break;case"boolean":s&&(n[o]=e[o])}}return n}var Wi=function(){function e(t){(0,N.Z)(this,e),Rr(this,"_listeners",[]),this._ctrl=t}return(0,z.Z)(e,[{key:"add",value:function(e,t,n,r,i){var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=kr[e],r=n&&n[t]||t;return e+r}(t,n),o=Wr(Wr({},this._ctrl.config.shared.eventOptions),i);e.addEventListener(a,r,o),this._listeners.push((function(){return e.removeEventListener(a,r,o)}))}},{key:"clean",value:function(){this._listeners.forEach((function(e){return e()})),this._listeners=[]}}]),e}(),ki=function(){function e(){(0,N.Z)(this,e),Rr(this,"_timeouts",new Map)}return(0,z.Z)(e,[{key:"add",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:140;this.remove(e);for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];this._timeouts.set(e,(n=window).setTimeout.apply(n,[t,r].concat(a)))}},{key:"remove",value:function(e){var t=this._timeouts.get(e);t&&window.clearTimeout(t)}},{key:"clean",value:function(){this._timeouts.forEach((function(e){window.clearTimeout(e)})),this._timeouts.clear()}}]),e}(),Vi=function(){function e(t){(0,N.Z)(this,e),Rr(this,"gestures",new Set),Rr(this,"_targetEventStore",new Wi(this)),Rr(this,"gestureEventStores",{}),Rr(this,"gestureTimeoutStores",{}),Rr(this,"handlers",{}),Rr(this,"config",{}),Rr(this,"pointerIds",new Set),Rr(this,"touchIds",new Set),Rr(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),function(e,t){t.drag&&Fi(e,"drag");t.wheel&&Fi(e,"wheel");t.scroll&&Fi(e,"scroll");t.move&&Fi(e,"move");t.pinch&&Fi(e,"pinch");t.hover&&Fi(e,"hover")}(this,t)}return(0,z.Z)(e,[{key:"setEventIds",value:function(e){Hr(e)?this.touchIds=new Set(Nr(e)):"pointerId"in e&&("pointerup"===e.type||"pointercancel"===e.type?this.pointerIds.delete(e.pointerId):"pointerdown"===e.type&&this.pointerIds.add(e.pointerId))}},{key:"applyHandlers",value:function(e,t){this.handlers=e,this.nativeHandlers=t}},{key:"applyConfig",value:function(e,t){this.config=function(e,t){var n=e,r=n.target,i=n.eventOptions,a=n.window,o=n.enabled,s=n.transform,u=xi(n,Ri),l={shared:Mi({target:r,eventOptions:i,window:a,enabled:o,transform:s},Si)};if(t){var c=vi.get(t);l[t]=Mi(Wr({shared:l.shared},u),c)}else for(var g in u){var d=vi.get(g);d&&(l[g]=Mi(Wr({shared:l.shared},u[g]),d))}return l}(e,t)}},{key:"clean",value:function(){this._targetEventStore.clean();var e,t=(0,Y.Z)(this.gestures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.gestureEventStores[n].clean(),this.gestureTimeoutStores[n].clean()}}catch(r){t.e(r)}finally{t.f()}}},{key:"effect",value:function(){var e=this;return this.config.shared.target&&this.bind(),function(){return e._targetEventStore.clean()}}},{key:"bind",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i,o=this.config.shared,s=o.eventOptions,u={};if(!o.target||(i=o.target())){var l=Ei(u,s,!!i);if(o.enabled){var c,g=(0,Y.Z)(this.gestures);try{for(g.s();!(c=g.n()).done;){var d=c.value;if(this.config[d].enabled){var I=mi.get(d);new I(this,n,d).bind(l)}}}catch(y){g.e(y)}finally{g.f()}var C=function(t){l(t,"",(function(r){return e.nativeHandlers[t](Wr(Wr({},e.state.shared),{},{event:r,args:n}))}),void 0,!0)};for(var h in this.nativeHandlers)C(h)}for(var f in u)u[f]=Or.apply(void 0,(0,a.Z)(u[f]));if(!i)return u;for(var p in u){var A=Xr(p),m=A.device,v=A.capture,b=A.passive;this._targetEventStore.add(i,m,"",u[p],{capture:v,passive:b})}}}}]),e}();function Fi(e,t){e.gestures.add(t),e.gestureEventStores[t]=new Wi(e),e.gestureTimeoutStores[t]=new ki}var Ei=function(e,t,n){return function(r,i,a){var o,s,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=null!==(o=u.capture)&&void 0!==o?o:t.capture,g=null!==(s=u.passive)&&void 0!==s?s:t.passive,d=l?r:Fr(r,i,c);n&&g&&(d+="Passive"),e[d]=e[d]||[],e[d].push(a)}},Xi=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function Hi(e,t,n,r,i,a){if(e.has(n)&&mi.has(r)){var o=n+"Start",s=n+"End";i[r]=function(e){var r=void 0;return e.first&&o in t&&t[o](e),n in t&&(r=t[n](e)),e.last&&s in t&&t[s](e),r},a[r]=a[r]||{}}}function Li(e,t){var n=function(e){var t={},n={},r=new Set;for(var i in e)Xi.test(i)?(r.add(RegExp.lastMatch),n[i]=e[i]):t[i]=e[i];return[n,t,r]}(e),r=(0,g.Z)(n,3),i=r[0],a=r[1],o=r[2],s={};return Hi(o,i,"onDrag","drag",s,t),Hi(o,i,"onWheel","wheel",s,t),Hi(o,i,"onScroll","scroll",s,t),Hi(o,i,"onPinch","pinch",s,t),Hi(o,i,"onMove","move",s,t),Hi(o,i,"onHover","hover",s,t),{handlers:s,config:t,nativeHandlers:a}}function zi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=o.useMemo((function(){return new Vi(e)}),[]);if(i.applyHandlers(e,r),i.applyConfig(t,n),o.useEffect(i.effect.bind(i)),o.useEffect((function(){return i.clean.bind(i)}),[]),void 0===t.target)return i.bind.bind(i)}function Ni(e){return e.forEach(bi),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Li(e,t),r=n.handlers,i=n.nativeHandlers,a=n.config;return zi(r,a,void 0,i)}}function Yi(e){var t=e.snap,n=e.global,r=e.children,i=e.speed,u=void 0===i?1:i,l=e.rotation,I=void 0===l?[0,0,0]:l,C=e.zoom,h=void 0===C?1:C,f=e.polar,p=void 0===f?[0,Math.PI/2]:f,A=e.azimuth,m=void 0===A?[-1/0,1/0]:A,b=e.config,y=void 0===b?{mass:1,tension:170,friction:26}:b,B=(0,s.useThree)(),G=B.size,Z=B.gl,w=o.useMemo((function(){return[I[0]+p[0],I[0]+p[1]]}),[I[0],p[0],p[1]]),_=o.useMemo((function(){return[I[1]+m[0],I[1]+m[1]]}),[I[1],m[0],m[1]]),x=o.useMemo((function(){return[d.MathUtils.clamp.apply(d.MathUtils,[I[0]].concat((0,a.Z)(w))),d.MathUtils.clamp.apply(d.MathUtils,[I[1]].concat((0,a.Z)(_))),I[2]]}),[I[0],I[1],I[2],w,_]),S=Ir((function(){return{scale:1,rotation:x,config:y}})),R=(0,g.Z)(S,2),M=R[0],W=R[1];o.useEffect((function(){W.start({scale:1,rotation:x,config:y})}),[x]),o.useEffect((function(){n&&(document.body.style.cursor="grab")}),[n]);var k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ni([yi,Zi,wi,_i,Gi,Bi])(e,t)}({onHover:function(e){var t=e.last;n||(document.body.style.cursor=t?"auto":"grab")},onDrag:function(e){var n=e.down,r=(0,g.Z)(e.delta,2),i=r[0],o=r[1],s=e.memo;s=void 0===s?M.rotation.animation.to||x:s;var l=(0,g.Z)(s,2),I=l[0],C=l[1];document.body.style.cursor=n?"grabbing":"grab",i=d.MathUtils.clamp.apply(d.MathUtils,[C+i/G.width*Math.PI*u].concat((0,a.Z)(_))),o=d.MathUtils.clamp.apply(d.MathUtils,[I+o/G.height*Math.PI*u].concat((0,a.Z)(w)));var f=t&&!n&&"boolean"!==typeof t?t:y;return W.start({scale:n&&o>w[1]/2?h:1,rotation:t&&!n?x:[o,i,0],config:function(e){return"scale"===e?(0,c.Z)((0,c.Z)({},f),{},{friction:3*f.friction}):f}}),[o,i]}},{target:n?Z.domElement:void 0});return o.createElement(br.group,(0,v.Z)({},null==k?void 0:k(),M),r)}var Ti=["follow","lockX","lockY","lockZ"],Ki=o.forwardRef((function(e,t){var n=e.follow,r=void 0===n||n,i=e.lockX,a=void 0!==i&&i,u=e.lockY,l=void 0!==u&&u,c=e.lockZ,g=void 0!==c&&c,d=(0,m.Z)(e,Ti),I=o.useRef();return(0,s.useFrame)((function(e){var t=e.camera;if(r&&I.current){var n=I.current.rotation.clone();I.current.quaternion.copy(t.quaternion),a&&(I.current.rotation.x=n.x),l&&(I.current.rotation.y=n.y),g&&(I.current.rotation.z=n.z)}})),o.createElement("group",(0,v.Z)({ref:(0,y.default)([I,t])},d))})),Di=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;(0,N.Z)(this,n),e=t.call(this),(0,yr.Z)((0,M.Z)(e),"isLineSegmentsGeometry",!0),(0,yr.Z)((0,M.Z)(e),"type","LineSegmentsGeometry"),(0,yr.Z)((0,M.Z)(e),"boundingBox",null),(0,yr.Z)((0,M.Z)(e),"boundingSphere",null),(0,yr.Z)((0,M.Z)(e),"box",new d.Box3),(0,yr.Z)((0,M.Z)(e),"vector",new d.Vector3);return e.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),e.setAttribute("position",new d.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),e.setAttribute("uv",new d.Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2)),e}return(0,z.Z)(n,[{key:"applyMatrix4",value:function(e){var t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"setPositions",value:function(e){var t;if(e instanceof Float32Array)t=e;else{if(!Array.isArray(e))return console.error("LineSegmentsGeometry.setPosition requires either a Float32Array or regular array of numbers"),this;t=new Float32Array(e)}var n=new d.InstancedInterleavedBuffer(t,6,1);return this.setAttribute("instanceStart",new d.InterleavedBufferAttribute(n,3,0)),this.setAttribute("instanceEnd",new d.InterleavedBufferAttribute(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}},{key:"setColors",value:function(e){var t;if(e instanceof Float32Array)t=e;else{if(!Array.isArray(e))return console.error("LineSegmentsGeometry.setColors requires either a Float32Array or regular array of numbers"),this;t=new Float32Array(e)}var n=new d.InstancedInterleavedBuffer(t,6,1);return this.setAttribute("instanceColorStart",new d.InterleavedBufferAttribute(n,3,0)),this.setAttribute("instanceColorEnd",new d.InterleavedBufferAttribute(n,3,3)),this}},{key:"fromWireframeGeometry",value:function(e){return this.setPositions(Array.from(e.attributes.position.array)),this}},{key:"fromEdgesGeometry",value:function(e){return this.setPositions(Array.from(e.attributes.position.array)),this}},{key:"fromMesh",value:function(e){return this.fromWireframeGeometry(new d.WireframeGeometry(e.geometry)),this}},{key:"fromLineSegments",value:function(e){var t=e.geometry;return t.isBufferGeometry&&this.setPositions(Array.from(t.attributes.position.array)),this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new d.Box3);var e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),this.box.setFromBufferAttribute(t),this.boundingBox.union(this.box))}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new d.Sphere),null===this.boundingBox&&this.computeBoundingBox();var e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){var n=this.boundingSphere.center;this.boundingBox&&this.boundingBox.getCenter(n);for(var r=0,i=0,a=e.count;i<a;i++)this.vector.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(this.vector)),this.vector.fromBufferAttribute(t,i),r=Math.max(r,n.distanceToSquared(this.vector));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}},{key:"toJSON",value:function(){}}]),n}(d.InstancedBufferGeometry),Pi={linewidth:{value:1},resolution:{value:new d.Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},dashOffset:{value:0},gapSize:{value:1},opacity:{value:1}};d.ShaderLib.line={uniforms:d.UniformsUtils.merge([d.UniformsLib.common,d.UniformsLib.fog,Pi]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tfloat alpha = opacity;\n\n\t\t\t#ifdef ALPHA_TO_COVERAGE\n\n\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\tfloat a = vUv.x;\n\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\tfloat len2 = a * a + b * b;\n\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t}\n\n\t\t\t#else\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\t#endif\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};var Ui=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.Z)(this,n),e=t.call(this,{uniforms:d.UniformsUtils.clone(d.ShaderLib.line.uniforms),vertexShader:d.ShaderLib.line.vertexShader,fragmentShader:d.ShaderLib.line.fragmentShader,clipping:!0}),(0,yr.Z)((0,M.Z)(e),"isLineMaterial",!0),(0,yr.Z)((0,M.Z)(e),"dashed",!1),(0,yr.Z)((0,M.Z)(e),"color",new d.Color(0)),(0,yr.Z)((0,M.Z)(e),"lineWidth",0),(0,yr.Z)((0,M.Z)(e),"dashScale",0),(0,yr.Z)((0,M.Z)(e),"dashOffset",0),(0,yr.Z)((0,M.Z)(e),"dashSize",0),(0,yr.Z)((0,M.Z)(e),"opacity",0),(0,yr.Z)((0,M.Z)(e),"resolution",new d.Vector2),(0,yr.Z)((0,M.Z)(e),"alphaToCoverage",!1),Object.defineProperties((0,M.Z)(e),{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){var t=new d.Color(e);this.uniforms.diffuse.value=t.getHex()}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}},alphaToCoverage:{enumerable:!0,get:function(){return Boolean("ALPHA_TO_COVERAGE"in this.defines)},set:function(e){Boolean(e)!==Boolean("ALPHA_TO_COVERAGE"in this.defines)&&(this.needsUpdate=!0),e?(this.defines.ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}},dashed:{enumerable:!0,get:function(){return Boolean("USE_DASH"in this.defines)},set:function(e){Boolean(e)!==Boolean("USE_DASH"in this.defines)&&(this.needsUpdate=!0),e?this.defines.USE_DASH="":delete this.defines.USE_DASH}}}),e.setValues(r),e}return(0,z.Z)(n)}(d.ShaderMaterial),Oi=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Di,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ui({color:16777215*Math.random()});return(0,N.Z)(this,n),e=t.call(this,r,i),(0,yr.Z)((0,M.Z)(e),"type","LineSegments2"),(0,yr.Z)((0,M.Z)(e),"isLineSegments2",!0),(0,yr.Z)((0,M.Z)(e),"distStart",new d.Vector3),(0,yr.Z)((0,M.Z)(e),"distEnd",new d.Vector3),(0,yr.Z)((0,M.Z)(e),"computeLineDistances",(function(){for(var t=e.geometry,n=t.attributes.instanceStart,r=t.attributes.instanceEnd,i=new Float32Array(2*n.data.count),a=0,o=0,s=n.data.count;a<s;a++,o+=2)e.distStart.fromBufferAttribute(n,a),e.distEnd.fromBufferAttribute(r,a),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+e.distStart.distanceTo(e.distEnd);var u=new d.InstancedInterleavedBuffer(i,2,1);return t.setAttribute("instanceDistanceStart",new d.InterleavedBufferAttribute(u,1,0)),t.setAttribute("instanceDistanceEnd",new d.InterleavedBufferAttribute(u,1,1)),(0,M.Z)(e)})),(0,yr.Z)((0,M.Z)(e),"rayStart",new d.Vector4),(0,yr.Z)((0,M.Z)(e),"rayEnd",new d.Vector4),(0,yr.Z)((0,M.Z)(e),"ssOrigin",new d.Vector4),(0,yr.Z)((0,M.Z)(e),"ssOrigin3",new d.Vector3),(0,yr.Z)((0,M.Z)(e),"mvMatrix",new d.Matrix4),(0,yr.Z)((0,M.Z)(e),"line",new d.Line3),(0,yr.Z)((0,M.Z)(e),"closestPoint",new d.Vector3),(0,yr.Z)((0,M.Z)(e),"raycast",(function(t,n){null===t.camera&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2.');var r=t.ray,i=t.camera,a=i.projectionMatrix,o=e.geometry,s=e.material,u=s.resolution,l=s.linewidth+0,c=o.attributes.instanceStart,g=o.attributes.instanceEnd,I=-i.near;r.at(1,e.ssOrigin),e.ssOrigin.w=1,e.ssOrigin.applyMatrix4(i.matrixWorldInverse),e.ssOrigin.applyMatrix4(a),e.ssOrigin.multiplyScalar(1/e.ssOrigin.w),e.ssOrigin.x*=u.x/2,e.ssOrigin.y*=u.y/2,e.ssOrigin.z=0,e.ssOrigin3.set(e.ssOrigin.x,e.ssOrigin.y,e.ssOrigin.z);var C=e.matrixWorld;e.mvMatrix.multiplyMatrices(i.matrixWorldInverse,C);for(var h=0,f=c.count;h<f;h++){if(e.rayStart.fromBufferAttribute(c,h),e.rayEnd.fromBufferAttribute(g,h),e.rayStart.w=1,e.rayEnd.w=1,e.rayStart.applyMatrix4(e.mvMatrix),e.rayEnd.applyMatrix4(e.mvMatrix),!(e.rayStart.z>I&&e.rayEnd.z>I)){if(e.rayStart.z>I){var p=e.rayStart.z-e.rayEnd.z,A=(e.rayStart.z-I)/p;e.rayStart.lerp(e.rayEnd,A)}else if(e.rayEnd.z>I){var m=e.rayEnd.z-e.rayStart.z,v=(e.rayEnd.z-I)/m;e.rayEnd.lerp(e.rayStart,v)}e.rayStart.applyMatrix4(a),e.rayEnd.applyMatrix4(a),e.rayStart.multiplyScalar(1/e.rayStart.w),e.rayEnd.multiplyScalar(1/e.rayEnd.w),e.rayStart.x*=u.x/2,e.rayStart.y*=u.y/2,e.rayEnd.x*=u.x/2,e.rayEnd.y*=u.y/2,e.line.start.set(e.rayStart.x,e.rayStart.y,e.rayStart.z),e.line.start.z=0,e.line.end.set(e.rayEnd.x,e.rayEnd.y,e.rayEnd.z),e.line.end.z=0;var b=e.line.closestPointToPointParameter(e.ssOrigin3,!0);e.line.at(b,e.closestPoint);var y=d.MathUtils.lerp(e.rayStart.z,e.rayEnd.z,b),B=y>=-1&&y<=1,G=e.ssOrigin3.distanceTo(e.closestPoint)<.5*l;if(B&&G){e.line.start.fromBufferAttribute(c,h),e.line.end.fromBufferAttribute(g,h),e.line.start.applyMatrix4(C),e.line.end.applyMatrix4(C);var Z=new d.Vector3,w=new d.Vector3;r.distanceSqToSegment(e.line.start,e.line.end,w,Z),n.push({distance:r.origin.distanceTo(w),point:w,face:null,faceIndex:h,object:(0,M.Z)(e),uv:void 0,pointOnLine:Z})}}}})),e}return(0,z.Z)(n)}(d.Mesh),Ji=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e,r;return(0,N.Z)(this,n),r=t.call(this),(0,yr.Z)((0,M.Z)(r),"type","LineGeometry"),(0,yr.Z)((0,M.Z)(r),"isLineGeometry",!0),(0,yr.Z)((0,M.Z)(r),"setColors",(function(t){for(var i=t.length-3,a=new Float32Array(2*i),o=0;o<i;o+=3)a[2*o]=t[o],a[2*o+1]=t[o+1],a[2*o+2]=t[o+2],a[2*o+3]=t[o+3],a[2*o+4]=t[o+4],a[2*o+5]=t[o+5];return(0,W.Z)((e=(0,M.Z)(r),(0,k.Z)(n.prototype)),"setColors",e).call(e,a),(0,M.Z)(r)})),(0,yr.Z)((0,M.Z)(r),"fromLine",(function(e){var t=e.geometry;return t.isBufferGeometry&&r.setPositions(Array.from(t.attributes.position.array)),(0,M.Z)(r)})),(0,yr.Z)((0,M.Z)(r),"copy",(function(){return(0,M.Z)(r)})),r}return(0,z.Z)(n,[{key:"setPositions",value:function(e){for(var t=e.length-3,r=new Float32Array(2*t),i=0;i<t;i+=3)r[2*i]=e[i],r[2*i+1]=e[i+1],r[2*i+2]=e[i+2],r[2*i+3]=e[i+3],r[2*i+4]=e[i+4],r[2*i+5]=e[i+5];return(0,W.Z)((0,k.Z)(n.prototype),"setPositions",this).call(this,r),this}}]),n}(Di),Qi=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ji,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ui({color:16777215*Math.random()});return(0,N.Z)(this,n),e=t.call(this,r,i),(0,yr.Z)((0,M.Z)(e),"type","Line2"),(0,yr.Z)((0,M.Z)(e),"isLine2",!0),e}return(0,z.Z)(n)}(Oi),ji=["points","color","vertexColors","lineWidth","dashed"],qi=o.forwardRef((function(e,t){var n=e.points,r=e.color,i=void 0===r?"black":r,a=e.vertexColors,s=e.lineWidth,u=e.dashed,l=(0,m.Z)(e,ji),c=o.useState((function(){return new Qi})),I=(0,g.Z)(c,1)[0],C=o.useState((function(){return new Ui})),h=(0,g.Z)(C,1)[0],f=o.useState((function(){return new d.Vector2(512,512)})),p=(0,g.Z)(f,1)[0],A=o.useMemo((function(){var e=new Ji,t=n.map((function(e){return e instanceof d.Vector3?e.toArray():e}));if(e.setPositions(t.flat()),a){var r=a.map((function(e){return e instanceof d.Color?e.toArray():e}));e.setColors(r.flat())}return e}),[n,a]);return o.useLayoutEffect((function(){I.computeLineDistances()}),[n,I]),o.useLayoutEffect((function(){u?h.defines.USE_DASH="":delete h.defines.USE_DASH,h.needsUpdate=!0}),[u,h]),o.useEffect((function(){return function(){return A.dispose()}}),[A]),o.createElement("primitive",(0,v.Z)({object:I,ref:t},l),o.createElement("primitive",{object:A,attach:"geometry"}),o.createElement("primitive",(0,v.Z)({object:h,attach:"material",color:i,vertexColors:Boolean(a),resolution:p,linewidth:s,dashed:u},l)))})),$i=["start","end","mid","segments"],ea=new d.Vector3,ta=o.forwardRef((function(e,t){var n=e.start,r=void 0===n?[0,0,0]:n,i=e.end,s=void 0===i?[0,0,0]:i,u=e.mid,l=e.segments,c=void 0===l?20:l,I=(0,m.Z)(e,$i),C=o.useRef(null),h=o.useState((function(){return new d.QuadraticBezierCurve3(void 0,void 0,void 0)})),f=(0,g.Z)(h,1)[0],p=o.useCallback((function(e,t,n){var r,i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20;return e instanceof d.Vector3?f.v0.copy(e):(r=f.v0).set.apply(r,(0,a.Z)(e)),t instanceof d.Vector3?f.v2.copy(t):(i=f.v2).set.apply(i,(0,a.Z)(t)),n instanceof d.Vector3?f.v1.copy(n):f.v1.copy(f.v0.clone().add(f.v2.clone().sub(f.v0)).add(ea.set(0,f.v0.y-f.v2.y,0))),f.getPoints(o)}),[]);o.useLayoutEffect((function(){C.current.setPoints=function(e,t,n){var r=p(e,t,n);C.current.geometry&&C.current.geometry.setPositions(r.map((function(e){return e.toArray()})).flat())}}),[]);var A=o.useMemo((function(){return p(r,s,u,c)}),[r,s,u,c]);return o.createElement(qi,(0,v.Z)({ref:(0,y.default)([C,t]),points:A},I))})),na=["start","end","midA","midB","segments"],ra=o.forwardRef((function(e,t){var n=e.start,r=e.end,i=e.midA,s=e.midB,u=e.segments,l=void 0===u?20:u,c=(0,m.Z)(e,na),g=o.useMemo((function(){var e=n instanceof d.Vector3?n:(0,X.Z)(d.Vector3,(0,a.Z)(n)),t=r instanceof d.Vector3?r:(0,X.Z)(d.Vector3,(0,a.Z)(r)),o=i instanceof d.Vector3?i:(0,X.Z)(d.Vector3,(0,a.Z)(i)),u=s instanceof d.Vector3?s:(0,X.Z)(d.Vector3,(0,a.Z)(s));return new d.CubicBezierCurve3(e,o,u,t).getPoints(l)}),[n,r,i,s,l]);return o.createElement(qi,(0,v.Z)({ref:t,points:g},c))})),ia=["url","distance","loop","autoplay"],aa=o.forwardRef((function(e,t){var n=e.url,r=e.distance,i=void 0===r?1:r,a=e.loop,u=void 0===a||a,l=e.autoplay,c=(0,m.Z)(e,ia),I=o.useRef(),C=(0,s.useThree)((function(e){return e.camera})),h=o.useState((function(){return new d.AudioListener})),f=(0,g.Z)(h,1)[0],p=(0,s.useLoader)(d.AudioLoader,n);return o.useEffect((function(){var e=I.current;e&&(e.setBuffer(p),e.setRefDistance(i),e.setLoop(u),l&&!e.isPlaying&&e.play())}),[p,C,i,u]),o.useEffect((function(){var e=I.current;return C.add(f),function(){C.remove(f),e&&(e.isPlaying&&e.stop(),e.source&&e.source._connected&&e.disconnect())}}),[]),o.createElement("positionalAudio",(0,v.Z)({ref:(0,y.default)([I,t]),args:[f]},c))}));function oa(){var e,t=0,n=[],r=0,i=0;var a=d((function(e){i||s(1,e)})),o=d((function(e){i||s(-1,e)}));function s(n,r){i++;var a=0;try{r===h&&I();var o=n>0&&g(r);o?o.call(r,d((function(e){a++,s(1,e)})),d((function(e){a++,s(-1,e)}))):(t=n,e=r,u())}catch(Ic){t||a||s(-1,Ic)}}function u(){r||(setTimeout(l,0),r=1)}function l(){var e=n;r=0,n=[],e.forEach(c)}function c(e){e()}function g(e){var t=e&&(C(e)||"object"===typeof e)&&e.then;return C(t)&&t}function d(e){var t=0;return function(){for(var n=[],r=arguments.length;r--;)n[r]=arguments[r];t++||e.apply(this,n)}}function I(){throw new TypeError("Chaining cycle detected")}var C=function(e){return"function"===typeof e},h={then:function(r,i){var a=oa();return n.push((function(){var n=t>0?r:i;if(C(n))try{var o=n(e);o===a&&I();var s=g(o);s?s.call(o,a.resolve,a.reject):a.resolve(o)}catch(u){a.reject(u)}else a[t>0?"resolve":"reject"](e)})),t&&u(),a},resolve:a,reject:o};return h}function sa(){var e,t,n=new Promise((function(n,r){e=n,t=r}));return{then:n.then.bind(n),resolve:e,reject:t}}oa.all=sa.all=function(e){var t=0,n=[],r=ua();return 0===e.length?r.resolve([]):e.forEach((function(i,a){var o=ua();o.resolve(i),o.then((function(i){t++,n[a]=i,t===e.length&&r.resolve(n)}),r.reject)})),r};var ua="function"===typeof Promise?sa:oa;function la(){var e=Object.create(null);function t(r,i){var a=r.id,o=r.name,s=r.dependencies;void 0===s&&(s=[]);var u=r.init;void 0===u&&(u=function(){});var l=r.getTransferables;if(void 0===l&&(l=null),!e[a])try{s=s.map((function(n){return n&&n.isWorkerModule&&(t(n,(function(e){if(e instanceof Error)throw e})),n=e[n.id].value),n})),u=n("<"+o+">.init",u),l&&(l=n("<"+o+">.getTransferables",l));var c=null;"function"===typeof u?c=u.apply(void 0,s):console.error("worker module init function failed to rehydrate"),e[a]={id:a,value:c,getTransferables:l},i(c)}catch(g){g&&g.noLog||console.error(g),i(g)}}function n(e,t){var n=void 0;self.troikaDefine=function(e){return n=e};var r=URL.createObjectURL(new Blob(["/** "+e.replace(/\*/g,"")+" **/\n\ntroikaDefine(\n"+t+"\n)"],{type:"application/javascript"}));try{importScripts(r)}catch(i){console.error(i)}return URL.revokeObjectURL(r),delete self.troikaDefine,n}self.addEventListener("message",(function(n){var r=n.data,i=r.messageId,a=r.action,o=r.data;try{"registerModule"===a&&t(o,(function(e){e instanceof Error?postMessage({messageId:i,success:!1,error:e.message}):postMessage({messageId:i,success:!0,result:{isCallable:"function"===typeof e}})})),"callModule"===a&&function(t,n){var r,i=t.id,a=t.args;e[i]&&"function"===typeof e[i].value||n(new Error("Worker module "+i+": not found or its 'init' did not return a function"));try{var o=(r=e[i]).value.apply(r,a);o&&"function"===typeof o.then?o.then(s,(function(e){return n(e instanceof Error?e:new Error(""+e))})):s(o)}catch(u){n(u)}function s(t){try{var r=e[i].getTransferables&&e[i].getTransferables(t);r&&Array.isArray(r)&&r.length||(r=void 0),n(t,r)}catch(u){console.error(u),n(u)}}}(o,(function(e,t){e instanceof Error?postMessage({messageId:i,success:!1,error:e.message}):postMessage({messageId:i,success:!0,result:e},t||void 0)}))}catch(s){postMessage({messageId:i,success:!1,error:s.stack})}}))}var ca=function(){var e=!1;if("undefined"!==typeof window&&"undefined"!==typeof window.document)try{new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"}))).terminate(),e=!0}catch(t){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return ca=function(){return e},e},ga=0,da=0,Ia=!1,Ca=Object.create(null),ha=Object.create(null),fa=Object.create(null);function pa(e){if((!e||"function"!==typeof e.init)&&!Ia)throw new Error("requires `options.init` function");var t=e.dependencies,n=e.init,r=e.getTransferables,i=e.workerId;if(!ca())return function(e){var t=function e(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return e._getInitResult().then((function(e){if("function"===typeof e)return e.apply(void 0,t);throw new Error("Worker module function was called but `init` did not return a callable function")}))};return t._getInitResult=function(){var n=e.dependencies,r=e.init;n=Array.isArray(n)?n.map((function(e){return e&&e._getInitResult?e._getInitResult():e})):[];var i=ua.all(n).then((function(e){return r.apply(null,e)}));return t._getInitResult=function(){return i},i},t}(e);null==i&&(i="#default");var a="workerModule"+ ++ga,o=e.name||a,s=null;function u(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(!s){s=va(i,"registerModule",u.workerModuleData);var n=function e(){s=null,ha[i].delete(e)};(ha[i]||(ha[i]=new Set)).add(n)}return s.then((function(t){if(t.isCallable)return va(i,"callModule",{id:a,args:e});throw new Error("Worker module function was called but `init` did not return a callable function")}))}return t=t&&t.map((function(e){return"function"!==typeof e||e.workerModuleData||(Ia=!0,e=pa({workerId:i,name:"<"+o+"> function dependency: "+e.name,init:"function(){return (\n"+ma(e)+"\n)}"}),Ia=!1),e&&e.workerModuleData&&(e=e.workerModuleData),e})),u.workerModuleData={isWorkerModule:!0,id:a,name:o,dependencies:t,init:ma(n),getTransferables:r&&ma(r)},u}function Aa(e){ha[e]&&ha[e].forEach((function(e){e()})),Ca[e]&&(Ca[e].terminate(),delete Ca[e])}function ma(e){var t=e.toString();return!/^function/.test(t)&&/^\w+\s*\(/.test(t)&&(t="function "+t),t}function va(e,t,n){var r=ua(),i=++da;return fa[i]=function(e){e.success?r.resolve(e.result):r.reject(new Error("Error in worker "+t+" call: "+e.error))},function(e){var t=Ca[e];if(!t){var n=ma(la);(t=Ca[e]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+e.replace(/\*/g,"")+" **/\n\n;("+n+")()"],{type:"application/javascript"})))).onmessage=function(e){var t=e.data,n=t.messageId,r=fa[n];if(!r)throw new Error("WorkerModule response with empty or unknown messageId");delete fa[n],r(t)}}return t}(e).postMessage({messageId:i,action:t,data:n}),r}var ba=pa({name:"Thenable",dependencies:[ua],init:function(e){return e}});var ya=function(){var e=function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},n={},r={};n.L=1,r[1]="L",Object.keys(t).forEach((function(e,t){n[e]=1<<t+1,r[n[e]]=e})),Object.freeze(n);var i=n.LRI|n.RLI|n.FSI,a=n.L|n.R|n.AL,o=n.B|n.S|n.WS|n.ON|n.FSI|n.LRI|n.RLI|n.PDI,s=n.BN|n.RLE|n.LRE|n.RLO|n.LRO|n.PDF,u=n.S|n.WS|n.B|i|n.PDI|s,l=null;function c(e){return function(){if(!l){l=new Map;var e=function(e){if(t.hasOwnProperty(e)){var r=0;t[e].split(",").forEach((function(t){var i=t.split("+"),a=i[0],o=i[1];a=parseInt(a,36),o=o?parseInt(o,36):0,l.set(r+=a,n[e]);for(var s=0;s<o;s++)l.set(++r,n[e])}))}};for(var r in t)e(r)}}(),l.get(e.codePointAt(0))||n.L}var g,d,I,C="14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",h="6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye";function f(e,t){var n,r=0,i=new Map,a=t&&new Map;return e.split(",").forEach((function e(o){if(-1!==o.indexOf("+"))for(var s=+o;s--;)e(n);else{n=o;var u=o.split(">"),l=u[0],c=u[1];l=String.fromCodePoint(r+=parseInt(l,36)),c=String.fromCodePoint(r+=parseInt(c,36)),i.set(l,c),t&&a.set(c,l)}})),{map:i,reverseMap:a}}function p(){if(!g){var e=f(C,!0),t=e.map,n=e.reverseMap;g=t,d=n,I=f(h,!1).map}}function A(e){return p(),g.get(e)||null}function m(e){return p(),d.get(e)||null}function v(e){return p(),I.get(e)||null}var b=n.L,y=n.R,B=n.EN,G=n.ES,Z=n.ET,w=n.AN,_=n.CS,x=n.B,S=n.S,R=n.ON,M=n.BN,W=n.NSM,k=n.AL,V=n.LRO,F=n.RLO,E=n.LRE,X=n.RLE,H=n.PDF,L=n.LRI,z=n.RLI,N=n.FSI,Y=n.PDI;var T;function K(e){return function(){if(!T){var e=f("14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",!0),t=e.map;e.reverseMap.forEach((function(e,n){t.set(n,e)})),T=t}}(),T.get(e)||null}function D(e,t,n,r){var i=e.length;n=Math.max(0,null==n?0:+n),r=Math.min(i-1,null==r?i-1:+r);var a=[];return t.paragraphs.forEach((function(i){var o=Math.max(n,i.start),s=Math.min(r,i.end);if(o<s){for(var l=t.levels.slice(o,s+1),g=s;g>=o&&c(e[g])&u;g--)l[g]=i.level;for(var d=i.level,I=1/0,C=0;C<l.length;C++){var h=l[C];h>d&&(d=h),h<I&&(I=1|h)}for(var f=d;f>=I;f--)for(var p=0;p<l.length;p++)if(l[p]>=f){for(var A=p;p+1<l.length&&l[p+1]>=f;)p++;p>A&&a.push([A+n,p+n])}}})),a}function P(e,t,n,r){for(var i=D(e,t,n,r),a=[],o=0;o<e.length;o++)a[o]=o;return i.forEach((function(e){for(var t=e[0],n=e[1],r=a.slice(t,n+1),i=r.length;i--;)a[n-i]=r[i]})),a}return e.closingToOpeningBracket=m,e.getBidiCharType=c,e.getBidiCharTypeName=function(e){return r[c(e)]},e.getCanonicalBracket=v,e.getEmbeddingLevels=function(e,t){for(var n=new Uint32Array(e.length),r=0;r<e.length;r++)n[r]=c(e[r]);var l=new Map;function g(e,t){var r=n[e];n[e]=t,l.set(r,l.get(r)-1),r&o&&l.set(o,l.get(o)-1),l.set(t,(l.get(t)||0)+1),t&o&&l.set(o,(l.get(o)||0)+1)}for(var d=new Uint8Array(e.length),I=new Map,C=[],h=null,f=0;f<e.length;f++)h||C.push(h={start:f,end:e.length-1,level:"rtl"===t?1:"ltr"===t?0:Nt(f,!1)}),n[f]&x&&(h.end=f,h=null);for(var p=X|E|F|V|i|Y|H|x,T=function(e){return e+(1&e?1:2)},K=function(e){return e+(1&e?2:1)},D=0;D<C.length;D++){var P=[{_level:(h=C[D]).level,_override:0,_isolate:0}],U=void 0,O=0,J=0,Q=0;l.clear();for(var j=h.start;j<=h.end;j++){var q=n[j];if(U=P[P.length-1],l.set(q,(l.get(q)||0)+1),q&o&&l.set(o,(l.get(o)||0)+1),q&p)if(q&(X|E)){d[j]=U._level;var $=(q===X?K:T)(U._level);$<=125&&!O&&!J?P.push({_level:$,_override:0,_isolate:0}):O||J++}else if(q&(F|V)){d[j]=U._level;var ee=(q===F?K:T)(U._level);ee<=125&&!O&&!J?P.push({_level:ee,_override:q&F?y:b,_isolate:0}):O||J++}else if(q&i){q&N&&(q=1===Nt(j+1,!0)?z:L),d[j]=U._level,U._override&&g(j,U._override);var te=(q===z?K:T)(U._level);te<=125&&0===O&&0===J?(Q++,P.push({_level:te,_override:0,_isolate:1,_isolInitIndex:j})):O++}else if(q&Y){if(O>0)O--;else if(Q>0){for(J=0;!P[P.length-1]._isolate;)P.pop();var ne=P[P.length-1]._isolInitIndex;null!=ne&&(I.set(ne,j),I.set(j,ne)),P.pop(),Q--}U=P[P.length-1],d[j]=U._level,U._override&&g(j,U._override)}else q&H?(0===O&&(J>0?J--:!U._isolate&&P.length>1&&(P.pop(),U=P[P.length-1])),d[j]=U._level):q&x&&(d[j]=h.level);else d[j]=U._level,U._override&&q!==M&&g(j,U._override)}for(var re=[],ie=null,ae=h.start;ae<=h.end;ae++){var oe=n[ae];if(!(oe&s)){var se=d[ae],ue=oe&i,le=oe===Y;ie&&se===ie._level?(ie._end=ae,ie._endsWithIsolInit=ue):re.push(ie={_start:ae,_end:ae,_level:se,_startsWithPDI:le,_endsWithIsolInit:ue})}}for(var ce=[],ge=0;ge<re.length;ge++){var de=re[ge];if(!de._startsWithPDI||de._startsWithPDI&&!I.has(de._start)){for(var Ie=[ie=de],Ce=void 0;ie&&ie._endsWithIsolInit&&null!=(Ce=I.get(ie._end));)for(var he=ge+1;he<re.length;he++)if(re[he]._start===Ce){Ie.push(ie=re[he]);break}for(var fe=[],pe=0;pe<Ie.length;pe++)for(var Ae=Ie[pe],me=Ae._start;me<=Ae._end;me++)fe.push(me);for(var ve=d[fe[0]],be=h.level,ye=fe[0]-1;ye>=0;ye--)if(!(n[ye]&s)){be=d[ye];break}var Be=fe[fe.length-1],Ge=d[Be],Ze=h.level;if(!(n[Be]&i))for(var we=Be+1;we<=h.end;we++)if(!(n[we]&s)){Ze=d[we];break}ce.push({_seqIndices:fe,_sosType:Math.max(be,ve)%2?y:b,_eosType:Math.max(Ze,Ge)%2?y:b})}}for(var _e=0;_e<ce.length;_e++){var xe=ce[_e],Se=xe._seqIndices,Re=xe._sosType,Me=xe._eosType;if(l.get(W))for(var We=0;We<Se.length;We++){var ke=Se[We];if(n[ke]&W){for(var Ve=Re,Fe=We-1;Fe>=0;Fe--)if(!(n[Se[Fe]]&s)){Ve=n[Se[Fe]];break}g(ke,Ve&(i|Y)?R:Ve)}}if(l.get(B))for(var Ee=0;Ee<Se.length;Ee++){var Xe=Se[Ee];if(n[Xe]&B)for(var He=Ee-1;He>=-1;He--){var Le=-1===He?Re:n[Se[He]];if(Le&a){Le===k&&g(Xe,w);break}}}if(l.get(k))for(var ze=0;ze<Se.length;ze++){var Ne=Se[ze];n[Ne]&k&&g(Ne,y)}if(l.get(G)||l.get(_))for(var Ye=1;Ye<Se.length-1;Ye++){var Te=Se[Ye];if(n[Te]&(G|_)){for(var Ke=0,De=0,Pe=Ye-1;Pe>=0&&(Ke=n[Se[Pe]])&s;Pe--);for(var Ue=Ye+1;Ue<Se.length&&(De=n[Se[Ue]])&s;Ue++);Ke===De&&(n[Te]===G?Ke===B:Ke&(B|w))&&g(Te,Ke)}}if(l.get(B))for(var Oe=0;Oe<Se.length;Oe++){var Je=Se[Oe];if(n[Je]&B){for(var Qe=Oe-1;Qe>=0&&n[Se[Qe]]&(Z|s);Qe--)g(Se[Qe],B);for(var je=Oe+1;je<Se.length&&n[Se[je]]&(Z|s);je++)g(Se[je],B)}}if(l.get(Z)||l.get(G)||l.get(_))for(var qe=0;qe<Se.length;qe++){var $e=Se[qe];if(n[$e]&(Z|G|_)){g($e,R);for(var et=qe-1;et>=0&&n[Se[et]]&s;et--)g(Se[et],R);for(var tt=qe+1;tt<Se.length&&n[Se[tt]]&s;tt++)g(Se[tt],R)}}if(l.get(B))for(var nt=0,rt=Re;nt<Se.length;nt++){var it=Se[nt],at=n[it];at&B?rt===b&&g(it,b):at&a&&(rt=at)}if(l.get(o)){for(var ot=y|B|w,st=ot|b,ut=[],lt=[],ct=0;ct<Se.length;ct++)if(n[Se[ct]]&o){var gt=e[Se[ct]],dt=void 0;if(null!==A(gt)){if(!(lt.length<63))break;lt.push({char:gt,seqIndex:ct})}else if(null!==(dt=m(gt)))for(var It=lt.length-1;It>=0;It--){var Ct=lt[It].char;if(Ct===dt||Ct===m(v(gt))||A(v(Ct))===gt){ut.push([lt[It].seqIndex,ct]),lt.length=It;break}}}ut.sort((function(e,t){return e[0]-t[0]}));for(var ht=0;ht<ut.length;ht++){for(var ft=ut[ht],pt=ft[0],At=ft[1],mt=!1,vt=0,bt=pt+1;bt<At;bt++){var yt=Se[bt];if(n[yt]&st){mt=!0;var Bt=n[yt]&ot?y:b;if(Bt===Tt(yt)){vt=Bt;break}}}if(mt&&!vt){vt=Re;for(var Gt=pt-1;Gt>=0;Gt--){var Zt=Se[Gt];if(n[Zt]&st){var wt=n[Zt]&ot?y:b;vt=wt!==Tt(Zt)?wt:Tt(Zt);break}}}if(vt){if(n[Se[pt]]=n[Se[At]]=vt,vt!==Tt(Se[pt]))for(var _t=pt+1;_t<Se.length;_t++)if(!(n[Se[_t]]&s)){c(e[Se[_t]])&W&&(n[Se[_t]]=vt);break}if(vt!==Tt(Se[At]))for(var xt=At+1;xt<Se.length;xt++)if(!(n[Se[xt]]&s)){c(e[Se[xt]])&W&&(n[Se[xt]]=vt);break}}}for(var St=0;St<Se.length;St++)if(n[Se[St]]&o){for(var Rt=St,Mt=St,Wt=Re,kt=St-1;kt>=0;kt--){if(!(n[Se[kt]]&s)){Wt=n[Se[kt]]&ot?y:b;break}Rt=kt}for(var Vt=Me,Ft=St+1;Ft<Se.length;Ft++){if(!(n[Se[Ft]]&(o|s))){Vt=n[Se[Ft]]&ot?y:b;break}Mt=Ft}for(var Et=Rt;Et<=Mt;Et++)n[Se[Et]]=Wt===Vt?Wt:Tt(Se[Et]);St=Mt}}}for(var Xt=h.start;Xt<=h.end;Xt++){var Ht=d[Xt],Lt=n[Xt];if(1&Ht?Lt&(b|B|w)&&d[Xt]++:Lt&y?d[Xt]++:Lt&(w|B)&&(d[Xt]+=2),Lt&s&&(d[Xt]=0===Xt?h.level:d[Xt-1]),Xt===h.end||c(e[Xt])&(S|x))for(var zt=Xt;zt>=0&&c(e[zt])&u;zt--)d[zt]=h.level}}return{levels:d,paragraphs:C};function Nt(t,r){for(var a=t;a<e.length;a++){var o=n[a];if(o&(y|k))return 1;if(o&(x|b)||r&&o===Y)return 0;if(o&i){var s=Yt(a);a=-1===s?e.length:s}}return 0}function Yt(t){for(var r=1,a=t+1;a<e.length;a++){var o=n[a];if(o&x)break;if(o&Y){if(0===--r)return a}else o&i&&r++}return-1}function Tt(e){return 1&d[e]?y:b}},e.getMirroredCharacter=K,e.getMirroredCharactersMap=function(e,t,n,r){var i=e.length;n=Math.max(0,null==n?0:+n),r=Math.min(i-1,null==r?i-1:+r);for(var a=new Map,o=n;o<=r;o++)if(1&t[o]){var s=K(e[o]);null!==s&&a.set(o,s)}return a},e.getReorderSegments=D,e.getReorderedIndices=P,e.getReorderedString=function(e,t,n,r){var i=P(e,t,n,r),a=[].concat(e);return i.forEach((function(n,r){a[r]=(1&t.levels[n]?K(e[n]):null)||e[n]})),a.join("")},e.openingToClosingBracket=A,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return e},Ba=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Ga(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,(function(e,t){var n=d.ShaderChunk[t];return n?Ga(n):e}))}for(var Za=[],wa=0;wa<256;wa++)Za[wa]=(wa<16?"0":"")+wa.toString(16);var _a=Object.assign||function(){for(var e=arguments[0],t=1,n=arguments.length;t<n;t++){var r=arguments[t];if(r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e},xa=Date.now(),Sa=new WeakMap,Ra=new Map,Ma=1e10;function Wa(e,t){var n=function(e){var t=JSON.stringify(e,Va),n=Ea.get(t);null==n&&Ea.set(t,n=++Fa);return n}(t),r=Sa.get(e);if(r||Sa.set(e,r=Object.create(null)),r[n])return new r[n];var i="_onBeforeCompile".concat(n),a=function(r){e.onBeforeCompile.call(this,r);var a=this.customProgramCacheKey()+"|"+r.vertexShader+"|"+r.fragmentShader,o=Ra[a];if(!o){var s=function(e,t,n){var r=e.vertexShader,i=e.fragmentShader,a=t.vertexDefs,o=t.vertexMainIntro,s=t.vertexMainOutro,u=t.vertexTransform,l=t.fragmentDefs,c=t.fragmentMainIntro,g=t.fragmentMainOutro,d=t.fragmentColorTransform,I=t.customRewriter,C=t.timeUniform;a=a||"",o=o||"",s=s||"",l=l||"",c=c||"",g=g||"",(u||I)&&(r=Ga(r));(d||I)&&(i=Ga(i=i.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,"\n//!BEGIN_POST_CHUNK $1\n$&\n//!END_POST_CHUNK\n")));if(I){var h=I({vertexShader:r,fragmentShader:i});r=h.vertexShader,i=h.fragmentShader}if(d){var f=[];i=i.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,(function(e){return f.push(e),""})),g="".concat(d,"\n").concat(f.join("\n"),"\n").concat(g)}if(C){var p="\nuniform float ".concat(C,";\n");a=p+a,l=p+l}u&&(r="vec3 troika_position_".concat(n,";\nvec3 troika_normal_").concat(n,";\nvec2 troika_uv_").concat(n,";\n").concat(r,"\n"),a="".concat(a,"\nvoid troikaVertexTransform").concat(n,"(inout vec3 position, inout vec3 normal, inout vec2 uv) {\n  ").concat(u,"\n}\n"),o="\ntroika_position_".concat(n," = vec3(position);\ntroika_normal_").concat(n," = vec3(normal);\ntroika_uv_").concat(n," = vec2(uv);\ntroikaVertexTransform").concat(n,"(troika_position_").concat(n,", troika_normal_").concat(n,", troika_uv_").concat(n,");\n").concat(o,"\n"),r=r.replace(/\b(position|normal|uv)\b/g,(function(e,t,r,i){return/\battribute\s+vec[23]\s+$/.test(i.substr(0,r))?t:"troika_".concat(t,"_").concat(n)})));return r=ka(r,n,a,o,s),i=ka(i,n,l,c,g),{vertexShader:r,fragmentShader:i}}(r,t,n);o=Ra[a]=s}r.vertexShader=o.vertexShader,r.fragmentShader=o.fragmentShader,_a(r.uniforms,this.uniforms),t.timeUniform&&(r.uniforms[t.timeUniform]={get value(){return Date.now()-xa}}),this[i]&&this[i](r)},o=function(){return s(t.chained?e:e.clone())},s=function(r){var i=Object.create(r,u);return Object.defineProperty(i,"baseMaterial",{value:e}),Object.defineProperty(i,"id",{value:Ma++}),i.uuid=function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Za[255&e]+Za[e>>8&255]+Za[e>>16&255]+Za[e>>24&255]+"-"+Za[255&t]+Za[t>>8&255]+"-"+Za[t>>16&15|64]+Za[t>>24&255]+"-"+Za[63&n|128]+Za[n>>8&255]+"-"+Za[n>>16&255]+Za[n>>24&255]+Za[255&r]+Za[r>>8&255]+Za[r>>16&255]+Za[r>>24&255]).toUpperCase()}(),i.uniforms=_a({},r.uniforms,t.uniforms),i.defines=_a({},r.defines,t.defines),i.defines["TROIKA_DERIVED_MATERIAL_".concat(n)]="",i.extensions=_a({},r.extensions,t.extensions),i._listeners=void 0,i},u={constructor:{value:o},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return n}},onBeforeCompile:{get:function(){return a},set:function(e){this[i]=e}},copy:{writable:!0,configurable:!0,value:function(t){return e.copy.call(this,t),e.isShaderMaterial||e.isDerivedMaterial||(_a(this.extensions,t.extensions),_a(this.defines,t.defines),_a(this.uniforms,d.UniformsUtils.clone(t.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){var t=new e.constructor;return s(t).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){var n=this._depthMaterial;return n||((n=this._depthMaterial=Wa(e.isDerivedMaterial?e.getDepthMaterial():new d.MeshDepthMaterial({depthPacking:d.RGBADepthPacking}),t)).defines.IS_DEPTH_MATERIAL="",n.uniforms=this.uniforms),n}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){var n=this._distanceMaterial;return n||((n=this._distanceMaterial=Wa(e.isDerivedMaterial?e.getDistanceMaterial():new d.MeshDistanceMaterial,t)).defines.IS_DISTANCE_MATERIAL="",n.uniforms=this.uniforms),n}},dispose:{writable:!0,configurable:!0,value:function(){var t=this._depthMaterial,n=this._distanceMaterial;t&&t.dispose(),n&&n.dispose(),e.dispose.call(this)}}};return r[n]=o,new o}function ka(e,t,n,r,i){return(r||i||n)&&(e=e.replace(Ba,"\n".concat(n,"\nvoid troikaOrigMain").concat(t,"() {")),e+="\nvoid main() {\n  ".concat(r,"\n  troikaOrigMain").concat(t,"();\n  ").concat(i,"\n}")),e}function Va(e,t){return"uniforms"===e?void 0:"function"===typeof t?t.toString():t}var Fa=0,Ea=new Map;var Xa=null,Ha=new d.MeshStandardMaterial({color:16777215,side:d.DoubleSide});d.Mesh;function La(e){var t=16;function n(e,t,n,r,i,a,o){var s=1-o;return{x:s*s*e+2*s*o*n+o*o*i,y:s*s*t+2*s*o*r+o*o*a}}function r(e,t,n,r,i,a,o,s,u){var l=1-u;return{x:l*l*l*e+3*l*l*u*n+3*l*u*u*i+u*u*u*o,y:l*l*l*t+3*l*l*u*r+3*l*u*u*a+u*u*u*s}}function i(){return(self.performance||Date).now()}return function(a,o,s,u,l){for(var c,g,d,I,C,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,f=i(),p=new Uint8Array(a*o),A=u[2]-u[0],m=u[3]-u[1],v=e(u),b=/([MLQCZ])([^MLQCZ]*)/g;c=b.exec(s);){var y=c[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map((function(e){return parseFloat(e)}));switch(c[1]){case"M":I=g=y[0],C=d=y[1];break;case"L":y[0]===I&&y[1]===C||v.addLineSegment(I,C,I=y[0],C=y[1]);break;case"Q":for(var B={x:I,y:C},G=1;G<t;G++){var Z=n(I,C,y[0],y[1],y[2],y[3],G/15);v.addLineSegment(B.x,B.y,Z.x,Z.y),B=Z}I=y[2],C=y[3];break;case"C":for(var w={x:I,y:C},_=1;_<t;_++){var x=r(I,C,y[0],y[1],y[2],y[3],y[4],y[5],_/15);v.addLineSegment(w.x,w.y,x.x,x.y),w=x}I=y[4],C=y[5];break;case"Z":I===g&&C===d||v.addLineSegment(I,C,g,d)}}for(var S=0;S<a;S++)for(var R=0;R<o;R++){var M=v.findNearestSignedDistance(u[0]+A*(S+.5)/a,u[1]+m*(R+.5)/o,l),W=Math.pow(1-Math.abs(M)/l,h)/2;M<0&&(W=1-W),W=Math.max(0,Math.min(255,Math.round(255*W))),p[R*a+S]=W}return{textureData:p,timing:i()-f}}}function za(e){var t=!1,n=[];function r(){t&&(n.sort((function(e,t){return e.maxX-t.maxX})),t=!1)}function i(e,t,n,r,i,a){var o=i-n,s=a-r,u=o*o+s*s,l=u?Math.max(0,Math.min(1,((e-n)*o+(t-r)*s)/u)):0,c=e-(n+l*o),g=t-(r+l*s);return c*c+g*g}return{addLineSegment:function(e,r,i,a){var o={x0:e,y0:r,x1:i,y1:a,minX:Math.min(e,i),minY:Math.min(r,a),maxX:Math.max(e,i),maxY:Math.max(r,a)};n.push(o),t=!0},findNearestSignedDistance:function(e,t){r();for(var a=1/0,o=1/0,s=n.length;s--;){var u=n[s];if(u.maxX+o<=e)break;if(e+o>u.minX&&t-o<u.maxY&&t+o>u.minY){var l=i(e,t,u.x0,u.y0,u.x1,u.y1);l<a&&(a=l,o=Math.sqrt(a))}}return function(e,t){r();for(var i=!1,a=n.length;a--;){var o=n[a];if(o.maxX<=e)break;if(o.minY<t&&o.maxY>t)o.y0>t!==o.y1>t&&e<(o.x1-o.x0)*(t-o.y0)/(o.y1-o.y0)+o.x0&&(i=!i)}return i}(e,t)&&(o=-o),o}}}var Na=pa({name:"Typr Font Parser",dependencies:[function(){return"undefined"==typeof window&&(self.window=self),function(e){var t={parse:function(e){var n=t._bin,r=new Uint8Array(e);if("ttcf"==n.readASCII(r,0,4)){var i=4;n.readUshort(r,i),i+=2,n.readUshort(r,i),i+=2;var a=n.readUint(r,i);i+=4;for(var o=[],s=0;s<a;s++){var u=n.readUint(r,i);i+=4,o.push(t._readFont(r,u))}return o}return[t._readFont(r,0)]},_readFont:function(e,n){var r=t._bin,i=n;r.readFixed(e,n),n+=4;var a=r.readUshort(e,n);n+=2,r.readUshort(e,n),n+=2,r.readUshort(e,n),n+=2,r.readUshort(e,n),n+=2;for(var o=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],s={_data:e,_offset:i},u={},l=0;l<a;l++){var c=r.readASCII(e,n,4);n+=4,r.readUint(e,n),n+=4;var g=r.readUint(e,n);n+=4;var d=r.readUint(e,n);n+=4,u[c]={offset:g,length:d}}for(l=0;l<o.length;l++){var I=o[l];u[I]&&(s[I.trim()]=t[I.trim()].parse(e,u[I].offset,u[I].length,s))}return s},_tabOffset:function(e,n,r){for(var i=t._bin,a=i.readUshort(e,r+4),o=r+12,s=0;s<a;s++){var u=i.readASCII(e,o,4);o+=4,i.readUint(e,o),o+=4;var l=i.readUint(e,o);if(o+=4,i.readUint(e,o),o+=4,u==n)return l}return 0}};t._bin={readFixed:function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<8|e[t+3])/65540},readF2dot14:function(e,n){return t._bin.readShort(e,n)/16384},readInt:function(e,n){return t._bin._view(e).getInt32(n)},readInt8:function(e,n){return t._bin._view(e).getInt8(n)},readShort:function(e,n){return t._bin._view(e).getInt16(n)},readUshort:function(e,n){return t._bin._view(e).getUint16(n)},readUshorts:function(e,n,r){for(var i=[],a=0;a<r;a++)i.push(t._bin.readUshort(e,n+2*a));return i},readUint:function(e,n){return t._bin._view(e).getUint32(n)},readUint64:function(e,n){return 4294967296*t._bin.readUint(e,n)+t._bin.readUint(e,n+4)},readASCII:function(e,t,n){for(var r="",i=0;i<n;i++)r+=String.fromCharCode(e[t+i]);return r},readUnicode:function(e,t,n){for(var r="",i=0;i<n;i++){var a=e[t++]<<8|e[t++];r+=String.fromCharCode(a)}return r},_tdec:"undefined"!=typeof window&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(e,n,r){var i=t._bin._tdec;return i&&0==n&&r==e.length?i.decode(e):t._bin.readASCII(e,n,r)},readBytes:function(e,t,n){for(var r=[],i=0;i<n;i++)r.push(e[t+i]);return r},readASCIIArray:function(e,t,n){for(var r=[],i=0;i<n;i++)r.push(String.fromCharCode(e[t+i]));return r},_view:function(e){return e._dataView||(e._dataView=e.buffer?new DataView(e.buffer,e.byteOffset,e.byteLength):new DataView(new Uint8Array(e).buffer))}},t._lctf={},t._lctf.parse=function(e,n,r,i,a){var o=t._bin,s={},u=n;o.readFixed(e,n),n+=4;var l=o.readUshort(e,n);n+=2;var c=o.readUshort(e,n);n+=2;var g=o.readUshort(e,n);return n+=2,s.scriptList=t._lctf.readScriptList(e,u+l),s.featureList=t._lctf.readFeatureList(e,u+c),s.lookupList=t._lctf.readLookupList(e,u+g,a),s},t._lctf.readLookupList=function(e,n,r){var i=t._bin,a=n,o=[],s=i.readUshort(e,n);n+=2;for(var u=0;u<s;u++){var l=i.readUshort(e,n);n+=2;var c=t._lctf.readLookupTable(e,a+l,r);o.push(c)}return o},t._lctf.readLookupTable=function(e,n,r){var i=t._bin,a=n,o={tabs:[]};o.ltype=i.readUshort(e,n),n+=2,o.flag=i.readUshort(e,n),n+=2;var s=i.readUshort(e,n);n+=2;for(var u=o.ltype,l=0;l<s;l++){var c=i.readUshort(e,n);n+=2;var g=r(e,u,a+c,o);o.tabs.push(g)}return o},t._lctf.numOfOnes=function(e){for(var t=0,n=0;n<32;n++)0!=(e>>>n&1)&&t++;return t},t._lctf.readClassDef=function(e,n){var r=t._bin,i=[],a=r.readUshort(e,n);if(n+=2,1==a){var o=r.readUshort(e,n);n+=2;var s=r.readUshort(e,n);n+=2;for(var u=0;u<s;u++)i.push(o+u),i.push(o+u),i.push(r.readUshort(e,n)),n+=2}if(2==a){var l=r.readUshort(e,n);for(n+=2,u=0;u<l;u++)i.push(r.readUshort(e,n)),n+=2,i.push(r.readUshort(e,n)),n+=2,i.push(r.readUshort(e,n)),n+=2}return i},t._lctf.getInterval=function(e,t){for(var n=0;n<e.length;n+=3){var r=e[n],i=e[n+1];if(e[n+2],r<=t&&t<=i)return n}return-1},t._lctf.readCoverage=function(e,n){var r=t._bin,i={};i.fmt=r.readUshort(e,n),n+=2;var a=r.readUshort(e,n);return n+=2,1==i.fmt&&(i.tab=r.readUshorts(e,n,a)),2==i.fmt&&(i.tab=r.readUshorts(e,n,3*a)),i},t._lctf.coverageIndex=function(e,n){var r=e.tab;if(1==e.fmt)return r.indexOf(n);if(2==e.fmt){var i=t._lctf.getInterval(r,n);if(-1!=i)return r[i+2]+(n-r[i])}return-1},t._lctf.readFeatureList=function(e,n){var r=t._bin,i=n,a=[],o=r.readUshort(e,n);n+=2;for(var s=0;s<o;s++){var u=r.readASCII(e,n,4);n+=4;var l=r.readUshort(e,n);n+=2;var c=t._lctf.readFeatureTable(e,i+l);c.tag=u.trim(),a.push(c)}return a},t._lctf.readFeatureTable=function(e,n){var r=t._bin,i=n,a={},o=r.readUshort(e,n);n+=2,o>0&&(a.featureParams=i+o);var s=r.readUshort(e,n);n+=2,a.tab=[];for(var u=0;u<s;u++)a.tab.push(r.readUshort(e,n+2*u));return a},t._lctf.readScriptList=function(e,n){var r=t._bin,i=n,a={},o=r.readUshort(e,n);n+=2;for(var s=0;s<o;s++){var u=r.readASCII(e,n,4);n+=4;var l=r.readUshort(e,n);n+=2,a[u.trim()]=t._lctf.readScriptTable(e,i+l)}return a},t._lctf.readScriptTable=function(e,n){var r=t._bin,i=n,a={},o=r.readUshort(e,n);n+=2,a.default=t._lctf.readLangSysTable(e,i+o);var s=r.readUshort(e,n);n+=2;for(var u=0;u<s;u++){var l=r.readASCII(e,n,4);n+=4;var c=r.readUshort(e,n);n+=2,a[l.trim()]=t._lctf.readLangSysTable(e,i+c)}return a},t._lctf.readLangSysTable=function(e,n){var r=t._bin,i={};r.readUshort(e,n),n+=2,i.reqFeature=r.readUshort(e,n),n+=2;var a=r.readUshort(e,n);return n+=2,i.features=r.readUshorts(e,n,a),i},t.CFF={},t.CFF.parse=function(e,n,r){var i=t._bin;(e=new Uint8Array(e.buffer,n,r))[n=0],e[++n],e[++n],e[++n],n++;var a=[];n=t.CFF.readIndex(e,n,a);for(var o=[],s=0;s<a.length-1;s++)o.push(i.readASCII(e,n+a[s],a[s+1]-a[s]));n+=a[a.length-1];var u=[];n=t.CFF.readIndex(e,n,u);var l=[];for(s=0;s<u.length-1;s++)l.push(t.CFF.readDict(e,n+u[s],n+u[s+1]));n+=u[u.length-1];var c=l[0],g=[];n=t.CFF.readIndex(e,n,g);var d=[];for(s=0;s<g.length-1;s++)d.push(i.readASCII(e,n+g[s],g[s+1]-g[s]));if(n+=g[g.length-1],t.CFF.readSubrs(e,n,c),c.CharStrings){n=c.CharStrings,g=[],n=t.CFF.readIndex(e,n,g);var I=[];for(s=0;s<g.length-1;s++)I.push(i.readBytes(e,n+g[s],g[s+1]-g[s]));c.CharStrings=I}if(c.ROS){n=c.FDArray;var C=[];for(n=t.CFF.readIndex(e,n,C),c.FDArray=[],s=0;s<C.length-1;s++){var h=t.CFF.readDict(e,n+C[s],n+C[s+1]);t.CFF._readFDict(e,h,d),c.FDArray.push(h)}n+=C[C.length-1],n=c.FDSelect,c.FDSelect=[];var f=e[n];if(n++,3!=f)throw f;var p=i.readUshort(e,n);for(n+=2,s=0;s<p+1;s++)c.FDSelect.push(i.readUshort(e,n),e[n+2]),n+=3}return c.Encoding&&(c.Encoding=t.CFF.readEncoding(e,c.Encoding,c.CharStrings.length)),c.charset&&(c.charset=t.CFF.readCharset(e,c.charset,c.CharStrings.length)),t.CFF._readFDict(e,c,d),c},t.CFF._readFDict=function(e,n,r){var i;for(var a in n.Private&&(i=n.Private[1],n.Private=t.CFF.readDict(e,i,i+n.Private[0]),n.Private.Subrs&&t.CFF.readSubrs(e,i+n.Private.Subrs,n.Private)),n)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(a)&&(n[a]=r[n[a]-426+35])},t.CFF.readSubrs=function(e,n,r){var i=t._bin,a=[];n=t.CFF.readIndex(e,n,a);var o,s=a.length;o=s<1240?107:s<33900?1131:32768,r.Bias=o,r.Subrs=[];for(var u=0;u<a.length-1;u++)r.Subrs.push(i.readBytes(e,n+a[u],a[u+1]-a[u]))},t.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],t.CFF.glyphByUnicode=function(e,t){for(var n=0;n<e.charset.length;n++)if(e.charset[n]==t)return n;return-1},t.CFF.glyphBySE=function(e,n){return n<0||n>255?-1:t.CFF.glyphByUnicode(e,t.CFF.tableSE[n])},t.CFF.readEncoding=function(e,n,r){t._bin;var i=[".notdef"],a=e[n];if(n++,0!=a)throw"error: unknown encoding format: "+a;var o=e[n];n++;for(var s=0;s<o;s++)i.push(e[n+s]);return i},t.CFF.readCharset=function(e,n,r){var i=t._bin,a=[".notdef"],o=e[n];if(n++,0==o)for(var s=0;s<r;s++){var u=i.readUshort(e,n);n+=2,a.push(u)}else{if(1!=o&&2!=o)throw"error: format: "+o;for(;a.length<r;){u=i.readUshort(e,n),n+=2;var l=0;for(1==o?(l=e[n],n++):(l=i.readUshort(e,n),n+=2),s=0;s<=l;s++)a.push(u),u++}}return a},t.CFF.readIndex=function(e,n,r){var i=t._bin,a=i.readUshort(e,n)+1,o=e[n+=2];if(n++,1==o)for(var s=0;s<a;s++)r.push(e[n+s]);else if(2==o)for(s=0;s<a;s++)r.push(i.readUshort(e,n+2*s));else if(3==o)for(s=0;s<a;s++)r.push(16777215&i.readUint(e,n+3*s-1));else if(1!=a)throw"unsupported offset size: "+o+", count: "+a;return(n+=a*o)-1},t.CFF.getCharString=function(e,n,r){var i=t._bin,a=e[n],o=e[n+1];e[n+2],e[n+3],e[n+4];var s=1,u=null,l=null;a<=20&&(u=a,s=1),12==a&&(u=100*a+o,s=2),21<=a&&a<=27&&(u=a,s=1),28==a&&(l=i.readShort(e,n+1),s=3),29<=a&&a<=31&&(u=a,s=1),32<=a&&a<=246&&(l=a-139,s=1),247<=a&&a<=250&&(l=256*(a-247)+o+108,s=2),251<=a&&a<=254&&(l=256*-(a-251)-o-108,s=2),255==a&&(l=i.readInt(e,n+1)/65535,s=5),r.val=null!=l?l:"o"+u,r.size=s},t.CFF.readCharString=function(e,n,r){for(var i=n+r,a=t._bin,o=[];n<i;){var s=e[n],u=e[n+1];e[n+2],e[n+3],e[n+4];var l=1,c=null,g=null;s<=20&&(c=s,l=1),12==s&&(c=100*s+u,l=2),19!=s&&20!=s||(c=s,l=2),21<=s&&s<=27&&(c=s,l=1),28==s&&(g=a.readShort(e,n+1),l=3),29<=s&&s<=31&&(c=s,l=1),32<=s&&s<=246&&(g=s-139,l=1),247<=s&&s<=250&&(g=256*(s-247)+u+108,l=2),251<=s&&s<=254&&(g=256*-(s-251)-u-108,l=2),255==s&&(g=a.readInt(e,n+1)/65535,l=5),o.push(null!=g?g:"o"+c),n+=l}return o},t.CFF.readDict=function(e,n,r){for(var i=t._bin,a={},o=[];n<r;){var s=e[n],u=e[n+1];e[n+2],e[n+3],e[n+4];var l=1,c=null,g=null;if(28==s&&(g=i.readShort(e,n+1),l=3),29==s&&(g=i.readInt(e,n+1),l=5),32<=s&&s<=246&&(g=s-139,l=1),247<=s&&s<=250&&(g=256*(s-247)+u+108,l=2),251<=s&&s<=254&&(g=256*-(s-251)-u-108,l=2),255==s)throw g=i.readInt(e,n+1)/65535,l=5,"unknown number";if(30==s){var d=[];for(l=1;;){var I=e[n+l];l++;var C=I>>4,h=15&I;if(15!=C&&d.push(C),15!=h&&d.push(h),15==h)break}for(var f="",p=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],A=0;A<d.length;A++)f+=p[d[A]];g=parseFloat(f)}s<=21&&(c=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],l=1,12==s&&(c=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][u],l=2)),null!=c?(a[c]=1==o.length?o[0]:o,o=[]):o.push(g),n+=l}return a},t.cmap={},t.cmap.parse=function(e,n,r){e=new Uint8Array(e.buffer,n,r),n=0;var i=t._bin,a={};i.readUshort(e,n),n+=2;var o=i.readUshort(e,n);n+=2;var s=[];a.tables=[];for(var u=0;u<o;u++){var l=i.readUshort(e,n);n+=2;var c=i.readUshort(e,n);n+=2;var g=i.readUint(e,n);n+=4;var d="p"+l+"e"+c,I=s.indexOf(g);if(-1==I){var C;I=a.tables.length,s.push(g);var h=i.readUshort(e,g);0==h?C=t.cmap.parse0(e,g):4==h?C=t.cmap.parse4(e,g):6==h?C=t.cmap.parse6(e,g):12==h?C=t.cmap.parse12(e,g):console.debug("unknown format: "+h,l,c,g),a.tables.push(C)}if(null!=a[d])throw"multiple tables for one platform+encoding";a[d]=I}return a},t.cmap.parse0=function(e,n){var r=t._bin,i={};i.format=r.readUshort(e,n),n+=2;var a=r.readUshort(e,n);n+=2,r.readUshort(e,n),n+=2,i.map=[];for(var o=0;o<a-6;o++)i.map.push(e[n+o]);return i},t.cmap.parse4=function(e,n){var r=t._bin,i=n,a={};a.format=r.readUshort(e,n),n+=2;var o=r.readUshort(e,n);n+=2,r.readUshort(e,n),n+=2;var s=r.readUshort(e,n);n+=2;var u=s/2;a.searchRange=r.readUshort(e,n),n+=2,a.entrySelector=r.readUshort(e,n),n+=2,a.rangeShift=r.readUshort(e,n),n+=2,a.endCount=r.readUshorts(e,n,u),n+=2*u,n+=2,a.startCount=r.readUshorts(e,n,u),n+=2*u,a.idDelta=[];for(var l=0;l<u;l++)a.idDelta.push(r.readShort(e,n)),n+=2;for(a.idRangeOffset=r.readUshorts(e,n,u),n+=2*u,a.glyphIdArray=[];n<i+o;)a.glyphIdArray.push(r.readUshort(e,n)),n+=2;return a},t.cmap.parse6=function(e,n){var r=t._bin,i={};i.format=r.readUshort(e,n),n+=2,r.readUshort(e,n),n+=2,r.readUshort(e,n),n+=2,i.firstCode=r.readUshort(e,n),n+=2;var a=r.readUshort(e,n);n+=2,i.glyphIdArray=[];for(var o=0;o<a;o++)i.glyphIdArray.push(r.readUshort(e,n)),n+=2;return i},t.cmap.parse12=function(e,n){var r=t._bin,i={};i.format=r.readUshort(e,n),n+=2,n+=2,r.readUint(e,n),n+=4,r.readUint(e,n),n+=4;var a=r.readUint(e,n);n+=4,i.groups=[];for(var o=0;o<a;o++){var s=n+12*o,u=r.readUint(e,s+0),l=r.readUint(e,s+4),c=r.readUint(e,s+8);i.groups.push([u,l,c])}return i},t.glyf={},t.glyf.parse=function(e,t,n,r){for(var i=[],a=0;a<r.maxp.numGlyphs;a++)i.push(null);return i},t.glyf._parseGlyf=function(e,n){var r=t._bin,i=e._data,a=t._tabOffset(i,"glyf",e._offset)+e.loca[n];if(e.loca[n]==e.loca[n+1])return null;var o={};if(o.noc=r.readShort(i,a),a+=2,o.xMin=r.readShort(i,a),a+=2,o.yMin=r.readShort(i,a),a+=2,o.xMax=r.readShort(i,a),a+=2,o.yMax=r.readShort(i,a),a+=2,o.xMin>=o.xMax||o.yMin>=o.yMax)return null;if(o.noc>0){o.endPts=[];for(var s=0;s<o.noc;s++)o.endPts.push(r.readUshort(i,a)),a+=2;var u=r.readUshort(i,a);if(a+=2,i.length-a<u)return null;o.instructions=r.readBytes(i,a,u),a+=u;var l=o.endPts[o.noc-1]+1;for(o.flags=[],s=0;s<l;s++){var c=i[a];if(a++,o.flags.push(c),0!=(8&c)){var g=i[a];a++;for(var d=0;d<g;d++)o.flags.push(c),s++}}for(o.xs=[],s=0;s<l;s++){var I=0!=(2&o.flags[s]),C=0!=(16&o.flags[s]);I?(o.xs.push(C?i[a]:-i[a]),a++):C?o.xs.push(0):(o.xs.push(r.readShort(i,a)),a+=2)}for(o.ys=[],s=0;s<l;s++)I=0!=(4&o.flags[s]),C=0!=(32&o.flags[s]),I?(o.ys.push(C?i[a]:-i[a]),a++):C?o.ys.push(0):(o.ys.push(r.readShort(i,a)),a+=2);var h=0,f=0;for(s=0;s<l;s++)h+=o.xs[s],f+=o.ys[s],o.xs[s]=h,o.ys[s]=f}else{var p;o.parts=[];do{p=r.readUshort(i,a),a+=2;var A={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(o.parts.push(A),A.glyphIndex=r.readUshort(i,a),a+=2,1&p){var m=r.readShort(i,a);a+=2;var v=r.readShort(i,a);a+=2}else m=r.readInt8(i,a),a++,v=r.readInt8(i,a),a++;2&p?(A.m.tx=m,A.m.ty=v):(A.p1=m,A.p2=v),8&p?(A.m.a=A.m.d=r.readF2dot14(i,a),a+=2):64&p?(A.m.a=r.readF2dot14(i,a),a+=2,A.m.d=r.readF2dot14(i,a),a+=2):128&p&&(A.m.a=r.readF2dot14(i,a),a+=2,A.m.b=r.readF2dot14(i,a),a+=2,A.m.c=r.readF2dot14(i,a),a+=2,A.m.d=r.readF2dot14(i,a),a+=2)}while(32&p);if(256&p){var b=r.readUshort(i,a);for(a+=2,o.instr=[],s=0;s<b;s++)o.instr.push(i[a]),a++}}return o},t.GPOS={},t.GPOS.parse=function(e,n,r,i){return t._lctf.parse(e,n,r,i,t.GPOS.subt)},t.GPOS.subt=function(e,n,r,i){var a=t._bin,o=r,s={};if(s.fmt=a.readUshort(e,r),r+=2,1==n||2==n||3==n||7==n||8==n&&s.fmt<=2){var u=a.readUshort(e,r);r+=2,s.coverage=t._lctf.readCoverage(e,u+o)}if(1==n&&1==s.fmt){var l=a.readUshort(e,r);r+=2;var c=t._lctf.numOfOnes(l);0!=l&&(s.pos=t.GPOS.readValueRecord(e,r,l))}else if(2==n&&s.fmt>=1&&s.fmt<=2){l=a.readUshort(e,r),r+=2;var g=a.readUshort(e,r);r+=2,c=t._lctf.numOfOnes(l);var d=t._lctf.numOfOnes(g);if(1==s.fmt){s.pairsets=[];var I=a.readUshort(e,r);r+=2;for(var C=0;C<I;C++){var h=o+a.readUshort(e,r);r+=2;var f=a.readUshort(e,h);h+=2;for(var p=[],A=0;A<f;A++){var m=a.readUshort(e,h);h+=2,0!=l&&(Z=t.GPOS.readValueRecord(e,h,l),h+=2*c),0!=g&&(w=t.GPOS.readValueRecord(e,h,g),h+=2*d),p.push({gid2:m,val1:Z,val2:w})}s.pairsets.push(p)}}if(2==s.fmt){var v=a.readUshort(e,r);r+=2;var b=a.readUshort(e,r);r+=2;var y=a.readUshort(e,r);r+=2;var B=a.readUshort(e,r);for(r+=2,s.classDef1=t._lctf.readClassDef(e,o+v),s.classDef2=t._lctf.readClassDef(e,o+b),s.matrix=[],C=0;C<y;C++){var G=[];for(A=0;A<B;A++){var Z=null,w=null;0!=l&&(Z=t.GPOS.readValueRecord(e,r,l),r+=2*c),0!=g&&(w=t.GPOS.readValueRecord(e,r,g),r+=2*d),G.push({val1:Z,val2:w})}s.matrix.push(G)}}}else{if(9==n&&1==s.fmt){var _=a.readUshort(e,r);r+=2;var x=a.readUint(e,r);if(r+=4,9==i.ltype)i.ltype=_;else if(i.ltype!=_)throw"invalid extension substitution";return t.GPOS.subt(e,i.ltype,o+x)}console.debug("unsupported GPOS table LookupType",n,"format",s.fmt)}return s},t.GPOS.readValueRecord=function(e,n,r){var i=t._bin,a=[];return a.push(1&r?i.readShort(e,n):0),n+=1&r?2:0,a.push(2&r?i.readShort(e,n):0),n+=2&r?2:0,a.push(4&r?i.readShort(e,n):0),n+=4&r?2:0,a.push(8&r?i.readShort(e,n):0),n+=8&r?2:0,a},t.GSUB={},t.GSUB.parse=function(e,n,r,i){return t._lctf.parse(e,n,r,i,t.GSUB.subt)},t.GSUB.subt=function(e,n,r,i){var a=t._bin,o=r,s={};if(s.fmt=a.readUshort(e,r),r+=2,1!=n&&4!=n&&5!=n&&6!=n)return null;if(1==n||4==n||5==n&&s.fmt<=2||6==n&&s.fmt<=2){var u=a.readUshort(e,r);r+=2,s.coverage=t._lctf.readCoverage(e,o+u)}if(1==n&&s.fmt>=1&&s.fmt<=2){if(1==s.fmt)s.delta=a.readShort(e,r),r+=2;else if(2==s.fmt){var l=a.readUshort(e,r);r+=2,s.newg=a.readUshorts(e,r,l),r+=2*s.newg.length}}else if(4==n){s.vals=[],l=a.readUshort(e,r),r+=2;for(var c=0;c<l;c++){var g=a.readUshort(e,r);r+=2,s.vals.push(t.GSUB.readLigatureSet(e,o+g))}}else if(5==n&&2==s.fmt){if(2==s.fmt){var d=a.readUshort(e,r);r+=2,s.cDef=t._lctf.readClassDef(e,o+d),s.scset=[];var I=a.readUshort(e,r);for(r+=2,c=0;c<I;c++){var C=a.readUshort(e,r);r+=2,s.scset.push(0==C?null:t.GSUB.readSubClassSet(e,o+C))}}}else if(6==n&&3==s.fmt){if(3==s.fmt){for(c=0;c<3;c++){l=a.readUshort(e,r),r+=2;for(var h=[],f=0;f<l;f++)h.push(t._lctf.readCoverage(e,o+a.readUshort(e,r+2*f)));r+=2*l,0==c&&(s.backCvg=h),1==c&&(s.inptCvg=h),2==c&&(s.ahedCvg=h)}l=a.readUshort(e,r),r+=2,s.lookupRec=t.GSUB.readSubstLookupRecords(e,r,l)}}else{if(7==n&&1==s.fmt){var p=a.readUshort(e,r);r+=2;var A=a.readUint(e,r);if(r+=4,9==i.ltype)i.ltype=p;else if(i.ltype!=p)throw"invalid extension substitution";return t.GSUB.subt(e,i.ltype,o+A)}console.debug("unsupported GSUB table LookupType",n,"format",s.fmt)}return s},t.GSUB.readSubClassSet=function(e,n){var r=t._bin.readUshort,i=n,a=[],o=r(e,n);n+=2;for(var s=0;s<o;s++){var u=r(e,n);n+=2,a.push(t.GSUB.readSubClassRule(e,i+u))}return a},t.GSUB.readSubClassRule=function(e,n){var r=t._bin.readUshort,i={},a=r(e,n),o=r(e,n+=2);n+=2,i.input=[];for(var s=0;s<a-1;s++)i.input.push(r(e,n)),n+=2;return i.substLookupRecords=t.GSUB.readSubstLookupRecords(e,n,o),i},t.GSUB.readSubstLookupRecords=function(e,n,r){for(var i=t._bin.readUshort,a=[],o=0;o<r;o++)a.push(i(e,n),i(e,n+2)),n+=4;return a},t.GSUB.readChainSubClassSet=function(e,n){var r=t._bin,i=n,a=[],o=r.readUshort(e,n);n+=2;for(var s=0;s<o;s++){var u=r.readUshort(e,n);n+=2,a.push(t.GSUB.readChainSubClassRule(e,i+u))}return a},t.GSUB.readChainSubClassRule=function(e,n){for(var r=t._bin,i={},a=["backtrack","input","lookahead"],o=0;o<a.length;o++){var s=r.readUshort(e,n);n+=2,1==o&&s--,i[a[o]]=r.readUshorts(e,n,s),n+=2*i[a[o]].length}return s=r.readUshort(e,n),n+=2,i.subst=r.readUshorts(e,n,2*s),n+=2*i.subst.length,i},t.GSUB.readLigatureSet=function(e,n){var r=t._bin,i=n,a=[],o=r.readUshort(e,n);n+=2;for(var s=0;s<o;s++){var u=r.readUshort(e,n);n+=2,a.push(t.GSUB.readLigature(e,i+u))}return a},t.GSUB.readLigature=function(e,n){var r=t._bin,i={chain:[]};i.nglyph=r.readUshort(e,n),n+=2;var a=r.readUshort(e,n);n+=2;for(var o=0;o<a-1;o++)i.chain.push(r.readUshort(e,n)),n+=2;return i},t.head={},t.head.parse=function(e,n,r){var i=t._bin,a={};return i.readFixed(e,n),n+=4,a.fontRevision=i.readFixed(e,n),n+=4,i.readUint(e,n),n+=4,i.readUint(e,n),n+=4,a.flags=i.readUshort(e,n),n+=2,a.unitsPerEm=i.readUshort(e,n),n+=2,a.created=i.readUint64(e,n),n+=8,a.modified=i.readUint64(e,n),n+=8,a.xMin=i.readShort(e,n),n+=2,a.yMin=i.readShort(e,n),n+=2,a.xMax=i.readShort(e,n),n+=2,a.yMax=i.readShort(e,n),n+=2,a.macStyle=i.readUshort(e,n),n+=2,a.lowestRecPPEM=i.readUshort(e,n),n+=2,a.fontDirectionHint=i.readShort(e,n),n+=2,a.indexToLocFormat=i.readShort(e,n),n+=2,a.glyphDataFormat=i.readShort(e,n),n+=2,a},t.hhea={},t.hhea.parse=function(e,n,r){var i=t._bin,a={};return i.readFixed(e,n),n+=4,a.ascender=i.readShort(e,n),n+=2,a.descender=i.readShort(e,n),n+=2,a.lineGap=i.readShort(e,n),n+=2,a.advanceWidthMax=i.readUshort(e,n),n+=2,a.minLeftSideBearing=i.readShort(e,n),n+=2,a.minRightSideBearing=i.readShort(e,n),n+=2,a.xMaxExtent=i.readShort(e,n),n+=2,a.caretSlopeRise=i.readShort(e,n),n+=2,a.caretSlopeRun=i.readShort(e,n),n+=2,a.caretOffset=i.readShort(e,n),n+=2,n+=8,a.metricDataFormat=i.readShort(e,n),n+=2,a.numberOfHMetrics=i.readUshort(e,n),n+=2,a},t.hmtx={},t.hmtx.parse=function(e,n,r,i){for(var a=t._bin,o={aWidth:[],lsBearing:[]},s=0,u=0,l=0;l<i.maxp.numGlyphs;l++)l<i.hhea.numberOfHMetrics&&(s=a.readUshort(e,n),n+=2,u=a.readShort(e,n),n+=2),o.aWidth.push(s),o.lsBearing.push(u);return o},t.kern={},t.kern.parse=function(e,n,r,i){var a=t._bin,o=a.readUshort(e,n);if(n+=2,1==o)return t.kern.parseV1(e,n-2,r,i);var s=a.readUshort(e,n);n+=2;for(var u={glyph1:[],rval:[]},l=0;l<s;l++){n+=2,r=a.readUshort(e,n),n+=2;var c=a.readUshort(e,n);n+=2;var g=c>>>8;if(0!=(g&=15))throw"unknown kern table format: "+g;n=t.kern.readFormat0(e,n,u)}return u},t.kern.parseV1=function(e,n,r,i){var a=t._bin;a.readFixed(e,n),n+=4;var o=a.readUint(e,n);n+=4;for(var s={glyph1:[],rval:[]},u=0;u<o;u++){a.readUint(e,n),n+=4;var l=a.readUshort(e,n);n+=2,a.readUshort(e,n),n+=2;var c=l>>>8;if(0!=(c&=15))throw"unknown kern table format: "+c;n=t.kern.readFormat0(e,n,s)}return s},t.kern.readFormat0=function(e,n,r){var i=t._bin,a=-1,o=i.readUshort(e,n);n+=2,i.readUshort(e,n),n+=2,i.readUshort(e,n),n+=2,i.readUshort(e,n),n+=2;for(var s=0;s<o;s++){var u=i.readUshort(e,n);n+=2;var l=i.readUshort(e,n);n+=2;var c=i.readShort(e,n);n+=2,u!=a&&(r.glyph1.push(u),r.rval.push({glyph2:[],vals:[]}));var g=r.rval[r.rval.length-1];g.glyph2.push(l),g.vals.push(c),a=u}return n},t.loca={},t.loca.parse=function(e,n,r,i){var a=t._bin,o=[],s=i.head.indexToLocFormat,u=i.maxp.numGlyphs+1;if(0==s)for(var l=0;l<u;l++)o.push(a.readUshort(e,n+(l<<1))<<1);if(1==s)for(l=0;l<u;l++)o.push(a.readUint(e,n+(l<<2)));return o},t.maxp={},t.maxp.parse=function(e,n,r){var i=t._bin,a={},o=i.readUint(e,n);return n+=4,a.numGlyphs=i.readUshort(e,n),n+=2,65536==o&&(a.maxPoints=i.readUshort(e,n),n+=2,a.maxContours=i.readUshort(e,n),n+=2,a.maxCompositePoints=i.readUshort(e,n),n+=2,a.maxCompositeContours=i.readUshort(e,n),n+=2,a.maxZones=i.readUshort(e,n),n+=2,a.maxTwilightPoints=i.readUshort(e,n),n+=2,a.maxStorage=i.readUshort(e,n),n+=2,a.maxFunctionDefs=i.readUshort(e,n),n+=2,a.maxInstructionDefs=i.readUshort(e,n),n+=2,a.maxStackElements=i.readUshort(e,n),n+=2,a.maxSizeOfInstructions=i.readUshort(e,n),n+=2,a.maxComponentElements=i.readUshort(e,n),n+=2,a.maxComponentDepth=i.readUshort(e,n),n+=2),a},t.name={},t.name.parse=function(e,n,r){var i=t._bin,a={};i.readUshort(e,n),n+=2;var o=i.readUshort(e,n);n+=2,i.readUshort(e,n);for(var s,u=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],l=n+=2,c=0;c<o;c++){var g=i.readUshort(e,n);n+=2;var d=i.readUshort(e,n);n+=2;var I=i.readUshort(e,n);n+=2;var C=i.readUshort(e,n);n+=2;var h=i.readUshort(e,n);n+=2;var f=i.readUshort(e,n);n+=2;var p,A=u[C],m=l+12*o+f;if(0==g)p=i.readUnicode(e,m,h/2);else if(3==g&&0==d)p=i.readUnicode(e,m,h/2);else if(0==d)p=i.readASCII(e,m,h);else if(1==d)p=i.readUnicode(e,m,h/2);else if(3==d)p=i.readUnicode(e,m,h/2);else{if(1!=g)throw"unknown encoding "+d+", platformID: "+g;p=i.readASCII(e,m,h),console.debug("reading unknown MAC encoding "+d+" as ASCII")}var v="p"+g+","+I.toString(16);null==a[v]&&(a[v]={}),a[v][void 0!==A?A:C]=p,a[v]._lang=I}for(var b in a)if(null!=a[b].postScriptName&&1033==a[b]._lang)return a[b];for(var b in a)if(null!=a[b].postScriptName&&0==a[b]._lang)return a[b];for(var b in a)if(null!=a[b].postScriptName&&3084==a[b]._lang)return a[b];for(var b in a)if(null!=a[b].postScriptName)return a[b];for(var b in a){s=b;break}return console.debug("returning name table with languageID "+a[s]._lang),a[s]},t["OS/2"]={},t["OS/2"].parse=function(e,n,r){var i=t._bin.readUshort(e,n);n+=2;var a={};if(0==i)t["OS/2"].version0(e,n,a);else if(1==i)t["OS/2"].version1(e,n,a);else if(2==i||3==i||4==i)t["OS/2"].version2(e,n,a);else{if(5!=i)throw"unknown OS/2 table version: "+i;t["OS/2"].version5(e,n,a)}return a},t["OS/2"].version0=function(e,n,r){var i=t._bin;return r.xAvgCharWidth=i.readShort(e,n),n+=2,r.usWeightClass=i.readUshort(e,n),n+=2,r.usWidthClass=i.readUshort(e,n),n+=2,r.fsType=i.readUshort(e,n),n+=2,r.ySubscriptXSize=i.readShort(e,n),n+=2,r.ySubscriptYSize=i.readShort(e,n),n+=2,r.ySubscriptXOffset=i.readShort(e,n),n+=2,r.ySubscriptYOffset=i.readShort(e,n),n+=2,r.ySuperscriptXSize=i.readShort(e,n),n+=2,r.ySuperscriptYSize=i.readShort(e,n),n+=2,r.ySuperscriptXOffset=i.readShort(e,n),n+=2,r.ySuperscriptYOffset=i.readShort(e,n),n+=2,r.yStrikeoutSize=i.readShort(e,n),n+=2,r.yStrikeoutPosition=i.readShort(e,n),n+=2,r.sFamilyClass=i.readShort(e,n),n+=2,r.panose=i.readBytes(e,n,10),n+=10,r.ulUnicodeRange1=i.readUint(e,n),n+=4,r.ulUnicodeRange2=i.readUint(e,n),n+=4,r.ulUnicodeRange3=i.readUint(e,n),n+=4,r.ulUnicodeRange4=i.readUint(e,n),n+=4,r.achVendID=[i.readInt8(e,n),i.readInt8(e,n+1),i.readInt8(e,n+2),i.readInt8(e,n+3)],n+=4,r.fsSelection=i.readUshort(e,n),n+=2,r.usFirstCharIndex=i.readUshort(e,n),n+=2,r.usLastCharIndex=i.readUshort(e,n),n+=2,r.sTypoAscender=i.readShort(e,n),n+=2,r.sTypoDescender=i.readShort(e,n),n+=2,r.sTypoLineGap=i.readShort(e,n),n+=2,r.usWinAscent=i.readUshort(e,n),n+=2,r.usWinDescent=i.readUshort(e,n),n+2},t["OS/2"].version1=function(e,n,r){var i=t._bin;return n=t["OS/2"].version0(e,n,r),r.ulCodePageRange1=i.readUint(e,n),n+=4,r.ulCodePageRange2=i.readUint(e,n),n+4},t["OS/2"].version2=function(e,n,r){var i=t._bin;return n=t["OS/2"].version1(e,n,r),r.sxHeight=i.readShort(e,n),n+=2,r.sCapHeight=i.readShort(e,n),n+=2,r.usDefault=i.readUshort(e,n),n+=2,r.usBreak=i.readUshort(e,n),n+=2,r.usMaxContext=i.readUshort(e,n),n+2},t["OS/2"].version5=function(e,n,r){var i=t._bin;return n=t["OS/2"].version2(e,n,r),r.usLowerOpticalPointSize=i.readUshort(e,n),n+=2,r.usUpperOpticalPointSize=i.readUshort(e,n),n+2},t.post={},t.post.parse=function(e,n,r){var i=t._bin,a={};return a.version=i.readFixed(e,n),n+=4,a.italicAngle=i.readFixed(e,n),n+=4,a.underlinePosition=i.readShort(e,n),n+=2,a.underlineThickness=i.readShort(e,n),n+=2,a},null==t&&(t={}),null==t.U&&(t.U={}),t.U.codeToGlyph=function(e,t){var n=e.cmap,r=-1;if(null!=n.p0e4?r=n.p0e4:null!=n.p3e1?r=n.p3e1:null!=n.p1e0?r=n.p1e0:null!=n.p0e3&&(r=n.p0e3),-1==r)throw"no familiar platform and encoding!";var i=n.tables[r];if(0==i.format)return t>=i.map.length?0:i.map[t];if(4==i.format){for(var a=-1,o=0;o<i.endCount.length;o++)if(t<=i.endCount[o]){a=o;break}return-1==a||i.startCount[a]>t?0:65535&(0!=i.idRangeOffset[a]?i.glyphIdArray[t-i.startCount[a]+(i.idRangeOffset[a]>>1)-(i.idRangeOffset.length-a)]:t+i.idDelta[a])}if(12==i.format){if(t>i.groups[i.groups.length-1][1])return 0;for(o=0;o<i.groups.length;o++){var s=i.groups[o];if(s[0]<=t&&t<=s[1])return s[2]+(t-s[0])}return 0}throw"unknown cmap table format "+i.format},t.U.glyphToPath=function(e,n){var r={cmds:[],crds:[]};if(e.SVG&&e.SVG.entries[n]){var i=e.SVG.entries[n];return null==i?r:("string"==typeof i&&(i=t.SVG.toPath(i),e.SVG.entries[n]=i),i)}if(e.CFF){var a={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:e.CFF.Private?e.CFF.Private.defaultWidthX:0,open:!1},o=e.CFF,s=e.CFF.Private;if(o.ROS){for(var u=0;o.FDSelect[u+2]<=n;)u+=2;s=o.FDArray[o.FDSelect[u+1]].Private}t.U._drawCFF(e.CFF.CharStrings[n],a,o,s,r)}else e.glyf&&t.U._drawGlyf(n,e,r);return r},t.U._drawGlyf=function(e,n,r){var i=n.glyf[e];null==i&&(i=n.glyf[e]=t.glyf._parseGlyf(n,e)),null!=i&&(i.noc>-1?t.U._simpleGlyph(i,r):t.U._compoGlyph(i,n,r))},t.U._simpleGlyph=function(e,n){for(var r=0;r<e.noc;r++){for(var i=0==r?0:e.endPts[r-1]+1,a=e.endPts[r],o=i;o<=a;o++){var s=o==i?a:o-1,u=o==a?i:o+1,l=1&e.flags[o],c=1&e.flags[s],g=1&e.flags[u],d=e.xs[o],I=e.ys[o];if(o==i)if(l){if(!c){t.U.P.moveTo(n,d,I);continue}t.U.P.moveTo(n,e.xs[s],e.ys[s])}else c?t.U.P.moveTo(n,e.xs[s],e.ys[s]):t.U.P.moveTo(n,(e.xs[s]+d)/2,(e.ys[s]+I)/2);l?c&&t.U.P.lineTo(n,d,I):g?t.U.P.qcurveTo(n,d,I,e.xs[u],e.ys[u]):t.U.P.qcurveTo(n,d,I,(d+e.xs[u])/2,(I+e.ys[u])/2)}t.U.P.closePath(n)}},t.U._compoGlyph=function(e,n,r){for(var i=0;i<e.parts.length;i++){var a={cmds:[],crds:[]},o=e.parts[i];t.U._drawGlyf(o.glyphIndex,n,a);for(var s=o.m,u=0;u<a.crds.length;u+=2){var l=a.crds[u],c=a.crds[u+1];r.crds.push(l*s.a+c*s.b+s.tx),r.crds.push(l*s.c+c*s.d+s.ty)}for(u=0;u<a.cmds.length;u++)r.cmds.push(a.cmds[u])}},t.U._getGlyphClass=function(e,n){var r=t._lctf.getInterval(n,e);return-1==r?0:n[r+2]},t.U.getPairAdjustment=function(e,n,r){var i=0;if(e.GPOS)for(var a=e.GPOS,o=a.lookupList,s=a.featureList,u=[],l=0;l<s.length;l++){var c=s[l];if("kern"==c.tag)for(var g=0;g<c.tab.length;g++)if(!u[c.tab[g]]){u[c.tab[g]]=!0;for(var d=o[c.tab[g]],I=0;I<d.tabs.length;I++)if(null!=d.tabs[I]){var C,h=d.tabs[I];if(!h.coverage||-1!=(C=t._lctf.coverageIndex(h.coverage,n)))if(1==d.ltype);else if(2==d.ltype){var f;if(1==h.fmt){var p=h.pairsets[C];for(l=0;l<p.length;l++)p[l].gid2==r&&(f=p[l])}else if(2==h.fmt){var A=t.U._getGlyphClass(n,h.classDef1),m=t.U._getGlyphClass(r,h.classDef2);f=h.matrix[A][m]}f&&f.val1&&f.val1[2]&&(i+=f.val1[2]),f&&f.val2&&f.val2[0]&&(i+=f.val2[0])}}}}if(e.kern){var v=e.kern.glyph1.indexOf(n);if(-1!=v){var b=e.kern.rval[v].glyph2.indexOf(r);-1!=b&&(i+=e.kern.rval[v].vals[b])}}return i},t.U._applySubs=function(e,n,r,i){for(var a=e.length-n-1,o=0;o<r.tabs.length;o++)if(null!=r.tabs[o]){var s,u=r.tabs[o];if(!u.coverage||-1!=(s=t._lctf.coverageIndex(u.coverage,e[n])))if(1==r.ltype)e[n],1==u.fmt?e[n]=e[n]+u.delta:e[n]=u.newg[s];else if(4==r.ltype)for(var l=u.vals[s],c=0;c<l.length;c++){var g=l[c],d=g.chain.length;if(!(d>a)){for(var I=!0,C=0,h=0;h<d;h++){for(;-1==e[n+C+(1+h)];)C++;g.chain[h]!=e[n+C+(1+h)]&&(I=!1)}if(I){for(e[n]=g.nglyph,h=0;h<d+C;h++)e[n+h+1]=-1;break}}}else if(5==r.ltype&&2==u.fmt)for(var f=t._lctf.getInterval(u.cDef,e[n]),p=u.cDef[f+2],A=u.scset[p],m=0;m<A.length;m++){var v=A[m],b=v.input;if(!(b.length>a)){for(I=!0,h=0;h<b.length;h++){var y=t._lctf.getInterval(u.cDef,e[n+1+h]);if(-1==f&&u.cDef[y+2]!=b[h]){I=!1;break}}if(I){var B=v.substLookupRecords;for(c=0;c<B.length;c+=2)B[c],B[c+1]}}}else if(6==r.ltype&&3==u.fmt){if(!t.U._glsCovered(e,u.backCvg,n-u.backCvg.length))continue;if(!t.U._glsCovered(e,u.inptCvg,n))continue;if(!t.U._glsCovered(e,u.ahedCvg,n+u.inptCvg.length))continue;var G=u.lookupRec;for(m=0;m<G.length;m+=2){f=G[m];var Z=i[G[m+1]];t.U._applySubs(e,n+f,Z,i)}}}},t.U._glsCovered=function(e,n,r){for(var i=0;i<n.length;i++)if(-1==t._lctf.coverageIndex(n[i],e[r+i]))return!1;return!0},t.U.glyphsToPath=function(e,n,r){for(var i={cmds:[],crds:[]},a=0,o=0;o<n.length;o++){var s=n[o];if(-1!=s){for(var u=o<n.length-1&&-1!=n[o+1]?n[o+1]:0,l=t.U.glyphToPath(e,s),c=0;c<l.crds.length;c+=2)i.crds.push(l.crds[c]+a),i.crds.push(l.crds[c+1]);for(r&&i.cmds.push(r),c=0;c<l.cmds.length;c++)i.cmds.push(l.cmds[c]);r&&i.cmds.push("X"),a+=e.hmtx.aWidth[s],o<n.length-1&&(a+=t.U.getPairAdjustment(e,s,u))}}return i},t.U.P={},t.U.P.moveTo=function(e,t,n){e.cmds.push("M"),e.crds.push(t,n)},t.U.P.lineTo=function(e,t,n){e.cmds.push("L"),e.crds.push(t,n)},t.U.P.curveTo=function(e,t,n,r,i,a,o){e.cmds.push("C"),e.crds.push(t,n,r,i,a,o)},t.U.P.qcurveTo=function(e,t,n,r,i){e.cmds.push("Q"),e.crds.push(t,n,r,i)},t.U.P.closePath=function(e){e.cmds.push("Z")},t.U._drawCFF=function(e,n,r,i,a){for(var o=n.stack,s=n.nStems,u=n.haveWidth,l=n.width,c=n.open,g=0,d=n.x,I=n.y,C=0,h=0,f=0,p=0,A=0,m=0,v=0,b=0,y=0,B=0,G={val:0,size:0};g<e.length;){t.CFF.getCharString(e,g,G);var Z=G.val;if(g+=G.size,"o1"==Z||"o18"==Z)o.length%2!=0&&!u&&(l=o.shift()+i.nominalWidthX),s+=o.length>>1,o.length=0,u=!0;else if("o3"==Z||"o23"==Z)o.length%2!=0&&!u&&(l=o.shift()+i.nominalWidthX),s+=o.length>>1,o.length=0,u=!0;else if("o4"==Z)o.length>1&&!u&&(l=o.shift()+i.nominalWidthX,u=!0),c&&t.U.P.closePath(a),I+=o.pop(),t.U.P.moveTo(a,d,I),c=!0;else if("o5"==Z)for(;o.length>0;)d+=o.shift(),I+=o.shift(),t.U.P.lineTo(a,d,I);else if("o6"==Z||"o7"==Z)for(var w=o.length,_="o6"==Z,x=0;x<w;x++){var S=o.shift();_?d+=S:I+=S,_=!_,t.U.P.lineTo(a,d,I)}else if("o8"==Z||"o24"==Z){w=o.length;for(var R=0;R+6<=w;)C=d+o.shift(),h=I+o.shift(),f=C+o.shift(),p=h+o.shift(),d=f+o.shift(),I=p+o.shift(),t.U.P.curveTo(a,C,h,f,p,d,I),R+=6;"o24"==Z&&(d+=o.shift(),I+=o.shift(),t.U.P.lineTo(a,d,I))}else{if("o11"==Z)break;if("o1234"==Z||"o1235"==Z||"o1236"==Z||"o1237"==Z)"o1234"==Z&&(h=I,f=(C=d+o.shift())+o.shift(),B=p=h+o.shift(),m=p,b=I,d=(v=(A=(y=f+o.shift())+o.shift())+o.shift())+o.shift(),t.U.P.curveTo(a,C,h,f,p,y,B),t.U.P.curveTo(a,A,m,v,b,d,I)),"o1235"==Z&&(C=d+o.shift(),h=I+o.shift(),f=C+o.shift(),p=h+o.shift(),y=f+o.shift(),B=p+o.shift(),A=y+o.shift(),m=B+o.shift(),v=A+o.shift(),b=m+o.shift(),d=v+o.shift(),I=b+o.shift(),o.shift(),t.U.P.curveTo(a,C,h,f,p,y,B),t.U.P.curveTo(a,A,m,v,b,d,I)),"o1236"==Z&&(C=d+o.shift(),h=I+o.shift(),f=C+o.shift(),B=p=h+o.shift(),m=p,v=(A=(y=f+o.shift())+o.shift())+o.shift(),b=m+o.shift(),d=v+o.shift(),t.U.P.curveTo(a,C,h,f,p,y,B),t.U.P.curveTo(a,A,m,v,b,d,I)),"o1237"==Z&&(C=d+o.shift(),h=I+o.shift(),f=C+o.shift(),p=h+o.shift(),y=f+o.shift(),B=p+o.shift(),A=y+o.shift(),m=B+o.shift(),v=A+o.shift(),b=m+o.shift(),Math.abs(v-d)>Math.abs(b-I)?d=v+o.shift():I=b+o.shift(),t.U.P.curveTo(a,C,h,f,p,y,B),t.U.P.curveTo(a,A,m,v,b,d,I));else if("o14"==Z){if(o.length>0&&!u&&(l=o.shift()+r.nominalWidthX,u=!0),4==o.length){var M=o.shift(),W=o.shift(),k=o.shift(),V=o.shift(),F=t.CFF.glyphBySE(r,k),E=t.CFF.glyphBySE(r,V);t.U._drawCFF(r.CharStrings[F],n,r,i,a),n.x=M,n.y=W,t.U._drawCFF(r.CharStrings[E],n,r,i,a)}c&&(t.U.P.closePath(a),c=!1)}else if("o19"==Z||"o20"==Z)o.length%2!=0&&!u&&(l=o.shift()+i.nominalWidthX),s+=o.length>>1,o.length=0,u=!0,g+=s+7>>3;else if("o21"==Z)o.length>2&&!u&&(l=o.shift()+i.nominalWidthX,u=!0),I+=o.pop(),d+=o.pop(),c&&t.U.P.closePath(a),t.U.P.moveTo(a,d,I),c=!0;else if("o22"==Z)o.length>1&&!u&&(l=o.shift()+i.nominalWidthX,u=!0),d+=o.pop(),c&&t.U.P.closePath(a),t.U.P.moveTo(a,d,I),c=!0;else if("o25"==Z){for(;o.length>6;)d+=o.shift(),I+=o.shift(),t.U.P.lineTo(a,d,I);C=d+o.shift(),h=I+o.shift(),f=C+o.shift(),p=h+o.shift(),d=f+o.shift(),I=p+o.shift(),t.U.P.curveTo(a,C,h,f,p,d,I)}else if("o26"==Z)for(o.length%2&&(d+=o.shift());o.length>0;)C=d,h=I+o.shift(),d=f=C+o.shift(),I=(p=h+o.shift())+o.shift(),t.U.P.curveTo(a,C,h,f,p,d,I);else if("o27"==Z)for(o.length%2&&(I+=o.shift());o.length>0;)h=I,f=(C=d+o.shift())+o.shift(),p=h+o.shift(),d=f+o.shift(),I=p,t.U.P.curveTo(a,C,h,f,p,d,I);else if("o10"==Z||"o29"==Z){var X="o10"==Z?i:r;if(0==o.length)console.debug("error: empty stack");else{var H=o.pop(),L=X.Subrs[H+X.Bias];n.x=d,n.y=I,n.nStems=s,n.haveWidth=u,n.width=l,n.open=c,t.U._drawCFF(L,n,r,i,a),d=n.x,I=n.y,s=n.nStems,u=n.haveWidth,l=n.width,c=n.open}}else if("o30"==Z||"o31"==Z){var z=o.length,N=(R=0,"o31"==Z);for(R+=z-(w=-3&z);R<w;)N?(h=I,f=(C=d+o.shift())+o.shift(),I=(p=h+o.shift())+o.shift(),w-R==5?(d=f+o.shift(),R++):d=f,N=!1):(C=d,h=I+o.shift(),f=C+o.shift(),p=h+o.shift(),d=f+o.shift(),w-R==5?(I=p+o.shift(),R++):I=p,N=!0),t.U.P.curveTo(a,C,h,f,p,d,I),R+=4}else{if("o"==(Z+"").charAt(0))throw console.debug("Unknown operation: "+Z,e),Z;o.push(Z)}}}n.x=d,n.y=I,n.nStems=s,n.haveWidth=u,n.width=l,n.open=c};var n=t,r={Typr:n};return e.Typr=n,e.default=r,Object.defineProperty(e,"__esModule",{value:!0}),e}({}).Typr},function(){return function(e){var t=Uint8Array,n=Uint16Array,r=Uint32Array,i=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(e,t){for(var i=new n(31),a=0;a<31;++a)i[a]=t+=1<<e[a-1];var o=new r(i[30]);for(a=1;a<30;++a)for(var s=i[a];s<i[a+1];++s)o[s]=s-i[a]<<5|a;return[i,o]},u=s(i,2),l=u[0],c=u[1];l[28]=258,c[258]=28;for(var g=s(a,0)[0],d=new n(32768),I=0;I<32768;++I){var C=(43690&I)>>>1|(21845&I)<<1;C=(61680&(C=(52428&C)>>>2|(13107&C)<<2))>>>4|(3855&C)<<4,d[I]=((65280&C)>>>8|(255&C)<<8)>>>1}var h=function(e,t,r){for(var i=e.length,a=0,o=new n(t);a<i;++a)++o[e[a]-1];var s,u=new n(t);for(a=0;a<t;++a)u[a]=u[a-1]+o[a-1]<<1;if(r){s=new n(1<<t);var l=15-t;for(a=0;a<i;++a)if(e[a])for(var c=a<<4|e[a],g=t-e[a],I=u[e[a]-1]++<<g,C=I|(1<<g)-1;I<=C;++I)s[d[I]>>>l]=c}else for(s=new n(i),a=0;a<i;++a)e[a]&&(s[a]=d[u[e[a]-1]++]>>>15-e[a]);return s},f=new t(288);for(I=0;I<144;++I)f[I]=8;for(I=144;I<256;++I)f[I]=9;for(I=256;I<280;++I)f[I]=7;for(I=280;I<288;++I)f[I]=8;var p=new t(32);for(I=0;I<32;++I)p[I]=5;var A=h(f,9,1),m=h(p,5,1),v=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},b=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},y=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},B=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],G=function e(t,n,r){var i=new Error(n||B[t]);if(i.code=t,Error.captureStackTrace&&Error.captureStackTrace(i,e),!r)throw i;return i},Z=function(e,s,u){var c=e.length;if(!c||u&&!u.l&&c<5)return s||new t(0);var d=!s||u,I=!u||u.i;u||(u={}),s||(s=new t(3*c));var C,f=function(e){var n=s.length;if(e>n){var r=new t(Math.max(2*n,e));r.set(s),s=r}},p=u.f||0,B=u.p||0,Z=u.b||0,w=u.l,_=u.d,x=u.m,S=u.n,R=8*c;do{if(!w){u.f=p=b(e,B,1);var M=b(e,B+1,3);if(B+=3,!M){var W=e[(T=((C=B)/8|0)+(7&C&&1)+4)-4]|e[T-3]<<8,k=T+W;if(k>c){I&&G(0);break}d&&f(Z+W),s.set(e.subarray(T,k),Z),u.b=Z+=W,u.p=B=8*k;continue}if(1==M)w=A,_=m,x=9,S=5;else if(2==M){var V=b(e,B,31)+257,F=b(e,B+10,15)+4,E=V+b(e,B+5,31)+1;B+=14;for(var X=new t(E),H=new t(19),L=0;L<F;++L)H[o[L]]=b(e,B+3*L,7);B+=3*F;var z=v(H),N=(1<<z)-1,Y=h(H,z,1);for(L=0;L<E;){var T,K=Y[b(e,B,N)];if(B+=15&K,(T=K>>>4)<16)X[L++]=T;else{var D=0,P=0;for(16==T?(P=3+b(e,B,3),B+=2,D=X[L-1]):17==T?(P=3+b(e,B,7),B+=3):18==T&&(P=11+b(e,B,127),B+=7);P--;)X[L++]=D}}var U=X.subarray(0,V),O=X.subarray(V);x=v(U),S=v(O),w=h(U,x,1),_=h(O,S,1)}else G(1);if(B>R){I&&G(0);break}}d&&f(Z+131072);for(var J=(1<<x)-1,Q=(1<<S)-1,j=B;;j=B){var q=(D=w[y(e,B)&J])>>>4;if((B+=15&D)>R){I&&G(0);break}if(D||G(2),q<256)s[Z++]=q;else{if(256==q){j=B,w=null;break}var $=q-254;if(q>264){var ee=i[L=q-257];$=b(e,B,(1<<ee)-1)+l[L],B+=ee}var te=_[y(e,B)&Q],ne=te>>>4;if(te||G(3),B+=15&te,O=g[ne],ne>3&&(ee=a[ne],O+=y(e,B)&(1<<ee)-1,B+=ee),B>R){I&&G(0);break}d&&f(Z+131072);for(var re=Z+$;Z<re;Z+=4)s[Z]=s[Z-O],s[Z+1]=s[Z+1-O],s[Z+2]=s[Z+2-O],s[Z+3]=s[Z+3-O];Z=re}}u.l=w,u.p=j,u.b=Z,w&&(p=1,u.m=x,u.d=_,u.n=S)}while(!p);return Z==s.length?s:function(e,i,a){(null==i||i<0)&&(i=0),(null==a||a>e.length)&&(a=e.length);var o=new(e instanceof n?n:e instanceof r?r:t)(a-i);return o.set(e.subarray(i,a)),o}(s,0,Z)},w=new t(0),_="undefined"!=typeof TextDecoder&&new TextDecoder;try{_.decode(w,{stream:!0})}catch(e){}return e.convert_streams=function(e){var t=new DataView(e),n=0;function r(){var e=t.getUint16(n);return n+=2,e}function i(){var e=t.getUint32(n);return n+=4,e}function a(e){p.setUint16(A,e),A+=2}function o(e){p.setUint32(A,e),A+=4}for(var s={signature:i(),flavor:i(),length:i(),numTables:r(),reserved:r(),totalSfntSize:i(),majorVersion:r(),minorVersion:r(),metaOffset:i(),metaLength:i(),metaOrigLength:i(),privOffset:i(),privLength:i()},u=0;Math.pow(2,u)<=s.numTables;)u++;u--;for(var l=16*Math.pow(2,u),c=16*s.numTables-l,g=12,d=[],I=0;I<s.numTables;I++)d.push({tag:i(),offset:i(),compLength:i(),origLength:i(),origChecksum:i()}),g+=16;var C,h=new Uint8Array(12+16*d.length+d.reduce((function(e,t){return e+t.origLength+4}),0)),f=h.buffer,p=new DataView(f),A=0;return o(s.flavor),a(s.numTables),a(l),a(u),a(c),d.forEach((function(e){o(e.tag),o(e.origChecksum),o(g),o(e.origLength),e.outOffset=g,(g+=e.origLength)%4!=0&&(g+=4-g%4)})),d.forEach((function(t){var n,r=e.slice(t.offset,t.offset+t.compLength);if(t.compLength!=t.origLength){var i=new Uint8Array(t.origLength);n=new Uint8Array(r,2),Z(n,i)}else i=new Uint8Array(r);h.set(i,t.outOffset);var a=0;(g=t.outOffset+t.origLength)%4!=0&&(a=4-g%4),h.set(new Uint8Array(a).buffer,t.outOffset+t.origLength),C=g+a})),f.slice(0,C)},Object.defineProperty(e,"__esModule",{value:!0}),e}({}).convert_streams},function(e,t){var n,r={M:2,L:2,Q:4,C:6,Z:0},i={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"};function a(e){return n||function(){var e={R:2,L:1,D:4,C:16,U:32,T:8};n=new Map;var t=function(t){var r=0;i[t].split(",").forEach((function(i){var a=i.split("+"),o=(0,g.Z)(a,2),s=o[0],u=o[1];s=parseInt(s,36),u=u?parseInt(u,36):0,n.set(r+=s,e[t]);for(var l=u;l--;)n.set(++r,e[t])}))};for(var r in i)t(r)}(),n.get(e)||32}var o=[null,"isol","init","fina","medi"];function s(e){for(var t=new Uint8Array(e.length),n=32,r=1,i=-1,o=0;o<e.length;o++){var s=e.codePointAt(o),u=0|a(s),l=1;8&u||(21&n?22&u?(l=3,1!==r&&3!==r||t[i]++):33&u&&(2!==r&&4!==r||t[i]--):34&n&&(2!==r&&4!==r||t[i]--),r=t[o]=l,n=u,i=o,s>65535&&o++)}return t}function u(t){var n=Object.create(null),i={unitsPerEm:t.head.unitsPerEm,ascender:t.hhea.ascender,descender:t.hhea.descender,forEachGlyph:function(a,u,l,c){var g=0,d=1/i.unitsPerEm*u,I=function(t,n){for(var r=[],i=0;i<n.length;i++){var a=n.codePointAt(i);a>65535&&i++,r.push(e.U.codeToGlyph(t,a))}var u=t.GSUB;if(u){var l,c=u.lookupList,g=u.featureList,d=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,I=[];g.forEach((function(t){if(d.test(t.tag))for(var i=0;i<t.tab.length;i++)if(!I[t.tab[i]]){I[t.tab[i]]=!0;var a=c[t.tab[i]],u=/^(isol|init|fina|medi)$/.test(t.tag);u&&!l&&(l=s(n));for(var g=0;g<r.length;g++)l&&u&&o[l[g]]!==t.tag||e.U._applySubs(r,g,a,c)}}))}return r}(t,a),C=0,h=-1;return I.forEach((function(i,o){if(-1!==i){var s=n[i];if(!s){for(var I,f,p,A,m=e.U.glyphToPath(t,i),v=m.cmds,b=m.crds,y="",B=0,G=0,Z=v.length;G<Z;G++){var w=r[v[G]];y+=v[G];for(var _=1;_<=w;_++)y+=(_>1?",":"")+b[B++]}if(b.length){I=f=1/0,p=A=-1/0;for(var x=0,S=b.length;x<S;x+=2){var R=b[x],M=b[x+1];R<I&&(I=R),M<f&&(f=M),R>p&&(p=R),M>A&&(A=M)}}else I=p=f=A=0;s=n[i]={index:i,advanceWidth:t.hmtx.aWidth[i],xMin:I,yMin:f,xMax:p,yMax:A,path:y,pathCommandCount:v.length}}-1!==h&&(g+=e.U.getPairAdjustment(t,h,i)*d),c.call(null,s,g,C),s.advanceWidth&&(g+=s.advanceWidth*d),l&&(g+=l*u),h=i}C+=a.codePointAt(C)>65535?2:1})),g}};return i}return function(n){var r=new Uint8Array(n,0,4),i=e._bin.readASCII(r,0,4);if("wOFF"===i)n=t(n);else if("wOF2"===i)throw new Error("woff2 fonts not supported");return u(e.parse(n)[0])}}],init:function(e,t,n){return n(e(),t())}}),Ya={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},Ta=new d.Color;function Ka(){return(self.performance||Date).now()}var Da,Pa=Object.create(null);function Ua(e,t){!0,e=Oa({},e);var n=Ka();if(e.font=function(e){Da||(Da="undefined"===typeof document?{}:document.createElement("a"));return Da.href=e,Da.href}(e.font||Ya.defaultFontURL),e.text=""+e.text,e.sdfGlyphSize=e.sdfGlyphSize||Ya.sdfGlyphSize,null!=e.colorRanges){var r={};for(var i in e.colorRanges)if(e.colorRanges.hasOwnProperty(i)){var a=e.colorRanges[i];"number"!==typeof a&&(a=Ta.set(a).getHex()),r[i]=a}e.colorRanges=r}Object.freeze(e);var o=Ya.textureWidth,s=Ya.sdfExponent,u=e.sdfGlyphSize,l="".concat(e.font,"@").concat(u),c=Pa[l];c||((c=Pa[l]={count:0,glyphs:new Map,sdfTexture:new d.DataTexture(new Uint8Array(u*o*4),o,u,d.RGBAFormat,void 0,void 0,void 0,void 0,d.LinearFilter,d.LinearFilter)}).sdfTexture.font=e.font),ja(e).then((function(r){var i=r.glyphIds,a=r.glyphPositions,o=r.fontSize,l=r.unitsPerEm,d=r.timings,I=[],C=new Float32Array(4*i.length),h=o/l,f=0,p=0,A=Ka();i.forEach((function(e,t){var n=c.glyphs.get(e);if(!n){var o=r.glyphData[e],s=o.path,l=o.pathBounds,g=Math.max(l[2]-l[0],l[3]-l[1])/u*(Ya.sdfMargin*u+.5),d=c.count++,A=[l[0]-g,l[1]-g,l[2]+g,l[3]+g];c.glyphs.set(e,n={path:s,atlasIndex:d,sdfViewBox:A}),I.push(n)}var m=n.sdfViewBox,v=a[p++],b=a[p++];C[f++]=v+m[0]*h,C[f++]=b+m[1]*h,C[f++]=v+m[2]*h,C[f++]=b+m[3]*h,i[t]=n.atlasIndex})),d.quads=(d.quads||0)+(Ka()-A);var m=Ka();d.sdf={},ua.all(I.map((function(e){var t=e.path,n=e.atlasIndex,r=e.sdfViewBox,i=Math.max(r[2]-r[0],r[3]-r[1]);return Qa(u,u,t,r,i,Ya.sdfExponent).then((function(e){var t=e.textureData,r=e.timing;return d.sdf[n]=r,{atlasIndex:n,textureData:t,timing:r}}))}))).then((function(a){a.length&&(a.forEach((function(e){for(var t=e.atlasIndex,n=e.textureData,r=(e.timing,c.sdfTexture.image);r.data.length<(t+1)*u*u;){var i=new Uint8Array(2*r.data.length);i.set(r.data),r.data=i,r.height*=2}for(var a=Math.floor(t/4),o=r.width/u,s=Math.floor(a/o)*r.width*u*4+a%o*u*4+t%4,l=0;l<u;l++)for(var g=l*u,d=s+l*r.width*4,I=0;I<u;I++)r.data[d+4*I]=n[g+I]})),c.sdfTexture.needsUpdate=!0),d.sdfTotal=Ka()-m,d.total=Ka()-n,t(Object.freeze({parameters:e,sdfTexture:c.sdfTexture,sdfGlyphSize:u,sdfExponent:s,glyphBounds:C,glyphAtlasIndices:i,glyphColors:r.glyphColors,caretPositions:r.caretPositions,caretHeight:r.caretHeight,chunkedBounds:r.chunkedBounds,ascender:r.ascender,descender:r.descender,lineHeight:r.lineHeight,topBaseline:r.topBaseline,blockBounds:r.blockBounds,visibleBounds:r.visibleBounds,timings:r.timings,get totalBounds(){return console.log("totalBounds deprecated, use blockBounds instead"),r.blockBounds},get totalBlockSize(){console.log("totalBlockSize deprecated, use blockBounds instead");var e=(0,g.Z)(r.blockBounds,4),t=e[0],n=e[1];return[e[2]-t,e[3]-n]}}))}))}))}function Oa(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var Ja=pa({name:"Typesetter",dependencies:[Ya,Na,function(e,t,n){var r=n.defaultFontURL,i=Object.create(null),a=1/0,o=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,s=/[\s\-\u007C\u00AD\u2010\u2012-\u2014\u2027\u2056\u2E17\u2E40]/;function u(t,n){t||(t=r);var a=i[t];a?a.pending?a.pending.push(n):n(a):(i[t]={pending:[n]},function(t,n){!function i(){var a=function(e){console.error("Failure loading font ".concat(t).concat(t===r?"":"; trying fallback"),e),t!==r&&(t=r,i())};try{var o=new XMLHttpRequest;o.open("get",t,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status>=400)a(new Error(o.statusText));else if(o.status>0)try{var t=e(o.response);n(t)}catch(Ic){a(Ic)}},o.onerror=a,o.send()}catch(s){a(s)}}()}(t,(function(e){var n=i[t].pending;i[t]=e,n.forEach((function(t){return t(e)}))})))}function l(e,n){var i=e.text,l=void 0===i?"":i,h=e.font,f=void 0===h?r:h,p=(e.sdfGlyphSize,e.fontSize),A=void 0===p?1:p,m=e.letterSpacing,v=void 0===m?0:m,b=e.lineHeight,y=void 0===b?"normal":b,B=e.maxWidth,G=void 0===B?a:B,Z=e.direction,w=e.textAlign,_=void 0===w?"left":w,x=e.textIndent,S=void 0===x?0:x,R=e.whiteSpace,M=void 0===R?"normal":R,W=e.overflowWrap,k=void 0===W?"normal":W,V=e.anchorX,F=void 0===V?0:V,E=e.anchorY,X=void 0===E?0:E,H=e.includeCaretPositions,L=void 0!==H&&H,z=e.chunkedBoundsSize,N=void 0===z?8192:z,Y=e.colorRanges,T=void 0===Y?null:Y,K=arguments.length>2&&void 0!==arguments[2]&&arguments[2],D=I(),P={fontLoad:0,typesetting:0};l.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),l=l.replace(/\r\n/g,"\n").replace(/\r/g,"\n")),A=+A,v=+v,G=+G,y=y||"normal",S=+S,u(f,(function(e){var r=isFinite(G),i=null,u=null,h=null,f=null,p=null,m=null,b=null,B=0,w=0,x="nowrap"!==M,R=e.ascender,W=e.descender,V=e.unitsPerEm;P.fontLoad=I()-D;var E=I(),H=A/V;"normal"===y&&(y=(R-W)/V);var z=((y*=A)-(R-W)*H)/2,Y=-(R*H+z),U=Math.min(y,(R-W)*H),O=(R+W)/2*H-U/2,J=S,Q=new C,j=[Q];e.forEachGlyph(l,A,v,(function(e,t,n){var i,a=l.charAt(n),u=e.advanceWidth*H,c=Q.count;if("isEmpty"in e||(e.isWhitespace=!!a&&/\s/.test(a),e.canBreakAfter=!!a&&s.test(a),e.isEmpty=e.xMin===e.xMax||e.yMin===e.yMax||o.test(a)),e.isWhitespace||e.isEmpty||w++,x&&r&&!e.isWhitespace&&t+u+J>G&&c){if(Q.glyphAt(c-1).glyphObj.canBreakAfter)i=new C,J=-t;else for(var g=c;g--;){if(0===g&&"break-word"===k){i=new C,J=-t;break}if(Q.glyphAt(g).glyphObj.canBreakAfter){var d=(i=Q.splitAt(g+1)).glyphAt(0).x;J-=d;for(var I=i.count;I--;)i.glyphAt(I).x-=d;break}}i&&(Q.isSoftWrapped=!0,Q=i,j.push(Q),B=G)}var h=Q.glyphAt(Q.count);h.glyphObj=e,h.x=t+J,h.width=u,h.charIndex=n,"\n"===a&&(Q=new C,j.push(Q),J=-(t+u+v*A)+S)})),j.forEach((function(e){for(var t=e.count;t--;){var n=e.glyphAt(t),r=n.glyphObj,i=n.x,a=n.width;if(!r.isWhitespace)return e.width=i+a,void(e.width>B&&(B=e.width))}}));var q=0,$=0;if(F&&("number"===typeof F?q=-F:"string"===typeof F&&(q=-B*("left"===F?0:"center"===F?.5:"right"===F?1:c(F)))),X)if("number"===typeof X)$=-X;else if("string"===typeof X){var ee=j.length*y;$="top"===X?0:"top-baseline"===X?-Y:"middle"===X?ee/2:"bottom"===X?ee:"bottom-baseline"===X?ee-z+W*H:c(X)*ee}if(!K){var te=t.getEmbeddingLevels(l,Z);i=new Uint16Array(w),u=new Float32Array(2*w),h={},m=[a,a,-1/0,-1/0],b=[];var ne=Y;L&&(p=new Float32Array(3*l.length)),T&&(f=new Uint8Array(3*w));var re,ie,ae=0,oe=-1,se=-1;if(j.forEach((function(n,r){var o=n.count,s=n.width;if(o>0){for(var c=0,I=o;I--&&n.glyphAt(I).glyphObj.isWhitespace;)c++;var C=0,A=0;if("center"===_)C=(B-s)/2;else if("right"===_)C=B-s;else if("justify"===_&&n.isSoftWrapped){for(var v=0,G=o-c;G--;)n.glyphAt(G).glyphObj.isWhitespace&&v++;A=(B-s)/v}if(A||C)for(var Z=0,w=0;w<o;w++){var x=n.glyphAt(w),S=x.glyphObj;x.x+=C+Z,0!==A&&S.isWhitespace&&w<o-c&&(Z+=A,x.width+=A)}for(var R,M=t.getReorderSegments(l,te,n.glyphAt(0).charIndex,n.glyphAt(n.count-1).charIndex),W=0;W<M.length;W++)for(var k=(0,g.Z)(M[W],2),V=k[0],F=k[1],E=1/0,X=-1/0,z=0;z<o;z++)if(n.glyphAt(z).charIndex>=V){for(var Y=z,K=z;K<o;K++){var D=n.glyphAt(K);if(D.charIndex>F)break;K<o-c&&(E=Math.min(E,D.x),X=Math.max(X,D.x+D.width))}for(var P=Y;P<K;P++){var U=n.glyphAt(P);U.x=X-(U.x+U.width-E)}break}for(var J=function(e){return R=e},Q=0;Q<o;Q++){var j=n.glyphAt(Q),ee=(R=j.glyphObj).index,ue=1&te.levels[j.charIndex];if(ue){var le=t.getMirroredCharacter(l[j.charIndex]);le&&e.forEachGlyph(le,0,0,J)}if(L){var ce=j.charIndex,ge=j.x+q,de=j.x+j.width+q;p[3*ce]=ue?de:ge,p[3*ce+1]=ue?ge:de,p[3*ce+2]=ne+O+$;var Ie=ce-oe;Ie>1&&d(p,oe,Ie),oe=ce}if(T)for(var Ce=j.charIndex;Ce>se;)se++,T.hasOwnProperty(se)&&(ie=T[se]);if(!R.isWhitespace&&!R.isEmpty){var he=ae++;h[ee]||(h[ee]={path:R.path,pathBounds:[R.xMin,R.yMin,R.xMax,R.yMax]});var fe=j.x+q,pe=ne+$;u[2*he]=fe,u[2*he+1]=pe;var Ae=fe+R.xMin*H,me=pe+R.yMin*H,ve=fe+R.xMax*H,be=pe+R.yMax*H;Ae<m[0]&&(m[0]=Ae),me<m[1]&&(m[1]=me),ve>m[2]&&(m[2]=ve),be>m[3]&&(m[3]=be),he%N===0&&(re={start:he,end:he,rect:[a,a,-1/0,-1/0]},b.push(re)),re.end++;var ye=re.rect;if(Ae<ye[0]&&(ye[0]=Ae),me<ye[1]&&(ye[1]=me),ve>ye[2]&&(ye[2]=ve),be>ye[3]&&(ye[3]=be),i[he]=ee,T){var Be=3*he;f[Be]=ie>>16&255,f[Be+1]=ie>>8&255,f[Be+2]=255&ie}}}}ne-=y})),p){var ue=l.length-oe;ue>1&&d(p,oe,ue)}}P.typesetting=I()-E,n({glyphIds:i,glyphPositions:u,glyphData:h,caretPositions:p,caretHeight:U,glyphColors:f,chunkedBounds:b,fontSize:A,unitsPerEm:V,ascender:R*H,descender:W*H,lineHeight:y,topBaseline:Y,blockBounds:[q,$-j.length*y,q+B,$],visibleBounds:m,timings:P})}))}function c(e){var t=e.match(/^([\d.]+)%$/),n=t?parseFloat(t[1]):NaN;return isNaN(n)?0:n/100}function d(e,t,n){for(var r=e[3*t],i=e[3*t+1],a=e[3*t+2],o=(i-r)/n,s=0;s<n;s++){var u=3*(t+s);e[u]=r+o*s,e[u+1]=r+o*(s+1),e[u+2]=a}}function I(){return(self.performance||Date).now()}function C(){this.data=[]}var h=["glyphObj","x","width","charIndex"];return C.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/h.length)},glyphAt:function(e){var t=C.flyweight;return t.data=this.data,t.index=e,t},splitAt:function(e){var t=new C;return t.data=this.data.splice(e*h.length),t}},C.flyweight=h.reduce((function(e,t,n,r){return Object.defineProperty(e,t,{get:function(){return this.data[this.index*h.length+n]},set:function(e){this.data[this.index*h.length+n]=e}}),e}),{data:null,index:0}),{typeset:l,measure:function(e,t){l(e,(function(e){var n=(0,g.Z)(e.blockBounds,4),r=n[0],i=n[1],a=n[2],o=n[3];t({width:a-r,height:o-i})}),{metricsOnly:!0})},loadFont:u}},ya],init:function(e,t,n,r){var i=e.defaultFontURL;return n(t,r(),{defaultFontURL:i})}}),Qa=function(){var e={},t=0;return function(){var n,r="TroikaTextSDFGenerator_"+t++%4,i=e[r];return i||(i=e[r]={workerModule:pa({name:r,workerId:r,dependencies:[Ya,za,La],init:function(e,t,n){return n(t,{sdfExponent:e.sdfExponent,sdfMargin:e.sdfMargin})},getTransferables:function(e){return[e.textureData.buffer]}}),requests:0,idleTimer:null}),i.requests++,clearTimeout(i.idleTimer),(n=i).workerModule.apply(n,arguments).then((function(e){return 0===--i.requests&&(i.idleTimer=setTimeout((function(){Aa(r)}),2e3)),e}))}}(),ja=pa({name:"Typesetter",dependencies:[Ja,ba],init:function(e,t){return function(n){var r=new t;return e.typeset(n,r.resolve),r}},getTransferables:function(e){var t=[e.glyphPositions.buffer,e.glyphIds.buffer];return e.caretPositions&&t.push(e.caretPositions.buffer),t}});var qa=function(){var e={};new d.Vector3;var t="aTroikaGlyphIndex",n=function(n){(0,V.Z)(o,n);var a=(0,F.Z)(o);function o(){var e;return(0,N.Z)(this,o),(e=a.call(this)).detail=1,e.curveRadius=0,e.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],e.boundingSphere=new d.Sphere,e.boundingBox=new d.Box3,e}return(0,z.Z)(o,[{key:"computeBoundingSphere",value:function(){}},{key:"computeBoundingBox",value:function(){}},{key:"detail",get:function(){return this._detail},set:function(t){var n=this;if(t!==this._detail){this._detail=t,("number"!==typeof t||t<1)&&(t=1);var r=function(t){var n=e[t];return n||(n=e[t]=new d.PlaneBufferGeometry(1,1,t,t).translate(.5,.5,0)),n}(t);["position","normal","uv"].forEach((function(e){n.attributes[e]=r.attributes[e].clone()})),this.setIndex(r.getIndex().clone())}}},{key:"curveRadius",get:function(){return this._curveRadius},set:function(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}},{key:"updateGlyphs",value:function(e,n,a,o,s){r(this,"aTroikaGlyphBounds",e,4),r(this,t,n,1),r(this,"aTroikaGlyphColor",s,3),this._blockBounds=a,this._chunkedBounds=o,i(this,n.length),this._updateBounds()}},{key:"_updateBounds",value:function(){var e=this._blockBounds;if(e){var t=this.curveRadius,n=this.boundingBox;if(t){var r=Math.PI,i=Math.floor,a=Math.min,o=Math.max,s=Math.sin,u=Math.cos,l=r/2,c=2*r,g=Math.abs(t),d=e[0]/g,I=e[2]/g,C=i((d+l)/c)!==i((I+l)/c)?-g:a(s(d)*g,s(I)*g),h=i((d-l)/c)!==i((I-l)/c)?g:o(s(d)*g,s(I)*g),f=i((d+r)/c)!==i((I+r)/c)?2*g:o(g-u(d)*g,g-u(I)*g);n.min.set(C,e[1],t<0?-f:0),n.max.set(h,e[3],t<0?0:f)}else n.min.set(e[0],e[1],0),n.max.set(e[2],e[3],0);n.getBoundingSphere(this.boundingSphere)}}},{key:"applyClipRect",value:function(e){var n=this.getAttribute(t).count,r=this._chunkedBounds;if(r)for(var a=r.length;a--;){n=r[a].end;var o=r[a].rect;if(o[1]<e.w&&o[3]>e.y&&o[0]<e.z&&o[2]>e.x)break}i(this,n)}}]),o}(d.InstancedBufferGeometry);function r(e,t,n,r){var i=e.getAttribute(t);n?i&&i.array.length===n.length?(i.array.set(n),i.needsUpdate=!0):(e.setAttribute(t,new d.InstancedBufferAttribute(n,r)),delete e._maxInstanceCount,e.dispose()):i&&e.deleteAttribute(t)}function i(e,t){e[e.hasOwnProperty("instanceCount")?"instanceCount":"maxInstancedCount"]=t}return n.prototype.setAttribute||(n.prototype.setAttribute=function(e,t){return this.attributes[e]=t,this}),n}(),$a="\nvec4 bounds = aTroikaGlyphBounds;\nbounds.xz += uTroikaPositionOffset.x;\nbounds.yw -= uTroikaPositionOffset.y;\n\nvec4 outlineBounds = vec4(\n  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,\n  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius\n);\nvec4 clippedBounds = vec4(\n  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),\n  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)\n);\n\nvec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);\n\nposition.xy = mix(bounds.xy, bounds.zw, clippedXY);\n\nuv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);\n\nfloat rad = uTroikaCurveRadius;\nif (rad != 0.0) {\n  float angle = position.x / rad;\n  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);\n  normal.xz = vec2(sin(angle), cos(angle));\n}\n  \nposition = uTroikaOrient * position;\nnormal = uTroikaOrient * normal;\n\nvTroikaGlyphUV = clippedXY.xy;\nvTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);\n\n".concat("\nfloat txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;\nvec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;\nvec2 txStartUV = txUvPerSquare * vec2(\n  mod(floor(aTroikaGlyphIndex / 4.0), txCols),\n  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)\n);\nvTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);\nvTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);\n"),eo="\nuniform sampler2D uTroikaSDFTexture;\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform float uTroikaSDFExponent;\nuniform float uTroikaDistanceOffset;\nuniform float uTroikaFillOpacity;\nuniform float uTroikaOutlineOpacity;\nuniform float uTroikaBlurRadius;\nuniform vec3 uTroikaStrokeColor;\nuniform float uTroikaStrokeWidth;\nuniform float uTroikaStrokeOpacity;\nuniform bool uTroikaSDFDebug;\nvarying vec2 vTroikaGlyphUV;\nvarying vec4 vTroikaTextureUVBounds;\nvarying float vTroikaTextureChannel;\nvarying vec2 vTroikaGlyphDimensions;\n\nfloat troikaSdfValueToSignedDistance(float alpha) {\n  // Inverse of encoding in SDFGenerator.js\n  ".concat("\n  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);\n  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;\n  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);\n  return signedDist;\n}\n\nfloat troikaGlyphUvToSdfValue(vec2 glyphUV) {\n  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);\n  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);\n  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1\n  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;\n}\n\nfloat troikaGlyphUvToDistance(vec2 uv) {\n  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));\n}\n\nfloat troikaGetAADist() {\n  ","\n  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300\n  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;\n  #else\n  return vTroikaGlyphDimensions.x / 64.0;\n  #endif\n}\n\nfloat troikaGetFragDistValue() {\n  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);\n  float distance = troikaGlyphUvToDistance(clampedGlyphUV);\n \n  // Extrapolate distance when outside bounds:\n  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : \n    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);\n\n  ","\n\n  return distance;\n}\n\nfloat troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {\n  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)\n  float alpha = step(-distanceOffset, -distance);\n  #else\n\n  float alpha = smoothstep(\n    distanceOffset + aaDist,\n    distanceOffset - aaDist,\n    distance\n  );\n  #endif\n\n  return alpha;\n}\n");var to=function(){var e=new d.MeshBasicMaterial({color:16777215,side:d.DoubleSide,transparent:!0}),t=8421504,n=new d.Matrix4,r=new d.Vector3,i=new d.Vector3,a=[],o=new d.Vector3,s="+x+y";function u(e){return Array.isArray(e)?e[0]:e}var l=function(){var t=new d.Mesh(new d.PlaneBufferGeometry(1,1),e);return l=function(){return t},t},c=function(){var t=new d.Mesh(new d.PlaneBufferGeometry(1,1,32,1),e);return c=function(){return t},t},I={type:"syncstart"},C={type:"synccomplete"},h=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],f=h.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail"),p=function(h){(0,V.Z)(A,h);var p=(0,F.Z)(A);function A(){var e;(0,N.Z)(this,A);var n=new qa;return(e=p.call(this,n,null)).text="",e.anchorX=0,e.anchorY=0,e.curveRadius=0,e.direction="auto",e.font=null,e.fontSize=.1,e.letterSpacing=0,e.lineHeight="normal",e.maxWidth=1/0,e.overflowWrap="normal",e.textAlign="left",e.textIndent=0,e.whiteSpace="normal",e.material=null,e.color=null,e.colorRanges=null,e.outlineWidth=0,e.outlineColor=0,e.outlineOpacity=1,e.outlineBlur=0,e.outlineOffsetX=0,e.outlineOffsetY=0,e.strokeWidth=0,e.strokeColor=t,e.strokeOpacity=1,e.fillOpacity=1,e.depthOffset=0,e.clipRect=null,e.orientation=s,e.glyphGeometryDetail=1,e.sdfGlyphSize=null,e.debugSDF=!1,e}return(0,z.Z)(A,[{key:"sync",value:function(e){var t=this;this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(I),Ua({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize},(function(n){t._isSyncing=!1,t._textRenderInfo=n,t.geometry.updateGlyphs(n.glyphBounds,n.glyphAtlasIndices,n.blockBounds,n.chunkedBounds,n.glyphColors);var r=t._queuedSyncs;r&&(t._queuedSyncs=null,t._needsSync=!0,t.sync((function(){r.forEach((function(e){return e&&e()}))}))),t.dispatchEvent(C),e&&e()}))))}},{key:"onBeforeRender",value:function(e,t,n,r,i,a){this.sync(),i.isTroikaTextMaterial&&this._prepareForRender(i)}},{key:"dispose",value:function(){this.geometry.dispose()}},{key:"textRenderInfo",get:function(){return this._textRenderInfo||null}},{key:"material",get:function(){var t=this._derivedMaterial,n=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=e.clone());if(t&&t.baseMaterial===n||(t=this._derivedMaterial=function(e){var t=Wa(e,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new d.Vector2},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new d.Vector4(0,0,0,0)},uTroikaClipRect:{value:new d.Vector4(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new d.Vector2},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new d.Color},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new d.Matrix3},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:"\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform vec4 uTroikaTotalBounds;\nuniform vec4 uTroikaClipRect;\nuniform mat3 uTroikaOrient;\nuniform bool uTroikaUseGlyphColors;\nuniform float uTroikaDistanceOffset;\nuniform float uTroikaBlurRadius;\nuniform vec2 uTroikaPositionOffset;\nuniform float uTroikaCurveRadius;\nattribute vec4 aTroikaGlyphBounds;\nattribute float aTroikaGlyphIndex;\nattribute vec3 aTroikaGlyphColor;\nvarying vec2 vTroikaGlyphUV;\nvarying vec4 vTroikaTextureUVBounds;\nvarying float vTroikaTextureChannel;\nvarying vec3 vTroikaGlyphColor;\nvarying vec2 vTroikaGlyphDimensions;\n",vertexTransform:$a,fragmentDefs:eo,fragmentColorTransform:"\nfloat aaDist = troikaGetAADist();\nfloat distance = troikaGetFragDistValue();\nfloat edgeAlpha = uTroikaSDFDebug ?\n  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :\n  troikaGetEdgeAlpha(distance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));\n\n#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)\nvec4 fillRGBA = gl_FragColor;\nfillRGBA.a *= uTroikaFillOpacity;\nvec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);\nif (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;\ngl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(\n  -uTroikaStrokeWidth - aaDist,\n  -uTroikaStrokeWidth + aaDist,\n  distance\n));\ngl_FragColor.a *= edgeAlpha;\n#endif\n\nif (edgeAlpha == 0.0) {\n  discard;\n}\n",customRewriter:function(e){var t=e.vertexShader,n=e.fragmentShader,r=/\buniform\s+vec3\s+diffuse\b/;return r.test(n)&&(n=n.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(t)||(t=t.replace(Ba,"uniform vec3 diffuse;\n$&\nvTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;\n"))),{vertexShader:t,fragmentShader:n}}});return t.transparent=!0,Object.defineProperties(t,{isTroikaTextMaterial:{value:!0},shadowSide:{get:function(){return this.side},set:function(){}}}),t}(n),n.addEventListener("dispose",(function e(){n.removeEventListener("dispose",e),t.dispose()}))),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){var r=t._outlineMtl;return r||((r=t._outlineMtl=Object.create(t,{id:{value:t.id+.1}})).isTextOutlineMaterial=!0,r.depthWrite=!1,r.map=null,t.addEventListener("dispose",(function e(){t.removeEventListener("dispose",e),r.dispose()}))),[r,t]}return t},set:function(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}},{key:"glyphGeometryDetail",get:function(){return this.geometry.detail},set:function(e){this.geometry.detail=e}},{key:"curveRadius",get:function(){return this.geometry.curveRadius},set:function(e){this.geometry.curveRadius=e}},{key:"customDepthMaterial",get:function(){return u(this.material).getDepthMaterial()}},{key:"customDistanceMaterial",get:function(){return u(this.material).getDistanceMaterial()}},{key:"_prepareForRender",value:function(e){var a=e.isTextOutlineMaterial,u=e.uniforms,l=this.textRenderInfo;if(l){var c=l.sdfTexture,I=l.blockBounds;u.uTroikaSDFTexture.value=c,u.uTroikaSDFTextureSize.value.set(c.image.width,c.image.height),u.uTroikaSDFGlyphSize.value=l.sdfGlyphSize,u.uTroikaSDFExponent.value=l.sdfExponent,u.uTroikaTotalBounds.value.fromArray(I),u.uTroikaUseGlyphColors.value=!a&&!!l.glyphColors;var C,h,f,p=0,A=0,m=0,v=0,b=0;if(a){var y=this.outlineWidth,B=this.outlineOffsetX,G=this.outlineOffsetY,Z=this.outlineBlur,w=this.outlineOpacity;p=this._parsePercent(y)||0,A=Math.max(0,this._parsePercent(Z)||0),C=w,v=this._parsePercent(B)||0,b=this._parsePercent(G)||0}else(m=Math.max(0,this._parsePercent(this.strokeWidth)||0))&&(f=this.strokeColor,u.uTroikaStrokeColor.value.set(null==f?t:f),null==(h=this.strokeOpacity)&&(h=1)),C=this.fillOpacity;u.uTroikaDistanceOffset.value=p,u.uTroikaPositionOffset.value.set(v,b),u.uTroikaBlurRadius.value=A,u.uTroikaStrokeWidth.value=m,u.uTroikaStrokeOpacity.value=h,u.uTroikaFillOpacity.value=null==C?1:C,u.uTroikaCurveRadius.value=this.curveRadius||0;var _=this.clipRect;if(_&&Array.isArray(_)&&4===_.length)u.uTroikaClipRect.value.fromArray(_);else{var x=100*(this.fontSize||.1);u.uTroikaClipRect.value.set(I[0]-x,I[1]-x,I[2]+x,I[3]+x)}this.geometry.applyClipRect(u.uTroikaClipRect.value)}u.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;var S=a?this.outlineColor||0:this.color;if(null==S)delete e.color;else{var R=e.hasOwnProperty("color")?e.color:e.color=new d.Color;S===R._input&&"object"!==typeof S||R.set(R._input=S)}var M=this.orientation||s;if(M!==e._orientation){var W=u.uTroikaOrient.value,k=(M=M.replace(/[^-+xyz]/g,""))!==s&&M.match(/^([-+])([xyz])([-+])([xyz])$/);if(k){var V=(0,g.Z)(k,5),F=V[1],E=V[2],X=V[3],H=V[4];r.set(0,0,0)[E]="-"===F?1:-1,i.set(0,0,0)[H]="-"===X?-1:1,n.lookAt(o,r.cross(i),i),W.setFromMatrix4(n)}else W.identity();e._orientation=M}}},{key:"_parsePercent",value:function(e){if("string"===typeof e){var t=e.match(/^(-?[\d.]+)%$/),n=t?parseFloat(t[1]):NaN;e=(isNaN(n)?0:n/100)*this.fontSize}return e}},{key:"localPositionToTextCoords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new d.Vector2;t.copy(e);var n=this.curveRadius;return n&&(t.x=Math.atan2(e.x,Math.abs(n)-Math.abs(e.z))*Math.abs(n)),t}},{key:"worldPositionToTextCoords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new d.Vector2;return r.copy(e),this.localPositionToTextCoords(this.worldToLocal(r),t)}},{key:"raycast",value:function(e,t){var n=this.textRenderInfo,r=this.curveRadius;if(n){for(var i=n.blockBounds,o=r?c():l(),s=o.geometry,u=s.attributes,g=u.position,d=u.uv,I=0;I<d.count;I++){var C=i[0]+d.getX(I)*(i[2]-i[0]),h=i[1]+d.getY(I)*(i[3]-i[1]),f=0;r&&(f=r-Math.cos(C/r)*r,C=Math.sin(C/r)*r),g.setXYZ(I,C,h,f)}s.boundingSphere=this.geometry.boundingSphere,s.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,a.length=0,o.raycast(e,a);for(var p=0;p<a.length;p++)a[p].object=this,t.push(a[p])}}},{key:"copy",value:function(e){var t=this,n=this.geometry;return(0,W.Z)((0,k.Z)(A.prototype),"copy",this).call(this,e),this.geometry=n,f.forEach((function(n){t[n]=e[n]})),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),A}(d.Mesh);h.forEach((function(e){var t="_private_"+e;Object.defineProperty(p.prototype,e,{get:function(){return this[t]},set:function(e){e!==this[t]&&(this[t]=e,this._needsSync=!0)}})}));var A=!1;return Object.defineProperty(p.prototype,"anchor",{get:function(){return this._deprecated_anchor},set:function(e){this._deprecated_anchor=e,A||(console.warn("TextMesh: `anchor` has been deprecated; use `anchorX` and `anchorY` instead."),A=!0),Array.isArray(e)?(this.anchorX="".concat(100*(+e[0]||0),"%"),this.anchorY="".concat(100*(+e[1]||0),"%")):this.anchorX=this.anchorY=0}}),p}();new WeakMap;new WeakMap;var no=["anchorX","anchorY","children","onSync"],ro=o.forwardRef((function(e,t){var n=e.anchorX,r=void 0===n?"center":n,i=e.anchorY,a=void 0===i?"middle":i,u=e.children,l=e.onSync,c=(0,m.Z)(e,no),d=(0,s.useThree)((function(e){return e.invalidate})),I=o.useState((function(){return new to})),C=(0,g.Z)(I,1)[0],h=o.useMemo((function(){var e=[],t="";return o.Children.forEach(u,(function(n){"string"===typeof n||"number"===typeof n?t+=n:e.push(n)})),[e,t]}),[u]),f=(0,g.Z)(h,2),p=f[0],A=f[1];return o.useLayoutEffect((function(){C.sync((function(){d(),l&&l(C)}))})),o.useEffect((function(){return function(){return C.dispose()}}),[C]),o.createElement("primitive",(0,v.Z)({object:C,ref:t,text:A,anchorX:r,anchorY:a},c),p)})),io={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")},ao=function(){function e(){(0,N.Z)(this,e),(0,yr.Z)(this,"enabled",!0),(0,yr.Z)(this,"needsSwap",!0),(0,yr.Z)(this,"clear",!1),(0,yr.Z)(this,"renderToScreen",!1)}return(0,z.Z)(e,[{key:"setSize",value:function(e,t){}},{key:"render",value:function(e,t,n,r,i){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}]),e}(),oo=function(){function e(t){(0,N.Z)(this,e),(0,yr.Z)(this,"camera",new d.OrthographicCamera(-1,1,1,-1,0,1)),(0,yr.Z)(this,"geometry",new d.PlaneGeometry(2,2)),(0,yr.Z)(this,"mesh",void 0),this.mesh=new d.Mesh(this.geometry,t)}return(0,z.Z)(e,[{key:"material",get:function(){return this.mesh.material},set:function(e){this.mesh.material=e}},{key:"dispose",value:function(){this.mesh.geometry.dispose()}},{key:"render",value:function(e){e.render(this.mesh,this.camera)}}]),e}(),so=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tDiffuse";return(0,N.Z)(this,n),r=t.call(this),(0,yr.Z)((0,M.Z)(r),"textureID",void 0),(0,yr.Z)((0,M.Z)(r),"uniforms",void 0),(0,yr.Z)((0,M.Z)(r),"material",void 0),(0,yr.Z)((0,M.Z)(r),"fsQuad",void 0),r.textureID=i,e instanceof d.ShaderMaterial?(r.uniforms=e.uniforms,r.material=e):(r.uniforms=d.UniformsUtils.clone(e.uniforms),r.material=new d.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:r.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),r.fsQuad=new oo(r.material),r}return(0,z.Z)(n,[{key:"render",value:function(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}]),n}(ao),uo=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r){var i;return(0,N.Z)(this,n),i=t.call(this),(0,yr.Z)((0,M.Z)(i),"scene",void 0),(0,yr.Z)((0,M.Z)(i),"camera",void 0),(0,yr.Z)((0,M.Z)(i),"inverse",void 0),i.scene=e,i.camera=r,i.clear=!0,i.needsSwap=!1,i.inverse=!1,i}return(0,z.Z)(n,[{key:"render",value:function(e,t,n){var r,i,a=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0),this.inverse?(r=0,i=1):(r=1,i=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),o.buffers.stencil.setFunc(a.ALWAYS,r,4294967295),o.buffers.stencil.setClear(i),o.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(a.EQUAL,1,4294967295),o.buffers.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),o.buffers.stencil.setLocked(!0)}}]),n}(ao),lo=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;return(0,N.Z)(this,n),(e=t.call(this)).needsSwap=!1,e}return(0,z.Z)(n,[{key:"render",value:function(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}]),n}(ao),co=function(){function e(t,n){if((0,N.Z)(this,e),(0,yr.Z)(this,"renderer",void 0),(0,yr.Z)(this,"_pixelRatio",void 0),(0,yr.Z)(this,"_width",void 0),(0,yr.Z)(this,"_height",void 0),(0,yr.Z)(this,"renderTarget1",void 0),(0,yr.Z)(this,"renderTarget2",void 0),(0,yr.Z)(this,"writeBuffer",void 0),(0,yr.Z)(this,"readBuffer",void 0),(0,yr.Z)(this,"renderToScreen",void 0),(0,yr.Z)(this,"passes",[]),(0,yr.Z)(this,"copyPass",void 0),(0,yr.Z)(this,"clock",void 0),this.renderer=t,void 0===n){var r={minFilter:d.LinearFilter,magFilter:d.LinearFilter,format:d.RGBAFormat},i=t.getSize(new d.Vector2);this._pixelRatio=t.getPixelRatio(),this._width=i.width,this._height=i.height,(n=new d.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,r)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,void 0===io&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===so&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new so(io),this.clock=new d.Clock}return(0,z.Z)(e,[{key:"swapBuffers",value:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}},{key:"addPass",value:function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"insertPass",value:function(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"removePass",value:function(e){var t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}},{key:"isLastEnabledPass",value:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}},{key:"render",value:function(e){void 0===e&&(e=this.clock.getDelta());for(var t=this.renderer.getRenderTarget(),n=!1,r=this.passes.length,i=0;i<r;i++){var a=this.passes[i];if(!1!==a.enabled){if(a.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),a.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),a.needsSwap){if(n){var o=this.renderer.getContext(),s=this.renderer.state.buffers.stencil;s.setFunc(o.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),s.setFunc(o.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==uo&&(a instanceof uo?n=!0:a instanceof lo&&(n=!1))}}this.renderer.setRenderTarget(t)}},{key:"reset",value:function(e){if(void 0===e){var t=this.renderer.getSize(new d.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}},{key:"setSize",value:function(e,t){this._width=e,this._height=t;var n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(n,r)}},{key:"setPixelRatio",value:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}]),e}(),go=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return(0,N.Z)(this,n),o=t.call(this),(0,yr.Z)((0,M.Z)(o),"scene",void 0),(0,yr.Z)((0,M.Z)(o),"camera",void 0),(0,yr.Z)((0,M.Z)(o),"overrideMaterial",void 0),(0,yr.Z)((0,M.Z)(o),"clearColor",void 0),(0,yr.Z)((0,M.Z)(o),"clearAlpha",void 0),(0,yr.Z)((0,M.Z)(o),"clearDepth",!1),(0,yr.Z)((0,M.Z)(o),"_oldClearColor",new d.Color),o.scene=e,o.camera=r,o.overrideMaterial=i,o.clearColor=a,o.clearAlpha=s,o.clear=!0,o.needsSwap=!1,o}return(0,z.Z)(n,[{key:"render",value:function(e,t,n){var r,i=e.autoClear;e.autoClear=!1;var a=null;void 0!==this.overrideMaterial&&(a=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),r=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,r),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=a),e.autoClear=i}}]),n}(ao),Io={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 tex = texture2D( tDiffuse, vUv );","\tgl_FragColor = LinearTosRGB( tex );","}"].join("\n")},Co=["children","multisamping","renderIndex","disableGamma","disableRenderPass"];(0,s.extend)({EffectComposer:co,RenderPass:go,ShaderPass:so});var ho=function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(Ic){return!1}},fo=o.forwardRef((function(e,t){var n=e.children,r=e.multisamping,i=void 0===r?8:r,a=e.renderIndex,u=void 0===a?1:a,l=e.disableGamma,c=void 0!==l&&l,I=e.disableRenderPass,C=void 0!==I&&I,h=(0,m.Z)(e,Co),f=o.useRef(),p=(0,s.useThree)((function(e){return e.scene})),A=(0,s.useThree)((function(e){return e.camera})),b=(0,s.useThree)((function(e){return e.gl})),B=(0,s.useThree)((function(e){return e.size})),G=o.useState((function(){if(ho()&&i>0){var e=new d.WebGLMultisampleRenderTarget(B.width,B.height,{format:d.RGBAFormat,encoding:d.sRGBEncoding});return e.samples=8,e}})),Z=(0,g.Z)(G,1)[0];return o.useEffect((function(){var e,t;null==(e=f.current)||e.setSize(B.width,B.height),null==(t=f.current)||t.setPixelRatio(b.getPixelRatio())}),[b,B]),(0,s.useFrame)((function(){var e;return null==(e=f.current)?void 0:e.render()}),u),o.createElement("effectComposer",(0,v.Z)({ref:(0,y.default)([t,f]),args:[b,Z]},h),!C&&o.createElement("renderPass",{attachArray:"passes",args:[p,A]}),!c&&o.createElement("shaderPass",{attachArray:"passes",args:[Io]}),n)})),po=["stops","colors","size"];function Ao(e){var t=e.stops,n=e.colors,r=e.size,i=void 0===r?2048:r,a=(0,m.Z)(e,po),s=o.useMemo((function(){var e=document.createElement("canvas"),r=e.getContext("2d");e.width=16,e.height=i;for(var a=r.createLinearGradient(0,0,0,i),o=t.length;o--;)a.addColorStop(t[o],n[o]);r.fillStyle=a,r.fillRect(0,0,16,i);var s=new d.Texture(e);return s.needsUpdate=!0,s}),[t]);return o.useEffect((function(){return function(){s.dispose()}}),[s]),o.createElement("primitive",(0,v.Z)({object:s,attach:"map"},a))}function mo(e,t,n,r){return function(i){(0,V.Z)(o,i);var a=(0,F.Z)(o);function o(){var i;(0,N.Z)(this,o);var s=Object.entries(e);return i=a.call(this,{uniforms:s.reduce((function(e,t){var n=(0,g.Z)(t,2),r=n[0],i=n[1],a=d.UniformsUtils.clone((0,yr.Z)({},r,{value:i}));return(0,c.Z)((0,c.Z)({},e),a)}),{}),vertexShader:t,fragmentShader:n}),s.forEach((function(e){var t=(0,g.Z)(e,1)[0];return Object.defineProperty((0,M.Z)(i),t,{get:function(){return i.uniforms[t].value},set:function(e){return i.uniforms[t].value=e}})})),r&&r((0,M.Z)(i)),i}return(0,z.Z)(o)}(d.ShaderMaterial)}var vo=function(e){return e===Object(e)&&!Array.isArray(e)&&"function"!==typeof e};function bo(e){var t=(0,s.useThree)((function(e){return e.gl})),n=(0,s.useLoader)(d.TextureLoader,vo(e)?Object.values(e):e);if((0,o.useEffect)((function(){(Array.isArray(n)?n:[n]).forEach(t.initTexture)}),[t,n]),vo(e)){var r=Object.keys(e),i={};return r.forEach((function(e){return Object.assign(i,(0,yr.Z)({},e,n[r.indexOf(e)]))})),i}return n}bo.preload=function(e){return s.useLoader.preload(d.TextureLoader,e)},bo.clear=function(e){return s.useLoader.clear(d.TextureLoader,e)};var yo=["children","color","segments","scale","zoom","grayscale","url"],Bo=mo({color:new d.Color("white"),scale:[1,1],imageBounds:[1,1],map:null,zoom:1,grayscale:0},"\n  varying vec2 vUv;\n  void main() {\n    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n    vUv = uv;\n  }\n","\n  // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44\n  varying vec2 vUv;\n  uniform vec2 scale;\n  uniform vec2 imageBounds;\n  uniform vec3 color;\n  uniform sampler2D map;\n  uniform float zoom;\n  uniform float grayscale;\n  const vec3 luma = vec3(.299, 0.587, 0.114);\n  vec4 toGrayscale(vec4 color, float intensity) {\n    return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);\n  }\n  vec2 aspect(vec2 size) {\n    return size / min(size.x, size.y);\n  }\n  void main() {\n    vec2 s = aspect(scale);\n    vec2 i = aspect(imageBounds);\n    float rs = s.x / s.y;\n    float ri = i.x / i.y;\n    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n    vec2 uv = vUv * s / new + offset;\n    vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);\n    gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, 1.0), grayscale);\n  }\n"),Go=o.forwardRef((function(e,t){var n=e.children,r=e.color,i=e.segments,a=void 0===i?1:i,u=e.scale,l=void 0===u?1:u,c=e.zoom,g=void 0===c?1:c,d=e.grayscale,I=void 0===d?0:d,C=e.url,h=(0,m.Z)(e,yo);(0,s.extend)({ImageMaterial:Bo});var f=bo(C),p=Array.isArray(l)?[l[0],l[1]]:[l,l],A=[f.image.width,f.image.height];return o.createElement("mesh",(0,v.Z)({ref:t,scale:l},h),o.createElement("planeGeometry",{args:[1,1,a,a]}),o.createElement("imageMaterial",{color:r,map:f,zoom:g,grayscale:I,scale:p,imageBounds:A}),n)})),Zo=["makeDefault"],wo=o.forwardRef((function(e,t){var n=e.makeDefault,r=(0,m.Z)(e,Zo),i=(0,s.useThree)((function(e){return e.set})),a=(0,s.useThree)((function(e){return e.camera})),u=(0,s.useThree)((function(e){return e.size})),l=o.useRef();return o.useLayoutEffect((function(){l.current&&!r.manual&&l.current.updateProjectionMatrix()}),[u,r]),o.useLayoutEffect((function(){if(n&&l.current){var e=a;return i((function(){return{camera:l.current}})),function(){return i((function(){return{camera:e}}))}}}),[a,l,n,i]),o.createElement("orthographicCamera",(0,v.Z)({left:u.width/-2,right:u.width/2,top:u.height/2,bottom:u.height/-2,ref:(0,y.default)([l,t])},r))})),_o=["makeDefault"],xo=o.forwardRef((function(e,t){var n=e.makeDefault,r=(0,m.Z)(e,_o),i=(0,s.useThree)((function(e){return e.set})),a=(0,s.useThree)((function(e){return e.camera})),u=(0,s.useThree)((function(e){return e.size})),l=o.useRef();return o.useLayoutEffect((function(){var e=l.current;e&&!r.manual&&(e.aspect=u.width/u.height,e.updateProjectionMatrix())}),[u,r]),o.useLayoutEffect((function(){if(n&&l.current){var e=a;return i((function(){return{camera:l.current}})),function(){return i((function(){return{camera:e}}))}}}),[a,l,n,i]),o.createElement("perspectiveCamera",(0,v.Z)({ref:(0,y.default)([l,t])},r))})),So=["children","fog","frames","resolution","near","far"];function Ro(e){var t=e.children,n=e.fog,r=e.frames,i=void 0===r?1/0:r,a=e.resolution,u=void 0===a?256:a,l=e.near,c=void 0===l?1:l,I=e.far,C=void 0===I?1e3:I,h=(0,m.Z)(e,So),f=o.useRef(),p=o.useState(),A=(0,g.Z)(p,2),v=A[0],b=A[1],y=(0,s.useThree)((function(e){return e.scene})),B=(0,s.useThree)((function(e){return e.gl})),G=o.useMemo((function(){return new d.WebGLCubeRenderTarget(u,{minFilter:d.LinearFilter,magFilter:d.LinearFilter,format:d.RGBFormat,encoding:B.outputEncoding})}),[u]),Z=0;return(0,s.useFrame)((function(){if(v&&f.current&&(i===1/0||Z<i)){f.current.traverse((function(e){return e.visible=!1}));var e=y.fog;y.fog=n||e,v.update(B,y),y.fog=e,f.current.traverse((function(e){return e.visible=!0})),Z++}})),o.createElement("group",h,o.createElement("cubeCamera",{ref:b,args:[c,C,G]}),o.createElement("group",{ref:f},t(G.texture)))}var Mo=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e){var r;return(0,N.Z)(this,n),r=t.call(this),(0,yr.Z)((0,M.Z)(r),"object",void 0),(0,yr.Z)((0,M.Z)(r),"changeEvent",{type:"change"}),(0,yr.Z)((0,M.Z)(r),"EPS",1e-6),(0,yr.Z)((0,M.Z)(r),"enabled",!0),(0,yr.Z)((0,M.Z)(r),"deviceOrientation",{alpha:0,beta:0,gamma:0}),(0,yr.Z)((0,M.Z)(r),"screenOrientation",0),(0,yr.Z)((0,M.Z)(r),"alphaOffset",0),(0,yr.Z)((0,M.Z)(r),"onDeviceOrientationChangeEvent",(function(e){r.deviceOrientation=e})),(0,yr.Z)((0,M.Z)(r),"onScreenOrientationChangeEvent",(function(){r.screenOrientation=window.orientation||0})),(0,yr.Z)((0,M.Z)(r),"zee",new d.Vector3(0,0,1)),(0,yr.Z)((0,M.Z)(r),"euler",new d.Euler),(0,yr.Z)((0,M.Z)(r),"q0",new d.Quaternion),(0,yr.Z)((0,M.Z)(r),"q1",new d.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5))),(0,yr.Z)((0,M.Z)(r),"setObjectQuaternion",(function(e,t,n,i,a){r.euler.set(n,t,-i,"YXZ"),e.setFromEuler(r.euler),e.multiply(r.q1),e.multiply(r.q0.setFromAxisAngle(r.zee,-a))})),(0,yr.Z)((0,M.Z)(r),"connect",(function(){r.onScreenOrientationChangeEvent(),void 0!==window.DeviceOrientationEvent&&"function"===typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then((function(e){"granted"==e&&(window.addEventListener("orientationchange",r.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",r.onDeviceOrientationChangeEvent))})).catch((function(e){console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",e)})):(window.addEventListener("orientationchange",r.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",r.onDeviceOrientationChangeEvent)),r.enabled=!0})),(0,yr.Z)((0,M.Z)(r),"disconnect",(function(){window.removeEventListener("orientationchange",r.onScreenOrientationChangeEvent),window.removeEventListener("deviceorientation",r.onDeviceOrientationChangeEvent),r.enabled=!1})),(0,yr.Z)((0,M.Z)(r),"lastQuaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(r),"update",(function(){if(!1!==r.enabled){var e=r.deviceOrientation;if(e){var t=e.alpha?d.MathUtils.degToRad(e.alpha)+r.alphaOffset:0,n=e.beta?d.MathUtils.degToRad(e.beta):0,i=e.gamma?d.MathUtils.degToRad(e.gamma):0,a=r.screenOrientation?d.MathUtils.degToRad(r.screenOrientation):0;r.setObjectQuaternion(r.object.quaternion,t,n,i,a),8*(1-r.lastQuaternion.dot(r.object.quaternion))>r.EPS&&(r.lastQuaternion.copy(r.object.quaternion),r.dispatchEvent(r.changeEvent))}}})),(0,yr.Z)((0,M.Z)(r),"dispose",(function(){return r.disconnect()})),r.object=e,r.object.rotation.reorder("YXZ"),r.connect(),r}return(0,z.Z)(n)}(d.EventDispatcher),Wo=["camera","onChange"],ko=o.forwardRef((function(e,t){var n=e.camera,r=e.onChange,i=(0,m.Z)(e,Wo),a=(0,s.useThree)((function(e){return e.camera})),u=(0,s.useThree)((function(e){return e.invalidate})),l=n||a,c=o.useState((function(){return new Mo(l)})),d=(0,g.Z)(c,1)[0];return o.useEffect((function(){var e=function(e){u(),r&&r(e)};return null==d||null==d.addEventListener||d.addEventListener("change",e),function(){return null==d||null==d.removeEventListener?void 0:d.removeEventListener("change",e)}}),[r,d,u]),(0,s.useFrame)((function(){return null==d?void 0:d.update()})),o.useEffect((function(){var e=d;return null==e||e.connect(),function(){return null==e?void 0:e.dispose()}}),[d]),d?o.createElement("primitive",(0,v.Z)({ref:t,dispose:void 0,object:d},i)):null}));function Vo(e){e.preventDefault()}var Fo=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r){var i;return(0,N.Z)(this,n),i=t.call(this),(0,yr.Z)((0,M.Z)(i),"object",void 0),(0,yr.Z)((0,M.Z)(i),"domElement",void 0),(0,yr.Z)((0,M.Z)(i),"movementSpeed",1),(0,yr.Z)((0,M.Z)(i),"rollSpeed",.005),(0,yr.Z)((0,M.Z)(i),"dragToLook",!1),(0,yr.Z)((0,M.Z)(i),"autoForward",!1),(0,yr.Z)((0,M.Z)(i),"changeEvent",{type:"change"}),(0,yr.Z)((0,M.Z)(i),"EPS",1e-6),(0,yr.Z)((0,M.Z)(i),"tmpQuaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(i),"mouseStatus",0),(0,yr.Z)((0,M.Z)(i),"movementSpeedMultiplier",1),(0,yr.Z)((0,M.Z)(i),"moveState",{up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0}),(0,yr.Z)((0,M.Z)(i),"moveVector",new d.Vector3(0,0,0)),(0,yr.Z)((0,M.Z)(i),"rotationVector",new d.Vector3(0,0,0)),(0,yr.Z)((0,M.Z)(i),"keydown",(function(e){if(!e.altKey){switch(e.code){case"ShiftLeft":case"ShiftRight":i.movementSpeedMultiplier=.1;break;case"KeyW":i.moveState.forward=1;break;case"KeyS":i.moveState.back=1;break;case"KeyA":i.moveState.left=1;break;case"KeyD":i.moveState.right=1;break;case"KeyR":i.moveState.up=1;break;case"KeyF":i.moveState.down=1;break;case"ArrowUp":i.moveState.pitchUp=1;break;case"ArrowDown":i.moveState.pitchDown=1;break;case"ArrowLeft":i.moveState.yawLeft=1;break;case"ArrowRight":i.moveState.yawRight=1;break;case"KeyQ":i.moveState.rollLeft=1;break;case"KeyE":i.moveState.rollRight=1}i.updateMovementVector(),i.updateRotationVector()}})),(0,yr.Z)((0,M.Z)(i),"keyup",(function(e){switch(e.code){case"ShiftLeft":case"ShiftRight":i.movementSpeedMultiplier=1;break;case"KeyW":i.moveState.forward=0;break;case"KeyS":i.moveState.back=0;break;case"KeyA":i.moveState.left=0;break;case"KeyD":i.moveState.right=0;break;case"KeyR":i.moveState.up=0;break;case"KeyF":i.moveState.down=0;break;case"ArrowUp":i.moveState.pitchUp=0;break;case"ArrowDown":i.moveState.pitchDown=0;break;case"ArrowLeft":i.moveState.yawLeft=0;break;case"ArrowRight":i.moveState.yawRight=0;break;case"KeyQ":i.moveState.rollLeft=0;break;case"KeyE":i.moveState.rollRight=0}i.updateMovementVector(),i.updateRotationVector()})),(0,yr.Z)((0,M.Z)(i),"mousedown",(function(e){if(i.dragToLook)i.mouseStatus++;else{switch(e.button){case 0:i.moveState.forward=1;break;case 2:i.moveState.back=1}i.updateMovementVector()}})),(0,yr.Z)((0,M.Z)(i),"mousemove",(function(e){if(!i.dragToLook||i.mouseStatus>0){var t=i.getContainerDimensions(),n=t.size[0]/2,r=t.size[1]/2;i.moveState.yawLeft=-(e.pageX-t.offset[0]-n)/n,i.moveState.pitchDown=(e.pageY-t.offset[1]-r)/r,i.updateRotationVector()}})),(0,yr.Z)((0,M.Z)(i),"mouseup",(function(e){if(i.dragToLook)i.mouseStatus--,i.moveState.yawLeft=i.moveState.pitchDown=0;else{switch(e.button){case 0:i.moveState.forward=0;break;case 2:i.moveState.back=0}i.updateMovementVector()}i.updateRotationVector()})),(0,yr.Z)((0,M.Z)(i),"lastQuaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(i),"lastPosition",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"update",(function(e){var t=e*i.movementSpeed,n=e*i.rollSpeed;i.object.translateX(i.moveVector.x*t),i.object.translateY(i.moveVector.y*t),i.object.translateZ(i.moveVector.z*t),i.tmpQuaternion.set(i.rotationVector.x*n,i.rotationVector.y*n,i.rotationVector.z*n,1).normalize(),i.object.quaternion.multiply(i.tmpQuaternion),(i.lastPosition.distanceToSquared(i.object.position)>i.EPS||8*(1-i.lastQuaternion.dot(i.object.quaternion))>i.EPS)&&(i.dispatchEvent(i.changeEvent),i.lastQuaternion.copy(i.object.quaternion),i.lastPosition.copy(i.object.position))})),(0,yr.Z)((0,M.Z)(i),"updateMovementVector",(function(){var e=i.moveState.forward||i.autoForward&&!i.moveState.back?1:0;i.moveVector.x=-i.moveState.left+i.moveState.right,i.moveVector.y=-i.moveState.down+i.moveState.up,i.moveVector.z=-e+i.moveState.back})),(0,yr.Z)((0,M.Z)(i),"updateRotationVector",(function(){i.rotationVector.x=-i.moveState.pitchDown+i.moveState.pitchUp,i.rotationVector.y=-i.moveState.yawRight+i.moveState.yawLeft,i.rotationVector.z=-i.moveState.rollRight+i.moveState.rollLeft})),(0,yr.Z)((0,M.Z)(i),"getContainerDimensions",(function(){return i.domElement==document||i.domElement instanceof Document?{size:[window.innerWidth,window.innerHeight],offset:[0,0]}:{size:[i.domElement.offsetWidth,i.domElement.offsetHeight],offset:[i.domElement.offsetLeft,i.domElement.offsetTop]}})),(0,yr.Z)((0,M.Z)(i),"dispose",(function(){i.domElement.removeEventListener("contextmenu",Vo),i.domElement.removeEventListener("mousemove",i.mousemove),i.domElement.removeEventListener("mousedown",i.mousedown),i.domElement.removeEventListener("mouseup",i.mouseup),window.removeEventListener("keydown",i.keydown),window.removeEventListener("keyup",i.keyup)})),void 0===r&&(console.warn('THREE.FlyControls: The second parameter "domElement" is now mandatory.'),r=document),i.object=e,i.domElement=r,!r||r instanceof Document||r.setAttribute("tabindex",-1),i.domElement.addEventListener("contextmenu",Vo),i.domElement.addEventListener("mousemove",i.mousemove),i.domElement.addEventListener("mousedown",i.mousedown),i.domElement.addEventListener("mouseup",i.mouseup),window.addEventListener("keydown",i.keydown),window.addEventListener("keyup",i.keyup),i.updateMovementVector(),i.updateRotationVector(),i}return(0,z.Z)(n)}(d.EventDispatcher),Eo=["onChange"],Xo=o.forwardRef((function(e,t){var n=e.onChange,r=(0,m.Z)(e,Eo),i=(0,s.useThree)((function(e){return e.invalidate})),a=(0,s.useThree)((function(e){return e.camera})),u=(0,s.useThree)((function(e){return e.gl})),l=o.useState((function(){return new Fo(a,u.domElement)})),c=(0,g.Z)(l,1)[0];return o.useEffect((function(){var e=function(e){i(),n&&n(e)};return null==c||null==c.addEventListener||c.addEventListener("change",e),function(){return null==c||null==c.removeEventListener?void 0:c.removeEventListener("change",e)}}),[n,c,i]),(0,s.useFrame)((function(e,t){return null==c?void 0:c.update(t)})),c?o.createElement("primitive",(0,v.Z)({ref:t,dispose:void 0,object:c},r)):null})),Ho=function(e,t){return(e%t+t)%t},Lo=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r){var i;(0,N.Z)(this,n),i=t.call(this),(0,yr.Z)((0,M.Z)(i),"object",void 0),(0,yr.Z)((0,M.Z)(i),"domElement",void 0),(0,yr.Z)((0,M.Z)(i),"enabled",!0),(0,yr.Z)((0,M.Z)(i),"target",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"minDistance",0),(0,yr.Z)((0,M.Z)(i),"maxDistance",1/0),(0,yr.Z)((0,M.Z)(i),"minZoom",0),(0,yr.Z)((0,M.Z)(i),"maxZoom",1/0),(0,yr.Z)((0,M.Z)(i),"minPolarAngle",0),(0,yr.Z)((0,M.Z)(i),"maxPolarAngle",Math.PI),(0,yr.Z)((0,M.Z)(i),"minAzimuthAngle",-1/0),(0,yr.Z)((0,M.Z)(i),"maxAzimuthAngle",1/0),(0,yr.Z)((0,M.Z)(i),"enableDamping",!1),(0,yr.Z)((0,M.Z)(i),"dampingFactor",.05),(0,yr.Z)((0,M.Z)(i),"enableZoom",!0),(0,yr.Z)((0,M.Z)(i),"zoomSpeed",1),(0,yr.Z)((0,M.Z)(i),"enableRotate",!0),(0,yr.Z)((0,M.Z)(i),"rotateSpeed",1),(0,yr.Z)((0,M.Z)(i),"enablePan",!0),(0,yr.Z)((0,M.Z)(i),"panSpeed",1),(0,yr.Z)((0,M.Z)(i),"screenSpacePanning",!0),(0,yr.Z)((0,M.Z)(i),"keyPanSpeed",7),(0,yr.Z)((0,M.Z)(i),"autoRotate",!1),(0,yr.Z)((0,M.Z)(i),"autoRotateSpeed",2),(0,yr.Z)((0,M.Z)(i),"reverseOrbit",!1),(0,yr.Z)((0,M.Z)(i),"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),(0,yr.Z)((0,M.Z)(i),"mouseButtons",{LEFT:d.MOUSE.ROTATE,MIDDLE:d.MOUSE.DOLLY,RIGHT:d.MOUSE.PAN}),(0,yr.Z)((0,M.Z)(i),"touches",{ONE:d.TOUCH.ROTATE,TWO:d.TOUCH.DOLLY_PAN}),(0,yr.Z)((0,M.Z)(i),"target0",void 0),(0,yr.Z)((0,M.Z)(i),"position0",void 0),(0,yr.Z)((0,M.Z)(i),"zoom0",void 0),(0,yr.Z)((0,M.Z)(i),"_domElementKeyEvents",null),(0,yr.Z)((0,M.Z)(i),"getPolarAngle",void 0),(0,yr.Z)((0,M.Z)(i),"getAzimuthalAngle",void 0),(0,yr.Z)((0,M.Z)(i),"setPolarAngle",void 0),(0,yr.Z)((0,M.Z)(i),"setAzimuthalAngle",void 0),(0,yr.Z)((0,M.Z)(i),"getDistance",void 0),(0,yr.Z)((0,M.Z)(i),"listenToKeyEvents",void 0),(0,yr.Z)((0,M.Z)(i),"saveState",void 0),(0,yr.Z)((0,M.Z)(i),"reset",void 0),(0,yr.Z)((0,M.Z)(i),"update",void 0),(0,yr.Z)((0,M.Z)(i),"connect",void 0),(0,yr.Z)((0,M.Z)(i),"dispose",void 0),i.object=e,i.domElement=r,i.target0=i.target.clone(),i.position0=i.object.position.clone(),i.zoom0=i.object instanceof d.PerspectiveCamera?i.object.zoom:1,i.getPolarAngle=function(){return I.phi},i.getAzimuthalAngle=function(){return I.theta},i.setPolarAngle=function(e){var t=Ho(e,2*Math.PI),n=I.phi;n<0&&(n+=2*Math.PI),t<0&&(t+=2*Math.PI);var r=Math.abs(t-n);2*Math.PI-r<r&&(t<n?t+=2*Math.PI:n+=2*Math.PI),C.phi=t-n,a.update()},i.setAzimuthalAngle=function(e){var t=Ho(e,2*Math.PI),n=I.theta;n<0&&(n+=2*Math.PI),t<0&&(t+=2*Math.PI);var r=Math.abs(t-n);2*Math.PI-r<r&&(t<n?t+=2*Math.PI:n+=2*Math.PI),C.theta=t-n,a.update()},i.getDistance=function(){return a.object.position.distanceTo(a.target)},i.listenToKeyEvents=function(e){e.addEventListener("keydown",q),i._domElementKeyEvents=e},i.saveState=function(){a.target0.copy(a.target),a.position0.copy(a.object.position),a.zoom0=a.object instanceof d.PerspectiveCamera?a.object.zoom:1},i.reset=function(){a.target.copy(a.target0),a.object.position.copy(a.position0),a.object instanceof d.PerspectiveCamera&&(a.object.zoom=a.zoom0,a.object.updateProjectionMatrix()),a.dispatchEvent(o),a.update(),c=l.NONE},i.update=function(){var t=new d.Vector3,n=(new d.Quaternion).setFromUnitVectors(e.up,new d.Vector3(0,1,0)),r=n.clone().invert(),i=new d.Vector3,s=new d.Quaternion,u=2*Math.PI;return function(){var e=a.object.position;t.copy(e).sub(a.target),t.applyQuaternion(n),I.setFromVector3(t),a.autoRotate&&c===l.NONE&&R(2*Math.PI/60/60*a.autoRotateSpeed),a.enableDamping?(I.theta+=C.theta*a.dampingFactor,I.phi+=C.phi*a.dampingFactor):(I.theta+=C.theta,I.phi+=C.phi);var d=a.minAzimuthAngle,A=a.maxAzimuthAngle;return isFinite(d)&&isFinite(A)&&(d<-Math.PI?d+=u:d>Math.PI&&(d-=u),A<-Math.PI?A+=u:A>Math.PI&&(A-=u),I.theta=d<=A?Math.max(d,Math.min(A,I.theta)):I.theta>(d+A)/2?Math.max(d,I.theta):Math.min(A,I.theta)),I.phi=Math.max(a.minPolarAngle,Math.min(a.maxPolarAngle,I.phi)),I.makeSafe(),I.radius*=h,I.radius=Math.max(a.minDistance,Math.min(a.maxDistance,I.radius)),!0===a.enableDamping?a.target.addScaledVector(f,a.dampingFactor):a.target.add(f),t.setFromSpherical(I),t.applyQuaternion(r),e.copy(a.target).add(t),a.object.lookAt(a.target),!0===a.enableDamping?(C.theta*=1-a.dampingFactor,C.phi*=1-a.dampingFactor,f.multiplyScalar(1-a.dampingFactor)):(C.set(0,0,0),f.set(0,0,0)),h=1,!!(p||i.distanceToSquared(a.object.position)>g||8*(1-s.dot(a.object.quaternion))>g)&&(a.dispatchEvent(o),i.copy(a.object.position),s.copy(a.object.quaternion),p=!1,!0)}}(),i.connect=function(e){e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),a.domElement=e,a.domElement.style.touchAction="none",a.domElement.addEventListener("contextmenu",$),a.domElement.addEventListener("pointerdown",U),a.domElement.addEventListener("pointercancel",Q),a.domElement.addEventListener("wheel",j)},i.dispose=function(){var e,t,n,r,i,o;null===(e=a.domElement)||void 0===e||e.removeEventListener("contextmenu",$),null===(t=a.domElement)||void 0===t||t.removeEventListener("pointerdown",U),null===(n=a.domElement)||void 0===n||n.removeEventListener("pointercancel",Q),null===(r=a.domElement)||void 0===r||r.removeEventListener("wheel",j),null===(i=a.domElement)||void 0===i||i.ownerDocument.removeEventListener("pointermove",O),null===(o=a.domElement)||void 0===o||o.ownerDocument.removeEventListener("pointerup",J),null!==a._domElementKeyEvents&&a._domElementKeyEvents.removeEventListener("keydown",q)};var a=(0,M.Z)(i),o={type:"change"},s={type:"start"},u={type:"end"},l={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},c=l.NONE,g=1e-6,I=new d.Spherical,C=new d.Spherical,h=1,f=new d.Vector3,p=!1,A=new d.Vector2,m=new d.Vector2,v=new d.Vector2,b=new d.Vector2,y=new d.Vector2,B=new d.Vector2,G=new d.Vector2,Z=new d.Vector2,w=new d.Vector2,_=[],x={};function S(){return Math.pow(.95,a.zoomSpeed)}function R(e){a.reverseOrbit?C.theta+=e:C.theta-=e}function W(e){a.reverseOrbit?C.phi+=e:C.phi-=e}var k=function(){var e=new d.Vector3;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),f.add(e)}}(),V=function(){var e=new d.Vector3;return function(t,n){!0===a.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(a.object.up,e)),e.multiplyScalar(t),f.add(e)}}(),F=function(){var e=new d.Vector3;return function(t,n){var r=a.domElement;if(r&&a.object instanceof d.PerspectiveCamera&&a.object.isPerspectiveCamera){var i=a.object.position;e.copy(i).sub(a.target);var o=e.length();o*=Math.tan(a.object.fov/2*Math.PI/180),k(2*t*o/r.clientHeight,a.object.matrix),V(2*n*o/r.clientHeight,a.object.matrix)}else r&&a.object instanceof d.OrthographicCamera&&a.object.isOrthographicCamera?(k(t*(a.object.right-a.object.left)/a.object.zoom/r.clientWidth,a.object.matrix),V(n*(a.object.top-a.object.bottom)/a.object.zoom/r.clientHeight,a.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),a.enablePan=!1)}}();function E(e){a.object instanceof d.PerspectiveCamera&&a.object.isPerspectiveCamera?h/=e:a.object instanceof d.OrthographicCamera&&a.object.isOrthographicCamera?(a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom*e)),a.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),a.enableZoom=!1)}function X(e){a.object instanceof d.PerspectiveCamera&&a.object.isPerspectiveCamera?h*=e:a.object instanceof d.OrthographicCamera&&a.object.isOrthographicCamera?(a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom/e)),a.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),a.enableZoom=!1)}function H(e){A.set(e.clientX,e.clientY)}function L(e){b.set(e.clientX,e.clientY)}function z(){if(1==_.length)A.set(_[0].pageX,_[0].pageY);else{var e=.5*(_[0].pageX+_[1].pageX),t=.5*(_[0].pageY+_[1].pageY);A.set(e,t)}}function Y(){if(1==_.length)b.set(_[0].pageX,_[0].pageY);else{var e=.5*(_[0].pageX+_[1].pageX),t=.5*(_[0].pageY+_[1].pageY);b.set(e,t)}}function T(){var e=_[0].pageX-_[1].pageX,t=_[0].pageY-_[1].pageY,n=Math.sqrt(e*e+t*t);G.set(0,n)}function K(e){if(1==_.length)m.set(e.pageX,e.pageY);else{var t=ne(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);m.set(n,r)}v.subVectors(m,A).multiplyScalar(a.rotateSpeed);var i=a.domElement;i&&(R(2*Math.PI*v.x/i.clientHeight),W(2*Math.PI*v.y/i.clientHeight)),A.copy(m)}function D(e){if(1==_.length)y.set(e.pageX,e.pageY);else{var t=ne(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);y.set(n,r)}B.subVectors(y,b).multiplyScalar(a.panSpeed),F(B.x,B.y),b.copy(y)}function P(e){var t=ne(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);Z.set(0,i),w.set(0,Math.pow(Z.y/G.y,a.zoomSpeed)),E(w.y),G.copy(Z)}function U(e){if(!1!==a.enabled){var t,n;if(0===_.length)null===(t=a.domElement)||void 0===t||t.ownerDocument.addEventListener("pointermove",O),null===(n=a.domElement)||void 0===n||n.ownerDocument.addEventListener("pointerup",J);!function(e){_.push(e)}(e),"touch"===e.pointerType?function(e){switch(te(e),_.length){case 1:switch(a.touches.ONE){case d.TOUCH.ROTATE:if(!1===a.enableRotate)return;z(),c=l.TOUCH_ROTATE;break;case d.TOUCH.PAN:if(!1===a.enablePan)return;Y(),c=l.TOUCH_PAN;break;default:c=l.NONE}break;case 2:switch(a.touches.TWO){case d.TOUCH.DOLLY_PAN:if(!1===a.enableZoom&&!1===a.enablePan)return;a.enableZoom&&T(),a.enablePan&&Y(),c=l.TOUCH_DOLLY_PAN;break;case d.TOUCH.DOLLY_ROTATE:if(!1===a.enableZoom&&!1===a.enableRotate)return;a.enableZoom&&T(),a.enableRotate&&z(),c=l.TOUCH_DOLLY_ROTATE;break;default:c=l.NONE}break;default:c=l.NONE}c!==l.NONE&&a.dispatchEvent(s)}(e):function(e){var t;switch(e.button){case 0:t=a.mouseButtons.LEFT;break;case 1:t=a.mouseButtons.MIDDLE;break;case 2:t=a.mouseButtons.RIGHT;break;default:t=-1}switch(t){case d.MOUSE.DOLLY:if(!1===a.enableZoom)return;!function(e){G.set(e.clientX,e.clientY)}(e),c=l.DOLLY;break;case d.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===a.enablePan)return;L(e),c=l.PAN}else{if(!1===a.enableRotate)return;H(e),c=l.ROTATE}break;case d.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===a.enableRotate)return;H(e),c=l.ROTATE}else{if(!1===a.enablePan)return;L(e),c=l.PAN}break;default:c=l.NONE}c!==l.NONE&&a.dispatchEvent(s)}(e)}}function O(e){!1!==a.enabled&&("touch"===e.pointerType?function(e){switch(te(e),c){case l.TOUCH_ROTATE:if(!1===a.enableRotate)return;K(e),a.update();break;case l.TOUCH_PAN:if(!1===a.enablePan)return;D(e),a.update();break;case l.TOUCH_DOLLY_PAN:if(!1===a.enableZoom&&!1===a.enablePan)return;!function(e){a.enableZoom&&P(e),a.enablePan&&D(e)}(e),a.update();break;case l.TOUCH_DOLLY_ROTATE:if(!1===a.enableZoom&&!1===a.enableRotate)return;!function(e){a.enableZoom&&P(e),a.enableRotate&&K(e)}(e),a.update();break;default:c=l.NONE}}(e):function(e){if(!1===a.enabled)return;switch(c){case l.ROTATE:if(!1===a.enableRotate)return;!function(e){m.set(e.clientX,e.clientY),v.subVectors(m,A).multiplyScalar(a.rotateSpeed);var t=a.domElement;t&&(R(2*Math.PI*v.x/t.clientHeight),W(2*Math.PI*v.y/t.clientHeight)),A.copy(m),a.update()}(e);break;case l.DOLLY:if(!1===a.enableZoom)return;!function(e){Z.set(e.clientX,e.clientY),w.subVectors(Z,G),w.y>0?E(S()):w.y<0&&X(S()),G.copy(Z),a.update()}(e);break;case l.PAN:if(!1===a.enablePan)return;!function(e){y.set(e.clientX,e.clientY),B.subVectors(y,b).multiplyScalar(a.panSpeed),F(B.x,B.y),b.copy(y),a.update()}(e)}}(e))}function J(e){var t,n,r;(ee(e),0===_.length)&&(null===(t=a.domElement)||void 0===t||t.releasePointerCapture(e.pointerId),null===(n=a.domElement)||void 0===n||n.ownerDocument.removeEventListener("pointermove",O),null===(r=a.domElement)||void 0===r||r.ownerDocument.removeEventListener("pointerup",J));a.dispatchEvent(u),c=l.NONE}function Q(e){ee(e)}function j(e){!1===a.enabled||!1===a.enableZoom||c!==l.NONE&&c!==l.ROTATE||(e.preventDefault(),a.dispatchEvent(s),function(e){e.deltaY<0?X(S()):e.deltaY>0&&E(S()),a.update()}(e),a.dispatchEvent(u))}function q(e){!1!==a.enabled&&!1!==a.enablePan&&function(e){var t=!1;switch(e.code){case a.keys.UP:F(0,a.keyPanSpeed),t=!0;break;case a.keys.BOTTOM:F(0,-a.keyPanSpeed),t=!0;break;case a.keys.LEFT:F(a.keyPanSpeed,0),t=!0;break;case a.keys.RIGHT:F(-a.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),a.update())}(e)}function $(e){!1!==a.enabled&&e.preventDefault()}function ee(e){delete x[e.pointerId];for(var t=0;t<_.length;t++)if(_[t].pointerId==e.pointerId)return void _.splice(t,1)}function te(e){var t=x[e.pointerId];void 0===t&&(t=new d.Vector2,x[e.pointerId]=t),t.set(e.pageX,e.pageY)}function ne(e){var t=e.pointerId===_[0].pointerId?_[1]:_[0];return x[t.pointerId]}return void 0!==r&&i.connect(r),i.update(),i}return(0,z.Z)(n)}(d.EventDispatcher),zo=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r){var i;return(0,N.Z)(this,n),(i=t.call(this,e,r)).screenSpacePanning=!1,i.mouseButtons.LEFT=d.MOUSE.PAN,i.mouseButtons.RIGHT=d.MOUSE.ROTATE,i.touches.ONE=d.TOUCH.PAN,i.touches.TWO=d.TOUCH.DOLLY_ROTATE,i}return(0,z.Z)(n)}(Lo),No=["camera","onChange","onStart","onEnd"],Yo=o.forwardRef((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enableDamping:!0},t=arguments.length>1?arguments[1]:void 0,n=e.camera,r=e.onChange,i=e.onStart,a=e.onEnd,u=(0,m.Z)(e,No),l=(0,s.useThree)((function(e){return e.invalidate})),c=(0,s.useThree)((function(e){return e.camera})),g=(0,s.useThree)((function(e){return e.gl.domElement})),d=n||c,I=o.useMemo((function(){return new zo(d)}),[d]);return o.useEffect((function(){I.connect(g);var e=function(e){l(),r&&r(e)};return I.addEventListener("change",e),i&&I.addEventListener("start",i),a&&I.addEventListener("end",a),function(){I.dispose(),I.removeEventListener("change",e),i&&I.removeEventListener("start",i),a&&I.removeEventListener("end",a)}}),[r,i,a,I,l,g]),(0,s.useFrame)((function(){return I.update()})),o.createElement("primitive",(0,v.Z)({ref:t,dispose:void 0,object:I,enableDamping:!0},u))})),To=["makeDefault","camera","regress","domElement","enableDamping","onChange","onStart","onEnd"],Ko=o.forwardRef((function(e,t){var n=e.makeDefault,r=e.camera,i=e.regress,a=e.domElement,u=e.enableDamping,l=void 0===u||u,c=e.onChange,g=e.onStart,d=e.onEnd,I=(0,m.Z)(e,To),C=(0,s.useThree)((function(e){return e.invalidate})),h=(0,s.useThree)((function(e){return e.camera})),f=(0,s.useThree)((function(e){return e.gl})),p=(0,s.useThree)((function(e){return e.events})),A=(0,s.useThree)((function(e){return e.set})),b=(0,s.useThree)((function(e){return e.get})),y=(0,s.useThree)((function(e){return e.performance})),B=r||h,G=a||("boolean"!==typeof p.connected?p.connected:f.domElement),Z=o.useMemo((function(){return new Lo(B)}),[B]);return(0,s.useFrame)((function(){Z.enabled&&Z.update()})),o.useEffect((function(){var e=function(e){C(),i&&y.regress(),c&&c(e)};return Z.connect(G),Z.addEventListener("change",e),g&&Z.addEventListener("start",g),d&&Z.addEventListener("end",d),function(){Z.removeEventListener("change",e),g&&Z.removeEventListener("start",g),d&&Z.removeEventListener("end",d),Z.dispose()}}),[G,c,g,d,i,Z,C]),o.useEffect((function(){if(n){var e=b().controls;return A({controls:Z}),function(){return A({controls:e})}}}),[n,Z]),o.createElement("primitive",(0,v.Z)({ref:t,object:Z,enableDamping:l},I))})),Do=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r){var i;return(0,N.Z)(this,n),i=t.call(this),(0,yr.Z)((0,M.Z)(i),"enabled",!0),(0,yr.Z)((0,M.Z)(i),"screen",{left:0,top:0,width:0,height:0}),(0,yr.Z)((0,M.Z)(i),"rotateSpeed",1),(0,yr.Z)((0,M.Z)(i),"zoomSpeed",1.2),(0,yr.Z)((0,M.Z)(i),"panSpeed",.3),(0,yr.Z)((0,M.Z)(i),"noRotate",!1),(0,yr.Z)((0,M.Z)(i),"noZoom",!1),(0,yr.Z)((0,M.Z)(i),"noPan",!1),(0,yr.Z)((0,M.Z)(i),"staticMoving",!1),(0,yr.Z)((0,M.Z)(i),"dynamicDampingFactor",.2),(0,yr.Z)((0,M.Z)(i),"minDistance",0),(0,yr.Z)((0,M.Z)(i),"maxDistance",1/0),(0,yr.Z)((0,M.Z)(i),"keys",["KeyA","KeyS","KeyD"]),(0,yr.Z)((0,M.Z)(i),"mouseButtons",{LEFT:d.MOUSE.ROTATE,MIDDLE:d.MOUSE.DOLLY,RIGHT:d.MOUSE.PAN}),(0,yr.Z)((0,M.Z)(i),"object",void 0),(0,yr.Z)((0,M.Z)(i),"domElement",void 0),(0,yr.Z)((0,M.Z)(i),"cursorZoom",!1),(0,yr.Z)((0,M.Z)(i),"target",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"mousePosition",new d.Vector2),(0,yr.Z)((0,M.Z)(i),"STATE",{NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4}),(0,yr.Z)((0,M.Z)(i),"EPS",1e-6),(0,yr.Z)((0,M.Z)(i),"lastZoom",1),(0,yr.Z)((0,M.Z)(i),"lastPosition",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"cursorVector",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"targetVector",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"_state",i.STATE.NONE),(0,yr.Z)((0,M.Z)(i),"_keyState",i.STATE.NONE),(0,yr.Z)((0,M.Z)(i),"_eye",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"_movePrev",new d.Vector2),(0,yr.Z)((0,M.Z)(i),"_moveCurr",new d.Vector2),(0,yr.Z)((0,M.Z)(i),"_lastAxis",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"_lastAngle",0),(0,yr.Z)((0,M.Z)(i),"_zoomStart",new d.Vector2),(0,yr.Z)((0,M.Z)(i),"_zoomEnd",new d.Vector2),(0,yr.Z)((0,M.Z)(i),"_touchZoomDistanceStart",0),(0,yr.Z)((0,M.Z)(i),"_touchZoomDistanceEnd",0),(0,yr.Z)((0,M.Z)(i),"_panStart",new d.Vector2),(0,yr.Z)((0,M.Z)(i),"_panEnd",new d.Vector2),(0,yr.Z)((0,M.Z)(i),"target0",void 0),(0,yr.Z)((0,M.Z)(i),"position0",void 0),(0,yr.Z)((0,M.Z)(i),"up0",void 0),(0,yr.Z)((0,M.Z)(i),"zoom0",void 0),(0,yr.Z)((0,M.Z)(i),"changeEvent",{type:"change"}),(0,yr.Z)((0,M.Z)(i),"startEvent",{type:"start"}),(0,yr.Z)((0,M.Z)(i),"endEvent",{type:"end"}),(0,yr.Z)((0,M.Z)(i),"onScreenVector",new d.Vector2),(0,yr.Z)((0,M.Z)(i),"getMouseOnScreen",(function(e,t){return i.onScreenVector.set((e-i.screen.left)/i.screen.width,(t-i.screen.top)/i.screen.height),i.onScreenVector})),(0,yr.Z)((0,M.Z)(i),"onCircleVector",new d.Vector2),(0,yr.Z)((0,M.Z)(i),"getMouseOnCircle",(function(e,t){return i.onCircleVector.set((e-.5*i.screen.width-i.screen.left)/(.5*i.screen.width),(i.screen.height+2*(i.screen.top-t))/i.screen.width),i.onCircleVector})),(0,yr.Z)((0,M.Z)(i),"axis",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"quaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(i),"eyeDirection",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"objectUpDirection",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"objectSidewaysDirection",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"moveDirection",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"angle",0),(0,yr.Z)((0,M.Z)(i),"rotateCamera",(function(){i.moveDirection.set(i._moveCurr.x-i._movePrev.x,i._moveCurr.y-i._movePrev.y,0),i.angle=i.moveDirection.length(),i.angle?(i._eye.copy(i.object.position).sub(i.target),i.eyeDirection.copy(i._eye).normalize(),i.objectUpDirection.copy(i.object.up).normalize(),i.objectSidewaysDirection.crossVectors(i.objectUpDirection,i.eyeDirection).normalize(),i.objectUpDirection.setLength(i._moveCurr.y-i._movePrev.y),i.objectSidewaysDirection.setLength(i._moveCurr.x-i._movePrev.x),i.moveDirection.copy(i.objectUpDirection.add(i.objectSidewaysDirection)),i.axis.crossVectors(i.moveDirection,i._eye).normalize(),i.angle*=i.rotateSpeed,i.quaternion.setFromAxisAngle(i.axis,i.angle),i._eye.applyQuaternion(i.quaternion),i.object.up.applyQuaternion(i.quaternion),i._lastAxis.copy(i.axis),i._lastAngle=i.angle):!i.staticMoving&&i._lastAngle&&(i._lastAngle*=Math.sqrt(1-i.dynamicDampingFactor),i._eye.copy(i.object.position).sub(i.target),i.quaternion.setFromAxisAngle(i._lastAxis,i._lastAngle),i._eye.applyQuaternion(i.quaternion),i.object.up.applyQuaternion(i.quaternion)),i._movePrev.copy(i._moveCurr)})),(0,yr.Z)((0,M.Z)(i),"zoomCamera",(function(){var e;if(i._state===i.STATE.TOUCH_ZOOM_PAN)e=i._touchZoomDistanceStart/i._touchZoomDistanceEnd,i._touchZoomDistanceStart=i._touchZoomDistanceEnd,i.object.isPerspectiveCamera?i._eye.multiplyScalar(e):i.object.isOrthographicCamera?(i.object.zoom/=e,i.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type");else{if(e=1+(i._zoomEnd.y-i._zoomStart.y)*i.zoomSpeed,Math.abs(e-1)>i.EPS&&e>0&&(i.object.isPerspectiveCamera?(e>1&&i._eye.length()>=i.maxDistance-i.EPS&&(e=1),i._eye.multiplyScalar(e)):i.object.isOrthographicCamera?(e>1&&i.object.zoom<i.maxDistance*i.maxDistance&&(e=1),i.object.zoom/=e):console.warn("THREE.TrackballControls: Unsupported camera type")),i.staticMoving?i._zoomStart.copy(i._zoomEnd):i._zoomStart.y+=(i._zoomEnd.y-i._zoomStart.y)*i.dynamicDampingFactor,i.cursorZoom){i.targetVector.copy(i.target).project(i.object);var t=i.cursorVector.set(i.mousePosition.x,i.mousePosition.y,i.targetVector.z).unproject(i.object);i.target.lerpVectors(t,i.target,e)}i.object.isOrthographicCamera&&i.object.updateProjectionMatrix()}})),(0,yr.Z)((0,M.Z)(i),"mouseChange",new d.Vector2),(0,yr.Z)((0,M.Z)(i),"objectUp",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"pan",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"panCamera",(function(){if(i.domElement&&(i.mouseChange.copy(i._panEnd).sub(i._panStart),i.mouseChange.lengthSq()>i.EPS)){if(i.object.isOrthographicCamera){var e=i.object,t=(e.right-e.left)/i.object.zoom,n=(e.top-e.bottom)/i.object.zoom;i.mouseChange.x*=t,i.mouseChange.y*=n}else i.mouseChange.multiplyScalar(i._eye.length()*i.panSpeed);i.pan.copy(i._eye).cross(i.object.up).setLength(i.mouseChange.x),i.pan.add(i.objectUp.copy(i.object.up).setLength(i.mouseChange.y)),i.object.position.add(i.pan),i.target.add(i.pan),i.staticMoving?i._panStart.copy(i._panEnd):i._panStart.add(i.mouseChange.subVectors(i._panEnd,i._panStart).multiplyScalar(i.dynamicDampingFactor))}})),(0,yr.Z)((0,M.Z)(i),"checkDistances",(function(){i.noZoom&&i.noPan||(i._eye.lengthSq()>i.maxDistance*i.maxDistance&&(i.object.position.addVectors(i.target,i._eye.setLength(i.maxDistance)),i._zoomStart.copy(i._zoomEnd)),i._eye.lengthSq()<i.minDistance*i.minDistance&&(i.object.position.addVectors(i.target,i._eye.setLength(i.minDistance)),i._zoomStart.copy(i._zoomEnd)))})),(0,yr.Z)((0,M.Z)(i),"handleResize",(function(){if(i.domElement){var e=i.domElement.getBoundingClientRect(),t=i.domElement.ownerDocument.documentElement;i.screen.left=e.left+window.pageXOffset-t.clientLeft,i.screen.top=e.top+window.pageYOffset-t.clientTop,i.screen.width=e.width,i.screen.height=e.height}})),(0,yr.Z)((0,M.Z)(i),"update",(function(){i._eye.subVectors(i.object.position,i.target),i.noRotate||i.rotateCamera(),i.noZoom||i.zoomCamera(),i.noPan||i.panCamera(),i.object.position.addVectors(i.target,i._eye),i.object.isPerspectiveCamera?(i.checkDistances(),i.object.lookAt(i.target),i.lastPosition.distanceToSquared(i.object.position)>i.EPS&&(i.dispatchEvent(i.changeEvent),i.lastPosition.copy(i.object.position))):i.object.isOrthographicCamera?(i.object.lookAt(i.target),(i.lastPosition.distanceToSquared(i.object.position)>i.EPS||i.lastZoom!==i.object.zoom)&&(i.dispatchEvent(i.changeEvent),i.lastPosition.copy(i.object.position),i.lastZoom=i.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")})),(0,yr.Z)((0,M.Z)(i),"reset",(function(){i._state=i.STATE.NONE,i._keyState=i.STATE.NONE,i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.up.copy(i.up0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i._eye.subVectors(i.object.position,i.target),i.object.lookAt(i.target),i.dispatchEvent(i.changeEvent),i.lastPosition.copy(i.object.position),i.lastZoom=i.object.zoom})),(0,yr.Z)((0,M.Z)(i),"keydown",(function(e){!1!==i.enabled&&(window.removeEventListener("keydown",i.keydown),i._keyState===i.STATE.NONE&&(e.code!==i.keys[i.STATE.ROTATE]||i.noRotate?e.code!==i.keys[i.STATE.ZOOM]||i.noZoom?e.code!==i.keys[i.STATE.PAN]||i.noPan||(i._keyState=i.STATE.PAN):i._keyState=i.STATE.ZOOM:i._keyState=i.STATE.ROTATE))})),(0,yr.Z)((0,M.Z)(i),"onPointerDown",(function(e){if(!1!==i.enabled)switch(e.pointerType){case"mouse":case"pen":i.onMouseDown(e)}})),(0,yr.Z)((0,M.Z)(i),"onPointerMove",(function(e){if(!1!==i.enabled)switch(e.pointerType){case"mouse":case"pen":i.onMouseMove(e)}})),(0,yr.Z)((0,M.Z)(i),"onPointerUp",(function(e){if(!1!==i.enabled)switch(e.pointerType){case"mouse":case"pen":i.onMouseUp()}})),(0,yr.Z)((0,M.Z)(i),"keyup",(function(){!1!==i.enabled&&(i._keyState=i.STATE.NONE,window.addEventListener("keydown",i.keydown))})),(0,yr.Z)((0,M.Z)(i),"onMouseDown",(function(e){if(i.domElement){if(i._state===i.STATE.NONE)switch(e.button){case i.mouseButtons.LEFT:i._state=i.STATE.ROTATE;break;case i.mouseButtons.MIDDLE:i._state=i.STATE.ZOOM;break;case i.mouseButtons.RIGHT:i._state=i.STATE.PAN;break;default:i._state=i.STATE.NONE}var t=i._keyState!==i.STATE.NONE?i._keyState:i._state;t!==i.STATE.ROTATE||i.noRotate?t!==i.STATE.ZOOM||i.noZoom?t!==i.STATE.PAN||i.noPan||(i._panStart.copy(i.getMouseOnScreen(e.pageX,e.pageY)),i._panEnd.copy(i._panStart)):(i._zoomStart.copy(i.getMouseOnScreen(e.pageX,e.pageY)),i._zoomEnd.copy(i._zoomStart)):(i._moveCurr.copy(i.getMouseOnCircle(e.pageX,e.pageY)),i._movePrev.copy(i._moveCurr)),i.domElement.ownerDocument.addEventListener("pointermove",i.onPointerMove),i.domElement.ownerDocument.addEventListener("pointerup",i.onPointerUp),i.dispatchEvent(i.startEvent)}})),(0,yr.Z)((0,M.Z)(i),"onMouseMove",(function(e){if(!1!==i.enabled){var t=i._keyState!==i.STATE.NONE?i._keyState:i._state;t!==i.STATE.ROTATE||i.noRotate?t!==i.STATE.ZOOM||i.noZoom?t!==i.STATE.PAN||i.noPan||i._panEnd.copy(i.getMouseOnScreen(e.pageX,e.pageY)):i._zoomEnd.copy(i.getMouseOnScreen(e.pageX,e.pageY)):(i._movePrev.copy(i._moveCurr),i._moveCurr.copy(i.getMouseOnCircle(e.pageX,e.pageY)))}})),(0,yr.Z)((0,M.Z)(i),"onMouseUp",(function(){i.domElement&&!1!==i.enabled&&(i._state=i.STATE.NONE,i.domElement.ownerDocument.removeEventListener("pointermove",i.onPointerMove),i.domElement.ownerDocument.removeEventListener("pointerup",i.onPointerUp),i.dispatchEvent(i.endEvent))})),(0,yr.Z)((0,M.Z)(i),"mousewheel",(function(e){if(!1!==i.enabled&&!0!==i.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:i._zoomStart.y-=.025*e.deltaY;break;case 1:i._zoomStart.y-=.01*e.deltaY;break;default:i._zoomStart.y-=25e-5*e.deltaY}i.mousePosition.x=e.offsetX/i.screen.width*2-1,i.mousePosition.y=-e.offsetY/i.screen.height*2+1,i.dispatchEvent(i.startEvent),i.dispatchEvent(i.endEvent)}})),(0,yr.Z)((0,M.Z)(i),"touchstart",(function(e){if(!1!==i.enabled){if(e.preventDefault(),1===e.touches.length)i._state=i.STATE.TOUCH_ROTATE,i._moveCurr.copy(i.getMouseOnCircle(e.touches[0].pageX,e.touches[0].pageY)),i._movePrev.copy(i._moveCurr);else{i._state=i.STATE.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;i._touchZoomDistanceEnd=i._touchZoomDistanceStart=Math.sqrt(t*t+n*n);var r=(e.touches[0].pageX+e.touches[1].pageX)/2,a=(e.touches[0].pageY+e.touches[1].pageY)/2;i._panStart.copy(i.getMouseOnScreen(r,a)),i._panEnd.copy(i._panStart)}i.dispatchEvent(i.startEvent)}})),(0,yr.Z)((0,M.Z)(i),"touchmove",(function(e){if(!1!==i.enabled)if(e.preventDefault(),1===e.touches.length)i._movePrev.copy(i._moveCurr),i._moveCurr.copy(i.getMouseOnCircle(e.touches[0].pageX,e.touches[0].pageY));else{var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;i._touchZoomDistanceEnd=Math.sqrt(t*t+n*n);var r=(e.touches[0].pageX+e.touches[1].pageX)/2,a=(e.touches[0].pageY+e.touches[1].pageY)/2;i._panEnd.copy(i.getMouseOnScreen(r,a))}})),(0,yr.Z)((0,M.Z)(i),"touchend",(function(e){if(!1!==i.enabled){switch(e.touches.length){case 0:i._state=i.STATE.NONE;break;case 1:i._state=i.STATE.TOUCH_ROTATE,i._moveCurr.copy(i.getMouseOnCircle(e.touches[0].pageX,e.touches[0].pageY)),i._movePrev.copy(i._moveCurr)}i.dispatchEvent(i.endEvent)}})),(0,yr.Z)((0,M.Z)(i),"contextmenu",(function(e){!1!==i.enabled&&e.preventDefault()})),(0,yr.Z)((0,M.Z)(i),"connect",(function(e){e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),i.domElement=e,i.domElement.addEventListener("contextmenu",i.contextmenu),i.domElement.addEventListener("pointerdown",i.onPointerDown),i.domElement.addEventListener("wheel",i.mousewheel),i.domElement.addEventListener("touchstart",i.touchstart),i.domElement.addEventListener("touchend",i.touchend),i.domElement.addEventListener("touchmove",i.touchmove),i.domElement.ownerDocument.addEventListener("pointermove",i.onPointerMove),i.domElement.ownerDocument.addEventListener("pointerup",i.onPointerUp),window.addEventListener("keydown",i.keydown),window.addEventListener("keyup",i.keyup),i.handleResize()})),(0,yr.Z)((0,M.Z)(i),"dispose",(function(){i.domElement&&(i.domElement.removeEventListener("contextmenu",i.contextmenu),i.domElement.removeEventListener("pointerdown",i.onPointerDown),i.domElement.removeEventListener("wheel",i.mousewheel),i.domElement.removeEventListener("touchstart",i.touchstart),i.domElement.removeEventListener("touchend",i.touchend),i.domElement.removeEventListener("touchmove",i.touchmove),i.domElement.ownerDocument.removeEventListener("pointermove",i.onPointerMove),i.domElement.ownerDocument.removeEventListener("pointerup",i.onPointerUp),window.removeEventListener("keydown",i.keydown),window.removeEventListener("keyup",i.keyup))})),i.object=e,i.target0=i.target.clone(),i.position0=i.object.position.clone(),i.up0=i.object.up.clone(),i.zoom0=i.object.zoom,void 0!==r&&i.connect(r),i.update(),i}return(0,z.Z)(n)}(d.EventDispatcher),Po=["makeDefault","camera","domElement","regress","onChange","onStart","onEnd"],Uo=o.forwardRef((function(e,t){var n=e.makeDefault,r=e.camera,i=e.domElement,a=e.regress,u=e.onChange,l=e.onStart,c=e.onEnd,g=(0,m.Z)(e,Po),d=(0,s.useThree)(),I=d.invalidate,C=d.camera,h=d.gl,f=d.events,p=d.set,A=d.get,b=d.performance,y=d.viewport,B=r||C,G=i||("boolean"!==typeof f.connected?f.connected:h.domElement),Z=o.useMemo((function(){return new Do(B)}),[B]);return(0,s.useFrame)((function(){Z.enabled&&Z.update()})),o.useEffect((function(){var e=function(e){I(),a&&b.regress(),u&&u(e)};return Z.connect(G),Z.addEventListener("change",e),l&&Z.addEventListener("start",l),c&&Z.addEventListener("end",c),function(){Z.removeEventListener("change",e),l&&Z.removeEventListener("start",l),c&&Z.removeEventListener("end",c),Z.dispose()}}),[G,u,l,c,a,Z,I]),o.useEffect((function(){Z.handleResize()}),[y]),o.useEffect((function(){if(n){var e=A().controls;return p({controls:Z}),function(){return p({controls:e})}}}),[n,Z]),o.createElement("primitive",(0,v.Z)({ref:t,object:Z},g))})),Oo={IDLE:Symbol(),ROTATE:Symbol(),PAN:Symbol(),SCALE:Symbol(),FOV:Symbol(),FOCUS:Symbol(),ZROTATE:Symbol(),TOUCH_MULTI:Symbol(),ANIMATION_FOCUS:Symbol(),ANIMATION_ROTATE:Symbol()},Jo={NONE:Symbol(),ONE_FINGER:Symbol(),ONE_FINGER_SWITCHED:Symbol(),TWO_FINGER:Symbol(),MULT_FINGER:Symbol(),CURSOR:Symbol()},Qo={x:0,y:0},jo={camera:new d.Matrix4,gizmos:new d.Matrix4},qo={type:"change"},$o={type:"start"},es={type:"end"},ts=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,N.Z)(this,n),i=t.call(this),(0,yr.Z)((0,M.Z)(i),"camera",void 0),(0,yr.Z)((0,M.Z)(i),"domElement",void 0),(0,yr.Z)((0,M.Z)(i),"scene",void 0),(0,yr.Z)((0,M.Z)(i),"mouseActions",void 0),(0,yr.Z)((0,M.Z)(i),"_mouseOp",void 0),(0,yr.Z)((0,M.Z)(i),"_v2_1",void 0),(0,yr.Z)((0,M.Z)(i),"_v3_1",void 0),(0,yr.Z)((0,M.Z)(i),"_v3_2",void 0),(0,yr.Z)((0,M.Z)(i),"_m4_1",void 0),(0,yr.Z)((0,M.Z)(i),"_m4_2",void 0),(0,yr.Z)((0,M.Z)(i),"_quat",void 0),(0,yr.Z)((0,M.Z)(i),"_translationMatrix",void 0),(0,yr.Z)((0,M.Z)(i),"_rotationMatrix",void 0),(0,yr.Z)((0,M.Z)(i),"_scaleMatrix",void 0),(0,yr.Z)((0,M.Z)(i),"_rotationAxis",void 0),(0,yr.Z)((0,M.Z)(i),"_cameraMatrixState",void 0),(0,yr.Z)((0,M.Z)(i),"_cameraProjectionState",void 0),(0,yr.Z)((0,M.Z)(i),"_fovState",void 0),(0,yr.Z)((0,M.Z)(i),"_upState",void 0),(0,yr.Z)((0,M.Z)(i),"_zoomState",void 0),(0,yr.Z)((0,M.Z)(i),"_nearPos",void 0),(0,yr.Z)((0,M.Z)(i),"_farPos",void 0),(0,yr.Z)((0,M.Z)(i),"_gizmoMatrixState",void 0),(0,yr.Z)((0,M.Z)(i),"_up0",void 0),(0,yr.Z)((0,M.Z)(i),"_zoom0",void 0),(0,yr.Z)((0,M.Z)(i),"_fov0",void 0),(0,yr.Z)((0,M.Z)(i),"_initialNear",void 0),(0,yr.Z)((0,M.Z)(i),"_nearPos0",void 0),(0,yr.Z)((0,M.Z)(i),"_initialFar",void 0),(0,yr.Z)((0,M.Z)(i),"_farPos0",void 0),(0,yr.Z)((0,M.Z)(i),"_cameraMatrixState0",void 0),(0,yr.Z)((0,M.Z)(i),"_gizmoMatrixState0",void 0),(0,yr.Z)((0,M.Z)(i),"_button",void 0),(0,yr.Z)((0,M.Z)(i),"_touchStart",void 0),(0,yr.Z)((0,M.Z)(i),"_touchCurrent",void 0),(0,yr.Z)((0,M.Z)(i),"_input",void 0),(0,yr.Z)((0,M.Z)(i),"_switchSensibility",void 0),(0,yr.Z)((0,M.Z)(i),"_startFingerDistance",void 0),(0,yr.Z)((0,M.Z)(i),"_currentFingerDistance",void 0),(0,yr.Z)((0,M.Z)(i),"_startFingerRotation",void 0),(0,yr.Z)((0,M.Z)(i),"_currentFingerRotation",void 0),(0,yr.Z)((0,M.Z)(i),"_devPxRatio",void 0),(0,yr.Z)((0,M.Z)(i),"_downValid",void 0),(0,yr.Z)((0,M.Z)(i),"_nclicks",void 0),(0,yr.Z)((0,M.Z)(i),"_downEvents",void 0),(0,yr.Z)((0,M.Z)(i),"_downStart",void 0),(0,yr.Z)((0,M.Z)(i),"_clickStart",void 0),(0,yr.Z)((0,M.Z)(i),"_maxDownTime",void 0),(0,yr.Z)((0,M.Z)(i),"_maxInterval",void 0),(0,yr.Z)((0,M.Z)(i),"_posThreshold",void 0),(0,yr.Z)((0,M.Z)(i),"_movementThreshold",void 0),(0,yr.Z)((0,M.Z)(i),"_currentCursorPosition",void 0),(0,yr.Z)((0,M.Z)(i),"_startCursorPosition",void 0),(0,yr.Z)((0,M.Z)(i),"_grid",void 0),(0,yr.Z)((0,M.Z)(i),"_gridPosition",void 0),(0,yr.Z)((0,M.Z)(i),"_gizmos",void 0),(0,yr.Z)((0,M.Z)(i),"_curvePts",void 0),(0,yr.Z)((0,M.Z)(i),"_timeStart",void 0),(0,yr.Z)((0,M.Z)(i),"_animationId",void 0),(0,yr.Z)((0,M.Z)(i),"focusAnimationTime",void 0),(0,yr.Z)((0,M.Z)(i),"_timePrev",void 0),(0,yr.Z)((0,M.Z)(i),"_timeCurrent",void 0),(0,yr.Z)((0,M.Z)(i),"_anglePrev",void 0),(0,yr.Z)((0,M.Z)(i),"_angleCurrent",void 0),(0,yr.Z)((0,M.Z)(i),"_cursorPosPrev",void 0),(0,yr.Z)((0,M.Z)(i),"_cursorPosCurr",void 0),(0,yr.Z)((0,M.Z)(i),"_wPrev",void 0),(0,yr.Z)((0,M.Z)(i),"_wCurr",void 0),(0,yr.Z)((0,M.Z)(i),"adjustNearFar",void 0),(0,yr.Z)((0,M.Z)(i),"scaleFactor",void 0),(0,yr.Z)((0,M.Z)(i),"dampingFactor",void 0),(0,yr.Z)((0,M.Z)(i),"wMax",void 0),(0,yr.Z)((0,M.Z)(i),"enableAnimations",void 0),(0,yr.Z)((0,M.Z)(i),"enableGrid",void 0),(0,yr.Z)((0,M.Z)(i),"cursorZoom",void 0),(0,yr.Z)((0,M.Z)(i),"minFov",void 0),(0,yr.Z)((0,M.Z)(i),"maxFov",void 0),(0,yr.Z)((0,M.Z)(i),"enabled",void 0),(0,yr.Z)((0,M.Z)(i),"enablePan",void 0),(0,yr.Z)((0,M.Z)(i),"enableRotate",void 0),(0,yr.Z)((0,M.Z)(i),"enableZoom",void 0),(0,yr.Z)((0,M.Z)(i),"enableGizmos",void 0),(0,yr.Z)((0,M.Z)(i),"minDistance",void 0),(0,yr.Z)((0,M.Z)(i),"maxDistance",void 0),(0,yr.Z)((0,M.Z)(i),"minZoom",void 0),(0,yr.Z)((0,M.Z)(i),"maxZoom",void 0),(0,yr.Z)((0,M.Z)(i),"target",void 0),(0,yr.Z)((0,M.Z)(i),"_currentTarget",void 0),(0,yr.Z)((0,M.Z)(i),"_tbRadius",void 0),(0,yr.Z)((0,M.Z)(i),"_state",void 0),(0,yr.Z)((0,M.Z)(i),"onWindowResize",(function(){var e=(i._gizmos.scale.x+i._gizmos.scale.y+i._gizmos.scale.z)/3;if(null!==i.camera){var t=i.calculateTbRadius(i.camera);void 0!==t&&(i._tbRadius=t)}var n=i._tbRadius/e,r=new d.EllipseCurve(0,0,n,n).getPoints(i._curvePts),a=(new d.BufferGeometry).setFromPoints(r);for(var o in i._gizmos.children){var s=i._gizmos.children[o];s instanceof d.Mesh&&(s.geometry=a)}i.dispatchEvent(qo)})),(0,yr.Z)((0,M.Z)(i),"onContextMenu",(function(e){if(i.enabled)for(var t=0;t<i.mouseActions.length;t++)if(2==i.mouseActions[t].mouse){e.preventDefault();break}})),(0,yr.Z)((0,M.Z)(i),"onPointerCancel",(function(){i._touchStart.splice(0,i._touchStart.length),i._touchCurrent.splice(0,i._touchCurrent.length),i._input=Jo.NONE})),(0,yr.Z)((0,M.Z)(i),"onPointerDown",(function(e){if(0==e.button&&e.isPrimary?(i._downValid=!0,i._downEvents.push(e),i._downStart=performance.now()):i._downValid=!1,"touch"==e.pointerType&&i._input!=Jo.CURSOR)switch(i._touchStart.push(e),i._touchCurrent.push(e),i._input){case Jo.NONE:i._input=Jo.ONE_FINGER,i.onSinglePanStart(e,"ROTATE"),window.addEventListener("pointermove",i.onPointerMove),window.addEventListener("pointerup",i.onPointerUp);break;case Jo.ONE_FINGER:case Jo.ONE_FINGER_SWITCHED:i._input=Jo.TWO_FINGER,i.onRotateStart(),i.onPinchStart(),i.onDoublePanStart();break;case Jo.TWO_FINGER:i._input=Jo.MULT_FINGER,i.onTriplePanStart()}else if("touch"!=e.pointerType&&i._input==Jo.NONE){var t=null;e.ctrlKey||e.metaKey?t="CTRL":e.shiftKey&&(t="SHIFT"),i._mouseOp=i.getOpFromAction(e.button,t),null!=i._mouseOp&&(window.addEventListener("pointermove",i.onPointerMove),window.addEventListener("pointerup",i.onPointerUp),i._input=Jo.CURSOR,i._button=e.button,i.onSinglePanStart(e,i._mouseOp))}})),(0,yr.Z)((0,M.Z)(i),"onPointerMove",(function(e){if("touch"==e.pointerType&&i._input!=Jo.CURSOR)switch(i._input){case Jo.ONE_FINGER:i.updateTouchEvent(e),i.onSinglePanMove(e,Oo.ROTATE);break;case Jo.ONE_FINGER_SWITCHED:if(i.calculatePointersDistance(i._touchCurrent[0],e)*i._devPxRatio>=i._switchSensibility){i._input=Jo.ONE_FINGER,i.updateTouchEvent(e),i.onSinglePanStart(e,"ROTATE");break}break;case Jo.TWO_FINGER:i.updateTouchEvent(e),i.onRotateMove(),i.onPinchMove(),i.onDoublePanMove();break;case Jo.MULT_FINGER:i.updateTouchEvent(e),i.onTriplePanMove()}else if("touch"!=e.pointerType&&i._input==Jo.CURSOR){var t=null;e.ctrlKey||e.metaKey?t="CTRL":e.shiftKey&&(t="SHIFT");var n=i.getOpStateFromAction(i._button,t);null!=n&&i.onSinglePanMove(e,n)}i._downValid&&(i.calculatePointersDistance(i._downEvents[i._downEvents.length-1],e)*i._devPxRatio>i._movementThreshold&&(i._downValid=!1))})),(0,yr.Z)((0,M.Z)(i),"onPointerUp",(function(e){if("touch"==e.pointerType&&i._input!=Jo.CURSOR){for(var t=i._touchCurrent.length,n=0;n<t;n++)if(i._touchCurrent[n].pointerId==e.pointerId){i._touchCurrent.splice(n,1),i._touchStart.splice(n,1);break}switch(i._input){case Jo.ONE_FINGER:case Jo.ONE_FINGER_SWITCHED:window.removeEventListener("pointermove",i.onPointerMove),window.removeEventListener("pointerup",i.onPointerUp),i._input=Jo.NONE,i.onSinglePanEnd();break;case Jo.TWO_FINGER:i.onDoublePanEnd(),i.onPinchEnd(),i.onRotateEnd(),i._input=Jo.ONE_FINGER_SWITCHED;break;case Jo.MULT_FINGER:0==i._touchCurrent.length&&(window.removeEventListener("pointermove",i.onPointerMove),window.removeEventListener("pointerup",i.onPointerUp),i._input=Jo.NONE,i.onTriplePanEnd())}}else"touch"!=e.pointerType&&i._input==Jo.CURSOR&&(window.removeEventListener("pointermove",i.onPointerMove),window.removeEventListener("pointerup",i.onPointerUp),i._input=Jo.NONE,i.onSinglePanEnd(),i._button=-1);if(e.isPrimary)if(i._downValid)if(e.timeStamp-i._downEvents[i._downEvents.length-1].timeStamp<=i._maxDownTime)if(0==i._nclicks)i._nclicks=1,i._clickStart=performance.now();else{var r=e.timeStamp-i._clickStart,a=i.calculatePointersDistance(i._downEvents[1],i._downEvents[0])*i._devPxRatio;r<=i._maxInterval&&a<=i._posThreshold?(i._nclicks=0,i._downEvents.splice(0,i._downEvents.length),i.onDoubleTap(e)):(i._nclicks=1,i._downEvents.shift(),i._clickStart=performance.now())}else i._downValid=!1,i._nclicks=0,i._downEvents.splice(0,i._downEvents.length);else i._nclicks=0,i._downEvents.splice(0,i._downEvents.length)})),(0,yr.Z)((0,M.Z)(i),"onWheel",(function(e){if(i.enabled&&i.enableZoom){var t=null;e.ctrlKey||e.metaKey?t="CTRL":e.shiftKey&&(t="SHIFT");var n=i.getOpFromAction("WHEEL",t);if(null!=n){e.preventDefault(),i.dispatchEvent($o);var r=e.deltaY/125,a=1;switch(r>0?a=1/i.scaleFactor:r<0&&(a=i.scaleFactor),n){case"ZOOM":if(i.updateTbState(Oo.SCALE,!0),r>0?a=1/Math.pow(i.scaleFactor,r):r<0&&(a=Math.pow(i.scaleFactor,-r)),i.cursorZoom&&i.enablePan){var o,s;if(i.camera instanceof d.OrthographicCamera&&i.camera.isOrthographicCamera)o=null===(s=i.unprojectOnTbPlane(i.camera,e.clientX,e.clientY,i.domElement))||void 0===s?void 0:s.applyQuaternion(i.camera.quaternion).multiplyScalar(1/i.camera.zoom).add(i._gizmos.position);else if(i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera){var u;o=null===(u=i.unprojectOnTbPlane(i.camera,e.clientX,e.clientY,i.domElement))||void 0===u?void 0:u.applyQuaternion(i.camera.quaternion).add(i._gizmos.position)}void 0!==o&&i.applyTransformMatrix(i.applyScale(a,o))}else i.applyTransformMatrix(i.applyScale(a,i._gizmos.position));null!=i._grid&&(i.disposeGrid(),i.drawGrid()),i.updateTbState(Oo.IDLE,!1),i.dispatchEvent(qo),i.dispatchEvent(es);break;case"FOV":if(i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera){i.updateTbState(Oo.FOV,!0),0!=e.deltaX&&(a=1,(r=e.deltaX/125)>0?a=1/Math.pow(i.scaleFactor,r):r<0&&(a=Math.pow(i.scaleFactor,-r))),i._v3_1.setFromMatrixPosition(i._cameraMatrixState);var l=i._v3_1.distanceTo(i._gizmos.position),c=l/a;c=d.MathUtils.clamp(c,i.minDistance,i.maxDistance);var g=l*Math.tan(d.MathUtils.DEG2RAD*i.camera.fov*.5),I=d.MathUtils.RAD2DEG*(2*Math.atan(g/c));I>i.maxFov?I=i.maxFov:I<i.minFov&&(I=i.minFov),a=l/(g/Math.tan(d.MathUtils.DEG2RAD*(I/2))),i.setFov(I),i.applyTransformMatrix(i.applyScale(a,i._gizmos.position,!1))}null!=i._grid&&(i.disposeGrid(),i.drawGrid()),i.updateTbState(Oo.IDLE,!1),i.dispatchEvent(qo),i.dispatchEvent(es)}}}})),(0,yr.Z)((0,M.Z)(i),"onKeyDown",(function(e){"c"==e.key?(e.ctrlKey||e.metaKey)&&i.copyState():"v"==e.key&&(e.ctrlKey||e.metaKey)&&i.pasteState()})),(0,yr.Z)((0,M.Z)(i),"onSinglePanStart",(function(e,t){if(i.enabled)switch(i.dispatchEvent($o),i.setCenter(e.clientX,e.clientY),t){case"PAN":if(!i.enablePan)return;if(-1!=i._animationId&&(cancelAnimationFrame(i._animationId),i._animationId=-1,i._timeStart=-1,i.activateGizmos(!1),i.dispatchEvent(qo)),null!==i.camera){i.updateTbState(Oo.PAN,!0);var n=i.unprojectOnTbPlane(i.camera,Qo.x,Qo.y,i.domElement);void 0!==n&&i._startCursorPosition.copy(n),i.enableGrid&&(i.drawGrid(),i.dispatchEvent(qo))}break;case"ROTATE":if(!i.enableRotate)return;if(-1!=i._animationId&&(cancelAnimationFrame(i._animationId),i._animationId=-1,i._timeStart=-1),null!==i.camera){i.updateTbState(Oo.ROTATE,!0);var r=i.unprojectOnTbSurface(i.camera,Qo.x,Qo.y,i.domElement,i._tbRadius);void 0!==r&&i._startCursorPosition.copy(r),i.activateGizmos(!0),i.enableAnimations&&(i._timePrev=i._timeCurrent=performance.now(),i._angleCurrent=i._anglePrev=0,i._cursorPosPrev.copy(i._startCursorPosition),i._cursorPosCurr.copy(i._cursorPosPrev),i._wCurr=0,i._wPrev=i._wCurr)}i.dispatchEvent(qo);break;case"FOV":if(!(i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera)||!i.enableZoom)return;-1!=i._animationId&&(cancelAnimationFrame(i._animationId),i._animationId=-1,i._timeStart=-1,i.activateGizmos(!1),i.dispatchEvent(qo)),i.updateTbState(Oo.FOV,!0),i._startCursorPosition.setY(.5*i.getCursorNDC(Qo.x,Qo.y,i.domElement).y),i._currentCursorPosition.copy(i._startCursorPosition);break;case"ZOOM":if(!i.enableZoom)return;-1!=i._animationId&&(cancelAnimationFrame(i._animationId),i._animationId=-1,i._timeStart=-1,i.activateGizmos(!1),i.dispatchEvent(qo)),i.updateTbState(Oo.SCALE,!0),i._startCursorPosition.setY(.5*i.getCursorNDC(Qo.x,Qo.y,i.domElement).y),i._currentCursorPosition.copy(i._startCursorPosition)}})),(0,yr.Z)((0,M.Z)(i),"onSinglePanMove",(function(e,t){if(i.enabled){var n=t!=i._state;switch(i.setCenter(e.clientX,e.clientY),t){case Oo.PAN:if(i.enablePan&&null!==i.camera)if(n){i.dispatchEvent(es),i.dispatchEvent($o),i.updateTbState(t,!0);var r=i.unprojectOnTbPlane(i.camera,Qo.x,Qo.y,i.domElement);void 0!==r&&i._startCursorPosition.copy(r),i.enableGrid&&i.drawGrid(),i.activateGizmos(!1)}else{var a=i.unprojectOnTbPlane(i.camera,Qo.x,Qo.y,i.domElement);void 0!==a&&i._currentCursorPosition.copy(a),i.applyTransformMatrix(i.pan(i._startCursorPosition,i._currentCursorPosition))}break;case Oo.ROTATE:if(i.enableRotate&&null!==i.camera)if(n){i.dispatchEvent(es),i.dispatchEvent($o),i.updateTbState(t,!0);var o=i.unprojectOnTbSurface(i.camera,Qo.x,Qo.y,i.domElement,i._tbRadius);void 0!==o&&i._startCursorPosition.copy(o),i.enableGrid&&i.disposeGrid(),i.activateGizmos(!0)}else{var s=i.unprojectOnTbSurface(i.camera,Qo.x,Qo.y,i.domElement,i._tbRadius);void 0!==s&&i._currentCursorPosition.copy(s);var u=i._startCursorPosition.distanceTo(i._currentCursorPosition),l=i._startCursorPosition.angleTo(i._currentCursorPosition),c=Math.max(u/i._tbRadius,l);i.applyTransformMatrix(i.rotate(i.calculateRotationAxis(i._startCursorPosition,i._currentCursorPosition),c)),i.enableAnimations&&(i._timePrev=i._timeCurrent,i._timeCurrent=performance.now(),i._anglePrev=i._angleCurrent,i._angleCurrent=c,i._cursorPosPrev.copy(i._cursorPosCurr),i._cursorPosCurr.copy(i._currentCursorPosition),i._wPrev=i._wCurr,i._wCurr=i.calculateAngularSpeed(i._anglePrev,i._angleCurrent,i._timePrev,i._timeCurrent))}break;case Oo.SCALE:if(i.enableZoom)if(n)i.dispatchEvent(es),i.dispatchEvent($o),i.updateTbState(t,!0),i._startCursorPosition.setY(.5*i.getCursorNDC(Qo.x,Qo.y,i.domElement).y),i._currentCursorPosition.copy(i._startCursorPosition),i.enableGrid&&i.disposeGrid(),i.activateGizmos(!1);else{i._currentCursorPosition.setY(.5*i.getCursorNDC(Qo.x,Qo.y,i.domElement).y);var g=i._currentCursorPosition.y-i._startCursorPosition.y,I=1;g<0?I=1/Math.pow(i.scaleFactor,8*-g):g>0&&(I=Math.pow(i.scaleFactor,8*g)),i.applyTransformMatrix(i.applyScale(I,i._gizmos.position))}break;case Oo.FOV:if(i.enableZoom&&i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera)if(n)i.dispatchEvent(es),i.dispatchEvent($o),i.updateTbState(t,!0),i._startCursorPosition.setY(.5*i.getCursorNDC(Qo.x,Qo.y,i.domElement).y),i._currentCursorPosition.copy(i._startCursorPosition),i.enableGrid&&i.disposeGrid(),i.activateGizmos(!1);else{i._currentCursorPosition.setY(.5*i.getCursorNDC(Qo.x,Qo.y,i.domElement).y);var C=i._currentCursorPosition.y-i._startCursorPosition.y,h=1;C<0?h=1/Math.pow(i.scaleFactor,8*-C):C>0&&(h=Math.pow(i.scaleFactor,8*C)),i._v3_1.setFromMatrixPosition(i._cameraMatrixState);var f=i._v3_1.distanceTo(i._gizmos.position),p=f/h;p=d.MathUtils.clamp(p,i.minDistance,i.maxDistance);var A=f*Math.tan(d.MathUtils.DEG2RAD*i._fovState*.5),m=d.MathUtils.RAD2DEG*(2*Math.atan(A/p));m=d.MathUtils.clamp(m,i.minFov,i.maxFov);var v=A/Math.tan(d.MathUtils.DEG2RAD*(m/2));h=f/v,i._v3_2.setFromMatrixPosition(i._gizmoMatrixState),i.setFov(m),i.applyTransformMatrix(i.applyScale(h,i._v3_2,!1));var b=i._gizmos.position.clone().sub(i.camera.position).normalize().multiplyScalar(v/f);i._m4_1.makeTranslation(b.x,b.y,b.z)}}i.dispatchEvent(qo)}})),(0,yr.Z)((0,M.Z)(i),"onSinglePanEnd",(function(){if(i._state==Oo.ROTATE){if(!i.enableRotate)return;if(i.enableAnimations)if(performance.now()-i._timeCurrent<120){var e=Math.abs((i._wPrev+i._wCurr)/2),t=(0,M.Z)(i);i._animationId=window.requestAnimationFrame((function(n){t.updateTbState(Oo.ANIMATION_ROTATE,!0);var r=t.calculateRotationAxis(t._cursorPosPrev,t._cursorPosCurr);t.onRotationAnim(n,r,Math.min(e,t.wMax))}))}else i.updateTbState(Oo.IDLE,!1),i.activateGizmos(!1),i.dispatchEvent(qo);else i.updateTbState(Oo.IDLE,!1),i.activateGizmos(!1),i.dispatchEvent(qo)}else i._state!=Oo.PAN&&i._state!=Oo.IDLE||(i.updateTbState(Oo.IDLE,!1),i.enableGrid&&i.disposeGrid(),i.activateGizmos(!1),i.dispatchEvent(qo));i.dispatchEvent(es)})),(0,yr.Z)((0,M.Z)(i),"onDoubleTap",(function(e){if(i.enabled&&i.enablePan&&null!=i.scene&&null!==i.camera){i.dispatchEvent($o),i.setCenter(e.clientX,e.clientY);var t=i.unprojectOnObj(i.getCursorNDC(Qo.x,Qo.y,i.domElement),i.camera);if(null!=t&&i.enableAnimations){var n=(0,M.Z)(i);-1!=i._animationId&&window.cancelAnimationFrame(i._animationId),i._timeStart=-1,i._animationId=window.requestAnimationFrame((function(e){n.updateTbState(Oo.ANIMATION_FOCUS,!0),n.onFocusAnim(e,t,n._cameraMatrixState,n._gizmoMatrixState)}))}else null==t||i.enableAnimations||(i.updateTbState(Oo.FOCUS,!0),i.focus(t,i.scaleFactor),i.updateTbState(Oo.IDLE,!1),i.dispatchEvent(qo))}i.dispatchEvent(es)})),(0,yr.Z)((0,M.Z)(i),"onDoublePanStart",(function(){if(i.enabled&&i.enablePan&&null!==i.camera){i.dispatchEvent($o),i.updateTbState(Oo.PAN,!0),i.setCenter((i._touchCurrent[0].clientX+i._touchCurrent[1].clientX)/2,(i._touchCurrent[0].clientY+i._touchCurrent[1].clientY)/2);var e=i.unprojectOnTbPlane(i.camera,Qo.x,Qo.y,i.domElement,!0);void 0!==e&&i._startCursorPosition.copy(e),i._currentCursorPosition.copy(i._startCursorPosition),i.activateGizmos(!1)}})),(0,yr.Z)((0,M.Z)(i),"onDoublePanMove",(function(){if(i.enabled&&i.enablePan&&null!==i.camera){i.setCenter((i._touchCurrent[0].clientX+i._touchCurrent[1].clientX)/2,(i._touchCurrent[0].clientY+i._touchCurrent[1].clientY)/2),i._state!=Oo.PAN&&(i.updateTbState(Oo.PAN,!0),i._startCursorPosition.copy(i._currentCursorPosition));var e=i.unprojectOnTbPlane(i.camera,Qo.x,Qo.y,i.domElement,!0);void 0!==e&&i._currentCursorPosition.copy(e),i.applyTransformMatrix(i.pan(i._startCursorPosition,i._currentCursorPosition,!0)),i.dispatchEvent(qo)}})),(0,yr.Z)((0,M.Z)(i),"onDoublePanEnd",(function(){i.updateTbState(Oo.IDLE,!1),i.dispatchEvent(es)})),(0,yr.Z)((0,M.Z)(i),"onRotateStart",(function(){var e;i.enabled&&i.enableRotate&&(i.dispatchEvent($o),i.updateTbState(Oo.ZROTATE,!0),i._startFingerRotation=i.getAngle(i._touchCurrent[1],i._touchCurrent[0])+i.getAngle(i._touchStart[1],i._touchStart[0]),i._currentFingerRotation=i._startFingerRotation,null===(e=i.camera)||void 0===e||e.getWorldDirection(i._rotationAxis),i.enablePan||i.enableZoom||i.activateGizmos(!0))})),(0,yr.Z)((0,M.Z)(i),"onRotateMove",(function(){if(i.enabled&&i.enableRotate&&null!==i.camera){var e;if(i.setCenter((i._touchCurrent[0].clientX+i._touchCurrent[1].clientX)/2,(i._touchCurrent[0].clientY+i._touchCurrent[1].clientY)/2),i._state!=Oo.ZROTATE&&(i.updateTbState(Oo.ZROTATE,!0),i._startFingerRotation=i._currentFingerRotation),i._currentFingerRotation=i.getAngle(i._touchCurrent[1],i._touchCurrent[0])+i.getAngle(i._touchStart[1],i._touchStart[0]),i.enablePan){if(i.camera instanceof d.PerspectiveCamera||i.camera instanceof d.OrthographicCamera){var t;i._v3_2.setFromMatrixPosition(i._gizmoMatrixState),e=null===(t=i.unprojectOnTbPlane(i.camera,Qo.x,Qo.y,i.domElement))||void 0===t?void 0:t.applyQuaternion(i.camera.quaternion).multiplyScalar(1/i.camera.zoom).add(i._v3_2)}}else e=(new d.Vector3).setFromMatrixPosition(i._gizmoMatrixState);var n=d.MathUtils.DEG2RAD*(i._startFingerRotation-i._currentFingerRotation);void 0!==e&&i.applyTransformMatrix(i.zRotate(e,n)),i.dispatchEvent(qo)}})),(0,yr.Z)((0,M.Z)(i),"onRotateEnd",(function(){i.updateTbState(Oo.IDLE,!1),i.activateGizmos(!1),i.dispatchEvent(es)})),(0,yr.Z)((0,M.Z)(i),"onPinchStart",(function(){i.enabled&&i.enableZoom&&(i.dispatchEvent($o),i.updateTbState(Oo.SCALE,!0),i._startFingerDistance=i.calculatePointersDistance(i._touchCurrent[0],i._touchCurrent[1]),i._currentFingerDistance=i._startFingerDistance,i.activateGizmos(!1))})),(0,yr.Z)((0,M.Z)(i),"onPinchMove",(function(){if(i.enabled&&i.enableZoom){i.setCenter((i._touchCurrent[0].clientX+i._touchCurrent[1].clientX)/2,(i._touchCurrent[0].clientY+i._touchCurrent[1].clientY)/2);i._state!=Oo.SCALE&&(i._startFingerDistance=i._currentFingerDistance,i.updateTbState(Oo.SCALE,!0)),i._currentFingerDistance=Math.max(i.calculatePointersDistance(i._touchCurrent[0],i._touchCurrent[1]),12*i._devPxRatio);var e,t,n=i._currentFingerDistance/i._startFingerDistance;if(i.enablePan){if(i.camera instanceof d.OrthographicCamera&&i.camera.isOrthographicCamera)e=null===(t=i.unprojectOnTbPlane(i.camera,Qo.x,Qo.y,i.domElement))||void 0===t?void 0:t.applyQuaternion(i.camera.quaternion).multiplyScalar(1/i.camera.zoom).add(i._gizmos.position);else if(i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera){var r;e=null===(r=i.unprojectOnTbPlane(i.camera,Qo.x,Qo.y,i.domElement))||void 0===r?void 0:r.applyQuaternion(i.camera.quaternion).add(i._gizmos.position)}}else e=i._gizmos.position;void 0!==e&&i.applyTransformMatrix(i.applyScale(n,e)),i.dispatchEvent(qo)}})),(0,yr.Z)((0,M.Z)(i),"onPinchEnd",(function(){i.updateTbState(Oo.IDLE,!1),i.dispatchEvent(es)})),(0,yr.Z)((0,M.Z)(i),"onTriplePanStart",(function(){if(i.enabled&&i.enableZoom){i.dispatchEvent($o),i.updateTbState(Oo.SCALE,!0);for(var e=0,t=0,n=i._touchCurrent.length,r=0;r<n;r++)e+=i._touchCurrent[r].clientX,t+=i._touchCurrent[r].clientY;i.setCenter(e/n,t/n),i._startCursorPosition.setY(.5*i.getCursorNDC(Qo.x,Qo.y,i.domElement).y),i._currentCursorPosition.copy(i._startCursorPosition)}})),(0,yr.Z)((0,M.Z)(i),"onTriplePanMove",(function(){if(i.enabled&&i.enableZoom&&null!==i.camera){for(var e=0,t=0,n=i._touchCurrent.length,r=0;r<n;r++)e+=i._touchCurrent[r].clientX,t+=i._touchCurrent[r].clientY;i.setCenter(e/n,t/n);i._currentCursorPosition.setY(.5*i.getCursorNDC(Qo.x,Qo.y,i.domElement).y);var a=i._currentCursorPosition.y-i._startCursorPosition.y,o=1;a<0?o=1/Math.pow(i.scaleFactor,8*-a):a>0&&(o=Math.pow(i.scaleFactor,8*a)),i._v3_1.setFromMatrixPosition(i._cameraMatrixState);var s=i._v3_1.distanceTo(i._gizmos.position),u=s/o;u=d.MathUtils.clamp(u,i.minDistance,i.maxDistance);var l=s*Math.tan(d.MathUtils.DEG2RAD*i._fovState*.5),c=d.MathUtils.RAD2DEG*(2*Math.atan(l/u));c=d.MathUtils.clamp(c,i.minFov,i.maxFov);var g=l/Math.tan(d.MathUtils.DEG2RAD*(c/2));o=s/g,i._v3_2.setFromMatrixPosition(i._gizmoMatrixState),i.setFov(c),i.applyTransformMatrix(i.applyScale(o,i._v3_2,!1));var I=i._gizmos.position.clone().sub(i.camera.position).normalize().multiplyScalar(g/s);i._m4_1.makeTranslation(I.x,I.y,I.z),i.dispatchEvent(qo)}})),(0,yr.Z)((0,M.Z)(i),"onTriplePanEnd",(function(){i.updateTbState(Oo.IDLE,!1),i.dispatchEvent(es)})),(0,yr.Z)((0,M.Z)(i),"setCenter",(function(e,t){Qo.x=e,Qo.y=t})),(0,yr.Z)((0,M.Z)(i),"initializeMouseActions",(function(){i.setMouseAction("PAN",0,"CTRL"),i.setMouseAction("PAN",2),i.setMouseAction("ROTATE",0),i.setMouseAction("ZOOM","WHEEL"),i.setMouseAction("ZOOM",1),i.setMouseAction("FOV","WHEEL","SHIFT"),i.setMouseAction("FOV",1,"SHIFT")})),(0,yr.Z)((0,M.Z)(i),"compareMouseAction",(function(e,t){return e.operation==t.operation&&(e.mouse==t.mouse&&e.key==t.key)})),(0,yr.Z)((0,M.Z)(i),"setMouseAction",(function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=["PAN","ROTATE","ZOOM","FOV"],o=[0,1,2,"WHEEL"],s=["CTRL","SHIFT",null];if(!a.includes(e)||!o.includes(t)||!s.includes(r))return!1;if("WHEEL"==t&&"ZOOM"!=e&&"FOV"!=e)return!1;switch(e){case"PAN":n=Oo.PAN;break;case"ROTATE":n=Oo.ROTATE;break;case"ZOOM":n=Oo.SCALE;break;case"FOV":n=Oo.FOV}for(var u={operation:e,mouse:t,key:r,state:n},l=0;l<i.mouseActions.length;l++)if(i.mouseActions[l].mouse==u.mouse&&i.mouseActions[l].key==u.key)return i.mouseActions.splice(l,1,u),!0;return i.mouseActions.push(u),!0})),(0,yr.Z)((0,M.Z)(i),"unsetMouseAction",(function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0;n<i.mouseActions.length;n++)if(i.mouseActions[n].mouse==e&&i.mouseActions[n].key==t)return i.mouseActions.splice(n,1),!0;return!1})),(0,yr.Z)((0,M.Z)(i),"getOpFromAction",(function(e,t){for(var n,r=0;r<i.mouseActions.length;r++)if((n=i.mouseActions[r]).mouse==e&&n.key==t)return n.operation;if(null!=t)for(var a=0;a<i.mouseActions.length;a++)if((n=i.mouseActions[a]).mouse==e&&null==n.key)return n.operation;return null})),(0,yr.Z)((0,M.Z)(i),"getOpStateFromAction",(function(e,t){for(var n,r=0;r<i.mouseActions.length;r++)if((n=i.mouseActions[r]).mouse==e&&n.key==t)return n.state;if(null!=t)for(var a=0;a<i.mouseActions.length;a++)if((n=i.mouseActions[a]).mouse==e&&null==n.key)return n.state;return null})),(0,yr.Z)((0,M.Z)(i),"getAngle",(function(e,t){return 180*Math.atan2(t.clientY-e.clientY,t.clientX-e.clientX)/Math.PI})),(0,yr.Z)((0,M.Z)(i),"updateTouchEvent",(function(e){for(var t=0;t<i._touchCurrent.length;t++)if(i._touchCurrent[t].pointerId==e.pointerId){i._touchCurrent.splice(t,1,e);break}})),(0,yr.Z)((0,M.Z)(i),"calculateAngularSpeed",(function(e,t,n,r){var i=(r-n)/1e3;return 0==i?0:(t-e)/i})),(0,yr.Z)((0,M.Z)(i),"calculatePointersDistance",(function(e,t){return Math.sqrt(Math.pow(t.clientX-e.clientX,2)+Math.pow(t.clientY-e.clientY,2))})),(0,yr.Z)((0,M.Z)(i),"calculateRotationAxis",(function(e,t){return i._rotationMatrix.extractRotation(i._cameraMatrixState),i._quat.setFromRotationMatrix(i._rotationMatrix),i._rotationAxis.crossVectors(e,t).applyQuaternion(i._quat),i._rotationAxis.normalize().clone()})),(0,yr.Z)((0,M.Z)(i),"calculateTbRadius",(function(e){var t=e.position.distanceTo(i._gizmos.position);if("PerspectiveCamera"==e.type&&e instanceof d.PerspectiveCamera){var n=d.MathUtils.DEG2RAD*e.fov*.5,r=Math.atan(e.aspect*Math.tan(n));return Math.tan(Math.min(n,r))*t*.67}if("OrthographicCamera"==e.type&&e instanceof d.OrthographicCamera)return.67*Math.min(e.top,e.right)})),(0,yr.Z)((0,M.Z)(i),"focus",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(null!==i.camera){var r=e.clone();r.sub(i._gizmos.position).multiplyScalar(n),i._translationMatrix.makeTranslation(r.x,r.y,r.z);var a=i._gizmoMatrixState.clone();i._gizmoMatrixState.premultiply(i._translationMatrix),i._gizmoMatrixState.decompose(i._gizmos.position,i._gizmos.quaternion,i._gizmos.scale);var o=i._cameraMatrixState.clone();i._cameraMatrixState.premultiply(i._translationMatrix),i._cameraMatrixState.decompose(i.camera.position,i.camera.quaternion,i.camera.scale),i.enableZoom&&i.applyTransformMatrix(i.applyScale(t,i._gizmos.position)),i._gizmoMatrixState.copy(a),i._cameraMatrixState.copy(o)}})),(0,yr.Z)((0,M.Z)(i),"drawGrid",(function(){if(null!=i.scene){var e,t,n,r,a=8947848;if(i.camera instanceof d.OrthographicCamera&&i.camera.isOrthographicCamera){var o=i.camera.right-i.camera.left,s=i.camera.bottom-i.camera.top;r=(n=Math.max(o,s))/20,t=(e=n/i.camera.zoom*3)/r*i.camera.zoom}else if(i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera){var u=i.camera.position.distanceTo(i._gizmos.position),l=d.MathUtils.DEG2RAD*i.camera.fov*.5,c=Math.atan(i.camera.aspect*Math.tan(l));t=(e=3*(n=Math.tan(Math.max(l,c))*u*2))/(r=n/20)}null==i._grid&&null!==i.camera&&(i._grid=new d.GridHelper(e,t,a,a),i._grid.position.copy(i._gizmos.position),i._gridPosition.copy(i._grid.position),i._grid.quaternion.copy(i.camera.quaternion),i._grid.rotateX(.5*Math.PI),i.scene.add(i._grid))}})),(0,yr.Z)((0,M.Z)(i),"dispose",(function(){var e;-1!=i._animationId&&window.cancelAnimationFrame(i._animationId),i.domElement.removeEventListener("pointerdown",i.onPointerDown),i.domElement.removeEventListener("pointercancel",i.onPointerCancel),i.domElement.removeEventListener("wheel",i.onWheel),i.domElement.removeEventListener("contextmenu",i.onContextMenu),window.removeEventListener("pointermove",i.onPointerMove),window.removeEventListener("pointerup",i.onPointerUp),window.removeEventListener("resize",i.onWindowResize),window.addEventListener("keydown",i.onKeyDown),null===(e=i.scene)||void 0===e||e.remove(i._gizmos),i.disposeGrid()})),(0,yr.Z)((0,M.Z)(i),"disposeGrid",(function(){null!=i._grid&&null!=i.scene&&(i.scene.remove(i._grid),i._grid=null)})),(0,yr.Z)((0,M.Z)(i),"easeOutCubic",(function(e){return 1-Math.pow(1-e,3)})),(0,yr.Z)((0,M.Z)(i),"activateGizmos",(function(e){var t=i._gizmos.children[0],n=i._gizmos.children[1],r=i._gizmos.children[2];e?(t.material.setValues({opacity:1}),n.material.setValues({opacity:1}),r.material.setValues({opacity:1})):(t.material.setValues({opacity:.6}),n.material.setValues({opacity:.6}),r.material.setValues({opacity:.6}))})),(0,yr.Z)((0,M.Z)(i),"getCursorNDC",(function(e,t,n){var r=n.getBoundingClientRect();return i._v2_1.setX((e-r.left)/r.width*2-1),i._v2_1.setY((r.bottom-t)/r.height*2-1),i._v2_1.clone()})),(0,yr.Z)((0,M.Z)(i),"getCursorPosition",(function(e,t,n){return i._v2_1.copy(i.getCursorNDC(e,t,n)),i.camera instanceof d.OrthographicCamera&&(i._v2_1.x*=.5*(i.camera.right-i.camera.left),i._v2_1.y*=.5*(i.camera.top-i.camera.bottom)),i._v2_1.clone()})),(0,yr.Z)((0,M.Z)(i),"setCamera",(function(e){if(e instanceof d.PerspectiveCamera||e instanceof d.OrthographicCamera){e.lookAt(i.target),e.updateMatrix(),"PerspectiveCamera"==(null===e||void 0===e?void 0:e.type)&&e instanceof d.PerspectiveCamera&&(i._fov0=e.fov,i._fovState=e.fov),i._cameraMatrixState0.copy(e.matrix),i._cameraMatrixState.copy(i._cameraMatrixState0),i._cameraProjectionState.copy(e.projectionMatrix),i._zoom0=e.zoom,i._zoomState=i._zoom0,i._initialNear=e.near,i._nearPos0=e.position.distanceTo(i.target)-e.near,i._nearPos=i._initialNear,i._initialFar=e.far,i._farPos0=e.position.distanceTo(i.target)-e.far,i._farPos=i._initialFar,i._up0.copy(e.up),i._upState.copy(e.up),i.camera=e,(i.camera instanceof d.PerspectiveCamera||i.camera instanceof d.OrthographicCamera)&&i.camera.updateProjectionMatrix();var t=i.calculateTbRadius(e);void 0!==t&&(i._tbRadius=t),i.makeGizmos(i.target,i._tbRadius)}})),(0,yr.Z)((0,M.Z)(i),"makeGizmos",(function(e,t){var n=new d.EllipseCurve(0,0,t,t).getPoints(i._curvePts),r=(new d.BufferGeometry).setFromPoints(n),a=new d.LineBasicMaterial({color:16744576,fog:!1,transparent:!0,opacity:.6}),o=new d.LineBasicMaterial({color:8454016,fog:!1,transparent:!0,opacity:.6}),s=new d.LineBasicMaterial({color:8421631,fog:!1,transparent:!0,opacity:.6}),u=new d.Line(r,a),l=new d.Line(r,o),c=new d.Line(r,s),g=.5*Math.PI;if(u.rotation.x=g,l.rotation.y=g,i._gizmoMatrixState0.identity().setPosition(e),i._gizmoMatrixState.copy(i._gizmoMatrixState0),(i.camera instanceof d.PerspectiveCamera||i.camera instanceof d.OrthographicCamera)&&1!=i.camera.zoom){var I=1/i.camera.zoom;i._scaleMatrix.makeScale(I,I,I),i._translationMatrix.makeTranslation(-e.x,-e.y,-e.z),i._gizmoMatrixState.premultiply(i._translationMatrix).premultiply(i._scaleMatrix),i._translationMatrix.makeTranslation(e.x,e.y,e.z),i._gizmoMatrixState.premultiply(i._translationMatrix)}i._gizmoMatrixState.decompose(i._gizmos.position,i._gizmos.quaternion,i._gizmos.scale),i._gizmos.clear(),i._gizmos.add(u),i._gizmos.add(l),i._gizmos.add(c)})),(0,yr.Z)((0,M.Z)(i),"onFocusAnim",(function(e,t,n,r){if(-1==i._timeStart&&(i._timeStart=e),i._state==Oo.ANIMATION_FOCUS){var a=(e-i._timeStart)/i.focusAnimationTime;if(i._gizmoMatrixState.copy(r),a>=1)i._gizmoMatrixState.decompose(i._gizmos.position,i._gizmos.quaternion,i._gizmos.scale),i.focus(t,i.scaleFactor),i._timeStart=-1,i.updateTbState(Oo.IDLE,!1),i.activateGizmos(!1),i.dispatchEvent(qo);else{var o=i.easeOutCubic(a),s=1-o+i.scaleFactor*o;i._gizmoMatrixState.decompose(i._gizmos.position,i._gizmos.quaternion,i._gizmos.scale),i.focus(t,s,o),i.dispatchEvent(qo);var u=(0,M.Z)(i);i._animationId=window.requestAnimationFrame((function(e){u.onFocusAnim(e,t,n,r.clone())}))}}else i._animationId=-1,i._timeStart=-1})),(0,yr.Z)((0,M.Z)(i),"onRotationAnim",(function(e,t,n){if(-1==i._timeStart&&(i._anglePrev=0,i._angleCurrent=0,i._timeStart=e),i._state==Oo.ANIMATION_ROTATE){var r=(e-i._timeStart)/1e3;if(n+-i.dampingFactor*r>0){i._angleCurrent=.5*-i.dampingFactor*Math.pow(r,2)+n*r+0,i.applyTransformMatrix(i.rotate(t,i._angleCurrent)),i.dispatchEvent(qo);var a=(0,M.Z)(i);i._animationId=window.requestAnimationFrame((function(e){a.onRotationAnim(e,t,n)}))}else i._animationId=-1,i._timeStart=-1,i.updateTbState(Oo.IDLE,!1),i.activateGizmos(!1),i.dispatchEvent(qo)}else i._animationId=-1,i._timeStart=-1,i._state!=Oo.ROTATE&&(i.activateGizmos(!1),i.dispatchEvent(qo))})),(0,yr.Z)((0,M.Z)(i),"pan",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null!==i.camera){var r=e.clone().sub(t);if(i.camera instanceof d.OrthographicCamera&&i.camera.isOrthographicCamera)r.multiplyScalar(1/i.camera.zoom);else if(i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera&&n){i._v3_1.setFromMatrixPosition(i._cameraMatrixState0),i._v3_2.setFromMatrixPosition(i._gizmoMatrixState0);var a=i._v3_1.distanceTo(i._v3_2)/i.camera.position.distanceTo(i._gizmos.position);r.multiplyScalar(1/a)}i._v3_1.set(r.x,r.y,0).applyQuaternion(i.camera.quaternion),i._m4_1.makeTranslation(i._v3_1.x,i._v3_1.y,i._v3_1.z),i.setTransformationMatrices(i._m4_1,i._m4_1)}return jo})),(0,yr.Z)((0,M.Z)(i),"reset",(function(){if(i.camera instanceof d.PerspectiveCamera||i.camera instanceof d.OrthographicCamera){i.camera.zoom=i._zoom0,i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera&&(i.camera.fov=i._fov0),i.camera.near=i._nearPos,i.camera.far=i._farPos,i._cameraMatrixState.copy(i._cameraMatrixState0),i._cameraMatrixState.decompose(i.camera.position,i.camera.quaternion,i.camera.scale),i.camera.up.copy(i._up0),i.camera.updateMatrix(),i.camera.updateProjectionMatrix(),i._gizmoMatrixState.copy(i._gizmoMatrixState0),i._gizmoMatrixState0.decompose(i._gizmos.position,i._gizmos.quaternion,i._gizmos.scale),i._gizmos.updateMatrix();var e=i.calculateTbRadius(i.camera);void 0!==e&&(i._tbRadius=e),i.makeGizmos(i._gizmos.position,i._tbRadius),i.camera.lookAt(i._gizmos.position),i.updateTbState(Oo.IDLE,!1),i.dispatchEvent(qo)}})),(0,yr.Z)((0,M.Z)(i),"rotate",(function(e,t){var n=i._gizmos.position;return i._translationMatrix.makeTranslation(-n.x,-n.y,-n.z),i._rotationMatrix.makeRotationAxis(e,-t),i._m4_1.makeTranslation(n.x,n.y,n.z),i._m4_1.multiply(i._rotationMatrix),i._m4_1.multiply(i._translationMatrix),i.setTransformationMatrices(i._m4_1),jo})),(0,yr.Z)((0,M.Z)(i),"copyState",(function(){var e;i.camera instanceof d.OrthographicCamera&&i.camera.isOrthographicCamera?e=JSON.stringify({arcballState:{cameraFar:i.camera.far,cameraMatrix:i.camera.matrix,cameraNear:i.camera.near,cameraUp:i.camera.up,cameraZoom:i.camera.zoom,gizmoMatrix:i._gizmos.matrix}}):i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera&&(e=JSON.stringify({arcballState:{cameraFar:i.camera.far,cameraFov:i.camera.fov,cameraMatrix:i.camera.matrix,cameraNear:i.camera.near,cameraUp:i.camera.up,cameraZoom:i.camera.zoom,gizmoMatrix:i._gizmos.matrix}})),void 0!==e&&navigator.clipboard.writeText(e)})),(0,yr.Z)((0,M.Z)(i),"pasteState",(function(){var e=(0,M.Z)(i);navigator.clipboard.readText().then((function(t){e.setStateFromJSON(t)}))})),(0,yr.Z)((0,M.Z)(i),"saveState",(function(){(i.camera instanceof d.PerspectiveCamera||i.camera instanceof d.OrthographicCamera)&&(i._cameraMatrixState0.copy(i.camera.matrix),i._gizmoMatrixState0.copy(i._gizmos.matrix),i._nearPos=i.camera.near,i._farPos=i.camera.far,i._zoom0=i.camera.zoom,i._up0.copy(i.camera.up),i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera&&(i._fov0=i.camera.fov))})),(0,yr.Z)((0,M.Z)(i),"applyScale",(function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.clone(),a=1/e;if(i.camera instanceof d.OrthographicCamera&&i.camera.isOrthographicCamera){i.camera.zoom=i._zoomState,i.camera.zoom*=e,i.camera.zoom>i.maxZoom?(i.camera.zoom=i.maxZoom,a=i._zoomState/i.maxZoom):i.camera.zoom<i.minZoom&&(i.camera.zoom=i.minZoom,a=i._zoomState/i.minZoom),i.camera.updateProjectionMatrix(),i._v3_1.setFromMatrixPosition(i._gizmoMatrixState),i._scaleMatrix.makeScale(a,a,a),i._translationMatrix.makeTranslation(-i._v3_1.x,-i._v3_1.y,-i._v3_1.z),i._m4_2.makeTranslation(i._v3_1.x,i._v3_1.y,i._v3_1.z).multiply(i._scaleMatrix),i._m4_2.multiply(i._translationMatrix),r.sub(i._v3_1);var o=r.clone().multiplyScalar(a);return r.sub(o),i._m4_1.makeTranslation(r.x,r.y,r.z),i._m4_2.premultiply(i._m4_1),i.setTransformationMatrices(i._m4_1,i._m4_2),jo}if(i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera){i._v3_1.setFromMatrixPosition(i._cameraMatrixState),i._v3_2.setFromMatrixPosition(i._gizmoMatrixState);var s=i._v3_1.distanceTo(r),u=s-s*a,l=s-u;l<i.minDistance?u=s-s*(a=i.minDistance/s):l>i.maxDistance&&(u=s-s*(a=i.maxDistance/s));var c=r.clone().sub(i._v3_1).normalize().multiplyScalar(u);if(i._m4_1.makeTranslation(c.x,c.y,c.z),n){var g=i._v3_2;u=(s=g.distanceTo(r))-s*a,c=r.clone().sub(i._v3_2).normalize().multiplyScalar(u),i._translationMatrix.makeTranslation(g.x,g.y,g.z),i._scaleMatrix.makeScale(a,a,a),i._m4_2.makeTranslation(c.x,c.y,c.z).multiply(i._translationMatrix),i._m4_2.multiply(i._scaleMatrix),i._translationMatrix.makeTranslation(-g.x,-g.y,-g.z),i._m4_2.multiply(i._translationMatrix),i.setTransformationMatrices(i._m4_1,i._m4_2)}else i.setTransformationMatrices(i._m4_1);return jo}})),(0,yr.Z)((0,M.Z)(i),"setFov",(function(e){i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera&&(i.camera.fov=d.MathUtils.clamp(e,i.minFov,i.maxFov),i.camera.updateProjectionMatrix())})),(0,yr.Z)((0,M.Z)(i),"setTarget",(function(e,t,n){if(null!==i.camera){i.target.set(e,t,n),i._gizmos.position.set(e,t,n);var r=i.calculateTbRadius(i.camera);void 0!==r&&(i._tbRadius=r),i.makeGizmos(i.target,i._tbRadius),i.camera.lookAt(i.target)}})),(0,yr.Z)((0,M.Z)(i),"zRotate",(function(e,t){return i._rotationMatrix.makeRotationAxis(i._rotationAxis,t),i._translationMatrix.makeTranslation(-e.x,-e.y,-e.z),i._m4_1.makeTranslation(e.x,e.y,e.z),i._m4_1.multiply(i._rotationMatrix),i._m4_1.multiply(i._translationMatrix),i._v3_1.setFromMatrixPosition(i._gizmoMatrixState).sub(e),i._v3_2.copy(i._v3_1).applyAxisAngle(i._rotationAxis,t),i._v3_2.sub(i._v3_1),i._m4_2.makeTranslation(i._v3_2.x,i._v3_2.y,i._v3_2.z),i.setTransformationMatrices(i._m4_1,i._m4_2),jo})),(0,yr.Z)((0,M.Z)(i),"unprojectOnObj",(function(e,t){if((t instanceof d.PerspectiveCamera||t instanceof d.OrthographicCamera)&&null!=i.scene){var n=new d.Raycaster;n.near=t.near,n.far=t.far,n.setFromCamera(e,t);for(var r=n.intersectObjects(i.scene.children,!0),a=0;a<r.length;a++)if(r[a].object.uuid!=i._gizmos.uuid&&null!=r[a].face)return r[a].point.clone()}return null})),(0,yr.Z)((0,M.Z)(i),"unprojectOnTbSurface",(function(e,t,n,r,a){if("OrthographicCamera"==e.type){i._v2_1.copy(i.getCursorPosition(t,n,r)),i._v3_1.set(i._v2_1.x,i._v2_1.y,0);var o=Math.pow(i._v2_1.x,2),s=Math.pow(i._v2_1.y,2),u=Math.pow(i._tbRadius,2);return o+s<=.5*u?i._v3_1.setZ(Math.sqrt(u-(o+s))):i._v3_1.setZ(.5*u/Math.sqrt(o+s)),i._v3_1}if("PerspectiveCamera"==e.type){i._v2_1.copy(i.getCursorNDC(t,n,r)),i._v3_1.set(i._v2_1.x,i._v2_1.y,-1),i._v3_1.applyMatrix4(e.projectionMatrixInverse);var l=i._v3_1.clone().normalize(),c=e.position.distanceTo(i._gizmos.position),g=Math.pow(a,2),I=i._v3_1.z,C=Math.sqrt(Math.pow(i._v3_1.x,2)+Math.pow(i._v3_1.y,2));if(0==C)return l.set(i._v3_1.x,i._v3_1.y,a),l;var h=I/C,f=c,p=Math.pow(h,2)+1,A=2*h*f,m=Math.pow(f,2)-g,v=Math.pow(A,2)-4*p*m;if(v>=0)if(i._v2_1.setX((-A-Math.sqrt(v))/(2*p)),i._v2_1.setY(h*i._v2_1.x+f),d.MathUtils.RAD2DEG*i._v2_1.angle()>=45){var b=Math.sqrt(Math.pow(i._v2_1.x,2)+Math.pow(c-i._v2_1.y,2));return l.multiplyScalar(b),l.z+=c,l}p=h,A=f,m=.5*-g,v=Math.pow(A,2)-4*p*m,i._v2_1.setX((-A-Math.sqrt(v))/(2*p)),i._v2_1.setY(h*i._v2_1.x+f);var y=Math.sqrt(Math.pow(i._v2_1.x,2)+Math.pow(c-i._v2_1.y,2));return l.multiplyScalar(y),l.z+=c,l}})),(0,yr.Z)((0,M.Z)(i),"unprojectOnTbPlane",(function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("OrthographicCamera"==e.type)return i._v2_1.copy(i.getCursorPosition(t,n,r)),i._v3_1.set(i._v2_1.x,i._v2_1.y,0),i._v3_1.clone();if("PerspectiveCamera"==e.type){i._v2_1.copy(i.getCursorNDC(t,n,r)),i._v3_1.set(i._v2_1.x,i._v2_1.y,-1),i._v3_1.applyMatrix4(e.projectionMatrixInverse);var o,s=i._v3_1.clone().normalize(),u=i._v3_1.z,l=Math.sqrt(Math.pow(i._v3_1.x,2)+Math.pow(i._v3_1.y,2));if(o=a?i._v3_1.setFromMatrixPosition(i._cameraMatrixState0).distanceTo(i._v3_2.setFromMatrixPosition(i._gizmoMatrixState0)):e.position.distanceTo(i._gizmos.position),0==l)return s.set(0,0,0),s;var c=u/l,g=o,d=-g/c,I=Math.sqrt(Math.pow(g,2)+Math.pow(d,2));return s.multiplyScalar(I),s.z=0,s}})),(0,yr.Z)((0,M.Z)(i),"updateMatrixState",(function(){null!==i.camera&&(i._cameraMatrixState.copy(i.camera.matrix),i._gizmoMatrixState.copy(i._gizmos.matrix),i.camera instanceof d.OrthographicCamera&&i.camera.isOrthographicCamera?(i._cameraProjectionState.copy(i.camera.projectionMatrix),i.camera.updateProjectionMatrix(),i._zoomState=i.camera.zoom):i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera&&(i._fovState=i.camera.fov))})),(0,yr.Z)((0,M.Z)(i),"updateTbState",(function(e,t){i._state=e,t&&i.updateMatrixState()})),(0,yr.Z)((0,M.Z)(i),"update",(function(){var e,t=1e-6;if(!i.target.equals(i._currentTarget)&&null!==i.camera){i._gizmos.position.set(i.target.x,i.target.y,i.target.z);var n=i.calculateTbRadius(i.camera);void 0!==n&&(i._tbRadius=n),i.makeGizmos(i.target,i._tbRadius),i._currentTarget.copy(i.target)}if(i.camera instanceof d.OrthographicCamera&&i.camera.isOrthographicCamera){if(i.camera.zoom>i.maxZoom||i.camera.zoom<i.minZoom){var r=d.MathUtils.clamp(i.camera.zoom,i.minZoom,i.maxZoom);i.applyTransformMatrix(i.applyScale(r/i.camera.zoom,i._gizmos.position,!0))}}else if(i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera){var a=i.camera.position.distanceTo(i._gizmos.position);if(a>i.maxDistance+t||a<i.minDistance-t){var o=d.MathUtils.clamp(a,i.minDistance,i.maxDistance);i.applyTransformMatrix(i.applyScale(o/a,i._gizmos.position)),i.updateMatrixState()}(i.camera.fov<i.minFov||i.camera.fov>i.maxFov)&&(i.camera.fov=d.MathUtils.clamp(i.camera.fov,i.minFov,i.maxFov),i.camera.updateProjectionMatrix());var s=i._tbRadius,u=i.calculateTbRadius(i.camera);if(void 0!==u&&(i._tbRadius=u),s<i._tbRadius-t||s>i._tbRadius+t){var l=(i._gizmos.scale.x+i._gizmos.scale.y+i._gizmos.scale.z)/3,c=i._tbRadius/l,g=new d.EllipseCurve(0,0,c,c).getPoints(i._curvePts),I=(new d.BufferGeometry).setFromPoints(g);for(var C in i._gizmos.children){var h=i._gizmos.children[C];h instanceof d.Mesh&&(h.geometry=I)}}}null===(e=i.camera)||void 0===e||e.lookAt(i._gizmos.position)})),(0,yr.Z)((0,M.Z)(i),"setStateFromJSON",(function(e){var t=JSON.parse(e);if(void 0!=t.arcballState&&(i.camera instanceof d.PerspectiveCamera||i.camera instanceof d.OrthographicCamera)){i._cameraMatrixState.fromArray(t.arcballState.cameraMatrix.elements),i._cameraMatrixState.decompose(i.camera.position,i.camera.quaternion,i.camera.scale),i.camera.up.copy(t.arcballState.cameraUp),i.camera.near=t.arcballState.cameraNear,i.camera.far=t.arcballState.cameraFar,i.camera.zoom=t.arcballState.cameraZoom,i.camera instanceof d.PerspectiveCamera&&i.camera.isPerspectiveCamera&&(i.camera.fov=t.arcballState.cameraFov),i._gizmoMatrixState.fromArray(t.arcballState.gizmoMatrix.elements),i._gizmoMatrixState.decompose(i._gizmos.position,i._gizmos.quaternion,i._gizmos.scale),i.camera.updateMatrix(),i.camera.updateProjectionMatrix(),i._gizmos.updateMatrix();var n=i.calculateTbRadius(i.camera);void 0!==n&&(i._tbRadius=n);var r=(new d.Matrix4).copy(i._gizmoMatrixState0);i.makeGizmos(i._gizmos.position,i._tbRadius),i._gizmoMatrixState0.copy(r),i.camera.lookAt(i._gizmos.position),i.updateTbState(Oo.IDLE,!1),i.dispatchEvent(qo)}})),i.camera=null,i.domElement=r,i.scene=a,i.mouseActions=[],i._mouseOp=null,i._v2_1=new d.Vector2,i._v3_1=new d.Vector3,i._v3_2=new d.Vector3,i._m4_1=new d.Matrix4,i._m4_2=new d.Matrix4,i._quat=new d.Quaternion,i._translationMatrix=new d.Matrix4,i._rotationMatrix=new d.Matrix4,i._scaleMatrix=new d.Matrix4,i._rotationAxis=new d.Vector3,i._cameraMatrixState=new d.Matrix4,i._cameraProjectionState=new d.Matrix4,i._fovState=1,i._upState=new d.Vector3,i._zoomState=1,i._nearPos=0,i._farPos=0,i._gizmoMatrixState=new d.Matrix4,i._up0=new d.Vector3,i._zoom0=1,i._fov0=0,i._initialNear=0,i._nearPos0=0,i._initialFar=0,i._farPos0=0,i._cameraMatrixState0=new d.Matrix4,i._gizmoMatrixState0=new d.Matrix4,i._button=-1,i._touchStart=[],i._touchCurrent=[],i._input=Jo.NONE,i._switchSensibility=32,i._startFingerDistance=0,i._currentFingerDistance=0,i._startFingerRotation=0,i._currentFingerRotation=0,i._devPxRatio=0,i._downValid=!0,i._nclicks=0,i._downEvents=[],i._downStart=0,i._clickStart=0,i._maxDownTime=250,i._maxInterval=300,i._posThreshold=24,i._movementThreshold=24,i._currentCursorPosition=new d.Vector3,i._startCursorPosition=new d.Vector3,i._grid=null,i._gridPosition=new d.Vector3,i._gizmos=new d.Group,i._curvePts=128,i._timeStart=-1,i._animationId=-1,i.focusAnimationTime=500,i._timePrev=0,i._timeCurrent=0,i._anglePrev=0,i._angleCurrent=0,i._cursorPosPrev=new d.Vector3,i._cursorPosCurr=new d.Vector3,i._wPrev=0,i._wCurr=0,i.adjustNearFar=!1,i.scaleFactor=1.1,i.dampingFactor=25,i.wMax=20,i.enableAnimations=!0,i.enableGrid=!1,i.cursorZoom=!1,i.minFov=5,i.maxFov=90,i.enabled=!0,i.enablePan=!0,i.enableRotate=!0,i.enableZoom=!0,i.enableGizmos=!0,i.minDistance=0,i.maxDistance=1/0,i.minZoom=0,i.maxZoom=1/0,i.target=new d.Vector3(0,0,0),i._currentTarget=new d.Vector3(0,0,0),i._tbRadius=1,i._state=Oo.IDLE,i.setCamera(e),null!=i.scene&&i.scene.add(i._gizmos),i.domElement.style.touchAction="none",i._devPxRatio=window.devicePixelRatio,i.initializeMouseActions(),i.domElement.addEventListener("contextmenu",i.onContextMenu),i.domElement.addEventListener("wheel",i.onWheel),i.domElement.addEventListener("pointerdown",i.onPointerDown),i.domElement.addEventListener("pointercancel",i.onPointerCancel),window.addEventListener("keydown",i.onKeyDown),window.addEventListener("resize",i.onWindowResize),i}return(0,z.Z)(n,[{key:"applyTransformMatrix",value:function(e){if(null!=(null===e||void 0===e?void 0:e.camera)&&null!==this.camera&&(this._m4_1.copy(this._cameraMatrixState).premultiply(e.camera),this._m4_1.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.updateMatrix(),this._state!=Oo.ROTATE&&this._state!=Oo.ZROTATE&&this._state!=Oo.ANIMATION_ROTATE||this.camera.up.copy(this._upState).applyQuaternion(this.camera.quaternion)),null!=(null===e||void 0===e?void 0:e.gizmos)&&(this._m4_1.copy(this._gizmoMatrixState).premultiply(e.gizmos),this._m4_1.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix()),(this._state==Oo.SCALE||this._state==Oo.FOCUS||this._state==Oo.ANIMATION_FOCUS)&&(this.camera instanceof d.PerspectiveCamera||this.camera instanceof d.OrthographicCamera)){var t=this.calculateTbRadius(this.camera);if(void 0!==t&&(this._tbRadius=t),this.adjustNearFar){var n=this.camera.position.distanceTo(this._gizmos.position),r=new d.Box3;r.setFromObject(this._gizmos);var i=new d.Sphere;r.getBoundingSphere(i);var a=Math.max(this._nearPos0,i.radius+i.center.length()),o=n-this._initialNear,s=Math.min(a,o);this.camera.near=n-s;var u=Math.min(this._farPos0,-i.radius+i.center.length()),l=n-this._initialFar,c=Math.min(u,l);this.camera.far=n-c,this.camera.updateProjectionMatrix()}else{var g=!1;this.camera.near!=this._initialNear&&(this.camera.near=this._initialNear,g=!0),this.camera.far!=this._initialFar&&(this.camera.far=this._initialFar,g=!0),g&&this.camera.updateProjectionMatrix()}}}},{key:"setGizmosVisible",value:function(e){this._gizmos.visible=e,this.dispatchEvent(qo)}},{key:"setTransformationMatrices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!=e?null!=jo.camera?jo.camera.copy(e):jo.camera=e.clone():jo.camera=null,null!=t?null!=jo.gizmos?jo.gizmos.copy(t):jo.gizmos=t.clone():jo.gizmos=null}}]),n}(d.EventDispatcher),ns=["makeDefault","camera","regress","domElement","onChange","onStart","onEnd"],rs=o.forwardRef((function(e,t){var n=e.makeDefault,r=e.camera,i=e.regress,a=e.domElement,u=e.onChange,l=e.onStart,c=e.onEnd,g=(0,m.Z)(e,ns),d=(0,s.useThree)((function(e){return e.invalidate})),I=(0,s.useThree)((function(e){return e.camera})),C=(0,s.useThree)((function(e){return e.gl})),h=(0,s.useThree)((function(e){return e.events})),f=(0,s.useThree)((function(e){return e.set})),p=(0,s.useThree)((function(e){return e.get})),A=(0,s.useThree)((function(e){return e.performance})),b=r||I,y=a||("boolean"!==typeof h.connected?h.connected:C.domElement),B=o.useMemo((function(){return new ts(b)}),[b]);return(0,s.useFrame)((function(){B.enabled&&B.update()})),o.useEffect((function(){var e=function(e){d(),i&&A.regress(),u&&u(e)};return B.connect(y),B.addEventListener("change",e),l&&B.addEventListener("start",l),c&&B.addEventListener("end",c),function(){B.removeEventListener("change",e),l&&B.removeEventListener("start",l),c&&B.removeEventListener("end",c),B.dispose()}}),[y,u,l,c,i,B,d]),o.useEffect((function(){if(n){var e=p().controls;return f({controls:B}),function(){return f({controls:e})}}}),[n,B]),o.createElement("primitive",(0,v.Z)({ref:t,object:B},g))})),is=n(537),as=n.n(is),os=n(103),ss=n.n(os),us=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r){var i,a;(0,N.Z)(this,n),a=t.call(this),(0,yr.Z)((0,M.Z)(a),"isTransformControls",!0),(0,yr.Z)((0,M.Z)(a),"visible",!1),(0,yr.Z)((0,M.Z)(a),"domElement",void 0),(0,yr.Z)((0,M.Z)(a),"raycaster",new d.Raycaster),(0,yr.Z)((0,M.Z)(a),"gizmo",void 0),(0,yr.Z)((0,M.Z)(a),"plane",void 0),(0,yr.Z)((0,M.Z)(a),"tempVector",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"tempVector2",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"tempQuaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(a),"unit",{X:new d.Vector3(1,0,0),Y:new d.Vector3(0,1,0),Z:new d.Vector3(0,0,1)}),(0,yr.Z)((0,M.Z)(a),"pointStart",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"pointEnd",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"offset",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"rotationAxis",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"startNorm",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"endNorm",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"rotationAngle",0),(0,yr.Z)((0,M.Z)(a),"cameraPosition",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"cameraQuaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(a),"cameraScale",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"parentPosition",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"parentQuaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(a),"parentQuaternionInv",new d.Quaternion),(0,yr.Z)((0,M.Z)(a),"parentScale",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"worldPositionStart",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"worldQuaternionStart",new d.Quaternion),(0,yr.Z)((0,M.Z)(a),"worldScaleStart",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"worldPosition",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"worldQuaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(a),"worldQuaternionInv",new d.Quaternion),(0,yr.Z)((0,M.Z)(a),"worldScale",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"eye",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"positionStart",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"quaternionStart",new d.Quaternion),(0,yr.Z)((0,M.Z)(a),"scaleStart",new d.Vector3),(0,yr.Z)((0,M.Z)(a),"camera",void 0),(0,yr.Z)((0,M.Z)(a),"object",void 0),(0,yr.Z)((0,M.Z)(a),"enabled",!0),(0,yr.Z)((0,M.Z)(a),"axis",null),(0,yr.Z)((0,M.Z)(a),"mode","translate"),(0,yr.Z)((0,M.Z)(a),"translationSnap",null),(0,yr.Z)((0,M.Z)(a),"rotationSnap",null),(0,yr.Z)((0,M.Z)(a),"scaleSnap",null),(0,yr.Z)((0,M.Z)(a),"space","world"),(0,yr.Z)((0,M.Z)(a),"size",1),(0,yr.Z)((0,M.Z)(a),"dragging",!1),(0,yr.Z)((0,M.Z)(a),"showX",!0),(0,yr.Z)((0,M.Z)(a),"showY",!0),(0,yr.Z)((0,M.Z)(a),"showZ",!0),(0,yr.Z)((0,M.Z)(a),"changeEvent",{type:"change"}),(0,yr.Z)((0,M.Z)(a),"mouseDownEvent",{type:"mouseDown",mode:a.mode}),(0,yr.Z)((0,M.Z)(a),"mouseUpEvent",{type:"mouseUp",mode:a.mode}),(0,yr.Z)((0,M.Z)(a),"objectChangeEvent",{type:"objectChange"}),(0,yr.Z)((0,M.Z)(a),"intersectObjectWithRay",(function(e,t,n){for(var r=t.intersectObject(e,!0),i=0;i<r.length;i++)if(r[i].object.visible||n)return r[i];return!1})),(0,yr.Z)((0,M.Z)(a),"attach",(function(e){return a.object=e,a.visible=!0,(0,M.Z)(a)})),(0,yr.Z)((0,M.Z)(a),"detach",(function(){return a.object=void 0,a.visible=!1,a.axis=null,(0,M.Z)(a)})),(0,yr.Z)((0,M.Z)(a),"updateMatrixWorld",(function(){void 0!==a.object&&(a.object.updateMatrixWorld(),null===a.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):a.object.parent.matrixWorld.decompose(a.parentPosition,a.parentQuaternion,a.parentScale),a.object.matrixWorld.decompose(a.worldPosition,a.worldQuaternion,a.worldScale),a.parentQuaternionInv.copy(a.parentQuaternion).invert(),a.worldQuaternionInv.copy(a.worldQuaternion).invert()),a.camera.updateMatrixWorld(),a.camera.matrixWorld.decompose(a.cameraPosition,a.cameraQuaternion,a.cameraScale),a.eye.copy(a.cameraPosition).sub(a.worldPosition).normalize(),(0,W.Z)((i=(0,M.Z)(a),(0,k.Z)(n.prototype)),"updateMatrixWorld",i).call(i)})),(0,yr.Z)((0,M.Z)(a),"pointerHover",(function(e){if(void 0!==a.object&&!0!==a.dragging){a.raycaster.setFromCamera(e,a.camera);var t=a.intersectObjectWithRay(a.gizmo.picker[a.mode],a.raycaster);a.axis=t?t.object.name:null}})),(0,yr.Z)((0,M.Z)(a),"pointerDown",(function(e){if(void 0!==a.object&&!0!==a.dragging&&0===e.button&&null!==a.axis){a.raycaster.setFromCamera(e,a.camera);var t=a.intersectObjectWithRay(a.plane,a.raycaster,!0);if(t){var n=a.space;if("scale"===a.mode?n="local":"E"!==a.axis&&"XYZE"!==a.axis&&"XYZ"!==a.axis||(n="world"),"local"===n&&"rotate"===a.mode){var r=a.rotationSnap;"X"===a.axis&&r&&(a.object.rotation.x=Math.round(a.object.rotation.x/r)*r),"Y"===a.axis&&r&&(a.object.rotation.y=Math.round(a.object.rotation.y/r)*r),"Z"===a.axis&&r&&(a.object.rotation.z=Math.round(a.object.rotation.z/r)*r)}a.object.updateMatrixWorld(),a.object.parent&&a.object.parent.updateMatrixWorld(),a.positionStart.copy(a.object.position),a.quaternionStart.copy(a.object.quaternion),a.scaleStart.copy(a.object.scale),a.object.matrixWorld.decompose(a.worldPositionStart,a.worldQuaternionStart,a.worldScaleStart),a.pointStart.copy(t.point).sub(a.worldPositionStart)}a.dragging=!0,a.mouseDownEvent.mode=a.mode,a.dispatchEvent(a.mouseDownEvent)}})),(0,yr.Z)((0,M.Z)(a),"pointerMove",(function(e){var t=a.axis,n=a.mode,r=a.object,i=a.space;if("scale"===n?i="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(i="world"),void 0!==r&&null!==t&&!1!==a.dragging&&-1===e.button){a.raycaster.setFromCamera(e,a.camera);var o=a.intersectObjectWithRay(a.plane,a.raycaster,!0);if(o){if(a.pointEnd.copy(o.point).sub(a.worldPositionStart),"translate"===n)a.offset.copy(a.pointEnd).sub(a.pointStart),"local"===i&&"XYZ"!==t&&a.offset.applyQuaternion(a.worldQuaternionInv),-1===t.indexOf("X")&&(a.offset.x=0),-1===t.indexOf("Y")&&(a.offset.y=0),-1===t.indexOf("Z")&&(a.offset.z=0),"local"===i&&"XYZ"!==t?a.offset.applyQuaternion(a.quaternionStart).divide(a.parentScale):a.offset.applyQuaternion(a.parentQuaternionInv).divide(a.parentScale),r.position.copy(a.offset).add(a.positionStart),a.translationSnap&&("local"===i&&(r.position.applyQuaternion(a.tempQuaternion.copy(a.quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/a.translationSnap)*a.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/a.translationSnap)*a.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/a.translationSnap)*a.translationSnap),r.position.applyQuaternion(a.quaternionStart)),"world"===i&&(r.parent&&r.position.add(a.tempVector.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/a.translationSnap)*a.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/a.translationSnap)*a.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/a.translationSnap)*a.translationSnap),r.parent&&r.position.sub(a.tempVector.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){var s=a.pointEnd.length()/a.pointStart.length();a.pointEnd.dot(a.pointStart)<0&&(s*=-1),a.tempVector2.set(s,s,s)}else a.tempVector.copy(a.pointStart),a.tempVector2.copy(a.pointEnd),a.tempVector.applyQuaternion(a.worldQuaternionInv),a.tempVector2.applyQuaternion(a.worldQuaternionInv),a.tempVector2.divide(a.tempVector),-1===t.search("X")&&(a.tempVector2.x=1),-1===t.search("Y")&&(a.tempVector2.y=1),-1===t.search("Z")&&(a.tempVector2.z=1);r.scale.copy(a.scaleStart).multiply(a.tempVector2),a.scaleSnap&&a.object&&(-1!==t.search("X")&&(a.object.scale.x=Math.round(r.scale.x/a.scaleSnap)*a.scaleSnap||a.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/a.scaleSnap)*a.scaleSnap||a.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/a.scaleSnap)*a.scaleSnap||a.scaleSnap))}else if("rotate"===n){a.offset.copy(a.pointEnd).sub(a.pointStart);var u=20/a.worldPosition.distanceTo(a.tempVector.setFromMatrixPosition(a.camera.matrixWorld));"E"===t?(a.rotationAxis.copy(a.eye),a.rotationAngle=a.pointEnd.angleTo(a.pointStart),a.startNorm.copy(a.pointStart).normalize(),a.endNorm.copy(a.pointEnd).normalize(),a.rotationAngle*=a.endNorm.cross(a.startNorm).dot(a.eye)<0?1:-1):"XYZE"===t?(a.rotationAxis.copy(a.offset).cross(a.eye).normalize(),a.rotationAngle=a.offset.dot(a.tempVector.copy(a.rotationAxis).cross(a.eye))*u):"X"!==t&&"Y"!==t&&"Z"!==t||(a.rotationAxis.copy(a.unit[t]),a.tempVector.copy(a.unit[t]),"local"===i&&a.tempVector.applyQuaternion(a.worldQuaternion),a.rotationAngle=a.offset.dot(a.tempVector.cross(a.eye).normalize())*u),a.rotationSnap&&(a.rotationAngle=Math.round(a.rotationAngle/a.rotationSnap)*a.rotationSnap),"local"===i&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(a.quaternionStart),r.quaternion.multiply(a.tempQuaternion.setFromAxisAngle(a.rotationAxis,a.rotationAngle)).normalize()):(a.rotationAxis.applyQuaternion(a.parentQuaternionInv),r.quaternion.copy(a.tempQuaternion.setFromAxisAngle(a.rotationAxis,a.rotationAngle)),r.quaternion.multiply(a.quaternionStart).normalize())}a.dispatchEvent(a.changeEvent),a.dispatchEvent(a.objectChangeEvent)}}})),(0,yr.Z)((0,M.Z)(a),"pointerUp",(function(e){0===e.button&&(a.dragging&&null!==a.axis&&(a.mouseUpEvent.mode=a.mode,a.dispatchEvent(a.mouseUpEvent)),a.dragging=!1,a.axis=null)})),(0,yr.Z)((0,M.Z)(a),"getPointer",(function(e){var t;if(a.domElement&&null!==(t=a.domElement.ownerDocument)&&void 0!==t&&t.pointerLockElement)return{x:0,y:0,button:e.button};var n,r=e.changedTouches?e.changedTouches[0]:e,i=null===(n=a.domElement)||void 0===n?void 0:n.getBoundingClientRect();return{x:(r.clientX-i.left)/i.width*2-1,y:-(r.clientY-i.top)/i.height*2+1,button:e.button}})),(0,yr.Z)((0,M.Z)(a),"onPointerHover",(function(e){if(a.enabled)switch(e.pointerType){case"mouse":case"pen":a.pointerHover(a.getPointer(e))}})),(0,yr.Z)((0,M.Z)(a),"onPointerDown",(function(e){var t;a.enabled&&(a.domElement.style.touchAction="none",null===(t=a.domElement.ownerDocument)||void 0===t||t.addEventListener("pointermove",a.onPointerMove),a.pointerHover(a.getPointer(e)),a.pointerDown(a.getPointer(e)))})),(0,yr.Z)((0,M.Z)(a),"onPointerMove",(function(e){a.enabled&&a.pointerMove(a.getPointer(e))})),(0,yr.Z)((0,M.Z)(a),"onPointerUp",(function(e){var t;a.enabled&&(a.domElement.style.touchAction="",null===(t=a.domElement.ownerDocument)||void 0===t||t.removeEventListener("pointermove",a.onPointerMove),a.pointerUp(a.getPointer(e)))})),(0,yr.Z)((0,M.Z)(a),"getMode",(function(){return a.mode})),(0,yr.Z)((0,M.Z)(a),"setMode",(function(e){a.mode=e})),(0,yr.Z)((0,M.Z)(a),"setTranslationSnap",(function(e){a.translationSnap=e})),(0,yr.Z)((0,M.Z)(a),"setRotationSnap",(function(e){a.rotationSnap=e})),(0,yr.Z)((0,M.Z)(a),"setScaleSnap",(function(e){a.scaleSnap=e})),(0,yr.Z)((0,M.Z)(a),"setSize",(function(e){a.size=e})),(0,yr.Z)((0,M.Z)(a),"setSpace",(function(e){a.space=e})),(0,yr.Z)((0,M.Z)(a),"update",(function(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")})),(0,yr.Z)((0,M.Z)(a),"dispose",(function(){var e,t;a.domElement.removeEventListener("pointerdown",a.onPointerDown),a.domElement.removeEventListener("pointermove",a.onPointerHover),null===(e=a.domElement.ownerDocument)||void 0===e||e.removeEventListener("pointermove",a.onPointerMove),null===(t=a.domElement.ownerDocument)||void 0===t||t.removeEventListener("pointerup",a.onPointerUp),a.traverse((function(e){var t=e;t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()}))})),void 0===r&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),a.domElement=document),a.domElement=r,a.camera=e,a.gizmo=new ls,a.add(a.gizmo),a.plane=new cs,a.add(a.plane);var o=function(e,t){var n=t;Object.defineProperty((0,M.Z)(a),e,{get:function(){return void 0!==n?n:t},set:function(t){n!==t&&(n=t,this.plane[e]=t,this.gizmo[e]=t,this.dispatchEvent({type:e+"-changed",value:t}),this.dispatchEvent(this.changeEvent))}}),a[e]=t,a.plane[e]=t,a.gizmo[e]=t};return o("camera",a.camera),o("object",a.object),o("enabled",a.enabled),o("axis",a.axis),o("mode",a.mode),o("translationSnap",a.translationSnap),o("rotationSnap",a.rotationSnap),o("scaleSnap",a.scaleSnap),o("space",a.space),o("size",a.size),o("dragging",a.dragging),o("showX",a.showX),o("showY",a.showY),o("showZ",a.showZ),o("worldPosition",a.worldPosition),o("worldPositionStart",a.worldPositionStart),o("worldQuaternion",a.worldQuaternion),o("worldQuaternionStart",a.worldQuaternionStart),o("cameraPosition",a.cameraPosition),o("cameraQuaternion",a.cameraQuaternion),o("pointStart",a.pointStart),o("pointEnd",a.pointEnd),o("rotationAxis",a.rotationAxis),o("rotationAngle",a.rotationAngle),o("eye",a.eye),r.addEventListener("pointerdown",a.onPointerDown),r.addEventListener("pointermove",a.onPointerHover),a.domElement.ownerDocument.addEventListener("pointerup",a.onPointerUp),a}return(0,z.Z)(n)}(d.Object3D),ls=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e,r;(0,N.Z)(this,n),r=t.call(this),(0,yr.Z)((0,M.Z)(r),"isTransformControlsGizmo",!0),(0,yr.Z)((0,M.Z)(r),"type","TransformControlsGizmo"),(0,yr.Z)((0,M.Z)(r),"tempVector",new d.Vector3(0,0,0)),(0,yr.Z)((0,M.Z)(r),"tempEuler",new d.Euler),(0,yr.Z)((0,M.Z)(r),"alignVector",new d.Vector3(0,1,0)),(0,yr.Z)((0,M.Z)(r),"zeroVector",new d.Vector3(0,0,0)),(0,yr.Z)((0,M.Z)(r),"lookAtMatrix",new d.Matrix4),(0,yr.Z)((0,M.Z)(r),"tempQuaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(r),"tempQuaternion2",new d.Quaternion),(0,yr.Z)((0,M.Z)(r),"identityQuaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(r),"unitX",new d.Vector3(1,0,0)),(0,yr.Z)((0,M.Z)(r),"unitY",new d.Vector3(0,1,0)),(0,yr.Z)((0,M.Z)(r),"unitZ",new d.Vector3(0,0,1)),(0,yr.Z)((0,M.Z)(r),"gizmo",void 0),(0,yr.Z)((0,M.Z)(r),"picker",void 0),(0,yr.Z)((0,M.Z)(r),"helper",void 0),(0,yr.Z)((0,M.Z)(r),"rotationAxis",new d.Vector3),(0,yr.Z)((0,M.Z)(r),"cameraPosition",new d.Vector3),(0,yr.Z)((0,M.Z)(r),"worldPositionStart",new d.Vector3),(0,yr.Z)((0,M.Z)(r),"worldQuaternionStart",new d.Quaternion),(0,yr.Z)((0,M.Z)(r),"worldPosition",new d.Vector3),(0,yr.Z)((0,M.Z)(r),"worldQuaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(r),"eye",new d.Vector3),(0,yr.Z)((0,M.Z)(r),"camera",null),(0,yr.Z)((0,M.Z)(r),"enabled",!0),(0,yr.Z)((0,M.Z)(r),"axis",null),(0,yr.Z)((0,M.Z)(r),"mode","translate"),(0,yr.Z)((0,M.Z)(r),"space","world"),(0,yr.Z)((0,M.Z)(r),"size",1),(0,yr.Z)((0,M.Z)(r),"dragging",!1),(0,yr.Z)((0,M.Z)(r),"showX",!0),(0,yr.Z)((0,M.Z)(r),"showY",!0),(0,yr.Z)((0,M.Z)(r),"showZ",!0),(0,yr.Z)((0,M.Z)(r),"updateMatrixWorld",(function(){var t=r.space;"scale"===r.mode&&(t="local");var i="local"===t?r.worldQuaternion:r.identityQuaternion;r.gizmo.translate.visible="translate"===r.mode,r.gizmo.rotate.visible="rotate"===r.mode,r.gizmo.scale.visible="scale"===r.mode,r.helper.translate.visible="translate"===r.mode,r.helper.rotate.visible="rotate"===r.mode,r.helper.scale.visible="scale"===r.mode;var a=[];a=(a=(a=a.concat(r.picker[r.mode].children)).concat(r.gizmo[r.mode].children)).concat(r.helper[r.mode].children);for(var o=function(e){var t=a[e];t.visible=!0,t.rotation.set(0,0,0),t.position.copy(r.worldPosition);var n=void 0;if(n=r.camera.isOrthographicCamera?(r.camera.top-r.camera.bottom)/r.camera.zoom:r.worldPosition.distanceTo(r.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*r.camera.fov/360)/r.camera.zoom,7),t.scale.set(1,1,1).multiplyScalar(n*r.size/7),"helper"===t.tag)return t.visible=!1,"AXIS"===t.name?(t.position.copy(r.worldPositionStart),t.visible=!!r.axis,"X"===r.axis&&(r.tempQuaternion.setFromEuler(r.tempEuler.set(0,0,0)),t.quaternion.copy(i).multiply(r.tempQuaternion),Math.abs(r.alignVector.copy(r.unitX).applyQuaternion(i).dot(r.eye))>.9&&(t.visible=!1)),"Y"===r.axis&&(r.tempQuaternion.setFromEuler(r.tempEuler.set(0,0,Math.PI/2)),t.quaternion.copy(i).multiply(r.tempQuaternion),Math.abs(r.alignVector.copy(r.unitY).applyQuaternion(i).dot(r.eye))>.9&&(t.visible=!1)),"Z"===r.axis&&(r.tempQuaternion.setFromEuler(r.tempEuler.set(0,Math.PI/2,0)),t.quaternion.copy(i).multiply(r.tempQuaternion),Math.abs(r.alignVector.copy(r.unitZ).applyQuaternion(i).dot(r.eye))>.9&&(t.visible=!1)),"XYZE"===r.axis&&(r.tempQuaternion.setFromEuler(r.tempEuler.set(0,Math.PI/2,0)),r.alignVector.copy(r.rotationAxis),t.quaternion.setFromRotationMatrix(r.lookAtMatrix.lookAt(r.zeroVector,r.alignVector,r.unitY)),t.quaternion.multiply(r.tempQuaternion),t.visible=r.dragging),"E"===r.axis&&(t.visible=!1)):"START"===t.name?(t.position.copy(r.worldPositionStart),t.visible=r.dragging):"END"===t.name?(t.position.copy(r.worldPosition),t.visible=r.dragging):"DELTA"===t.name?(t.position.copy(r.worldPositionStart),t.quaternion.copy(r.worldQuaternionStart),r.tempVector.set(1e-10,1e-10,1e-10).add(r.worldPositionStart).sub(r.worldPosition).multiplyScalar(-1),r.tempVector.applyQuaternion(r.worldQuaternionStart.clone().invert()),t.scale.copy(r.tempVector),t.visible=r.dragging):(t.quaternion.copy(i),r.dragging?t.position.copy(r.worldPositionStart):t.position.copy(r.worldPosition),r.axis&&(t.visible=-1!==r.axis.search(t.name))),"continue";if(t.quaternion.copy(i),"translate"===r.mode||"scale"===r.mode){var o=.99;"X"!==t.name&&"XYZX"!==t.name||Math.abs(r.alignVector.copy(r.unitX).applyQuaternion(i).dot(r.eye))>o&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),"Y"!==t.name&&"XYZY"!==t.name||Math.abs(r.alignVector.copy(r.unitY).applyQuaternion(i).dot(r.eye))>o&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),"Z"!==t.name&&"XYZZ"!==t.name||Math.abs(r.alignVector.copy(r.unitZ).applyQuaternion(i).dot(r.eye))>o&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),"XY"===t.name&&Math.abs(r.alignVector.copy(r.unitZ).applyQuaternion(i).dot(r.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),"YZ"===t.name&&Math.abs(r.alignVector.copy(r.unitX).applyQuaternion(i).dot(r.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),"XZ"===t.name&&Math.abs(r.alignVector.copy(r.unitY).applyQuaternion(i).dot(r.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),-1!==t.name.search("X")&&(r.alignVector.copy(r.unitX).applyQuaternion(i).dot(r.eye)<0?"fwd"===t.tag?t.visible=!1:t.scale.x*=-1:"bwd"===t.tag&&(t.visible=!1)),-1!==t.name.search("Y")&&(r.alignVector.copy(r.unitY).applyQuaternion(i).dot(r.eye)<0?"fwd"===t.tag?t.visible=!1:t.scale.y*=-1:"bwd"===t.tag&&(t.visible=!1)),-1!==t.name.search("Z")&&(r.alignVector.copy(r.unitZ).applyQuaternion(i).dot(r.eye)<0?"fwd"===t.tag?t.visible=!1:t.scale.z*=-1:"bwd"===t.tag&&(t.visible=!1))}else"rotate"===r.mode&&(r.tempQuaternion2.copy(i),r.alignVector.copy(r.eye).applyQuaternion(r.tempQuaternion.copy(i).invert()),-1!==t.name.search("E")&&t.quaternion.setFromRotationMatrix(r.lookAtMatrix.lookAt(r.eye,r.zeroVector,r.unitY)),"X"===t.name&&(r.tempQuaternion.setFromAxisAngle(r.unitX,Math.atan2(-r.alignVector.y,r.alignVector.z)),r.tempQuaternion.multiplyQuaternions(r.tempQuaternion2,r.tempQuaternion),t.quaternion.copy(r.tempQuaternion)),"Y"===t.name&&(r.tempQuaternion.setFromAxisAngle(r.unitY,Math.atan2(r.alignVector.x,r.alignVector.z)),r.tempQuaternion.multiplyQuaternions(r.tempQuaternion2,r.tempQuaternion),t.quaternion.copy(r.tempQuaternion)),"Z"===t.name&&(r.tempQuaternion.setFromAxisAngle(r.unitZ,Math.atan2(r.alignVector.y,r.alignVector.x)),r.tempQuaternion.multiplyQuaternions(r.tempQuaternion2,r.tempQuaternion),t.quaternion.copy(r.tempQuaternion)));t.visible=t.visible&&(-1===t.name.indexOf("X")||r.showX),t.visible=t.visible&&(-1===t.name.indexOf("Y")||r.showY),t.visible=t.visible&&(-1===t.name.indexOf("Z")||r.showZ),t.visible=t.visible&&(-1===t.name.indexOf("E")||r.showX&&r.showY&&r.showZ),t.material.tempOpacity=t.material.tempOpacity||t.material.opacity,t.material.tempColor=t.material.tempColor||t.material.color.clone(),t.material.color.copy(t.material.tempColor),t.material.opacity=t.material.tempOpacity,r.enabled?r.axis&&(t.name===r.axis||r.axis.split("").some((function(e){return t.name===e}))?(t.material.opacity=1,t.material.color.lerp(new d.Color(1,1,1),.5)):(t.material.opacity*=.25,t.material.color.lerp(new d.Color(1,1,1),.5))):(t.material.opacity*=.5,t.material.color.lerp(new d.Color(1,1,1),.5))},s=0;s<a.length;s++)o(s);(0,W.Z)((e=(0,M.Z)(r),(0,k.Z)(n.prototype)),"updateMatrixWorld",e).call(e)}));var i=new d.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:d.DoubleSide,fog:!1,toneMapped:!1}),a=new d.LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),o=i.clone();o.opacity=.15;var s=i.clone();s.opacity=.33;var u=i.clone();u.color.set(16711680);var l=i.clone();l.color.set(65280);var c=i.clone();c.color.set(255);var g=i.clone();g.opacity=.25;var I=g.clone();I.color.set(16776960);var C=g.clone();C.color.set(65535);var h=g.clone();h.color.set(16711935),i.clone().color.set(16776960);var f=a.clone();f.color.set(16711680);var p=a.clone();p.color.set(65280);var A=a.clone();A.color.set(255);var m=a.clone();m.color.set(65535);var v=a.clone();v.color.set(16711935);var b=a.clone();b.color.set(16776960);var y=a.clone();y.color.set(7895160);var B=b.clone();B.opacity=.25;var G=new d.CylinderGeometry(0,.05,.2,12,1,!1),Z=new d.BoxGeometry(.125,.125,.125),w=new d.BufferGeometry;w.setAttribute("position",new d.Float32BufferAttribute([0,0,0,1,0,0],3));var _=function(e,t){for(var n=new d.BufferGeometry,r=[],i=0;i<=64*t;++i)r.push(0,Math.cos(i/32*Math.PI)*e,Math.sin(i/32*Math.PI)*e);return n.setAttribute("position",new d.Float32BufferAttribute(r,3)),n},x={X:[[new d.Mesh(G,u),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new d.Mesh(G,u),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new d.Line(w,f)]],Y:[[new d.Mesh(G,l),[0,1,0],null,null,"fwd"],[new d.Mesh(G,l),[0,1,0],[Math.PI,0,0],null,"bwd"],[new d.Line(w,p),null,[0,0,Math.PI/2]]],Z:[[new d.Mesh(G,c),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new d.Mesh(G,c),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new d.Line(w,A),null,[0,-Math.PI/2,0]]],XYZ:[[new d.Mesh(new d.OctahedronGeometry(.1,0),g.clone()),[0,0,0],[0,0,0]]],XY:[[new d.Mesh(new d.PlaneGeometry(.295,.295),I.clone()),[.15,.15,0]],[new d.Line(w,b),[.18,.3,0],null,[.125,1,1]],[new d.Line(w,b),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new d.Mesh(new d.PlaneGeometry(.295,.295),C.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new d.Line(w,m),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new d.Line(w,m),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new d.Mesh(new d.PlaneGeometry(.295,.295),h.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new d.Line(w,v),[.18,0,.3],null,[.125,1,1]],[new d.Line(w,v),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},S={X:[[new d.Mesh(new d.CylinderGeometry(.2,0,1,4,1,!1),o),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new d.Mesh(new d.CylinderGeometry(.2,0,1,4,1,!1),o),[0,.6,0]]],Z:[[new d.Mesh(new d.CylinderGeometry(.2,0,1,4,1,!1),o),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new d.Mesh(new d.OctahedronGeometry(.2,0),o)]],XY:[[new d.Mesh(new d.PlaneGeometry(.4,.4),o),[.2,.2,0]]],YZ:[[new d.Mesh(new d.PlaneGeometry(.4,.4),o),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new d.Mesh(new d.PlaneGeometry(.4,.4),o),[.2,0,.2],[-Math.PI/2,0,0]]]},R={START:[[new d.Mesh(new d.OctahedronGeometry(.01,2),s),null,null,null,"helper"]],END:[[new d.Mesh(new d.OctahedronGeometry(.01,2),s),null,null,null,"helper"]],DELTA:[[new d.Line(function(){var e=new d.BufferGeometry;return e.setAttribute("position",new d.Float32BufferAttribute([0,0,0,1,1,1],3)),e}(),s),null,null,null,"helper"]],X:[[new d.Line(w,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new d.Line(w,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new d.Line(w,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},V={X:[[new d.Line(_(1,.5),f)],[new d.Mesh(new d.OctahedronGeometry(.04,0),u),[0,0,.99],null,[1,3,1]]],Y:[[new d.Line(_(1,.5),p),null,[0,0,-Math.PI/2]],[new d.Mesh(new d.OctahedronGeometry(.04,0),l),[0,0,.99],null,[3,1,1]]],Z:[[new d.Line(_(1,.5),A),null,[0,Math.PI/2,0]],[new d.Mesh(new d.OctahedronGeometry(.04,0),c),[.99,0,0],null,[1,3,1]]],E:[[new d.Line(_(1.25,1),B),null,[0,Math.PI/2,0]],[new d.Mesh(new d.CylinderGeometry(.03,0,.15,4,1,!1),B),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new d.Mesh(new d.CylinderGeometry(.03,0,.15,4,1,!1),B),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new d.Mesh(new d.CylinderGeometry(.03,0,.15,4,1,!1),B),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new d.Mesh(new d.CylinderGeometry(.03,0,.15,4,1,!1),B),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new d.Line(_(1,1),y),null,[0,Math.PI/2,0]]]},F={AXIS:[[new d.Line(w,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},E={X:[[new d.Mesh(new d.TorusGeometry(1,.1,4,24),o),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new d.Mesh(new d.TorusGeometry(1,.1,4,24),o),[0,0,0],[Math.PI/2,0,0]]],Z:[[new d.Mesh(new d.TorusGeometry(1,.1,4,24),o),[0,0,0],[0,0,-Math.PI/2]]],E:[[new d.Mesh(new d.TorusGeometry(1.25,.1,2,24),o)]],XYZE:[[new d.Mesh(new d.SphereGeometry(.7,10,8),o)]]},X={X:[[new d.Mesh(Z,u),[.8,0,0],[0,0,-Math.PI/2]],[new d.Line(w,f),null,null,[.8,1,1]]],Y:[[new d.Mesh(Z,l),[0,.8,0]],[new d.Line(w,p),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new d.Mesh(Z,c),[0,0,.8],[Math.PI/2,0,0]],[new d.Line(w,A),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new d.Mesh(Z,I),[.85,.85,0],null,[2,2,.2]],[new d.Line(w,b),[.855,.98,0],null,[.125,1,1]],[new d.Line(w,b),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new d.Mesh(Z,C),[0,.85,.85],null,[.2,2,2]],[new d.Line(w,m),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new d.Line(w,m),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new d.Mesh(Z,h),[.85,0,.85],null,[2,.2,2]],[new d.Line(w,v),[.855,0,.98],null,[.125,1,1]],[new d.Line(w,v),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new d.Mesh(new d.BoxGeometry(.125,.125,.125),g.clone()),[1.1,0,0]]],XYZY:[[new d.Mesh(new d.BoxGeometry(.125,.125,.125),g.clone()),[0,1.1,0]]],XYZZ:[[new d.Mesh(new d.BoxGeometry(.125,.125,.125),g.clone()),[0,0,1.1]]]},H={X:[[new d.Mesh(new d.CylinderGeometry(.2,0,.8,4,1,!1),o),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new d.Mesh(new d.CylinderGeometry(.2,0,.8,4,1,!1),o),[0,.5,0]]],Z:[[new d.Mesh(new d.CylinderGeometry(.2,0,.8,4,1,!1),o),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new d.Mesh(Z,o),[.85,.85,0],null,[3,3,.2]]],YZ:[[new d.Mesh(Z,o),[0,.85,.85],null,[.2,3,3]]],XZ:[[new d.Mesh(Z,o),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new d.Mesh(new d.BoxGeometry(.2,.2,.2),o),[1.1,0,0]]],XYZY:[[new d.Mesh(new d.BoxGeometry(.2,.2,.2),o),[0,1.1,0]]],XYZZ:[[new d.Mesh(new d.BoxGeometry(.2,.2,.2),o),[0,0,1.1]]]},L={X:[[new d.Line(w,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new d.Line(w,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new d.Line(w,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},z=function(e){var t=new d.Object3D;for(var n in e)for(var r=e[n].length;r--;){var i=e[n][r][0].clone(),a=e[n][r][1],o=e[n][r][2],s=e[n][r][3],u=e[n][r][4];i.name=n,i.tag=u,a&&i.position.set(a[0],a[1],a[2]),o&&i.rotation.set(o[0],o[1],o[2]),s&&i.scale.set(s[0],s[1],s[2]),i.updateMatrix();var l=i.geometry.clone();l.applyMatrix4(i.matrix),i.geometry=l,i.renderOrder=1/0,i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1),t.add(i)}return t};return r.gizmo={},r.picker={},r.helper={},r.add(r.gizmo.translate=z(x)),r.add(r.gizmo.rotate=z(V)),r.add(r.gizmo.scale=z(X)),r.add(r.picker.translate=z(S)),r.add(r.picker.rotate=z(E)),r.add(r.picker.scale=z(H)),r.add(r.helper.translate=z(R)),r.add(r.helper.rotate=z(F)),r.add(r.helper.scale=z(L)),r.picker.translate.visible=!1,r.picker.rotate.visible=!1,r.picker.scale.visible=!1,r}return(0,z.Z)(n)}(d.Object3D),cs=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e,r;return(0,N.Z)(this,n),r=t.call(this,new d.PlaneGeometry(1e5,1e5,2,2),new d.MeshBasicMaterial({visible:!1,wireframe:!0,side:d.DoubleSide,transparent:!0,opacity:.1,toneMapped:!1})),(0,yr.Z)((0,M.Z)(r),"isTransformControlsPlane",!0),(0,yr.Z)((0,M.Z)(r),"type","TransformControlsPlane"),(0,yr.Z)((0,M.Z)(r),"unitX",new d.Vector3(1,0,0)),(0,yr.Z)((0,M.Z)(r),"unitY",new d.Vector3(0,1,0)),(0,yr.Z)((0,M.Z)(r),"unitZ",new d.Vector3(0,0,1)),(0,yr.Z)((0,M.Z)(r),"tempVector",new d.Vector3),(0,yr.Z)((0,M.Z)(r),"dirVector",new d.Vector3),(0,yr.Z)((0,M.Z)(r),"alignVector",new d.Vector3),(0,yr.Z)((0,M.Z)(r),"tempMatrix",new d.Matrix4),(0,yr.Z)((0,M.Z)(r),"identityQuaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(r),"cameraQuaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(r),"worldPosition",new d.Vector3),(0,yr.Z)((0,M.Z)(r),"worldQuaternion",new d.Quaternion),(0,yr.Z)((0,M.Z)(r),"eye",new d.Vector3),(0,yr.Z)((0,M.Z)(r),"axis",null),(0,yr.Z)((0,M.Z)(r),"mode","translate"),(0,yr.Z)((0,M.Z)(r),"space","world"),(0,yr.Z)((0,M.Z)(r),"updateMatrixWorld",(function(){var t=r.space;switch(r.position.copy(r.worldPosition),"scale"===r.mode&&(t="local"),r.unitX.set(1,0,0).applyQuaternion("local"===t?r.worldQuaternion:r.identityQuaternion),r.unitY.set(0,1,0).applyQuaternion("local"===t?r.worldQuaternion:r.identityQuaternion),r.unitZ.set(0,0,1).applyQuaternion("local"===t?r.worldQuaternion:r.identityQuaternion),r.alignVector.copy(r.unitY),r.mode){case"translate":case"scale":switch(r.axis){case"X":r.alignVector.copy(r.eye).cross(r.unitX),r.dirVector.copy(r.unitX).cross(r.alignVector);break;case"Y":r.alignVector.copy(r.eye).cross(r.unitY),r.dirVector.copy(r.unitY).cross(r.alignVector);break;case"Z":r.alignVector.copy(r.eye).cross(r.unitZ),r.dirVector.copy(r.unitZ).cross(r.alignVector);break;case"XY":r.dirVector.copy(r.unitZ);break;case"YZ":r.dirVector.copy(r.unitX);break;case"XZ":r.alignVector.copy(r.unitZ),r.dirVector.copy(r.unitY);break;case"XYZ":case"E":r.dirVector.set(0,0,0)}break;default:r.dirVector.set(0,0,0)}0===r.dirVector.length()?r.quaternion.copy(r.cameraQuaternion):(r.tempMatrix.lookAt(r.tempVector.set(0,0,0),r.dirVector,r.alignVector),r.quaternion.setFromRotationMatrix(r.tempMatrix)),(0,W.Z)((e=(0,M.Z)(r),(0,k.Z)(n.prototype)),"updateMatrixWorld",e).call(e)})),r}return(0,z.Z)(n)}(d.Mesh),gs=["children","onChange","onMouseDown","onMouseUp","onObjectChange","object"],ds=["camera"],Is=o.forwardRef((function(e,t){var n=e.children,r=e.onChange,i=e.onMouseDown,a=e.onMouseUp,u=e.onObjectChange,l=e.object,c=(0,m.Z)(e,gs),I=["enabled","axis","mode","translationSnap","rotationSnap","scaleSnap","space","size","showX","showY","showZ"],C=c.camera,h=(0,m.Z)(c,ds),f=ss()(h,I),p=as()(h,I),A=(0,s.useThree)((function(e){return e.controls})),b=(0,s.useThree)((function(e){return e.gl})),y=(0,s.useThree)((function(e){return e.camera})),B=(0,s.useThree)((function(e){return e.invalidate})),G=C||y,Z=o.useState((function(){return new us(G,b.domElement)})),w=(0,g.Z)(Z,1)[0],_=o.useRef();return o.useLayoutEffect((function(){l?null==w||w.attach(l instanceof d.Object3D?l:l.current):null==w||w.attach(_.current)}),[l,n,w]),o.useEffect((function(){if(A){var e=function(e){return A.enabled=!e.value};return w.addEventListener("dragging-changed",e),function(){return w.removeEventListener("dragging-changed",e)}}}),[w,A]),o.useEffect((function(){var e=function(e){B(),r&&r(e)};return null==w||null==w.addEventListener||w.addEventListener("change",e),i&&(null==w||null==w.addEventListener||w.addEventListener("mouseDown",i)),a&&(null==w||null==w.addEventListener||w.addEventListener("mouseUp",a)),u&&(null==w||null==w.addEventListener||w.addEventListener("objectChange",u)),function(){null==w||null==w.removeEventListener||w.removeEventListener("change",e),i&&(null==w||null==w.removeEventListener||w.removeEventListener("mouseDown",i)),a&&(null==w||null==w.removeEventListener||w.removeEventListener("mouseUp",a)),u&&(null==w||null==w.removeEventListener||w.removeEventListener("objectChange",u))}}),[r,i,a,u,w,B]),w?o.createElement(o.Fragment,null,o.createElement("primitive",(0,v.Z)({ref:t,dispose:void 0,object:w},f)),o.createElement("group",(0,v.Z)({ref:_},p),n)):null})),Cs=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r){var i;return(0,N.Z)(this,n),i=t.call(this),(0,yr.Z)((0,M.Z)(i),"camera",void 0),(0,yr.Z)((0,M.Z)(i),"domElement",void 0),(0,yr.Z)((0,M.Z)(i),"isLocked",!1),(0,yr.Z)((0,M.Z)(i),"minPolarAngle",0),(0,yr.Z)((0,M.Z)(i),"maxPolarAngle",Math.PI),(0,yr.Z)((0,M.Z)(i),"changeEvent",{type:"change"}),(0,yr.Z)((0,M.Z)(i),"lockEvent",{type:"lock"}),(0,yr.Z)((0,M.Z)(i),"unlockEvent",{type:"unlock"}),(0,yr.Z)((0,M.Z)(i),"euler",new d.Euler(0,0,0,"YXZ")),(0,yr.Z)((0,M.Z)(i),"PI_2",Math.PI/2),(0,yr.Z)((0,M.Z)(i),"vec",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"onMouseMove",(function(e){if(!1!==i.isLocked){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,n=e.movementY||e.mozMovementY||e.webkitMovementY||0;i.euler.setFromQuaternion(i.camera.quaternion),i.euler.y-=.002*t,i.euler.x-=.002*n,i.euler.x=Math.max(i.PI_2-i.maxPolarAngle,Math.min(i.PI_2-i.minPolarAngle,i.euler.x)),i.camera.quaternion.setFromEuler(i.euler),i.dispatchEvent(i.changeEvent)}})),(0,yr.Z)((0,M.Z)(i),"onPointerlockChange",(function(){i.domElement.ownerDocument.pointerLockElement===i.domElement?(i.dispatchEvent(i.lockEvent),i.isLocked=!0):(i.dispatchEvent(i.unlockEvent),i.isLocked=!1)})),(0,yr.Z)((0,M.Z)(i),"onPointerlockError",(function(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")})),(0,yr.Z)((0,M.Z)(i),"connect",(function(){i.domElement.ownerDocument.addEventListener("mousemove",i.onMouseMove),i.domElement.ownerDocument.addEventListener("pointerlockchange",i.onPointerlockChange),i.domElement.ownerDocument.addEventListener("pointerlockerror",i.onPointerlockError)})),(0,yr.Z)((0,M.Z)(i),"disconnect",(function(){i.domElement.ownerDocument.removeEventListener("mousemove",i.onMouseMove),i.domElement.ownerDocument.removeEventListener("pointerlockchange",i.onPointerlockChange),i.domElement.ownerDocument.removeEventListener("pointerlockerror",i.onPointerlockError)})),(0,yr.Z)((0,M.Z)(i),"dispose",(function(){i.disconnect()})),(0,yr.Z)((0,M.Z)(i),"getObject",(function(){return i.camera})),(0,yr.Z)((0,M.Z)(i),"direction",new d.Vector3(0,0,-1)),(0,yr.Z)((0,M.Z)(i),"getDirection",(function(e){return e.copy(i.direction).applyQuaternion(i.camera.quaternion)})),(0,yr.Z)((0,M.Z)(i),"moveForward",(function(e){i.vec.setFromMatrixColumn(i.camera.matrix,0),i.vec.crossVectors(i.camera.up,i.vec),i.camera.position.addScaledVector(i.vec,e)})),(0,yr.Z)((0,M.Z)(i),"moveRight",(function(e){i.vec.setFromMatrixColumn(i.camera.matrix,0),i.camera.position.addScaledVector(i.vec,e)})),(0,yr.Z)((0,M.Z)(i),"lock",(function(){i.domElement.requestPointerLock()})),(0,yr.Z)((0,M.Z)(i),"unlock",(function(){i.domElement.ownerDocument.exitPointerLock()})),void 0===r&&(console.warn('THREE.PointerLockControls: The second parameter "domElement" is now mandatory.'),r=document.body),i.domElement=r,i.camera=e,i.connect(),i}return(0,z.Z)(n)}(d.EventDispatcher),hs=["selector","onChange","onLock","onUnlock"],fs=["camera"],ps=o.forwardRef((function(e,t){var n=e.selector,r=e.onChange,i=e.onLock,a=e.onUnlock,u=(0,m.Z)(e,hs),l=u.camera,c=(0,m.Z)(u,fs),d=(0,s.useThree)((function(e){return e.gl})),I=(0,s.useThree)((function(e){return e.camera})),C=(0,s.useThree)((function(e){return e.invalidate})),h=l||I,f=o.useState((function(){return new Cs(h,d.domElement)})),p=(0,g.Z)(f,1)[0];return o.useEffect((function(){var e=function(e){C(),r&&r(e)};return null==p||null==p.addEventListener||p.addEventListener("change",e),i&&(null==p||null==p.addEventListener||p.addEventListener("lock",i)),a&&(null==p||null==p.addEventListener||p.addEventListener("unlock",a)),function(){null==p||null==p.removeEventListener||p.removeEventListener("change",e),i&&(null==p||null==p.addEventListener||p.addEventListener("lock",i)),a&&(null==p||null==p.addEventListener||p.addEventListener("unlock",a))}}),[r,i,a,p,C]),o.useEffect((function(){var e=function(){return null==p?void 0:p.lock()},t=n?Array.from(document.querySelectorAll(n)):[document];return t.forEach((function(t){return t&&t.addEventListener("click",e)})),function(){t.forEach((function(t){return t?t.removeEventListener("click",e):void 0}))}}),[p,n]),p?o.createElement("primitive",(0,v.Z)({ref:t,dispose:void 0,object:p},c)):null})),As=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r){var i;return(0,N.Z)(this,n),i=t.call(this),(0,yr.Z)((0,M.Z)(i),"object",void 0),(0,yr.Z)((0,M.Z)(i),"domElement",void 0),(0,yr.Z)((0,M.Z)(i),"enabled",!0),(0,yr.Z)((0,M.Z)(i),"movementSpeed",1),(0,yr.Z)((0,M.Z)(i),"lookSpeed",.005),(0,yr.Z)((0,M.Z)(i),"lookVertical",!0),(0,yr.Z)((0,M.Z)(i),"autoForward",!1),(0,yr.Z)((0,M.Z)(i),"activeLook",!0),(0,yr.Z)((0,M.Z)(i),"heightSpeed",!1),(0,yr.Z)((0,M.Z)(i),"heightCoef",1),(0,yr.Z)((0,M.Z)(i),"heightMin",0),(0,yr.Z)((0,M.Z)(i),"heightMax",1),(0,yr.Z)((0,M.Z)(i),"constrainVertical",!1),(0,yr.Z)((0,M.Z)(i),"verticalMin",0),(0,yr.Z)((0,M.Z)(i),"verticalMax",Math.PI),(0,yr.Z)((0,M.Z)(i),"mouseDragOn",!1),(0,yr.Z)((0,M.Z)(i),"autoSpeedFactor",0),(0,yr.Z)((0,M.Z)(i),"mouseX",0),(0,yr.Z)((0,M.Z)(i),"mouseY",0),(0,yr.Z)((0,M.Z)(i),"moveForward",!1),(0,yr.Z)((0,M.Z)(i),"moveBackward",!1),(0,yr.Z)((0,M.Z)(i),"moveLeft",!1),(0,yr.Z)((0,M.Z)(i),"moveRight",!1),(0,yr.Z)((0,M.Z)(i),"moveUp",!1),(0,yr.Z)((0,M.Z)(i),"moveDown",!1),(0,yr.Z)((0,M.Z)(i),"viewHalfX",0),(0,yr.Z)((0,M.Z)(i),"viewHalfY",0),(0,yr.Z)((0,M.Z)(i),"lat",0),(0,yr.Z)((0,M.Z)(i),"lon",0),(0,yr.Z)((0,M.Z)(i),"lookDirection",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"spherical",new d.Spherical),(0,yr.Z)((0,M.Z)(i),"target",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"dispose",(function(){i.domElement.removeEventListener("contextmenu",i.contextmenu),i.domElement.removeEventListener("mousedown",i.onMouseDown),i.domElement.removeEventListener("mousemove",i.onMouseMove),i.domElement.removeEventListener("mouseup",i.onMouseUp),window.removeEventListener("keydown",i.onKeyDown),window.removeEventListener("keyup",i.onKeyUp)})),(0,yr.Z)((0,M.Z)(i),"handleResize",(function(){i.domElement instanceof Document?(i.viewHalfX=window.innerWidth/2,i.viewHalfY=window.innerHeight/2):(i.viewHalfX=i.domElement.offsetWidth/2,i.viewHalfY=i.domElement.offsetHeight/2)})),(0,yr.Z)((0,M.Z)(i),"onMouseDown",(function(e){if(i.domElement instanceof HTMLElement&&i.domElement.focus(),i.activeLook)switch(e.button){case 0:i.moveForward=!0;break;case 2:i.moveBackward=!0}i.mouseDragOn=!0})),(0,yr.Z)((0,M.Z)(i),"onMouseUp",(function(e){if(i.activeLook)switch(e.button){case 0:i.moveForward=!1;break;case 2:i.moveBackward=!1}i.mouseDragOn=!1})),(0,yr.Z)((0,M.Z)(i),"onMouseMove",(function(e){i.domElement instanceof Document?(i.mouseX=e.pageX-i.viewHalfX,i.mouseY=e.pageY-i.viewHalfY):(i.mouseX=e.pageX-i.domElement.offsetLeft-i.viewHalfX,i.mouseY=e.pageY-i.domElement.offsetTop-i.viewHalfY)})),(0,yr.Z)((0,M.Z)(i),"onKeyDown",(function(e){switch(e.code){case"ArrowUp":case"KeyW":i.moveForward=!0;break;case"ArrowLeft":case"KeyA":i.moveLeft=!0;break;case"ArrowDown":case"KeyS":i.moveBackward=!0;break;case"ArrowRight":case"KeyD":i.moveRight=!0;break;case"KeyR":i.moveUp=!0;break;case"KeyF":i.moveDown=!0}})),(0,yr.Z)((0,M.Z)(i),"onKeyUp",(function(e){switch(e.code){case"ArrowUp":case"KeyW":i.moveForward=!1;break;case"ArrowLeft":case"KeyA":i.moveLeft=!1;break;case"ArrowDown":case"KeyS":i.moveBackward=!1;break;case"ArrowRight":case"KeyD":i.moveRight=!1;break;case"KeyR":i.moveUp=!1;break;case"KeyF":i.moveDown=!1}})),(0,yr.Z)((0,M.Z)(i),"lookAt",(function(e,t,n){return e instanceof d.Vector3?i.target.copy(e):t&&n&&i.target.set(e,t,n),i.object.lookAt(i.target),i.setOrientation((0,M.Z)(i)),(0,M.Z)(i)})),(0,yr.Z)((0,M.Z)(i),"targetPosition",new d.Vector3),(0,yr.Z)((0,M.Z)(i),"update",(function(e){if(!1!==i.enabled){if(i.heightSpeed){var t=d.MathUtils.clamp(i.object.position.y,i.heightMin,i.heightMax)-i.heightMin;i.autoSpeedFactor=e*(t*i.heightCoef)}else i.autoSpeedFactor=0;var n=e*i.movementSpeed;(i.moveForward||i.autoForward&&!i.moveBackward)&&i.object.translateZ(-(n+i.autoSpeedFactor)),i.moveBackward&&i.object.translateZ(n),i.moveLeft&&i.object.translateX(-n),i.moveRight&&i.object.translateX(n),i.moveUp&&i.object.translateY(n),i.moveDown&&i.object.translateY(-n);var r=e*i.lookSpeed;i.activeLook||(r=0);var a=1;i.constrainVertical&&(a=Math.PI/(i.verticalMax-i.verticalMin)),i.lon-=i.mouseX*r,i.lookVertical&&(i.lat-=i.mouseY*r*a),i.lat=Math.max(-85,Math.min(85,i.lat));var o=d.MathUtils.degToRad(90-i.lat),s=d.MathUtils.degToRad(i.lon);i.constrainVertical&&(o=d.MathUtils.mapLinear(o,0,Math.PI,i.verticalMin,i.verticalMax));var u=i.object.position;i.targetPosition.setFromSphericalCoords(1,o,s).add(u),i.object.lookAt(i.targetPosition)}})),(0,yr.Z)((0,M.Z)(i),"contextmenu",(function(e){return e.preventDefault()})),(0,yr.Z)((0,M.Z)(i),"setOrientation",(function(e){var t=e.object.quaternion;i.lookDirection.set(0,0,-1).applyQuaternion(t),i.spherical.setFromVector3(i.lookDirection),i.lat=90-d.MathUtils.radToDeg(i.spherical.phi),i.lon=d.MathUtils.radToDeg(i.spherical.theta)})),void 0===r&&(console.warn('THREE.FirstPersonControls: The second parameter "domElement" is now mandatory.'),r=document),i.object=e,i.domElement=r,i.domElement instanceof HTMLElement&&i.domElement.setAttribute("tabindex","-1"),i.handleResize(),i.setOrientation((0,M.Z)(i)),i.domElement.addEventListener("contextmenu",i.contextmenu),i.domElement.addEventListener("mousemove",i.onMouseMove),i.domElement.addEventListener("mousedown",i.onMouseDown),i.domElement.addEventListener("mouseup",i.onMouseUp),window.addEventListener("keydown",i.onKeyDown),window.addEventListener("keyup",i.onKeyUp),i}return(0,z.Z)(n)}(d.EventDispatcher),ms=o.forwardRef((function(e,t){var n=(0,s.useThree)((function(e){return e.camera})),r=(0,s.useThree)((function(e){return e.gl})),i=o.useState((function(){return new As(n,r.domElement)})),a=(0,g.Z)(i,1)[0];return(0,s.useFrame)((function(e,t){a.update(t)})),a?o.createElement("primitive",(0,v.Z)({ref:t,object:a},e)):null}));function vs(e,t){var n=(0,s.useThree)((function(e){return e.mouse})),r=o.useState((function(){var r=new d.Raycaster;return t&&(0,s.applyProps)(r,t,{}),function(t,i){r.setFromCamera(n,e instanceof d.Camera?e:e.current);var a=this.constructor.prototype.raycast.bind(this);a&&a(r,i)}}));return(0,g.Z)(r,1)[0]}var bs=o.createContext({}),ys=function(){return o.useContext(bs)},Bs=2*Math.PI,Gs=new d.Object3D,Zs=new d.Matrix4,ws=new d.Quaternion,_s=new d.Quaternion,xs=new d.Vector3,Ss=new d.Vector3,Rs=function(e){var t=e.alignment,n=void 0===t?"bottom-right":t,r=e.margin,i=void 0===r?[80,80]:r,a=e.renderPriority,u=void 0===a?0:a,l=e.onUpdate,c=e.onTarget,I=e.children,C=(0,s.useThree)((function(e){return e.size})),h=(0,s.useThree)((function(e){return e.camera})),f=(0,s.useThree)((function(e){return e.controls})),p=(0,s.useThree)((function(e){return e.gl})),A=(0,s.useThree)((function(e){return e.scene})),m=(0,s.useThree)((function(e){return e.invalidate})),v=o.useRef(),b=o.useRef(),y=o.useRef(null),B=o.useState((function(){return new d.Scene})),G=(0,g.Z)(B,1)[0],Z=o.useRef(!1),w=o.useRef(0),_=o.useRef(new d.Vector3(0,0,0));o.useEffect((function(){return A.background&&(v.current=A.background,A.background=null,G.background=v.current),function(){v.current&&(A.background=v.current)}}),[]);(0,s.useFrame)((function(e,t){y.current&&b.current&&(!function(e){if(Z.current)if(ws.angleTo(_s)<.01)Z.current=!1;else{var t=e*Bs;ws.rotateTowards(_s,t),h.position.set(0,0,1).applyQuaternion(ws).multiplyScalar(w.current).add(_.current),h.up.set(0,1,0).applyQuaternion(ws).normalize(),h.quaternion.copy(ws),l?l():f&&f.update(),m()}}(t),function(){var e;Zs.copy(h.matrix).invert(),null==(e=b.current)||e.quaternion.setFromRotationMatrix(Zs)}(),p.autoClear=!1,p.clearDepth(),p.render(G,y.current))}),u);var x={tweenCamera:function(e){Z.current=!0,(f||c)&&(_.current=(null==f?void 0:f.target)||(null==c?void 0:c())),w.current=h.position.distanceTo(xs),ws.copy(h.quaternion),Ss.copy(e).multiplyScalar(w.current).add(xs),Gs.lookAt(Ss),_s.copy(Gs.quaternion),m()},raycast:vs(y)},S=(0,g.Z)(i,2),R=S[0],M=S[1],W=n.endsWith("-left")?-C.width/2+R:C.width/2-R,k=n.startsWith("top-")?C.height/2-M:-C.height/2+M;return(0,s.createPortal)(o.createElement(bs.Provider,{value:x},o.createElement(wo,{ref:y,makeDefault:!1,position:[0,0,200]}),o.createElement("group",{ref:b,position:[W,k,0]},I)),G)},Ms="#f0f0f0",Ws="#999",ks="black",Vs="black",Fs=["Right","Left","Top","Bottom","Front","Back"],Es=function(e){return(0,X.Z)(d.Vector3,(0,a.Z)(e)).multiplyScalar(.38)},Xs=[[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1],[-1,1,1],[-1,1,-1],[-1,-1,1],[-1,-1,-1]].map(Es),Hs=[.25,.25,.25],Ls=[[1,1,0],[1,0,1],[1,0,-1],[1,-1,0],[0,1,1],[0,1,-1],[0,-1,1],[0,-1,-1],[-1,1,0],[-1,0,1],[-1,0,-1],[-1,-1,0]].map(Es),zs=Ls.map((function(e){return e.toArray().map((function(e){return 0==e?.5:.25}))})),Ns=function(e){var t=e.hover,n=e.index,r=e.font,i=void 0===r?"20px Inter var, Arial, sans-serif":r,a=e.faces,u=void 0===a?Fs:a,l=e.color,c=void 0===l?Ms:l,g=e.hoverColor,I=void 0===g?Ws:g,C=e.textColor,h=void 0===C?ks:C,f=e.strokeColor,p=void 0===f?Vs:f,A=e.opacity,m=void 0===A?1:A,v=(0,s.useThree)((function(e){return e.gl})),b=o.useMemo((function(){var e=document.createElement("canvas");e.width=128,e.height=128;var t=e.getContext("2d");return t.fillStyle=c,t.fillRect(0,0,e.width,e.height),t.strokeStyle=p,t.strokeRect(0,0,e.width,e.height),t.font=i,t.textAlign="center",t.fillStyle=h,t.fillText(u[n].toUpperCase(),64,76),new d.CanvasTexture(e)}),[n,i,c,h,p]);return o.createElement("meshLambertMaterial",{map:b,"map-anisotropy":v.capabilities.getMaxAnisotropy()||1,attachArray:"material",color:t?I:"white",transparent:!0,opacity:m})},Ys=function(e){var t=ys(),n=t.tweenCamera,r=t.raycast,i=o.useState(null),s=(0,g.Z)(i,2),u=s[0],l=s[1];return o.createElement("mesh",{raycast:r,onPointerOut:function(e){e.stopPropagation(),l(null)},onPointerMove:function(e){e.stopPropagation(),l(Math.floor(e.faceIndex/2))},onClick:e.onClick||function(e){e.stopPropagation(),n(e.face.normal)}},(0,a.Z)(Array(6)).map((function(t,n){return o.createElement(Ns,(0,v.Z)({key:n,index:n,hover:u===n},e))})),o.createElement("boxGeometry",null))},Ts=function(e){var t=e.onClick,n=e.dimensions,r=e.position,i=e.hoverColor,a=void 0===i?Ws:i,s=ys(),u=s.tweenCamera,l=s.raycast,c=o.useState(!1),d=(0,g.Z)(c,2),I=d[0],C=d[1];return o.createElement("mesh",{scale:1.01,position:r,raycast:l,onPointerOver:function(e){e.stopPropagation(),C(!0)},onPointerOut:function(e){e.stopPropagation(),C(!1)},onClick:t||function(e){e.stopPropagation(),u(r)}},o.createElement("meshBasicMaterial",{color:I?a:"white",transparent:!0,opacity:.6,visible:I}),o.createElement("boxGeometry",{args:n}))},Ks=function(e){return o.createElement("group",{scale:[60,60,60]},o.createElement(Ys,e),Ls.map((function(t,n){return o.createElement(Ts,(0,v.Z)({key:n,position:t,dimensions:zs[n]},e))})),Xs.map((function(t,n){return o.createElement(Ts,(0,v.Z)({key:n,position:t,dimensions:Hs},e))})),o.createElement("ambientLight",{intensity:.5}),o.createElement("pointLight",{position:[10,10,10],intensity:.5}))},Ds=["onClick","font","disabled","arcStyle","label","labelColor","axisHeadScale"],Ps=["hideNegativeAxes","hideAxisHeads","disabled","font","axisColors","axisHeadScale","axisScale","labels","labelColor","onClick"];function Us(e){var t=e.scale,n=void 0===t?[.8,.05,.05]:t,r=e.color,i=e.rotation;return o.createElement("group",{rotation:i},o.createElement("mesh",{position:[.4,0,0]},o.createElement("boxGeometry",{args:n}),o.createElement("meshBasicMaterial",{color:r,toneMapped:!1})))}function Os(e){var t=e.onClick,n=e.font,r=e.disabled,i=e.arcStyle,a=e.label,u=e.labelColor,l=e.axisHeadScale,c=void 0===l?1:l,I=(0,m.Z)(e,Ds),C=(0,s.useThree)((function(e){return e.gl})),h=o.useMemo((function(){var e=document.createElement("canvas");e.width=64,e.height=64;var t=e.getContext("2d");return t.beginPath(),t.arc(32,32,16,0,2*Math.PI),t.closePath(),t.fillStyle=i,t.fill(),a&&(t.font=n,t.textAlign="center",t.fillStyle=u,t.fillText(a,32,41)),new d.CanvasTexture(e)}),[i,a,u,n]),f=o.useState(!1),p=(0,g.Z)(f,2),A=p[0],b=p[1],y=(a?1:.75)*(A?1.2:1)*c;return o.createElement("sprite",(0,v.Z)({scale:y,onPointerOver:r?void 0:function(e){e.stopPropagation(),b(!0)},onPointerOut:r?void 0:t||function(e){e.stopPropagation(),b(!1)}},I),o.createElement("spriteMaterial",{map:h,"map-anisotropy":C.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:a?1:.75,toneMapped:!1}))}var Js=function(e){var t=e.hideNegativeAxes,n=e.hideAxisHeads,r=e.disabled,i=e.font,a=void 0===i?"18px Inter var, Arial, sans-serif":i,s=e.axisColors,u=void 0===s?["#ff3653","#0adb50","#2c8fdf"]:s,l=e.axisHeadScale,c=void 0===l?1:l,d=e.axisScale,I=e.labels,C=void 0===I?["X","Y","Z"]:I,h=e.labelColor,f=void 0===h?"#000":h,p=e.onClick,A=(0,m.Z)(e,Ps),b=(0,g.Z)(u,3),y=b[0],B=b[1],G=b[2],Z=ys(),w=Z.tweenCamera,_={font:a,disabled:r,labelColor:f,raycast:Z.raycast,onClick:p,axisHeadScale:c,onPointerDown:r?void 0:function(e){w(e.object.position),e.stopPropagation()}};return o.createElement("group",(0,v.Z)({scale:40},A),o.createElement(Us,{color:y,rotation:[0,0,0],scale:d}),o.createElement(Us,{color:B,rotation:[0,0,Math.PI/2],scale:d}),o.createElement(Us,{color:G,rotation:[0,-Math.PI/2,0],scale:d}),!n&&o.createElement(o.Fragment,null,o.createElement(Os,(0,v.Z)({arcStyle:y,position:[1,0,0],label:C[0]},_)),o.createElement(Os,(0,v.Z)({arcStyle:B,position:[0,1,0],label:C[1]},_)),o.createElement(Os,(0,v.Z)({arcStyle:G,position:[0,0,1],label:C[2]},_)),!t&&o.createElement(o.Fragment,null,o.createElement(Os,(0,v.Z)({arcStyle:y,position:[-1,0,0]},_)),o.createElement(Os,(0,v.Z)({arcStyle:B,position:[0,-1,0]},_)),o.createElement(Os,(0,v.Z)({arcStyle:G,position:[0,0,-1]},_)))),o.createElement("ambientLight",{intensity:.5}),o.createElement("pointLight",{position:[10,10,10],intensity:.5}))};function Qs(e,t){var n=t.path,r=(0,s.useLoader)(d.CubeTextureLoader,[e],(function(e){return e.setPath(n)}));return(0,g.Z)(r,1)[0]}Qs.preload=function(e,t){var n=t.path;return s.useLoader.preload(d.CubeTextureLoader,[e],(function(e){return e.setPath(n)}))};var js=Uint8Array,qs=Uint16Array,$s=Uint32Array,eu=new js([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),tu=new js([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),nu=new js([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ru=function(e,t){for(var n=new qs(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new $s(n[30]);for(r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return[n,i]},iu=ru(eu,2),au=iu[0],ou=iu[1];au[28]=258,ou[258]=28;for(var su=ru(tu,0),uu=su[0],lu=(su[1],new qs(32768)),cu=0;cu<32768;++cu){var gu=(43690&cu)>>>1|(21845&cu)<<1;gu=(61680&(gu=(52428&gu)>>>2|(13107&gu)<<2))>>>4|(3855&gu)<<4,lu[cu]=((65280&gu)>>>8|(255&gu)<<8)>>>1}var du=function(e,t,n){for(var r=e.length,i=0,a=new qs(t);i<r;++i)++a[e[i]-1];var o,s=new qs(t);for(i=0;i<t;++i)s[i]=s[i-1]+a[i-1]<<1;if(n){o=new qs(1<<t);var u=15-t;for(i=0;i<r;++i)if(e[i])for(var l=i<<4|e[i],c=t-e[i],g=s[e[i]-1]++<<c,d=g|(1<<c)-1;g<=d;++g)o[lu[g]>>>u]=l}else for(o=new qs(r),i=0;i<r;++i)e[i]&&(o[i]=lu[s[e[i]-1]++]>>>15-e[i]);return o},Iu=new js(288);for(cu=0;cu<144;++cu)Iu[cu]=8;for(cu=144;cu<256;++cu)Iu[cu]=9;for(cu=256;cu<280;++cu)Iu[cu]=7;for(cu=280;cu<288;++cu)Iu[cu]=8;var Cu=new js(32);for(cu=0;cu<32;++cu)Cu[cu]=5;var hu=du(Iu,9,1),fu=du(Cu,5,1),pu=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},Au=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},mu=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},vu=function(e){return(e/8|0)+(7&e&&1)},bu=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof qs?qs:e instanceof $s?$s:js)(n-t);return r.set(e.subarray(t,n)),r},yu=function(e,t,n){var r=e.length;if(!r||n&&!n.l&&r<5)return t||new js(0);var i=!t||n,a=!n||n.i;n||(n={}),t||(t=new js(3*r));var o=function(e){var n=t.length;if(e>n){var r=new js(Math.max(2*n,e));r.set(t),t=r}},s=n.f||0,u=n.p||0,l=n.b||0,c=n.l,g=n.d,d=n.m,I=n.n,C=8*r;do{if(!c){n.f=s=Au(e,u,1);var h=Au(e,u+1,3);if(u+=3,!h){var f=e[(_=vu(u)+4)-4]|e[_-3]<<8,p=_+f;if(p>r){if(a)throw"unexpected EOF";break}i&&o(l+f),t.set(e.subarray(_,p),l),n.b=l+=f,n.p=u=8*p;continue}if(1==h)c=hu,g=fu,d=9,I=5;else{if(2!=h)throw"invalid block type";var A=Au(e,u,31)+257,m=Au(e,u+10,15)+4,v=A+Au(e,u+5,31)+1;u+=14;for(var b=new js(v),y=new js(19),B=0;B<m;++B)y[nu[B]]=Au(e,u+3*B,7);u+=3*m;var G=pu(y),Z=(1<<G)-1,w=du(y,G,1);for(B=0;B<v;){var _,x=w[Au(e,u,Z)];if(u+=15&x,(_=x>>>4)<16)b[B++]=_;else{var S=0,R=0;for(16==_?(R=3+Au(e,u,3),u+=2,S=b[B-1]):17==_?(R=3+Au(e,u,7),u+=3):18==_&&(R=11+Au(e,u,127),u+=7);R--;)b[B++]=S}}var M=b.subarray(0,A),W=b.subarray(A);d=pu(M),I=pu(W),c=du(M,d,1),g=du(W,I,1)}if(u>C){if(a)throw"unexpected EOF";break}}i&&o(l+131072);for(var k=(1<<d)-1,V=(1<<I)-1,F=u;;F=u){var E=(S=c[mu(e,u)&k])>>>4;if((u+=15&S)>C){if(a)throw"unexpected EOF";break}if(!S)throw"invalid length/literal";if(E<256)t[l++]=E;else{if(256==E){F=u,c=null;break}var X=E-254;if(E>264){var H=eu[B=E-257];X=Au(e,u,(1<<H)-1)+au[B],u+=H}var L=g[mu(e,u)&V],z=L>>>4;if(!L)throw"invalid distance";u+=15&L;W=uu[z];if(z>3){H=tu[z];W+=mu(e,u)&(1<<H)-1,u+=H}if(u>C){if(a)throw"unexpected EOF";break}i&&o(l+131072);for(var N=l+X;l<N;l+=4)t[l]=t[l-W],t[l+1]=t[l+1-W],t[l+2]=t[l+2-W],t[l+3]=t[l+3-W];l=N}}n.l=c,n.p=F,n.b=l,c&&(s=1,n.m=d,n.d=g,n.n=I)}while(!s);return l==t.length?t:bu(t,0,l)},Bu=new js(0),Gu=function(e){if(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"};function Zu(e,t){return yu((Gu(e),e.subarray(2,-4)),t)}var wu="undefined"!=typeof TextDecoder&&new TextDecoder;try{wu.decode(Bu,{stream:!0}),1}catch(Ic){}var _u,xu,Su,Ru=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r,i,a,o){var s;(0,N.Z)(this,n),(s=t.call(this)).degree=e,s.knots=r,s.controlPoints=[],s.startKnot=a||0,s.endKnot=o||s.knots.length-1;for(var u=0;u<i.length;++u){var l=i[u];s.controlPoints[u]=new d.Vector4(l.x,l.y,l.z,l.w)}return s}return(0,z.Z)(n,[{key:"getPoint",value:function(e,t){var n=t||new d.Vector3,r=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),i=function(e,t,n,r){for(var i=this.findSpan(e,r,t),a=this.calcBasisFunctions(i,r,e,t),o=new d.Vector4(0,0,0,0),s=0;s<=e;++s){var u=n[i-e+s],l=a[s],c=u.w*l;o.x+=u.x*c,o.y+=u.y*c,o.z+=u.z*c,o.w+=u.w*l}return o}(this.degree,this.knots,this.controlPoints,r);return 1!=i.w&&i.divideScalar(i.w),n.set(i.x,i.y,i.z)}},{key:"getTangent",value:function(e,t){var n=t||new d.Vector3,r=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),i=function(e,t,n,r,i){var a=this.calcBSplineDerivatives(e,t,n,r,i);return this.calcRationalCurveDerivatives(a)}(this.degree,this.knots,this.controlPoints,r,1);return n.copy(i[1]).normalize(),n}}]),n}(d.Curve),Mu=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e){return(0,N.Z)(this,n),t.call(this,e)}return(0,z.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=""===i.path?d.LoaderUtils.extractUrlBase(e):i.path,o=new d.FileLoader(this.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{t(i.parse(n,a))}catch(Ic){r?r(Ic):console.error(Ic),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e,t){if(function(e){var t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===Ou(e,0,t.length)}(e))_u=(new Eu).parse(e);else{var n=Ou(e);if(!function(e){var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],n=0;function r(t){var r=e[t-1];return e=e.slice(n+t),n++,r}for(var i=0;i<t.length;++i){if(r(1)===t[i])return!1}return!0}(n))throw new Error("THREE.FBXLoader: Unknown format.");if(Lu(n)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Lu(n));_u=(new Fu).parse(n)}var r=new d.TextureLoader(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new Wu(r,this.manager).parse(_u)}}]),n}(d.Loader),Wu=function(){function e(t,n){(0,N.Z)(this,e),this.textureLoader=t,this.manager=n}return(0,z.Z)(e,[{key:"parse",value:function(){xu=this.parseConnections();var e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),r=this.parseDeformers(),i=(new ku).parse(r);return this.parseScene(r,i,n),Su}},{key:"parseConnections",value:function(){var e=new Map;"Connections"in _u&&_u.Connections.connections.forEach((function(t){var n=t[0],r=t[1],i=t[2];e.has(n)||e.set(n,{parents:[],children:[]});var a={ID:r,relationship:i};e.get(n).parents.push(a),e.has(r)||e.set(r,{parents:[],children:[]});var o={ID:n,relationship:i};e.get(r).children.push(o)}));return e}},{key:"parseImages",value:function(){var e={},t={};if("Video"in _u.Objects){var n=_u.Objects.Video;for(var r in n){var i=n[r];if(e[parseInt(r)]=i.RelativeFilename||i.Filename,"Content"in i){var a=i.Content instanceof ArrayBuffer&&i.Content.byteLength>0,o="string"===typeof i.Content&&""!==i.Content;if(a||o){var s=this.parseImage(n[r]);t[i.RelativeFilename||i.Filename]=s}}}}for(var u in e){var l=e[u];void 0!==t[l]?e[u]=t[l]:e[u]=e[u].split("\\").pop()}return e}},{key:"parseImage",value:function(e){var t,n=e.Content,r=e.RelativeFilename||e.Filename,i=r.slice(r.lastIndexOf(".")+1).toLowerCase();switch(i){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",r),t="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+i+'" is not supported.')}if("string"===typeof n)return"data:"+t+";base64,"+n;var a=new Uint8Array(n);return window.URL.createObjectURL(new Blob([a],{type:t}))}},{key:"parseTextures",value:function(e){var t=new Map;if("Texture"in _u.Objects){var n=_u.Objects.Texture;for(var r in n){var i=this.parseTexture(n[r],e);t.set(parseInt(r),i)}}return t}},{key:"parseTexture",value:function(e,t){var n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;var r=e.WrapModeU,i=e.WrapModeV,a=void 0!==r?r.value:0,o=void 0!==i?i.value:0;if(n.wrapS=0===a?d.RepeatWrapping:d.ClampToEdgeWrapping,n.wrapT=0===o?d.RepeatWrapping:d.ClampToEdgeWrapping,"Scaling"in e){var s=e.Scaling.value;n.repeat.x=s[0],n.repeat.y=s[1]}return n}},{key:"loadTexture",value:function(e,t){var n,r,i=this.textureLoader.path,a=xu.get(e.id).children;void 0!==a&&a.length>0&&void 0!==t[a[0].ID]&&(0!==(n=t[a[0].ID]).indexOf("blob:")&&0!==n.indexOf("data:")||this.textureLoader.setPath(void 0));var o=e.FileName.slice(-3).toLowerCase();if("tga"===o){var s=this.manager.getHandler(".tga");null===s?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),r=new d.Texture):(s.setPath(this.textureLoader.path),r=s.load(n))}else"psd"===o?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),r=new d.Texture):r=this.textureLoader.load(n);return this.textureLoader.setPath(i),r}},{key:"parseMaterials",value:function(e){var t=new Map;if("Material"in _u.Objects){var n=_u.Objects.Material;for(var r in n){var i=this.parseMaterial(n[r],e);null!==i&&t.set(parseInt(r),i)}}return t}},{key:"parseMaterial",value:function(e,t){var n=e.id,r=e.attrName,i=e.ShadingModel;if("object"===typeof i&&(i=i.value),!xu.has(n))return null;var a,o=this.parseParameters(e,t,n);switch(i.toLowerCase()){case"phong":a=new d.MeshPhongMaterial;break;case"lambert":a=new d.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',i),a=new d.MeshPhongMaterial}return a.setValues(o),a.name=r,a}},{key:"parseParameters",value:function(e,t,n){var r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=(new d.Color).fromArray(e.Diffuse.value):!e.DiffuseColor||"Color"!==e.DiffuseColor.type&&"ColorRGB"!==e.DiffuseColor.type||(r.color=(new d.Color).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=(new d.Color).fromArray(e.Emissive.value):!e.EmissiveColor||"Color"!==e.EmissiveColor.type&&"ColorRGB"!==e.EmissiveColor.type||(r.emissive=(new d.Color).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=(new d.Color).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(r.specular=(new d.Color).fromArray(e.SpecularColor.value));var i=this;return xu.get(n).children.forEach((function(e){var n=e.relationship;switch(n){case"Bump":r.bumpMap=i.getTexture(t,e.ID);break;case"Maya|TEX_ao_map":r.aoMap=i.getTexture(t,e.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=i.getTexture(t,e.ID),void 0!==r.map&&(r.map.encoding=d.sRGBEncoding);break;case"DisplacementColor":r.displacementMap=i.getTexture(t,e.ID);break;case"EmissiveColor":r.emissiveMap=i.getTexture(t,e.ID),void 0!==r.emissiveMap&&(r.emissiveMap.encoding=d.sRGBEncoding);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=i.getTexture(t,e.ID);break;case"ReflectionColor":r.envMap=i.getTexture(t,e.ID),void 0!==r.envMap&&(r.envMap.mapping=d.EquirectangularReflectionMapping,r.envMap.encoding=d.sRGBEncoding);break;case"SpecularColor":r.specularMap=i.getTexture(t,e.ID),void 0!==r.specularMap&&(r.specularMap.encoding=d.sRGBEncoding);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=i.getTexture(t,e.ID),r.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",n)}})),r}},{key:"getTexture",value:function(e,t){return"LayeredTexture"in _u.Objects&&t in _u.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=xu.get(t).children[0].ID),e.get(t)}},{key:"parseDeformers",value:function(){var e={},t={};if("Deformer"in _u.Objects){var n=_u.Objects.Deformer;for(var r in n){var i=n[r],a=xu.get(parseInt(r));if("Skin"===i.attrType){var o=this.parseSkeleton(a,n);o.ID=r,a.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),o.geometryID=a.parents[0].ID,e[r]=o}else if("BlendShape"===i.attrType){var s={id:r};s.rawTargets=this.parseMorphTargets(a,n),s.id=r,a.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=s}}}return{skeletons:e,morphTargets:t}}},{key:"parseSkeleton",value:function(e,t){var n=[];return e.children.forEach((function(e){var r=t[e.ID];if("Cluster"===r.attrType){var i={ID:e.ID,indices:[],weights:[],transformLink:(new d.Matrix4).fromArray(r.TransformLink.a)};"Indexes"in r&&(i.indices=r.Indexes.a,i.weights=r.Weights.a),n.push(i)}})),{rawBones:n,bones:[]}}},{key:"parseMorphTargets",value:function(e,t){for(var n=[],r=0;r<e.children.length;r++){var i=e.children[r],a=t[i.ID],o={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if("BlendShapeChannel"!==a.attrType)return;o.geoID=xu.get(parseInt(i.ID)).children.filter((function(e){return void 0===e.relationship}))[0].ID,n.push(o)}return n}},{key:"parseScene",value:function(e,t,n){Su=new d.Group;var r=this.parseModels(e.skeletons,t,n),i=_u.Objects.Model,a=this;r.forEach((function(e){var t=i[e.ID];a.setLookAtProperties(e,t),xu.get(e.ID).parents.forEach((function(t){var n=r.get(t.ID);void 0!==n&&n.add(e)})),null===e.parent&&Su.add(e)})),this.bindSkeleton(e.skeletons,t,r),this.createAmbientLight(),Su.traverse((function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrix=e.parent.matrix,e.userData.transformData.parentMatrixWorld=e.parent.matrixWorld);var t=Du(e.userData.transformData);e.applyMatrix4(t),e.updateWorldMatrix()}}));var o=(new Vu).parse();1===Su.children.length&&Su.children[0].isGroup&&(Su.children[0].animations=o,Su=Su.children[0]),Su.animations=o}},{key:"parseModels",value:function(e,t,n){var r=new Map,i=_u.Objects.Model;for(var a in i){var o=parseInt(a),s=i[a],u=xu.get(o),l=this.buildSkeleton(u,e,o,s.attrName);if(!l){switch(s.attrType){case"Camera":l=this.createCamera(u);break;case"Light":l=this.createLight(u);break;case"Mesh":l=this.createMesh(u,t,n);break;case"NurbsCurve":l=this.createCurve(u,t);break;case"LimbNode":case"Root":l=new d.Bone;break;default:l=new d.Group}l.name=s.attrName?d.PropertyBinding.sanitizeNodeName(s.attrName):"",l.ID=o}this.getTransformData(l,s),r.set(o,l)}return r}},{key:"buildSkeleton",value:function(e,t,n,r){var i=null;return e.parents.forEach((function(e){var a=function(a){var o=t[a];o.rawBones.forEach((function(t,a){if(t.ID===e.ID){var s=i;(i=new d.Bone).matrixWorld.copy(t.transformLink),i.name=r?d.PropertyBinding.sanitizeNodeName(r):"",i.ID=n,o.bones[a]=i,null!==s&&i.add(s)}}))};for(var o in t)a(o)})),i}},{key:"createCamera",value:function(e){var t,n;if(e.children.forEach((function(e){var t=_u.Objects.NodeAttribute[e.ID];void 0!==t&&(n=t)})),void 0===n)t=new d.Object3D;else{var r=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(r=1);var i=1;void 0!==n.NearPlane&&(i=n.NearPlane.value/1e3);var a=1e3;void 0!==n.FarPlane&&(a=n.FarPlane.value/1e3);var o=window.innerWidth,s=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(o=n.AspectWidth.value,s=n.AspectHeight.value);var u=o/s,l=45;void 0!==n.FieldOfView&&(l=n.FieldOfView.value);var c=n.FocalLength?n.FocalLength.value:null;switch(r){case 0:t=new d.PerspectiveCamera(l,u,i,a),null!==c&&t.setFocalLength(c);break;case 1:t=new d.OrthographicCamera(-o/2,o/2,s/2,-s/2,i,a);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new d.Object3D}}return t}},{key:"createLight",value:function(e){var t,n;if(e.children.forEach((function(e){var t=_u.Objects.NodeAttribute[e.ID];void 0!==t&&(n=t)})),void 0===n)t=new d.Object3D;else{var r;r=void 0===n.LightType?0:n.LightType.value;var i=16777215;void 0!==n.Color&&(i=(new d.Color).fromArray(n.Color.value));var a=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(a=0);var o=0;void 0!==n.FarAttenuationEnd&&(o=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);switch(r){case 0:t=new d.PointLight(i,a,o,1);break;case 1:t=new d.DirectionalLight(i,a);break;case 2:var s=Math.PI/3;void 0!==n.InnerAngle&&(s=d.MathUtils.degToRad(n.InnerAngle.value));var u=0;void 0!==n.OuterAngle&&(u=d.MathUtils.degToRad(n.OuterAngle.value),u=Math.max(u,1)),t=new d.SpotLight(i,a,o,s,u,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new d.PointLight(i,a)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(t.castShadow=!0)}return t}},{key:"createMesh",value:function(e,t,n){var r,i=null,a=null,o=[];return e.children.forEach((function(e){t.has(e.ID)&&(i=t.get(e.ID)),n.has(e.ID)&&o.push(n.get(e.ID))})),o.length>1?a=o:o.length>0?a=o[0]:(a=new d.MeshPhongMaterial({color:13421772}),o.push(a)),"color"in i.attributes&&o.forEach((function(e){e.vertexColors=!0})),i.FBX_Deformer?(r=new d.SkinnedMesh(i,a)).normalizeSkinWeights():r=new d.Mesh(i,a),r}},{key:"createCurve",value:function(e,t){var n=e.children.reduce((function(e,n){return t.has(n.ID)&&(e=t.get(n.ID)),e}),null),r=new d.LineBasicMaterial({color:3342591,linewidth:1});return new d.Line(n,r)}},{key:"getTransformData",value:function(e,t){var n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),n.eulerOrder="RotationOrder"in t?Pu(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}},{key:"setLookAtProperties",value:function(e,t){"LookAtProperty"in t&&xu.get(e.ID).children.forEach((function(t){if("LookAtProperty"===t.relationship){var n=_u.Objects.Model[t.ID];if("Lcl_Translation"in n){var r=n.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(r),Su.add(e.target)):e.lookAt((new d.Vector3).fromArray(r))}}}))}},{key:"bindSkeleton",value:function(e,t,n){var r=this.parsePoseNodes(),i=function(i){var a=e[i];xu.get(parseInt(a.ID)).parents.forEach((function(e){if(t.has(e.ID)){var i=e.ID;xu.get(i).parents.forEach((function(e){n.has(e.ID)&&n.get(e.ID).bind(new d.Skeleton(a.bones),r[e.ID])}))}}))};for(var a in e)i(a)}},{key:"parsePoseNodes",value:function(){var e={};if("Pose"in _u.Objects){var t=_u.Objects.Pose;for(var n in t)if("BindPose"===t[n].attrType&&t[n].NbPoseNodes>0){var r=t[n].PoseNode;Array.isArray(r)?r.forEach((function(t){e[t.Node]=(new d.Matrix4).fromArray(t.Matrix.a)})):e[r.Node]=(new d.Matrix4).fromArray(r.Matrix.a)}}return e}},{key:"createAmbientLight",value:function(){if("GlobalSettings"in _u&&"AmbientColor"in _u.GlobalSettings){var e=_u.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],r=e[2];if(0!==t||0!==n||0!==r){var i=new d.Color(t,n,r);Su.add(new d.AmbientLight(i,1))}}}}]),e}(),ku=function(){function e(){(0,N.Z)(this,e)}return(0,z.Z)(e,[{key:"parse",value:function(e){var t=new Map;if("Geometry"in _u.Objects){var n=_u.Objects.Geometry;for(var r in n){var i=xu.get(parseInt(r)),a=this.parseGeometry(i,n[r],e);t.set(parseInt(r),a)}}return t}},{key:"parseGeometry",value:function(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}},{key:"parseMeshGeometry",value:function(e,t,n){var r=n.skeletons,i=[],a=e.parents.map((function(e){return _u.Objects.Model[e.ID]}));if(0!==a.length){var o=e.children.reduce((function(e,t){return void 0!==r[t.ID]&&(e=r[t.ID]),e}),null);e.children.forEach((function(e){void 0!==n.morphTargets[e.ID]&&i.push(n.morphTargets[e.ID])}));var s=a[0],u={};"RotationOrder"in s&&(u.eulerOrder=Pu(s.RotationOrder.value)),"InheritType"in s&&(u.inheritType=parseInt(s.InheritType.value)),"GeometricTranslation"in s&&(u.translation=s.GeometricTranslation.value),"GeometricRotation"in s&&(u.rotation=s.GeometricRotation.value),"GeometricScaling"in s&&(u.scale=s.GeometricScaling.value);var l=Du(u);return this.genGeometry(t,o,i,l)}}},{key:"genGeometry",value:function(e,t,n,r){var i=new d.BufferGeometry;e.attrName&&(i.name=e.attrName);var a=this.parseGeoNode(e,t),o=this.genBuffers(a),s=new d.Float32BufferAttribute(o.vertex,3);if(s.applyMatrix4(r),i.setAttribute("position",s),o.colors.length>0&&i.setAttribute("color",new d.Float32BufferAttribute(o.colors,3)),t&&(i.setAttribute("skinIndex",new d.Uint16BufferAttribute(o.weightsIndices,4)),i.setAttribute("skinWeight",new d.Float32BufferAttribute(o.vertexWeights,4)),i.FBX_Deformer=t),o.normal.length>0){var u=(new d.Matrix3).getNormalMatrix(r),l=new d.Float32BufferAttribute(o.normal,3);l.applyNormalMatrix(u),i.setAttribute("normal",l)}if(o.uvs.forEach((function(e,t){var n="uv"+(t+1).toString();0===t&&(n="uv"),i.setAttribute(n,new d.Float32BufferAttribute(o.uvs[t],2))})),a.material&&"AllSame"!==a.material.mappingType){var c=o.materialIndex[0],g=0;if(o.materialIndex.forEach((function(e,t){e!==c&&(i.addGroup(g,t-g,c),c=e,g=t)})),i.groups.length>0){var I=i.groups[i.groups.length-1],C=I.start+I.count;C!==o.materialIndex.length&&i.addGroup(C,o.materialIndex.length-C,c)}0===i.groups.length&&i.addGroup(0,o.materialIndex.length,o.materialIndex[0])}return this.addMorphTargets(i,e,n,r),i}},{key:"parseGeoNode",value:function(e,t){var n={};if(n.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],n.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];for(var r=0;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return n.weightTable={},null!==t&&(n.skeleton=t,t.rawBones.forEach((function(e,t){e.indices.forEach((function(r,i){void 0===n.weightTable[r]&&(n.weightTable[r]=[]),n.weightTable[r].push({id:t,weight:e.weights[i]})}))}))),n}},{key:"genBuffers",value:function(e){var t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},n=0,r=0,i=!1,a=[],o=[],s=[],u=[],l=[],c=[],g=this;return e.vertexIndices.forEach((function(d,I){var C,h=!1;d<0&&(d^=-1,h=!0);var f=[],p=[];if(a.push(3*d,3*d+1,3*d+2),e.color){var A=Yu(I,n,d,e.color);s.push(A[0],A[1],A[2])}if(e.skeleton){if(void 0!==e.weightTable[d]&&e.weightTable[d].forEach((function(e){p.push(e.weight),f.push(e.id)})),p.length>4){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);var m=[0,0,0,0],v=[0,0,0,0];p.forEach((function(e,t){var n=e,r=f[t];v.forEach((function(e,t,i){if(n>e){i[t]=n,n=e;var a=m[t];m[t]=r,r=a}}))})),f=m,p=v}for(;p.length<4;)p.push(0),f.push(0);for(var b=0;b<4;++b)l.push(p[b]),c.push(f[b])}if(e.normal){var y=Yu(I,n,d,e.normal);o.push(y[0],y[1],y[2])}e.material&&"AllSame"!==e.material.mappingType&&(C=Yu(I,n,d,e.material)[0]),e.uv&&e.uv.forEach((function(e,t){var r=Yu(I,n,d,e);void 0===u[t]&&(u[t]=[]),u[t].push(r[0]),u[t].push(r[1])})),r++,h&&(g.genFace(t,e,a,C,o,s,u,l,c,r),n++,r=0,a=[],o=[],s=[],u=[],l=[],c=[])})),t}},{key:"genFace",value:function(e,t,n,r,i,a,o,s,u,l){for(var c=function(l){e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[3*(l-1)]]),e.vertex.push(t.vertexPositions[n[3*(l-1)+1]]),e.vertex.push(t.vertexPositions[n[3*(l-1)+2]]),e.vertex.push(t.vertexPositions[n[3*l]]),e.vertex.push(t.vertexPositions[n[3*l+1]]),e.vertex.push(t.vertexPositions[n[3*l+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[4*(l-1)]),e.vertexWeights.push(s[4*(l-1)+1]),e.vertexWeights.push(s[4*(l-1)+2]),e.vertexWeights.push(s[4*(l-1)+3]),e.vertexWeights.push(s[4*l]),e.vertexWeights.push(s[4*l+1]),e.vertexWeights.push(s[4*l+2]),e.vertexWeights.push(s[4*l+3]),e.weightsIndices.push(u[0]),e.weightsIndices.push(u[1]),e.weightsIndices.push(u[2]),e.weightsIndices.push(u[3]),e.weightsIndices.push(u[4*(l-1)]),e.weightsIndices.push(u[4*(l-1)+1]),e.weightsIndices.push(u[4*(l-1)+2]),e.weightsIndices.push(u[4*(l-1)+3]),e.weightsIndices.push(u[4*l]),e.weightsIndices.push(u[4*l+1]),e.weightsIndices.push(u[4*l+2]),e.weightsIndices.push(u[4*l+3])),t.color&&(e.colors.push(a[0]),e.colors.push(a[1]),e.colors.push(a[2]),e.colors.push(a[3*(l-1)]),e.colors.push(a[3*(l-1)+1]),e.colors.push(a[3*(l-1)+2]),e.colors.push(a[3*l]),e.colors.push(a[3*l+1]),e.colors.push(a[3*l+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(i[0]),e.normal.push(i[1]),e.normal.push(i[2]),e.normal.push(i[3*(l-1)]),e.normal.push(i[3*(l-1)+1]),e.normal.push(i[3*(l-1)+2]),e.normal.push(i[3*l]),e.normal.push(i[3*l+1]),e.normal.push(i[3*l+2])),t.uv&&t.uv.forEach((function(t,n){void 0===e.uvs[n]&&(e.uvs[n]=[]),e.uvs[n].push(o[n][0]),e.uvs[n].push(o[n][1]),e.uvs[n].push(o[n][2*(l-1)]),e.uvs[n].push(o[n][2*(l-1)+1]),e.uvs[n].push(o[n][2*l]),e.uvs[n].push(o[n][2*l+1])}))},g=2;g<l;g++)c(g)}},{key:"addMorphTargets",value:function(e,t,n,r){if(0!==n.length){e.morphTargetsRelative=!0,e.morphAttributes.position=[];var i=this;n.forEach((function(n){n.rawTargets.forEach((function(n){var a=_u.Objects.Geometry[n.geoID];void 0!==a&&i.genMorphGeometry(e,t,a,r,n.name)}))}))}}},{key:"genMorphGeometry",value:function(e,t,n,r,i){for(var a=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],o=void 0!==n.Vertices?n.Vertices.a:[],s=void 0!==n.Indexes?n.Indexes.a:[],u=3*e.attributes.position.count,l=new Float32Array(u),c=0;c<s.length;c++){var g=3*s[c];l[g]=o[3*c],l[g+1]=o[3*c+1],l[g+2]=o[3*c+2]}var I={vertexIndices:a,vertexPositions:l},C=this.genBuffers(I),h=new d.Float32BufferAttribute(C.vertex,3);h.name=i||n.attrName,h.applyMatrix4(r),e.morphAttributes.position.push(h)}},{key:"parseNormals",value:function(e){var t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Normals.a,i=[];return"IndexToDirect"===n&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a)),{dataSize:3,buffer:r,indices:i,mappingType:t,referenceType:n}}},{key:"parseUVs",value:function(e){var t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.UV.a,i=[];return"IndexToDirect"===n&&(i=e.UVIndex.a),{dataSize:2,buffer:r,indices:i,mappingType:t,referenceType:n}}},{key:"parseVertexColors",value:function(e){var t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Colors.a,i=[];return"IndexToDirect"===n&&(i=e.ColorIndex.a),{dataSize:4,buffer:r,indices:i,mappingType:t,referenceType:n}}},{key:"parseMaterialIndices",value:function(e){var t=e.MappingInformationType,n=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};for(var r=e.Materials.a,i=[],a=0;a<r.length;++a)i.push(a);return{dataSize:1,buffer:r,indices:i,mappingType:t,referenceType:n}}},{key:"parseNurbsGeometry",value:function(e){if(void 0===Ru)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new d.BufferGeometry;var t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new d.BufferGeometry;for(var n,r,i=t-1,a=e.KnotVector.a,o=[],s=e.Points.a,u=0,l=s.length;u<l;u+=4)o.push((new d.Vector4).fromArray(s,u));if("Closed"===e.Form)o.push(o[0]);else if("Periodic"===e.Form){n=i,r=a.length-1-n;for(var c=0;c<i;++c)o.push(o[c])}var g=new Ru(i,a,o,n,r).getPoints(12*o.length);return(new d.BufferGeometry).setFromPoints(g)}}]),e}(),Vu=function(){function e(){(0,N.Z)(this,e)}return(0,z.Z)(e,[{key:"parse",value:function(){var e=[],t=this.parseClips();if(void 0!==t)for(var n in t){var r=t[n],i=this.addClip(r);e.push(i)}return e}},{key:"parseClips",value:function(){if(void 0!==_u.Objects.AnimationCurve){var e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);var t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}}},{key:"parseAnimationCurveNodes",value:function(){var e=_u.Objects.AnimationCurveNode,t=new Map;for(var n in e){var r=e[n];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){var i={id:r.id,attr:r.attrName,curves:{}};t.set(i.id,i)}}return t}},{key:"parseAnimationCurves",value:function(e){var t=_u.Objects.AnimationCurve;for(var n in t){var r={id:t[n].id,times:t[n].KeyTime.a.map(zu),values:t[n].KeyValueFloat.a},i=xu.get(r.id);if(void 0!==i){var a=i.parents[0].ID,o=i.parents[0].relationship;o.match(/X/)?e.get(a).curves.x=r:o.match(/Y/)?e.get(a).curves.y=r:o.match(/Z/)?e.get(a).curves.z=r:o.match(/d|DeformPercent/)&&e.has(a)&&(e.get(a).curves.morph=r)}}}},{key:"parseAnimationLayers",value:function(e){var t=_u.Objects.AnimationLayer,n=new Map,r=function(t){var r=[],i=xu.get(parseInt(t));void 0!==i&&(i.children.forEach((function(t,n){if(e.has(t.ID)){var i=e.get(t.ID);if(void 0!==i.curves.x||void 0!==i.curves.y||void 0!==i.curves.z){if(void 0===r[n]){var a=xu.get(t.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID;if(void 0!==a){var o=_u.Objects.Model[a.toString()];if(void 0===o)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",t);var s={modelName:o.attrName?d.PropertyBinding.sanitizeNodeName(o.attrName):"",ID:o.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Su.traverse((function(e){e.ID===o.id&&(s.transform=e.matrix,e.userData.transformData&&(s.eulerOrder=e.userData.transformData.eulerOrder))})),s.transform||(s.transform=new d.Matrix4),"PreRotation"in o&&(s.preRotation=o.PreRotation.value),"PostRotation"in o&&(s.postRotation=o.PostRotation.value),r[n]=s}}r[n]&&(r[n][i.attr]=i)}else if(void 0!==i.curves.morph){if(void 0===r[n]){var u=xu.get(t.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID,l=xu.get(u).parents[0].ID,c=xu.get(l).parents[0].ID,g=xu.get(c).parents[0].ID,I=_u.Objects.Model[g],C={modelName:I.attrName?d.PropertyBinding.sanitizeNodeName(I.attrName):"",morphName:_u.Objects.Deformer[u].attrName};r[n]=C}r[n][i.attr]=i}}})),n.set(parseInt(t),r))};for(var i in t)r(i);return n}},{key:"parseAnimStacks",value:function(e){var t=_u.Objects.AnimationStack,n={};for(var r in t){var i=xu.get(parseInt(r)).children;i.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var a=e.get(i[0].ID);n[r]={name:t[r].attrName,layer:a}}return n}},{key:"addClip",value:function(e){var t=[],n=this;return e.layer.forEach((function(e){t=t.concat(n.generateTracks(e))})),new d.AnimationClip(e.name,-1,t)}},{key:"generateTracks",value:function(e){var t=[],n=new d.Vector3,r=new d.Quaternion,i=new d.Vector3;if(e.transform&&e.transform.decompose(n,r,i),n=n.toArray(),r=(new d.Euler).setFromQuaternion(r,e.eulerOrder).toArray(),i=i.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){var a=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");void 0!==a&&t.push(a)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){var o=this.generateRotationTrack(e.modelName,e.R.curves,r,e.preRotation,e.postRotation,e.eulerOrder);void 0!==o&&t.push(o)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){var s=this.generateVectorTrack(e.modelName,e.S.curves,i,"scale");void 0!==s&&t.push(s)}if(void 0!==e.DeformPercent){var u=this.generateMorphTrack(e);void 0!==u&&t.push(u)}return t}},{key:"generateVectorTrack",value:function(e,t,n,r){var i=this.getTimesForAllAxes(t),a=this.getKeyframeTrackValues(i,t,n);return new d.VectorKeyframeTrack(e+"."+r,i,a)}},{key:"generateRotationTrack",value:function(e,t,n,r,i,a){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(d.MathUtils.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(d.MathUtils.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(d.MathUtils.degToRad));var o=this.getTimesForAllAxes(t),s=this.getKeyframeTrackValues(o,t,n);void 0!==r&&((r=r.map(d.MathUtils.degToRad)).push(a),r=(new d.Euler).fromArray(r),r=(new d.Quaternion).setFromEuler(r)),void 0!==i&&((i=i.map(d.MathUtils.degToRad)).push(a),i=(new d.Euler).fromArray(i),i=(new d.Quaternion).setFromEuler(i).invert());for(var u=new d.Quaternion,l=new d.Euler,c=[],g=0;g<s.length;g+=3)l.set(s[g],s[g+1],s[g+2],a),u.setFromEuler(l),void 0!==r&&u.premultiply(r),void 0!==i&&u.multiply(i),u.toArray(c,g/3*4);return new d.QuaternionKeyframeTrack(e+".quaternion",o,c)}},{key:"generateMorphTrack",value:function(e){var t=e.DeformPercent.curves.morph,n=t.values.map((function(e){return e/100})),r=Su.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new d.NumberKeyframeTrack(e.modelName+".morphTargetInfluences["+r+"]",t.times,n)}},{key:"getTimesForAllAxes",value:function(e){var t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort((function(e,t){return e-t})),t.length>1){for(var n=1,r=t[0],i=1;i<t.length;i++){var a=t[i];a!==r&&(t[n]=a,r=a,n++)}t=t.slice(0,n)}return t}},{key:"getKeyframeTrackValues",value:function(e,t,n){var r=n,i=[],a=-1,o=-1,s=-1;return e.forEach((function(e){if(t.x&&(a=t.x.times.indexOf(e)),t.y&&(o=t.y.times.indexOf(e)),t.z&&(s=t.z.times.indexOf(e)),-1!==a){var n=t.x.values[a];i.push(n),r[0]=n}else i.push(r[0]);if(-1!==o){var u=t.y.values[o];i.push(u),r[1]=u}else i.push(r[1]);if(-1!==s){var l=t.z.values[s];i.push(l),r[2]=l}else i.push(r[2])})),i}},{key:"interpolateRotations",value:function(e){for(var t=1;t<e.values.length;t++){var n=e.values[t-1],r=e.values[t]-n,i=Math.abs(r);if(i>=180){for(var a=i/180,o=r/a,s=n+o,u=e.times[t-1],l=(e.times[t]-u)/a,c=u+l,g=[],d=[];c<e.times[t];)g.push(c),c+=l,d.push(s),s+=o;e.times=Ju(e.times,t,g),e.values=Ju(e.values,t,d)}}}}]),e}(),Fu=function(){function e(){(0,N.Z)(this,e)}return(0,z.Z)(e,[{key:"getPrevNode",value:function(){return this.nodeStack[this.currentIndent-2]}},{key:"getCurrentNode",value:function(){return this.nodeStack[this.currentIndent-1]}},{key:"getCurrentProp",value:function(){return this.currentProp}},{key:"pushStack",value:function(e){this.nodeStack.push(e),this.currentIndent+=1}},{key:"popStack",value:function(){this.nodeStack.pop(),this.currentIndent-=1}},{key:"setCurrentProp",value:function(e,t){this.currentProp=e,this.currentPropName=t}},{key:"parse",value:function(e){this.currentIndent=0,this.allNodes=new Hu,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,n=e.split(/[\r\n]+/);return n.forEach((function(e,r){var i=e.match(/^[\s\t]*;/),a=e.match(/^[\s\t]*$/);if(!i&&!a){var o=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),u=e.match("^\\t{"+(t.currentIndent-1)+"}}");o?t.parseNodeBegin(e,o):s?t.parseNodeProperty(e,s,n[++r]):u?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}})),this.allNodes}},{key:"parseNodeBegin",value:function(e,t){var n=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map((function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")})),i={name:n},a=this.parseNodeAttr(r),o=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,i):n in o?("PoseNode"===n?o.PoseNode.push(i):void 0!==o[n].id&&(o[n]={},o[n][o[n].id]=o[n]),""!==a.id&&(o[n][a.id]=i)):"number"===typeof a.id?(o[n]={},o[n][a.id]=i):"Properties70"!==n&&(o[n]="PoseNode"===n?[i]:i),"number"===typeof a.id&&(i.id=a.id),""!==a.name&&(i.attrName=a.name),""!==a.type&&(i.attrType=a.type),this.pushStack(i)}},{key:"parseNodeAttr",value:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var n="",r="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:n,type:r}}},{key:"parseNodeProperty",value:function(e,t,n){var r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===i&&(i=n.replace(/"/g,"").replace(/,$/,"").trim());var a=this.getCurrentNode();if("Properties70"!==a.name){if("C"===r){var o=i.split(",").slice(1),s=parseInt(o[0]),u=parseInt(o[1]),l=i.split(",").slice(3);r="connections",function(e,t){for(var n=0,r=e.length,i=t.length;n<i;n++,r++)e[r]=t[n]}(i=[s,u],l=l.map((function(e){return e.trim().replace(/^"/,"")}))),void 0===a[r]&&(a[r]=[])}"Node"===r&&(a.id=i),r in a&&Array.isArray(a[r])?a[r].push(i):"a"!==r?a[r]=i:a.a=i,this.setCurrentProp(a,r),"a"===r&&","!==i.slice(-1)&&(a.a=Uu(i))}else this.parseNodeSpecialProperty(e,r,i)}},{key:"parseNodePropertyContinued",value:function(e){var t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=Uu(t.a))}},{key:"parseNodeSpecialProperty",value:function(e,t,n){var r=n.split('",').map((function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")})),i=r[0],a=r[1],o=r[2],s=r[3],u=r[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":u=parseFloat(u);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":u=Uu(u)}this.getPrevNode()[i]={type:a,type2:o,flag:s,value:u},this.setCurrentProp(this.getPrevNode(),i)}}]),e}(),Eu=function(){function e(){(0,N.Z)(this,e)}return(0,z.Z)(e,[{key:"parse",value:function(e){var t=new Xu(e);t.skip(23);var n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);for(var r=new Hu;!this.endOfContent(t);){var i=this.parseNode(t,n);null!==i&&r.add(i.name,i)}return r}},{key:"endOfContent",value:function(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}},{key:"parseNode",value:function(e,t){var n={},r=t>=7500?e.getUint64():e.getUint32(),i=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();var a=e.getUint8(),o=e.getString(a);if(0===r)return null;for(var s=[],u=0;u<i;u++)s.push(this.parseProperty(e));var l=s.length>0?s[0]:"",c=s.length>1?s[1]:"",g=s.length>2?s[2]:"";for(n.singleProperty=1===i&&e.getOffset()===r;r>e.getOffset();){var d=this.parseNode(e,t);null!==d&&this.parseSubNode(o,n,d)}return n.propertyList=s,"number"===typeof l&&(n.id=l),""!==c&&(n.attrName=c),""!==g&&(n.attrType=g),""!==o&&(n.name=o),n}},{key:"parseSubNode",value:function(e,t,n){if(!0===n.singleProperty){var r=n.propertyList[0];Array.isArray(r)?(t[n.name]=n,n.a=r):t[n.name]=r}else if("Connections"===e&&"C"===n.name){var i=[];n.propertyList.forEach((function(e,t){0!==t&&i.push(e)})),void 0===t.connections&&(t.connections=[]),t.connections.push(i)}else if("Properties70"===n.name){Object.keys(n).forEach((function(e){t[e]=n[e]}))}else if("Properties70"===e&&"P"===n.name){var a,o=n.propertyList[0],s=n.propertyList[1],u=n.propertyList[2],l=n.propertyList[3];0===o.indexOf("Lcl ")&&(o=o.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),a="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],t[o]={type:s,type2:u,flag:l,value:a}}else void 0===t[n.name]?"number"===typeof n.id?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:"PoseNode"===n.name?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):void 0===t[n.name][n.id]&&(t[n.name][n.id]=n)}},{key:"parseProperty",value:function(e){var t,n=e.getString(1);switch(n){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return t=e.getUint32(),e.getArrayBuffer(t);case"S":return t=e.getUint32(),e.getString(t);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var r=e.getUint32(),i=e.getUint32(),a=e.getUint32();if(0===i)switch(n){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}var o=Zu(new Uint8Array(e.getArrayBuffer(a))),s=new Xu(o.buffer);switch(n){case"b":case"c":return s.getBooleanArray(r);case"d":return s.getFloat64Array(r);case"f":return s.getFloat32Array(r);case"i":return s.getInt32Array(r);case"l":return s.getInt64Array(r)}default:throw new Error("THREE.FBXLoader: Unknown property type "+n)}}}]),e}(),Xu=function(){function e(t,n){(0,N.Z)(this,e),this.dv=new DataView(t),this.offset=0,this.littleEndian=void 0===n||n}return(0,z.Z)(e,[{key:"getOffset",value:function(){return this.offset}},{key:"size",value:function(){return this.dv.buffer.byteLength}},{key:"skip",value:function(e){this.offset+=e}},{key:"getBoolean",value:function(){return 1===(1&this.getUint8())}},{key:"getBooleanArray",value:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getBoolean());return t}},{key:"getUint8",value:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e}},{key:"getInt16",value:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}},{key:"getInt32",value:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}},{key:"getInt32Array",value:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getInt32());return t}},{key:"getUint32",value:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}},{key:"getInt64",value:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e}},{key:"getInt64Array",value:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getInt64());return t}},{key:"getUint64",value:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}},{key:"getFloat32",value:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}},{key:"getFloat32Array",value:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getFloat32());return t}},{key:"getFloat64",value:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}},{key:"getFloat64Array",value:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getFloat64());return t}},{key:"getArrayBuffer",value:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}},{key:"getString",value:function(e){for(var t=[],n=0;n<e;n++)t[n]=this.getUint8();var r=t.indexOf(0);return r>=0&&(t=t.slice(0,r)),d.LoaderUtils.decodeText(new Uint8Array(t))}}]),e}(),Hu=function(){function e(){(0,N.Z)(this,e)}return(0,z.Z)(e,[{key:"add",value:function(e,t){this[e]=t}}]),e}();function Lu(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function zu(e){return e/46186158e3}var Nu=[];function Yu(e,t,n,r){var i;switch(r.mappingType){case"ByPolygonVertex":i=e;break;case"ByPolygon":i=t;break;case"ByVertice":i=n;break;case"AllSame":i=r.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+r.mappingType)}"IndexToDirect"===r.referenceType&&(i=r.indices[i]);var a=i*r.dataSize,o=a+r.dataSize;return function(e,t,n,r){for(var i=n,a=0;i<r;i++,a++)e[a]=t[i];return e}(Nu,r.buffer,a,o)}var Tu=new d.Euler,Ku=new d.Vector3;function Du(e){var t=new d.Matrix4,n=new d.Matrix4,r=new d.Matrix4,i=new d.Matrix4,a=new d.Matrix4,o=new d.Matrix4,s=new d.Matrix4,u=new d.Matrix4,l=new d.Matrix4,c=new d.Matrix4,g=new d.Matrix4,I=new d.Matrix4,C=e.inheritType?e.inheritType:0;if(e.translation&&t.setPosition(Ku.fromArray(e.translation)),e.preRotation){var h=e.preRotation.map(d.MathUtils.degToRad);h.push(e.eulerOrder),n.makeRotationFromEuler(Tu.fromArray(h))}if(e.rotation){var f=e.rotation.map(d.MathUtils.degToRad);f.push(e.eulerOrder),r.makeRotationFromEuler(Tu.fromArray(f))}if(e.postRotation){var p=e.postRotation.map(d.MathUtils.degToRad);p.push(e.eulerOrder),i.makeRotationFromEuler(Tu.fromArray(p)),i.invert()}e.scale&&a.scale(Ku.fromArray(e.scale)),e.scalingOffset&&s.setPosition(Ku.fromArray(e.scalingOffset)),e.scalingPivot&&o.setPosition(Ku.fromArray(e.scalingPivot)),e.rotationOffset&&u.setPosition(Ku.fromArray(e.rotationOffset)),e.rotationPivot&&l.setPosition(Ku.fromArray(e.rotationPivot)),e.parentMatrixWorld&&(g.copy(e.parentMatrix),c.copy(e.parentMatrixWorld));var A=n.clone().multiply(r).multiply(i),m=new d.Matrix4;m.extractRotation(c);var v=new d.Matrix4;v.copyPosition(c);var b=v.clone().invert().multiply(c),y=m.clone().invert().multiply(b),B=a,G=new d.Matrix4;if(0===C)G.copy(m).multiply(A).multiply(y).multiply(B);else if(1===C)G.copy(m).multiply(y).multiply(A).multiply(B);else{var Z=(new d.Matrix4).scale((new d.Vector3).setFromMatrixScale(g)).clone().invert(),w=y.clone().multiply(Z);G.copy(m).multiply(A).multiply(w).multiply(B)}var _=l.clone().invert(),x=o.clone().invert(),S=t.clone().multiply(u).multiply(l).multiply(n).multiply(r).multiply(i).multiply(_).multiply(s).multiply(o).multiply(a).multiply(x),R=(new d.Matrix4).copyPosition(S),M=c.clone().multiply(R);return I.copyPosition(M),(S=I.clone().multiply(G)).premultiply(c.invert()),S}function Pu(e){var t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(e=e||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function Uu(e){return e.split(",").map((function(e){return parseFloat(e)}))}function Ou(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=e.byteLength),d.LoaderUtils.decodeText(new Uint8Array(e,t,n))}function Ju(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))}function Qu(e){return(0,s.useLoader)(Mu,e)}Qu.preload=function(e){return s.useLoader.preload(Mu,e)},Qu.clear=function(e){return s.useLoader.clear(Mu,e)};var ju,qu=new WeakMap,$u=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e){var r;return(0,N.Z)(this,n),(r=t.call(this,e)).decoderPath="",r.decoderConfig={},r.decoderBinary=null,r.decoderPending=null,r.workerLimit=4,r.workerPool=[],r.workerNextTaskID=1,r.workerSourceURL="",r.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},r.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"},r}return(0,z.Z)(n,[{key:"setDecoderPath",value:function(e){return this.decoderPath=e,this}},{key:"setDecoderConfig",value:function(e){return this.decoderConfig=e,this}},{key:"setWorkerLimit",value:function(e){return this.workerLimit=e,this}},{key:"load",value:function(e,t,n,r){var i=this,a=new d.FileLoader(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(e){var n={attributeIDs:i.defaultAttributeIDs,attributeTypes:i.defaultAttributeTypes,useUniqueIDs:!1};i.decodeGeometry(e,n).then(t).catch(r)}),n,r)}},{key:"decodeDracoFile",value:function(e,t,n,r){var i={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,i).then(t)}},{key:"decodeGeometry",value:function(e,t){var n=this;for(var r in t.attributeTypes){var i=t.attributeTypes[r];void 0!==i.BYTES_PER_ELEMENT&&(t.attributeTypes[r]=i.name)}var a,o=JSON.stringify(t);if(qu.has(e)){var s=qu.get(e);if(s.key===o)return s.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var u=this.workerNextTaskID++,l=e.byteLength,c=this._getWorker(u,l).then((function(n){return a=n,new Promise((function(n,r){a._callbacks[u]={resolve:n,reject:r},a.postMessage({type:"decode",id:u,taskConfig:t,buffer:e},[e])}))})).then((function(e){return n._createGeometry(e.geometry)}));return c.catch((function(){return!0})).then((function(){a&&u&&n._releaseTask(a,u)})),qu.set(e,{key:o,promise:c}),c}},{key:"_createGeometry",value:function(e){var t=new d.BufferGeometry;e.index&&t.setIndex(new d.BufferAttribute(e.index.array,1));for(var n=0;n<e.attributes.length;n++){var r=e.attributes[n],i=r.name,a=r.array,o=r.itemSize;t.setAttribute(i,new d.BufferAttribute(a,o))}return t}},{key:"_loadLibrary",value:function(e,t){var n=new d.FileLoader(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((function(t,r){n.load(e,t,void 0,r)}))}},{key:"preload",value:function(){return this._initDecoder(),this}},{key:"_initDecoder",value:function(){var e=this;if(this.decoderPending)return this.decoderPending;var t="object"!==typeof WebAssembly||"js"===this.decoderConfig.type,n=[];return t?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then((function(n){var r=n[0];t||(e.decoderConfig.wasmBinary=n[1]);var i=el.toString(),a=["/* draco decoder */",r,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([a]))})),this.decoderPending}},{key:"_getWorker",value:function(e,t){var n=this;return this._initDecoder().then((function(){if(n.workerPool.length<n.workerLimit){var r=new Worker(n.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:n.decoderConfig}),r.onmessage=function(e){var t=e.data;switch(t.type){case"decode":r._callbacks[t.id].resolve(t);break;case"error":r._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},n.workerPool.push(r)}else n.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));var i=n.workerPool[n.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i}))}},{key:"_releaseTask",value:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}},{key:"debug",value:function(){console.log("Task load: ",this.workerPool.map((function(e){return e._taskLoad})))}},{key:"dispose",value:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}]),n}(d.Loader);function el(){var e,t;function n(e,t,n,r,i,a){var o=a.num_components(),s=n.num_points()*o,u=s*i.BYTES_PER_ELEMENT,l=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,i),c=e._malloc(u);t.GetAttributeDataArrayForAllPoints(n,a,l,u,c);var g=new i(e.HEAPF32.buffer,c,s).slice();return e._free(c),{name:r,array:g,itemSize:o}}onmessage=function(r){var i=r.data;switch(i.type){case"init":e=i.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":var a=i.buffer,o=i.taskConfig;t.then((function(e){var t=e.draco,r=new t.Decoder,s=new t.DecoderBuffer;s.Init(new Int8Array(a),a.byteLength);try{var u=function(e,t,r,i){var a,o,s=i.attributeIDs,u=i.attributeTypes,l=t.GetEncodedGeometryType(r);if(l===e.TRIANGULAR_MESH)a=new e.Mesh,o=t.DecodeBufferToMesh(r,a);else{if(l!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");a=new e.PointCloud,o=t.DecodeBufferToPointCloud(r,a)}if(!o.ok()||0===a.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+o.error_msg());var c={index:null,attributes:[]};for(var g in s){var d=self[u[g]],I=void 0,C=void 0;if(i.useUniqueIDs)C=s[g],I=t.GetAttributeByUniqueId(a,C);else{if(-1===(C=t.GetAttributeId(a,e[s[g]])))continue;I=t.GetAttribute(a,C)}c.attributes.push(n(e,t,a,g,d,I))}l===e.TRIANGULAR_MESH&&(c.index=function(e,t,n){var r=3*n.num_faces(),i=4*r,a=e._malloc(i);t.GetTrianglesUInt32Array(n,i,a);var o=new Uint32Array(e.HEAPF32.buffer,a,r).slice();return e._free(a),{array:o,itemSize:1}}(e,t,a));return e.destroy(a),c}(t,r,s,o),l=u.attributes.map((function(e){return e.array.buffer}));u.index&&l.push(u.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:u},l)}catch(c){console.error(c),self.postMessage({type:"error",id:i.id,error:c.message})}finally{t.destroy(s),t.destroy(r)}}))}}}var tl=function(){if(ju)return ju;var e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if("object"!==typeof WebAssembly)return{supported:!1};var n,r="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";WebAssembly.validate(e)&&(r="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB");var i=WebAssembly.instantiate(function(e){for(var n=new Uint8Array(e.length),r=0;r<e.length;++r){var i=e.charCodeAt(r);n[r]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}for(var a=0,o=0;o<e.length;++o)n[a++]=n[o]<60?t[n[o]]:64*(n[o]-60)+n[++o];return n.buffer.slice(0,a)}(r),{}).then((function(e){(n=e.instance).exports.__wasm_call_ctors()}));function a(e,t,r,i,a,o){var s=n.exports.sbrk,u=r+3&-4,l=s(u*i),c=s(a.length),g=new Uint8Array(n.exports.memory.buffer);g.set(a,c);var d=e(l,r,i,c,a.length);if(0===d&&o&&o(l,u,i),t.set(g.subarray(l,l+r*i)),s(l-s(0)),0!==d)throw new Error("Malformed buffer data: ".concat(d))}var o={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},s={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return ju={ready:i,supported:!0,decodeVertexBuffer:function(e,t,r,i,s){a(n.exports.meshopt_decodeVertexBuffer,e,t,r,i,n.exports[o[s]])},decodeIndexBuffer:function(e,t,r,i){a(n.exports.meshopt_decodeIndexBuffer,e,t,r,i)},decodeIndexSequence:function(e,t,r,i){a(n.exports.meshopt_decodeIndexSequence,e,t,r,i)},decodeGltfBuffer:function(e,t,r,i,u,l){a(n.exports[s[u]],e,t,r,i,n.exports[o[l]])}},ju},nl=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e){var r;return(0,N.Z)(this,n),(r=t.call(this,e)).dracoLoader=null,r.ktx2Loader=null,r.meshoptDecoder=null,r.pluginCallbacks=[],r.register((function(e){return new sl(e)})),r.register((function(e){return new Il(e)})),r.register((function(e){return new Cl(e)})),r.register((function(e){return new ul(e)})),r.register((function(e){return new ll(e)})),r.register((function(e){return new cl(e)})),r.register((function(e){return new gl(e)})),r.register((function(e){return new dl(e)})),r.register((function(e){return new al(e)})),r.register((function(e){return new hl(e)})),r}return(0,z.Z)(n,[{key:"load",value:function(e,t,n,r){var i,a=this;i=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:d.LoaderUtils.extractUrlBase(e),this.manager.itemStart(e);var o=function(t){r?r(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},s=new d.FileLoader(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(n){try{a.parse(n,i,(function(n){t(n),a.manager.itemEnd(e)}),o)}catch(Ic){o(Ic)}}),n,o)}},{key:"setDRACOLoader",value:function(e){return this.dracoLoader=e,this}},{key:"setDDSLoader",value:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}},{key:"setKTX2Loader",value:function(e){return this.ktx2Loader=e,this}},{key:"setMeshoptDecoder",value:function(e){return this.meshoptDecoder=e,this}},{key:"register",value:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}},{key:"unregister",value:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}},{key:"parse",value:function(e,t,n,r){var i,a={},o={};if("string"===typeof e)i=e;else if(d.LoaderUtils.decodeText(new Uint8Array(e,0,4))===fl){try{a[il.KHR_BINARY_GLTF]=new ml(e)}catch(h){return void(r&&r(h))}i=a[il.KHR_BINARY_GLTF].content}else i=d.LoaderUtils.decodeText(new Uint8Array(e));var s=JSON.parse(i);if(void 0===s.asset||s.asset.version[0]<2)r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var u=new jl(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(var l=0;l<this.pluginCallbacks.length;l++){var c=this.pluginCallbacks[l](u);o[c.name]=c,a[c.name]=!0}if(s.extensionsUsed)for(var g=0;g<s.extensionsUsed.length;++g){var I=s.extensionsUsed[g],C=s.extensionsRequired||[];switch(I){case il.KHR_MATERIALS_UNLIT:a[I]=new ol;break;case il.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:a[I]=new Bl;break;case il.KHR_DRACO_MESH_COMPRESSION:a[I]=new vl(s,this.dracoLoader);break;case il.KHR_TEXTURE_TRANSFORM:a[I]=new bl;break;case il.KHR_MESH_QUANTIZATION:a[I]=new Gl;break;default:C.indexOf(I)>=0&&void 0===o[I]&&console.warn('THREE.GLTFLoader: Unknown extension "'+I+'".')}}u.setExtensions(a),u.setPlugins(o),u.parse(n,r)}}},{key:"parseAsync",value:function(e,t){var n=this;return new Promise((function(r,i){n.parse(e,t,r,i)}))}}]),n}(d.Loader);function rl(){var e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}var il={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"},al=function(){function e(t){(0,N.Z)(this,e),this.parser=t,this.name=il.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}return(0,z.Z)(e,[{key:"_markDefs",value:function(){for(var e=this.parser,t=this.parser.json.nodes||[],n=0,r=t.length;n<r;n++){var i=t[n];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}},{key:"_loadLight",value:function(e){var t=this.parser,n="light:"+e,r=t.cache.get(n);if(r)return r;var i,a=t.json,o=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e],s=new d.Color(16777215);void 0!==o.color&&s.fromArray(o.color);var u=void 0!==o.range?o.range:0;switch(o.type){case"directional":(i=new d.DirectionalLight(s)).target.position.set(0,0,-1),i.add(i.target);break;case"point":(i=new d.PointLight(s)).distance=u;break;case"spot":(i=new d.SpotLight(s)).distance=u,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,i.angle=o.spot.outerConeAngle,i.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,i.target.position.set(0,0,-1),i.add(i.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return i.position.set(0,0,0),i.decay=2,void 0!==o.intensity&&(i.intensity=o.intensity),i.name=t.createUniqueName(o.name||"light_"+e),r=Promise.resolve(i),t.cache.add(n,r),r}},{key:"createNodeAttachment",value:function(e){var t=this,n=this.parser,r=n.json.nodes[e],i=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then((function(e){return n._getNodeRef(t.cache,i,e)}))}}]),e}(),ol=function(){function e(){(0,N.Z)(this,e),this.name=il.KHR_MATERIALS_UNLIT}return(0,z.Z)(e,[{key:"getMaterialType",value:function(){return d.MeshBasicMaterial}},{key:"extendParams",value:function(e,t,n){var r=[];e.color=new d.Color(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var a=i.baseColorFactor;e.color.fromArray(a),e.opacity=a[3]}void 0!==i.baseColorTexture&&r.push(n.assignTexture(e,"map",i.baseColorTexture))}return Promise.all(r)}}]),e}(),sl=function(){function e(t){(0,N.Z)(this,e),this.parser=t,this.name=il.KHR_MATERIALS_CLEARCOAT}return(0,z.Z)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.MeshPhysicalMaterial:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&i.push(n.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&i.push(n.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(i.push(n.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){var o=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new d.Vector2(o,o)}return Promise.all(i)}}]),e}(),ul=function(){function e(t){(0,N.Z)(this,e),this.parser=t,this.name=il.KHR_MATERIALS_SHEEN}return(0,z.Z)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.MeshPhysicalMaterial:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[];t.sheenColor=new d.Color(0,0,0),t.sheenRoughness=0,t.sheen=1;var a=r.extensions[this.name];return void 0!==a.sheenColorFactor&&t.sheenColor.fromArray(a.sheenColorFactor),void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&i.push(n.assignTexture(t,"sheenColorMap",a.sheenColorTexture)),void 0!==a.sheenRoughnessTexture&&i.push(n.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(i)}}]),e}(),ll=function(){function e(t){(0,N.Z)(this,e),this.parser=t,this.name=il.KHR_MATERIALS_TRANSMISSION}return(0,z.Z)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.MeshPhysicalMaterial:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&i.push(n.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(i)}}]),e}(),cl=function(){function e(t){(0,N.Z)(this,e),this.parser=t,this.name=il.KHR_MATERIALS_VOLUME}return(0,z.Z)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.MeshPhysicalMaterial:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&i.push(n.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||0;var o=a.attenuationColor||[1,1,1];return t.attenuationColor=new d.Color(o[0],o[1],o[2]),Promise.all(i)}}]),e}(),gl=function(){function e(t){(0,N.Z)(this,e),this.parser=t,this.name=il.KHR_MATERIALS_IOR}return(0,z.Z)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.MeshPhysicalMaterial:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var r=n.extensions[this.name];return t.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}]),e}(),dl=function(){function e(t){(0,N.Z)(this,e),this.parser=t,this.name=il.KHR_MATERIALS_SPECULAR}return(0,z.Z)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.MeshPhysicalMaterial:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&i.push(n.assignTexture(t,"specularIntensityMap",a.specularTexture));var o=a.specularColorFactor||[1,1,1];return t.specularColor=new d.Color(o[0],o[1],o[2]),void 0!==a.specularColorTexture&&i.push(n.assignTexture(t,"specularColorMap",a.specularColorTexture).then((function(e){e.encoding=d.sRGBEncoding}))),Promise.all(i)}}]),e}(),Il=function(){function e(t){(0,N.Z)(this,e),this.parser=t,this.name=il.KHR_TEXTURE_BASISU}return(0,z.Z)(e,[{key:"loadTexture",value:function(e){var t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;var i=r.extensions[this.name],a=n.images[i.source],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,a,o)}}]),e}(),Cl=function(){function e(t){(0,N.Z)(this,e),this.parser=t,this.name=il.EXT_TEXTURE_WEBP,this.isSupported=null}return(0,z.Z)(e,[{key:"loadTexture",value:function(e){var t=this.name,n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[t])return null;var a=i.extensions[t],o=r.images[a.source],s=n.textureLoader;if(o.uri){var u=n.options.manager.getHandler(o.uri);null!==u&&(s=u)}return this.detectSupport().then((function(i){if(i)return n.loadTextureImage(e,o,s);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}},{key:"detectSupport",value:function(){return this.isSupported||(this.isSupported=new Promise((function(e){var t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}]),e}(),hl=function(){function e(t){(0,N.Z)(this,e),this.name=il.EXT_MESHOPT_COMPRESSION,this.parser=t}return(0,z.Z)(e,[{key:"loadBufferView",value:function(e){var t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){var r=n.extensions[this.name],i=this.parser.getDependency("buffer",r.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([i,a.ready]).then((function(e){var t=r.byteOffset||0,n=r.byteLength||0,i=r.count,o=r.byteStride,s=new ArrayBuffer(i*o),u=new Uint8Array(e[0],t,n);return a.decodeGltfBuffer(new Uint8Array(s),i,o,u,r.mode,r.filter),s}))}return null}}]),e}(),fl="glTF",pl=1313821514,Al=5130562,ml=(0,z.Z)((function e(t){(0,N.Z)(this,e),this.name=il.KHR_BINARY_GLTF,this.content=null,this.body=null;var n=new DataView(t,0,12);if(this.header={magic:d.LoaderUtils.decodeText(new Uint8Array(t.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==fl)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var r=this.header.length-12,i=new DataView(t,12),a=0;a<r;){var o=i.getUint32(a,!0);a+=4;var s=i.getUint32(a,!0);if(a+=4,s===pl){var u=new Uint8Array(t,12+a,o);this.content=d.LoaderUtils.decodeText(u)}else if(s===Al){var l=12+a;this.body=t.slice(l,l+o)}a+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")})),vl=function(){function e(t,n){if((0,N.Z)(this,e),!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=il.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=n,this.dracoLoader.preload()}return(0,z.Z)(e,[{key:"decodePrimitive",value:function(e,t){var n=this.json,r=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},s={},u={};for(var l in a){var c=Ll[l]||l.toLowerCase();o[c]=a[l]}for(var g in e.attributes){var d=Ll[g]||g.toLowerCase();if(void 0!==a[g]){var I=n.accessors[e.attributes[g]],C=Fl[I.componentType];u[d]=C,s[d]=!0===I.normalized}}return t.getDependency("bufferView",i).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(var n in e.attributes){var r=e.attributes[n],i=s[n];void 0!==i&&(r.normalized=i)}t(e)}),o,u)}))}))}}]),e}(),bl=function(){function e(){(0,N.Z)(this,e),this.name=il.KHR_TEXTURE_TRANSFORM}return(0,z.Z)(e,[{key:"extendTexture",value:function(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}]),e}(),yl=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e){var r;(0,N.Z)(this,n),(r=t.call(this)).isGLTFSpecularGlossinessMaterial=!0;var i=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),a=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),o=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),u=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),l={specular:{value:(new d.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};return r._extraUniforms=l,r.onBeforeCompile=function(e){for(var t in l)e.uniforms[t]=l[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",i).replace("#include <metalnessmap_pars_fragment>",a).replace("#include <roughnessmap_fragment>",o).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",u)},Object.defineProperties((0,M.Z)(r),{specular:{get:function(){return l.specular.value},set:function(e){l.specular.value=e}},specularMap:{get:function(){return l.specularMap.value},set:function(e){l.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return l.glossiness.value},set:function(e){l.glossiness.value=e}},glossinessMap:{get:function(){return l.glossinessMap.value},set:function(e){l.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete r.metalness,delete r.roughness,delete r.metalnessMap,delete r.roughnessMap,r.setValues(e),r}return(0,z.Z)(n,[{key:"copy",value:function(e){return(0,W.Z)((0,k.Z)(n.prototype),"copy",this).call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}]),n}(d.MeshStandardMaterial),Bl=function(){function e(){(0,N.Z)(this,e),this.name=il.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}return(0,z.Z)(e,[{key:"getMaterialType",value:function(){return yl}},{key:"extendParams",value:function(e,t,n){var r=t.extensions[this.name];e.color=new d.Color(1,1,1),e.opacity=1;var i=[];if(Array.isArray(r.diffuseFactor)){var a=r.diffuseFactor;e.color.fromArray(a),e.opacity=a[3]}if(void 0!==r.diffuseTexture&&i.push(n.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new d.Color(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new d.Color(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var o=r.specularGlossinessTexture;i.push(n.assignTexture(e,"glossinessMap",o)),i.push(n.assignTexture(e,"specularMap",o))}return Promise.all(i)}},{key:"createMaterial",value:function(e){var t=new yl(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=d.TangentSpaceNormalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}]),e}(),Gl=(0,z.Z)((function e(){(0,N.Z)(this,e),this.name=il.KHR_MESH_QUANTIZATION})),Zl=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e,r,i,a){return(0,N.Z)(this,n),t.call(this,e,r,i,a)}return(0,z.Z)(n,[{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r,a=0;a!==r;a++)t[a]=n[i+a];return t}}]),n}(d.Interpolant);Zl.prototype.beforeStart_=Zl.prototype.copySampleValue_,Zl.prototype.afterEnd_=Zl.prototype.copySampleValue_,Zl.prototype.interpolate_=function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,u=3*o,l=r-t,c=(n-t)/l,g=c*c,d=g*c,I=e*u,C=I-u,h=-2*d+3*g,f=d-g,p=1-h,A=f-g+c,m=0;m!==o;m++){var v=a[C+m+o],b=a[C+m+s]*l,y=a[I+m+o],B=a[I+m]*l;i[m]=p*v+A*b+h*y+f*B}return i};var wl=new d.Quaternion,_l=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){return(0,N.Z)(this,n),t.apply(this,arguments)}return(0,z.Z)(n,[{key:"interpolate_",value:function(e,t,r,i){var a=(0,W.Z)((0,k.Z)(n.prototype),"interpolate_",this).call(this,e,t,r,i);return wl.fromArray(a).normalize().toArray(a),a}}]),n}(Zl),xl=0,Sl=1,Rl=2,Ml=3,Wl=4,kl=5,Vl=6,Fl={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},El={9728:d.NearestFilter,9729:d.LinearFilter,9984:d.NearestMipmapNearestFilter,9985:d.LinearMipmapNearestFilter,9986:d.NearestMipmapLinearFilter,9987:d.LinearMipmapLinearFilter},Xl={33071:d.ClampToEdgeWrapping,33648:d.MirroredRepeatWrapping,10497:d.RepeatWrapping},Hl={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ll={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},zl={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Nl={CUBICSPLINE:void 0,LINEAR:d.InterpolateLinear,STEP:d.InterpolateDiscrete},Yl="OPAQUE",Tl="MASK",Kl="BLEND";function Dl(e,t,n){for(var r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function Pl(e,t){void 0!==t.extras&&("object"===typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function Ul(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(var a=0,o=i.length;a<o;a++)e.morphTargetDictionary[i[a]]=a}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Ol(e){var t=e.extensions&&e.extensions[il.KHR_DRACO_MESH_COMPRESSION];return t?"draco:"+t.bufferView+":"+t.indices+":"+Jl(t.attributes):e.indices+":"+Jl(e.attributes)+":"+e.mode}function Jl(e){for(var t="",n=Object.keys(e).sort(),r=0,i=n.length;r<i;r++)t+=n[r]+":"+e[n[r]]+";";return t}function Ql(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}var jl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,N.Z)(this,e),this.json=t,this.extensions={},this.plugins={},this.options=n,this.cache=new rl,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},"undefined"!==typeof createImageBitmap&&!1===/Firefox|Safari/.test(navigator.userAgent)?this.textureLoader=new d.ImageBitmapLoader(this.options.manager):this.textureLoader=new d.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new d.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}return(0,z.Z)(e,[{key:"setExtensions",value:function(e){this.extensions=e}},{key:"setPlugins",value:function(e){this.plugins=e}},{key:"parse",value:function(e,t){var n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){var a={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};Dl(i,a,r),Pl(a,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(a)}))).then((function(){e(a)}))})).catch(t)}},{key:"_markDefs",value:function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r=0,i=t.length;r<i;r++)for(var a=t[r].joints,o=0,s=a.length;o<s;o++)e[a[o]].isBone=!0;for(var u=0,l=e.length;u<l;u++){var c=e[u];void 0!==c.mesh&&(this._addNodeRef(this.meshCache,c.mesh),void 0!==c.skin&&(n[c.mesh].isSkinnedMesh=!0)),void 0!==c.camera&&this._addNodeRef(this.cameraCache,c.camera)}}},{key:"_addNodeRef",value:function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}},{key:"_getNodeRef",value:function(e,t,n){var r=this;if(e.refs[t]<=1)return n;var i=n.clone();return function e(t,n){var i=r.associations.get(t);null!=i&&r.associations.set(n,i);var a,o=(0,Y.Z)(t.children.entries());try{for(o.s();!(a=o.n()).done;){var s=(0,g.Z)(a.value,2),u=s[0];e(s[1],n.children[u])}}catch(l){o.e(l)}finally{o.f()}}(n,i),i.name+="_instance_"+e.uses[t]++,i}},{key:"_invokeOne",value:function(e){var t=Object.values(this.plugins);t.push(this);for(var n=0;n<t.length;n++){var r=e(t[n]);if(r)return r}return null}},{key:"_invokeAll",value:function(e){var t=Object.values(this.plugins);t.unshift(this);for(var n=[],r=0;r<t.length;r++){var i=e(t[r]);i&&n.push(i)}return n}},{key:"getDependency",value:function(e,t){var n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}},{key:"getDependencies",value:function(e){var t=this.cache.get(e);if(!t){var n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t}},{key:"loadBuffer",value:function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[il.KHR_BINARY_GLTF].body);var r=this.options;return new Promise((function(e,i){n.load(d.LoaderUtils.resolveURL(t.uri,r.path),e,void 0,(function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}},{key:"loadBufferView",value:function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))}},{key:"loadAccessor",value:function(e){var t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var i=[];return void 0!==r.bufferView?i.push(this.getDependency("bufferView",r.bufferView)):i.push(null),void 0!==r.sparse&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then((function(e){var i,a,o=e[0],s=Hl[r.type],u=Fl[r.componentType],l=u.BYTES_PER_ELEMENT,c=l*s,g=r.byteOffset||0,I=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,C=!0===r.normalized;if(I&&I!==c){var h=Math.floor(g/I),f="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+h+":"+r.count,p=t.cache.get(f);p||(i=new u(o,h*I,r.count*I/l),p=new d.InterleavedBuffer(i,I/l),t.cache.add(f,p)),a=new d.InterleavedBufferAttribute(p,s,g%I/l,C)}else i=null===o?new u(r.count*s):new u(o,g,r.count*s),a=new d.BufferAttribute(i,s,C);if(void 0!==r.sparse){var A=Hl.SCALAR,m=Fl[r.sparse.indices.componentType],v=r.sparse.indices.byteOffset||0,b=r.sparse.values.byteOffset||0,y=new m(e[1],v,r.sparse.count*A),B=new u(e[2],b,r.sparse.count*s);null!==o&&(a=new d.BufferAttribute(a.array.slice(),a.itemSize,a.normalized));for(var G=0,Z=y.length;G<Z;G++){var w=y[G];if(a.setX(w,B[G*s]),s>=2&&a.setY(w,B[G*s+1]),s>=3&&a.setZ(w,B[G*s+2]),s>=4&&a.setW(w,B[G*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a}))}},{key:"loadTexture",value:function(e){var t=this.json,n=this.options,r=t.textures[e],i=t.images[r.source],a=this.textureLoader;if(i.uri){var o=n.manager.getHandler(i.uri);null!==o&&(a=o)}return this.loadTextureImage(e,i,a)}},{key:"loadTextureImage",value:function(e,t,n){var r=this,i=this.json,a=this.options,o=i.textures[e],s=(t.uri||t.bufferView)+":"+o.sampler;if(this.textureCache[s])return this.textureCache[s];var u=self.URL||self.webkitURL,l=t.uri||"",c=!1;if(void 0!==t.bufferView)l=r.getDependency("bufferView",t.bufferView).then((function(e){c=!0;var n=new Blob([e],{type:t.mimeType});return l=u.createObjectURL(n)}));else if(void 0===t.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");var g=Promise.resolve(l).then((function(e){return new Promise((function(t,r){var i=t;!0===n.isImageBitmapLoader&&(i=function(e){var n=new d.Texture(e);n.needsUpdate=!0,t(n)}),n.load(d.LoaderUtils.resolveURL(e,a.path),i,void 0,r)}))})).then((function(t){!0===c&&u.revokeObjectURL(l),t.flipY=!1,o.name&&(t.name=o.name);var n=(i.samplers||{})[o.sampler]||{};return t.magFilter=El[n.magFilter]||d.LinearFilter,t.minFilter=El[n.minFilter]||d.LinearMipmapLinearFilter,t.wrapS=Xl[n.wrapS]||d.RepeatWrapping,t.wrapT=Xl[n.wrapT]||d.RepeatWrapping,r.associations.set(t,{textures:e}),t})).catch((function(){return console.error("THREE.GLTFLoader: Couldn't load texture",l),null}));return this.textureCache[s]=g,g}},{key:"assignTexture",value:function(e,t,n){var r=this;return this.getDependency("texture",n.index).then((function(i){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===t&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),r.extensions[il.KHR_TEXTURE_TRANSFORM]){var a=void 0!==n.extensions?n.extensions[il.KHR_TEXTURE_TRANSFORM]:void 0;if(a){var o=r.associations.get(i);i=r.extensions[il.KHR_TEXTURE_TRANSFORM].extendTexture(i,a),r.associations.set(i,o)}}return e[t]=i,i}))}},{key:"assignFinalMaterial",value:function(e){var t=e.geometry,n=e.material,r=void 0===t.attributes.tangent,i=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){var o="PointsMaterial:"+n.uuid,s=this.cache.get(o);s||(s=new d.PointsMaterial,d.Material.prototype.copy.call(s,n),s.color.copy(n.color),s.map=n.map,s.sizeAttenuation=!1,this.cache.add(o,s)),n=s}else if(e.isLine){var u="LineBasicMaterial:"+n.uuid,l=this.cache.get(u);l||(l=new d.LineBasicMaterial,d.Material.prototype.copy.call(l,n),l.color.copy(n.color),this.cache.add(u,l)),n=l}if(r||i||a){var c="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(c+="specular-glossiness:"),r&&(c+="derivative-tangents:"),i&&(c+="vertex-colors:"),a&&(c+="flat-shading:");var g=this.cache.get(c);g||(g=n.clone(),i&&(g.vertexColors=!0),a&&(g.flatShading=!0),r&&(g.normalScale&&(g.normalScale.y*=-1),g.clearcoatNormalScale&&(g.clearcoatNormalScale.y*=-1)),this.cache.add(c,g),this.associations.set(g,this.associations.get(n))),n=g}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n}},{key:"getMaterialType",value:function(){return d.MeshStandardMaterial}},{key:"loadMaterial",value:function(e){var t,n=this,r=this.json,i=this.extensions,a=r.materials[e],o={},s=a.extensions||{},u=[];if(s[il.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var l=i[il.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=l.getMaterialType(),u.push(l.extendParams(o,a,n))}else if(s[il.KHR_MATERIALS_UNLIT]){var c=i[il.KHR_MATERIALS_UNLIT];t=c.getMaterialType(),u.push(c.extendParams(o,a,n))}else{var g=a.pbrMetallicRoughness||{};if(o.color=new d.Color(1,1,1),o.opacity=1,Array.isArray(g.baseColorFactor)){var I=g.baseColorFactor;o.color.fromArray(I),o.opacity=I[3]}void 0!==g.baseColorTexture&&u.push(n.assignTexture(o,"map",g.baseColorTexture)),o.metalness=void 0!==g.metallicFactor?g.metallicFactor:1,o.roughness=void 0!==g.roughnessFactor?g.roughnessFactor:1,void 0!==g.metallicRoughnessTexture&&(u.push(n.assignTexture(o,"metalnessMap",g.metallicRoughnessTexture)),u.push(n.assignTexture(o,"roughnessMap",g.metallicRoughnessTexture))),t=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),u.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)}))))}!0===a.doubleSided&&(o.side=d.DoubleSide);var C=a.alphaMode||Yl;if(C===Kl?(o.transparent=!0,o.depthWrite=!1):(o.format=d.RGBFormat,o.transparent=!1,C===Tl&&(o.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&t!==d.MeshBasicMaterial&&(u.push(n.assignTexture(o,"normalMap",a.normalTexture)),o.normalScale=new d.Vector2(1,1),void 0!==a.normalTexture.scale)){var h=a.normalTexture.scale;o.normalScale.set(h,h)}return void 0!==a.occlusionTexture&&t!==d.MeshBasicMaterial&&(u.push(n.assignTexture(o,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(o.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&t!==d.MeshBasicMaterial&&(o.emissive=(new d.Color).fromArray(a.emissiveFactor)),void 0!==a.emissiveTexture&&t!==d.MeshBasicMaterial&&u.push(n.assignTexture(o,"emissiveMap",a.emissiveTexture)),Promise.all(u).then((function(){var r;return r=t===yl?i[il.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):new t(o),a.name&&(r.name=a.name),r.map&&(r.map.encoding=d.sRGBEncoding),r.emissiveMap&&(r.emissiveMap.encoding=d.sRGBEncoding),Pl(r,a),n.associations.set(r,{materials:e}),a.extensions&&Dl(i,r,a),r}))}},{key:"createUniqueName",value:function(e){for(var t=d.PropertyBinding.sanitizeNodeName(e||""),n=t,r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n}},{key:"loadGeometries",value:function(e){var t=this,n=this.extensions,r=this.primitiveCache;function i(e){return n[il.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return $l(n,e,t)}))}for(var a=[],o=0,s=e.length;o<s;o++){var u=e[o],l=Ol(u),c=r[l];if(c)a.push(c.promise);else{var g=void 0;g=u.extensions&&u.extensions[il.KHR_DRACO_MESH_COMPRESSION]?i(u):$l(new d.BufferGeometry,u,t),r[l]={primitive:u,promise:g},a.push(g)}}return Promise.all(a)}},{key:"loadMesh",value:function(e){for(var t,n=this,r=this.json,i=this.extensions,a=r.meshes[e],o=a.primitives,s=[],u=0,l=o.length;u<l;u++){var c=void 0===o[u].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new d.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:d.FrontSide})),t.DefaultMaterial):this.getDependency("material",o[u].material);s.push(c)}return s.push(n.loadGeometries(o)),Promise.all(s).then((function(t){for(var r=t.slice(0,t.length-1),s=t[t.length-1],u=[],l=0,c=s.length;l<c;l++){var g=s[l],I=o[l],C=void 0,h=r[l];if(I.mode===Wl||I.mode===kl||I.mode===Vl||void 0===I.mode)!0!==(C=!0===a.isSkinnedMesh?new d.SkinnedMesh(g,h):new d.Mesh(g,h)).isSkinnedMesh||C.geometry.attributes.skinWeight.normalized||C.normalizeSkinWeights(),I.mode===kl?C.geometry=ec(C.geometry,d.TriangleStripDrawMode):I.mode===Vl&&(C.geometry=ec(C.geometry,d.TriangleFanDrawMode));else if(I.mode===Sl)C=new d.LineSegments(g,h);else if(I.mode===Ml)C=new d.Line(g,h);else if(I.mode===Rl)C=new d.LineLoop(g,h);else{if(I.mode!==xl)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+I.mode);C=new d.Points(g,h)}Object.keys(C.geometry.morphAttributes).length>0&&Ul(C,a),C.name=n.createUniqueName(a.name||"mesh_"+e),Pl(C,a),I.extensions&&Dl(i,C,I),n.assignFinalMaterial(C),u.push(C)}for(var f=0,p=u.length;f<p;f++)n.associations.set(u[f],{meshes:e,primitives:f});if(1===u.length)return u[0];var A=new d.Group;n.associations.set(A,{meshes:e});for(var m=0,v=u.length;m<v;m++)A.add(u[m]);return A}))}},{key:"loadCamera",value:function(e){var t,n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new d.PerspectiveCamera(d.MathUtils.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new d.OrthographicCamera(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Pl(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}},{key:"loadSkin",value:function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))}},{key:"loadAnimation",value:function(e){for(var t=this.json.animations[e],n=[],r=[],i=[],a=[],o=[],s=0,u=t.channels.length;s<u;s++){var l=t.channels[s],c=t.samplers[l.sampler],g=l.target,I=void 0!==g.node?g.node:g.id,C=void 0!==t.parameters?t.parameters[c.input]:c.input,h=void 0!==t.parameters?t.parameters[c.output]:c.output;n.push(this.getDependency("node",I)),r.push(this.getDependency("accessor",C)),i.push(this.getDependency("accessor",h)),a.push(c),o.push(g)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(i),Promise.all(a),Promise.all(o)]).then((function(n){for(var r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=[],l=function(e,t){var n=r[e],l=i[e],c=a[e],g=o[e],I=s[e];if(void 0===n)return"continue";n.updateMatrix(),n.matrixAutoUpdate=!0;var C=void 0;switch(zl[I.path]){case zl.weights:C=d.NumberKeyframeTrack;break;case zl.rotation:C=d.QuaternionKeyframeTrack;break;default:C=d.VectorKeyframeTrack}var h=n.name?n.name:n.uuid,f=void 0!==g.interpolation?Nl[g.interpolation]:d.InterpolateLinear,p=[];zl[I.path]===zl.weights?n.traverse((function(e){e.morphTargetInfluences&&p.push(e.name?e.name:e.uuid)})):p.push(h);var A=c.array;if(c.normalized){for(var m=Ql(A.constructor),v=new Float32Array(A.length),b=0,y=A.length;b<y;b++)v[b]=A[b]*m;A=v}for(var B=0,G=p.length;B<G;B++){var Z=new C(p[B]+"."+zl[I.path],l.array,A,f);"CUBICSPLINE"===g.interpolation&&(Z.createInterpolant=function(e){return new(this instanceof d.QuaternionKeyframeTrack?_l:Zl)(this.times,this.values,this.getValueSize()/3,e)},Z.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),u.push(Z)}},c=0,g=r.length;c<g;c++)l(c);var I=t.name?t.name:"animation_"+e;return new d.AnimationClip(I,void 0,u)}))}},{key:"createNodeMesh",value:function(e){var t=this.json,n=this,r=t.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then((function(e){var t=n._getNodeRef(n.meshCache,r.mesh,e);return void 0!==r.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,n=r.weights.length;t<n;t++)e.morphTargetInfluences[t]=r.weights[t]})),t}))}},{key:"loadNode",value:function(e){var t=this.json,n=this.extensions,r=this,i=t.nodes[e],a=i.name?r.createUniqueName(i.name):"";return function(){var t=[],n=r._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return n&&t.push(n),void 0!==i.camera&&t.push(r.getDependency("camera",i.camera).then((function(e){return r._getNodeRef(r.cameraCache,i.camera,e)}))),r._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)}().then((function(t){var o;if((o=!0===i.isBone?new d.Bone:t.length>1?new d.Group:1===t.length?t[0]:new d.Object3D)!==t[0])for(var s=0,u=t.length;s<u;s++)o.add(t[s]);if(i.name&&(o.userData.name=i.name,o.name=a),Pl(o,i),i.extensions&&Dl(n,o,i),void 0!==i.matrix){var l=new d.Matrix4;l.fromArray(i.matrix),o.applyMatrix4(l)}else void 0!==i.translation&&o.position.fromArray(i.translation),void 0!==i.rotation&&o.quaternion.fromArray(i.rotation),void 0!==i.scale&&o.scale.fromArray(i.scale);return r.associations.has(o)||r.associations.set(o,{}),r.associations.get(o).nodes=e,o}))}},{key:"loadScene",value:function(e){var t=this.json,n=this.extensions,r=this.json.scenes[e],i=this,a=new d.Group;r.name&&(a.name=i.createUniqueName(r.name)),Pl(a,r),r.extensions&&Dl(n,a,r);for(var o=r.nodes||[],s=[],u=0,l=o.length;u<l;u++)s.push(ql(o[u],a,t,i));return Promise.all(s).then((function(){return i.associations=function(e){var t,n=new Map,r=(0,Y.Z)(i.associations);try{for(r.s();!(t=r.n()).done;){var a=(0,g.Z)(t.value,2),o=a[0],s=a[1];(o instanceof d.Material||o instanceof d.Texture)&&n.set(o,s)}}catch(u){r.e(u)}finally{r.f()}return e.traverse((function(e){var t=i.associations.get(e);null!=t&&n.set(e,t)})),n}(a),a}))}}]),e}();function ql(e,t,n,r){var i=n.nodes[e];return r.getDependency("node",e).then((function(e){return void 0===i.skin?e:r.getDependency("skin",i.skin).then((function(e){for(var n=[],i=0,a=(t=e).joints.length;i<a;i++)n.push(r.getDependency("node",t.joints[i]));return Promise.all(n)})).then((function(n){return e.traverse((function(e){if(e.isMesh){for(var r=[],i=[],a=0,o=n.length;a<o;a++){var s=n[a];if(s){r.push(s);var u=new d.Matrix4;void 0!==t.inverseBindMatrices&&u.fromArray(t.inverseBindMatrices.array,16*a),i.push(u)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[a])}e.bind(new d.Skeleton(r,i),e.matrixWorld)}})),e}));var t})).then((function(e){t.add(e);var a=[];if(i.children)for(var o=i.children,s=0,u=o.length;s<u;s++){var l=o[s];a.push(ql(l,e,n,r))}return Promise.all(a)}))}function $l(e,t,n){var r=t.attributes,i=[];function a(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(var o in r){var s=Ll[o]||o.toLowerCase();s in e.attributes||i.push(a(r[o],s))}if(void 0!==t.indices&&!e.index){var u=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));i.push(u)}return Pl(e,t),function(e,t,n){var r=t.attributes,i=new d.Box3;if(void 0!==r.POSITION){var a=n.json.accessors[r.POSITION],o=a.min,s=a.max;if(void 0!==o&&void 0!==s){if(i.set(new d.Vector3(o[0],o[1],o[2]),new d.Vector3(s[0],s[1],s[2])),a.normalized){var u=Ql(Fl[a.componentType]);i.min.multiplyScalar(u),i.max.multiplyScalar(u)}var l=t.targets;if(void 0!==l){for(var c=new d.Vector3,g=new d.Vector3,I=0,C=l.length;I<C;I++){var h=l[I];if(void 0!==h.POSITION){var f=n.json.accessors[h.POSITION],p=f.min,A=f.max;if(void 0!==p&&void 0!==A){if(g.setX(Math.max(Math.abs(p[0]),Math.abs(A[0]))),g.setY(Math.max(Math.abs(p[1]),Math.abs(A[1]))),g.setZ(Math.max(Math.abs(p[2]),Math.abs(A[2]))),f.normalized){var m=Ql(Fl[f.componentType]);g.multiplyScalar(m)}c.max(g)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(c)}e.boundingBox=i;var v=new d.Sphere;i.getCenter(v.center),v.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=v}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,n),Promise.all(i).then((function(){return void 0!==t.targets?function(e,t,n){for(var r=!1,i=!1,a=0,o=t.length;a<o;a++){var s=t[a];if(void 0!==s.POSITION&&(r=!0),void 0!==s.NORMAL&&(i=!0),r&&i)break}if(!r&&!i)return Promise.resolve(e);for(var u=[],l=[],c=0,g=t.length;c<g;c++){var d=t[c];if(r){var I=void 0!==d.POSITION?n.getDependency("accessor",d.POSITION):e.attributes.position;u.push(I)}if(i){var C=void 0!==d.NORMAL?n.getDependency("accessor",d.NORMAL):e.attributes.normal;l.push(C)}}return Promise.all([Promise.all(u),Promise.all(l)]).then((function(t){var n=t[0],a=t[1];return r&&(e.morphAttributes.position=n),i&&(e.morphAttributes.normal=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}function ec(e,t){var n=e.getIndex();if(null===n){var r=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var a=0;a<i.count;a++)r.push(a);e.setIndex(r),n=e.getIndex()}var o=n.count-2,s=[];if(t===d.TriangleFanDrawMode)for(var u=1;u<=o;u++)s.push(n.getX(0)),s.push(n.getX(u)),s.push(n.getX(u+1));else for(var l=0;l<o;l++)l%2===0?(s.push(n.getX(l)),s.push(n.getX(l+1)),s.push(n.getX(l+2))):(s.push(n.getX(l+2)),s.push(n.getX(l+1)),s.push(n.getX(l)));s.length/3!==o&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var c=e.clone();return c.setIndex(s),c}var tc=null;function nc(e,t,n){return function(r){n&&n(r),e&&(tc||(tc=new $u),tc.setDecoderPath("string"===typeof e?e:"https://www.gstatic.com/draco/versioned/decoders/1.4.3/"),r.setDRACOLoader(tc)),t&&r.setMeshoptDecoder(tl())}}function rc(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0,i=(0,s.useLoader)(nl,e,nc(t,n,r));return i}rc.preload=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;return s.useLoader.preload(nl,e,nc(t,n,r))},rc.clear=function(e){return s.useLoader.clear(nl,e)};var ic=n(8356),ac=n.n(ic);function oc(e,t){"function"===typeof e?e(t):null!=e&&(e.current=t)}function sc(e){var t=e.showPanel,n=void 0===t?0:t,r=e.className,i=e.parent,a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=o.useState(),i=(0,g.Z)(r,2),a=i[0],s=i[1];return o.useLayoutEffect((function(){var t=e();return s(t),oc(n,t),function(){return oc(n,null)}}),t),a}((function(){return new(ac())}),[]);return o.useEffect((function(){if(a){var e=i&&i.current||document.body;a.showPanel(n),null==e||e.appendChild(a.dom),r&&a.dom.classList.add(r);var t=(0,s.addEffect)((function(){return a.begin()})),o=(0,s.addAfterEffect)((function(){return a.end()}));return function(){null==e||e.removeChild(a.dom),t(),o()}}}),[i,a,r,n]),null}var uc=["multisample","samples"];function lc(e,t,n){var r=(0,s.useThree)((function(e){return e.gl})),i=(0,s.useThree)((function(e){return e.size})),a=(0,o.useMemo)((function(){return r.getPixelRatio()}),[r]),u="number"===typeof e?e:i.width*a,l="number"===typeof t?t:i.height*a,c=("number"===typeof e?n:e)||{},g=(0,o.useMemo)((function(){var e,t=c.multisample,n=c.samples,i=(0,m.Z)(c,uc);return t&&r.capabilities.isWebGL2?(e=new d.WebGLMultisampleRenderTarget(u,l,i),n&&(e.samples=n)):e=new d.WebGLRenderTarget(u,l,i),e}),[]);return(0,o.useEffect)((function(){g.setSize(u,l)}),[g,u,l]),(0,o.useEffect)((function(){return function(){return g.dispose()}}),[]),g}var cc=o.forwardRef((function(e,t){var n=e.size,r=void 0===n?256:n;o.useEffect((function(){console.warn("DepthBuffer has been deprecated and will be removed next major. Replace it with useDepthBuffer(size)!")}),[]);var i=(0,s.useThree)((function(e){return e.viewport.dpr})),a=(0,s.useThree)((function(e){return e.size})),u=a.width,l=a.height,c=r||u*i,g=r||l*i,I=o.useMemo((function(){var e=new d.DepthTexture(c,g);return e.format=d.DepthFormat,e.type=d.UnsignedShortType,{depthTexture:e}}),[c,g]),C=lc(c,g,I);return o.useImperativeHandle(t,(function(){return null==C?void 0:C.depthTexture})),(0,s.useFrame)((function(e){e.gl.setRenderTarget(C),e.gl.render(e.scene,e.camera),e.gl.setRenderTarget(null)}))}));function gc(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.size,n=void 0===t?256:t,r=e.frames,i=void 0===r?1/0:r,a=(0,s.useThree)((function(e){return e.viewport.dpr})),u=(0,s.useThree)((function(e){return e.size})),l=u.width,c=u.height,g=n||l*a,I=n||c*a,C=o.useMemo((function(){var e=new d.DepthTexture(g,I);return e.format=d.DepthFormat,e.type=d.UnsignedShortType,{depthTexture:e}}),[g,I]),h=0,f=lc(g,I,C);return(0,s.useFrame)((function(e){(i===1/0||h<i)&&(e.gl.setRenderTarget(f),e.gl.render(e.scene,e.camera),e.gl.setRenderTarget(null),h++)})),f.depthTexture}function dc(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=(0,s.useThree)((function(e){return e.viewport})),i=t*(r.aspect>e/t?r.width/e:r.height/t),a=e*(r.aspect>e/t?r.width/e:r.height/t);return[a*n,i*n,1]}function Ic(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))}var Cc=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","radeon r9 200","sgx 543","sgx543"],hc=function(e){return e.toLowerCase().replace(/^angle ?\((.+)\)*$/,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"")},fc="undefined"==typeof window,pc=function(){if(!fc){var e=window.navigator,t=e.userAgent,n=e.platform,r=e.maxTouchPoints,i=/(iphone|ipod|ipad)/i.test(t),a="iPad"===n||"MacIntel"===n&&r>0&&!window.MSStream;return{isIpad:a,isMobile:/android/i.test(t)||i||a,isSafari12:/Version\/12.+Safari/.test(t)}}}(),Ac=function(e,t,n){return"apple gpu"===t?function(e,t,n){var r=[t];if(n){var i=e.createShader(35633),a=e.createShader(35632),o=e.createProgram();if(a&&i&&o){e.shaderSource(i,"\n      precision highp float;\n      attribute vec3 aPosition;\n      varying float vvv;\n      void main() {\n        vvv = 0.31622776601683794;\n        gl_Position = vec4(aPosition, 1.0);\n      }\n    "),e.shaderSource(a,"\n      precision highp float;\n      varying float vvv;\n      void main() {\n        vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;\n        enc = fract(enc);\n        enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\n        gl_FragColor = enc;\n      }\n    "),e.compileShader(i),e.compileShader(a),e.attachShader(o,i),e.attachShader(o,a),e.linkProgram(o),e.detachShader(o,i),e.detachShader(o,a),e.deleteShader(i),e.deleteShader(a),e.useProgram(o);var s=e.createBuffer();e.bindBuffer(34962,s),e.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);var u=e.getAttribLocation(o,"aPosition");e.vertexAttribPointer(u,3,5126,!1,0,0),e.enableVertexAttribArray(u),e.clearColor(1,1,1,1),e.clear(16384),e.viewport(0,0,1,1),e.drawArrays(4,0,3);var l=new Uint8Array(4);e.readPixels(0,0,1,1,6408,5121,l),e.deleteProgram(o),e.deleteBuffer(s),r={801621810:(null==pc?void 0:pc.isIpad)?["apple a12x gpu"]:["apple a11 gpu","apple a12 gpu","apple a13 gpu","apple a14 gpu"],8016218135:(null==pc?void 0:pc.isIpad)?["apple a9x gpu","apple a10 gpu","apple a10x gpu"]:["apple a9 gpu","apple a10 gpu"]}[l.join("")]||r}}return r}(e,t,n):[t]},mc=[],vc=[],bc=function(e,t){if(e===t)return 0;var n=e;e.length>t.length&&(e=t,t=n);for(var r=e.length,i=t.length;r>0&&e.charCodeAt(~-r)===t.charCodeAt(~-i);)r--,i--;for(var a,o=0;o<r&&e.charCodeAt(o)===t.charCodeAt(o);)o++;if(i-=o,0===(r-=o))return i;for(var s,u,l=0,c=0,g=0;c<r;)vc[c]=e.charCodeAt(o+c),mc[c]=++c;for(;g<i;)for(a=t.charCodeAt(o+g),s=g++,l=g,c=0;c<r;c++)u=a===vc[c]?s:s+1,s=mc[c],l=mc[c]=s>l?u>l?l+1:u:u>s?s+1:u;return l},yc=n(1652),Bc=function(e){return(0,yc.G)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mobileTiers,n=void 0===t?[0,15,30,60]:t,r=e.desktopTiers,i=void 0===r?[0,15,30,60]:r,a=e.override,o=void 0===a?{}:a,s=e.glContext,u=e.failIfMajorPerformanceCaveat,l=void 0!==u&&u,c=e.benchmarksURL,d=void 0===c?"https://unpkg.com/detect-gpu@3.1.30/dist/benchmarks":c;return Ic(void 0,void 0,void 0,K().mark((function e(){var t,r,a,u,c,I,C,h,f,p,A,m,v,b,y,B,G,Z,w,_,x,S,R,M;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},!fc){e.next=3;break}return e.abrupt("return",{tier:0,type:"SSR"});case 3:if(r=o.isIpad,a=void 0===r?!!(null==pc?void 0:pc.isIpad):r,u=o.isMobile,c=void 0===u?!!(null==pc?void 0:pc.isMobile):u,I=o.screenSize,C=void 0===I?window.screen:I,h=o.loadBenchmarks,f=void 0===h?function(e){return Ic(void 0,void 0,void 0,K().mark((function t(){var n;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(d,"/").concat(e)).then((function(e){return e.json()}));case 2:return n=t.sent,t.abrupt("return",(n.shift(),n));case 4:case"end":return t.stop()}}),t)})))}:h,p=o.renderer,A=function(e,t,n,r,i){return{device:i,fps:r,gpu:n,isMobile:c,tier:e,type:t}},v="",!p){e.next=11;break}p=hc(p),m=[p],e.next=18;break;case 11:if(b=s||function(e){var t={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:arguments.length>1&&void 0!==arguments[1]&&arguments[1],powerPreference:"high-performance",stencil:!1};e&&delete t.powerPreference;var n=window.document.createElement("canvas"),r=n.getContext("webgl",t)||n.getContext("experimental-webgl",t);return null!=r?r:void 0}(null==pc?void 0:pc.isSafari12,l),b){e.next=14;break}return e.abrupt("return",A(0,"WEBGL_UNSUPPORTED"));case 14:if((y=b.getExtension("WEBGL_debug_renderer_info"))&&(p=b.getParameter(y.UNMASKED_RENDERER_WEBGL)),p){e.next=17;break}return e.abrupt("return",A(1,"FALLBACK"));case 17:v=p,p=hc(p),m=Ac(b,p,c);case 18:return e.next=20,Promise.all(m.map((function(e){return Ic(void 0,void 0,void 0,K().mark((function n(){var r,i,o,s,u,l,d,I,h,p,A,m,v,b,y,B,G,Z,w,_,x,S,R,M,W,k,V,F,E;return K().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=function(e){for(var t=0,n=c?["adreno","apple","mali-t","mali","nvidia","powervr"]:["intel","amd","radeon","nvidia","geforce"];t<n.length;t++){var r=n[t];if(e.includes(r))return r}}(e)){n.next=3;break}return n.abrupt("return");case 3:return i="".concat(c?"m":"d","-").concat(r,".json"),o=t[i]=t[i]||f(i),n.prev=4,n.next=7,o;case 7:s=n.sent,n.next=13;break;case 10:return n.prev=10,n.t0=n.catch(4),n.abrupt("return");case 13:if(u=function(e){var t,n=(e=e.replace(/\([^)]+\)/,"")).match(/\d+/)||e.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return null!==(t=null==n?void 0:n.join("").replace(/\W|amd/g,""))&&void 0!==t?t:""}(e),l="apple"===r,(d=s.filter((function(e){return(0,g.Z)(e,2)[1]===u}))).length||(d=s.filter((function(t){return(0,g.Z)(t,1)[0].includes(e)}))),0!==(I=d.length)){n.next=19;break}return n.abrupt("return");case 19:p=I>1?d.map((function(t){return[t,bc(e,t[0])]})).sort((function(e,t){return(0,g.Z)(e,2)[1]-(0,g.Z)(t,2)[1]}))[0][0]:d[0],A=(0,g.Z)(p,4),m=A[0],v=A[3],b=Number.MAX_VALUE,y=window,B=y.devicePixelRatio,G=C.width*B*(C.height*B),l&&c&&(v=v.filter((function(e){var t,n=(0,g.Z)(e,4)[3];return(null!==(t=null==n?void 0:n.indexOf(a?"ipad":"iphone"))&&void 0!==t?t:-1)>-1}))),Z=(0,Y.Z)(v);try{for(Z.s();!(w=Z.n()).done;)_=w.value,x=(0,g.Z)(_,2),S=x[0],R=x[1],M=S*R,(W=Math.abs(G-M))<b&&(b=W,h=_)}catch(X){Z.e(X)}finally{Z.f()}if(h){n.next=26;break}return n.abrupt("return");case 26:return k=h,V=(0,g.Z)(k,4),F=V[2],E=V[3],n.abrupt("return",[b,F,m,E]);case 28:case"end":return n.stop()}}),n,null,[[4,10]])})))})));case 20:if(B=e.sent.filter((function(e){return!!e})),B.length){e.next=24;break}return G=Cc.find((function(e){return p.includes(e)})),e.abrupt("return",G?A(0,"BLOCKLISTED",G):A(1,"FALLBACK","".concat(p," (").concat(v,")")));case 24:if(Z=(0,g.Z)(B.sort((function(e,t){var n=(0,g.Z)(e,1)[0],r=void 0===n?Number.MAX_VALUE:n,i=(0,g.Z)(t,1)[0];return r-(void 0===i?Number.MAX_VALUE:i)}))[0],4),w=Z[1],_=Z[2],x=Z[3],-1!==w){e.next=27;break}return e.abrupt("return",A(0,"BLOCKLISTED",_,w,x));case 27:for(S=c?n:i,R=0,M=0;M<S.length;M++)w>=S[M]&&(R=M);return e.abrupt("return",A(R,"BENCHMARK",_,w,x));case 31:case"end":return e.stop()}}),e)})))}(e)}),"useDetectGPU")};function Gc(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var a=o.useRef(),u=(0,s.useThree)((function(e){return e.scene}));return o.useEffect((function(){return t&&e.current&&(a.current=(0,X.Z)(t,[e.current].concat(r)),a.current&&u.add(a.current)),function(){a.current&&u.remove(a.current)}}),[u,t,e,r]),(0,s.useFrame)((function(){var e;null!=(e=a.current)&&e.update&&a.current.update()})),a}var Zc=new d.Vector3,wc=new d.Vector3,_c=new d.Vector3,xc=new d.Vector2,Sc=new d.Vector2,Rc=new d.Vector2,Mc=new d.Vector3;function Wc(e,t,n,r,i,a,o){Zc.fromBufferAttribute(t,r),wc.fromBufferAttribute(t,i),_c.fromBufferAttribute(t,a);var s=function(e,t,n,r,i,a){return null===(a===d.BackSide?e.intersectTriangle(r,n,t,!0,i):e.intersectTriangle(t,n,r,a!==d.DoubleSide,i))?null:{distance:e.origin.distanceTo(i),point:i.clone()}}(e,Zc,wc,_c,Mc,o);if(s){n&&(xc.fromBufferAttribute(n,r),Sc.fromBufferAttribute(n,i),Rc.fromBufferAttribute(n,a),s.uv=d.Triangle.getUV(Mc,Zc,wc,_c,xc,Sc,Rc,new d.Vector2));var u={a:r,b:i,c:a,normal:new d.Vector3,materialIndex:0};d.Triangle.getNormal(Zc,wc,_c,u.normal),s.face=u,s.faceIndex=r}return s}function kc(e,t,n,r,i){var a=3*r,o=e.index.getX(a),s=e.index.getX(a+1),u=e.index.getX(a+2),l=Wc(n,e.attributes.position,e.attributes.uv,o,s,u,t);return l?(l.faceIndex=r,i&&i.push(l),l):null}function Vc(e,t,n){return null===e?null:(e.point.applyMatrix4(t.matrixWorld),e.distance=e.point.distanceTo(n.ray.origin),e.object=t,e.distance<n.near||e.distance>n.far?null:e)}var Fc=1.25,Ec=32,Xc=65535,Hc=Math.pow(2,-24),Lc=(0,z.Z)((function e(){(0,N.Z)(this,e)}));function zc(e,t,n){return n.min.x=t[e],n.min.y=t[e+1],n.min.z=t[e+2],n.max.x=t[e+3],n.max.y=t[e+4],n.max.z=t[e+5],n}function Nc(e){for(var t=-1,n=-1/0,r=0;r<3;r++){var i=e[r+3]-e[r];i>n&&(n=i,t=r)}return t}function Yc(e,t){t.set(e)}function Tc(e,t,n){for(var r,i,a=0;a<3;a++){var o=a+3;r=e[a],i=t[a],n[a]=r<i?r:i,r=e[o],i=t[o],n[o]=r>i?r:i}}function Kc(e,t,n){for(var r=0;r<3;r++){var i=t[e+2*r],a=t[e+2*r+1],o=i-a,s=i+a;o<n[r]&&(n[r]=o),s>n[r+3]&&(n[r+3]=s)}}function Dc(e){var t=e[3]-e[0],n=e[4]-e[1],r=e[5]-e[2];return 2*(t*n+n*r+r*t)}function Pc(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=1/0,o=1/0,s=1/0,u=-1/0,l=-1/0,c=-1/0,g=1/0,d=1/0,I=1/0,C=-1/0,h=-1/0,f=-1/0,p=null!==i,A=6*t,m=6*(t+n);A<m;A+=6){var v=e[A+0],b=e[A+1],y=v-b,B=v+b;y<a&&(a=y),B>u&&(u=B),p&&v<g&&(g=v),p&&v>C&&(C=v);var G=e[A+2],Z=e[A+3],w=G-Z,_=G+Z;w<o&&(o=w),_>l&&(l=_),p&&G<d&&(d=G),p&&G>h&&(h=G);var x=e[A+4],S=e[A+5],R=x-S,M=x+S;R<s&&(s=R),M>c&&(c=M),p&&x<I&&(I=x),p&&x>f&&(f=x)}r[0]=a,r[1]=o,r[2]=s,r[3]=u,r[4]=l,r[5]=c,p&&(i[0]=g,i[1]=d,i[2]=I,i[3]=C,i[4]=h,i[5]=f)}function Uc(e,t,n,r,i){for(var a=n,o=n+r-1,s=i.pos,u=2*i.axis;;){for(;a<=o&&t[6*a+u]<s;)a++;for(;a<=o&&t[6*o+u]>=s;)o--;if(!(a<o))return a;for(var l=0;l<3;l++){var c=e[3*a+l];e[3*a+l]=e[3*o+l],e[3*o+l]=c;var g=t[6*a+2*l+0];t[6*a+2*l+0]=t[6*o+2*l+0],t[6*o+2*l+0]=g;var d=t[6*a+2*l+1];t[6*a+2*l+1]=t[6*o+2*l+1],t[6*o+2*l+1]=d}a++,o--}}var Oc=32,Jc=function(e,t){return e.candidate-t.candidate},Qc=new Array(Oc).fill().map((function(){return{count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}})),jc=new Float32Array(6);function qc(e,t,n,r,i,o){var s=-1,u=0;if(0===o)-1!==(s=Nc(t))&&(u=(t[s]+t[s+3])/2);else if(1===o)-1!==(s=Nc(e))&&(u=function(e,t,n,r){for(var i=0,a=t,o=t+n;a<o;a++)i+=e[6*a+2*r];return i/n}(n,r,i,s));else if(2===o)for(var l=Dc(e),c=Fc*i,g=6*r,d=6*(r+i),I=0;I<3;I++){var C=t[I],h=(t[I+3]-C)/Oc;if(i<8){var f=(0,a.Z)(Qc);f.length=i;for(var p=0,A=g;A<d;A+=6,p++){var m=f[p];m.candidate=n[A+2*I],m.count=0;for(var v=m.bounds,b=m.leftCacheBounds,y=m.rightCacheBounds,B=0;B<3;B++)y[B]=1/0,y[B+3]=-1/0,b[B]=1/0,b[B+3]=-1/0,v[B]=1/0,v[B+3]=-1/0;Kc(A,n,v)}f.sort(Jc);for(var G=i,Z=0;Z<G;Z++)for(var w=f[Z];Z+1<G&&f[Z+1].candidate===w.candidate;)f.splice(Z+1,1),G--;for(var _=g;_<d;_+=6)for(var x=n[_+2*I],S=0;S<G;S++){var R=f[S];x>=R.candidate?Kc(_,n,R.rightCacheBounds):(Kc(_,n,R.leftCacheBounds),R.count++)}for(var M=0;M<G;M++){var W=f[M],k=W.count,V=i-W.count,F=W.leftCacheBounds,E=W.rightCacheBounds,X=0;0!==k&&(X=Dc(F)/l);var H=0;0!==V&&(H=Dc(E)/l);var L=1+Fc*(X*k+H*V);L<c&&(s=I,c=L,u=W.candidate)}}else{for(var z=0;z<Oc;z++){var N=Qc[z];N.count=0,N.candidate=C+h+z*h;for(var Y=N.bounds,T=0;T<3;T++)Y[T]=1/0,Y[T+3]=-1/0}for(var K=g;K<d;K+=6){var D=~~((n[K+2*I]-C)/h);D>=Oc&&(D=31);var P=Qc[D];P.count++,Kc(K,n,P.bounds)}var U=Qc[31];Yc(U.bounds,U.rightCacheBounds);for(var O=30;O>=0;O--){var J=Qc[O],Q=Qc[O+1];Tc(J.bounds,Q.rightCacheBounds,J.rightCacheBounds)}for(var j=0,q=0;q<31;q++){var $=Qc[q],ee=$.count,te=$.bounds,ne=Qc[q+1].rightCacheBounds;0!==ee&&(0===j?Yc(te,jc):Tc(te,jc,jc));var re=0,ie=0;0!==(j+=ee)&&(re=Dc(jc)/l);var ae=i-j;0!==ae&&(ie=Dc(ne)/l);var oe=1+Fc*(re*j+ie*ae);oe<c&&(s=I,c=oe,u=$.candidate)}}}else console.warn("MeshBVH: Invalid build strategy value ".concat(o," used."));return{axis:s,pos:u}}function $c(e,t){function n(e){I&&I(e/C)}function r(t,i,d){var I=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,C=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!h&&C>=u&&(h=!0,l&&(console.warn("MeshBVH: Max depth of ".concat(u," reached when generating BVH. Consider increasing maxDepth.")),console.warn(e))),d<=c||C>=u)return n(i+d),t.offset=i,t.count=d,t;var f=qc(t.boundingData,I,o,i,d,g);if(-1===f.axis)return n(i+d),t.offset=i,t.count=d,t;var p=Uc(s,o,i,d,f);if(p===i||p===i+d)n(i+d),t.offset=i,t.count=d;else{t.splitAxis=f.axis;var A=new Lc,m=i,v=p-i;t.left=A,A.boundingData=new Float32Array(6),Pc(o,m,v,A.boundingData,a),r(A,m,v,a,C+1);var b=new Lc,y=p,B=d-v;t.right=b,b.boundingData=new Float32Array(6),Pc(o,y,B,b.boundingData,a),r(b,y,B,a,C+1)}return t}!function(e,t){if(!e.index){var n,r=e.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;n=r>65535?new Uint32Array(new i(4*r)):new Uint16Array(new i(2*r)),e.setIndex(new d.BufferAttribute(n,1));for(var a=0;a<r;a++)n[a]=a}}(e,t);var i=new Float32Array(6),a=new Float32Array(6),o=function(e,t){var n=e.attributes.position,r=n.array,i=e.index.array,a=i.length/3,o=new Float32Array(6*a),s=n.offset||0,u=3;n.isInterleavedBufferAttribute&&(u=n.data.stride);for(var l=0;l<a;l++)for(var c=3*l,g=6*l,d=i[c+0]*u+s,I=i[c+1]*u+s,C=i[c+2]*u+s,h=0;h<3;h++){var f=r[d+h],p=r[I+h],A=r[C+h],m=f;p<m&&(m=p),A<m&&(m=A);var v=f;p>v&&(v=p),A>v&&(v=A);var b=(v-m)/2,y=2*h;o[g+y+0]=m+b,o[g+y+1]=b+(Math.abs(m)+b)*Hc,m<t[h]&&(t[h]=m),v>t[h+3]&&(t[h+3]=v)}return o}(e,i),s=e.index.array,u=t.maxDepth,l=t.verbose,c=t.maxLeafTris,g=t.strategy,I=t.onProgress,C=e.index.count/3,h=!1,f=[],p=function(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];var t,n=[],r=new Set,i=(0,Y.Z)(e.groups);try{for(i.s();!(t=i.n()).done;){var a=t.value;r.add(a.start),r.add(a.start+a.count)}}catch(c){i.e(c)}finally{i.f()}for(var o=Array.from(r.values()).sort((function(e,t){return e-t})),s=0;s<o.length-1;s++){var u=o[s],l=o[s+1];n.push({offset:u/3,count:(l-u)/3})}return n}(e);if(1===p.length){var A=p[0],m=new Lc;m.boundingData=i,function(e,t,n,r){for(var i=1/0,a=1/0,o=1/0,s=-1/0,u=-1/0,l=-1/0,c=6*t,g=6*(t+n);c<g;c+=6){var d=e[c+0];d<i&&(i=d),d>s&&(s=d);var I=e[c+2];I<a&&(a=I),I>u&&(u=I);var C=e[c+4];C<o&&(o=C),C>l&&(l=C)}r[0]=i,r[1]=a,r[2]=o,r[3]=s,r[4]=u,r[5]=l}(o,A.offset,A.count,a),r(m,A.offset,A.count,a),f.push(m)}else{var v,b=(0,Y.Z)(p);try{for(b.s();!(v=b.n()).done;){var y=v.value,B=new Lc;B.boundingData=new Float32Array(6),Pc(o,y.offset,y.count,B.boundingData,a),r(B,y.offset,y.count,a),f.push(B)}}catch(G){b.e(G)}finally{b.f()}}return f}function eg(e,t){for(var n,r,i,a=$c(e,t),o=[],s=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,u=0;u<a.length;u++){var l=a[u],c=d(l),g=new s(Ec*c);n=new Float32Array(g),r=new Uint32Array(g),i=new Uint16Array(g),I(0,l),o.push(g)}return o;function d(e){return e.count?1:1+d(e.left)+d(e.right)}function I(e,t){for(var a=e/4,o=e/2,s=!!t.count,u=t.boundingData,l=0;l<6;l++)n[a+l]=u[l];if(s){var c=t.offset,g=t.count;return r[a+6]=c,i[o+14]=g,i[o+15]=Xc,e+Ec}var d,C=t.left,h=t.right,f=t.splitAxis;if((d=I(e+Ec,C))/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return r[a+6]=d/4,d=I(d,h),r[a+7]=f,d}}var tg=function(){function e(){(0,N.Z)(this,e),this.min=1/0,this.max=-1/0}return(0,z.Z)(e,[{key:"setFromPointsField",value:function(e,t){for(var n=1/0,r=-1/0,i=0,a=e.length;i<a;i++){var o=e[i][t];n=o<n?o:n,r=o>r?o:r}this.min=n,this.max=r}},{key:"setFromPoints",value:function(e,t){for(var n=1/0,r=-1/0,i=0,a=t.length;i<a;i++){var o=t[i],s=e.dot(o);n=s<n?s:n,r=s>r?s:r}this.min=n,this.max=r}},{key:"isSeparated",value:function(e){return this.min>e.max||e.min>this.max}}]),e}();tg.prototype.setFromBox=function(){var e=new d.Vector3;return function(t,n){for(var r=n.min,i=n.max,a=1/0,o=-1/0,s=0;s<=1;s++)for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){e.x=r.x*s+i.x*(1-s),e.y=r.y*u+i.y*(1-u),e.z=r.z*l+i.z*(1-l);var c=t.dot(e);a=Math.min(c,a),o=Math.max(c,o)}this.min=a,this.max=o}}();!function(){var e=new tg}();var ng=function(){var e=new d.Vector3,t=new d.Vector3,n=new d.Vector3;return function(r,i,a){var o=r.start,s=e,u=i.start,l=t;n.subVectors(o,u),e.subVectors(r.end,i.start),t.subVectors(i.end,i.start);var c,g,d=n.dot(l),I=l.dot(s),C=l.dot(l),h=n.dot(s),f=s.dot(s)*C-I*I;g=(d+(c=0!==f?(d*I-h*C)/f:0)*I)/C,a.x=c,a.y=g}}(),rg=function(){var e=new d.Vector2,t=new d.Vector3,n=new d.Vector3;return function(r,i,a,o){ng(r,i,e);var s,u,l=e.x,c=e.y;if(l>=0&&l<=1&&c>=0&&c<=1)return r.at(l,a),void i.at(c,o);if(l>=0&&l<=1)return c<0?i.at(0,o):i.at(1,o),void r.closestPointToPoint(o,!0,a);if(c>=0&&c<=1)return l<0?r.at(0,a):r.at(1,a),void i.closestPointToPoint(a,!0,o);s=l<0?r.start:r.end,u=c<0?i.start:i.end;var g=t,d=n;return r.closestPointToPoint(u,!0,t),i.closestPointToPoint(s,!0,n),g.distanceToSquared(u)<=d.distanceToSquared(s)?(a.copy(g),void o.copy(u)):(a.copy(s),void o.copy(d))}}(),ig=function(){var e=new d.Vector3,t=new d.Vector3,n=new d.Plane,r=new d.Line3;return function(i,a){var o=i.radius,s=i.center,u=a.a,l=a.b,c=a.c;if(r.start=u,r.end=l,r.closestPointToPoint(s,!0,e).distanceTo(s)<=o)return!0;if(r.start=u,r.end=c,r.closestPointToPoint(s,!0,e).distanceTo(s)<=o)return!0;if(r.start=l,r.end=c,r.closestPointToPoint(s,!0,e).distanceTo(s)<=o)return!0;var g=a.getPlane(n);if(Math.abs(g.distanceToPoint(s))<=o){var d=g.projectPoint(s,t);if(a.containsPoint(d))return!0}return!1}}(),ag=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;(0,N.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).isExtendedTriangle=!0,e.satAxes=new Array(4).fill().map((function(){return new d.Vector3})),e.satBounds=new Array(4).fill().map((function(){return new tg})),e.points=[e.a,e.b,e.c],e.sphere=new d.Sphere,e.plane=new d.Plane,e.needsUpdate=!1,e}return(0,z.Z)(n,[{key:"intersectsSphere",value:function(e){return ig(e,this)}},{key:"update",value:function(){var e=this.a,t=this.b,n=this.c,r=this.points,i=this.satAxes,a=this.satBounds,o=i[0],s=a[0];this.getNormal(o),s.setFromPoints(o,r);var u=i[1],l=a[1];u.subVectors(e,t),l.setFromPoints(u,r);var c=i[2],g=a[2];c.subVectors(t,n),g.setFromPoints(c,r);var d=i[3],I=a[3];d.subVectors(n,e),I.setFromPoints(d,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,e),this.needsUpdate=!1}}]),n}(d.Triangle);ag.prototype.closestPointToSegment=function(){var e=new d.Vector3,t=new d.Vector3,n=new d.Line3;return function(r){for(var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=r.start,u=r.end,l=this.points,c=1/0,g=0;g<3;g++){var d=(g+1)%3;n.start.copy(l[g]),n.end.copy(l[d]),rg(n,r,e,t),(i=e.distanceToSquared(t))<c&&(c=i,a&&a.copy(e),o&&o.copy(t))}return this.closestPointToPoint(s,e),(i=s.distanceToSquared(e))<c&&(c=i,a&&a.copy(e),o&&o.copy(s)),this.closestPointToPoint(u,e),(i=u.distanceToSquared(e))<c&&(c=i,a&&a.copy(e),o&&o.copy(u)),Math.sqrt(c)}}(),ag.prototype.intersectsTriangle=function(){var e=new ag,t=new Array(3),n=new Array(3),r=new tg,i=new tg,a=new d.Vector3,o=new d.Vector3,s=new d.Vector3,u=new d.Vector3,l=new d.Line3,c=new d.Line3,g=new d.Line3;return function(d){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(e.copy(d),e.update(),d=e);var C=this.plane,h=d.plane;if(Math.abs(C.normal.dot(h.normal))>1-1e-10){var f=this.satBounds,p=this.satAxes;n[0]=d.a,n[1]=d.b,n[2]=d.c;for(var A=0;A<4;A++){var m=f[A],v=p[A];if(r.setFromPoints(v,n),m.isSeparated(r))return!1}var b=d.satBounds,y=d.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(var B=0;B<4;B++){var G=b[B],Z=y[B];if(r.setFromPoints(Z,t),G.isSeparated(r))return!1}for(var w=0;w<4;w++)for(var _=p[w],x=0;x<4;x++){var S=y[x];if(a.crossVectors(_,S),r.setFromPoints(a,t),i.setFromPoints(a,n),r.isSeparated(i))return!1}return I&&(console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),I.start.set(0,0,0),I.end.set(0,0,0)),!0}for(var R=this.points,M=!1,W=0,k=0;k<3;k++){var V=R[k],F=R[(k+1)%3];if(l.start.copy(V),l.end.copy(F),l.delta(o),0===h.normal.dot(o)&&0===h.distanceToPoint(l.start)){c.copy(l),W=2;break}if(h.intersectLine(l,M?c.start:c.end)){if(W++,M)break;M=!0}}if(2!==W)return!1;for(var E=d.points,X=!1,H=0,L=0;L<3;L++){var z=E[L],N=E[(L+1)%3];if(l.start.copy(z),l.end.copy(N),l.delta(s),0===C.normal.dot(s)&&0===C.distanceToPoint(l.start)){g.copy(l),H=2;break}if(C.intersectLine(l,X?g.start:g.end)){if(H++,X)break;X=!0}}if(2!==H)return!1;if(c.delta(o),g.delta(s),o.dot(s)<0){var Y=g.start;g.start=g.end,g.end=Y}var T=c.start.dot(o),K=c.end.dot(o),D=g.start.dot(o),P=g.end.dot(o),U=K<D,O=T<P;return(T===P||D===K||U!==O)&&(I&&(u.subVectors(c.start,g.start),u.dot(o)>0?I.start.copy(c.start):I.start.copy(g.start),u.subVectors(c.end,g.end),u.dot(o)<0?I.end.copy(c.end):I.end.copy(g.end)),!0)}}(),ag.prototype.distanceToPoint=function(){var e=new d.Vector3;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),ag.prototype.distanceToTriangle=function(){var e=new d.Vector3,t=new d.Vector3,n=["a","b","c"],r=new d.Line3,i=new d.Line3;return function(a){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=o||s?r:null;if(this.intersectsTriangle(a,u))return(o||s)&&(o&&u.getCenter(o),s&&u.getCenter(s)),0;for(var l=1/0,c=0;c<3;c++){var g=void 0,d=n[c],I=a[d];this.closestPointToPoint(I,e),(g=I.distanceToSquared(e))<l&&(l=g,o&&o.copy(e),s&&s.copy(I));var C=this[d];a.closestPointToPoint(C,e),(g=C.distanceToSquared(e))<l&&(l=g,o&&o.copy(C),s&&s.copy(e))}for(var h=0;h<3;h++){var f=n[h],p=n[(h+1)%3];r.set(this[f],this[p]);for(var A=0;A<3;A++){var m=n[A],v=n[(A+1)%3];i.set(a[m],a[v]),rg(r,i,e,t);var b=e.distanceToSquared(t);b<l&&(l=b,o&&o.copy(e),s&&s.copy(t))}}return Math.sqrt(l)}}();var og=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;(0,N.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).isOrientedBox=!0,e.matrix=new d.Matrix4,e.invMatrix=new d.Matrix4,e.points=new Array(8).fill().map((function(){return new d.Vector3})),e.satAxes=new Array(3).fill().map((function(){return new d.Vector3})),e.satBounds=new Array(3).fill().map((function(){return new tg})),e.alignedSatBounds=new Array(3).fill().map((function(){return new tg})),e.needsUpdate=!1,e}return(0,z.Z)(n,[{key:"set",value:function(e,t,r){(0,W.Z)((0,k.Z)(n.prototype),"set",this).call(this,e,t),this.matrix.copy(r),this.needsUpdate=!0}},{key:"copy",value:function(e){(0,W.Z)((0,k.Z)(n.prototype),"copy",this).call(this,e),this.matrix.copy(e.matrix),this.needsUpdate=!0}}]),n}(d.Box3);function sg(e,t,n,r){var i=e.a,a=e.b,o=e.c,s=t,u=t+1,l=t+2;n&&(s=n.getX(t),u=n.getX(t+1),l=n.getX(t+2)),i.x=r.getX(s),i.y=r.getY(s),i.z=r.getZ(s),a.x=r.getX(u),a.y=r.getY(u),a.z=r.getZ(u),o.x=r.getX(l),o.y=r.getY(l),o.z=r.getZ(l)}function ug(e,t,n,r,i,a,o){for(var s=n.index,u=n.attributes.position,l=e,c=t+e;l<c;l++)if(sg(o,3*l,s,u),o.needsUpdate=!0,r(o,l,i,a))return!0;return!1}og.prototype.update=function(){for(var e=this.matrix,t=this.min,n=this.max,r=this.points,i=0;i<=1;i++)for(var a=0;a<=1;a++)for(var o=0;o<=1;o++){var s=r[1*i|2*a|4*o];s.x=i?n.x:t.x,s.y=a?n.y:t.y,s.z=o?n.z:t.z,s.applyMatrix4(e)}for(var u=this.satBounds,l=this.satAxes,c=r[0],g=0;g<3;g++){var d=l[g],I=u[g],C=r[1<<g];d.subVectors(c,C),I.setFromPoints(d,r)}var h=this.alignedSatBounds;h[0].setFromPointsField(r,"x"),h[1].setFromPointsField(r,"y"),h[2].setFromPointsField(r,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},og.prototype.intersectsBox=function(){var e=new tg;return function(t){this.needsUpdate&&this.update();var n=t.min,r=t.max,i=this.satBounds,a=this.satAxes,o=this.alignedSatBounds;if(e.min=n.x,e.max=r.x,o[0].isSeparated(e))return!1;if(e.min=n.y,e.max=r.y,o[1].isSeparated(e))return!1;if(e.min=n.z,e.max=r.z,o[2].isSeparated(e))return!1;for(var s=0;s<3;s++){var u=a[s],l=i[s];if(e.setFromBox(u,t),l.isSeparated(e))return!1}return!0}}(),og.prototype.intersectsTriangle=function(){var e=new ag,t=new Array(3),n=new tg,r=new tg,i=new d.Vector3;return function(a){this.needsUpdate&&this.update(),a.isExtendedTriangle?a.needsUpdate&&a.update():(e.copy(a),e.update(),a=e);var o=this.satBounds,s=this.satAxes;t[0]=a.a,t[1]=a.b,t[2]=a.c;for(var u=0;u<3;u++){var l=o[u],c=s[u];if(n.setFromPoints(c,t),l.isSeparated(n))return!1}for(var g=a.satBounds,d=a.satAxes,I=this.points,C=0;C<3;C++){var h=g[C],f=d[C];if(n.setFromPoints(f,I),h.isSeparated(n))return!1}for(var p=0;p<3;p++)for(var A=s[p],m=0;m<4;m++){var v=d[m];if(i.crossVectors(A,v),n.setFromPoints(i,t),r.setFromPoints(i,I),n.isSeparated(r))return!1}return!0}}(),og.prototype.closestPointToPoint=function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},og.prototype.distanceToPoint=function(){var e=new d.Vector3;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),og.prototype.distanceToBox=function(){var e=["x","y","z"],t=new Array(12).fill().map((function(){return new d.Line3})),n=new Array(12).fill().map((function(){return new d.Line3})),r=new d.Vector3,i=new d.Vector3;return function(a){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.needsUpdate&&this.update(),this.intersectsBox(a))return(s||u)&&(a.getCenter(i),this.closestPointToPoint(i,r),a.closestPointToPoint(r,i),s&&s.copy(r),u&&u.copy(i)),0;for(var l=o*o,c=a.min,g=a.max,d=this.points,I=1/0,C=0;C<8;C++){var h=d[C];i.copy(h).clamp(c,g);var f=h.distanceToSquared(i);if(f<I&&(I=f,s&&s.copy(h),u&&u.copy(i),f<l))return Math.sqrt(f)}for(var p=0,A=0;A<3;A++)for(var m=0;m<=1;m++)for(var v=0;v<=1;v++){var b=(A+1)%3,y=(A+2)%3,B=m<<b|v<<y,G=1<<A|m<<b|v<<y,Z=d[B],w=d[G],_=t[p];_.set(Z,w);var x=e[A],S=e[b],R=e[y],M=n[p],W=M.start,k=M.end;W[x]=c[x],W[S]=m?c[S]:g[S],W[R]=v?c[R]:g[S],k[x]=g[x],k[S]=m?c[S]:g[S],k[R]=v?c[R]:g[S],p++}for(var V=0;V<=1;V++)for(var F=0;F<=1;F++)for(var E=0;E<=1;E++){i.x=V?g.x:c.x,i.y=F?g.y:c.y,i.z=E?g.z:c.z,this.closestPointToPoint(i,r);var X=i.distanceToSquared(r);if(X<I&&(I=X,s&&s.copy(r),u&&u.copy(i),X<l))return Math.sqrt(X)}for(var H=0;H<12;H++)for(var L=t[H],z=0;z<12;z++){var N=n[z];rg(L,N,r,i);var Y=r.distanceToSquared(i);if(Y<I&&(I=Y,s&&s.copy(r),u&&u.copy(i),Y<l))return Math.sqrt(Y)}return Math.sqrt(I)}}();var lg=function(){function e(t){(0,N.Z)(this,e),this._getNewPrimitive=t,this._primitives=[]}return(0,z.Z)(e,[{key:"getPrimitive",value:function(){var e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}},{key:"releasePrimitive",value:function(e){this._primitives.push(e)}}]),e}();function cg(e,t){return 65535===t[e+15]}function gg(e,t){return t[e+6]}function dg(e,t){return t[e+14]}function Ig(e){return e+8}function Cg(e,t){return t[e+6]}var hg=new d.Box3,fg=new d.Vector3,pg=["x","y","z"];function Ag(e,t,n,r,i){var a=2*e,o=Gg,s=Zg,u=wg;if(cg(a,s)){!function(e,t,n,r,i,a){for(var o=r,s=r+i;o<s;o++)kc(e,t,n,o,a)}(t,n,r,gg(e,u),dg(a,s),i)}else{var l=Ig(e);yg(l,o,r,fg)&&Ag(l,t,n,r,i);var c=Cg(e,u);yg(c,o,r,fg)&&Ag(c,t,n,r,i)}}function mg(e,t,n,r){var i=2*e,a=Gg,o=Zg,s=wg;if(cg(i,o))return function(e,t,n,r,i){for(var a=1/0,o=null,s=r,u=r+i;s<u;s++){var l=kc(e,t,n,s);l&&l.distance<a&&(o=l,a=l.distance)}return o}(t,n,r,gg(e,s),dg(i,o));var u,l,c=function(e,t){return t[e+7]}(e,s),g=pg[c],d=r.direction[g]>=0;d?(u=Ig(e),l=Cg(e,s)):(u=Cg(e,s),l=Ig(e));var I=yg(u,a,r,fg)?mg(u,t,n,r):null;if(I){var C=I.point[g];if(d?C<=a[l+c]:C>=a[l+c+3])return I}var h=yg(l,a,r,fg)?mg(l,t,n,r):null;return I&&h?I.distance<=h.distance?I:h:I||h||null}var vg=function(){var e,t,n=[],r=new lg((function(){return new d.Box3}));return function(){e=r.getPrimitive(),t=r.getPrimitive(),n.push(e,t);var a=i.apply(void 0,arguments);r.releasePrimitive(e),r.releasePrimitive(t),n.pop(),n.pop();var o=n.length;return o>0&&(t=n[o-1],e=n[o-2]),a};function i(n,r,a,o){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;function c(e){for(var t=2*e,n=Zg,r=wg;!cg(t,n);)t=2*(e=Ig(e));return gg(e,r)}function g(e){for(var t=2*e,n=Zg,r=wg;!cg(t,n);)t=2*(e=Cg(e,r));return gg(e,r)+dg(t,n)}var d=2*n,I=Gg,C=Zg,h=wg,f=cg(d,C);if(f){var p=gg(n,h),A=dg(d,C);return zc(n,I,e),o(p,A,!1,l,u+n,e)}var m,v,b,y,B=Ig(n),G=Cg(n,h),Z=B,w=G;if(s&&(y=t,zc(Z,I,b=e),zc(w,I,y),m=s(b),(v=s(y))<m)){Z=G,w=B;var _=m;m=v,v=_,b=y}b||zc(Z,I,b=e);var x,S=cg(2*Z,C),R=a(b,S,m,l+1,u+Z);if(2===R){var M=c(Z),W=g(Z),k=W-M;x=o(M,k,!0,l+1,u+Z,b)}else x=R&&i(Z,r,a,o,s,u,l+1);if(x)return!0;zc(w,I,y=t);var V,F=cg(2*w,C),E=a(y,F,v,l+1,u+w);if(2===E){var X=c(w),H=g(w),L=H-X;V=o(X,L,!0,l+1,u+w,y)}else V=E&&i(w,r,a,o,s,u,l+1);return!!V}}(),bg=function(){var e=new ag,t=new ag,n=new d.Matrix4,r=new og,i=new og;return function a(o,s,u,l){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,g=2*o,d=Gg,I=Zg,C=wg;null===c&&(u.boundingBox||u.computeBoundingBox(),r.set(u.boundingBox.min,u.boundingBox.max,l),c=r);var h=cg(g,I);if(!h){var f=o+8,p=C[o+6];zc(f,d,hg);var A=c.intersectsBox(hg)&&a(f,s,u,l,c);if(A)return!0;zc(p,d,hg);var m=c.intersectsBox(hg)&&a(p,s,u,l,c);return!!m}var v=s,b=v.index,y=v.attributes.position,B=u.index,G=u.attributes.position,Z=gg(o,C),w=dg(g,I);if(n.copy(l).invert(),u.boundsTree){zc(o,d,i),i.matrix.copy(n),i.needsUpdate=!0;var _=u.boundsTree.shapecast({intersectsBounds:function(e){return i.intersectsBox(e)},intersectsTriangle:function(e){e.a.applyMatrix4(l),e.b.applyMatrix4(l),e.c.applyMatrix4(l),e.needsUpdate=!0;for(var n=3*Z,r=3*(w+Z);n<r;n+=3)if(sg(t,n,b,y),t.needsUpdate=!0,e.intersectsTriangle(t))return!0;return!1}});return _}for(var x=3*Z,S=w+3*Z;x<S;x+=3){sg(e,x,b,y),e.a.applyMatrix4(n),e.b.applyMatrix4(n),e.c.applyMatrix4(n),e.needsUpdate=!0;for(var R=0,M=B.count;R<M;R+=3)if(sg(t,R,B,G),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}}();function yg(e,t,n,r){return zc(e,t,hg),n.intersectBox(hg,r)}var Bg,Gg,Zg,wg,_g=[];function xg(e){Bg&&_g.push(Bg),Bg=e,Gg=new Float32Array(e),Zg=new Uint16Array(e),wg=new Uint32Array(e)}function Sg(){Bg=null,Gg=null,Zg=null,wg=null,_g.length&&xg(_g.pop())}var Rg=Symbol("skip tree generation"),Mg=new d.Box3,Wg=new d.Box3,kg=new d.Matrix4,Vg=new og,Fg=new og,Eg=new d.Vector3,Xg=new d.Vector3,Hg=new d.Vector3,Lg=new d.Vector3,zg=new d.Vector3,Ng=new d.Box3,Yg=new lg((function(){return new ag})),Tg=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,N.Z)(this,e),!t.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if((n=Object.assign((0,yr.Z)({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null},Rg,!1),n)).useSharedArrayBuffer&&"undefined"===typeof SharedArrayBuffer)throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,n[Rg]||(this._roots=eg(t,n),!t.boundingBox&&n.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new d.Box3))),this.geometry=t}return(0,z.Z)(e,[{key:"refit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&Array.isArray(e)&&(e=new Set(e));var t,n,r,i,a=this.geometry,o=a.index.array,s=a.attributes.position,u=s.array,l=s.offset||0,c=3;s.isInterleavedBufferAttribute&&(c=s.data.stride);for(var g=0,d=this._roots,I=0,C=d.length;I<C;I++)t=d[I],n=new Uint32Array(t),r=new Uint16Array(t),i=new Float32Array(t),h(0,g),g+=t.byteLength;function h(t,a){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],g=2*t,d=r[g+15]===Xc;if(d){for(var I=n[t+6],C=r[g+14],f=1/0,p=1/0,A=1/0,m=-1/0,v=-1/0,b=-1/0,y=3*I,B=3*(I+C);y<B;y++){var G=o[y]*c+l,Z=u[G+0],w=u[G+1],_=u[G+2];Z<f&&(f=Z),Z>m&&(m=Z),w<p&&(p=w),w>v&&(v=w),_<A&&(A=_),_>b&&(b=_)}return(i[t+0]!==f||i[t+1]!==p||i[t+2]!==A||i[t+3]!==m||i[t+4]!==v||i[t+5]!==b)&&(i[t+0]=f,i[t+1]=p,i[t+2]=A,i[t+3]=m,i[t+4]=v,i[t+5]=b,!0)}var x=t+8,S=n[t+6],R=x+a,M=S+a,W=s,k=!1,V=!1;e?W||(k=e.has(R),V=e.has(M),W=!k&&!V):(k=!0,V=!0);var F=W||k,E=W||V,X=!1;F&&(X=h(x,a,W));var H=!1;E&&(H=h(S,a,W));var L=X||H;if(L)for(var z=0;z<3;z++){var N=x+z,Y=S+z,T=i[N],K=i[N+3],D=i[Y],P=i[Y+3];i[t+z]=T<D?T:D,i[t+z+3]=K>P?K:P}return L}}},{key:"traverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._roots[t],r=new Uint32Array(n),i=new Uint16Array(n);function a(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=2*t,u=i[s+15]===Xc;if(u){var l=r[t+6],c=i[s+14];e(o,u,new Float32Array(n,4*t,6),l,c)}else{var g=t+8,d=r[t+6],I=r[t+7],C=e(o,u,new Float32Array(n,4*t,6),I);C||(a(g,o+1),a(d,o+1))}}a(0)}},{key:"raycast",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.FrontSide,n=this._roots,r=this.geometry,i=[],a=t.isMaterial,o=Array.isArray(t),s=r.groups,u=a?t.side:t,l=0,c=n.length;l<c;l++){var g=o?t[s[l].materialIndex].side:u,I=i.length;if(xg(n[l]),Ag(0,r,g,e,i),Sg(),o)for(var C=s[l].materialIndex,h=I,f=i.length;h<f;h++)i[h].face.materialIndex=C}return i}},{key:"raycastFirst",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.FrontSide,n=this._roots,r=this.geometry,i=t.isMaterial,a=Array.isArray(t),o=null,s=r.groups,u=i?t.side:t,l=0,c=n.length;l<c;l++){var g=a?t[s[l].materialIndex].side:u;xg(n[l]);var I=mg(0,r,g,e);Sg(),null!=I&&(null==o||I.distance<o.distance)&&(o=I,a&&(I.face.materialIndex=s[l].materialIndex))}return o}},{key:"intersectsGeometry",value:function(e,t){var n,r=this.geometry,i=!1,a=(0,Y.Z)(this._roots);try{for(a.s();!(n=a.n()).done;){if(xg(n.value),i=bg(0,r,e,t),Sg(),i)break}}catch(o){a.e(o)}finally{a.f()}return i}},{key:"shapecast",value:function(e,t,n){var r=this.geometry;if(e instanceof Function){if(t){var i=t;t=function(e,t,n,r){var a=3*t;return i(e,a,a+1,a+2,n,r)}}e={boundsTraverseOrder:n,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}var a=Yg.getPrimitive(),o=e,s=o.boundsTraverseOrder,u=o.intersectsBounds,l=o.intersectsRange,c=o.intersectsTriangle;if(l&&c){var g=l;l=function(e,t,n,i,o){return!!g(e,t,n,i,o)||ug(e,t,r,c,n,i,a)}}else l||(l=c?function(e,t,n,i){return ug(e,t,r,c,n,i,a)}:function(e,t,n){return n});var d,I=!1,C=0,h=(0,Y.Z)(this._roots);try{for(h.s();!(d=h.n()).done;){var f=d.value;if(xg(f),I=vg(0,r,u,l,s,C),Sg(),I)break;C+=f.byteLength}}catch(p){h.e(p)}finally{h.f()}return Yg.releasePrimitive(a),I}},{key:"bvhcast",value:function(e,t,n){var r=n.intersectsRanges,i=n.intersectsTriangles,a=this.geometry.index,o=this.geometry.attributes.position,s=e.geometry.index,u=e.geometry.attributes.position;kg.copy(t).invert();var l=Yg.getPrimitive(),c=Yg.getPrimitive();if(i){var g=function(e,n,r,g,d,I,C,h){for(var f=r,p=r+g;f<p;f++){sg(c,3*f,s,u),c.a.applyMatrix4(t),c.b.applyMatrix4(t),c.c.applyMatrix4(t),c.needsUpdate=!0;for(var A=e,m=e+n;A<m;A++)if(sg(l,3*A,a,o),l.needsUpdate=!0,i(l,c,A,f,d,I,C,h))return!0}return!1};if(r){var d=r;r=function(e,t,n,r,i,a,o,s){return!!d(e,t,n,r,i,a,o,s)||g(e,t,n,r,i,a,o,s)}}else r=g}this.getBoundingBox(Wg),Wg.applyMatrix4(t);var I=this.shapecast({intersectsBounds:function(e){return Wg.intersectsBox(e)},intersectsRange:function(t,n,i,a,o,s){return Mg.copy(s),Mg.applyMatrix4(kg),e.shapecast({intersectsBounds:function(e){return Mg.intersectsBox(e)},intersectsRange:function(e,i,s,u,l){return r(t,n,e,i,a,o,u,l)}})}});return Yg.releasePrimitive(l),Yg.releasePrimitive(c),I}},{key:"intersectsBox",value:function(e,t){return Vg.set(e.min,e.max,t),Vg.needsUpdate=!0,this.shapecast({intersectsBounds:function(e){return Vg.intersectsBox(e)},intersectsTriangle:function(e){return Vg.intersectsTriangle(e)}})}},{key:"intersectsSphere",value:function(e){return this.shapecast({intersectsBounds:function(t){return e.intersectsBox(t)},intersectsTriangle:function(t){return t.intersectsSphere(e)}})}},{key:"closestPointToGeometry",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0;e.boundingBox||e.computeBoundingBox(),Vg.set(e.boundingBox.min,e.boundingBox.max,t),Vg.needsUpdate=!0;var o=this.geometry,s=o.attributes.position,u=o.index,l=e.attributes.position,c=e.index,g=Yg.getPrimitive(),d=Yg.getPrimitive(),I=Xg,C=Hg,h=null,f=null;r&&(h=Lg,f=zg);var p=1/0,A=null,m=null;return kg.copy(t).invert(),Fg.matrix.copy(kg),this.shapecast({boundsTraverseOrder:function(e){return Vg.distanceToBox(e)},intersectsBounds:function(e,t,n){return n<p&&n<a&&(t&&(Fg.min.copy(e.min),Fg.max.copy(e.max),Fg.needsUpdate=!0),!0)},intersectsRange:function(n,r){if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:function(e){return Fg.distanceToBox(e)},intersectsBounds:function(e,t,n){return n<p&&n<a},intersectsRange:function(e,a){for(var o=3*e,v=3*(e+a);o<v;o+=3){sg(d,o,c,l),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(var b=3*n,y=3*(n+r);b<y;b+=3){sg(g,b,u,s),g.needsUpdate=!0;var B=g.distanceToTriangle(d,I,h);if(B<p&&(C.copy(I),f&&f.copy(h),p=B,A=b/3,m=o/3),B<i)return!0}}}});for(var o=0,v=c?c.count:l.count;o<v;o+=3){sg(d,o,c,l),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(var b=3*n,y=3*(n+r);b<y;b+=3){sg(g,b,u,s),g.needsUpdate=!0;var B=g.distanceToTriangle(d,I,h);if(B<p&&(C.copy(I),f&&f.copy(h),p=B,A=b/3,m=o/3),B<i)return!0}}}}),Yg.releasePrimitive(g),Yg.releasePrimitive(d),p===1/0?null:(n.point?n.point.copy(C):n.point=C.clone(),n.distance=p,n.faceIndex=A,r&&(r.point?r.point.copy(f):r.point=f.clone(),r.point.applyMatrix4(kg),C.applyMatrix4(kg),r.distance=C.sub(r.point).length(),r.faceIndex=m),n)}},{key:"closestPointToPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=n*n,a=r*r,o=1/0,s=null;if(this.shapecast({boundsTraverseOrder:function(t){return Eg.copy(e).clamp(t.min,t.max),Eg.distanceToSquared(e)},intersectsBounds:function(e,t,n){return n<o&&n<a},intersectsTriangle:function(t,n){t.closestPointToPoint(e,Eg);var r=e.distanceToSquared(Eg);return r<o&&(Xg.copy(Eg),o=r,s=n),r<i}}),o===1/0)return null;var u=Math.sqrt(o);return t.point?t.point.copy(Xg):t.point=Xg.clone(),t.distance=u,t.faceIndex=s,t}},{key:"getBoundingBox",value:function(e){return e.makeEmpty(),this._roots.forEach((function(t){zc(0,new Float32Array(t),Ng),e.union(Ng)})),e}}],[{key:"serialize",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),e.serialize(arguments[0],{cloneBuffers:void 0===arguments[2]||arguments[2]});n=(0,c.Z)({cloneBuffers:!0},n);var r=t.geometry,i=t._roots,a=r.getIndex();return n.cloneBuffers?{roots:i.map((function(e){return e.slice()})),index:a.array.slice()}:{roots:i,index:a.array}}},{key:"deserialize",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("boolean"===typeof r)return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),e.deserialize(arguments[0],arguments[1],{setIndex:void 0===arguments[2]||arguments[2]});r=(0,c.Z)({setIndex:!0},r);var i=t.index,a=t.roots,o=new e(n,(0,c.Z)((0,c.Z)({},r),{},(0,yr.Z)({},Rg,!0)));if(o._roots=a,r.setIndex){var s=n.getIndex();if(null===s){var u=new d.BufferAttribute(t.index,1,!1);n.setIndex(u)}else s.array!==i&&(s.array.set(i),s.needsUpdate=!0)}return o}}]),e}(),Kg=Tg.prototype.raycast;Tg.prototype.raycast=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycast" has changed. See docs for new signature.');var r=t[0],i=t[1],a=t[2],o=t[3],s=Kg.call(this,a,r.material);return s.forEach((function(e){(e=Vc(e,r,i))&&o.push(e)})),o}return Kg.apply(this,t)};var Dg=Tg.prototype.raycastFirst;Tg.prototype.raycastFirst=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycastFirst" has changed. See docs for new signature.');var r=t[0],i=t[1],a=t[2];return Vc(Dg.call(this,a,r.material),r,i)}return Dg.apply(this,t)};var Pg=Tg.prototype.closestPointToPoint;Tg.prototype.closestPointToPoint=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "closestPointToPoint" has changed. See docs for new signature.'),t.unshift();var r=t[1],i={};return t[1]=i,Pg.apply(this,t),r&&r.copy(i.point),i.distance}return Pg.apply(this,t)};var Ug=Tg.prototype.closestPointToGeometry;Tg.prototype.closestPointToGeometry=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[2],i=t[3];if(r&&r.isVector3||i&&i.isVector3){console.warn('MeshBVH: The function signature and results frame for "closestPointToGeometry" has changed. See docs for new signature.');var a={},o={},s=t[1];return t[2]=a,t[3]=o,Ug.apply(this,t),r&&r.copy(a.point),i&&i.copy(o.point).applyMatrix4(s),a.distance}return Ug.apply(this,t)};var Og=Tg.prototype.refit;Tg.prototype.refit=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],i=t[1];if(i&&(i instanceof Set||Array.isArray(i))){console.warn('MeshBVH: The function signature for "refit" has changed. See docs for new signature.');var a=new Set;i.forEach((function(e){return a.add(e)})),r&&r.forEach((function(e){return a.add(e)})),Og.call(this,a)}else Og.apply(this,t)},["intersectsGeometry","shapecast","intersectsBox","intersectsSphere"].forEach((function(e){var t=Tg.prototype[e];Tg.prototype[e]=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(null===r[0]||r[0].isMesh)&&(r.shift(),console.warn('MeshBVH: The function signature for "'.concat(e,'" has changed and no longer takes Mesh. See docs for new signature.'))),t.apply(this,r)}}));var Jg=new d.Ray,Qg=new d.Matrix4,jg=d.Mesh.prototype.raycast;function qg(e,t){if(this.geometry.boundsTree){if(void 0===this.material)return;Qg.copy(this.matrixWorld).invert(),Jg.copy(e.ray).applyMatrix4(Qg);var n=this.geometry.boundsTree;if(!0===e.firstHitOnly){var r=Vc(n.raycastFirst(Jg,this.material),this,e);r&&t.push(r)}else for(var i=n.raycast(Jg,this.material),a=0,o=i.length;a<o;a++){var s=Vc(i[a],this,e);s&&t.push(s)}}else jg.call(this,e,t)}function $g(e){return this.boundsTree=new Tg(this,e),this.boundsTree}function ed(){this.boundsTree=null}function td(e,t){o.useEffect((function(){if(e.current){e.current.raycast=qg;var n=e.current.geometry;return n.computeBoundsTree=$g,n.disposeBoundsTree=ed,n.computeBoundsTree(t),function(){n.boundsTree&&n.disposeBoundsTree()}}}),[e,t])}function nd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=o.useRef([]);return r.current=t.map((function(e){return o.useContext(e)})),o.useMemo((function(){return function(e){var n=e.children;return t.reduceRight((function(e,t,n){return o.createElement(t.Provider,{value:r.current[n],children:e})}),n)}}),[])}function rd(e,t){var n=o.useRef(),r=o.useState((function(){return t?t instanceof d.Object3D?{current:t}:t:n})),i=(0,g.Z)(r,1)[0],a=o.useState((function(){return new d.AnimationMixer(void 0)})),u=(0,g.Z)(a,1)[0],l=o.useRef({}),c=o.useState((function(){var t={};return e.forEach((function(e){return Object.defineProperty(t,e.name,{enumerable:!0,get:function(){if(i.current)return l.current[e.name]||(l.current[e.name]=u.clipAction(e,i.current))}})})),{ref:i,clips:e,actions:t,names:e.map((function(e){return e.name})),mixer:u}})),I=(0,g.Z)(c,1)[0];return(0,s.useFrame)((function(e,t){return u.update(t)})),o.useEffect((function(){var e=i.current;return function(){l.current={},Object.values(I.actions).forEach((function(t){e&&u.uncacheAction(t,e)}))}}),[e]),I}function id(e){var t=o.useRef(null),n=o.useRef(!1),r=o.useRef(!1);return o.useEffect((function(){var i=t.current;if(i){var a=(0,s.addEffect)((function(){return n.current=!1,!0})),o=i.onBeforeRender;i.onBeforeRender=function(){return n.current=!0};var u=(0,s.addAfterEffect)((function(){return n.current!==r.current&&e(r.current=n.current),!0}));return function(){i.onBeforeRender=o,a(),u()}}}),[]),t}var ad=function(e,t){return e[t]},od=function(e,t){var n=null!==e[0].index,r=new Set(Object.keys(e[0].attributes)),i=new Set(Object.keys(e[0].morphAttributes)),a={},o={},s=e[0].morphTargetsRelative,u=new d.BufferGeometry,l=0;if(e.forEach((function(e,c){var g=0;if(n!==(null!==e.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(var d in e.attributes){if(!r.has(d))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+'. All geometries must have compatible attributes; make sure "'+d+'" attribute exists among all geometries, or in none of them.'),null;void 0===a[d]&&(a[d]=[]),a[d].push(e.attributes[d]),g++}if(g!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". Make sure all geometries have the same number of attributes."),null;if(s!==e.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(var I in e.morphAttributes){if(!i.has(I))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[I]&&(o[I]=[]),o[I].push(e.morphAttributes[I])}if(u.userData.mergedUserData=u.userData.mergedUserData||[],u.userData.mergedUserData.push(e.userData),t){var C;if(e.index)C=e.index.count;else{if(void 0===e.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". The geometry must have either an index or a position attribute"),null;C=e.attributes.position.count}u.addGroup(l,C,c),l+=C}})),n){var c=0,g=[];e.forEach((function(e){for(var t=e.index,n=0;n<t.count;++n)g.push(t.getX(n)+c);c+=e.attributes.position.count})),u.setIndex(g)}for(var I in a){var C=sd(a[I]);if(!C)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+I+" attribute."),null;u.setAttribute(I,C)}for(var h in o){var f=o[h][0].length;if(0===f)break;u.morphAttributes=u.morphAttributes||{},u.morphAttributes[h]=[];for(var p=0;p<f;++p){for(var A=[],m=0;m<o[h].length;++m)A.push(o[h][m][p]);var v=sd(A);if(!v)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" morphAttribute."),null;u.morphAttributes[h].push(v)}}return u},sd=function(e){var t=void 0,n=void 0,r=void 0,i=0;if(e.forEach((function(e){return void 0===t&&(t=e.array.constructor),t!==e.array.constructor?(console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null):(void 0===n&&(n=e.itemSize),n!==e.itemSize?(console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null):(void 0===r&&(r=e.normalized),r!==e.normalized?(console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null):void(i+=e.array.length)))})),t&&n){var a=new t(i),o=0;return e.forEach((function(e){a.set(e.array,o),o+=e.array.length})),new d.BufferAttribute(a,n,r)}},ud=function(e){for(var t=void 0,n=0,r=0,i=0,a=e.length;i<a;++i){var o=e[i];if(void 0===t&&(t=o.array.constructor),t!==o.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;n+=o.array.length,r+=o.itemSize}for(var s=new d.InterleavedBuffer(new t(n),r),u=0,l=[],c=["getX","getY","getZ","getW"],g=["setX","setY","setZ","setW"],I=0,C=e.length;I<C;I++){var h=e[I],f=h.itemSize,p=h.count,A=new d.InterleavedBufferAttribute(s,f,u,h.normalized);l.push(A),u+=f;for(var m=0;m<p;m++)for(var v=0;v<f;v++){ad(A,g[v])(m,ad(h,c[v])(m))}}return l};function ld(e){var t=0;for(var n in e.attributes){var r=e.getAttribute(n);t+=r.count*r.itemSize*r.array.BYTES_PER_ELEMENT}var i=e.getIndex();return t+=i?i.count*i.itemSize*i.array.BYTES_PER_ELEMENT:0}function cd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-4;t=Math.max(t,Number.EPSILON);for(var n={},r=e.getIndex(),i=e.getAttribute("position"),a=r?r.count:i.count,o=0,s=Object.keys(e.attributes),u={},l={},c=[],g=["getX","getY","getZ","getW"],I=0,C=s.length;I<C;I++){var h=s[I];u[h]=[];var f=e.morphAttributes[h];f&&(l[h]=new Array(f.length).fill(0).map((function(){return[]})))}for(var p=Math.log10(1/t),A=Math.pow(10,p),m=0;m<a;m++){for(var v=r?r.getX(m):m,b="",y=0,B=s.length;y<B;y++)for(var G=s[y],Z=e.getAttribute(G),w=Z.itemSize,_=0;_<w;_++)b+="".concat(~~(Z[g[_]](v)*A),",");if(b in n)c.push(n[b]);else{for(var x=0,S=s.length;x<S;x++)for(var R=s[x],M=e.getAttribute(R),W=e.morphAttributes[R],k=M.itemSize,V=u[R],F=l[R],E=0;E<k;E++){var X=g[E];if(V.push(M[X](v)),W)for(var H=0,L=W.length;H<L;H++)F[H].push(W[H][X](v))}n[b]=o,c.push(o),o++}}for(var z=e.clone(),N=0,Y=s.length;N<Y;N++){var T=s[N],K=e.getAttribute(T),D=new K.array.constructor(u[T]),P=new d.BufferAttribute(D,K.itemSize,K.normalized);if(z.setAttribute(T,P),T in l)for(var U=0;U<l[T].length;U++){var O=e.morphAttributes[T][U],J=new O.array.constructor(l[T][U]),Q=new d.BufferAttribute(J,O.itemSize,O.normalized);z.morphAttributes[T][U]=Q}}return z.setIndex(c),z}function gd(e,t){if(t===d.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===d.TriangleFanDrawMode||t===d.TriangleStripDrawMode){var n=e.getIndex();if(null===n){var r=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var a=0;a<i.count;a++)r.push(a);e.setIndex(r),n=e.getIndex()}var o=n.count-2,s=[];if(n)if(t===d.TriangleFanDrawMode)for(var u=1;u<=o;u++)s.push(n.getX(0)),s.push(n.getX(u)),s.push(n.getX(u+1));else for(var l=0;l<o;l++)l%2===0?(s.push(n.getX(l)),s.push(n.getX(l+1)),s.push(n.getX(l+2))):(s.push(n.getX(l+2)),s.push(n.getX(l+1)),s.push(n.getX(l)));s.length/3!==o&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var c=e.clone();return c.setIndex(s),c.clearGroups(),c}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}function dd(e){if(!0!==e.geometry.isBufferGeometry)return console.error("THREE.BufferGeometryUtils: Geometry is not of type BufferGeometry."),null;var t=new d.Vector3,n=new d.Vector3,r=new d.Vector3,i=new d.Vector3,a=new d.Vector3,o=new d.Vector3,s=new d.Vector3,u=new d.Vector3,l=new d.Vector3;function c(e,c,g,d,I,C,h,f,p){t.fromBufferAttribute(g,C),n.fromBufferAttribute(g,h),r.fromBufferAttribute(g,f);var A=e.morphTargetInfluences;if(c.morphTargets&&d&&A){s.set(0,0,0),u.set(0,0,0),l.set(0,0,0);for(var m=0,v=d.length;m<v;m++){var b=A[m],y=d[m];0!==b&&(i.fromBufferAttribute(y,C),a.fromBufferAttribute(y,h),o.fromBufferAttribute(y,f),I?(s.addScaledVector(i,b),u.addScaledVector(a,b),l.addScaledVector(o,b)):(s.addScaledVector(i.sub(t),b),u.addScaledVector(a.sub(n),b),l.addScaledVector(o.sub(r),b)))}t.add(s),n.add(u),r.add(l)}e.isSkinnedMesh&&(e.boneTransform(C,t),e.boneTransform(h,n),e.boneTransform(f,r)),p[3*C+0]=t.x,p[3*C+1]=t.y,p[3*C+2]=t.z,p[3*h+0]=n.x,p[3*h+1]=n.y,p[3*h+2]=n.z,p[3*f+0]=r.x,p[3*f+1]=r.y,p[3*f+2]=r.z}var g,I,C,h,f,p,A,m,v,b=e.geometry,y=e.material,B=b.index,G=b.attributes.position,Z=b.morphAttributes.position,w=b.morphTargetsRelative,_=b.attributes.normal,x=b.morphAttributes.position,S=b.groups,R=b.drawRange,M=new Float32Array(G.count*G.itemSize),W=new Float32Array(_.count*_.itemSize);if(null!==B)if(Array.isArray(y))for(h=0,p=S.length;h<p;h++)for(v=y[(m=S[h]).materialIndex],f=Math.max(m.start,R.start),A=Math.min(m.start+m.count,R.start+R.count);f<A;f+=3)c(e,v,G,Z,w,g=B.getX(f),I=B.getX(f+1),C=B.getX(f+2),M),c(e,v,_,x,w,g,I,C,W);else for(h=Math.max(0,R.start),p=Math.min(B.count,R.start+R.count);h<p;h+=3)c(e,y,G,Z,w,g=B.getX(h),I=B.getX(h+1),C=B.getX(h+2),M),c(e,y,_,x,w,g,I,C,W);else if(void 0!==G)if(Array.isArray(y))for(h=0,p=S.length;h<p;h++)for(v=y[(m=S[h]).materialIndex],f=Math.max(m.start,R.start),A=Math.min(m.start+m.count,R.start+R.count);f<A;f+=3)c(e,v,G,Z,w,g=f,I=f+1,C=f+2,M),c(e,v,_,x,w,g,I,C,W);else for(h=Math.max(0,R.start),p=Math.min(G.count,R.start+R.count);h<p;h+=3)c(e,y,G,Z,w,g=h,I=h+1,C=h+2,M),c(e,y,_,x,w,g,I,C,W);return{positionAttribute:G,normalAttribute:_,morphedPositionAttribute:new d.Float32BufferAttribute(M,3),morphedNormalAttribute:new d.Float32BufferAttribute(W,3)}}var Id=new d.Vector3,Cd=new d.Vector3;function hd(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var fd=function(){function e(t,n){(0,N.Z)(this,e),(0,yr.Z)(this,"position",void 0),(0,yr.Z)(this,"id",void 0),(0,yr.Z)(this,"faces",void 0),(0,yr.Z)(this,"neighbors",void 0),(0,yr.Z)(this,"collapseCost",void 0),(0,yr.Z)(this,"collapseNeighbor",void 0),(0,yr.Z)(this,"minCost",0),(0,yr.Z)(this,"totalCost",0),(0,yr.Z)(this,"costCount",0),this.position=t,this.id=n,this.faces=[],this.neighbors=[],this.collapseCost=0,this.collapseNeighbor=null}return(0,z.Z)(e,[{key:"addUniqueNeighbor",value:function(e){var t,n;t=this.neighbors,n=e,-1===t.indexOf(n)&&t.push(n)}},{key:"removeIfNonNeighbor",value:function(e){var t=this.neighbors,n=this.faces,r=t.indexOf(e);if(-1!==r){for(var i=0;i<n.length;i++)if(n[i].hasVertex(e))return;t.splice(r,1)}}}]),e}(),pd=function(){function e(t,n,r,i,a,o){(0,N.Z)(this,e),(0,yr.Z)(this,"a",void 0),(0,yr.Z)(this,"b",void 0),(0,yr.Z)(this,"c",void 0),(0,yr.Z)(this,"v1",void 0),(0,yr.Z)(this,"v2",void 0),(0,yr.Z)(this,"v3",void 0),(0,yr.Z)(this,"normal",new d.Vector3),this.a=i,this.b=a,this.c=o,this.v1=t,this.v2=n,this.v3=r,this.computeNormal(),t.faces.push(this),t.addUniqueNeighbor(n),t.addUniqueNeighbor(r),n.faces.push(this),n.addUniqueNeighbor(t),n.addUniqueNeighbor(r),r.faces.push(this),r.addUniqueNeighbor(t),r.addUniqueNeighbor(n)}return(0,z.Z)(e,[{key:"computeNormal",value:function(){var e=this.v1.position,t=this.v2.position,n=this.v3.position;Id.subVectors(n,t),Cd.subVectors(e,t),Id.cross(Cd).normalize(),this.normal.copy(Id)}},{key:"hasVertex",value:function(e){return e===this.v1||e===this.v2||e===this.v3}},{key:"replaceVertex",value:function(e,t){e===this.v1?this.v1=t:e===this.v2?this.v2=t:e===this.v3&&(this.v3=t),hd(e.faces,this),t.faces.push(this),e.removeIfNonNeighbor(this.v1),this.v1.removeIfNonNeighbor(e),e.removeIfNonNeighbor(this.v2),this.v2.removeIfNonNeighbor(e),e.removeIfNonNeighbor(this.v3),this.v3.removeIfNonNeighbor(e),this.v1.addUniqueNeighbor(this.v2),this.v1.addUniqueNeighbor(this.v3),this.v2.addUniqueNeighbor(this.v1),this.v2.addUniqueNeighbor(this.v3),this.v3.addUniqueNeighbor(this.v1),this.v3.addUniqueNeighbor(this.v2),this.computeNormal()}}]),e}(),Ad=function(){function e(){var t=this;(0,N.Z)(this,e),(0,yr.Z)(this,"computeEdgeCollapseCost",(function(e,t){var n,r,i,a=t.position.distanceTo(e.position),o=0,s=[],u=e.faces.length;for(n=0;n<u;n++)(r=e.faces[n]).hasVertex(t)&&s.push(r);for(n=0;n<u;n++){var l=1;r=e.faces[n];for(var c=0;c<s.length;c++){i=s[c];var g=r.normal.dot(i.normal);l=Math.min(l,(1.001-g)/2)}o=Math.max(o,l)}return s.length<2&&(o=1),a*o+0})),(0,yr.Z)(this,"computeEdgeCostAtVertex",(function(e){if(0===e.neighbors.length)return e.collapseNeighbor=null,void(e.collapseCost=-.01);e.collapseCost=1e5,e.collapseNeighbor=null;for(var n=0;n<e.neighbors.length;n++){var r=t.computeEdgeCollapseCost(e,e.neighbors[n]);e.collapseNeighbor||(e.collapseNeighbor=e.neighbors[n],e.collapseCost=r,e.minCost=r,e.totalCost=0,e.costCount=0),e.costCount++,e.totalCost+=r,r<e.minCost&&(e.collapseNeighbor=e.neighbors[n],e.minCost=r)}e.collapseCost=e.totalCost/e.costCount})),(0,yr.Z)(this,"removeFace",(function(e,t){hd(t,e),e.v1&&hd(e.v1.faces,e),e.v2&&hd(e.v2.faces,e),e.v3&&hd(e.v3.faces,e);for(var n,r,i=[e.v1,e.v2,e.v3],a=0;a<3;a++)r=i[(a+1)%3],(n=i[a])&&r&&(n.removeIfNonNeighbor(r),r.removeIfNonNeighbor(n))})),(0,yr.Z)(this,"collapse",(function(e,n,r,i){if(i){var a,o=[];for(a=0;a<r.neighbors.length;a++)o.push(r.neighbors[a]);for(a=r.faces.length-1;a>=0;a--)r.faces[a].hasVertex(i)&&t.removeFace(r.faces[a],n);for(a=r.faces.length-1;a>=0;a--)r.faces[a].replaceVertex(r,i);for(t.removeVertex(r,e),a=0;a<o.length;a++)t.computeEdgeCostAtVertex(o[a])}else t.removeVertex(r,e)})),(0,yr.Z)(this,"minimumCostEdge",(function(e){for(var t=e[0],n=0;n<e.length;n++)e[n].collapseCost<t.collapseCost&&(t=e[n]);return t})),(0,yr.Z)(this,"modify",(function(e,n){var r=(e=e.clone()).attributes;for(var i in r)"position"!==i&&e.deleteAttribute(i);for(var a=[],o=[],s=(e=cd(e)).getAttribute("position"),u=0;u<s.count;u++){var l=(new d.Vector3).fromBufferAttribute(s,u),c=new fd(l,u);a.push(c)}var g,I=e.getIndex();if(null!==I)for(var C=0;C<I.count;C+=3){var h=I.getX(C),f=I.getX(C+1),p=I.getX(C+2),A=new pd(a[h],a[f],a[p],h,f,p);o.push(A)}else for(var m=0;m<s.count;m+=3){var v=m,b=m+1,y=m+2,B=new pd(a[v],a[b],a[y],v,b,y);o.push(B)}for(var G=0,Z=a.length;G<Z;G++)t.computeEdgeCostAtVertex(a[G]);for(var w=n;w--;){if(!(g=t.minimumCostEdge(a))){console.log("THREE.SimplifyModifier: No next vertex");break}t.collapse(a,o,g,g.collapseNeighbor)}for(var _=new d.BufferGeometry,x=[],S=[],R=0;R<a.length;R++){var M=a[R].position;x.push(M.x,M.y,M.z)}for(var W=0;W<o.length;W++){var k=o[W],V=a.indexOf(k.v1),F=a.indexOf(k.v2),E=a.indexOf(k.v3);S.push(V,F,E)}return _.setAttribute("position",new d.Float32BufferAttribute(x,3)),_.setIndex(S),_}))}return(0,z.Z)(e,[{key:"removeVertex",value:function(e,t){for(console.assert(0===e.faces.length);e.neighbors.length;){hd(e.neighbors.pop().neighbors,e)}hd(t,e)}}]),e}();function md(e){var t=o.useRef(),n=o.useRef(),r=o.useRef();return o.useEffect((function(){n.current||(n.current=t.current.geometry.clone(),r.current=new Ad)}),[]),o.useEffect((function(){if(n.current&&t.current){var i=n.current,a=Math.floor(i.attributes.position.count*e);t.current.geometry=r.current.modify(i,a)}}),[e]),t}var vd=(0,z.Z)((function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;(0,N.Z)(this,e),(0,yr.Z)(this,"maxEdgeLength",void 0),(0,yr.Z)(this,"maxIterations",void 0),(0,yr.Z)(this,"modify",(function(e){null!==e.index&&(e=e.toNonIndexed());var n=t.maxIterations,r=t.maxEdgeLength*t.maxEdgeLength,i=new d.Vector3,a=new d.Vector3,o=new d.Vector3,s=new d.Vector3,u=[i,a,o,s],l=new d.Vector3,c=new d.Vector3,g=new d.Vector3,I=new d.Vector3,C=[l,c,g,I],h=new d.Color,f=new d.Color,p=new d.Color,A=new d.Color,m=[h,f,p,A],v=new d.Vector2,b=new d.Vector2,y=new d.Vector2,B=new d.Vector2,G=[v,b,y,B],Z=new d.Vector2,w=new d.Vector2,_=new d.Vector2,x=new d.Vector2,S=[Z,w,_,x],R=e.attributes,M=void 0!==R.normal,W=void 0!==R.color,k=void 0!==R.uv,V=void 0!==R.uv2,F=R.position.array,E=M?R.normal.array:null,X=W?R.color.array:null,H=k?R.uv.array:null,L=V?R.uv2.array:null,z=F,N=E,Y=X,T=H,K=L,D=0,P=!0;function U(e,t,n){var r=u[e],i=u[t],a=u[n];if(z.push(r.x,r.y,r.z),z.push(i.x,i.y,i.z),z.push(a.x,a.y,a.z),M){var o=C[e],s=C[t],l=C[n];N.push(o.x,o.y,o.z),N.push(s.x,s.y,s.z),N.push(l.x,l.y,l.z)}if(W){var c=m[e],g=m[t],d=m[n];Y.push(c.r,c.g,c.b),Y.push(g.r,g.g,g.b),Y.push(d.r,d.g,d.b)}if(k){var I=G[e],h=G[t],f=G[n];T.push(I.x,I.y),T.push(h.x,h.y),T.push(f.x,f.y)}if(V){var p=S[e],A=S[t],v=S[n];K.push(p.x,p.y),K.push(A.x,A.y),K.push(v.x,v.y)}}for(;P&&D<n;){D++,P=!1,F=z,z=[],M&&(E=N,N=[]),W&&(X=Y,Y=[]),k&&(H=T,T=[]),V&&(L=K,K=[]);for(var O=0,J=0,Q=F.length;O<Q;O+=9,J+=6){i.fromArray(F,O+0),a.fromArray(F,O+3),o.fromArray(F,O+6),M&&E&&(l.fromArray(E,O+0),c.fromArray(E,O+3),g.fromArray(E,O+6)),W&&X&&(h.fromArray(X,O+0),f.fromArray(X,O+3),p.fromArray(X,O+6)),k&&H&&(v.fromArray(H,J+0),b.fromArray(H,J+2),y.fromArray(H,J+4)),V&&L&&(Z.fromArray(L,J+0),w.fromArray(L,J+2),_.fromArray(L,J+4));var j=i.distanceToSquared(a),q=a.distanceToSquared(o),$=i.distanceToSquared(o);j>r||q>r||$>r?(P=!0,j>=q&&j>=$?(s.lerpVectors(i,a,.5),M&&I.lerpVectors(l,c,.5),W&&A.lerpColors(h,f,.5),k&&B.lerpVectors(v,b,.5),V&&x.lerpVectors(Z,w,.5),U(0,3,2),U(3,1,2)):q>=j&&q>=$?(s.lerpVectors(a,o,.5),M&&I.lerpVectors(c,g,.5),W&&A.lerpColors(f,p,.5),k&&B.lerpVectors(b,y,.5),V&&x.lerpVectors(w,_,.5),U(0,1,3),U(3,2,0)):(s.lerpVectors(i,o,.5),M&&I.lerpVectors(l,g,.5),W&&A.lerpColors(h,p,.5),k&&B.lerpVectors(v,y,.5),V&&x.lerpVectors(Z,_,.5),U(0,1,3),U(3,1,2))):U(0,1,2)}}var ee=new d.BufferGeometry;return ee.setAttribute("position",new d.Float32BufferAttribute(z,3)),M&&ee.setAttribute("normal",new d.Float32BufferAttribute(N,3)),W&&ee.setAttribute("color",new d.Float32BufferAttribute(Y,3)),k&&ee.setAttribute("uv",new d.Float32BufferAttribute(T,2)),V&&ee.setAttribute("uv2",new d.Float32BufferAttribute(K,2)),ee})),this.maxEdgeLength=n,this.maxIterations=r}));function bd(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1?arguments[1]:void 0,n=o.useRef(),r=o.useRef(),i=o.useRef();return o.useEffect((function(){r.current||(r.current=n.current.geometry.clone(),i.current=new vd(parseInt(t),e))}),[t,e]),o.useEffect((function(){i.current.maxEdgeLength=t}),[t]),o.useEffect((function(){if(r.current&&n.current){var e=i.current.modify(r.current);n.current.geometry=e}}),[t,e]),n}var yd=(0,z.Z)((function e(){var t=this;(0,N.Z)(this,e),(0,yr.Z)(this,"A",new d.Vector3),(0,yr.Z)(this,"B",new d.Vector3),(0,yr.Z)(this,"C",new d.Vector3),(0,yr.Z)(this,"positions",[]),(0,yr.Z)(this,"normals",new Float32Array),(0,yr.Z)(this,"indexes",[]),(0,yr.Z)(this,"pointToIndexMap",[]),(0,yr.Z)(this,"splitIndexes",[]),(0,yr.Z)(this,"oldNormals",[]),(0,yr.Z)(this,"computeNormals",(function(){t.normals=new Float32Array(3*t.indexes.length);for(var e=0;e<t.indexes.length;e+=3){var n=t.indexes[e];t.A.set(t.positions[3*n],t.positions[3*n+1],t.positions[3*n+2]),n=t.indexes[e+1],t.B.set(t.positions[3*n],t.positions[3*n+1],t.positions[3*n+2]),n=t.indexes[e+2],t.C.set(t.positions[3*n],t.positions[3*n+1],t.positions[3*n+2]),t.C.sub(t.B),t.A.sub(t.B);for(var r=t.C.cross(t.A).normalize(),i=0;i<3;i++)t.normals[3*(e+i)]=r.x,t.normals[3*(e+i)+1]=r.y,t.normals[3*(e+i)+2]=r.z}})),(0,yr.Z)(this,"mapPositionsToIndexes",(function(){t.pointToIndexMap=Array(t.positions.length/3);for(var e=0;e<t.indexes.length;e++){var n=t.indexes[e];null==t.pointToIndexMap[n]&&(t.pointToIndexMap[n]=[]),t.pointToIndexMap[n].push(e)}})),(0,yr.Z)(this,"edgeSplitToGroups",(function(e,n,r){t.A.set(t.normals[3*r],t.normals[3*r+1],t.normals[3*r+2]).normalize();var i,a={splitGroup:[],currentGroup:[r]},o=(0,Y.Z)(e);try{for(o.s();!(i=o.n()).done;){var s=i.value;s!==r&&(t.B.set(t.normals[3*s],t.normals[3*s+1],t.normals[3*s+2]).normalize(),t.B.dot(t.A)<n?a.splitGroup.push(s):a.currentGroup.push(s))}}catch(u){o.e(u)}finally{o.f()}return a})),(0,yr.Z)(this,"edgeSplit",(function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0!==e.length){var i,a=[],o=(0,Y.Z)(e);try{for(o.s();!(i=o.n()).done;){var s=i.value;a.push(t.edgeSplitToGroups(e,n,s))}}catch(d){o.e(d)}finally{o.f()}for(var u=a[0],l=0,c=a;l<c.length;l++){var g=c[l];g.currentGroup.length>u.currentGroup.length&&(u=g)}null!=r&&t.splitIndexes.push({original:r,indexes:u.currentGroup}),u.splitGroup.length&&t.edgeSplit(u.splitGroup,n,r||u.currentGroup[0])}})),(0,yr.Z)(this,"modify",(function(e,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=!1;if(e.attributes.normal&&(a=!0,e=e.clone(),!0===i&&null!==e.index&&(t.oldNormals=e.attributes.normal.array),e.deleteAttribute("normal")),null==e.index){if(void 0===r)throw"THREE.EdgeSplitModifier relies on BufferGeometryUtils";e=cd(e)}t.indexes=e.index.array,t.positions=e.getAttribute("position").array,t.computeNormals(),t.mapPositionsToIndexes(),t.splitIndexes=[];var o,s=(0,Y.Z)(t.pointToIndexMap);try{for(s.s();!(o=s.n()).done;){var u=o.value;t.edgeSplit(u,Math.cos(n)-.001)}}catch(E){s.e(E)}finally{s.f()}for(var l={},c=0,g=Object.keys(e.attributes);c<g.length;c++){var I=g[c],C=e.attributes[I],h=new C.array.constructor((t.indexes.length+t.splitIndexes.length)*C.itemSize);h.set(C.array),l[I]=new d.BufferAttribute(h,C.itemSize,C.normalized)}var f=new Uint32Array(t.indexes.length);f.set(t.indexes);for(var p=0;p<t.splitIndexes.length;p++){for(var A=t.splitIndexes[p],m=t.indexes[A.original],v=0,b=Object.values(l);v<b.length;v++)for(var y=b[v],B=0;B<y.itemSize;B++)y.array[(t.indexes.length+p)*y.itemSize+B]=y.array[m*y.itemSize+B];var G,Z=(0,Y.Z)(A.indexes);try{for(Z.s();!(G=Z.n()).done;){var w=G.value;f[w]=t.indexes.length+p}}catch(E){Z.e(E)}finally{Z.f()}}(e=new d.BufferGeometry).setIndex(new d.BufferAttribute(f,1));for(var _=0,x=Object.keys(l);_<x.length;_++){var S=x[_];e.setAttribute(S,l[S])}if(a&&(e.computeVertexNormals(),null!==t.oldNormals)){var R,M=new Array(t.oldNormals.length/3).fill(!1),W=(0,Y.Z)(t.splitIndexes);try{for(W.s();!(R=W.n()).done;){var k=R.value;M[k.original]=!0}}catch(E){W.e(E)}finally{W.f()}for(var V=0;V<M.length;V++)if(!1===M[V])for(var F=0;F<3;F++)e.attributes.normal.array[3*V+F]=t.oldNormals[3*V+F]}return e}))}));function Bd(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=o.useRef(),r=o.useRef(),i=o.useRef();return o.useEffect((function(){!r.current&&n.current&&(r.current=n.current.geometry.clone(),i.current=new yd)}),[]),o.useEffect((function(){if(r.current&&n.current&&i.current){var a=i.current.modify(r.current,e,t);a.computeVertexNormals(),n.current.geometry=a}}),[e,t]),n}var Gd=1024,Zd=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=new Float32Array(4096*e*3),n=new d.DataTexture(t,Gd,4*e,d.RGBFormat,d.FloatType);return n.wrapS=d.RepeatWrapping,n.wrapT=d.RepeatWrapping,n.magFilter=d.NearestFilter,n.needsUpdate=!0,n},wd=function(e,t,n,r,i,a){var o=e.image.data,s=3072*a;o[3*t+s+0]=n,o[3*t+s+1]=r,o[3*t+s+2]=i};function _d(e){return{spineTexture:{value:e},pathOffset:{type:"f",value:0},pathSegment:{type:"f",value:1},spineOffset:{type:"f",value:161},spineLength:{type:"f",value:400},flow:{type:"i",value:1}}}function xd(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.__ok||(e.__ok=!0,e.onBeforeCompile=function(e){if(!e.__modified){e.__modified=!0,Object.assign(e.uniforms,t);var r="\n\t\tuniform sampler2D spineTexture;\n\t\tuniform float pathOffset;\n\t\tuniform float pathSegment;\n\t\tuniform float spineOffset;\n\t\tuniform float spineLength;\n\t\tuniform int flow;\n\n\t\tfloat textureLayers = ".concat(4*n,".;\n\t\tfloat textureStacks = ").concat(1,".;\n\n\t\t").concat(e.vertexShader,"\n\t\t").replace("#include <beginnormal_vertex>","").replace("#include <defaultnormal_vertex>","").replace("#include <begin_vertex>","").replace(/void\s*main\s*\(\)\s*\{/,"\n        void main() {\n        #include <beginnormal_vertex>\n\n        vec4 worldPos = modelMatrix * vec4(position, 1.);\n\n        bool bend = flow > 0;\n        float xWeight = bend ? 0. : 1.;\n\n        #ifdef USE_INSTANCING\n        float pathOffsetFromInstanceMatrix = instanceMatrix[3][2];\n        float spineLengthFromInstanceMatrix = instanceMatrix[3][0];\n        float spinePortion = bend ? (worldPos.x + spineOffset) / spineLengthFromInstanceMatrix : 0.;\n        float mt = (spinePortion * pathSegment + pathOffset + pathOffsetFromInstanceMatrix)*textureStacks;\n        #else\n        float spinePortion = bend ? (worldPos.x + spineOffset) / spineLength : 0.;\n        float mt = (spinePortion * pathSegment + pathOffset)*textureStacks;\n        #endif\n\n        mt = mod(mt, textureStacks);\n        float rowOffset = floor(mt);\n\n        #ifdef USE_INSTANCING\n        rowOffset += instanceMatrix[3][1] * ".concat(4,".;\n        #endif\n\n        vec3 spinePos = texture2D(spineTexture, vec2(mt, (0. + rowOffset + 0.5) / textureLayers)).xyz;\n        vec3 a =        texture2D(spineTexture, vec2(mt, (1. + rowOffset + 0.5) / textureLayers)).xyz;\n        vec3 b =        texture2D(spineTexture, vec2(mt, (2. + rowOffset + 0.5) / textureLayers)).xyz;\n        vec3 c =        texture2D(spineTexture, vec2(mt, (3. + rowOffset + 0.5) / textureLayers)).xyz;\n        mat3 basis = mat3(a, b, c);\n\n        vec3 transformed = basis\n          * vec3(worldPos.x * xWeight, worldPos.y * 1., worldPos.z * 1.)\n          + spinePos;\n\n        vec3 transformedNormal = normalMatrix * (basis * objectNormal);\n\t\t\t")).replace("#include <project_vertex>","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\t\t\t\tgl_Position = projectionMatrix * mvPosition;");e.vertexShader=r}})}var Sd=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,N.Z)(this,e),(0,yr.Z)(this,"curveArray",void 0),(0,yr.Z)(this,"curveLengthArray",void 0),(0,yr.Z)(this,"object3D",void 0),(0,yr.Z)(this,"splineTexure",void 0),(0,yr.Z)(this,"uniforms",void 0);var r=t.clone(),i=Zd(n),a=_d(i);r.traverse((function(e){(e instanceof d.Mesh||e instanceof d.InstancedMesh)&&(e.material=e.material.clone(),xd(e.material,a,n))})),this.curveArray=new Array(n),this.curveLengthArray=new Array(n),this.object3D=r,this.splineTexure=i,this.uniforms=a}return(0,z.Z)(e,[{key:"updateCurve",value:function(e,t){if(e>=this.curveArray.length)throw Error("Index out of range for Flow");var n=t.getLength();this.uniforms.spineLength.value=n,this.curveLengthArray[e]=n,this.curveArray[e]=t,function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.floor(1024);t.arcLengthDivisions=r/2,t.updateArcLengths();for(var i=t.getSpacedPoints(r),a=t.computeFrenetFrames(r,!0),o=0;o<r;o++){var s=Math.floor(o/Gd),u=o%Gd,l=i[o];wd(e,u,l.x,l.y,l.z,0+s+4*n),l=a.tangents[o],wd(e,u,l.x,l.y,l.z,1+s+4*n),l=a.normals[o],wd(e,u,l.x,l.y,l.z,2+s+4*n),l=a.binormals[o],wd(e,u,l.x,l.y,l.z,3+s+4*n)}e.needsUpdate=!0}(this.splineTexure,t,e)}},{key:"moveAlongCurve",value:function(e){this.uniforms.pathOffset.value+=e}}]),e}(),Rd=(new d.Matrix4,o.forwardRef((function(e,t){var n=e.children,r=e.curve,i=o.useState(),a=(0,g.Z)(i,2),s=a[0],u=a[1],l=o.useRef(),c=o.useRef();return o.useImperativeHandle(t,(function(){return{moveAlongCurve:function(e){var t;null==(t=c.current)||t.moveAlongCurve(e)}}})),o.useEffect((function(){!c.current&&l.current&&t&&(c.current=new Sd(l.current),u(c.current.object3D))}),[n,t]),o.useEffect((function(){var e;l.current&&r&&(null==(e=c.current)||e.updateCurve(0,r))}),[r]),s?o.createElement("primitive",{object:s}):o.cloneElement(o.Children.only(n),{ref:l})}))),Md=["speed"],Wd=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.Z)(this,n),(e=t.call(this,r)).setValues(r),e._time={value:0},e._distort={value:.4},e._radius={value:1},e}return(0,z.Z)(n,[{key:"onBeforeCompile",value:function(e){e.uniforms.time=this._time,e.uniforms.radius=this._radius,e.uniforms.distort=this._distort,e.vertexShader="\n      uniform float time;\n      uniform float radius;\n      uniform float distort;\n      ".concat("#define GLSLIFY 1\nvec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}float snoise(vec3 v){const vec2 C=vec2(1.0/6.0,1.0/3.0);const vec4 D=vec4(0.0,0.5,1.0,2.0);vec3 i=floor(v+dot(v,C.yyy));vec3 x0=v-i+dot(i,C.xxx);vec3 g=step(x0.yzx,x0.xyz);vec3 l=1.0-g;vec3 i1=min(g.xyz,l.zxy);vec3 i2=max(g.xyz,l.zxy);vec3 x1=x0-i1+C.xxx;vec3 x2=x0-i2+C.yyy;vec3 x3=x0-D.yyy;i=mod289(i);vec4 p=permute(permute(permute(i.z+vec4(0.0,i1.z,i2.z,1.0))+i.y+vec4(0.0,i1.y,i2.y,1.0))+i.x+vec4(0.0,i1.x,i2.x,1.0));float n_=0.142857142857;vec3 ns=n_*D.wyz-D.xzx;vec4 j=p-49.0*floor(p*ns.z*ns.z);vec4 x_=floor(j*ns.z);vec4 y_=floor(j-7.0*x_);vec4 x=x_*ns.x+ns.yyyy;vec4 y=y_*ns.x+ns.yyyy;vec4 h=1.0-abs(x)-abs(y);vec4 b0=vec4(x.xy,y.xy);vec4 b1=vec4(x.zw,y.zw);vec4 s0=floor(b0)*2.0+1.0;vec4 s1=floor(b1)*2.0+1.0;vec4 sh=-step(h,vec4(0.0));vec4 a0=b0.xzyw+s0.xzyw*sh.xxyy;vec4 a1=b1.xzyw+s1.xzyw*sh.zzww;vec3 p0=vec3(a0.xy,h.x);vec3 p1=vec3(a0.zw,h.y);vec3 p2=vec3(a1.xy,h.z);vec3 p3=vec3(a1.zw,h.w);vec4 norm=taylorInvSqrt(vec4(dot(p0,p0),dot(p1,p1),dot(p2,p2),dot(p3,p3)));p0*=norm.x;p1*=norm.y;p2*=norm.z;p3*=norm.w;vec4 m=max(0.6-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3)),0.0);m=m*m;return 42.0*dot(m*m,vec4(dot(p0,x0),dot(p1,x1),dot(p2,x2),dot(p3,x3)));}","\n      ").concat(e.vertexShader,"\n    "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n        float updateTime = time / 50.0;\n        float noise = snoise(vec3(position / 2.0 + updateTime * 5.0));\n        vec3 transformed = vec3(position * (noise * pow(distort, 2.0) + radius));\n        ")}},{key:"time",get:function(){return this._time.value},set:function(e){this._time.value=e}},{key:"distort",get:function(){return this._distort.value},set:function(e){this._distort.value=e}},{key:"radius",get:function(){return this._radius.value},set:function(e){this._radius.value=e}}]),n}(d.MeshPhysicalMaterial),kd=o.forwardRef((function(e,t){var n=e.speed,r=void 0===n?1:n,i=(0,m.Z)(e,Md),a=o.useState((function(){return new Wd})),u=(0,g.Z)(a,1)[0];return(0,s.useFrame)((function(e){return u&&(u.time=e.clock.getElapsedTime()*r)})),o.createElement("primitive",(0,v.Z)({dispose:void 0,object:u,ref:t,attach:"material"},i))})),Vd=["speed"],Fd=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.Z)(this,n),(e=t.call(this,r)).setValues(r),e._time={value:0},e._factor={value:1},e}return(0,z.Z)(n,[{key:"onBeforeCompile",value:function(e){e.uniforms.time=this._time,e.uniforms.factor=this._factor,e.vertexShader="\n      uniform float time;\n      uniform float factor;\n      ".concat(e.vertexShader,"\n    "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","float theta = sin( time + position.y ) / 2.0 * factor;\n        float c = cos( theta );\n        float s = sin( theta );\n        mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );\n        vec3 transformed = vec3( position ) * m;\n        vNormal = vNormal * m;")}},{key:"time",get:function(){return this._time.value},set:function(e){this._time.value=e}},{key:"factor",get:function(){return this._factor.value},set:function(e){this._factor.value=e}}]),n}(d.MeshStandardMaterial),Ed=o.forwardRef((function(e,t){var n=e.speed,r=void 0===n?1:n,i=(0,m.Z)(e,Vd),a=o.useState((function(){return new Fd})),u=(0,g.Z)(a,1)[0];return(0,s.useFrame)((function(e){return u&&(u.time=e.clock.getElapsedTime()*r)})),o.createElement("primitive",(0,v.Z)({dispose:void 0,object:u,ref:t,attach:"material"},i))})),Xd=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new d.Vector2;return(0,N.Z)(this,n),(e=t.call(this,{uniforms:{inputBuffer:new d.Uniform(null),depthBuffer:new d.Uniform(null),resolution:new d.Uniform(new d.Vector2),texelSize:new d.Uniform(new d.Vector2),halfTexelSize:new d.Uniform(new d.Vector2),kernel:new d.Uniform(0),scale:new d.Uniform(1),cameraNear:new d.Uniform(0),cameraFar:new d.Uniform(1),minDepthThreshold:new d.Uniform(0),maxDepthThreshold:new d.Uniform(1),depthScale:new d.Uniform(0),depthToBlurRatioBias:new d.Uniform(.25)},fragmentShader:"#include <common>\n        #include <dithering_pars_fragment>      \n        uniform sampler2D inputBuffer;\n        uniform sampler2D depthBuffer;\n        uniform float cameraNear;\n        uniform float cameraFar;\n        uniform float minDepthThreshold;\n        uniform float maxDepthThreshold;\n        uniform float depthScale;\n        uniform float depthToBlurRatioBias;\n        varying vec2 vUv;\n        varying vec2 vUv0;\n        varying vec2 vUv1;\n        varying vec2 vUv2;\n        varying vec2 vUv3;\n\n        void main() {\n          float depthFactor = 0.0;\n          \n          #ifdef USE_DEPTH\n            vec4 depth = texture2D(depthBuffer, vUv);\n            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));\n            depthFactor *= depthScale;\n            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));\n          #endif\n          \n          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));\n          gl_FragColor = sum * 0.25 ;\n\n          #include <dithering_fragment>\n        }",vertexShader:"uniform vec2 texelSize;\n        uniform vec2 halfTexelSize;\n        uniform float kernel;\n        uniform float scale;\n        varying vec2 vUv;\n        varying vec2 vUv0;\n        varying vec2 vUv1;\n        varying vec2 vUv2;\n        varying vec2 vUv3;\n\n        void main() {\n          vec2 uv = position.xy * 0.5 + 0.5;\n          vUv = uv;\n\n          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;\n          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);\n          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);\n          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);\n          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);\n\n          gl_Position = vec4(position.xy, 1.0, 1.0);\n        }",blending:d.NoBlending,depthWrite:!1,depthTest:!1})).toneMapped=!1,e.setTexelSize(r.x,r.y),e.kernel=new Float32Array([0,1,2,2,3]),e}return(0,z.Z)(n,[{key:"setTexelSize",value:function(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}},{key:"setResolution",value:function(e){this.uniforms.resolution.value.copy(e)}}]),n}(d.ShaderMaterial),Hd=function(){function e(t){var n=t.gl,r=t.resolution,i=t.width,a=void 0===i?500:i,o=t.height,s=void 0===o?500:o,u=t.minDepthThreshold,l=void 0===u?0:u,c=t.maxDepthThreshold,g=void 0===c?1:c,I=t.depthScale,C=void 0===I?0:I,h=t.depthToBlurRatioBias,f=void 0===h?.25:h;(0,N.Z)(this,e),this.renderToScreen=!1,this.renderTargetA=new d.WebGLRenderTarget(r,r,{minFilter:d.LinearFilter,magFilter:d.LinearFilter,stencilBuffer:!1,depthBuffer:!1,encoding:n.outputEncoding}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new Xd,this.convolutionMaterial.setTexelSize(1/a,1/s),this.convolutionMaterial.setResolution(new d.Vector2(a,s)),this.scene=new d.Scene,this.camera=new d.Camera,this.convolutionMaterial.uniforms.minDepthThreshold.value=l,this.convolutionMaterial.uniforms.maxDepthThreshold.value=g,this.convolutionMaterial.uniforms.depthScale.value=C,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=f,this.convolutionMaterial.defines.USE_DEPTH=C>0;var p=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),A=new Float32Array([0,0,2,0,0,2]),m=new d.BufferGeometry;m.setAttribute("position",new d.BufferAttribute(p,3)),m.setAttribute("uv",new d.BufferAttribute(A,2)),this.screen=new d.Mesh(m,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}return(0,z.Z)(e,[{key:"render",value:function(e,t,n){var r=this.scene,i=this.camera,a=this.renderTargetA,o=this.renderTargetB,s=this.convolutionMaterial,u=s.uniforms;u.depthBuffer.value=t.depthTexture;var l,c,g,d=s.kernel,I=t;for(c=0,g=d.length-1;c<g;++c)l=0===(1&c)?a:o,u.kernel.value=d[c],u.inputBuffer.value=I.texture,e.setRenderTarget(l),e.render(r,i),I=l;u.kernel.value=d[c],u.inputBuffer.value=I.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(r,i)}}]),e}(),Ld=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,N.Z)(this,n),(e=t.call(this,r))._debug={value:0},e._tDepth={value:null},e._distortionMap={value:null},e._tDiffuse={value:null},e._tDiffuseBlur={value:null},e._textureMatrix={value:null},e._hasBlur={value:!1},e._mirror={value:0},e._mixBlur={value:0},e._blurStrength={value:.5},e._minDepthThreshold={value:.9},e._maxDepthThreshold={value:1},e._depthScale={value:0},e._depthToBlurRatioBias={value:.25},e._distortion={value:1},e._mixContrast={value:1},e.setValues(r),e}return(0,z.Z)(n,[{key:"onBeforeCompile",value:function(e){var t;null!=(t=e.defines)&&t.USE_UV||(e.defines.USE_UV=""),e.uniforms.debug=this._debug,e.uniforms.hasBlur=this._hasBlur,e.uniforms.tDiffuse=this._tDiffuse,e.uniforms.tDepth=this._tDepth,e.uniforms.distortionMap=this._distortionMap,e.uniforms.tDiffuseBlur=this._tDiffuseBlur,e.uniforms.textureMatrix=this._textureMatrix,e.uniforms.mirror=this._mirror,e.uniforms.mixBlur=this._mixBlur,e.uniforms.mixStrength=this._blurStrength,e.uniforms.minDepthThreshold=this._minDepthThreshold,e.uniforms.maxDepthThreshold=this._maxDepthThreshold,e.uniforms.depthScale=this._depthScale,e.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,e.uniforms.distortion=this._distortion,e.uniforms.mixContrast=this._mixContrast,e.vertexShader="\n        uniform mat4 textureMatrix;\n        varying vec4 my_vUv;     \n      ".concat(e.vertexShader),e.vertexShader=e.vertexShader.replace("#include <project_vertex>","#include <project_vertex>\n        my_vUv = textureMatrix * vec4( position, 1.0 );\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );"),e.fragmentShader="\n        uniform int debug;\n        uniform sampler2D tDiffuse;\n        uniform sampler2D tDiffuseBlur;\n        uniform sampler2D tDepth;\n        uniform sampler2D distortionMap;\n        uniform float distortion;\n        uniform float cameraNear;\n\t\t\t  uniform float cameraFar;\n        uniform bool hasBlur;\n        uniform float mixBlur;\n        uniform float mirror;\n        uniform float mixStrength;\n        uniform float minDepthThreshold;\n        uniform float maxDepthThreshold;\n        uniform float mixContrast;\n        uniform float depthScale;\n        uniform float depthToBlurRatioBias;\n        varying vec4 my_vUv;        \n        ".concat(e.fragmentShader),e.fragmentShader=e.fragmentShader.replace("#include <emissivemap_fragment>","#include <emissivemap_fragment>\n    \n      float distortionFactor = 0.0;\n      #ifdef USE_DISTORTION\n        distortionFactor = texture2D(distortionMap, vUv).r * distortion;\n      #endif\n\n      vec4 new_vUv = my_vUv;\n      new_vUv.x += distortionFactor;\n      new_vUv.y += distortionFactor;\n\n      vec4 base = texture2DProj(tDiffuse, new_vUv);\n      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);\n      \n      vec4 merge = base;\n      \n      #ifdef USE_NORMALMAP\n        vec2 normal_uv = vec2(0.0);\n        vec4 normalColor = texture2D(normalMap, vUv * normalScale);\n        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );\n        vec3 coord = new_vUv.xyz / new_vUv.w;\n        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;\n        vec4 base_normal = texture2D(tDiffuse, normal_uv);\n        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);\n        merge = base_normal;\n        blur = blur_normal;\n      #endif\n\n      float depthFactor = 0.0001;\n      float blurFactor = 0.0;\n\n      #ifdef USE_DEPTH\n        vec4 depth = texture2DProj(tDepth, new_vUv);\n        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));\n        depthFactor *= depthScale;\n        depthFactor = max(0.0001, min(1.0, depthFactor));\n\n        #ifdef USE_BLUR\n          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);\n          merge = merge * min(1.0, depthFactor + 0.5);\n        #else\n          merge = merge * depthFactor;\n        #endif\n  \n      #endif\n\n      float reflectorRoughnessFactor = roughness;\n      #ifdef USE_ROUGHNESSMAP\n        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );\n        reflectorRoughnessFactor *= reflectorTexelRoughness.g;\n      #endif\n      \n      #ifdef USE_BLUR\n        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);\n        merge = mix(merge, blur, blurFactor);\n      #endif\n\n      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);\n      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;\n      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;\n      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;\n\n      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);           \n      diffuseColor = sRGBToLinear(diffuseColor);\n      \n      if (debug == 1) {\n        diffuseColor = sRGBToLinear(vec4(vec3(depthFactor), 1.0));\n      }\n      if (debug == 2) {\n        diffuseColor = sRGBToLinear(vec4(vec3(blurFactor), 1.0));\n      }\n      if (debug == 3) {\n        diffuseColor = sRGBToLinear(texture2DProj(tDiffuse, new_vUv));\n      }\n      if (debug == 4) {\n        diffuseColor = sRGBToLinear(texture2DProj(tDiffuseBlur, new_vUv));\n      }\n      ")}},{key:"tDiffuse",get:function(){return this._tDiffuse.value},set:function(e){this._tDiffuse.value=e}},{key:"tDepth",get:function(){return this._tDepth.value},set:function(e){this._tDepth.value=e}},{key:"distortionMap",get:function(){return this._distortionMap.value},set:function(e){this._distortionMap.value=e}},{key:"tDiffuseBlur",get:function(){return this._tDiffuseBlur.value},set:function(e){this._tDiffuseBlur.value=e}},{key:"textureMatrix",get:function(){return this._textureMatrix.value},set:function(e){this._textureMatrix.value=e}},{key:"hasBlur",get:function(){return this._hasBlur.value},set:function(e){this._hasBlur.value=e}},{key:"mirror",get:function(){return this._mirror.value},set:function(e){this._mirror.value=e}},{key:"mixBlur",get:function(){return this._mixBlur.value},set:function(e){this._mixBlur.value=e}},{key:"mixStrength",get:function(){return this._blurStrength.value},set:function(e){this._blurStrength.value=e}},{key:"minDepthThreshold",get:function(){return this._minDepthThreshold.value},set:function(e){this._minDepthThreshold.value=e}},{key:"maxDepthThreshold",get:function(){return this._maxDepthThreshold.value},set:function(e){this._maxDepthThreshold.value=e}},{key:"depthScale",get:function(){return this._depthScale.value},set:function(e){this._depthScale.value=e}},{key:"debug",get:function(){return this._debug.value},set:function(e){this._debug.value=e}},{key:"depthToBlurRatioBias",get:function(){return this._depthToBlurRatioBias.value},set:function(e){this._depthToBlurRatioBias.value=e}},{key:"distortion",get:function(){return this._distortion.value},set:function(e){this._distortion.value=e}},{key:"mixContrast",get:function(){return this._mixContrast.value},set:function(e){this._mixContrast.value=e}}]),n}(d.MeshStandardMaterial),zd=["mixBlur","mixStrength","resolution","blur","minDepthThreshold","maxDepthThreshold","depthScale","depthToBlurRatioBias","mirror","debug","distortion","mixContrast","distortionMap"];(0,s.extend)({MeshReflectorMaterialImpl:Ld});var Nd=o.forwardRef((function(e,t){var n=e.mixBlur,r=void 0===n?0:n,i=e.mixStrength,a=void 0===i?1:i,u=e.resolution,l=void 0===u?256:u,c=e.blur,I=void 0===c?[0,0]:c,C=e.minDepthThreshold,h=void 0===C?.9:C,f=e.maxDepthThreshold,p=void 0===f?1:f,A=e.depthScale,b=void 0===A?0:A,B=e.depthToBlurRatioBias,G=void 0===B?.25:B,Z=e.mirror,w=void 0===Z?0:Z,_=e.debug,x=void 0===_?0:_,S=e.distortion,R=void 0===S?1:S,M=e.mixContrast,W=void 0===M?1:M,k=e.distortionMap,V=(0,m.Z)(e,zd),F=(0,s.useThree)((function(e){return e.gl})),E=(0,s.useThree)((function(e){return e.camera})),X=(0,s.useThree)((function(e){return e.scene})),H=(I=Array.isArray(I)?I:[I,I])[0]+I[1]>0,L=o.useRef(null),z=o.useState((function(){return new d.Plane})),N=(0,g.Z)(z,1)[0],Y=o.useState((function(){return new d.Vector3})),T=(0,g.Z)(Y,1)[0],K=o.useState((function(){return new d.Vector3})),D=(0,g.Z)(K,1)[0],P=o.useState((function(){return new d.Vector3})),U=(0,g.Z)(P,1)[0],O=o.useState((function(){return new d.Matrix4})),J=(0,g.Z)(O,1)[0],Q=o.useState((function(){return new d.Vector3(0,0,-1)})),j=(0,g.Z)(Q,1)[0],q=o.useState((function(){return new d.Vector4})),$=(0,g.Z)(q,1)[0],ee=o.useState((function(){return new d.Vector3})),te=(0,g.Z)(ee,1)[0],ne=o.useState((function(){return new d.Vector3})),re=(0,g.Z)(ne,1)[0],ie=o.useState((function(){return new d.Vector4})),ae=(0,g.Z)(ie,1)[0],oe=o.useState((function(){return new d.Matrix4})),se=(0,g.Z)(oe,1)[0],ue=o.useState((function(){return new d.PerspectiveCamera})),le=(0,g.Z)(ue,1)[0],ce=o.useCallback((function(){var e,t=L.current.parent||(null==(e=L.current)?void 0:e.__r3f.parent);if(t&&(D.setFromMatrixPosition(t.matrixWorld),U.setFromMatrixPosition(E.matrixWorld),J.extractRotation(t.matrixWorld),T.set(0,0,1),T.applyMatrix4(J),te.subVectors(D,U),!(te.dot(T)>0))){te.reflect(T).negate(),te.add(D),J.extractRotation(E.matrixWorld),j.set(0,0,-1),j.applyMatrix4(J),j.add(U),re.subVectors(D,j),re.reflect(T).negate(),re.add(D),le.position.copy(te),le.up.set(0,1,0),le.up.applyMatrix4(J),le.up.reflect(T),le.lookAt(re),le.far=E.far,le.updateMatrixWorld(),le.projectionMatrix.copy(E.projectionMatrix),se.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),se.multiply(le.projectionMatrix),se.multiply(le.matrixWorldInverse),se.multiply(t.matrixWorld),N.setFromNormalAndCoplanarPoint(T,D),N.applyMatrix4(le.matrixWorldInverse),$.set(N.normal.x,N.normal.y,N.normal.z,N.constant);var n=le.projectionMatrix;ae.x=(Math.sign($.x)+n.elements[8])/n.elements[0],ae.y=(Math.sign($.y)+n.elements[9])/n.elements[5],ae.z=-1,ae.w=(1+n.elements[10])/n.elements[14],$.multiplyScalar(2/$.dot(ae)),n.elements[2]=$.x,n.elements[6]=$.y,n.elements[10]=$.z+1,n.elements[14]=$.w}}),[]),ge=o.useMemo((function(){var e={minFilter:d.LinearFilter,magFilter:d.LinearFilter,format:d.RGBFormat,encoding:F.outputEncoding},t=new d.WebGLRenderTarget(l,l,e);t.depthBuffer=!0,t.depthTexture=new d.DepthTexture(l,l),t.depthTexture.format=d.DepthFormat,t.depthTexture.type=d.UnsignedShortType;var n=new d.WebGLRenderTarget(l,l,e);return[t,n,new Hd({gl:F,resolution:l,width:I[0],height:I[1],minDepthThreshold:h,maxDepthThreshold:p,depthScale:b,depthToBlurRatioBias:G}),{mirror:w,textureMatrix:se,mixBlur:r,tDiffuse:t.texture,tDepth:t.depthTexture,tDiffuseBlur:n.texture,hasBlur:H,mixStrength:a,minDepthThreshold:h,maxDepthThreshold:p,depthScale:b,depthToBlurRatioBias:G,transparent:!0,debug:x,distortion:R,distortionMap:k,mixContrast:W,"defines-USE_BLUR":H?"":void 0,"defines-USE_DEPTH":b>0?"":void 0,"defines-USE_DISTORTION":k?"":void 0}]}),[F,I,se,l,w,H,r,a,h,p,b,G,x,R,k,W]),de=(0,g.Z)(ge,4),Ie=de[0],Ce=de[1],he=de[2],fe=de[3];return(0,s.useFrame)((function(){var e,t=L.current.parent||(null==(e=L.current)?void 0:e.__r3f.parent);if(t){t.visible=!1;var n=F.xr.enabled,r=F.shadowMap.autoUpdate;ce(),F.xr.enabled=!1,F.shadowMap.autoUpdate=!1,F.setRenderTarget(Ie),F.state.buffers.depth.setMask(!0),F.autoClear||F.clear(),F.render(X,le),H&&he.render(F,Ie,Ce),F.xr.enabled=n,F.shadowMap.autoUpdate=r,t.visible=!0,F.setRenderTarget(null)}})),o.createElement("meshReflectorMaterialImpl",(0,v.Z)({attach:"material",key:"key"+fe["defines-USE_BLUR"]+fe["defines-USE_DEPTH"]+fe["defines-USE_DISTORTION"],ref:(0,y.default)([L,t])},fe,V))})),Yd=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){return(0,N.Z)(this,n),t.call(this,{transparent:!0,uniforms:{size:{value:1}},vertexShader:d.ShaderLib.points.vertexShader,fragmentShader:"\n      varying vec3 vColor;\n      void main() {\n        vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n        float r = dot(cxy, cxy);\n        float delta = fwidth(r);\n        vec3 color = vColor;\n        #ifdef TONE_MAPPING\n          color = toneMapping(color);\n        #endif\n        gl_FragColor = linearToOutputTexel(vec4(color, 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r)));\n      }",vertexColors:!0})}return(0,z.Z)(n,[{key:"scale",get:function(){return this.uniforms.size.value},set:function(e){this.uniforms.size.value=e}}]),n}(d.ShaderMaterial),Td=o.forwardRef((function(e,t){var n=o.useState((function(){return new Yd})),r=(0,g.Z)(n,1)[0];return o.createElement("primitive",(0,v.Z)({object:r,ref:t,attach:"material"},e))})),Kd=!1,Dd=function(e){if(!Kd){Kd=!0;var t=d.ShaderChunk.shadowmap_pars_fragment;t=t.replace("#ifdef USE_SHADOWMAP","#ifdef USE_SHADOWMAP\n"+function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.frustum,n=void 0===t?3.75:t,r=e.size,i=void 0===r?.005:r,a=e.near,o=void 0===a?9.5:a,s=e.samples,u=void 0===s?17:s,l=e.rings,c=void 0===l?11:l;return"#define LIGHT_WORLD_SIZE ".concat(i,"\n#define LIGHT_FRUSTUM_WIDTH ").concat(n,"\n#define LIGHT_SIZE_UV (LIGHT_WORLD_SIZE / LIGHT_FRUSTUM_WIDTH)\n#define NEAR_PLANE ").concat(o,"\n\n#define NUM_SAMPLES ").concat(u,"\n#define NUM_RINGS ").concat(c,"\n#define BLOCKER_SEARCH_NUM_SAMPLES NUM_SAMPLES\n#define PCF_NUM_SAMPLES NUM_SAMPLES\n\nvec2 poissonDisk[NUM_SAMPLES];\n\nvoid initPoissonSamples(const in vec2 randomSeed) {\n  float ANGLE_STEP = PI2 * float(NUM_RINGS) / float(NUM_SAMPLES);\n  float INV_NUM_SAMPLES = 1.0 / float(NUM_SAMPLES);\n  float angle = rand(randomSeed) * PI2;\n  float radius = INV_NUM_SAMPLES;\n  float radiusStep = radius;\n  for (int i = 0; i < NUM_SAMPLES; i++) {\n    poissonDisk[i] = vec2(cos(angle), sin(angle)) * pow(radius, 0.75);\n    radius += radiusStep;\n    angle += ANGLE_STEP;\n  }\n}\n\nfloat penumbraSize(const in float zReceiver, const in float zBlocker) { // Parallel plane estimation\n  return (zReceiver - zBlocker) / zBlocker;\n}\n\nfloat findBlocker(sampler2D shadowMap, const in vec2 uv, const in float zReceiver) {\n  float searchRadius = LIGHT_SIZE_UV * (zReceiver - NEAR_PLANE) / zReceiver;\n  float blockerDepthSum = 0.0;\n  int numBlockers = 0;\n  for (int i = 0; i < BLOCKER_SEARCH_NUM_SAMPLES; i++) {\n    float shadowMapDepth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[i] * searchRadius));\n    if (shadowMapDepth < zReceiver) {\n      blockerDepthSum += shadowMapDepth;\n      numBlockers++;\n    }\n  }\n  if (numBlockers == 0) return -1.0;\n  return blockerDepthSum / float(numBlockers);\n}\n\nfloat PCF_Filter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius) {\n  float sum = 0.0;\n  for (int i = 0; i < PCF_NUM_SAMPLES; i++) {\n    float depth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[ i ] * filterRadius));\n    if (zReceiver <= depth) sum += 1.0;\n  }\n  for (int i = 0; i < PCF_NUM_SAMPLES; i++) {\n    float depth = unpackRGBAToDepth(texture2D(shadowMap, uv + -poissonDisk[ i ].yx * filterRadius));\n    if (zReceiver <= depth) sum += 1.0;\n  }\n  return sum / (2.0 * float(PCF_NUM_SAMPLES));\n}\n\nfloat PCSS(sampler2D shadowMap, vec4 coords) {\n  vec2 uv = coords.xy;\n  float zReceiver = coords.z; // Assumed to be eye-space z in this code\n  initPoissonSamples(uv);\n  float avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver);\n  if (avgBlockerDepth == -1.0) return 1.0;\n  float penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);\n  float filterRadius = penumbraRatio * LIGHT_SIZE_UV * NEAR_PLANE / zReceiver;\n  return PCF_Filter(shadowMap, uv, zReceiver, filterRadius);\n}")}((0,c.Z)({},e))),t=t.replace("#if defined( SHADOWMAP_TYPE_PCF )","\nreturn PCSS(shadowMap, shadowCoord);\n#if defined( SHADOWMAP_TYPE_PCF )"),d.ShaderChunk.shadowmap_pars_fragment=t}},Pd=["args","children"];function Ud(e){var t=e+"BufferGeometry";return o.forwardRef((function(e,n){var r=e.args,i=e.children,a=(0,m.Z)(e,Pd);return o.createElement("mesh",(0,v.Z)({ref:n},a),o.createElement(t,{attach:"geometry",args:r}),i)}))}var Od=Ud("box"),Jd=Ud("circle"),Qd=Ud("cone"),jd=Ud("cylinder"),qd=Ud("sphere"),$d=Ud("plane"),eI=Ud("tube"),tI=Ud("torus"),nI=Ud("torusKnot"),rI=Ud("tetrahedron"),iI=Ud("ring"),aI=Ud("polyhedron"),oI=Ud("icosahedron"),sI=Ud("octahedron"),uI=Ud("dodecahedron"),lI=Ud("extrude"),cI=Ud("lathe"),gI=Ud("parametric"),dI=["args","radius","smoothness","children"],II=1e-5;var CI=o.forwardRef((function(e,t){var n=e.args;n=void 0===n?[]:n;var r=(0,g.Z)(n,3),i=r[0],a=void 0===i?1:i,s=r[1],u=void 0===s?1:s,l=r[2],c=void 0===l?1:l,I=e.radius,C=void 0===I?.05:I,h=e.smoothness,f=void 0===h?4:h,p=e.children,A=(0,m.Z)(e,dI),b=o.useMemo((function(){return function(e,t,n){var r=new d.Shape,i=n-II;return r.absarc(II,II,II,-Math.PI/2,-Math.PI,!0),r.absarc(II,t-2*i,II,Math.PI,Math.PI/2,!0),r.absarc(e-2*i,t-2*i,II,Math.PI/2,0,!0),r.absarc(e-2*i,II,II,0,-Math.PI/2,!0),r}(a,u,C)}),[a,u,C]),y=o.useMemo((function(){return{depth:c-2*C,bevelEnabled:!0,bevelSegments:2*f,steps:1,bevelSize:C-II,bevelThickness:C,curveSegments:f}}),[c,C,f]),B=o.useRef();return o.useLayoutEffect((function(){B.current&&B.current.center()}),[b,y]),o.createElement("mesh",(0,v.Z)({ref:t},A),o.createElement("extrudeBufferGeometry",{attach:"geometry",ref:B,args:[b,y]}),p)})),hI=["children"];function fI(){var e=new d.BufferGeometry,t=new Float32Array([-1,-1,3,-1,-1,3]);return e.setAttribute("position",new d.BufferAttribute(t,2)),e}var pI=o.forwardRef((function(e,t){var n=e.children,r=(0,m.Z)(e,hI),i=o.useMemo(fI,[]);return o.createElement("mesh",(0,v.Z)({ref:t,geometry:i,frustumCulled:!1},r),n)})),AI=["children","alignTop"],mI=o.forwardRef((function(e,t){var n=e.children,r=e.alignTop,i=(0,m.Z)(e,AI),a=o.useRef(null),s=o.useRef(null);return o.useLayoutEffect((function(){a.current.position.set(0,0,0),a.current.updateWorldMatrix(!0,!0);var e=(new d.Box3).setFromObject(s.current),t=new d.Vector3,n=new d.Sphere,i=e.max.y-e.min.y;e.getCenter(t),e.getBoundingSphere(n),a.current.position.set(-t.x,-t.y+(r?i/2:0),-t.z)}),[n]),o.createElement("group",(0,v.Z)({ref:t},i),o.createElement("group",{ref:a},o.createElement("group",{ref:s},n)))})),vI=function(e){return e&&e.isOrthographicCamera},bI=o.createContext(null);function yI(e){var t=e.children,n=e.damping,r=void 0===n?6:n,i=e.fit,a=e.clip,u=e.margin,l=void 0===u?1.2:u,c=e.eps,I=void 0===c?.01:c,C=e.onFit,h=o.useRef(null),f=(0,s.useThree)((function(e){return e.camera})),p=(0,s.useThree)((function(e){return e.controls})),A=(0,s.useThree)((function(e){return e.invalidate})),m=o.useRef(C);function v(e,t){return Math.abs(e.x-t.x)<I&&Math.abs(e.y-t.y)<I&&Math.abs(e.z-t.z)<I}function b(e,t,n,r){e.x=d.MathUtils.damp(e.x,t.x,n,r),e.y=d.MathUtils.damp(e.y,t.y,n,r),e.z=d.MathUtils.damp(e.z,t.z,n,r)}m.current=C;var y=o.useState((function(){return{animating:!1,focus:new d.Vector3,camera:new d.Vector3,zoom:1}})),B=(0,g.Z)(y,1)[0],G=o.useState((function(){return{focus:new d.Vector3,camera:new d.Vector3,zoom:1}})),Z=(0,g.Z)(G,1)[0],w=o.useState((function(){return new d.Box3})),_=(0,g.Z)(w,1)[0],x=o.useMemo((function(){function e(){var e=_.getSize(new d.Vector3),t=_.getCenter(new d.Vector3),n=Math.max(e.x,e.y,e.z),r=vI(f)?4*n:n/(2*Math.atan(Math.PI*f.fov/360)),i=vI(f)?4*n:r/f.aspect,a=l*Math.max(r,i);return{box:_,size:e,center:t,distance:a}}return{getSize:e,refresh:function(e){var t;if((t=e)&&t.isObject3D?_.setFromObject(e):!function(e){return e&&e.isBox3}(e)?h.current&&_.setFromObject(h.current):_.copy(e),_.isEmpty()){var n=f.position.length()||10;_.setFromCenterAndSize(new d.Vector3,new d.Vector3(n,n,n))}return this},clip:function(){var t=e().distance;return p&&(p.maxDistance=10*t),f.near=t/100,f.far=100*t,f.updateProjectionMatrix(),p&&p.update(),this},fit:function(){B.camera.copy(f.position),p&&B.focus.copy(p.target);var t=e(),n=t.center,i=t.distance,a=n.clone().sub(f.position).normalize().multiplyScalar(i);if(Z.camera.copy(n).sub(a),Z.focus.copy(n),vI(f)){B.zoom=f.zoom;var o=0,s=0,u=[new d.Vector3(_.min.x,_.min.y,_.min.z),new d.Vector3(_.min.x,_.max.y,_.min.z),new d.Vector3(_.min.x,_.min.y,_.max.z),new d.Vector3(_.min.x,_.max.y,_.max.z),new d.Vector3(_.max.x,_.max.y,_.max.z),new d.Vector3(_.max.x,_.max.y,_.min.z),new d.Vector3(_.max.x,_.min.y,_.max.z),new d.Vector3(_.max.x,_.min.y,_.min.z)];n.applyMatrix4(f.matrixWorldInverse);for(var c=0,g=u;c<g.length;c++){var I=g[c];I.applyMatrix4(f.matrixWorldInverse),o=Math.max(o,Math.abs(I.y-n.y)),s=Math.max(s,Math.abs(I.x-n.x))}o*=2,s*=2;var C=(f.top-f.bottom)/o,h=(f.right-f.left)/s;Z.zoom=Math.min(C,h)/l,r||(f.zoom=Z.zoom,f.updateProjectionMatrix())}return r?B.animating=!0:(f.position.copy(Z.camera),f.lookAt(Z.focus),p&&(p.target.copy(Z.focus),p.update()),A()),m.current&&m.current(this.getSize()),this}}}),[_,f,p,l,r,A]);return o.useLayoutEffect((function(){if(x.refresh(),i&&x.fit(),a&&x.clip(),p){var e=function(){return B.animating=!1};return p.addEventListener("start",e),function(){return p.removeEventListener("start",e)}}}),[a,i,p]),(0,s.useFrame)((function(e,t){if(B.animating){if(b(B.focus,Z.focus,r,t),b(B.camera,Z.camera,r,t),B.zoom=d.MathUtils.damp(B.zoom,Z.zoom,r,t),f.position.copy(B.camera),vI(f)&&(f.zoom=B.zoom,f.updateProjectionMatrix()),p?(p.target.copy(B.focus),p.update()):f.lookAt(B.focus),A(),vI(f)&&!(Math.abs(B.zoom-Z.zoom)<I))return;if(!vI(f)&&!v(B.camera,Z.camera))return;if(p&&!v(B.focus,Z.focus))return;B.animating=!1}})),o.createElement("group",{ref:h},o.createElement(bI.Provider,{value:x},t))}function BI(){return o.useContext(bI)}var GI=(0,z.Z)((function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math;(0,N.Z)(this,e),(0,yr.Z)(this,"grad3",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]]),(0,yr.Z)(this,"grad4",[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]]),(0,yr.Z)(this,"p",[]),(0,yr.Z)(this,"perm",[]),(0,yr.Z)(this,"simplex",[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]),(0,yr.Z)(this,"dot",(function(e,t,n){return e[0]*t+e[1]*n})),(0,yr.Z)(this,"dot3",(function(e,t,n,r){return e[0]*t+e[1]*n+e[2]*r})),(0,yr.Z)(this,"dot4",(function(e,t,n,r,i){return e[0]*t+e[1]*n+e[2]*r+e[3]*i})),(0,yr.Z)(this,"noise",(function(e,n){var r=(e+n)*(.5*(Math.sqrt(3)-1)),i=Math.floor(e+r),a=Math.floor(n+r),o=(3-Math.sqrt(3))/6,s=(i+a)*o,u=e-(i-s),l=n-(a-s),c=0,g=1;u>l&&(c=1,g=0);var d=u-c+o,I=l-g+o,C=u-1+2*o,h=l-1+2*o,f=255&i,p=255&a,A=t.perm[f+t.perm[p]]%12,m=t.perm[f+c+t.perm[p+g]]%12,v=t.perm[f+1+t.perm[p+1]]%12,b=.5-u*u-l*l,y=.5-d*d-I*I,B=.5-C*C-h*h;return 70*((b<0?0:(b*=b)*b*t.dot(t.grad3[A],u,l))+(y<0?0:(y*=y)*y*t.dot(t.grad3[m],d,I))+(B<0?0:(B*=B)*B*t.dot(t.grad3[v],C,h)))})),(0,yr.Z)(this,"noise3d",(function(e,n,r){var i,a,o,s,u,l,c=(e+n+r)*(1/3),g=Math.floor(e+c),d=Math.floor(n+c),I=Math.floor(r+c),C=1/6,h=(g+d+I)*C,f=e-(g-h),p=n-(d-h),A=r-(I-h);f>=p?p>=A?(i=1,a=0,o=0,s=1,u=1,l=0):f>=A?(i=1,a=0,o=0,s=1,u=0,l=1):(i=0,a=0,o=1,s=1,u=0,l=1):p<A?(i=0,a=0,o=1,s=0,u=1,l=1):f<A?(i=0,a=1,o=0,s=0,u=1,l=1):(i=0,a=1,o=0,s=1,u=1,l=0);var m=f-i+C,v=p-a+C,b=A-o+C,y=f-s+2*C,B=p-u+2*C,G=A-l+2*C,Z=f-1+.5,w=p-1+.5,_=A-1+.5,x=255&g,S=255&d,R=255&I,M=t.perm[x+t.perm[S+t.perm[R]]]%12,W=t.perm[x+i+t.perm[S+a+t.perm[R+o]]]%12,k=t.perm[x+s+t.perm[S+u+t.perm[R+l]]]%12,V=t.perm[x+1+t.perm[S+1+t.perm[R+1]]]%12,F=.6-f*f-p*p-A*A,E=.6-m*m-v*v-b*b,X=.6-y*y-B*B-G*G,H=.6-Z*Z-w*w-_*_;return 32*((F<0?0:(F*=F)*F*t.dot3(t.grad3[M],f,p,A))+(E<0?0:(E*=E)*E*t.dot3(t.grad3[W],m,v,b))+(X<0?0:(X*=X)*X*t.dot3(t.grad3[k],y,B,G))+(H<0?0:(H*=H)*H*t.dot3(t.grad3[V],Z,w,_)))})),(0,yr.Z)(this,"noise4d",(function(e,n,r,i){var a,o,s,u,l,c,g,d,I,C,h,f,p=t.grad4,A=t.simplex,m=t.perm,v=(Math.sqrt(5)-1)/4,b=(5-Math.sqrt(5))/20,y=(e+n+r+i)*v,B=Math.floor(e+y),G=Math.floor(n+y),Z=Math.floor(r+y),w=Math.floor(i+y),_=(B+G+Z+w)*b,x=e-(B-_),S=n-(G-_),R=r-(Z-_),M=i-(w-_),W=(x>S?32:0)+(x>R?16:0)+(S>R?8:0)+(x>M?4:0)+(S>M?2:0)+(R>M?1:0),k=x-(a=A[W][0]>=3?1:0)+b,V=S-(o=A[W][1]>=3?1:0)+b,F=R-(s=A[W][2]>=3?1:0)+b,E=M-(u=A[W][3]>=3?1:0)+b,X=x-(l=A[W][0]>=2?1:0)+2*b,H=S-(c=A[W][1]>=2?1:0)+2*b,L=R-(g=A[W][2]>=2?1:0)+2*b,z=M-(d=A[W][3]>=2?1:0)+2*b,N=x-(I=A[W][0]>=1?1:0)+3*b,Y=S-(C=A[W][1]>=1?1:0)+3*b,T=R-(h=A[W][2]>=1?1:0)+3*b,K=M-(f=A[W][3]>=1?1:0)+3*b,D=x-1+4*b,P=S-1+4*b,U=R-1+4*b,O=M-1+4*b,J=255&B,Q=255&G,j=255&Z,q=255&w,$=m[J+m[Q+m[j+m[q]]]]%32,ee=m[J+a+m[Q+o+m[j+s+m[q+u]]]]%32,te=m[J+l+m[Q+c+m[j+g+m[q+d]]]]%32,ne=m[J+I+m[Q+C+m[j+h+m[q+f]]]]%32,re=m[J+1+m[Q+1+m[j+1+m[q+1]]]]%32,ie=.6-x*x-S*S-R*R-M*M,ae=.6-k*k-V*V-F*F-E*E,oe=.6-X*X-H*H-L*L-z*z,se=.6-N*N-Y*Y-T*T-K*K,ue=.6-D*D-P*P-U*U-O*O;return 27*((ie<0?0:(ie*=ie)*ie*t.dot4(p[$],x,S,R,M))+(ae<0?0:(ae*=ae)*ae*t.dot4(p[ee],k,V,F,E))+(oe<0?0:(oe*=oe)*oe*t.dot4(p[te],X,H,L,z))+(se<0?0:(se*=se)*se*t.dot4(p[ne],N,Y,T,K))+(ue<0?0:(ue*=ue)*ue*t.dot4(p[re],D,P,U,O)))}));for(var r=0;r<256;r++)this.p[r]=Math.floor(256*n.random());for(var i=0;i<512;i++)this.perm[i]=this.p[255&i]})),ZI=o.forwardRef((function(e,t){var n=e.intensity,r=void 0===n?1:n,i=e.decay,a=e.decayRate,u=void 0===a?.65:a,l=e.maxYaw,c=void 0===l?.1:l,d=e.maxPitch,I=void 0===d?.1:d,C=e.maxRoll,h=void 0===C?.1:C,f=e.yawFrequency,p=void 0===f?.1:f,A=e.pitchFrequency,m=void 0===A?.1:A,v=e.rollFrequency,b=void 0===v?.1:v,y=e.controls,B=(0,s.useThree)((function(e){return e.camera})),G=(0,s.useThree)((function(e){return e.controls})),Z=o.useRef(r),w=o.useRef(B.rotation.clone()),_=o.useState((function(){return new GI})),x=(0,g.Z)(_,1)[0],S=o.useState((function(){return new GI})),R=(0,g.Z)(S,1)[0],M=o.useState((function(){return new GI})),W=(0,g.Z)(M,1)[0],k=function(){(Z.current<0||Z.current>1)&&(Z.current=Z.current<0?0:1)};return o.useImperativeHandle(t,(function(){return{getIntensity:function(){return Z.current},setIntensity:function(e){Z.current=e,k()}}}),[]),o.useEffect((function(){var e=G||(null==y?void 0:y.current),t=function(){w.current=B.rotation.clone()};return null==e||e.addEventListener("change",t),function(){null==e||e.removeEventListener("change",t)}}),[y,G]),(0,s.useFrame)((function(e,t){var n=e.clock,r=Math.pow(Z.current,2),a=c*r*x.noise(n.elapsedTime*p,1),o=I*r*R.noise(n.elapsedTime*m,1),s=h*r*W.noise(n.elapsedTime*b,1);B.rotation.set(w.current.x+o,w.current.y+a,w.current.z+s),i&&Z.current>0&&(Z.current-=u*t,k())})),null})),wI=["children","speed","rotationIntensity","floatIntensity"];function _I(e){var t=e.children,n=e.speed,r=void 0===n?1:n,i=e.rotationIntensity,a=void 0===i?1:i,u=e.floatIntensity,l=void 0===u?1:u,c=(0,m.Z)(e,wI),g=o.useRef(null),d=o.useRef(1e4*Math.random());return(0,s.useFrame)((function(e){var t=d.current+e.clock.getElapsedTime();g.current.rotation.x=Math.cos(t/4*r)/8*a,g.current.rotation.y=Math.sin(t/4*r)/8*a,g.current.rotation.z=Math.sin(t/4*r)/20*a,g.current.position.y=Math.sin(t/4*r)/10*l})),o.createElement("group",c,o.createElement("group",{ref:g},t))}var xI=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(e){var r;return(0,N.Z)(this,n),(r=t.call(this,e)).type=d.HalfFloatType,r}return(0,z.Z)(n,[{key:"parse",value:function(e){var t=function(e,t){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(t||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(t||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(t||""));break;default:console.error("THREE.RGBELoader: Error: "+(t||""))}return-1},n=function(e,t,n){t=t||1024;for(var r=e.pos,i=-1,a=0,o="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));0>(i=s.indexOf("\n"))&&a<t&&r<e.byteLength;)o+=s,a+=s.length,r+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));return-1<i&&(!1!==n&&(e.pos+=a+i+1),o+s.slice(0,i))},r=function(e,t,n,r){var i=e[t+3],a=Math.pow(2,i-128)/255;n[r+0]=e[t+0]*a,n[r+1]=e[t+1]*a,n[r+2]=e[t+2]*a},i=function(e,t,n,r){var i=e[t+3],a=Math.pow(2,i-128)/255;n[r+0]=d.DataUtils.toHalfFloat(Math.min(e[t+0]*a,65504)),n[r+1]=d.DataUtils.toHalfFloat(Math.min(e[t+1]*a,65504)),n[r+2]=d.DataUtils.toHalfFloat(Math.min(e[t+2]*a,65504))},a=new Uint8Array(e);a.pos=0;var o=function(e){var r,i,a=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,u=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,l={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(r=n(e)))return t(1,"no header found");if(!(i=r.match(/^#\?(\S+)/)))return t(3,"bad initial token");for(l.valid|=1,l.programtype=i[1],l.string+=r+"\n";!1!==(r=n(e));)if(l.string+=r+"\n","#"!==r.charAt(0)){if((i=r.match(a))&&(l.gamma=parseFloat(i[1],10)),(i=r.match(o))&&(l.exposure=parseFloat(i[1],10)),(i=r.match(s))&&(l.valid|=2,l.format=i[1]),(i=r.match(u))&&(l.valid|=4,l.height=parseInt(i[1],10),l.width=parseInt(i[2],10)),2&l.valid&&4&l.valid)break}else l.comments+=r+"\n";return 2&l.valid?4&l.valid?l:t(3,"missing image size specifier"):t(3,"missing format specifier")}(a);if(-1!==o){var s=o.width,u=o.height,l=function(e,n,r){var i=n;if(i<8||i>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(i!==(e[2]<<8|e[3]))return t(3,"wrong scanline width");var a=new Uint8Array(4*n*r);if(!a.length)return t(4,"unable to allocate buffer space");for(var o=0,s=0,u=4*i,l=new Uint8Array(4),c=new Uint8Array(u),g=r;g>0&&s<e.byteLength;){if(s+4>e.byteLength)return t(1);if(l[0]=e[s++],l[1]=e[s++],l[2]=e[s++],l[3]=e[s++],2!=l[0]||2!=l[1]||(l[2]<<8|l[3])!=i)return t(3,"bad rgbe scanline format");for(var d=0,I=void 0;d<u&&s<e.byteLength;){var C=(I=e[s++])>128;if(C&&(I-=128),0===I||d+I>u)return t(3,"bad scanline data");if(C)for(var h=e[s++],f=0;f<I;f++)c[d++]=h;else c.set(e.subarray(s,s+I),d),d+=I,s+=I}for(var p=i,A=0;A<p;A++){var m=0;a[o]=c[A+m],m+=i,a[o+1]=c[A+m],m+=i,a[o+2]=c[A+m],m+=i,a[o+3]=c[A+m],o+=4}g--}return a}(a.subarray(a.pos),s,u);if(-1!==l){var c,g,I,C;switch(this.type){case d.FloatType:C=l.length/4;for(var h=new Float32Array(3*C),f=0;f<C;f++)r(l,4*f,h,3*f);c=h,g=d.RGBFormat,I=d.FloatType;break;case d.HalfFloatType:C=l.length/4;for(var p=new Uint16Array(3*C),A=0;A<C;A++)i(l,4*A,p,3*A);c=p,g=d.RGBFormat,I=d.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:s,height:u,data:c,header:o.string,gamma:o.gamma,exposure:o.exposure,format:g,type:I}}}return null}},{key:"setDataType",value:function(e){return this.type=e,this}},{key:"load",value:function(e,t,r,i){return(0,W.Z)((0,k.Z)(n.prototype),"load",this).call(this,e,(function(e,n){switch(e.type){case d.FloatType:case d.HalfFloatType:e.encoding=d.LinearEncoding,e.minFilter=d.LinearFilter,e.magFilter=d.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,n)}),r,i)}}]),n}(d.DataTextureLoader),SI={sunset:"venice_sunset_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",night:"dikhololo_night_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr",forest:"forest_slope_1k.hdr",apartment:"lebombo_1k.hdr",studio:"studio_small_03_1k.hdr",city:"potsdamer_platz_1k.hdr",park:"rooitou_park_1k.hdr",lobby:"st_fagans_interior_1k.hdr"};function RI(e){var t=e.background,n=void 0!==t&&t,r=e.files,i=void 0===r?["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"]:r,a=e.path,u=void 0===a?"":a,l=e.preset,c=void 0===l?void 0:l,g=e.scene,I=e.extensions;if(c){if(!(c in SI))throw new Error("Preset must be one of: "+Object.keys(SI).join(", "));i=SI[c],u="https://rawcdn.githack.com/pmndrs/drei-assets/aa3600359ba664d546d05821bcbca42013587df2/hdri/"}var C=(0,s.useThree)((function(e){return e.scene})),h=(0,s.useThree)((function(e){return e.gl})),f=Array.isArray(i),p=f?d.CubeTextureLoader:xI,A=(0,s.useLoader)(p,f?[i]:i,(function(e){e.setPath(u),I&&I(e)})),m=f?A[0]:A,v=(0,yc.G)((function(){return new Promise((function(e){var t=new d.PMREMGenerator(h),n=function(e,t,n){return n?(t.compileEquirectangularShader(),t.fromCubemap(e).texture):t.fromEquirectangular(e).texture}(m,t,f);t.dispose(),e(n)}))}),m);return o.useLayoutEffect((function(){var e=g?g.background:C.background,t=g?g.environment:C.environment;return g?(g.environment=v,n&&(g.background=v)):(C.environment=v,n&&(C.background=v)),function(){g?(g.environment=t,g.background=e):(C.environment=t,C.background=e),yc.G.clear(m),v.dispose()}}),[v,n,g]),null}var MI={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n      varying vec2 vUv;\n\n      void main() {\n\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n      }\n  ",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform float h;\n\n    varying vec2 vUv;\n\n    void main() {\n\n    \tvec4 sum = vec4( 0.0 );\n\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n    \tgl_FragColor = sum;\n\n    }\n  "},WI={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n    varying vec2 vUv;\n\n    void main() {\n\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    }\n  ",fragmentShader:"\n  \n  uniform sampler2D tDiffuse;\n  uniform float v;\n\n  varying vec2 vUv;\n\n  void main() {\n\n    vec4 sum = vec4( 0.0 );\n\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n    gl_FragColor = sum;\n\n  }\n  "},kI=["scale","frames","opacity","width","height","blur","far","resolution"],VI=o.forwardRef((function(e,t){var n=e.scale,r=e.frames,i=void 0===r?1/0:r,a=e.opacity,u=void 0===a?1:a,l=e.width,c=void 0===l?1:l,I=e.height,C=void 0===I?1:I,h=e.blur,f=void 0===h?1:h,p=e.far,A=void 0===p?10:p,b=e.resolution,y=void 0===b?256:b,B=(0,m.Z)(e,kI),G=(0,s.useThree)((function(e){return e.scene})),Z=(0,s.useThree)((function(e){return e.gl})),w=o.useRef();c*=Array.isArray(n)?n[0]:n||1,C*=Array.isArray(n)?n[1]:n||1;var _=o.useMemo((function(){var e=new d.WebGLRenderTarget(y,y),t=new d.WebGLRenderTarget(y,y);t.texture.generateMipmaps=e.texture.generateMipmaps=!1;var n=new d.PlaneBufferGeometry(c,C).rotateX(Math.PI/2),r=new d.Mesh(n),i=new d.MeshDepthMaterial;i.depthTest=i.depthWrite=!1,i.onBeforeCompile=function(e){return e.fragmentShader=e.fragmentShader.replace("1.0 - fragCoordZ ), opacity );","0.0 ), ( 1.0 - fragCoordZ ) * 1.0 );")};var a=new d.ShaderMaterial(MI),o=new d.ShaderMaterial(WI);return o.depthTest=a.depthTest=!1,[e,n,i,r,a,o,t]}),[y,c,C,n]),x=(0,g.Z)(_,7),S=x[0],R=x[1],M=x[2],W=x[3],k=x[4],V=x[5],F=x[6],E=0;return(0,s.useFrame)((function(){if(w.current&&(i===1/0||E<i)){var e=G.background;G.background=null,G.overrideMaterial=M,Z.setRenderTarget(S),Z.render(G,w.current),G.overrideMaterial=null,W.material=k,W.material.uniforms.tDiffuse.value=S.texture,k.uniforms.h.value=f/256,Z.setRenderTarget(F),Z.render(W,w.current),W.material=V,W.material.uniforms.tDiffuse.value=F.texture,V.uniforms.v.value=f/256,Z.setRenderTarget(S),Z.render(W,w.current),Z.setRenderTarget(null),G.background=e,E++}})),o.createElement("group",(0,v.Z)({"rotation-x":Math.PI/2},B,{ref:t}),o.createElement("mesh",{geometry:R,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},o.createElement("meshBasicMaterial",{map:S.texture,transparent:!0,opacity:u})),o.createElement("orthographicCamera",{ref:w,args:[-c/2,c/2,C/2,-C/2,0,A]}))})),FI=["children","controls","shadows","adjustCamera","environment","intensity","preset","shadowBias","contactShadow"],EI={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function XI(e){var t=e.children,n=e.controls,r=e.shadows,i=void 0===r||r,a=e.adjustCamera,u=void 0===a||a,l=e.environment,c=void 0===l?"city":l,I=e.intensity,C=void 0===I?1:I,h=e.preset,f=void 0===h?"rembrandt":h,p=e.shadowBias,A=void 0===p?0:p,b=e.contactShadow,y=void 0===b?{blur:2,opacity:.5,position:[0,0,0]}:b,B=(0,m.Z)(e,FI),G=EI[f],Z=(0,s.useThree)((function(e){return e.camera})),w=(0,s.useThree)((function(e){return e.controls})),_=o.useRef(null),x=o.useRef(null),S=o.useState({radius:0,width:0,height:0}),R=(0,g.Z)(S,2),M=R[0],W=M.radius,k=M.width,V=M.height,F=R[1];return o.useLayoutEffect((function(){_.current.position.set(0,0,0),_.current.updateWorldMatrix(!0,!0);var e=(new d.Box3).setFromObject(x.current),t=new d.Vector3,n=new d.Sphere,r=e.max.y-e.min.y,i=e.max.x-e.min.x;e.getCenter(t),e.getBoundingSphere(n),F({radius:n.radius,width:i,height:r}),_.current.position.set(-t.x,-t.y+r/2,-t.z)}),[t]),o.useLayoutEffect((function(){if(u){var e=W/(V>k?1.5:2.5);Z.position.set(0,.5*W,2.5*W),Z.near=.1,Z.far=Math.max(5e3,4*W),Z.lookAt(0,e,0);var t=w||(null==n?void 0:n.current);t&&(t.target.set(0,e,0),t.update())}}),[w,W,V,k,u]),o.createElement("group",B,o.createElement("group",{ref:_},o.createElement("group",{ref:x},t)),y&&o.createElement(VI,(0,v.Z)({width:2*W,height:2*W,far:W/2},y)),c&&o.createElement(RI,{preset:c}),o.createElement("ambientLight",{intensity:C/3}),o.createElement("spotLight",{penumbra:1,position:[G.main[0]*W,G.main[1]*W,G.main[2]*W],intensity:2*C,castShadow:i,"shadow-bias":A}),o.createElement("pointLight",{position:[G.fill[0]*W,G.fill[1]*W,G.fill[2]*W],intensity:C}))}var HI=["children","floor","segments","receiveShadow"],LI=function(e){return 0===e?0:Math.pow(2,10*e-10)};function zI(e){var t=e.children,n=e.floor,r=void 0===n?.25:n,i=e.segments,a=void 0===i?20:i,s=e.receiveShadow,u=(0,m.Z)(e,HI),l=o.useRef(null);return o.useLayoutEffect((function(){for(var e=0,t=a/a/2,n=l.current.attributes.position,i=0;i<a+1;i++)for(var o=0;o<a+1;o++)n.setXYZ(e++,i/a-t+(0===i?-r:0),o/a-t,LI(i/a));n.needsUpdate=!0,l.current.computeVertexNormals()}),[a,r]),o.createElement("group",u,o.createElement("mesh",{receiveShadow:s,rotation:[-Math.PI/2,0,Math.PI/2]},o.createElement("planeGeometry",{ref:l,args:[1,1,a,a]}),t))}var NI=["fog","colorStop","color","opacity"],YI=o.forwardRef((function(e,t){var n=e.fog,r=void 0!==n&&n,i=e.colorStop,a=void 0===i?0:i,s=e.color,u=void 0===s?"black":s,l=e.opacity,c=void 0===l?.5:l,g=(0,m.Z)(e,NI),I=o.useMemo((function(){var e=document.createElement("canvas");e.width=128,e.height=128;var t=e.getContext("2d"),n=t.createRadialGradient(e.width/2,e.height/2,0,e.width/2,e.height/2,e.width/2);return n.addColorStop(a,new d.Color(u).getStyle()),n.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=n,t.fillRect(0,0,e.width,e.height),e}),[u,a]);return o.createElement("mesh",(0,v.Z)({ref:t},g),o.createElement("planeBufferGeometry",{attach:"geometry",args:[1,1]}),o.createElement("meshBasicMaterial",{attach:"material",transparent:!0,opacity:c,fog:r},o.createElement("canvasTexture",{attach:"map",args:[I]})))})),TI=["mixBlur","mixStrength","resolution","blur","args","minDepthThreshold","maxDepthThreshold","depthScale","depthToBlurRatioBias","mirror","children","debug","distortion","mixContrast","distortionMap"];(0,s.extend)({MeshReflectorMaterial:Ld});var KI=o.forwardRef((function(e,t){var n=e.mixBlur,r=void 0===n?0:n,i=e.mixStrength,a=void 0===i?.5:i,u=e.resolution,l=void 0===u?256:u,c=e.blur,I=void 0===c?[0,0]:c,C=e.args,h=void 0===C?[1,1]:C,f=e.minDepthThreshold,p=void 0===f?.9:f,A=e.maxDepthThreshold,b=void 0===A?1:A,B=e.depthScale,G=void 0===B?0:B,Z=e.depthToBlurRatioBias,w=void 0===Z?.25:Z,_=e.mirror,x=void 0===_?0:_,S=e.children,R=e.debug,M=void 0===R?0:R,W=e.distortion,k=void 0===W?1:W,V=e.mixContrast,F=void 0===V?1:V,E=e.distortionMap,X=(0,m.Z)(e,TI);o.useEffect((function(){console.warn("Reflector has been deprecated and will be removed next major. Replace it with <MeshReflectorMaterial />!")}),[]);var H=(0,s.useThree)((function(e){return e.gl})),L=(0,s.useThree)((function(e){return e.camera})),z=(0,s.useThree)((function(e){return e.scene})),N=(I=Array.isArray(I)?I:[I,I])[0]+I[1]>0,Y=o.useRef(null),T=o.useState((function(){return new d.Plane})),K=(0,g.Z)(T,1)[0],D=o.useState((function(){return new d.Vector3})),P=(0,g.Z)(D,1)[0],U=o.useState((function(){return new d.Vector3})),O=(0,g.Z)(U,1)[0],J=o.useState((function(){return new d.Vector3})),Q=(0,g.Z)(J,1)[0],j=o.useState((function(){return new d.Matrix4})),q=(0,g.Z)(j,1)[0],$=o.useState((function(){return new d.Vector3(0,0,-1)})),ee=(0,g.Z)($,1)[0],te=o.useState((function(){return new d.Vector4})),ne=(0,g.Z)(te,1)[0],re=o.useState((function(){return new d.Vector3})),ie=(0,g.Z)(re,1)[0],ae=o.useState((function(){return new d.Vector3})),oe=(0,g.Z)(ae,1)[0],se=o.useState((function(){return new d.Vector4})),ue=(0,g.Z)(se,1)[0],le=o.useState((function(){return new d.Matrix4})),ce=(0,g.Z)(le,1)[0],ge=o.useState((function(){return new d.PerspectiveCamera})),de=(0,g.Z)(ge,1)[0],Ie=o.useCallback((function(){if(O.setFromMatrixPosition(Y.current.matrixWorld),Q.setFromMatrixPosition(L.matrixWorld),q.extractRotation(Y.current.matrixWorld),P.set(0,0,1),P.applyMatrix4(q),ie.subVectors(O,Q),!(ie.dot(P)>0)){ie.reflect(P).negate(),ie.add(O),q.extractRotation(L.matrixWorld),ee.set(0,0,-1),ee.applyMatrix4(q),ee.add(Q),oe.subVectors(O,ee),oe.reflect(P).negate(),oe.add(O),de.position.copy(ie),de.up.set(0,1,0),de.up.applyMatrix4(q),de.up.reflect(P),de.lookAt(oe),de.far=L.far,de.updateMatrixWorld(),de.projectionMatrix.copy(L.projectionMatrix),ce.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),ce.multiply(de.projectionMatrix),ce.multiply(de.matrixWorldInverse),ce.multiply(Y.current.matrixWorld),K.setFromNormalAndCoplanarPoint(P,O),K.applyMatrix4(de.matrixWorldInverse),ne.set(K.normal.x,K.normal.y,K.normal.z,K.constant);var e=de.projectionMatrix;ue.x=(Math.sign(ne.x)+e.elements[8])/e.elements[0],ue.y=(Math.sign(ne.y)+e.elements[9])/e.elements[5],ue.z=-1,ue.w=(1+e.elements[10])/e.elements[14],ne.multiplyScalar(2/ne.dot(ue)),e.elements[2]=ne.x,e.elements[6]=ne.y,e.elements[10]=ne.z+1,e.elements[14]=ne.w}}),[]),Ce=o.useMemo((function(){var e={minFilter:d.LinearFilter,magFilter:d.LinearFilter,format:d.RGBFormat,encoding:H.outputEncoding},t=new d.WebGLRenderTarget(l,l,e);t.depthBuffer=!0,t.depthTexture=new d.DepthTexture(l,l),t.depthTexture.format=d.DepthFormat,t.depthTexture.type=d.UnsignedShortType;var n=new d.WebGLRenderTarget(l,l,e);return[t,n,new Hd({gl:H,resolution:l,width:I[0],height:I[1],minDepthThreshold:p,maxDepthThreshold:b,depthScale:G,depthToBlurRatioBias:w}),{mirror:x,textureMatrix:ce,mixBlur:r,tDiffuse:t.texture,tDepth:t.depthTexture,tDiffuseBlur:n.texture,hasBlur:N,mixStrength:a,minDepthThreshold:p,maxDepthThreshold:b,depthScale:G,depthToBlurRatioBias:w,transparent:!0,debug:M,distortion:k,distortionMap:E,mixContrast:F,"defines-USE_BLUR":N?"":void 0,"defines-USE_DEPTH":G>0?"":void 0,"defines-USE_DISTORTION":E?"":void 0}]}),[H,I,ce,l,x,N,r,a,p,b,G,w,M,k,E,F]),he=(0,g.Z)(Ce,4),fe=he[0],pe=he[1],Ae=he[2],me=he[3];return(0,s.useFrame)((function(){if(null!=Y&&Y.current){Y.current.visible=!1;var e=H.xr.enabled,t=H.shadowMap.autoUpdate;Ie(),H.xr.enabled=!1,H.shadowMap.autoUpdate=!1,H.setRenderTarget(fe),H.state.buffers.depth.setMask(!0),H.autoClear||H.clear(),H.render(z,de),N&&Ae.render(H,fe,pe),H.xr.enabled=e,H.shadowMap.autoUpdate=t,Y.current.visible=!0,H.setRenderTarget(null)}})),o.createElement("mesh",(0,v.Z)({ref:(0,y.default)([Y,t])},X),o.createElement("planeBufferGeometry",{args:h}),S?S("meshReflectorMaterial",me):o.createElement("meshReflectorMaterial",me))})),DI=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){return(0,N.Z)(this,n),t.call(this,{uniforms:{depth:{value:null},attenuation:{value:2.5},anglePower:{value:12},spotPosition:{value:new d.Vector3(0,0,0)},lightColor:{value:new d.Color("white")},cameraNear:{value:0},cameraFar:{value:1},resolution:{value:new d.Vector2(0,0)}},transparent:!0,depthWrite:!1,vertexShader:"\n      varying vec3 vNormal;\n      varying vec3 vWorldPosition;\n      varying float vViewZ;\n      varying float vIntensity;\n      uniform vec3 spotPosition;\n      uniform float attenuation;\n\n      void main() {\n        // compute intensity\n        vNormal = normalize( normalMatrix * normal );\n        vec4 worldPosition\t= modelMatrix * vec4( position, 1.0 );\n        vWorldPosition = worldPosition.xyz;\n        vec4 viewPosition = viewMatrix * worldPosition;\n        vViewZ = viewPosition.z;\n        float intensity\t= distance(worldPosition.xyz, spotPosition) / attenuation;\n        intensity\t= 1.0 - clamp(intensity, 0.0, 1.0);\n        vIntensity = intensity;        \n        // set gl_Position\n        gl_Position\t= projectionMatrix * viewPosition;\n\n      }",fragmentShader:"\n      #include <packing>\n\n      varying vec3 vNormal;\n      varying vec3 vWorldPosition;\n      uniform vec3 lightColor;\n      uniform vec3 spotPosition;\n      uniform float attenuation;\n      uniform float anglePower;\n      uniform sampler2D depth;\n      uniform vec2 resolution;\n      uniform float cameraNear;\n      uniform float cameraFar;\n      varying float vViewZ;\n      varying float vIntensity;\n\n      float readDepth( sampler2D depthSampler, vec2 coord ) {\n        float fragCoordZ = texture2D( depthSampler, coord ).x;\n        float viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);\n        return viewZ;\n      }\n\n      void main() {\n        float d = 1.0;\n        bool isSoft = resolution[0] > 0.0 && resolution[1] > 0.0;\n        if (isSoft) {\n          vec2 sUv = gl_FragCoord.xy / resolution;\n          d = readDepth(depth, sUv);\n        }\n        float intensity = vIntensity;\n        vec3 normal\t= vec3(vNormal.x, vNormal.y, abs(vNormal.z));\n        float angleIntensity\t= pow( dot(normal, vec3(0.0, 0.0, 1.0)), anglePower );\n        intensity\t*= angleIntensity;\n        // fades when z is close to sampled depth, meaning the cone is intersecting existing geometry\n        if (isSoft) {\n          intensity\t*= smoothstep(0., 1., vViewZ - d);\n        }\n        gl_FragColor = vec4(lightColor, intensity);\n      }"})}return(0,z.Z)(n)}(d.ShaderMaterial),PI=["depthBuffer","color","distance","angle","attenuation","anglePower"],UI=new d.Vector3,OI=o.forwardRef((function(e,t){var n=e.depthBuffer,r=e.color,i=void 0===r?"white":r,a=e.distance,u=void 0===a?5:a,l=e.angle,c=void 0===l?.15:l,I=e.attenuation,C=void 0===I?5:I,h=e.anglePower,f=void 0===h?5:h,p=(0,m.Z)(e,PI),A=o.useRef(null),b=(0,s.useThree)((function(e){return e.size})),y=(0,s.useThree)((function(e){return e.camera})),B=(0,s.useThree)((function(e){return e.viewport.dpr})),G=o.useState((function(){return new DI})),Z=(0,g.Z)(G,1)[0];(0,s.useFrame)((function(){Z.uniforms.spotPosition.value.copy(A.current.getWorldPosition(UI)),A.current.lookAt(A.current.parent.target.getWorldPosition(UI))}));var w=o.useMemo((function(){var e=new d.CylinderGeometry(.1,7*c,u,128,64,!0);return e.applyMatrix4((new d.Matrix4).makeTranslation(0,-u/2,0)),e.applyMatrix4((new d.Matrix4).makeRotationX(-Math.PI/2)),e}),[c,u]);return o.createElement("spotLight",(0,v.Z)({ref:t,angle:c,color:i,distance:u},p),o.createElement("mesh",{ref:A,geometry:w},o.createElement("primitive",{object:Z,attach:"material","uniforms-lightColor-value":i,"uniforms-attenuation-value":C,"uniforms-anglePower-value":f,"uniforms-depth-value":n,"uniforms-cameraNear-value":y.near,"uniforms-cameraFar-value":y.far,"uniforms-resolution-value":n?[b.width*B,b.height*B]:[0,0]})))})),JI=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){return(0,N.Z)(this,n),t.call(this,new d.BoxGeometry(1,1,1),n.material)}return(0,z.Z)(n)}(d.Mesh);(0,yr.Z)(JI,"SkyShader",{uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new d.Vector3},up:{value:new d.Vector3(0,1,0)}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","uniform vec3 up;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tgl_Position.z = gl_Position.w;","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float mieDirectionalG;","uniform vec3 up;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","void main() {","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat zenithAngle = acos( max( 0.0, dot( up, direction ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( direction, vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","#include <tonemapping_fragment>","#include <encodings_fragment>","}"].join("\n")}),(0,yr.Z)(JI,"material",new d.ShaderMaterial({name:"SkyShader",fragmentShader:JI.SkyShader.fragmentShader,vertexShader:JI.SkyShader.vertexShader,uniforms:d.UniformsUtils.clone(JI.SkyShader.uniforms),side:d.BackSide,depthWrite:!1}));var QI=["inclination","azimuth","distance","mieCoefficient","mieDirectionalG","rayleigh","turbidity","sunPosition"];function jI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new d.Vector3,r=Math.PI*(e-.5),i=2*Math.PI*(t-.5);return n.x=Math.cos(i),n.y=Math.sin(r),n.z=Math.sin(i),n}var qI=o.forwardRef((function(e,t){var n=e.inclination,r=void 0===n?.6:n,i=e.azimuth,a=void 0===i?.1:i,s=e.distance,u=void 0===s?1e3:s,l=e.mieCoefficient,c=void 0===l?.005:l,I=e.mieDirectionalG,C=void 0===I?.8:I,h=e.rayleigh,f=void 0===h?.5:h,p=e.turbidity,A=void 0===p?10:p,b=e.sunPosition,y=void 0===b?jI(r,a):b,B=(0,m.Z)(e,QI),G=o.useMemo((function(){return(new d.Vector3).setScalar(u)}),[u]),Z=o.useState((function(){return new JI})),w=(0,g.Z)(Z,1)[0];return o.createElement("primitive",(0,v.Z)({dispose:void 0,object:w,ref:t,"material-uniforms-mieCoefficient-value":c,"material-uniforms-mieDirectionalG-value":C,"material-uniforms-rayleigh-value":f,"material-uniforms-sunPosition-value":y,"material-uniforms-turbidity-value":A,scale:G},B))})),$I=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){return(0,N.Z)(this,n),t.call(this,{uniforms:{time:{value:0},fade:{value:1}},vertexShader:"\n      uniform float time;\n      attribute float size;\n      varying vec3 vColor;\n      void main() {\n        vColor = color;\n        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);\n        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(mvPosition.x + 2.0 * time + 100.0));\n        gl_Position = projectionMatrix * mvPosition;\n      }",fragmentShader:"\n      uniform sampler2D pointTexture;\n      uniform float fade;\n      varying vec3 vColor;\n      void main() {\n        float opacity = 1.0;\n        if (fade == 1.0) {\n          float d = distance(gl_PointCoord, vec2(0.5, 0.5));\n          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));\n        }\n        gl_FragColor = vec4(vColor, opacity);\n      }"})}return(0,z.Z)(n)}(d.ShaderMaterial),eC=function(e){return(new d.Vector3).setFromSpherical(new d.Spherical(e,Math.acos(1-2*Math.random()),2*Math.random()*Math.PI))},tC=o.forwardRef((function(e,t){var n=e.radius,r=void 0===n?100:n,i=e.depth,u=void 0===i?50:i,l=e.count,c=void 0===l?5e3:l,I=e.saturation,C=void 0===I?0:I,h=e.factor,f=void 0===h?4:h,p=e.fade,A=void 0!==p&&p,m=o.useRef(),v=o.useMemo((function(){for(var e=[],t=[],n=Array.from({length:c},(function(){return(.5+.5*Math.random())*f})),i=new d.Color,o=r+u,s=u/c,l=0;l<c;l++)o-=s*Math.random(),e.push.apply(e,(0,a.Z)(eC(o).toArray())),i.setHSL(l/c,C,.9),t.push(i.r,i.g,i.b);return[new Float32Array(e),new Float32Array(t),new Float32Array(n)]}),[c,u,f,r,C]),b=(0,g.Z)(v,3),y=b[0],B=b[1],G=b[2];(0,s.useFrame)((function(e){return m.current&&(m.current.uniforms.time.value=e.clock.getElapsedTime())}));var Z=o.useState((function(){return new $I})),w=(0,g.Z)(Z,1)[0];return o.createElement("points",{ref:t},o.createElement("bufferGeometry",{attach:"geometry"},o.createElement("bufferAttribute",{attachObject:["attributes","position"],args:[y,3]}),o.createElement("bufferAttribute",{attachObject:["attributes","color"],args:[B,3]}),o.createElement("bufferAttribute",{attachObject:["attributes","size"],args:[G,1]})),o.createElement("primitive",{dispose:void 0,ref:m,object:w,attach:"material",blending:d.AdditiveBlending,"uniforms-fade-value":A,transparent:!0,vertexColors:!0}))})),nC=["opacity","speed","width","depth","segments"];function rC(e){var t=e.opacity,n=void 0===t?.5:t,r=e.speed,i=void 0===r?.4:r,u=e.width,l=void 0===u?10:u,c=e.depth,g=void 0===c?1.5:c,d=e.segments,I=void 0===d?20:d,C=(0,m.Z)(e,nC),h=o.useRef(),f=bo("data:image/png;base64,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"),p=o.useMemo((function(){return(0,a.Z)(new Array(I)).map((function(e,t){return{x:l/2-Math.random()*l,y:l/2-Math.random()*l,scale:.4+Math.sin((t+1)/I*Math.PI)*(10*(.2+Math.random())),density:Math.max(.2,Math.random()),rotation:Math.max(.002,.005*Math.random())*i}}))}),[l,I,i]);return(0,s.useFrame)((function(e){var t;return null==(t=h.current)?void 0:t.children.forEach((function(t,n){t.children[0].rotation.z+=p[n].rotation,t.children[0].scale.setScalar(p[n].scale+(1+Math.sin(e.clock.getElapsedTime()/10))/2*n/10)}))})),o.createElement("group",C,o.createElement("group",{position:[0,0,I/2*g],ref:h},p.map((function(e,t){var r=e.x,i=e.y,a=e.scale,s=e.density;return o.createElement(Ki,{key:t,position:[r,i,-t*g]},o.createElement($d,{scale:a,rotation:[0,0,0]},o.createElement("meshStandardMaterial",{map:f,transparent:!0,opacity:a/6*s*n,depthTest:!1})))}))))}var iC={0:"0404E8_0404B5_0404CB_3333FC",1:"045C5C_0DBDBD_049393_04A4A4",2:"046363_0CC3C3_049B9B_04ACAC",3:"0489C5_0DDDF9_04C3EE_04AFE1",4:"04989A_0CE3E4_04D2D5_04C7C8",5:"04C455_0EFABC_04F097_04E17A",6:"04CC77_0CF7CA_04E9A7_04AB54",7:"04E804_04B504_04CB04_33FC33",8:"04E8E8_04B5B5_04CCCC_33FCFC",9:"050505_747474_4C4C4C_333333",10:"070B0C_B2C7CE_728FA3_5B748B",11:"090909_9C9C9C_555555_7C7C7C",12:"0A0A0A_A9A9A9_525252_747474",13:"0C0CC3_04049F_040483_04045C",14:"0C430C_257D25_439A43_3C683C",15:"0D0DBD_040497_04047B_040455",16:"0D0DE3_040486_0404AF_0404CF",17:"0DBD0D_049704_047B04_045504",18:"0F0F0F_4B4B4B_1C1C1C_2C2C2C",19:"0F990F_047B04_044604_046704",20:"15100F_241D1B_292424_2C2C27",21:"161B1F_C7E0EC_90A5B3_7B8C9B",22:"167E76_36D6D2_23B2AC_27C1BE",23:"17395A_7EBCC7_4D8B9F_65A1B5",24:"181F1F_475057_616566_525C62",25:"191514_6D5145_4E3324_3B564D",26:"1A2461_3D70DB_2C3C8F_2C6CAC",27:"1B1B1B_515151_7E7E7E_6C6C6C",28:"1B1B1B_999999_575757_747474",29:"1B1C19_5F615D_4B4E4C_3F403D",30:"1C1810_352F23_2B2C1C_2B2C24",31:"1C70C6_09294C_0F3F73_52B3F6",32:"1D2424_565F66_4E555A_646C6E",33:"1D2A21_43443B_655B54_545C54",34:"1D3FCC_051B5F_81A0F2_5579E9",35:"221917_928380_5F504D_7C746C",36:"232014_908B78_5E5743_747460",37:"242733_333A4D_3E4554_3C3B43",38:"245642_3D8168_3D6858_417364",39:"253C3C_528181_406C6C_385F5F",40:"254FB0_99AFF0_6587D8_1D3279",41:"27222B_677491_484F6A_5D657A",42:"281813_604233_4B3426_442B22",43:"28292A_D3DAE5_A3ACB8_818183",44:"291912_473531_3C2C25_3A2424",45:"293534_B2BFC5_738289_8A9AA7",46:"293D21_ABC692_73B255_667C5C",47:"2A2A2A_B3B3B3_6D6D6D_848C8C",48:"2A2A2A_DBDBDB_6A6A6A_949494",49:"2A2D21_555742_898974_6C745B",50:"2A4BA7_1B2D44_1F3768_233C81",51:"2A6276_041218_739BA6_042941",52:"2B2828_7B796F_534F4A_616464",53:"2B2B22_3C3C30_464538_121210",54:"2D2D2A_74716E_8F8C8C_92958E",55:"2D2D2F_C6C2C5_727176_94949B",56:"2D8753_5CD6A5_45BB82_4CC494",57:"2E2E2D_7D7C76_A3A39F_949C94",58:"2E763A_78A0B7_B3D1CF_14F209",59:"2EAC9E_61EBE3_4DDDD1_43D1C6",60:"2F2FAA_1E1E87_10104E_1C1C70",61:"2F3747_6A7C9E_54637F_62748B",62:"300706_888576_822821_876E79",63:"302721_CAC1BB_7A706A_91959B",64:"304FB1_69A1EF_5081DF_5C8CE6",65:"312C34_A2AAB3_61656A_808494",66:"312D20_80675C_8B8C8B_85848C",67:"313131_BBBBBB_878787_A3A4A4",68:"320455_720DBE_560496_47047B",69:"32201D_613C3C_563533_8C655F",70:"32302B_4C4842_121211_1C1C14",71:"323C4D_B79039_7C6A44_605C48",72:"326666_66CBC9_C0B8AE_52B3B4",73:"331A0B_B17038_7D4E28_5B351A",74:"336EB3_152578_A4C5E2_74AED9",75:"34352A_718184_50605E_6E6761",76:"346088_6ABED7_56A0C5_4E91B8",77:"34A09C_6EE5E3_5CD7D3_4EC9C6",78:"34AB94_36DFC1_19F9EB_6C6E62",79:"353535_CFCFCF_828282_A4A4A4",80:"36220C_C6C391_8C844A_8B7B4C",81:"36312E_726461_59504D_645C5C",82:"365123_C6E5A3_A8D18D_8EB16C",83:"36C8FA_176ACB_24A7EF_1D93EC",84:"37C337_279F27_186018_248824",85:"385264_A1D3E2_86ADC1_6E94A8",86:"385862_6D8B8D_647B80_1A2E2F",87:"386169_A9CFDB_153C23_7CA3AC",88:"38925D_142B23_1D4835_2A6449",89:"392307_B3AE7D_6D5618_847C42",90:"39433A_65866E_86BF8B_BFF8D8",91:"394641_B1A67E_75BEBE_7D7256",92:"3A2412_A78B5F_705434_836C47",93:"3A3329_C9B090_928069_A9957A",94:"3A3D37_7E7F75_BCBFB6_9C9C94",95:"3B3B3B_C7C7C7_878787_A4A4A4",96:"3B3C3F_DAD9D5_929290_ABACA8",97:"3B4235_7B9395_5B716C_70847B",98:"3B6E10_E3F2C3_88AC2E_99CE51",99:"3D1F12_653821_070404_22130B",100:"3E2335_D36A1B_8E4A2E_2842A5",101:"3E3D39_D6CEAF_91BAC1_897966",102:"3E3E36_72726D_63645D_0E0F0C",103:"3E3E3E_AEAEAE_848484_777777",104:"3E95CC_65D9F1_A2E2F6_679BD4",105:"3F3A2F_91D0A5_7D876A_94977B",106:"3F3D52_CCCED9_AFB0C6_8D8CAC",107:"3F4441_D1D7D6_888F87_A2ADA1",108:"403A34_B0936E_7F979C_7E6956",109:"415325_83A24E_678239_748C3C",110:"416BA7_A5B8D0_0D2549_65ABEB",111:"422509_C89536_824512_0A0604",112:"422A1E_716767_685D59_5E4F4A",113:"424244_BDBBBE_8A898E_A3A4A9",114:"425F84_1C2939_2A3F57_24344C",115:"430404_BD9295_7E1E21_94544C",116:"432322_5E3839_170C0B_543433",117:"433D3F_A58D7D_786760_8C7C6D",118:"434240_D3D3CF_898784_A4A49F",119:"434343_9E9E9E_8C8C8C_848484",120:"434C32_62704C_546244_2F3220",121:"442C27_A79E90_847066_8D837C",122:"447072_8ACACB_65A4A5_74B3B3",123:"45432C_808361_B8C8BC_A5A27A",124:"454447_908E9A_181716_7C7C7B",125:"456A73_779B9E_173A46_154C5D",126:"463F37_ACCFBB_818B78_91A494",127:"464445_D2D0CB_919196_A8ADB0",128:"464543_D1CFC1_8E8C83_A4AC9C",129:"46804D_CBE9AC_90B57C_95D38F",130:"468126_C1DDB5_8AC460_A1D07C",131:"47392E_997E69_7C6553_8B745F",132:"474444_7B7575_9E9899_8C8C8B",133:"474643_696F7D_A9ABB8_8B8C93",134:"474843_CECEC4_898883_A3A3A4",135:"48270F_C4723B_9B5728_7B431B",136:"482908_894E0D_FBDB52_CA7420",137:"487FC9_A8E7F8_88CCF2_70AFDE",138:"489B7A_A0E7D9_6DC5AC_87DAC7",139:"48C381_226640_369F64_3CAC74",140:"49200B_C6926C_9C642B_A45C26",141:"495CA6_CCD2E6_A5B1D8_1E2852",142:"495E48_0D100D_9D9C87_9ECC9C",143:"496DBA_94C9F2_72A7E2_84B4EC",144:"4A6442_D0AB75_81CD94_181B12",145:"4B362C_715A4F_211913_644C44",146:"4B4A3A_94A3A4_68766F_988475",147:"4B5455_BBBFC4_97A0A6_838C90",148:"4C240E_A5613B_895134_734C44",149:"4C342A_7B584B_271912_6B4C44",150:"4C462E_6D876C_9AAC8F_9AABA6",151:"4C4C4C_D2D2D2_8F8F8F_ACACAC",152:"4D595E_858D87_596F84_748480",153:"4E4C42_B8C4C5_898E89_A3ACA4",154:"4E4D40_979786_AEAEA1_878678",155:"4E5150_9FA3A3_848C8A_82848C",156:"4F251B_381710_43241B_602F23",157:"4F439F_A28BE5_8570D6_7765C9",158:"4F4742_B7B1AA_847E79_969294",159:"4F4C45_A7AEAA_7A8575_9D97A2",160:"4F4F4F_9C9C9C_121212_7C7C7C",161:"4F4F4F_A1A1A1_8C8C8C_848484",162:"4F5246_8C8D84_7B7C74_131611",163:"4FE34F_2BB02B_3CD03C_1C861C",164:"50332C_D98D79_955F52_AA7C6C",165:"503522_C38254_9F6B45_845838",166:"504D3C_979C9D_81837D_9C998A",167:"513A11_CDBEB5_C8811C_9A733F",168:"51462B_DFCA7E_948050_A49874",169:"515151_DCDCDC_B7B7B7_9B9B9B",170:"515341_9A9C86_16180D_838474",171:"517919_659623_34460C_3E5813",172:"519C8D_83DAC7_9DEDE0_2B5B4C",173:"522221_91343B_7F6F6B_744960",174:"522A1A_94543A_C3896F_AB7D66",175:"525050_D4D3D3_959393_ACACAC",176:"533B33_AF9998_866965_9C7E7B",177:"535A2F_CDCA91_91915B_A4AC6F",178:"535F6B_A6BDC8_8FA3B4_7F91A2",179:"537387_75BBB9_152E5B_0E85E8",180:"54584E_B1BAC5_818B91_A7ACA3",181:"545B4D_D8DDC8_A0A792_B2C1A3",182:"54C104_BBFA0F_97EF04_7AE104",183:"55382F_78554E_271A16_6C4C44",184:"555555_C8C8C8_8B8B8B_A4A4A4",185:"556F42_112817_81927F_223E24",186:"55C404_BCFA0E_97F004_7AE104",187:"562D2A_2E1615_7E4945_703C3C",188:"56352F_1E110F_311C19_3C231C",189:"57553F_C6C3AF_8C8768_868C8C",190:"57583E_969788_292920_848474",191:"579241_B5D25D_0E1D2D_97C284",192:"582410_83381A_1F0C04_30140A",193:"583629_2E1810_765648_3C1C14",194:"584F3A_BEC3BD_C5A57D_A39073",195:"586A51_CCD5AA_8C9675_8DBBB7",196:"593E2C_E5D8A9_BC9F79_9F8A68",197:"595356_CDBFC6_AA9DA3_BBB3BC",198:"59554F_171716_847C74_2C2C24",199:"596773_B3C6CE_98AFB9_879AA8",200:"597C3F_254319_6C9668_7C9B53",201:"5A492B_DEC583_987D4D_AC9C74",202:"5A643B_454D2C_393F25_202315",203:"5B4CBC_B59AF2_9B84EB_8F78E4",204:"5B5428_C5A052_A28B46_ADA752",205:"5B574E_586967_807C6F_6A746C",206:"5C045C_BD0DBD_930493_A404A4",207:"5C2E0C_C36924_9F4F14_834114",208:"5C4E41_CCCDD6_9B979B_B1AFB0",209:"5C5743_262418_393727_342C20",210:"5C5C04_BDBD0D_939304_A4A404",211:"5C5C5C_A2A2A2_8C8C8C_848484",212:"5D5854_1A1714_373330_2C2424",213:"5D5D5D_CDCDCD_232323_ACACAC",214:"5D5E5A_A1A29B_2A2927_8B948C",215:"5E423A_8C6E69_382416_745D64",216:"5E5049_CDC2BE_9C8E88_B7ACA4",217:"5E5855_C6C4CD_C89B67_8F8E98",218:"5E5F62_A7B2BE_211C17_939CA3",219:"5ECBA4_BCFAE7_92EED0_A1F4DC",220:"5F1827_9B4A60_1F0404_340406",221:"5F4C4B_A07C7D_A8AFBF_868185",222:"5F4F50_A18E8E_8C7C7B_211A1A",223:"5F5F5F_BDBDBD_A4A4A4_9C9C9C",224:"604A30_DC9065_212C14_AC9C92",225:"60534A_211813_9B948E_8E837D",226:"605352_E9CCC5_C7A8A3_A89291",227:"606857_9BA894_8C9C83_8C9483",228:"613F04_D68C04_A45F04_1F0F04",229:"61583E_252314_928972_342C1C",230:"617586_23304C_1B1E30_4988CF",231:"622F19_885934_9A7748_94603A",232:"623622_A1756F_986353_89645B",233:"624541_FCD0C6_E4A19A_FCBCB4",234:"626262_9E9E9E_848484_262626",235:"626262_A8A8A8_949494_1F1F1F",236:"626A57_3B3F33_7D8973_444C3C",237:"626D5C_B8C2BB_1B230F_A4ACA3",238:"627D72_A6CAAA_202C28_B4D4B4",239:"630463_C30CC3_9B049B_AC04AC",240:"63533B_AA9472_1C1108_9B8C68",241:"63584B_E6E0D6_A8A092_BFB6A8",242:"635D52_A9BCC0_B1AEA0_819598",243:"636363_AAAAAA_949494_252525",244:"636D6C_D4E7ED_ABBCC4_9BA4A8",245:"637598_B7C4D3_22293A_9BACBF",246:"64554D_D1C9C1_ABADA0_0E0C0A",247:"64686F_BDC0C4_161718_A4A7AB",248:"647171_1F3349_2A475C_87A5AD",249:"647686_23292E_333C44_404B55",250:"656662_9B9B99_393B31_8B8C8C",251:"657274_2A2F30_A0A7B0_363C44",252:"65A0BA_C3E4F1_A7D5E6_97CADF",253:"65A0C7_C3E4F8_A7D5EF_97CAE9",254:"660505_F2B090_DD4D37_AA1914",255:"66605E_939198_2E261F_3C332A",256:"666864_B3B4AB_2F2F2C_9CA49B",257:"673B2A_99735C_99593A_3A160E",258:"677E93_36444D_99A9BA_435464",259:"678E67_C4D9C4_ACC8AC_98B898",260:"68049F_C90DE6_A404CF_B304DC",261:"683F2D_9F736D_431D06_966152",262:"68493E_B2AAA9_978C8C_130907",263:"684C40_776E69_9B7765_758D96",264:"685B57_BEB1B1_9B99A4_1E1D1D",265:"686464_CCCAC7_A4A19F_BCB4B4",266:"686B73_2A2B2D_D5D9DD_B0B3BC",267:"686E55_353C2F_869B7F_444434",268:"696347_98B0A2_28261E_362B22",269:"696969_A0A0A0_949494_8C8C8C",270:"6A3C15_EFC898_D59D59_B38346",271:"6A5338_1C120B_C5975F_96886C",272:"6A8287_405153_839EBE_424C5C",273:"6B3822_A65D48_824E48_401E0C",274:"6BBD6B_C8F3C8_A3E2A3_B4ECB4",275:"6C52AA_C9A6EA_A681D6_B494E2",276:"6C5DC3_352D66_5C4CAB_544CA5",277:"6C6F76_CBD1D7_B2BDC7_A6B0BF",278:"6C8996_14223F_B9DEDD_2E445C",279:"6D1616_E6CDBA_DE2B24_230F0F",280:"6D3B1C_895638_502A0D_844C31",281:"6D6050_C8C2B9_A2998E_B4AA9F",282:"6D6D6D_3E3E3E_C0C0C0_949494",283:"6E2E36_D3A1A0_BD7175_C78C8B",284:"6E5137_E8CA90_271912_B99C74",285:"6E524D_8496C5_AF6624_100B11",286:"6E6D69_D0ECE9_AAC7C6_200C0C",287:"6E7181_D1CFDF_ABAFC7_B4BCCE",288:"6E8C48_B8CDA7_344018_A8BC94",289:"6EC66E_C9F8C9_A3E8A3_B4F1B4",290:"6F503E_D59A70_221812_B0A899",291:"705B4B_312821_AF927B_44342C",292:"706962_24211E_BCB6AF_ACA494",293:"713A28_A87661_3A160D_9B6454",294:"714C30_EAD7C5_CC9265_E2B48F",295:"716049_D1C8B9_3F160C_BAA6A9",296:"71623B_ECDE8C_30250A_ABA69A",297:"72625B_F0DFD0_D9BAA5_C3A595",298:"726F5B_A09C88_8B8C7B_94907C",299:"727167_2F2F2B_A3A6A2_44443C",300:"728473_534C40_7BCEC8_7BB9B6",301:"736655_D9D8D5_2F281F_B1AEAB",302:"745359_BFAEA8_9B8384_AC9392",303:"746761_291C19_AB9385_3C2B27",304:"747A6F_292E2A_ACA79F_45453B",305:"74A192_041B0D_194C33_235B4C",306:"75322B_96463F_51201A_3D1814",307:"75723E_C0C3A0_2A1E0E_AFAE77",308:"75746F_333330_A2A1A9_444444",309:"758391_BAC2CA_435263_A1ACBC",310:"763B28_D0BDB8_ADA39E_1E1D1D",311:"763C39_431510_210504_55241C",312:"764739_D0917B_2A1611_B37C68",313:"765938_1F1009_A59C7C_C9A382",314:"766554_C1BEBB_2A1A0E_B4ABAC",315:"76787C_2F3031_A5A9B8_444446",316:"767989_323437_B6C4EE_343C44",317:"771A1F_D2939E_B6595D_9D4B54",318:"773012_AE5124_4D1908_340F04",319:"776045_D2CCC3_281910_BBB5AA",320:"776A5C_BA9A89_302C26_443C34",321:"776C62_292622_474039_3C342C",322:"777C61_333727_BABFA1_A5AC8C",323:"777D7D_BDCAD2_3E3C2E_B1B8B6",324:"787165_DAD9CD_9DC0CE_36302A",325:"7877EE_D87FC5_75D9C7_1C78C0",326:"794E40_361612_4C2A21_441B1B",327:"795038_C2856B_533320_AC7C61",328:"796D6B_DED3CB_C6BAB1_ADA09B",329:"796F52_36413A_C9B48C_B6A77F",330:"797367_302E29_ABA3A0_443C35",331:"7A6959_2D271D_C1B5A9_B4A393",332:"7A736F_463F33_575046_4B463D",333:"7A7A7A_D0D0D0_BCBCBC_B4B4B4",334:"7A7A7A_D9D9D9_BCBCBC_B4B4B4",335:"7A7C63_625531_665B3F_5B4B29",336:"7A9196_485C64_425459_C1E4E7",337:"7B5254_E9DCC7_B19986_C8AC91",338:"7B6857_383028_BCA38F_4C3C34",339:"7B6E5B_C5CACC_B1B2AE_322415",340:"7B7E82_343536_A0B1C8_44444C",341:"7C584C_27140D_B3765C_3D2318",342:"7C7C71_353630_ADAFAF_444444",343:"7D6651_F8E3BF_CEA987_E7C29C",344:"7D7673_353230_AEA7B0_4C4444",345:"7DA1BA_A4CCE8_5D7A8B_5E7C94",346:"7E5344_22120E_CCAB9C_8D919D",347:"7E5E57_AD9794_612D1D_C9997D",348:"7E8174_39444D_CECAA7_B3B49B",349:"7F5134_22120A_452110_9F7D5F",350:"7F8896_3B3936_BBCFE9_4B4B4D",351:"803537_310F10_C35A5D_D89093",352:"807068_C3B0AB_443E3B_AC9C94",353:"80726C_DCDBD7_9AA6C2_B7BFCA",354:"808A5B_E0E1D4_2C4304_C5C7B0",355:"80A6B4_D5E9EF_B2D0D9_C1DCE4",356:"80CA23_B7EE37_D5FA4C_A3E434",357:"812828_521818_C94141_AB3737",358:"812E39_551C24_381117_9E3C49",359:"815C41_F6C99A_D39F77_BB9474",360:"815F54_DECBC6_301813_C5A8A0",361:"8194AB_D6DFEB_C0CEDE_B0BFD1",362:"81ADB3_D6ECEE_BFDEE1_AFD1D7",363:"81BABA_D5F3F3_BBE4E4_ABDCDC",364:"825C4D_A08175_97746C_613B2F",365:"826A59_E0C9B9_CBAD99_3D2615",366:"827C87_4F3937_605457_534C4E",367:"834741_4C281D_BE8F8C_AE6A65",368:"835984_39273A_4C334C_593D5A",369:"837667_DCD4C8_C5BAAC_3C2E22",370:"846556_503E33_61493D_5C4434",371:"848679_363630_AABBB7_4B4B44",372:"855D08_DAC31B_BF9B0C_AF860C",373:"85694C_D1A67A_3C2F22_EBBF8F",374:"857B61_ACE5D4_593D28_5B4334",375:"858362_9F9F80_9C9673_70714B",376:"85B9D3_C9EAF9_417277_528789",377:"866C5B_544237_B29B8C_AC8F7C",378:"872F2D_AB403E_682421_581F1C",379:"877B70_34302B_CBB3A4_524C44",380:"877C72_B6ACBB_36322D_4C443B",381:"878787_4C4C4C_646464_5C5C5C",382:"887153_E5C188_433729_C1A484",383:"888D8F_515454_646A6C_6C6C6D",384:"89204B_17080D_DA4377_F780B5",385:"8955D0_744CC4_EA4AEF_954DA4",386:"8A3B3D_DA5F62_461F20_BC7F81",387:"8A3DA1_D77CE4_C263D4_B75AC9",388:"8A5B34_F3BD7C_DA9758_BE7E45",389:"8A6565_2E214D_D48A5F_ADA59C",390:"8A7666_3C332C_C6AEA2_54443C",391:"8A7968_3C342D_C6B3A5_54443B",392:"8B7469_443E39_C7A797_544443",393:"8B795F_291504_EFE5D4_4A3518",394:"8B892C_D4E856_475E2D_47360A",395:"8C5945_D4C0B6_C3A49C_430504",396:"8CAEBC_3A4443_506463_DAEFEF",397:"8D553D_3C2419_5D3727_AA766C",398:"8D8D8D_DDDDDD_CCCCCC_B7B7B7",399:"8E6767_D9C4C4_C8ACAC_B89898",400:"8E7C67_E2C6A5_3B332A_C3AB94",401:"8E907C_B1B5A7_D7DBD0_CCCFBA",402:"8F4277_361530_BF538E_52274C",403:"8F4E20_E8B06B_391A08_CC8944",404:"8F5D3C_5B3B26_382416_70482E",405:"8F7B61_D6B892_4E4436_C3AC86",406:"8F894E_DAD79B_C9C384_C4BE7B",407:"903B2A_EC9888_D96747_58190D",408:"906867_C7B6BC_5D2E26_BEA4A3",409:"908887_3C3229_C7C6D0_554A45",410:"908E8E_292828_454444_595757",411:"909473_555D4B_C2CCA2_645B3C",412:"910E5A_E127C3_CF1CA3_C1158F",413:"926B48_4C2D0D_5F3913_AA8874",414:"927253_EECEA7_D8B792_C7A883",415:"935555_F6DAD9_D39393_593333",416:"936451_C29A8F_5F3A2B_361D14",417:"938C8D_403731_CECED8_554C4C",418:"942967_D292B5_C76E9E_551A4C",419:"945D43_E5AAA0_351F14_CC8B78",420:"94615B_DACED1_C3B9A4_CCABAA",421:"94624F_573529_24110C_733424",422:"9650CA_46236A_7239A6_633492",423:"965146_2B191D_DF7A5C_BFD6E1",424:"96785D_B8A398_63452C_6C5435",425:"975337_EEBE98_4B211C_D88659",426:"977970_E1D9D8_DAC8C1_C4B2AD",427:"98332E_4A100D_691A16_A85A5B",428:"989784_665542_BFECE5_6D644C",429:"9A5A55_31110D_582A24_703C34",430:"9A7467_D2C2BF_662D22_CCB2A5",431:"9AA8B6_313133_4E5055_D7EBF8",432:"9B4816_E8A138_CC7421_DC8827",433:"9B9994_E1E0DB_474643_544C4C",434:"9B9B9B_1E1E1E_5C5C5C_444444",435:"9C5B3B_49200A_E9C8AB_DDAB7D",436:"9CC338_4E671A_799F27_8CAC2C",437:"9D282A_38191D_DFC6CD_D6495A",438:"9D4343_E38989_D37474_CE6C6C",439:"9D602E_E4C363_D5A64F_C38A44",440:"9D7F6E_C6DAD4_6D4C4B_C6BBBC",441:"9D8F84_5D4544_D9D3C9_62555A",442:"9D9D9D_4E4E4E_646464_6C6C6C",443:"9E7C7E_DDCBD0_351D20_683B38",444:"9E9C77_6E6F4E_7C7C54_C7BF96",445:"9F1A27_F1AF7F_CD5845_D08441",446:"9F4738_CE958D_4F0C0A_C0837C",447:"9F7D30_B69F75_B9B7BE_CB9C4D",448:"9F886D_362F25_E8C9A4_5C4C3C",449:"9F9F9F_E4E4E4_D4D4D4_CCCCCC",450:"A05F31_D5C2BC_D9996F_42230E",451:"A0A8B0_424336_E7E9EF_545C5C",452:"A1824F_4A2A06_F7E29F_B3A598",453:"A27216_E9D036_D0AB24_DCB927",454:"A28766_E4D6C3_D6C4AA_CAB598",455:"A3B2A4_3B3E3D_676F6A_535C57",456:"A48DA4_E8DDE8_C9B7C9_D4C2D4",457:"A49994_695244_C4C2CF_76645C",458:"A67362_36150C_5E2E1E_F6C3BF",459:"A84337_611D18_3F110F_7C2A22",460:"A88C77_DAD2C7_623532_956229",461:"A95E4D_57261A_6E3223_773C24",462:"A971A9_E8CBE8_D4A8D4_DCB3DC",463:"A98D6A_F2D3AB_FBE6BE_695332",464:"A9A2A0_2F211C_544440_6D5E5A",465:"AA526C_EAA6C9_DC88AF_D17BA0",466:"AB2C2C_EBB4B3_561212_DE8484",467:"AB2D08_C35E5A_C75522_C56C70",468:"AB54A8_EBAAE9_DF8FDD_D37ED0",469:"AC171C_FA8593_E84854_D3464E",470:"AC725C_2E1610_663E31_E78F6B",471:"AC7F84_78463A_C4AABB_885454",472:"AC8942_432D19_6E4D27_5F3B1C",473:"AC8961_EBDAC3_D1B791_DCC2A0",474:"AD9E81_F1E5CE_6B5C3E_5A492A",475:"ADC2CD_DFF7FA_C9E6F5_C1DBEC",476:"AE9D99_29303B_585F70_875C33",477:"AF986F_CDB489_9C7C5B_7E6C4D",478:"AF987A_2F2416_523F27_6B5331",479:"AF9A72_504718_74652B_E2C2A2",480:"B06932_451B09_7B3E16_150804",481:"B09273_7A573D_C7AF97_84644C",482:"B0A2A8_866A63_E8E9F2_614C4F",483:"B0B0B0_6E6E6E_848484_8C8C8C",484:"B1A395_EFE6E1_635A47_786D5D",485:"B2674B_552913_7C442F_733919",486:"B26F52_4B2E2B_79493A_663B32",487:"B27744_5A2804_F6C488_EBB27D",488:"B38B76_40251D_745042_5F3A30",489:"B3AA93_F4EFD7_E1DDC2_DCD3BB",490:"B47A5B_301E14_704A31_633C23",491:"B4B29D_442D0D_604E2A_736542",492:"B5987E_F8E4DC_6F5939_E9CCBA",493:"B5BBB5_3B4026_6E745D_5C6147",494:"B62D33_E4868B_7E2D34_DD6469",495:"B66D59_F0C9B2_E5B49C_DAA084",496:"B67F6B_4B2E2A_6C3A34_F3DBC6",497:"B6B8B1_994A24_315C81_927963",498:"B76E5E_7F3A2F_EE938C_F8A5A1",499:"B7A763_E6E1CC_554A1E_6C6428",500:"B86137_FBCA6F_6F3C37_040404",501:"B9896A_5B341B_F4CAA3_6C4C2D",502:"B98A6D_7B4F38_D1A68F_8C5B43",503:"B9B37A_F1EED0_E5E4BA_DAD6A8",504:"B9CDD2_775339_958272_7F6A5E",505:"BA472D_CA6E67_C76150_CA6C59",506:"BA5DBA_F2BEF2_E69BE6_DC8CDC",507:"BA864A_5D381E_644422_FBE97A",508:"BA8979_DDCBCA_9A4726_892407",509:"BAADA8_ECE6E7_9A8378_E3DCD3",510:"BC5B43_95170B_EEAC92_DB8C7C",511:"BC928D_F9E2D6_654445_835A51",512:"BD0D0D_970404_7B0404_550404",513:"BD5345_460F11_732622_EDB7B1",514:"BDB466_F3EDC3_E3DD9F_ECE3AA",515:"BE5F5F_F4BDBD_ECA4A4_E29191",516:"BEE2E9_7E6A53_9AA09C_87837E",517:"BF7051_994C2D_E99A7B_DE8C74",518:"BF7745_F5D08E_E5AE6B_ECBC7C",519:"BF8E78_E5CCBF_753E32_4A261E",520:"BFAA83_F5EAD6_E1D0B1_EBDDC0",521:"BFB5A4_DEDCCB_D7D4CC_DCD3C2",522:"C05429_ED6129_94492A_834729",523:"C09E5C_DAD2B9_654429_81582D",524:"C1AA92_AD6E29_737889_CED1D7",525:"C1B3A1_F6EEE5_E1D7C7_ECE4D3",526:"C21338_920C24_E71C54_F34A7D",527:"C28E4E_845119_0B0805_713C0C",528:"C2A391_523728_785741_694836",529:"C2A584_363B41_71665B_8C7367",530:"C2AB7D_4A412E_7A6B4E_F9EDBE",531:"C30C0C_9F0404_830404_5C0404",532:"C33829_48171A_752523_942923",533:"C345EC_5F1DAA_9F31DB_872CCD",534:"C35C04_F9C30C_EE9F04_E08304",535:"C3CCD4_5F3B23_948A7B_A9A49A",536:"C47004_F9D00C_EDAF04_E09704",537:"C4A591_635448_F2D9D5_856D5B",538:"C4C6C6_4D5756_646463_7A8080",539:"C4DEDE_97B5B5_EAF9F9_ABC4C4",540:"C5A292_635247_F2D7D6_846A5B",541:"C5BBB6_F8F4F1_E2DAD6_ECE3DF",542:"C75F55_F8BDA9_EB9484_F4A494",543:"C7938D_E0DBE1_D1BBBC_D5CCCB",544:"C7B9A1_F8F1E4_EEE4D2_E4D8C4",545:"C7C0AC_2E181B_543B30_6B6270",546:"C7C7D7_4C4E5A_818393_6C6C74",547:"C87157_F8CBAE_E9A582_F2B394",548:"C88467_5B3333_875C5A_7A3822",549:"C8AF84_F9ECD7_EFDEBF_E6D1AF",550:"C8C8C8_3F3F3F_787878_5C5C5C",551:"C8D1DC_575B62_818892_6E747B",552:"C98D7F_3B0B0B_A97667_94433F",553:"C99A8B_491B0E_6E4136_8A4D28",554:"C9C7BE_55514B_888279_7B6E5F",555:"CA4FE1_6B2398_A337C7_9334BC",556:"CA8892_F9D7DC_EBB8C0_F3C4CC",557:"CAA094_875343_956255_EADEDC",558:"CAA78A_F9E7D7_EAD0B9_F3DCC3",559:"CAAC80_FAEBD5_F2DEBF_EAD1AF",560:"CAB094_F9ECDD_EFDEC8_E8D4BD",561:"CAB79D_F9F1E3_F1E5D1_E9DAC6",562:"CAE24E_6C9A23_A3C737_B3D43C",563:"CB4934_FB9971_F07554_F68464",564:"CB4E88_F99AD6_F384C3_ED75B9",565:"CB5E3B_FABC7A_EF965E_F4A46C",566:"CB7146_551D0F_7C270D_E5AB9C",567:"CB7846_753C22_AB5C32_B46C3C",568:"CB919B_F9DDE1_ECC0C8_F4CCD4",569:"CBCBCB_595959_8C8C8C_747474",570:"CC7C5F_A15436_B26346_AF5C3C",571:"CC9A7E_8A5249_C06A3E_DADADA",572:"CCC5C9_3B2B2B_67585B_7F7375",573:"CCF6FA_9DD9EB_82C5D9_ACD4E4",574:"CDC3B8_5A3F3C_67545A_8D7769",575:"CDCBC8_444342_696765_81807E",576:"CE8C15_EAC79B_DDAB57_F9C962",577:"CE8F3D_F0D2B0_F3C77D_E6B278",578:"CEB299_6B5C4C_887564_746355",579:"D04444_AF2F2F_8B2424_9B2C2C",580:"D07E3F_FBBD1F_8D2840_24120C",581:"D0CCCB_524D50_928891_727581",582:"D0D3BE_816854_998366_685146",583:"D1AC04_F8E50A_EDD004_B38D04",584:"D3CAAB_8C866E_C0B89A_AEA68A",585:"D4855F_92512D_AE6742_A75C2C",586:"D54C2B_5F1105_F39382_F08375",587:"D5B5B4_9E6C6F_F5E9EF_A57986",588:"D5D5D5_929292_ACACAC_B4B4B4",589:"D64480_E27497_EA9BB1_CD156F",590:"D7D7C3_AAAA92_F5F5EA_BCBCA4",591:"D7DFDB_AAB5AF_F5FAF7_BCC4C4",592:"D8388B_230A14_FCC8FC_FC71E1",593:"D8C949_F5F19E_6B7855_9A9858",594:"D8D8E5_9D9DAF_B4B4C4_B4B4CC",595:"DA5788_DE94BD_E078A3_DD83B4",596:"DBDBBB_F7F7E4_AFAF89_C4C49C",597:"DC3E04_B52604_FC7D20_F85F04",598:"DE9261_86361E_A85A37_944C2C",599:"DEDEC4_B5B597_F9F9EA_C4C4AB",600:"DEE3E8_A6AEB5_BCC4CC_BCC4C4",601:"DEE8DE_A6B5A6_BCCCBC_BCC4BC",602:"DEE8E8_A6B5B5_BCCCCC_BAC4C4",603:"DFD9C2_B5AE92_F9F7EA_C4C4A4",604:"DFDBB7_F9F8E3_B5AF86_BCBC8C",605:"DFDFCA_4D2D07_6B5224_857145",606:"DFDFD6_58544E_81766A_989288",607:"E1E1D4_777C7B_9FA19A_898F8D",608:"E1E1E0_363636_989897_747472",609:"E2D3BC_867255_B39E7F_96836C",610:"E2E2E7_AEAEB5_C4C4CC_C4C4C4",611:"E42E12_F35132_F86949_B71B0A",612:"E5DED7_AFA69D_C4BCB4_C3BAAB",613:"E6BF3C_5A4719_977726_FCFC82",614:"E6E3E3_B5AFAF_CCC4C4_C4C4C4",615:"E6E6E6_AAAAAA_C4C4C4_CCCCCC",616:"E7632F_FBA06B_BB2905_FB865E",617:"E7E2D8_B1AA9D_C9C2B3_BCB4AC",618:"E80404_B50404_CB0404_FC3333",619:"E804E8_B504B5_CC04CC_FC33FC",620:"E8DEE1_B5A6AA_CCBCC1_C4BBBC",621:"E8E5DE_B5AFA6_CCC5BC_C4C4BB",622:"E8E8DE_B5B5A6_CCCCBC_C4C4BA",623:"E9CCA1_A63106_DF8C3B_621304",624:"EA783E_6D4830_905837_FCDC6C",625:"EAD8D6_B59A97_CCB4B0_C9ABAB",626:"EAEAEA_B5B5B5_CCCCCC_D4D4D4",627:"EAEAEA_B6B6B6_CCCCCC_C4C4C4",628:"ED4630_791A0E_A42716_501009",629:"ED5087_FAC3D0_1C0B0C_FC84CC",630:"ED7F04_FCD60E_7E2D04_B73E04",631:"EDED06_B5B504_CCCC04_D4D404",632:"EE4128_FC8E82_9A0704_BF0F05",633:"EEECFB_BFB6D5_D0C8EB_CCC4DC",634:"F0D504_FBFAD3_B98609_CDA204",635:"F75F0B_461604_9A3004_FB9D2F",636:"F77777_FBE1E1_FAB2B2_FBC4C4",637:"F79686_FCCBD4_E76644_E76B56",638:"F9E6C7_FCF7DF_EDD3AA_F1D4B4",639:"FBB43F_FBE993_FB552E_FCDD65",640:"FBB82D_FBEDBF_FBDE7D_FB7E05"};function aC(e){switch(e){case 64:return"-64px";case 128:return"-128px";case 256:return"-256px";case 512:return"-512px";default:return""}}var oC="https://rawcdn.githack.com/emmelleppi/matcaps/9b36ccaaf0a24881a39062d05566c9e92be4aa0d",sC=iC[0];function uC(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,n=o.useMemo((function(){return Object.keys(iC).length}),[]),r=o.useMemo((function(){return"string"===typeof e?e:"number"===typeof e?iC[e]:null}),[e]),i="".concat(r||sC).concat(aC(t),".png"),a="".concat(oC,"/").concat(t,"/").concat(i),s=bo(a);return[s,a,n]}var lC={0:"151_norm.JPG",1:"152_norm.JPG",2:"153_norm.JPG",3:"154_norm.JPG",4:"155_norm.JPG",5:"156_norm.JPG",6:"157_norm.JPG",7:"158_norm.JPG",8:"159_norm.JPG",9:"160_norm.JPG",10:"161_norm.JPG",11:"162_norm.JPG",12:"163_norm.JPG",13:"164_norm.JPG",14:"165_norm.JPG",15:"166_norm.JPG",16:"167_norm.JPG",17:"168_norm.JPG",18:"169_norm.JPG",19:"170_norm.JPG",20:"171_norm.JPG",21:"172_norm.JPG",22:"173_norm.JPG",23:"174_norm.jpg",24:"175_norm.JPG",25:"176_norm.JPG",26:"177_norm.JPG",27:"178_norm.JPG",28:"179_norm.JPG",29:"180_norm.JPG",30:"181_norm.JPG",31:"182_norm.JPG",32:"183_norm.JPG",33:"184_norm.JPG",34:"185_norm.JPG",35:"186_norm.JPG",36:"187_norm.JPG",37:"188_norm.JPG",38:"189_norm.JPG",39:"190_norm.JPG",40:"191_norm.JPG",41:"192_norm.JPG",42:"193_norm.JPG",43:"194_norm.JPG",44:"195_norm.JPG",45:"196_norm.JPG",46:"197_norm.JPG",47:"198_norm.JPG",48:"199_norm.JPG",49:"200_norm.JPG",50:"201_norm.jpg",51:"202_norm.jpg",52:"203_norm.jpg",53:"204_norm.jpg",54:"205_norm.jpg",55:"206_norm.jpg",56:"207_norm.jpg",57:"208_norm.jpg",58:"209_norm.jpg",59:"210_norm.jpg",60:"211_norm.jpg",61:"212_norm.jpg",62:"213_norm.jpg",63:"214_norm.jpg",64:"215_norm.jpg",65:"216_norm.jpg",66:"217_norm.jpg",67:"218_norm.jpg",68:"219_norm.jpg",69:"220_norm.jpg",70:"221_norm.jpg",71:"222_norm.jpg",72:"223_norm.jpg",73:"224_norm.jpg",74:"225_norm.jpg",75:"226_norm.jpg"},cC="https://rawcdn.githack.com/emmelleppi/normal-maps/f24c810fc1d86b5b1e5dfea914b668f70b5f2923",gC=lC[0];function dC(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.repeat,r=void 0===n?[1,1]:n,i=t.anisotropy,a=void 0===i?1:i,s=t.offset,u=void 0===s?[0,0]:s,l=o.useMemo((function(){return Object.keys(lC).length}),[]),c=lC[e]||gC,g="".concat(cC,"/normals/").concat(c),I=bo(g);return o.useLayoutEffect((function(){I&&(I.wrapS=I.wrapT=d.RepeatWrapping,I.repeat=new d.Vector2(r[0],r[1]),I.offset=new d.Vector2(u[0],u[1]),I.anisotropy=a)}),[I,a,r,u]),[I,g,l]}var IC,CC,hC=function(e){(0,V.Z)(n,e);var t=(0,F.Z)(n);function n(){var e;return(0,N.Z)(this,n),(e=t.call(this)).color=new d.Color("white"),e}return(0,z.Z)(n)}(d.Group),fC=["children","range","limit"],pC=["children"],AC=["children","positions","colors","sizes","stride"],mC=o.createContext(null),vC=new d.Matrix4,bC=new d.Vector3,yC=new d.Color,BC=o.forwardRef((function(e,t){var n=e.children,r=e.range,i=e.limit,u=void 0===i?1e3:i,l=(0,m.Z)(e,fC),I=o.useRef(null),C=o.useState([]),h=(0,g.Z)(C,2),f=h[0],p=h[1],A=o.useState((function(){return[new Float32Array(3*u),Float32Array.from({length:3*u},(function(){return 1})),Float32Array.from({length:u},(function(){return 1}))]})),b=(0,g.Z)(A,1),B=(0,g.Z)(b[0],3),G=B[0],Z=B[1],w=B[2];o.useLayoutEffect((function(){I.current.geometry.drawRange.count=Math.min(u,void 0!==r?r:u,f.length)}),[f,r]),o.useEffect((function(){I.current.geometry.attributes.position.needsUpdate=!0})),(0,s.useFrame)((function(){for(I.current.updateMatrix(),I.current.updateMatrixWorld(),vC.copy(I.current.matrixWorld).invert(),IC=0;IC<f.length;IC++)(CC=f[IC].current).getWorldPosition(bC).applyMatrix4(vC),bC.x===G[3*IC]&&bC.y===G[3*IC+1]&&bC.z===G[3*IC+2]||(bC.toArray(G,3*IC),I.current.geometry.attributes.position.needsUpdate=!0,CC.matrixWorldNeedsUpdate=!0),CC.color.equals(yC.fromArray(Z,3*IC))||(CC.color.toArray(Z,3*IC),I.current.geometry.attributes.color.needsUpdate=!0),CC.size!==w[IC]&&(w.set([CC.size],IC),I.current.geometry.attributes.size.needsUpdate=!0)}));var _=o.useMemo((function(){var e={};for(IC=0;IC<f.length;IC++){var t;Object.assign(e,null==(t=f[IC].current)?void 0:t.__r3f.handlers)}return Object.keys(e).reduce((function(e,t){return(0,c.Z)((0,c.Z)({},e),{},(0,yr.Z)({},t,(function(e){var n,r,i,a=null==(n=f[e.index])?void 0:n.current;return null==a||null==(r=a.__r3f)||null==(i=r.handlers)?void 0:i[t]((0,c.Z)((0,c.Z)({},e),{},{object:a}))})))}),{})}),[n,f]),x=o.useMemo((function(){return{subscribe:function(e){return p((function(t){return[].concat((0,a.Z)(t),[e])})),function(){return p((function(t){return t.filter((function(t){return t.current!==e.current}))}))}}}}),[]);return o.createElement("points",(0,v.Z)({matrixAutoUpdate:!1,ref:(0,y.default)([t,I])},_,l),o.createElement("bufferGeometry",null,o.createElement("bufferAttribute",{attachObject:["attributes","position"],count:G.length/3,array:G,itemSize:3,usage:d.DynamicDrawUsage}),o.createElement("bufferAttribute",{attachObject:["attributes","color"],count:Z.length/3,array:Z,itemSize:3,usage:d.DynamicDrawUsage}),o.createElement("bufferAttribute",{attachObject:["attributes","size"],count:w.length,array:w,itemSize:1,usage:d.DynamicDrawUsage})),o.createElement(mC.Provider,{value:x},n))})),GC=o.forwardRef((function(e,t){var n=e.children,r=(0,m.Z)(e,pC);o.useMemo((function(){return(0,s.extend)({Position:hC})}),[]);var i=o.useRef(),a=o.useContext(mC).subscribe;return o.useLayoutEffect((function(){return a(i)}),[]),o.createElement("position",(0,v.Z)({ref:(0,y.default)([t,i])},r),n)})),ZC=o.forwardRef((function(e,t){var n=e.children,r=e.positions,i=e.colors,a=e.sizes,u=e.stride,l=void 0===u?3:u,c=(0,m.Z)(e,AC),g=o.useRef(null);return(0,s.useFrame)((function(){var e=g.current.geometry.attributes;e.position.needsUpdate=!0,i&&(e.color.needsUpdate=!0),a&&(e.size.needsUpdate=!0)})),o.createElement("points",(0,v.Z)({matrixAutoUpdate:!1,ref:(0,y.default)([t,g])},c),o.createElement("bufferGeometry",null,o.createElement("bufferAttribute",{attachObject:["attributes","position"],count:r.length/l,array:r,itemSize:l,usage:d.DynamicDrawUsage}),i&&o.createElement("bufferAttribute",{attachObject:["attributes","color"],count:i.length/l,array:i,itemSize:3,usage:d.DynamicDrawUsage}),a&&o.createElement("bufferAttribute",{attachObject:["attributes","size"],count:a.length/l,array:a,itemSize:1,usage:d.DynamicDrawUsage})),n)})),wC=o.forwardRef((function(e,t){return e.positions instanceof Float32Array?o.createElement(ZC,(0,v.Z)({},e,{ref:t})):o.createElement(BC,(0,v.Z)({},e,{ref:t}))})),_C=n(1386),xC=n.n(_C);function SC(e){return RC(e.children,e.components)}function RC(e,t,n){if(n=n||[],!t[0])return e(n);function r(r){return RC(e,t.slice(1),n.concat([r]))}return"function"===typeof t[0]?t[0]({results:n,render:r}):(0,o.cloneElement)(t[0],{children:r})}SC.propTypes={children:xC().func.isRequired,components:xC().arrayOf(xC().oneOfType([xC().element,xC().func])).isRequired};var MC,WC,kC=["context","children"],VC=["children","range","limit","frames"],FC=["meshes","children"],EC=o.createContext(null),XC=new d.Matrix4,HC=new d.Matrix4,LC=new d.Matrix4,zC=new d.Color,NC=new d.Vector3,YC=new d.Quaternion,TC=new d.Vector3,KC=o.forwardRef((function(e,t){var n=e.context,r=e.children,i=(0,m.Z)(e,kC);o.useMemo((function(){return(0,s.extend)({Position:hC})}),[]);var a=o.useRef(),u=o.useContext(n||EC).subscribe;return o.useLayoutEffect((function(){return u(a)}),[]),o.createElement("position",(0,v.Z)({ref:(0,y.default)([t,a])},i),r)})),DC=o.forwardRef((function(e,t){var n=e.children,r=e.range,i=e.limit,u=void 0===i?1e3:i,l=e.frames,I=void 0===l?1/0:l,C=(0,m.Z)(e,VC),h=o.useState((function(){var e=o.createContext(null);return{context:e,instance:o.forwardRef((function(t,n){return o.createElement(KC,(0,v.Z)({context:e},t,{ref:n}))}))}})),f=(0,g.Z)(h,1)[0],p=f.context,A=f.instance,b=o.useRef(null),B=o.useState([]),G=(0,g.Z)(B,2),Z=G[0],w=G[1],_=o.useState((function(){var e=new Float32Array(16*u);for(MC=0;MC<u;MC++)LC.identity().toArray(e,16*MC);return[e,new Float32Array((0,a.Z)(new Array(3*u)).map((function(){return 1})))]})),x=(0,g.Z)(_,1),S=(0,g.Z)(x[0],2),R=S[0],M=S[1];o.useLayoutEffect((function(){b.current.count=b.current.instanceMatrix.updateRange.count=b.current.instanceColor.updateRange.count=Math.min(u,void 0!==r?r:u,Z.length)}),[Z,r]),o.useEffect((function(){b.current.instanceMatrix.needsUpdate=!0}));var W=0;(0,s.useFrame)((function(){if(I===1/0||W<I){for(b.current.updateMatrix(),b.current.updateMatrixWorld(),XC.copy(b.current.matrixWorld).invert(),MC=0;MC<Z.length;MC++)(WC=Z[MC].current).matrixWorld.decompose(NC,YC,TC),HC.compose(NC,YC,TC).premultiply(XC),HC.equals(LC.fromArray(R,16*MC))||(HC.toArray(R,16*MC),b.current.instanceMatrix.needsUpdate=!0),WC.color.equals(zC.fromArray(M,3*MC))||(WC.color.toArray(M,3*MC),b.current.instanceColor.needsUpdate=!0);W++}}));var k=o.useMemo((function(){var e={};for(MC=0;MC<Z.length;MC++){var t;Object.assign(e,null==(t=Z[MC].current)?void 0:t.__r3f.handlers)}return Object.keys(e).reduce((function(e,t){return(0,c.Z)((0,c.Z)({},e),{},(0,yr.Z)({},t,(function(e){var n,r,i,a=null==(n=Z[e.instanceId])?void 0:n.current;return null==a||null==(r=a.__r3f)||null==(i=r.handlers)?void 0:i[t]((0,c.Z)((0,c.Z)({},e),{},{object:a}))})))}),{})}),[n,Z]),V=o.useMemo((function(){return{subscribe:function(e){return w((function(t){return[].concat((0,a.Z)(t),[e])})),function(){return w((function(t){return t.filter((function(t){return t.current!==e.current}))}))}}}}),[]);return o.createElement("instancedMesh",(0,v.Z)({matrixAutoUpdate:!1,ref:(0,y.default)([t,b]),args:[null,null,0]},k,C),o.createElement("instancedBufferAttribute",{attach:"instanceMatrix",count:R.length/16,array:R,itemSize:16,usage:d.DynamicDrawUsage}),o.createElement("instancedBufferAttribute",{attach:"instanceColor",count:M.length/3,array:M,itemSize:3,usage:d.DynamicDrawUsage}),"function"===typeof n?o.createElement(p.Provider,{value:V},n(A)):o.createElement(EC.Provider,{value:V},n))}));function PC(e){var t=e.meshes,n=e.children,r=(0,m.Z)(e,FC),i=Array.isArray(t);if(!i)for(var s=0,u=Object.keys(t);s<u.length;s++){var l=u[s];t[l].isMesh||delete t[l]}return o.createElement(SC,{components:(i?t:Object.values(t)).map((function(e){var t=e.geometry,n=e.material;return o.createElement(DC,(0,v.Z)({key:t.uuid,geometry:t,material:n},r))}))},(function(e){return i?n.apply(void 0,(0,a.Z)(e)):n(Object.keys(t).filter((function(e){return t[e].isMesh})).reduce((function(t,n,r){return(0,c.Z)((0,c.Z)({},t),{},(0,yr.Z)({},n,e[r]))}),{}))}))}var UC=["limit","lineWidth","children"],OC=o.createContext(null),JC=function(e){return e instanceof d.Color?e.toArray():e},QC=function(e){return e instanceof d.Vector3?e.toArray():e},jC=o.forwardRef((function(e,t){var n=e.limit,r=void 0===n?1e3:n,i=e.lineWidth,u=void 0===i?1:i,l=e.children,c=(0,m.Z)(e,UC),I=o.useState([]),C=(0,g.Z)(I,2),h=C[0],f=C[1],p=o.useState((function(){return new Qi})),A=(0,g.Z)(p,1)[0],b=o.useState((function(){return new Ui})),y=(0,g.Z)(b,1)[0],B=o.useState((function(){return new Di})),G=(0,g.Z)(B,1)[0],Z=o.useState((function(){return new d.Vector2(512,512)})),w=(0,g.Z)(Z,1)[0],_=o.useState((function(){return Array(6*r).fill(0)})),x=(0,g.Z)(_,1)[0],S=o.useState((function(){return Array(6*r).fill(0)})),R=(0,g.Z)(S,1)[0],M=o.useMemo((function(){return{subscribe:function(e){return f((function(t){return[].concat((0,a.Z)(t),[e])})),function(){return f((function(t){return t.filter((function(t){return t.current!==e.current}))}))}}}}),[]);return(0,s.useFrame)((function(){for(var e=0;e<r;e++)for(var t,n=null==(t=h[e])?void 0:t.current,i=n?QC(n.start):[0,0,0],a=n?QC(n.end):[0,0,0],o=n?JC(n.color):[1,1,1],s=0;s<3;s++)x[6*e+s]=i[s],x[6*e+s+3]=a[s],R[6*e+s]=o[s],R[6*e+s+3]=o[s];G.setColors(R),G.setPositions(x),A.computeLineDistances()})),o.createElement("primitive",{object:A,ref:t},o.createElement("primitive",{object:G,attach:"geometry"}),o.createElement("primitive",(0,v.Z)({object:y,attach:"material",vertexColors:!0,resolution:w,linewidth:u},c)),o.createElement(OC.Provider,{value:M},l))})),qC=(0,z.Z)((function e(){(0,N.Z)(this,e),this.color=new d.Color("white"),this.start=new d.Vector3(0,0,0),this.end=new d.Vector3(0,0,0)})),$C=o.forwardRef((function(e,t){var n=o.useContext(OC);if(!n)throw"Segment must used inside Segments component.";var r=o.useRef();return o.useMemo((function(){return(0,s.extend)({SegmentObject:qC})}),[]),o.useLayoutEffect((function(){return n.subscribe(r)}),[]),o.createElement("segmentObject",(0,v.Z)({ref:(0,y.default)([r,t])},e))})),eh=["children","distances"],th=o.forwardRef((function(e,t){var n=e.children,r=e.distances,i=(0,m.Z)(e,eh),a=o.useRef(null);return o.useLayoutEffect((function(){var e=a.current;e.levels.length=0,e.children.forEach((function(t,n){return e.levels.push({object:t,distance:r[n]})}))})),(0,s.useFrame)((function(e){var t;return null==(t=a.current)?void 0:t.update(e.camera)})),o.createElement("lOD",(0,v.Z)({ref:(0,y.default)([a,t])},i),n)}));function nh(e){var t=e.all,n=e.scene,r=e.camera,i=(0,s.useThree)((function(e){return e.gl})),a=(0,s.useThree)((function(e){return e.camera})),u=(0,s.useThree)((function(e){return e.scene}));return o.useLayoutEffect((function(){var e=[];t&&(n||u).traverse((function(t){!1===t.visible&&(e.push(t),t.visible=!0)})),i.compile(n||u,r||a);var o=new d.WebGLCubeRenderTarget(128);new d.CubeCamera(.01,1e5,o).update(i,n||u),o.dispose(),e.forEach((function(e){return e.visible=!1}))}),[]),null}function rh(){var e=(0,s.useThree)((function(e){return e.gl}));return(0,o.useEffect)((function(){return e.shadowMap.autoUpdate=!1,e.shadowMap.needsUpdate=!0,function(){e.shadowMap.autoUpdate=e.shadowMap.needsUpdate=!0}}),[e.shadowMap]),null}var ih=new d.Matrix4,ah=new d.Ray,oh=new d.Sphere,sh=new d.Vector3;function uh(e,t){var n=this.geometry,r=this.material,i=this.matrixWorld;void 0!==r&&(null===n.boundingSphere&&n.computeBoundingSphere(),oh.copy(n.boundingSphere),oh.applyMatrix4(i),!1!==e.ray.intersectsSphere(oh)&&(ih.copy(i).invert(),ah.copy(e.ray).applyMatrix4(ih),null!==n.boundingBox&&null===ah.intersectBox(n.boundingBox,sh)||t.push({distance:sh.distanceTo(e.ray.origin),point:sh.clone(),object:this})))}function lh(e){var t=e.pixelated,n=(0,s.useThree)((function(e){return e.gl})),r=(0,s.useThree)((function(e){return e.internal.active})),i=(0,s.useThree)((function(e){return e.performance.current})),a=(0,s.useThree)((function(e){return e.viewport.initialDpr})),u=(0,s.useThree)((function(e){return e.setDpr}));return o.useEffect((function(){var e=n.domElement;return function(){r&&u(a),t&&e&&(e.style.imageRendering="auto")}}),[]),o.useEffect((function(){u(i*a),t&&n.domElement&&(n.domElement.style.imageRendering=1===i?"auto":"pixelated")}),[i]),null}function ch(){var e=(0,s.useThree)((function(e){return e.get})),t=(0,s.useThree)((function(e){return e.performance.current}));return o.useEffect((function(){var t=e().raycaster.enabled;return function(){e().raycaster.enabled=t}}),[]),o.useEffect((function(){e().raycaster.enabled=1===t}),[t]),null}},1539:function(e,t,n){"use strict";n.d(t,{V:function(){return b}});var r=n(1413),i=n(9439),a=n(4925),o=n(7462),s=n(4519),u=n(4453),l=n(4911),c=n(5112),g=["children","eps","style","className","prepend","center","fullscreen","portal","distanceFactor","sprite","transform","occlude","onOcclude","zIndexRange","calculatePosition","as","pointerEvents"],d=new l.Vector3,I=new l.Vector3,C=new l.Vector3;function h(e,t,n){var r=d.setFromMatrixPosition(e.matrixWorld);r.project(t);var i=n.width/2,a=n.height/2;return[r.x*i+i,-r.y*a+a]}var f=function(e){return Math.abs(e)<1e-10?0:e};function p(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r="matrix3d(",i=0;16!==i;i++)r+=f(t[i]*e.elements[i])+(15!==i?",":")");return n+r}var A,m=(A=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],function(e){return p(e,A)}),v=function(e,t){return p(e,[1/(n=t),1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1],"translate(-50%,-50%)");var n},b=s.forwardRef((function(e,t){var n,p=e.children,A=e.eps,b=void 0===A?.001:A,y=e.style,B=e.className,G=e.prepend,Z=e.center,w=e.fullscreen,_=e.portal,x=e.distanceFactor,S=e.sprite,R=void 0!==S&&S,M=e.transform,W=void 0!==M&&M,k=e.occlude,V=e.onOcclude,F=e.zIndexRange,E=void 0===F?[16777271,0]:F,X=e.calculatePosition,H=void 0===X?h:X,L=e.as,z=void 0===L?"div":L,N=e.pointerEvents,Y=void 0===N?"auto":N,T=(0,a.Z)(e,g),K=(0,c.useThree)((function(e){return e.gl})),D=(0,c.useThree)((function(e){return e.camera})),P=(0,c.useThree)((function(e){return e.scene})),U=(0,c.useThree)((function(e){return e.size})),O=(0,c.useThree)((function(e){return e.raycaster})),J=s.useState((function(){return document.createElement(z)})),Q=(0,i.Z)(J,1)[0],j=s.useRef(null),q=s.useRef(0),$=s.useRef([0,0]),ee=s.useRef(null),te=s.useRef(null),ne=null!==(n=null==_?void 0:_.current)&&void 0!==n?n:K.domElement.parentNode;s.useEffect((function(){if(j.current){if(P.updateMatrixWorld(),W)Q.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{var e=H(j.current,D,U);Q.style.cssText="position:absolute;top:0;left:0;transform:translate3d(".concat(e[0],"px,").concat(e[1],"px,0);transform-origin:0 0;")}return ne&&(G?ne.prepend(Q):ne.appendChild(Q)),function(){ne&&ne.removeChild(Q),u.unmountComponentAtNode(Q)}}}),[ne,W]);var re=s.useMemo((function(){return W?{position:"absolute",top:0,left:0,width:U.width,height:U.height,transformStyle:"preserve-3d",pointerEvents:"none"}:(0,r.Z)((0,r.Z)({position:"absolute",transform:Z?"translate3d(-50%,-50%,0)":"none"},w&&{top:-U.height/2,left:-U.width/2,width:U.width,height:U.height}),y)}),[y,Z,w,U,W]),ie=s.useMemo((function(){return{position:"absolute",pointerEvents:Y}}),[Y]);s.useLayoutEffect((function(){W?u.render(s.createElement("div",{ref:ee,style:re},s.createElement("div",{ref:te,style:ie},s.createElement("div",{ref:t,className:B,style:y,children:p}))),Q):u.render(s.createElement("div",{ref:t,style:re,className:B,children:p}),Q)}));var ae=s.useRef(!0);return(0,c.useFrame)((function(){if(j.current){D.updateMatrixWorld(),j.current.updateWorldMatrix(!0,!1);var e=W?$.current:H(j.current,D,U);if(W||Math.abs(q.current-D.zoom)>b||Math.abs($.current[0]-e[0])>b||Math.abs($.current[1]-e[1])>b){var t=function(e,t){var n=d.setFromMatrixPosition(e.matrixWorld),r=I.setFromMatrixPosition(t.matrixWorld),i=n.sub(r),a=t.getWorldDirection(C);return i.angleTo(a)>Math.PI/2}(j.current,D),n=!1;"boolean"===typeof k?!0===k&&(n=[P]):Array.isArray(k)&&(n=k.map((function(e){return e.current})));var r=ae.current;if(n){var i=function(e,t,n,r){var i=d.setFromMatrixPosition(e.matrixWorld),a=i.clone();a.project(t),n.setFromCamera(a,t);var o=n.intersectObjects(r,!0);if(o.length){var s=o[0].distance;return i.distanceTo(n.ray.origin)<s}return!0}(j.current,D,O,n);ae.current=i&&!t}else ae.current=!t;if(r!==ae.current&&(V?V(!ae.current):Q.style.display=ae.current?"block":"none"),Q.style.zIndex="".concat(function(e,t,n){if(t instanceof l.PerspectiveCamera||t instanceof l.OrthographicCamera){var r=d.setFromMatrixPosition(e.matrixWorld),i=I.setFromMatrixPosition(t.matrixWorld),a=r.distanceTo(i),o=(n[1]-n[0])/(t.far-t.near),s=n[1]-o*t.far;return Math.round(o*a+s)}}(j.current,D,E)),W){var a=U.width/2,o=U.height/2,s=D.projectionMatrix.elements[5]*o,u=D.isOrthographicCamera,c=D.top,g=D.left,h=D.bottom,p=D.right,A=m(D.matrixWorldInverse),y=u?"scale(".concat(s,")translate(").concat(f(-(p+g)/2),"px,").concat(f((c+h)/2),"px)"):"translateZ(".concat(s,"px)"),B=j.current.matrixWorld;R&&((B=D.matrixWorldInverse.clone().transpose().copyPosition(B).scale(j.current.scale)).elements[3]=B.elements[7]=B.elements[11]=0,B.elements[15]=1),Q.style.width=U.width+"px",Q.style.height=U.height+"px",Q.style.perspective=u?"":"".concat(s,"px"),ee.current&&te.current&&(ee.current.style.transform="".concat(y).concat(A,"translate(").concat(a,"px,").concat(o,"px)"),te.current.style.transform=v(B,1/((x||10)/400)))}else{var G=void 0===x?1:function(e,t){if(t instanceof l.OrthographicCamera)return t.zoom;if(t instanceof l.PerspectiveCamera){var n=d.setFromMatrixPosition(e.matrixWorld),r=I.setFromMatrixPosition(t.matrixWorld),i=t.fov*Math.PI/180,a=n.distanceTo(r);return 1/(2*Math.tan(i/2)*a)}return 1}(j.current,D)*x;Q.style.transform="translate3d(".concat(e[0],"px,").concat(e[1],"px,0) scale(").concat(G,")")}$.current=e,q.current=D.zoom}}})),s.createElement("group",(0,o.Z)({},T,{ref:j}))}))},5112:function(e,t,n){"use strict";n.r(t),n.d(t,{Canvas:function(){return Ce},ReactThreeFiber:function(){return L},_roots:function(){return be},act:function(){return Ve},addAfterEffect:function(){return oe},addEffect:function(){return ae},addTail:function(){return se},advance:function(){return Ze},applyProps:function(){return xe},context:function(){return $},createPortal:function(){return Ee},dispose:function(){return ke},events:function(){return ce},extend:function(){return J},invalidate:function(){return Ge},reconciler:function(){return _e},render:function(){return Re},unmountComponentAtNode:function(){return We},useFrame:function(){return fe},useGraph:function(){return Ae},useLoader:function(){return ve},useThree:function(){return he}});var r=n(5671),i=n(3144),a=n(136),o=n(9388),s=n(5647),u=n(4925),l=n(4942),c=n(3878),g=n(9199),d=n(181),I=n(5267);function C(e){return(0,c.Z)(e)||(0,g.Z)(e)||(0,d.Z)(e)||(0,I.Z)()}var h=n(9439),f=n(3433),p=n(1413),A=n(7762),m=n(4911),v=n(4519),b=n(5401);function y(e,t){if(Object.is(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(var r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}var B=n(438),G=n.n(B),Z=n(8514),w=n(1652),_=n(1870),x=n.n(_);function S(e){var t=void 0===e?{debounce:0,scroll:!1,offsetSize:!1}:e,n=t.debounce,a=t.scroll,o=t.polyfill,s=t.offsetSize,u=o||("undefined"===typeof window?(0,i.Z)((function e(){(0,r.Z)(this,e)})):window.ResizeObserver);if(!u)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");var l=(0,v.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=(0,h.Z)(l,2),g=c[0],d=c[1],I=(0,v.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:g}),C=n?"number"===typeof n?n:n.scroll:null,f=n?"number"===typeof n?n:n.resize:null,p=(0,v.useRef)(!1);(0,v.useEffect)((function(){return p.current=!0,function(){p.current=!1}}));var A=(0,v.useMemo)((function(){var e=function(){if(I.current.element){var e=I.current.element.getBoundingClientRect(),t={left:e.left,top:e.top,width:e.width,height:e.height,bottom:e.bottom,right:e.right,x:e.x,y:e.y};I.current.element instanceof HTMLElement&&s&&(t.height=I.current.element.offsetHeight,t.width=I.current.element.offsetWidth),Object.freeze(t),p.current&&!W(I.current.lastBounds,t)&&d(I.current.lastBounds=t)}};return[e,f?x()(e,f):e,C?x()(e,C):e]}),[d,s,C,f]),m=(0,h.Z)(A,3),b=m[0],y=m[1],B=m[2];function G(){I.current.scrollContainers&&(I.current.scrollContainers.forEach((function(e){return e.removeEventListener("scroll",B,!0)})),I.current.scrollContainers=null),I.current.resizeObserver&&(I.current.resizeObserver.disconnect(),I.current.resizeObserver=null)}function Z(){I.current.element&&(I.current.resizeObserver=new u(B),I.current.resizeObserver.observe(I.current.element),a&&I.current.scrollContainers&&I.current.scrollContainers.forEach((function(e){return e.addEventListener("scroll",B,{capture:!0,passive:!0})})))}var w,_,S;return w=B,_=Boolean(a),(0,v.useEffect)((function(){if(_){var e=w;return window.addEventListener("scroll",e,{capture:!0,passive:!0}),function(){window.removeEventListener("scroll",e,!0)}}}),[w,_]),S=y,(0,v.useEffect)((function(){var e=S;return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[S]),(0,v.useEffect)((function(){G(),Z()}),[a,B,y]),(0,v.useEffect)((function(){return G}),[]),[function(e){e&&e!==I.current.element&&(G(),I.current.element=e,I.current.scrollContainers=R(e),Z())},g,b]}function R(e){var t=[];if(!e||e===document.body)return t;var n=window.getComputedStyle(e);return[n.overflow,n.overflowX,n.overflowY].some((function(e){return"auto"===e||"scroll"===e}))&&t.push(e),[].concat(t,(0,f.Z)(R(e.parentElement)))}var M=["x","y","top","bottom","left","right","width","height"],W=function(e,t){return M.every((function(n){return e[n]===t[n]}))},k=["args"],V=["args"],F=["args"],E=["params"],X=["children","fallback","tabIndex","resize","id","style","className","events"],H=["gl","size","mode","events","onCreated"],L=Object.freeze({__proto__:null}),z={obj:function(e){return e===Object(e)&&!z.arr(e)&&"function"!==typeof e},fun:function(e){return"function"===typeof e},str:function(e){return"string"===typeof e},num:function(e){return"number"===typeof e},und:function(e){return void 0===e},arr:function(e){return Array.isArray(e)},equ:function(e,t){if(typeof e!==typeof t||!!e!==!!t)return!1;if(z.str(e)||z.num(e)||z.obj(e))return e===t;if(z.arr(e)&&e==t)return!0;var n;for(n in e)if(!(n in t))return!1;for(n in t)if(e[n]!==t[n])return!1;return!z.und(n)||e===t}};function N(e){return(e.eventObject||e.object).uuid+"/"+e.index}function Y(e){var t=new m.Vector3;function n(t){var n=e.getState().internal,r=t.offsetX-n.initialClick[0],i=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(r*r+i*i))}function r(e){return e.filter((function(e){return["Move","Over","Enter","Out","Leave"].some((function(t){var n;return null==(n=e.__r3f.handlers)?void 0:n["onPointer"+t]}))}))}function i(t){var n=e.getState().internal;Array.from(n.hovered.values()).forEach((function(e){if(!t.length||!t.find((function(t){return t.object===e.object&&t.index===e.index}))){var r=e.eventObject.__r3f.handlers;if(n.hovered.delete(N(e)),r){var i=(0,p.Z)((0,p.Z)({},e),{},{intersections:t||[]});null==r.onPointerOut||r.onPointerOut(i),null==r.onPointerLeave||r.onPointerLeave(i)}}}))}function a(e,t){t.forEach((function(t){var n;return null==(n=t.__r3f.handlers)||null==n.onPointerMissed?void 0:n.onPointerMissed(e)}))}return{handlePointer:function(o){switch(o){case"onPointerLeave":case"onPointerCancel":return function(){return i([])};case"onLostPointerCapture":return function(t){"pointerId"in t&&e.getState().internal.capturedMap.delete(t.pointerId),i([])}}return function(s){var u=e.getState(),l=u.onPointerMissed,c=u.internal;!function(t){var n,r=e.getState(),i=r.raycaster,a=r.mouse,o=r.camera,s=r.size,u=null!=(n=null==i.computeOffsets?void 0:i.computeOffsets(t,r))?n:t,l=u.offsetX,c=u.offsetY,g=s.width,d=s.height;a.set(l/g*2-1,-c/d*2+1),i.setFromCamera(a,o)}(s);var g="onPointerMove"===o,d=function(t,n){var r=e.getState().internal;return"pointerId"in n&&r.capturedMap.has(n.pointerId)&&t.push.apply(t,(0,f.Z)(r.capturedMap.get(n.pointerId).values())),t}(function(t){var n=e.getState(),r=n.raycaster,i=n.internal;if(!r.enabled)return[];var a=new Set,o=[],s=t?t(i.interaction):i.interaction,u=r.intersectObjects(s,!0).filter((function(e){var t=N(e);return!a.has(t)&&(a.add(t),!0)}));r.filter&&(u=r.filter(u,n));var l,c=(0,A.Z)(u);try{for(c.s();!(l=c.n()).done;)for(var g=l.value,d=g.object;d;){var I;(null==(I=d.__r3f)?void 0:I.handlers)&&o.push((0,p.Z)((0,p.Z)({},g),{},{eventObject:d})),d=d.parent}}catch(C){c.e(C)}finally{c.f()}return o}(g?r:void 0),s);g&&i(d),function(r,a,o){var s=e.getState(),u=s.raycaster,l=s.mouse,c=s.camera,g=s.internal;r.length&&function(){var e,s=t.set(l.x,l.y,0).unproject(c),d="click"===a.type?n(a):0,I=function(e){return a.target.releasePointerCapture(e)},C={stopped:!1},h=(0,A.Z)(r);try{var m=function(){var t=e.value,n=function(e){var n,r;return null!=(n=null==(r=g.capturedMap.get(e))?void 0:r.has(t.eventObject))&&n},h=function(e){g.capturedMap.has(e)?g.capturedMap.get(e).set(t.eventObject,t):g.capturedMap.set(e,new Map([[t.eventObject,t]])),a.target.setPointerCapture(e)},A={};for(var m in Object.getPrototypeOf(a)){var v=a[m];"function"!==typeof v&&(A[m]=v)}var b=(0,p.Z)((0,p.Z)((0,p.Z)({},t),A),{},{spaceX:l.x,spaceY:l.y,intersections:r,stopped:C.stopped,delta:d,unprojectedPoint:s,ray:u.ray,camera:c,stopPropagation:function(){var e="pointerId"in a&&g.capturedMap.get(a.pointerId);if((!e||e.has(t.eventObject))&&(b.stopped=C.stopped=!0,g.hovered.size&&Array.from(g.hovered.values()).find((function(e){return e.eventObject===t.eventObject})))){var n=r.slice(0,r.indexOf(t));i([].concat((0,f.Z)(n),[t]))}},target:{hasPointerCapture:n,setPointerCapture:h,releasePointerCapture:I},currentTarget:{hasPointerCapture:n,setPointerCapture:h,releasePointerCapture:I},sourceEvent:a,nativeEvent:a});if(o(b),!0===C.stopped)return"break"};for(h.s();!(e=h.n()).done&&"break"!==m(););}catch(v){h.e(v)}finally{h.f()}}()}(d,s,(function(e){var t=e.eventObject,n=t.__r3f.handlers;if(n)if(g){if(n.onPointerOver||n.onPointerEnter||n.onPointerOut||n.onPointerLeave){var r=N(e),i=c.hovered.get(r);i?i.stopped&&e.stopPropagation():(c.hovered.set(r,e),null==n.onPointerOver||n.onPointerOver(e),null==n.onPointerEnter||n.onPointerEnter(e))}null==n.onPointerMove||n.onPointerMove(e)}else{var u=null==n?void 0:n[o];u&&("onClick"!==o&&"onContextMenu"!==o&&"onDoubleClick"!==o||c.initialHits.includes(t))&&(u(e),a(s,c.interaction.filter((function(e){return e!==t}))))}})),"onPointerDown"===o&&(c.initialClick=[s.offsetX,s.offsetY],c.initialHits=d.map((function(e){return e.eventObject}))),"onClick"!==o&&"onContextMenu"!==o&&"onDoubleClick"!==o||d.length||n(s)<=2&&(a(s,c.interaction),l&&l(s))}}}}var T=function(e){return e&&!!e.getState},K=function(e,t){var n,r;return{root:T(e)?e:null!=(n=null==(r=e.__r3f)?void 0:r.root)?n:t.__r3f.root,container:T(e)?e.getState().scene:e}},D="__default",P={},U=["children","key","ref"],O={},J=function(e){O=(0,p.Z)((0,p.Z)({},O),e)};function Q(e,t){var n=e;return(null!=t&&t.instance||!n.__r3f)&&(n.__r3f=(0,p.Z)({root:null,memoizedProps:{},objects:[]},t)),e}var j,q=function(e){return e&&e.isOrthographicCamera},$=v.createContext(null),ee=function(e,t,n,r){var i=r.gl,a=r.size,o=r.shadows,s=void 0!==o&&o,l=r.linear,c=void 0!==l&&l,g=r.flat,d=void 0!==g&&g,I=r.vr,C=void 0!==I&&I,h=r.orthographic,A=void 0!==h&&h,v=r.frameloop,B=void 0===v?"always":v,G=r.dpr,Z=void 0===G?1:G,w=r.performance,_=r.clock,x=void 0===_?new m.Clock:_,S=r.raycaster,R=r.camera,M=r.onPointerMissed;s&&(i.shadowMap.enabled=!0,"object"===typeof s?Object.assign(i.shadowMap,s):i.shadowMap.type=m.PCFSoftShadowMap),c||(d||(i.toneMapping=m.ACESFilmicToneMapping),i.outputEncoding=m.sRGBEncoding),"never"===B&&(x.stop(),x.elapsedTime=0);var W=(0,b.Z)((function(a,o){var s=new m.Raycaster,l=S||{},g=l.params,I=(0,u.Z)(l,E);e(s,(0,p.Z)((0,p.Z)({enabled:!0},I),{},{params:(0,p.Z)((0,p.Z)({},s.params),g)}),{});var h=R instanceof m.Camera,v=h?R:A?new m.OrthographicCamera(0,0,0,0,.1,1e3):new m.PerspectiveCamera(75,0,.1,1e3);function b(e){return Array.isArray(e)?Math.min(Math.max(e[0],window.devicePixelRatio),e[1]):e}h||(v.position.z=5,R&&e(v,R,{}),v.lookAt(0,0,0));var y=b(Z),G=new m.Vector3,_=new m.Vector3;function W(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o().size,r=n.width,i=n.height,a=r/i,s=e.getWorldPosition(G).distanceTo(t);if(q(e))return{width:r/e.zoom,height:i/e.zoom,factor:1,distance:s,aspect:a};var u=e.fov*Math.PI/180,l=2*Math.tan(u/2)*s,c=l*(r/i);return{width:c,height:l,factor:r/c,distance:s,aspect:a}}var k=void 0,V=function(e){return a((function(t){return{performance:(0,p.Z)((0,p.Z)({},t.performance),{},{current:e})}}))};return{gl:i,set:a,get:o,invalidate:function(){return t(o())},advance:function(e,t){return n(e,t,o())},linear:c,flat:d,scene:Q(new m.Scene),camera:v,raycaster:s,clock:x,mouse:new m.Vector2,vr:C,frameloop:B,onPointerMissed:M,performance:(0,p.Z)((0,p.Z)({current:1,min:.5,max:1,debounce:200},w),{},{regress:function(){var e=o();k&&clearTimeout(k),e.performance.current!==e.performance.min&&V(e.performance.min),k=setTimeout((function(){return V(o().performance.max)}),e.performance.debounce)}}),size:{width:0,height:0},viewport:{initialDpr:y,dpr:y,width:0,height:0,aspect:0,distance:0,factor:0,getCurrentViewport:W},setSize:function(e,t){var n={width:e,height:t};a((function(e){return{size:n,viewport:(0,p.Z)((0,p.Z)({},e.viewport),W(v,_,n))}}))},setDpr:function(e){return a((function(t){return{viewport:(0,p.Z)((0,p.Z)({},t.viewport),{},{dpr:b(e)})}}))},events:{connected:!1},internal:{active:!1,priority:0,frames:0,lastProps:r,interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return a((function(n){var r=n.internal;return{internal:(0,p.Z)((0,p.Z)({},r),{},{priority:r.priority+(t?1:0),subscribers:[].concat((0,f.Z)(r.subscribers),[{ref:e,priority:t}]).sort((function(e,t){return e.priority-t.priority}))})}})),function(){a((function(n){var r=n.internal;return{internal:(0,p.Z)((0,p.Z)({},r),{},{priority:r.priority-(t?1:0),subscribers:r.subscribers.filter((function(t){return t.ref!==e}))})}}))}}}}}));W.subscribe((function(){var e=W.getState(),t=e.camera,n=e.size,r=e.viewport;e.internal.lastProps.camera instanceof m.Camera||(q(t)?(t.left=n.width/-2,t.right=n.width/2,t.top=n.height/2,t.bottom=n.height/-2):t.aspect=n.width/n.height,t.updateProjectionMatrix(),t.updateMatrixWorld()),i.setPixelRatio(r.dpr),i.setSize(n.width,n.height)}),(function(e){return[e.viewport.dpr,e.size]}),y);var k=W.getState();return a&&k.setSize(a.width,a.height),W.subscribe((function(e){return t(e)})),W};function te(e,t){var n=t.length;return t.push(e),function(){t.splice(n,1)}}var ne=[],re=[],ie=[],ae=function(e){return te(e,ne)},oe=function(e){return te(e,re)},se=function(e){return te(e,ie)};function ue(e,t){for(j=0;j<e.length;j++)e[j](t)}function le(e,t){var n=t.clock.getDelta();for("never"===t.frameloop&&"number"===typeof e&&(n=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),j=0;j<t.internal.subscribers.length;j++)t.internal.subscribers[j].ref.current(t,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function ce(e){var t=Y(e).handlePointer,n={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};return{connected:!1,handlers:Object.keys(n).reduce((function(e,n){return(0,p.Z)((0,p.Z)({},e),{},(0,l.Z)({},n,t(n)))}),{}),connect:function(t){var r,i=e.getState(),a=i.set,o=i.events;null==o.disconnect||o.disconnect(),a((function(e){return{events:(0,p.Z)((0,p.Z)({},e.events),{},{connected:t})}})),Object.entries(null!=(r=null==o?void 0:o.handlers)?r:[]).forEach((function(e){var r=(0,h.Z)(e,2),i=r[0],a=r[1],o=(0,h.Z)(n[i],2),s=o[0],u=o[1];t.addEventListener(s,a,{passive:u})}))},disconnect:function(){var t,r=e.getState(),i=r.set,a=r.events;a.connected&&(Object.entries(null!=(t=a.handlers)?t:[]).forEach((function(e){var t=(0,h.Z)(e,2),r=t[0],i=t[1];if(a&&a.connected instanceof HTMLElement){var o=(0,h.Z)(n[r],1)[0];a.connected.removeEventListener(o,i)}})),i((function(e){return{events:(0,p.Z)((0,p.Z)({},e.events),{},{connected:!1})}})))}}}var ge="undefined"!==typeof window?v.useLayoutEffect:v.useEffect;function de(e){var t=e.set;return ge((function(){return t(new Promise((function(){return null}))),function(){return t(!1)}}),[]),null}var Ie=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={error:!1},e}return(0,i.Z)(n,[{key:"componentDidCatch",value:function(e){this.props.set(e)}},{key:"render",value:function(){return this.state.error?null:this.props.children}}]),n}(v.Component);function Ce(e){var t=e.children,n=e.fallback,r=e.tabIndex,i=e.resize,a=e.id,o=e.style,s=e.className,l=e.events,c=(0,u.Z)(e,X),g=S((0,p.Z)({scroll:!0,debounce:{scroll:50,resize:0}},i)),d=(0,h.Z)(g,2),I=d[0],C=d[1],f=v.useRef(null),A=v.useState(!1),m=(0,h.Z)(A,2),b=m[0],y=m[1],B=v.useState(!1),G=(0,h.Z)(B,2),Z=G[0],w=G[1];if(b)throw b;if(Z)throw Z;return ge((function(){C.width>0&&C.height>0&&Re(v.createElement(Ie,{set:w},v.createElement(v.Suspense,{fallback:v.createElement(de,{set:y})},t)),f.current,(0,p.Z)((0,p.Z)({},c),{},{size:C,events:l||ce}))}),[C,t]),ge((function(){var e=f.current;return function(){return We(e)}}),[]),v.createElement("div",{ref:I,id:a,className:s,tabIndex:r,style:(0,p.Z)({position:"relative",width:"100%",height:"100%",overflow:"hidden"},o)},v.createElement("canvas",{ref:f,style:{display:"block"}},n))}function he(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=arguments.length>1?arguments[1]:void 0,n=v.useContext($);if(!n)throw"R3F hooks can only be used within the Canvas component!";return n(e,t)}function fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=v.useContext($).getState().internal.subscribe,r=v.useRef(e);return v.useLayoutEffect((function(){r.current=e}),[e]),v.useLayoutEffect((function(){var e=n(r,t);return function(){return e()}}),[t,n]),null}function pe(e){var t={nodes:{},materials:{}};return e&&e.traverse((function(e){e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)})),t}function Ae(e){return v.useMemo((function(){return pe(e)}),[e])}function me(e,t){return function(n){var r=new n;e&&e(r);for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];return Promise.all(a.map((function(e){return new Promise((function(n,i){return r.load(e,(function(e){e.scene&&Object.assign(e,pe(e.scene)),n(e)}),t,(function(t){return i("Could not load ".concat(e,": ").concat(t.message))}))}))})))}}function ve(e,t,n,r){var i=Array.isArray(t)?t:[t],a=w.G.apply(void 0,[me(n,r),e].concat((0,f.Z)(i)));return Array.isArray(t)?a:a[0]}Ie.getDerivedStateFromError=function(){return{error:!0}},ve.preload=function(e,t,n){var r=Array.isArray(t)?t:[t];return w.G.preload.apply(w.G,[me(n),e].concat((0,f.Z)(r)))};var be=new Map,ye=["legacy","blocking","concurrent"],Be=function(e){var t,n=!1;function r(i){if(n=!0,t=0,ue(ne,i),e.forEach((function(e){var n=e.store.getState();n.internal.active&&("always"===n.frameloop||n.internal.frames>0)&&(t+=le(i,n))})),ue(re,i),t>0)return requestAnimationFrame(r);ue(ie,i),n=!1}return{loop:r,invalidate:function t(i){if(!i)return e.forEach((function(e){return t(e.store.getState())}));!i.vr&&i.internal.active&&"never"!==i.frameloop&&(i.internal.frames=Math.min(60,i.internal.frames+1),n||(n=!0,requestAnimationFrame(r)))},advance:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;n&&ue(ne,t),r?le(t,r):e.forEach((function(e){return le(t,e.store.getState())})),n&&ue(re,t)}}}(be),Ge=Be.invalidate,Ze=Be.advance,we=function(e){function t(e,t){var i,a,o,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=null!=(i=null==e?void 0:e.__r3f)?i:{},g=c.root,d=null!=(a=null==g||null==g.getState?void 0:g.getState())?a:{},I=[],A=[],v={},b=0;Object.entries(t).forEach((function(e){var t=(0,h.Z)(e,2),n=t[0],r=t[1];-1===U.indexOf(n)&&(v[n]=r)})),c.memoizedProps&&c.memoizedProps.args&&(v.args=c.memoizedProps.args),c.memoizedProps&&c.memoizedProps.attach&&(v.attach=c.memoizedProps.attach),e.__r3f&&(e.__r3f.memoizedProps=v);var y=Object.keys(t);for(b=0;b<y.length;b++)z.equ(t[y[b]],s[y[b]])&&I.push(y[b]),z.fun(t[y[b]])&&/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(y[b])&&A.push(y[b]);var B=[];if(u)for(y=Object.keys(s),b=0;b<y.length;b++)t.hasOwnProperty(y[b])||B.push(y[b]);var G=[].concat(I,U);null!=(o=e.__r3f)&&o.instance&&G.push("object");var Z=(0,p.Z)({},t);for(y=Object.keys(Z),b=0;b<y.length;b++)G.indexOf(y[b])>-1&&delete Z[y[b]];var w=Object.entries(Z);for(b=0;b<B.length;b++)"children"!==B[b]&&w.unshift([B[b],D+"remove"]);if(w.length>0){if(w.forEach((function(t){var r=(0,h.Z)(t,2),i=r[0],a=r[1];if(!A.includes(i)){var o,s=e,u=s[i];if(i.includes("-")){var l=i.split("-");if(u=l.reduce((function(e,t){return e[t]}),e),!u||!u.set){var c=C(l.reverse()),g=c[0];s=c.slice(1).reverse().reduce((function(e,t){return e[t]}),e),i=g}}if(a===D+"remove")if(u&&u.constructor)a=new u.constructor(v.args);else if(s.constructor){var I=new s.constructor(s.__r3f.memoizedProps.args);a=I[u],I.dispose&&I.dispose()}else a=0;if(u&&u.set&&(u.copy||u instanceof m.Layers)){if(Array.isArray(a))if(u.fromArray)u.fromArray(a);else(o=u).set.apply(o,(0,f.Z)(a));else if(u.copy&&a&&a.constructor&&u.constructor.name===a.constructor.name)u.copy(a);else if(void 0!==a){var p=u instanceof m.Color;!p&&u.setScalar?u.setScalar(a):u instanceof m.Layers&&a instanceof m.Layers?u.mask=a.mask:u.set(a),!d.linear&&p&&u.convertSRGBToLinear()}}else s[i]=a,!d.linear&&s[i]instanceof m.Texture&&(s[i].encoding=m.sRGBEncoding);n(e)}})),u&&g&&e.raycast&&c.handlers){c.handlers=void 0;var _=d.internal.interaction.indexOf(e);_>-1&&d.internal.interaction.splice(_,1)}A.length&&(u&&g&&e.raycast&&d.internal.interaction.push(e),c.handlers=A.reduce((function(e,n){return(0,p.Z)((0,p.Z)({},e),{},(0,l.Z)({},n,t[n]))}),{})),e.parent&&r(e)}}function n(e){var t,n,r=null==(t=e.__r3f)||null==(n=t.root)||null==n.getState?void 0:n.getState();r&&0===r.internal.frames&&r.invalidate()}function r(e){null==e.onUpdate||e.onUpdate(e)}function i(e,n,r,i,a){var o,l=n.args,c=void 0===l?[]:l,g=(0,u.Z)(n,k),d="".concat(e[0].toUpperCase()).concat(e.slice(1));if(!T(r)&&a){r=function e(t){return t.return?e(t.return):t.stateNode&&t.stateNode.containerInfo}(a)}if(!r||!T(r))throw"No valid root for ".concat(d,"!");if("primitive"===e){if(void 0===g.object)throw"Primitives without 'object' are invalid!";o=Q(g.object,{root:r,instance:!0})}else{var I=O[d]||m[d];if(!I)throw"".concat(d," is not part of the THREE namespace! Did you forget to extend? See: https://github.com/pmndrs/react-three-fiber/blob/master/markdown/api.md#using-3rd-party-objects-declaratively");var C=z.arr(c);o=Q(C?(0,s.Z)(I,(0,f.Z)(c)):new I(c),{root:r,memoizedProps:{args:C&&0===c.length?null:c}})}return d.endsWith("Geometry")?g=(0,p.Z)({attach:"geometry"},g):d.endsWith("Material")&&(g=(0,p.Z)({attach:"material"},g)),t(o,g,{}),o}function a(e,t){var i=!1;t&&(t.attachArray?(z.arr(e[t.attachArray])||(e[t.attachArray]=[]),e[t.attachArray].push(t)):t.attachObject?(z.obj(e[t.attachObject[0]])||(e[t.attachObject[0]]={}),e[t.attachObject[0]][t.attachObject[1]]=t):t.attach&&!z.fun(t.attach)?e[t.attach]=t:t.isObject3D&&(e.add(t),i=!0),i||(e.__r3f.objects.push(t),t.parent=e),r(t),n(t))}function o(e,t,i){var o=!1;if(t){if(t.attachArray){var s=e[t.attachArray];z.arr(s)||(e[t.attachArray]=[]),s.splice(s.indexOf(i),0,t)}else{if(t.attachObject||t.attach&&!z.fun(t.attach))return o=!0,a(e,t);if(t.isObject3D){t.parent=e,t.dispatchEvent({type:"added"});var u=e.children.filter((function(e){return e!==t})),l=u.indexOf(i);e.children=[].concat((0,f.Z)(u.slice(0,l)),[t],(0,f.Z)(u.slice(l))),o=!0}}o||(e.__r3f.objects.push(t),t.parent=e),r(t),n(t)}}function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&(0,f.Z)(e).forEach((function(e){return g(t,e,n)}))}function g(e,t,r){if(t){var i;if(e.__r3f.objects){var a=e.__r3f.objects.length;e.__r3f.objects=e.__r3f.objects.filter((function(e){return e!==t})),e.__r3f.objects.length<a&&(t.parent=null)}if(t.attachArray)e[t.attachArray]=e[t.attachArray].filter((function(e){return e!==t}));else if(t.attachObject)delete e[t.attachObject[0]][t.attachObject[1]];else if(t.attach&&!z.fun(t.attach))e[t.attach]=null;else if(t.isObject3D){var o;e.remove(t),null!=(o=t.__r3f)&&o.root&&function(e,t){var n=e.getState().internal;n.interaction=n.interaction.filter((function(e){return e!==t})),n.initialHits=n.initialHits.filter((function(e){return e!==t})),n.hovered.forEach((function(e,r){e.eventObject!==t&&e.object!==t||n.hovered.delete(r)}))}(t.__r3f.root,t)}var s,u=null==(i=t.__r3f)?void 0:i.instance,l=void 0===r?null!==t.dispose&&!u:r;if(!u)c(null==(s=t.__r3f)?void 0:s.objects,t,l),c(t.children,t,l);t.__r3f&&(delete t.__r3f.root,delete t.__r3f.objects,delete t.__r3f.handlers,delete t.__r3f.memoizedProps,u||delete t.__r3f),l&&t.dispose&&"Scene"!==t.type&&(0,Z.unstable_runWithPriority)(Z.unstable_IdlePriority,(function(){return t.dispose()})),n(e)}}function d(e,t,n,r){var o=e.parent;if(o){var s=i(t,n,e.__r3f.root);e.children&&(e.children.forEach((function(e){return a(s,e)})),e.children=[]),e.__r3f.objects.forEach((function(e){return a(s,e)})),e.__r3f.objects=[],g(o,e),a(o,s),[r,r.alternate].forEach((function(e){null!==e&&(e.stateNode=s,e.ref&&("function"===typeof e.ref?e.ref(s):e.ref.current=s))}))}}return{reconciler:G()({now:Z.unstable_now,createInstance:i,removeChild:g,appendChild:a,appendInitialChild:a,insertBefore:o,warnsIfNotActing:!0,supportsMutation:!0,isPrimaryRenderer:!1,scheduleTimeout:z.fun(setTimeout)?setTimeout:void 0,cancelTimeout:z.fun(clearTimeout)?clearTimeout:void 0,setTimeout:z.fun(setTimeout)?setTimeout:void 0,clearTimeout:z.fun(clearTimeout)?clearTimeout:void 0,noTimeout:-1,appendChildToContainer:function(e,t){var n=K(e,t),r=n.container,i=n.root;r.__r3f.root=i,a(r,t)},removeChildFromContainer:function(e,t){g(K(e,t).container,t)},insertInContainerBefore:function(e,t,n){o(K(e,t).container,t,n)},commitUpdate:function(e,n,r,i,a,o){if(e.__r3f.instance&&a.object&&a.object!==e)d(e,r,a,o);else{var s=a.args,l=void 0===s?[]:s,c=(0,u.Z)(a,V),g=i.args,I=void 0===g?[]:g,C=(0,u.Z)(i,F);l.some((function(e,t){return z.obj(e)?Object.entries(e).some((function(e){var n=(0,h.Z)(e,2),r=n[0];return n[1]!==I[t][r]})):e!==I[t]}))?d(e,r,a,o):t(e,c,C,!0)}},hideInstance:function(e){e.isObject3D&&(e.visible=!1,n(e))},unhideInstance:function(e,t){(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0,n(e))},hideTextInstance:function(){throw new Error("Text is not allowed in the R3F tree.")},getPublicInstance:function(e){return e},getRootHostContext:function(e){return P},getChildHostContext:function(e){return P},createTextInstance:function(){},finalizeInitialChildren:function(e){return!!e.__r3f.handlers},commitMount:function(e){e.raycast&&e.__r3f.handlers&&e.__r3f.root.getState().internal.interaction.push(e)},prepareUpdate:function(){return P},shouldDeprioritizeSubtree:function(){return!1},prepareForCommit:function(){return null},preparePortalMount:function(){},resetAfterCommit:function(){},shouldSetTextContent:function(){return!1},clearContainer:function(){return!1}}),applyProps:t}}(),_e=we.reconciler,xe=we.applyProps,Se=function(e,t){return(n=e)&&n.render?e:new m.WebGLRenderer((0,p.Z)({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0},e));var n};function Re(e,t){var n,r,i,a,o,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=s.gl,c=s.size,g=s.mode,d=void 0===g?ye[1]:g,I=s.events,C=s.onCreated,h=(0,u.Z)(s,H);c||(c={width:null!=(r=null==(i=t.parentElement)?void 0:i.clientWidth)?r:0,height:null!=(a=null==(o=t.parentElement)?void 0:o.clientHeight)?a:0});var f=be.get(t),A=null==f?void 0:f.fiber,m=null==f?void 0:f.store,b=null==(n=m)?void 0:n.getState();if(A&&b){var y=b.internal.lastProps;void 0===h.dpr||z.equ(y.dpr,h.dpr)||b.setDpr(h.dpr),void 0===c||z.equ(y.size,c)||b.setSize(c.width,c.height);var B=h.linear!==y.linear;B&&(We(t),A=void 0)}if(!A){var G=Se(l,t);h.vr&&(G.xr.enabled=!0,G.setAnimationLoop((function(e){return Ze(e,!0)})));var Z=(m=ee(xe,Ge,Ze,(0,p.Z)({gl:G,size:c},h))).getState();Z.get,A=_e.createContainer(m,ye.indexOf(d),!1,null),be.set(t,{fiber:A,store:m}),I&&Z.set({events:I(m)})}if(m&&A)return _e.updateContainer(v.createElement(Me,{store:m,element:e,onCreated:C,target:t}),A,null,(function(){})),m;throw"Error creating root!"}function Me(e){var t=e.store,n=e.element,r=e.onCreated,i=e.target;return v.useEffect((function(){var e=t.getState();e.set((function(e){return{internal:(0,p.Z)((0,p.Z)({},e.internal),{},{active:!0})}})),null==e.events.connect||e.events.connect(i),r&&r(e)}),[]),v.createElement($.Provider,{value:t},n)}function We(e,t){var n=be.get(e),r=null==n?void 0:n.fiber;if(r){var i=null==n?void 0:n.store.getState();i&&(i.internal.active=!1),_e.updateContainer(null,r,null,(function(){i&&setTimeout((function(){var n,r,a;null==i.events.disconnect||i.events.disconnect(),null==(n=i.gl)||null==(r=n.renderLists)||null==r.dispose||r.dispose(),null==(a=i.gl)||null==a.forceContextLoss||a.forceContextLoss(),ke(i),be.delete(e),t&&t(e)}),500)}))}}function ke(e){for(var t in e.dispose&&"Scene"!==e.type&&e.dispose(),e){var n,r;null==(n=(r=t).dispose)||n.call(r),delete e[t]}}var Ve=_e.act,Fe=z.fun(Symbol)&&Symbol.for?Symbol.for("react.portal"):60106;function Ee(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Fe,key:null==r?null:""+r,children:e,containerInfo:Q(t),implementation:n}}_e.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:"17.0.2"})},9138:function(e,t,n){"use strict";var r=n(7757),i=n(4575).default,a=n(3913).default,o=n(6525).default,s=n(9754).default,u=n(2205).default,l=n(9842).default,c=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CameraSource=void 0;var g=n(633),d=n(5729),I=n(4985),C=n(5756),h=n(7117),f=1,p=new Map,A=document.createElement("video");A.setAttribute("playsinline",""),A.setAttribute("webkit-playsinline",""),d.profile.videoElementInDOM&&(A.style.width="0px",A.style.height="0px",document.body.appendChild(A));var m=function(e){u(n,e);var t=l(n);function n(e,r,a){var o;return i(this,n),(o=t.call(this,A,r))._impl=e,o._deviceId=a,o._currentStream=null,o._activeDeviceId=null,o._hasStartedOrientation=!1,o._deviceMotionListener=function(e){var t=I.Pipeline.get(o._pipeline);if(t){var n=void 0!==e.timeStamp&&null!==e.timeStamp?e.timeStamp:performance.now();null!==e.accelerationIncludingGravity&&null!==e.accelerationIncludingGravity.x&&null!==e.accelerationIncludingGravity.y&&null!==e.accelerationIncludingGravity.z&&t.motionAccelerometerSubmit(n,e.accelerationIncludingGravity.x*d.profile.deviceMotionMutliplier,e.accelerationIncludingGravity.y*d.profile.deviceMotionMutliplier,e.accelerationIncludingGravity.z*d.profile.deviceMotionMutliplier),null===e.rotationRate||null===e.rotationRate.alpha||null===e.rotationRate.beta||null===e.rotationRate.gamma||o._hasStartedOrientation?o._hasStartedOrientation||o._startDeviceOrientation():(e.timeStamp,t.motionRotationRateSubmit(n,e.rotationRate.alpha*Math.PI/-180,e.rotationRate.beta*Math.PI/-180,e.rotationRate.gamma*Math.PI/-180))}},o}return a(n,[{key:"destroy",value:function(){p.delete(this._impl),o(s(n.prototype),"destroy",this).call(this)}},{key:"_stop",value:function(){this._currentStream&&(this._currentStream.getTracks().forEach((function(e){return e.stop()})),this._currentStream=null)}},{key:"pause",value:function(){o(s(n.prototype),"pause",this).call(this),this._stopDeviceMotion(),this._syncCamera()}},{key:"start",value:function(){o(s(n.prototype),"start",this).call(this),this._startDeviceMotion(),this._syncCamera()}},{key:"_getConstraints",value:function(){return c(this,void 0,void 0,r.mark((function e(){var t,i,a,o,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._deviceId!==n.DEFAULT_DEVICE_ID&&this._deviceId!==n.USER_DEFAULT_DEVICE_ID?t=this._deviceId:i=this._deviceId===n.DEFAULT_DEVICE_ID?"environment":"user",a={audio:!1,video:{facingMode:i,width:d.profile.videoWidth,height:d.profile.videoHeight,frameRate:d.profile.requestHighFrameRate?60:void 0,deviceId:t}},!t){e.next=4;break}return e.abrupt("return",a);case 4:if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){e.next=6;break}return e.abrupt("return",a);case 6:return e.next=8,navigator.mediaDevices.enumerateDevices();case 8:if(o=e.sent,s=!1,o=o.filter((function(e){if("videoinput"!==e.kind)return!1;if(e.getCapabilities){s=!0;var t=e.getCapabilities();if(t&&t.facingMode&&t.facingMode.indexOf("user"===i?"user":"environment")<0)return!1}return!0})),s&&0!==o.length){e.next=13;break}return e.abrupt("return",a);case 13:return"object"===typeof a.video&&(h.zcout("choosing device ID",o[o.length-1].deviceId),a.video.deviceId=o[o.length-1].deviceId),e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this)})))}},{key:"getFrame",value:function(e){return this._cameraToScreenRotation=C.cameraRotationForScreenOrientation(!1),o(s(n.prototype),"getFrame",this).call(this,e)}},{key:"_getUserMedia",value:function(){return c(this,void 0,void 0,r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getConstraints();case 2:if(t=e.sent,!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){e.next=7;break}return e.next=6,navigator.mediaDevices.getUserMedia(t);case 6:case 9:return e.abrupt("return",e.sent);case 7:return e.next=9,new Promise((function(e,n){navigator.getUserMedia(t,e,n)}));case 10:case"end":return e.stop()}}),e,this)})))}},{key:"_syncCamera",value:function(){return c(this,void 0,void 0,r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._currentStream||!this._isPaused){e.next=3;break}return this._stop(),e.abrupt("return");case 3:if(this._currentStream&&this._activeDeviceId!==this._deviceId&&this._stop(),this._isPaused){e.next=22;break}return this._activeDeviceId=this._deviceId,e.next=8,this._getUserMedia();case 8:if(this._currentStream=e.sent,!this._isPaused){e.next=13;break}return e.next=12,this._syncCamera();case 12:return e.abrupt("return");case 13:if(this._isUserFacing=!1,this._currentStream&&(t=this._currentStream.getVideoTracks()).length>0&&(this._isUserFacing="user"===t[0].getSettings().facingMode),this._video instanceof HTMLVideoElement){e.next=17;break}return e.abrupt("return");case 17:this._video.src="",this._video.loop=!1,this._video.muted=!0,this._video.srcObject=this._currentStream,this._video.play();case 22:case"end":return e.stop()}}),e,this)})))}},{key:"_startDeviceOrientation",value:function(){var e=this;this._hasStartedOrientation||(this._hasStartedOrientation=!0,window.addEventListener("deviceorientation",(function(t){var n=I.Pipeline.get(e._pipeline);if(n){var r=void 0!==t.timeStamp&&null!==t.timeStamp?t.timeStamp:performance.now();null!==t.alpha&&null!==t.beta&&null!==t.gamma&&n.motionAttitudeSubmit(r,t.alpha,t.beta,t.gamma)}})))}},{key:"_startDeviceMotion",value:function(){window.addEventListener("devicemotion",this._deviceMotionListener,!1)}},{key:"_stopDeviceMotion",value:function(){window.removeEventListener("devicemotion",this._deviceMotionListener)}}],[{key:"create",value:function(e,t){var r=f++;return p.set(r,new n(r,e,t)),h.zcout("camera_source_t initialized"),r}},{key:"get",value:function(e){return p.get(e)}}]),n}(g.HTMLElementSource);t.CameraSource=m,m.USER_DEFAULT_DEVICE_ID="Simulated User Default Device ID: a908df7f-5661-4d20-b227-a1c15d2fdb4b",m.DEFAULT_DEVICE_ID="Simulated Default Device ID: a908df7f-5661-4d20-b227-a1c15d2fdb4b"},5756:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cameraRotationForScreenOrientation=t.projectionMatrix=void 0;var r=n(2e3);function i(e){if(window.screen.orientation)switch(window.screen.orientation.type){case"portrait-primary":return e?90:270;case"landscape-secondary":return 180;case"portrait-secondary":return e?270:90;default:return 0}else if(void 0!==window.orientation)switch(window.orientation){case 0:return e?90:270;case 90:return 0;case 180:return e?270:90;case-90:return 180}return 0}t.projectionMatrix=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.01,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,s=2*e[2],u=2*e[3],l=r.mat4.create();r.mat4.frustum(l,a*(-.5-e[2])/e[0],a*(s-.5-e[2])/e[0],a*(u-.5-e[3])/e[1],a*(-.5-e[3])/e[1],a,o),l[4]*=-1,l[5]*=-1,l[6]*=-1,l[7]*=-1;var c=r.mat4.create();r.mat4.fromScaling(c,[.5*s,.5*u,1]),r.mat4.multiply(l,c,l),r.mat4.fromRotation(c,i(!1)*Math.PI/180,[0,0,1]),r.mat4.multiply(l,c,l);var g=r.vec3.create();g[0]=s,g[1]=u,g[2]=0,r.vec3.transformMat4(g,g,c);var d=Math.abs(g[0]),I=Math.abs(g[1]),C=1;return C=d/t>I/n?n/I:t/d,r.mat4.fromScaling(c,[C,C,1]),r.mat4.multiply(l,c,l),r.mat4.fromScaling(c,[2/t,2/n,1]),r.mat4.multiply(l,c,l),r.mat4.fromRotation(c,i(!1)*Math.PI/-180,[0,0,1]),r.mat4.multiply(l,l,c),l},t.cameraRotationForScreenOrientation=i},3262:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={incompatible:function(){return!("function"===typeof Promise&&"object"===typeof WebAssembly&&(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&navigator.mediaDevices.getUserMedia))},incompatible_ui:function(){var e=document.createElement("div");e.append(function(){var e=document.createElement("div"),t="a recent web browser";navigator.userAgent.match(/Android/i)?(t="Chrome for Android",window.location.href="googlechrome://navigate?url="+encodeURI(window.location.href),setTimeout((function(){window.location.href="samsunginternet://open?url="+encodeURI(window.location.href)}),2e3)):navigator.userAgent.match(/iPhone|iPod|iPad/i)&&(t="Safari",e.classList.add("zee-launcher-browser-safari")),e.classList.add("zee-launcher-unsupported"),e.innerHTML="\n            <style>.zee-launcher-unsupported {\n               display: flex;\n               flex-direction: column;\n               height: 100%;\n               justify-content: center;\n               position: absolute;\n               width: 100%;\n               height: 100%;\n               top: 0;\n               left: 0;\n               align-items: center;\n               }\n               .zee-launcher-browser-logo {\n               background-image: url(\"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg version='1.1' viewBox='0 0 210 211' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg transform='translate(-82 -146)' fill-rule='nonzero' stroke='%23ffffff' stroke-width='2'%3E%3Cg transform='translate(83 146.5)'%3E%3Cpath d='m55.146 88.785l-32.039-49.472c19.962-24.947 49.904-38.684 80.517-38.81 17.739-0.12642 35.855 4.4246 52.336 13.99 18.2 10.619 32.039 25.874 40.846 43.404l-86.095-4.5511c-24.365-1.4327-47.556 12.347-55.565 35.439zm13.797 16.224c0 19.468 15.684 35.229 35.059 35.229 19.374 0 35.059-15.76 35.059-35.229 0-19.468-15.684-35.229-35.059-35.229-19.374 0-35.059 15.718-35.059 35.229zm132.06-37.588l-58.585 3.034c15.894 18.668 16.145 45.595 2.7678 66.243l-47.01 72.648c19.5 1.0535 39.588-3.2447 57.788-13.864 45.039-26.126 63.282-80.908 45.039-128.06zm-144.93 57.647l-39.126-77.326c-10.694 16.434-16.942 36.156-16.942 57.267 0 52.253 38.078 95.53 87.856 103.2l26.713-52.59c-24.155 4.5511-47.472-8.765-58.501-30.551z'/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A\");\n               width: 211px;\n               height: 211px;\n               margin-bottom: 25%;\n               margin-top: -60px;\n               background-repeat: no-repeat;\n               }\n               .zee-launcher-browser-safari .zee-launcher-browser-logo {\n               background-image: url(\"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg version='1.1' viewBox='0 0 211 211' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg transform='translate(-82 -146)' fill-rule='nonzero' stroke='%23ffffff' stroke-width='2'%3E%3Cpath d='m180 251.86c0-4.0385 2.9377-7.855 7.2552-7.855 3.9614 0 7.7448 2.8402 7.7448 7.145 0 4.0385-2.8487 7.855-7.1662 7.855-4.0059 0-7.8338-2.9734-7.8338-7.145zm112-0.35503c0 57.728-46.772 104.5-104.5 104.5s-104.5-46.772-104.5-104.5 46.772-104.5 104.5-104.5 104.5 46.772 104.5 104.5zm-12-1c0-51.649-41.851-93.5-93.5-93.5s-93.5 41.851-93.5 93.5 41.851 93.5 93.5 93.5 93.5-41.851 93.5-93.5zm-30.624 40.983c0 1.5095 5.4495 4.2768 6.8328 5.1154-11.486 17.401-29.26 29.938-49.423 34.928l-1.8444-7.757c-0.12576-1.0482-0.79646-1.174-1.7606-1.174-0.79646 0-1.2576 1.174-1.1737 1.7611l1.8444 7.8828c-5.5753 1.174-11.234 1.7611-16.935 1.7611-15.217 0-30.182-4.2768-43.177-12.202 0.71263-1.174 5.1141-7.5474 5.1141-8.4698 0-0.79666-0.71263-1.5095-1.5091-1.5095-1.6348 0-5.1141 6.9603-6.1621 8.344-17.522-11.615-30.182-29.602-35.044-50.148l8.0066-1.761c0.92222-0.25158 1.1737-0.92246 1.1737-1.7611 0-0.79667-1.1737-1.2579-1.8444-1.174l-7.8389 1.803c-1.048-5.3251-1.6348-10.692-1.6348-16.143 0-15.556 4.4015-30.86 12.66-43.984 1.1737 0.71281 6.749 4.5284 7.6712 4.5284 0.79646 0 1.5091-0.58702 1.5091-1.3837 0-1.6353-6.1621-4.7381-7.5455-5.7024 11.821-17.275 29.805-29.728 50.219-34.34l1.7606 7.757c0.25152 0.92246 0.92222 1.174 1.7606 1.174 0.83838 0 1.2576-1.174 1.1737-1.8449l-1.7606-7.6732c5.1141-0.92246 10.312-1.5095 15.552-1.5095 15.552 0 30.727 4.4026 43.973 12.663-0.79646 1.174-4.5273 6.6249-4.5273 7.5474 0 0.79667 0.58687 1.5095 1.3833 1.5095 1.6348 0 4.7369-6.0379 5.5753-7.4216 17.187 11.615 29.469 29.351 34.248 49.561l-6.4975 1.3837c-1.048 0.25158-1.1737 0.92246-1.1737 1.8449 0 0.79667 1.1737 1.2579 1.7606 1.174l6.6232-1.5095c1.048 5.3251 1.6348 10.776 1.6348 16.227 0 15.221-4.1919 30.189-12.073 43.062-1.1737-0.58702-6.0364-4.0672-6.9586-4.0672-0.8803 0-1.5929 0.71281-1.5929 1.5095zm-14.876-98.483c-5.2178 4.88-53.863 49.48-55.228 51.8l-38.772 64.2c5.0974-4.76 53.863-49.6 55.108-51.72l38.892-64.28z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\");\n               }\n               .zee-launcher-unsupported-message {\n               text-align: center;\n               width: 250px;\n               font-family: sans-serif;\n               color: #ffffff;\n               }\n               .zee-launcher-unsupported-message-copy {\n               border: 1px solid #ffffff;\n               border-radius: 5px;\n               margin-top: 10px;\n               }\n               #zee-launcher-unsupported-message-input {\n               border: none;\n               padding: 10px;\n               border-radius: 0px;\n               border-right: 1px solid #344B60;\n               height: 40px;\n               color: #ffffff;\n               background-color: black;\n               box-sizing: border-box;\n               width: calc(100% - 65px);\n               margin-left: 5px;\n               }\n               #zee-launcher-unsupported-message-button {\n               background: none;\n               border: none;\n               outline: none;\n               text-transform: uppercase;\n               color: #ffffff;\n               height: 40px;\n               display: inline-block;\n               width: 59px;\n               }\n               .zee-launcher-unsupported-message-before-copy {\n               height: 100px;\n               display: flex;\n               flex-direction: column;\n               justify-content: center;\n               margin-top: 20px;\n               }\n               .zee-launcher-unsupported-message-copied .zee-launcher-unsupported-message-before-copy {\n               display: none;\n               }\n               .zee-launcher-unsupported-message-after-copy {\n               display: none;\n               }\n               .zee-launcher-unsupported-message-copied .zee-launcher-unsupported-message-after-copy {\n               height: 100px;\n               display: flex;\n               flex-direction: column;\n               justify-content: center;\n               margin-top: 20px;\n               }\n            </style>\n            <div class=\"zee-launcher-browser-logo\"></div>\n            <div class=\"zee-launcher-unsupported-message\">Open with ".concat(t,' to access this content.</div>\n            <div class="zee-launcher-unsupported-message-before-copy">\n               <div class="zee-launcher-unsupported-message ">Tap below to copy the address for easy pasting into ').concat(t,'.</div>\n               <div class="zee-launcher-unsupported-message-copy"><input id="zee-launcher-unsupported-message-input" type="text/"><button id="zee-launcher-unsupported-message-button">Copy</button></div>\n            </div>\n            <div class="zee-launcher-unsupported-message zee-launcher-unsupported-message-after-copy">COPIED! Now paste into ').concat(t,"'s address bar to experience the content.</div>\n    ");var n=e.querySelector("#zee-launcher-unsupported-message-input")||document.createElement("input");n.value=window.location.href;var r=function(){if(navigator.userAgent.match(/iPhone|iPod|iPad/i)){var t=document.createRange();t.selectNodeContents(n);var r=window.getSelection();if(!r)return;r.removeAllRanges(),r.addRange(t),n.setSelectionRange(0,999999999)}else n.select();document.execCommand("copy"),n.blur(),e.classList.toggle("zee-launcher-unsupported-message-copied",!0)};return(e.querySelector("#zee-launcher-unsupported-message-button")||document.createElement("button")).addEventListener("click",r),n.addEventListener("click",r),e}()),Object.assign(e.style,{position:"fixed",width:"100%",height:"100%",top:"0px",left:"0px",zIndex:1001,backgroundColor:"rgba(0, 0, 0, 0.9)",fontFamily:"sans-serif",color:"white",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),e.classList.add("zee_launcher_compatibility"),document.body.append(e)}}},2735:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MessageDeserializer=void 0;var a=function(){function e(){var t=this;r(this,e),this._buffer=new ArrayBuffer(0),this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer),this._f64View=new Float64Array(this._buffer),this._u8View=new Uint8Array(this._buffer),this._u16View=new Uint16Array(this._buffer),this._u32View=new Uint32Array(this._buffer),this._offset=0,this._length=0,this._startOffset=-1,this._processor={int:function(){return t._i32View[t._startOffset++]},bool:function(){return 1===t._i32View[t._startOffset++]},type:function(){return t._i32View[t._startOffset++]},float:function(){return t._f32View[t._startOffset++]},timestamp:function(){t._startOffset%2===1&&t._startOffset++;var e=t._f64View[t._startOffset/2];return t._startOffset+=2,e},string:function(){var e=t._i32View[t._startOffset++],n=(new TextDecoder).decode(new Uint8Array(t._buffer,4*t._startOffset,e));return t._startOffset+=e>>2,0!==(3&e)&&t._startOffset++,n},dataWithLength:function(){var e=t._i32View[t._startOffset++],n=new Uint8Array(e);return n.set(t._u8View.subarray(4*t._startOffset,4*t._startOffset+e)),t._startOffset+=n.byteLength>>2,0!==(3&n.byteLength)&&t._startOffset++,n.buffer},matrix4x4:function(){var e=t._i32View[t._startOffset++],n=new Float32Array(e);return n.set(t._f32View.subarray(t._startOffset,t._startOffset+16)),t._startOffset+=e,n},identityCoefficients:function(){var e=t._i32View[t._startOffset++],n=new Float32Array(e);return n.set(t._f32View.subarray(t._startOffset,t._startOffset+50)),t._startOffset+=e,n},expressionCoefficients:function(){var e=t._i32View[t._startOffset++],n=new Float32Array(e);return n.set(t._f32View.subarray(t._startOffset,t._startOffset+29)),t._startOffset+=e,n},cameraModel:function(){var e=t._i32View[t._startOffset++],n=new Float32Array(e);return n.set(t._f32View.subarray(t._startOffset,t._startOffset+6)),t._startOffset+=e,n},barcodeFormat:function(){return t._i32View[t._startOffset++]},faceLandmarkName:function(){return t._i32View[t._startOffset++]},instantTrackerTransformOrientation:function(){return t._i32View[t._startOffset++]},logLevel:function(){return t._i32View[t._startOffset++]}}}return i(e,[{key:"setData",value:function(e){this._buffer=e,this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer),this._f64View=new Float64Array(this._buffer),this._u8View=new Uint8Array(this._buffer),this._u16View=new Uint16Array(this._buffer),this._u32View=new Uint32Array(this._buffer),this._offset=0,this._length=0,e.byteLength>=4&&(this._offset=1,this._length=this._i32View[0]),this._startOffset=-1}},{key:"hasMessage",value:function(){return this._offset+1<this._length}},{key:"forMessages",value:function(e){for(;this.hasMessage();){var t=this._i32View[this._offset],n=this._i32View[this._offset+1];this._startOffset=this._offset+2,this._offset+=t,e(n,this._processor)}}}]),e}();t.MessageDeserializer=a},7183:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.cameraFrameTextureMatrix=t.CameraDraw=void 0;var a=n(7916),o=n(2e3),s=function(){function e(t){r(this,e),this._gl=t}return i(e,[{key:"dispose",value:function(){this._vbo&&this._gl.deleteBuffer(this._vbo),this._vbo=void 0,this._shader&&this._gl.deleteProgram(this._shader.prog),this._shader=void 0}},{key:"_generate",value:function(e,t){if(this._vbo)return this._vbo;if(this._vbo||(this._vbo=e.createBuffer()),!this._vbo)throw new Error("Unable to create buffer object");var n=new Float32Array([-1,-1,0,0,0,-1,1,0,0,1,1,-1,0,1,0,1,-1,0,1,0,-1,1,0,0,1,1,1,0,1,1]);return e.bindBuffer(e.ARRAY_BUFFER,this._vbo),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this._vbo}},{key:"drawCameraFrame",value:function(e,t,n,r){if(n.texture){var i=this._gl;i.disable(i.DEPTH_TEST),i.disable(i.SCISSOR_TEST),i.disable(i.CULL_FACE),i.disable(i.BLEND);var a=this._getCameraShader(i),o=this._generate(i,n);i.activeTexture(i.TEXTURE0),i.useProgram(a.prog),i.uniformMatrix4fv(a.unif_skinTexTransform,!1,c(n.dataWidth,n.dataHeight,e,t,n.uvTransform,r)),i.uniform1i(a.unif_skinSampler,0),i.bindTexture(i.TEXTURE_2D,n.texture),i.bindBuffer(i.ARRAY_BUFFER,o),i.vertexAttribPointer(a.attr_position,3,i.FLOAT,!1,20,0),i.enableVertexAttribArray(a.attr_position),i.vertexAttribPointer(a.attr_texCoord,2,i.FLOAT,!1,20,12),i.enableVertexAttribArray(a.attr_texCoord),i.drawArrays(i.TRIANGLES,0,6),i.disableVertexAttribArray(a.attr_position),i.disableVertexAttribArray(a.attr_texCoord),i.bindTexture(i.TEXTURE_2D,null),i.bindBuffer(i.ARRAY_BUFFER,null),i.useProgram(null)}}},{key:"_getCameraShader",value:function(e){if(this._shader)return this._shader;var t=e.createProgram();if(!t)throw new Error("Unable to create program");var n=a.compileShader(e,e.VERTEX_SHADER,u),r=a.compileShader(e,e.FRAGMENT_SHADER,l);e.attachShader(t,n),e.attachShader(t,r),a.linkProgram(e,t);var i=e.getUniformLocation(t,"skinTexTransform");if(!i)throw new Error("Unable to get uniform location skinTexTransform");var o=e.getUniformLocation(t,"skinSampler");if(!o)throw new Error("Unable to get uniform location skinSampler");return this._shader={prog:t,unif_skinTexTransform:i,unif_skinSampler:o,attr_position:e.getAttribLocation(t,"position"),attr_texCoord:e.getAttribLocation(t,"texCoord")},this._shader}}]),e}();t.CameraDraw=s;var u="\n#ifndef GL_ES\n#define highp\n#define mediump\n#define lowp\n#endif\n\nattribute vec4 position;\nattribute vec4 texCoord;\nvarying vec4 skinTexVarying;\nuniform mat4 skinTexTransform;\n\nvoid main()\n{\n    gl_Position = position;\n    skinTexVarying = skinTexTransform * texCoord;\n}",l="\n#define highp mediump\n#ifdef GL_ES\n    // define default precision for float, vec, mat.\n    precision highp float;\n#else\n#define highp\n#define mediump\n#define lowp\n#endif\n\nvarying vec4 skinTexVarying;\nuniform lowp sampler2D skinSampler;\n\nvoid main()\n{\n    gl_FragColor = texture2DProj(skinSampler, skinTexVarying);\n}";function c(e,t,n,r,i,a){var s=o.mat4.create(),u=o.mat4.create();o.mat4.fromTranslation(u,[-.5,-.5,0]),o.mat4.multiply(s,u,s),a&&(o.mat4.fromScaling(u,[-1,1,1]),o.mat4.multiply(s,u,s)),o.mat4.fromRotation(u,-1*function(){if(window.screen.orientation)switch(window.screen.orientation.type){case"portrait-primary":return 270;case"landscape-secondary":return 180;case"portrait-secondary":return 90;default:return 0}else if(void 0!==window.orientation)switch(window.orientation){case 0:return 270;case 90:return 0;case 180:return 90;case-90:return 180}return 0}()*Math.PI/180,[0,0,1]),o.mat4.multiply(s,u,s);var l=o.vec3.create();l[0]=n,l[1]=r,l[2]=0,o.vec3.transformMat4(l,l,u);var c=Math.abs(l[0]),g=Math.abs(l[1]);o.mat4.fromScaling(u,[1,-1,1]),o.mat4.multiply(s,u,s);var d=c/g,I=e/t;return d>I?o.mat4.fromScaling(u,[1,I/d,1]):o.mat4.fromScaling(u,[d/I,1,1]),o.mat4.multiply(s,u,s),o.mat4.fromTranslation(u,[.5,.5,0]),o.mat4.multiply(s,u,s),o.mat4.multiply(s,i,s),s}t.cameraFrameTextureMatrix=c},224:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.FaceDraw=void 0;var a=n(7916),o=function(){function e(t){r(this,e),this._gl=t}return i(e,[{key:"dispose",value:function(){this._vbo&&this._gl.deleteBuffer(this._vbo),this._normalbo&&this._gl.deleteBuffer(this._normalbo),this._ibo&&this._gl.deleteBuffer(this._ibo),this._shader&&this._gl.deleteProgram(this._shader.prog),this._vbo=void 0,this._normalbo=void 0,this._ibo=void 0,this._shader=void 0}},{key:"_generateIBO",value:function(e,t){if(this._ibo&&this._lastIndices===e)return this._ibo;if(this._lastIndices=e,this._ibo||(this._ibo=t.createBuffer()),!this._ibo)throw new Error("Unable to create buffer object");return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._ibo),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),this._ibo}},{key:"_generateVBO",value:function(e,t){if(this._vbo||(this._vbo=t.createBuffer()),!this._vbo)throw new Error("Unable to create buffer object");return t.bindBuffer(t.ARRAY_BUFFER,this._vbo),t.bufferData(t.ARRAY_BUFFER,e,t.STREAM_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this._vbo}},{key:"_generateNormalBO",value:function(e,t){if(this._normalbo||(this._normalbo=t.createBuffer()),!this._normalbo)throw new Error("Unable to create buffer object");return t.bindBuffer(t.ARRAY_BUFFER,this._normalbo),t.bufferData(t.ARRAY_BUFFER,e,t.STREAM_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this._normalbo}},{key:"drawFace",value:function(e,t){var n=this._gl,r=this._getShader(n),i=this._generateVBO(t.getVertices(),n),a=this._generateNormalBO(t.getNormals(),n),o=this._generateIBO(t.getIndices(),n);n.enable(n.DEPTH_TEST),n.enable(n.CULL_FACE),n.useProgram(r.prog),n.uniformMatrix4fv(r.unif_matrix,!1,e),n.bindBuffer(n.ARRAY_BUFFER,i),n.vertexAttribPointer(r.attr_position,3,n.FLOAT,!1,12,0),n.enableVertexAttribArray(r.attr_position),n.bindBuffer(n.ARRAY_BUFFER,a),n.vertexAttribPointer(r.attr_normal,3,n.FLOAT,!1,12,0),n.enableVertexAttribArray(r.attr_normal),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,o),n.drawElements(n.TRIANGLES,t.getIndices().length,n.UNSIGNED_SHORT,0),n.disableVertexAttribArray(r.attr_position),n.disableVertexAttribArray(r.attr_normal),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}},{key:"_getShader",value:function(e){if(this._shader)return this._shader;var t=e.createProgram();if(!t)throw new Error("Unable to create program");var n=a.compileShader(e,e.VERTEX_SHADER,s),r=a.compileShader(e,e.FRAGMENT_SHADER,u);e.attachShader(t,n),e.attachShader(t,r),a.linkProgram(e,t);var i=e.getUniformLocation(t,"matrix");if(!i)throw new Error("Unable to get uniform location mattrix");return this._shader={prog:t,unif_matrix:i,attr_position:e.getAttribLocation(t,"position"),attr_normal:e.getAttribLocation(t,"normal")},this._shader}}]),e}();t.FaceDraw=o;var s="\n#ifndef GL_ES\n#define highp\n#define mediump\n#define lowp\n#endif\n\nuniform mat4 matrix;\nattribute vec4 position;\nattribute vec3 normal;\nvarying highp vec3 vnormal;\n\nvoid main()\n{\n    gl_Position = matrix * position;\n    vnormal = normal;\n}",u="\n#define highp mediump\n#ifdef GL_ES\n    // define default precision for float, vec, mat.\n    precision highp float;\n#else\n#define highp\n#define mediump\n#define lowp\n#endif\n\nvarying vec4 skinTexVarying;\nvarying highp vec3 vnormal;\nuniform lowp sampler2D skinSampler;\n\nvoid main()\n{\n    vec3 normal2 = 0.5 * vnormal + 0.5;\n    gl_FragColor = vec4(normal2.x , normal2.y, normal2.z, 1.0);\n}"},2667:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.FaceDrawProject=void 0;var a=n(7916),o=function(){function e(t){r(this,e),this._gl=t}return i(e,[{key:"dispose",value:function(){this._vbo&&this._gl.deleteBuffer(this._vbo),this._uvbo&&this._gl.deleteBuffer(this._uvbo),this._ibo&&this._gl.deleteBuffer(this._ibo),this._shader&&this._gl.deleteProgram(this._shader.prog),this._vbo=void 0,this._uvbo=void 0,this._ibo=void 0,this._shader=void 0}},{key:"_generateIBO",value:function(e,t){if(this._ibo&&this._lastIndices===e)return this._ibo;if(this._lastIndices=e,this._ibo||(this._ibo=t.createBuffer()),!this._ibo)throw new Error("Unable to create buffer object");return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._ibo),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),this._ibo}},{key:"_generateVBO",value:function(e,t){if(this._vbo||(this._vbo=t.createBuffer()),!this._vbo)throw new Error("Unable to create buffer object");return t.bindBuffer(t.ARRAY_BUFFER,this._vbo),t.bufferData(t.ARRAY_BUFFER,e,t.STREAM_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this._vbo}},{key:"_generateUVBO",value:function(e,t){if(this._uvbo||(this._uvbo=t.createBuffer()),!this._uvbo)throw new Error("Unable to create buffer object");return t.bindBuffer(t.ARRAY_BUFFER,this._uvbo),t.bufferData(t.ARRAY_BUFFER,e,t.STREAM_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this._uvbo}},{key:"drawFace",value:function(e,t,n,r,i,a){var o=this._gl,s=this._getShader(o),u=this._generateVBO(t,o),l=this._generateUVBO(r,o),c=this._generateIBO(i,o);o.enable(o.DEPTH_TEST),o.enable(o.CULL_FACE),o.useProgram(s.prog),o.uniformMatrix4fv(s.unif_matrix,!1,e),o.uniformMatrix4fv(s.unif_uvmatrix,!1,n),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,a),o.uniform1i(s.unif_sampler,0),o.bindBuffer(o.ARRAY_BUFFER,u),o.vertexAttribPointer(s.attr_position,3,o.FLOAT,!1,12,0),o.enableVertexAttribArray(s.attr_position),o.bindBuffer(o.ARRAY_BUFFER,l),o.vertexAttribPointer(s.attr_uv,3,o.FLOAT,!1,12,0),o.enableVertexAttribArray(s.attr_uv),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,c),o.drawElements(o.TRIANGLES,6912,o.UNSIGNED_SHORT,0),o.disableVertexAttribArray(s.attr_position),o.disableVertexAttribArray(s.attr_uv),o.bindBuffer(o.ARRAY_BUFFER,null),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,null)}},{key:"_getShader",value:function(e){if(this._shader)return this._shader;var t=e.createProgram();if(!t)throw new Error("Unable to create program");var n=a.compileShader(e,e.VERTEX_SHADER,s),r=a.compileShader(e,e.FRAGMENT_SHADER,u);e.attachShader(t,n),e.attachShader(t,r),a.linkProgram(e,t);var i=e.getUniformLocation(t,"matrix");if(!i)throw new Error("Unable to get uniform location matrix");var o=e.getUniformLocation(t,"uvmatrix");if(!o)throw new Error("Unable to get uniform location matrix");var l=e.getUniformLocation(t,"uSampler");if(!l)throw new Error("Unable to get uniform location sampler");return this._shader={prog:t,unif_matrix:i,unif_sampler:l,unif_uvmatrix:o,attr_position:e.getAttribLocation(t,"position"),attr_uv:e.getAttribLocation(t,"uv"),attr_texturecoord:e.getAttribLocation(t,"aTextureCoord")},this._shader}}]),e}();t.FaceDrawProject=o;var s="\n#ifndef GL_ES\n#define highp\n#define mediump\n#define lowp\n#endif\n\nuniform mat4 matrix;\nuniform mat4 uvmatrix;\nattribute vec4 position;\nattribute vec3 normal;\nattribute vec3 uv;\n\n// varying highp vec3 vnormal;\n\nvarying highp vec2 vTextureCoord;\nvarying highp float vAlpha;\n\nvoid main()\n{\n    gl_Position = matrix * position;\n    vec4 ret = uvmatrix * vec4(uv.x, uv.y, uv.z, 1.0);\n    ret.x /= ret.w * 2.0;\n    ret.y /= ret.w * 2.0;\n    ret.x += 0.5;\n    ret.y += 0.0;\n    vAlpha = 1.0;\n    vTextureCoord = ret.xy;\n}",u="\n#define highp mediump\n#ifdef GL_ES\n    // define default precision for float, vec, mat.\n    precision highp float;\n#else\n#define highp\n#define mediump\n#define lowp\n#endif\n\nvarying highp vec2 vTextureCoord;\nvarying highp vec3 vnormal;\nvarying highp float vAlpha;\nuniform lowp sampler2D uSampler;\n\nvoid main()\n{\n    // vec3 normal2 = 0.5 * vnormal + 0.5;\n    vec4 p = texture2D(uSampler, vTextureCoord);\n    p.a = vAlpha;\n    gl_FragColor = p; // vec4(normal2.x , normal2.y, normal2.z, 1.0);\n}"},1758:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawPlane=t.disposeDrawPlane=void 0;var r,i,a,o=n(7916),s={};function u(e){if(a)return a;if(!(a=e.createBuffer()))throw new Error("Unable to create buffer object");return e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,1,1,0]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),a}t.disposeDrawPlane=function(){r=void 0,i=void 0,a=void 0,s={}},t.drawPlane=function(e,t,n,r,a){var o=l(e),c=function(e){if(i)return i;if(!(i=e.createBuffer()))throw new Error("Unable to create buffer object");return e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-.5,.125,0,-.5,-.125,0,.5,.125,0,.5,-.125,0]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),i}(e),g=u(e);e.disable(e.DEPTH_TEST),e.useProgram(o.prog),e.uniformMatrix4fv(o.unif_proj,!1,t),e.uniformMatrix4fv(o.unif_camera,!1,n),e.uniformMatrix4fv(o.unif_matrix,!1,r),e.bindBuffer(e.ARRAY_BUFFER,c),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,function(e,t){if(s[t])return s[t];var n=e.createTexture();if(!n)throw new Error("Unable to create texture");s[t]=n,e.bindTexture(e.TEXTURE_2D,n);var r=0,i=e.RGBA,a=1,o=1,u=0,l=e.RGBA,c=e.UNSIGNED_BYTE,g=new Uint8Array([0,0,255,255]);e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,r,i,a,o,u,l,c,g);var d=new Image;return d.onload=function(){e.bindTexture(e.TEXTURE_2D,n),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,r,i,l,c,d),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)},d.src=t,n}(e,a)),e.uniform1i(o.unif_skinSampler,0),e.vertexAttribPointer(o.attr_position,3,e.FLOAT,!1,12,0),e.enableVertexAttribArray(o.attr_position),e.bindBuffer(e.ARRAY_BUFFER,g),e.vertexAttribPointer(o.attr_textureCoord,2,e.FLOAT,!1,8,0),e.enableVertexAttribArray(o.attr_textureCoord),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.disableVertexAttribArray(o.attr_position),e.bindBuffer(e.ARRAY_BUFFER,null)};function l(e){if(r)return r;var t=e.createProgram();if(!t)throw new Error("Unable to create program");var n=o.compileShader(e,e.VERTEX_SHADER,"\n#ifndef GL_ES\n#define highp\n#define mediump\n#define lowp\n#endif\n\nuniform mat4 projMatrix;\nuniform mat4 cameraMatrix;\nuniform mat4 modelViewMatrix;\nattribute vec4 position;\nattribute vec2 textureCoord;\n\nvarying highp vec2 vTextureCoord;\n\nvoid main()\n{\n    gl_Position = projMatrix * cameraMatrix * modelViewMatrix * position;\n    vTextureCoord = textureCoord;\n}"),i=o.compileShader(e,e.FRAGMENT_SHADER,"\n#define highp mediump\n#ifdef GL_ES\n    // define default precision for float, vec, mat.\n    precision highp float;\n#else\n#define highp\n#define mediump\n#define lowp\n#endif\n\nvarying highp vec2 vTextureCoord;\nuniform sampler2D skinSampler;\n\nvoid main()\n{\n    gl_FragColor = texture2D(skinSampler, vTextureCoord);\n}");e.attachShader(t,n),e.attachShader(t,i),o.linkProgram(e,t);var a=e.getUniformLocation(t,"projMatrix");if(!a)throw new Error("Unable to get uniform location projMatrix");var s=e.getUniformLocation(t,"modelViewMatrix");if(!s)throw new Error("Unable to get uniform location modelViewMatrix");var u=e.getUniformLocation(t,"cameraMatrix");if(!u)throw new Error("Unable to get uniform location cameraMatrix");var l=e.getUniformLocation(t,"skinSampler");if(!l)throw new Error("Unable to get uniform location skinSampler");return r={prog:t,unif_matrix:s,unif_proj:a,unif_camera:u,unif_skinSampler:l,attr_position:e.getAttribLocation(t,"position"),attr_textureCoord:e.getAttribLocation(t,"textureCoord")}}},1319:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Event5=t.Event3=t.Event2=t.Event1=t.Event=void 0;var a=function(){function e(){r(this,e),this._funcs=[]}return i(e,[{key:"bind",value:function(e){this._funcs.push(e)}},{key:"unbind",value:function(e){var t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}},{key:"emit",value:function(){for(var e=0,t=this._funcs.length;e<t;e++)this._funcs[e]()}}]),e}();t.Event=a;var o=function(){function e(){r(this,e),this._funcs=[]}return i(e,[{key:"bind",value:function(e){this._funcs.push(e)}},{key:"unbind",value:function(e){var t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}},{key:"emit",value:function(e){for(var t=0,n=this._funcs.length;t<n;t++)this._funcs[t](e)}}]),e}();t.Event1=o;var s=function(){function e(){r(this,e),this._funcs=[]}return i(e,[{key:"bind",value:function(e){this._funcs.push(e)}},{key:"unbind",value:function(e){var t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}},{key:"emit",value:function(e,t){for(var n=0,r=this._funcs.length;n<r;n++)this._funcs[n](e,t)}}]),e}();t.Event2=s;var u=function(){function e(){r(this,e),this._funcs=[]}return i(e,[{key:"bind",value:function(e){this._funcs.push(e)}},{key:"unbind",value:function(e){var t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}},{key:"emit",value:function(e,t,n){for(var r=0,i=this._funcs.length;r<i;r++)this._funcs[r](e,t,n)}}]),e}();t.Event3=u;var l=function(){function e(){r(this,e),this._funcs=[]}return i(e,[{key:"bind",value:function(e){this._funcs.push(e)}},{key:"unbind",value:function(e){var t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}},{key:"emit",value:function(e,t,n,r,i){for(var a=0,o=this._funcs.length;a<o;a++)this._funcs[a](e,t,n,r,i)}}]),e}();t.Event5=l},1192:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.FaceLandmark=t.getFaceLandmark=t.destroyFaceLandmark=t.createFaceLandmark=void 0;var a=n(2e3),o=n(3987),s=n(7117),u=1,l=new Map;t.createFaceLandmark=function(e){var t=u++;return l.set(t,new c(e)),s.zcout("face_landmark_t initialized"),t},t.destroyFaceLandmark=function(e){l.delete(e)},t.getFaceLandmark=function(e){return l.get(e)};var c=function(){function e(t){r(this,e),this._name=t,this.anchor_pose=a.mat4.create()}return i(e,[{key:"_getVertex",value:function(e,t,n){for(var r=n.mean.slice(),i=0;i<50;i++)r[0]+=e[i]*n.identity[3*i+0],r[1]+=e[i]*n.identity[3*i+1],r[2]+=e[i]*n.identity[3*i+2];for(var a=0;a<29;a++)r[0]+=t[a]*n.expression[3*a+0],r[1]+=t[a]*n.expression[3*a+1],r[2]+=t[a]*n.expression[3*a+2];return r}},{key:"update",value:function(e,t,n){var r,i=o.landmarkData[this._name.toString()];if(i){if(Array.isArray(i)){r=this._getVertex(e,t,i[0]);var s=this._getVertex(e,t,i[1]);r[0]=.5*(r[0]+s[0]),r[1]=.5*(r[1]+s[1]),r[2]=.5*(r[2]+s[2])}else r=this._getVertex(e,t,i);n&&(r[0]*=-1),a.mat4.fromTranslation(this.anchor_pose,r)}}}]),e}();t.FaceLandmark=c},3987:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.landmarkData=void 0,t.landmarkData={0:[{mean:[.235,.2344,.7305],identity:[.008,.0087,.0024,-.0026,6e-4,-.0022,5e-4,.0033,.0026,.0017,-.0055,-8e-4,.0011,.0059,0,2e-4,.001,-.001,-.0044,-.0011,-1e-4,.0024,.0019,-9e-4,4e-4,-.0015,0,.0038,.0013,3e-4,.002,-.0021,.0018,.0023,.0011,.0012,-.0011,-.0017,9e-4,-.0012,-8e-4,7e-4,-.0017,.0029,-.0029,8e-4,-.0027,8e-4,-.0017,4e-4,9e-4,-.001,-3e-4,8e-4,-.0016,-3e-4,-7e-4,.0016,-9e-4,.0021,-5e-4,.0011,-.0024,-1e-4,6e-4,1e-4,-.0026,-4e-4,-3e-4,-9e-4,5e-4,3e-4,-8e-4,-.001,-4e-4,-8e-4,.0022,-.0014,-1e-4,-.0023,0,-.0018,7e-4,-.0036,.0017,.0017,-.0018,-2e-4,-4e-4,-9e-4,-8e-4,3e-4,.0012,9e-4,-4e-4,-.0016,5e-4,-.0013,.0011,.0023,.0029,.0024,.0017,-.0027,-4e-4,-.001,-.0018,-.0015,-.001,.001,-.0013,-1e-4,-2e-4,7e-4,3e-4,3e-4,-.0016,9e-4,-.0021,4e-4,.0014,.002,-7e-4,-4e-4,2e-4,-4e-4,-6e-4,-9e-4,.0015,4e-4,-4e-4,5e-4,-.0015,9e-4,3e-4,3e-4,-2e-4,-8e-4,-9e-4,.0023,4e-4,1e-4,-4e-4,-1e-4,7e-4,2e-4,.001,1e-4,-.0029,-5e-4],expression:[0,3e-4,.0052,-7e-4,-.0051,-.0103,0,.0019,.0027,-.0054,.0135,.035,-5e-4,-6e-4,.0025,-.0045,-.0557,-.003,-.0191,-.1199,.0548,-.0036,-.0682,-.0167,2e-4,-.0085,-.0085,.0044,.0041,-.0568,.0044,.179,.0065,-.0017,-.1006,.0036,-.0267,-.3279,.0301,-.0011,-.0173,-.001,.0046,.2808,.0207,.0162,.238,-.0225,.0017,.1041,.0203,5e-4,.0161,.0031,-.0436,.6504,.0873,-.0099,.1039,.0048,-.0254,.2534,-.0042,.003,-.0106,-.0153,-.0118,.0252,9e-4,-.0071,.0099,.007,-.0724,.0461,-.0235,.0833,.004,.0141,-.0219,.0132,-.0042,-.0179,.0045,-.0215,.3638,.0054,-.0445]},{mean:[.2358,.1466,.7183],identity:[.0077,.0093,1e-4,-.0022,0,-.0041,5e-4,.0022,.0028,.0018,-.0038,-.0013,.001,.0044,-2e-4,0,.0017,-.0016,-.0043,-2e-4,-1e-4,.0023,9e-4,5e-4,-7e-4,-4e-4,-.0017,.003,7e-4,6e-4,.0011,-.0018,5e-4,.0018,-8e-4,4e-4,-.0023,-6e-4,-3e-4,-.0015,-.0014,-1e-4,-.0018,.0027,-.0026,3e-4,-.0031,.0011,-.0026,-.0011,.0012,-.0013,-2e-4,7e-4,-.0021,.0021,4e-4,.0012,-.001,.002,-3e-4,2e-4,-.0026,-3e-4,.001,1e-4,-.0018,-.001,9e-4,-.0011,.001,4e-4,-8e-4,-7e-4,-.001,-3e-4,7e-4,-5e-4,-6e-4,-.0019,-5e-4,-.002,7e-4,-.0027,.0014,.0013,6e-4,-5e-4,-3e-4,-3e-4,-.001,0,.0019,1e-4,6e-4,-.0012,4e-4,-9e-4,4e-4,.0025,3e-4,.0024,.0017,-9e-4,-.0015,-.0015,-.001,-.0023,-.001,-5e-4,-4e-4,8e-4,9e-4,7e-4,2e-4,7e-4,-9e-4,9e-4,-.0013,1e-4,9e-4,2e-4,6e-4,-6e-4,-8e-4,-4e-4,-7e-4,8e-4,.0019,3e-4,.0015,2e-4,-.0015,-3e-4,0,6e-4,3e-4,6e-4,-6e-4,2e-4,5e-4,-4e-4,.0012,-4e-4,2e-4,-8e-4,6e-4,-4e-4,2e-4,-.0021],expression:[-.0034,.0054,.0069,.004,6e-4,-.0104,-3e-4,.0036,.0025,.0065,.0296,.0208,-9e-4,.0154,.0029,-.0167,.0124,.004,-.0102,.0351,.028,-.019,.0146,-.0035,-.0023,-.0069,-.0051,-.01,.0262,-.028,.0112,.082,.023,-.0019,-.066,-.0104,-.0408,.0164,.0075,-.0074,.0367,.0041,.0517,-.0207,.0045,.0291,-.0672,-.0129,.0345,-.1558,-.0106,.0037,-.0437,-.0021,.0854,-.1121,.0187,.0041,.0072,.0011,.0193,-.0143,-.0119,.005,-.02,-.0122,-.008,.0527,.0036,-.006,.0222,.007,-.0429,.046,-.0046,.0226,-.0059,.0202,-.0173,.0087,0,-.0067,-.0095,-.0153,.1506,-.0017,.0021]}],1:[{mean:[-.2271,.2323,.7319],identity:[-.0084,.0097,.0018,.0041,2e-4,-.002,-.0012,.0036,.0019,-9e-4,-.0063,-.001,-3e-4,.0053,6e-4,1e-4,5e-4,-.0015,.0044,-.0025,-.0015,-.002,.0016,-6e-4,2e-4,-.0013,0,-.0022,2e-4,2e-4,-.0025,-.0014,.0015,8e-4,2e-4,.0012,6e-4,-6e-4,.0017,0,3e-4,-1e-4,.0024,.0025,-.0029,-.0015,-.0015,1e-4,.0031,-.0016,7e-4,.0019,6e-4,.002,9e-4,.001,-.0014,-.002,-.0015,.0029,1e-4,5e-4,-.0023,8e-4,-.0011,.0019,.0017,-3e-4,-.0011,-3e-4,.0011,-8e-4,.0019,-.0022,1e-4,.0015,.0017,-8e-4,-.0011,-.0022,3e-4,.0022,6e-4,-.003,-2e-4,0,-.0017,-2e-4,0,1e-4,4e-4,.0012,.0019,-.0014,4e-4,-.0017,-.0012,-.0011,.0021,-.0029,.0026,.0018,-.0023,-.0029,1e-4,.0014,-.0019,-4e-4,-4e-4,.0023,-.0016,0,-9e-4,.0014,-.0015,.0015,-.0016,-.0011,-.0022,1e-4,-.0018,.0027,-.0013,4e-4,-1e-4,-5e-4,.0011,-2e-4,.0015,5e-4,-9e-4,-1e-4,.0029,6e-4,0,-3e-4,7e-4,-8e-4,-5e-4,.0025,3e-4,2e-4,-8e-4,-1e-4,3e-4,0,.0014,2e-4,-.0024,1e-4],expression:[-.0025,-9e-4,.006,.004,-.0027,-.0113,-8e-4,.001,.0031,-.0016,.0144,.0382,-3e-4,-5e-4,.0035,-.0044,-.0511,-.0014,-7e-4,-.1007,.0582,-6e-4,-.0606,-.0165,5e-4,-.0087,-.0093,.0036,.0057,-.0576,-.0039,.1488,.0127,.0016,-.0666,-9e-4,-.0153,.3162,-.0445,-.0021,.0023,.0043,-.0033,.2382,.0063,-.0217,.167,-.039,.0097,-.1144,-.0189,-.0145,.6831,.0632,-.0012,-.1959,-.0133,4e-4,.1108,-3e-4,.0062,.2593,-.0161,-.0018,-.0051,-.012,.0162,.016,-.0022,-.0052,-.0201,.0101,.0115,.0365,-.024,-.0059,.0188,-.0336,.0352,.0224,-.0229,.0146,.0086,-.0273,-.0032,.0103,-.0112]},{mean:[-.2288,.1541,.7202],identity:[-.0082,.0101,2e-4,.0036,-7e-4,-.0037,-8e-4,.0024,.0022,-.0013,-.0045,-.0013,-6e-4,.0045,-4e-4,4e-4,.0012,-.0014,.0042,-.001,-7e-4,-.0019,3e-4,-2e-4,.0012,-4e-4,-.0012,-.0018,-4e-4,-1e-4,-.0014,-.0012,1e-4,1e-4,-.0017,.001,.0015,-1e-4,6e-4,1e-4,0,-6e-4,.0028,.0021,-.0025,-.002,-.0015,7e-4,.0028,-.0023,9e-4,.0013,1e-4,.0016,.0012,.0032,-6e-4,-.0013,-.0011,.0021,3e-4,-5e-4,-.0024,4e-4,-4e-4,.0014,.0015,-8e-4,-3e-4,3e-4,.0017,-6e-4,.002,-.0018,-3e-4,9e-4,1e-4,2e-4,-6e-4,-.0015,-4e-4,.0022,7e-4,-.0023,0,-2e-4,-2e-4,-3e-4,-1e-4,6e-4,-2e-4,6e-4,.0022,-3e-4,.0013,-.0014,-5e-4,-3e-4,.0013,-.0027,6e-4,.0025,-.0023,-8e-4,-.0013,.0017,-9e-4,-.0019,1e-4,8e-4,-7e-4,-4e-4,0,.001,-.001,.0019,-8e-4,-.0015,-6e-4,-2e-4,-.0011,8e-4,1e-4,9e-4,-8e-4,-4e-4,6e-4,7e-4,.0021,-4e-4,7e-4,-5e-4,.0021,-7e-4,-4e-4,-9e-4,8e-4,3e-4,1e-4,3e-4,1e-4,9e-4,.001,-5e-4,5e-4,-.001,.001,4e-4,-5e-4,-.0012],expression:[8e-4,.0037,.0078,-4e-4,5e-4,-.012,-2e-4,-.0046,.0033,-.0089,.0295,.0221,-.0024,-.0084,.0013,.0057,.0125,.0049,-.0036,.0373,.0285,.0115,.0135,-.0035,.0048,.0108,-.0033,.0106,.0281,-.0301,-.0082,.0803,.0244,-7e-4,-.0725,-.0105,-.0247,-.0036,-.0143,-.0045,-.029,2e-4,-.0303,.0093,-.0021,-.0196,-.0754,-.0211,.0326,.1246,.006,-.0804,-.1499,.0109,.0182,-.0029,-.0014,-.0035,.0072,-8e-4,-.0152,-.0108,-.0166,-.0073,-.0144,-.0095,.0101,.047,-.0018,-.004,-.0189,.0027,.0104,.0298,-.0042,-.0096,.0191,-.0217,.0228,.0226,-.0105,.0047,-.0048,-.0172,.0061,-.0043,-.0016]}],2:{mean:[.5396,.2028,.2496],identity:[.0204,.0146,-.0182,-.0052,.0158,-.0038,-.0025,-.0108,-.006,.0085,-.0044,.0029,.0042,.001,.0095,.0015,-.0034,-.0064,-.0057,7e-4,.0026,7e-4,.0037,-6e-4,.0037,.0026,.0024,5e-4,-.0019,-.0013,.003,-.0028,.0018,-9e-4,.002,-.0047,.004,-.003,.0031,-.0027,-.0026,-.0017,.0016,.0014,-4e-4,.0021,-.002,0,.0017,7e-4,-4e-4,-7e-4,-.0018,-9e-4,2e-4,-.0012,1e-4,-5e-4,-.0011,4e-4,2e-4,.0011,1e-4,8e-4,.0017,-.0013,.0025,.0017,.001,2e-4,3e-4,5e-4,-4e-4,-1e-4,-5e-4,7e-4,-.0022,-.0029,6e-4,-8e-4,-6e-4,6e-4,-5e-4,5e-4,.0013,3e-4,-5e-4,-.003,7e-4,2e-4,.0016,-4e-4,0,0,4e-4,1e-4,.0014,.0012,1e-4,4e-4,-1e-4,8e-4,9e-4,4e-4,-4e-4,9e-4,-2e-4,.001,9e-4,4e-4,1e-4,7e-4,7e-4,.001,-.0017,-8e-4,2e-4,.0017,-3e-4,-1e-4,4e-4,5e-4,7e-4,5e-4,-1e-4,-6e-4,-1e-4,1e-4,-3e-4,-7e-4,-2e-4,-5e-4,0,-3e-4,3e-4,8e-4,-2e-4,-3e-4,5e-4,1e-4,-7e-4,-.001,-2e-4,3e-4,4e-4,-1e-4,7e-4,0,4e-4,4e-4],expression:[1e-4,-4e-4,1e-4,0,5e-4,2e-4,0,0,3e-4,-2e-4,3e-4,5e-4,-1e-4,2e-4,8e-4,1e-4,-2e-4,-5e-4,-3e-4,6e-4,5e-4,0,1e-4,2e-4,1e-4,-1e-4,-6e-4,-2e-4,5e-4,0,-4e-4,4e-4,.0016,4e-4,-4e-4,-.0015,0,1e-4,1e-4,-3e-4,3e-4,.0019,-2e-4,7e-4,4e-4,4e-4,-8e-4,-.0015,.0013,-.0016,-.0069,4e-4,-6e-4,-.0019,0,-1e-4,5e-4,-3e-4,2e-4,.0014,-3e-4,6e-4,.0011,4e-4,-3e-4,-.0032,-6e-4,8e-4,.0025,-3e-4,3e-4,.0015,-1e-4,1e-4,3e-4,-1e-4,0,0,-3e-4,4e-4,.0019,1e-4,0,-8e-4,-1e-4,1e-4,5e-4]},3:{mean:[-.5464,.2141,.26],identity:[-.0207,.0172,-.0176,.0068,.0148,-.0051,.0042,-.0101,-.0058,-.0087,-.0059,.0045,-.0056,.0017,.0097,-.0048,-.004,-.0044,.0019,2e-4,.0041,-.0052,.0041,2e-4,-.0027,6e-4,.002,-.0027,-.0033,-6e-4,-.004,9e-4,-.0012,-1e-4,-.0026,.0021,-.003,-.0025,.0052,.0025,.0022,-1e-4,-8e-4,.0013,.001,4e-4,.0018,.0014,6e-4,-5e-4,-.0015,-.0039,.0014,-1e-4,8e-4,-2e-4,6e-4,-5e-4,-.0038,-.0012,-.0018,-3e-4,.001,9e-4,.0012,.0024,-.0024,-7e-4,-.0016,-.0016,3e-4,-.001,-.0014,-.0014,.001,-3e-4,-7e-4,-.0012,3e-4,6e-4,3e-4,-5e-4,3e-4,.0012,6e-4,-8e-4,4e-4,4e-4,8e-4,-2e-4,-.0014,3e-4,0,.0023,-3e-4,-.0012,-.0013,.0011,-2e-4,-.0014,-1e-4,.0014,0,3e-4,3e-4,-8e-4,-5e-4,-7e-4,-7e-4,-2e-4,3e-4,5e-4,2e-4,-1e-4,.0011,-.0014,1e-4,-.0015,-1e-4,-3e-4,0,-.001,-1e-4,-8e-4,8e-4,-8e-4,-2e-4,-.0011,-3e-4,-4e-4,1e-4,-2e-4,3e-4,-7e-4,0,3e-4,1e-4,-8e-4,5e-4,1e-4,4e-4,.0014,-6e-4,-.001,-3e-4,-2e-4,1e-4,-1e-4,-1e-4,7e-4],expression:[-3e-4,-1e-4,6e-4,4e-4,0,-7e-4,0,-3e-4,-2e-4,-4e-4,.0012,8e-4,1e-4,-5e-4,-7e-4,-4e-4,0,1e-4,-4e-4,.0017,7e-4,0,1e-4,3e-4,0,4e-4,4e-4,5e-4,1e-4,-.001,-7e-4,.0022,.0026,5e-4,-.0024,-.0023,0,1e-4,3e-4,0,-.0013,-.0015,6e-4,.0014,8e-4,-2e-4,-.0025,-.0023,-3e-4,.0049,.006,-2e-4,-7e-4,-2e-4,0,-.0019,-.0018,-2e-4,.0017,.0017,3e-4,.0015,7e-4,1e-4,-.0023,-.0036,2e-4,.0023,.0017,0,-5e-4,-3e-4,-3e-4,4e-4,2e-4,-1e-4,-3e-4,-5e-4,1e-4,.0018,.0025,1e-4,-6e-4,-.0011,0,1e-4,1e-4]},4:{mean:[.0018,.1864,.853],identity:[-.0011,.0134,.0085,9e-4,-.0025,-7e-4,-3e-4,.0033,4e-4,-5e-4,-.0047,-.002,7e-4,.0026,-.0069,-1e-4,.0036,.0072,5e-4,-8e-4,-.0047,4e-4,-8e-4,-.001,0,2e-4,-.0036,-2e-4,-.001,-.0048,-1e-4,.0018,.0044,-7e-4,-2e-4,.0043,3e-4,.002,-.0031,0,-7e-4,.0013,0,.0037,.0033,-.0016,-.0012,.002,-1e-4,-.0027,.0051,5e-4,8e-4,7e-4,-.0017,.0054,.0023,-3e-4,.0032,1e-4,0,7e-4,-5e-4,-.0011,2e-4,8e-4,0,-.0033,-8e-4,-7e-4,7e-4,.0033,5e-4,-3e-4,.0029,-1e-4,-.0024,-.0011,-.002,-.0015,-.0019,2e-4,7e-4,.0031,6e-4,.0012,0,0,-.0021,0,-9e-4,-.0011,-.0011,-2e-4,.0015,.001,.0013,8e-4,.001,-3e-4,9e-4,.0027,-2e-4,-.0011,-.0011,6e-4,7e-4,2e-4,1e-4,-5e-4,-.0022,.0011,-.0014,9e-4,3e-4,2e-4,0,-6e-4,-4e-4,-.0011,-7e-4,.001,-.0012,6e-4,-.0012,-.0015,3e-4,-9e-4,-.0013,-.0013,7e-4,.001,-.0011,-.0013,.0015,4e-4,1e-4,4e-4,-1e-4,-.0016,-.0016,9e-4,-7e-4,-.0024,5e-4,-1e-4,-.0017,-2e-4,3e-4,-9e-4],expression:[-.0017,.0019,.0097,.003,-.0103,-.0093,9e-4,6e-4,.0023,-.0017,-.0204,.0376,.0033,-.0034,.0033,-.0026,-.0322,.0396,-.0032,-.0947,.0942,-7e-4,-.0175,.0266,-.001,-6e-4,.0016,.0025,.0157,-.0142,-.0022,.037,.015,.0021,-.0102,-.0107,.0036,.0055,-.0051,.0021,3e-4,-3e-4,4e-4,-.0177,.0074,-6e-4,-.0357,.0149,-.0066,9e-4,.0013,-.0031,.0016,.0095,.002,.0052,.0035,-3e-4,.0053,-.0082,.002,.0022,-.0071,-.0011,5e-4,.0055,.0011,3e-4,-.0126,-4e-4,3e-4,-.0023,-.0015,.0059,.0063,-.0042,-.0023,.0055,.0019,.0017,-.0075,6e-4,-8e-4,.0018,.0012,.0012,-5e-4]},5:{mean:[-.002,-.0469,1.0039],identity:[-.0017,.0018,.0156,6e-4,-.0038,5e-4,4e-4,.0013,.002,-4e-4,-.0015,-.0051,5e-4,-7e-4,-.0055,-1e-4,-9e-4,.008,-2e-4,.0036,-.0053,4e-4,-.0026,-.0016,7e-4,9e-4,-.009,-3e-4,7e-4,-.0084,.0015,.0021,.0032,-.0015,.0018,.0046,-3e-4,-4e-4,-1e-4,8e-4,-.0044,-7e-4,-8e-4,7e-4,.0048,-.0024,-3e-4,.0024,2e-4,-.0051,.0058,-6e-4,.0028,.0018,-.0021,.0035,.0057,.0011,.0065,0,-2e-4,.0011,.003,-.0027,8e-4,7e-4,3e-4,-.0039,-.002,-2e-4,-.0015,.0034,.0012,-.0025,.0024,-2e-4,4e-4,-.0042,-.0024,-.001,-.0023,.0016,-7e-4,.0039,1e-4,-5e-4,.0018,3e-4,-2e-4,-9e-4,-.0015,3e-4,-7e-4,-1e-4,-2e-4,.0023,.0032,.002,-.0013,.0013,-.0038,.0045,1e-4,-.0031,1e-4,.0019,-1e-4,.0016,.0013,0,-.002,.0023,2e-4,.0011,.0018,-.0024,6e-4,-.0017,.002,-8e-4,-.0021,7e-4,.0011,8e-4,4e-4,-.001,.0012,2e-4,-6e-4,-.0027,-5e-4,.001,-9e-4,1e-4,-1e-4,8e-4,-.0011,.0022,-.001,-5e-4,-.0011,.0016,-.0015,8e-4,-3e-4,9e-4,.0013,-7e-4,-7e-4,-2e-4],expression:[-.0018,-.0168,.0088,.0389,.1026,.0414,.2201,-.0262,-.0016,-.0017,.0612,-.0298,-.0323,.0093,.0013,-.005,.2207,.1315,-4e-4,.0858,-.0303,-.0133,.015,-.008,.1454,.0114,.0177,-.0077,.1022,.0356,-.0023,.1088,.0232,.003,-.0706,.0347,-1e-4,.004,-.0011,.0397,-.0096,-.0033,.0029,-.01,-.0083,-6e-4,-.0135,.0016,-.0087,-.0019,.0022,-.004,-.0087,.0105,8e-4,-.005,.0069,.0028,.0409,-.0391,.003,.0103,.0051,.0026,.0776,-.0083,-.0062,-.0567,.0268,.0175,.0017,.0156,-.0043,.0299,-.0395,-.0015,.0051,-.0148,.0125,.0035,.0603,.0109,-.0645,-.0257,.002,6e-4,-8e-4]},6:{mean:[-6e-4,-.1542,.8789],identity:[-7e-4,-.0032,.01,0,-.0027,.0031,6e-4,5e-4,-6e-4,-3e-4,.0013,-.0049,-2e-4,-.002,-.0046,8e-4,-.0011,.0054,2e-4,.0043,-.0027,3e-4,-.0022,-.0019,8e-4,.0032,-.0069,0,4e-4,-.0071,.0016,.0027,.0039,-.0017,9e-4,.0031,-1e-4,-5e-4,-4e-4,7e-4,-.0026,-.0012,-5e-4,6e-4,2e-4,-.0014,-.0013,.0019,-2e-4,-.0053,.0031,-6e-4,.0016,.0023,-.0013,.0021,.0029,8e-4,.0052,0,4e-4,0,.0037,-.0026,3e-4,.002,-2e-4,-.0024,4e-4,-4e-4,-.0012,8e-4,7e-4,-.0023,5e-4,0,.0014,-.0022,-.0016,0,-.0012,8e-4,-7e-4,.0014,-6e-4,-.0012,-3e-4,2e-4,.0012,-3e-4,-.002,-1e-4,1e-4,-2e-4,-.0016,9e-4,.002,.0019,0,6e-4,-.0022,.0016,1e-4,-.0017,-.0013,.001,9e-4,-1e-4,.0011,3e-4,-7e-4,.0014,8e-4,.0013,.0011,-.002,0,-.0015,.0014,.001,-.0015,7e-4,3e-4,.001,-1e-4,.0012,7e-4,6e-4,-4e-4,-.0013,-.0012,-9e-4,-.0011,2e-4,-5e-4,5e-4,4e-4,2e-4,1e-4,0,5e-4,5e-4,-.0014,.0015,-9e-4,5e-4,.0014,-8e-4,-8e-4,.0012],expression:[8e-4,.0481,.1653,.0784,.1008,-.3992,.5088,-.02,.0542,.001,.3723,-.0151,-.0986,.0283,-.0033,-.0121,.2634,.1202,.0036,-.0529,-.0245,-.0297,-.1085,.0495,.3264,.0083,4e-4,-.0314,.1459,-.1142,-.003,1e-4,.1154,-.0035,-.0285,-.0184,-1e-4,.0012,.0035,.079,-.0103,.0043,.011,-.004,-.0774,-.0047,-.023,.0284,-.0048,-.001,.0149,-.0039,.0046,.0528,-6e-4,.0063,.0376,.0096,.0558,-.0295,0,-.0311,-.0634,.0062,.0176,-.0154,-.0109,-.1149,.0192,.0326,.0121,.0237,.0034,.0262,-.0778,.0014,-.0045,-.0203,.0077,.0588,.0575,.008,-.0557,-.0095,.0032,.0054,-.0042]},7:{mean:[.0038,-.2927,.833],identity:[6e-4,-.0109,.0073,-6e-4,-.0044,.0017,-1e-4,-.0022,-6e-4,-3e-4,.0065,-.0014,-6e-4,-.0051,-.0046,3e-4,-.0029,.003,2e-4,.0038,-6e-4,0,-.0012,6e-4,-4e-4,.0053,-.0075,-2e-4,-7e-4,-.0063,.0014,.0026,.0019,-.0022,.0018,.0028,-1e-4,-.0012,.0011,9e-4,.0019,-.0019,-1e-4,.0012,-.0022,-3e-4,-.0012,4e-4,-8e-4,3e-4,-3e-4,0,.0017,.0021,-4e-4,.0012,.0022,-3e-4,.0026,-3e-4,4e-4,-.0026,.0032,-.0019,3e-4,.0015,1e-4,-.0015,.0013,-1e-4,1e-4,-.0029,0,-2e-4,-.0028,-7e-4,.0019,-3e-4,-2e-4,.0012,9e-4,4e-4,-.001,-.002,-.0016,.0011,-1e-4,3e-4,.0021,2e-4,-.0014,-9e-4,-1e-4,0,-2e-4,-.001,.0015,.0018,1e-4,7e-4,8e-4,.0017,.001,-9e-4,1e-4,4e-4,.0023,-1e-4,.0012,1e-4,-8e-4,2e-4,.0018,6e-4,3e-4,1e-4,.0012,-3e-4,.002,-6e-4,0,-1e-4,-.0022,4e-4,5e-4,.0011,2e-4,-.0013,-.0023,6e-4,6e-4,-5e-4,-5e-4,9e-4,2e-4,2e-4,.0011,-3e-4,.0011,.0015,.0011,3e-4,2e-4,8e-4,-4e-4,-8e-4,3e-4,0,.0012,-1e-4],expression:[.026,.1107,.3257,.1917,.3206,-1.1348,1.0791,-.035,.1549,-.0103,.6953,1e-4,-.3262,.068,.0219,-.0044,.3643,.2178,.0168,-.2478,-.1321,-.0414,-.3782,-.0617,.5088,-.0031,-.0311,-.0497,.0948,-.385,.0148,-.2224,-.1415,-.0074,.0863,-.203,3e-4,-.0081,.0057,.1164,-.0039,.0015,-.0024,.0505,.1532,.0039,-.0148,-.0753,.0163,.0058,-.0339,.0036,.0252,-.0569,-.0041,.0163,-.0361,.0035,-.018,.1266,0,-.0163,-.0046,.0133,-.1656,.2134,.0191,.0057,.0734,.0681,.0039,-.0144,.029,-.074,-.046,.0122,.0072,-.0162,-.0349,-.1234,.0212,-.0355,.0535,.1218,.0043,-.024,.0016]},8:{mean:[-.0018,-.3037,.8491],identity:[2e-4,-.0112,.0077,-4e-4,-.0044,.0024,1e-4,-.0021,-4e-4,-4e-4,.0066,-.002,-4e-4,-.0052,-.0044,3e-4,-.0032,.0039,4e-4,.0042,-3e-4,2e-4,-.0012,-2e-4,-2e-4,.0052,-.0083,-1e-4,-8e-4,-.0056,.0017,.0024,.0019,-.0023,.002,.0027,-2e-4,-.0013,.002,9e-4,.0017,-.0028,-2e-4,.0012,-.0026,0,-.0016,2e-4,-5e-4,3e-4,-.001,-1e-4,.0016,.0016,-3e-4,.0012,.0012,-3e-4,.0027,-3e-4,3e-4,-.0026,.0037,-.0017,1e-4,.0016,1e-4,-.0015,.0024,1e-4,2e-4,-.0039,0,-3e-4,-.0033,-6e-4,.0017,-4e-4,-4e-4,.0012,.0018,2e-4,-.0012,-.002,-.0017,.0013,-.001,3e-4,.0021,4e-4,-.0012,-6e-4,-2e-4,0,-4e-4,-9e-4,.0016,.0017,4e-4,7e-4,7e-4,.001,9e-4,-8e-4,5e-4,5e-4,.0023,.001,.0013,2e-4,-4e-4,2e-4,.0017,8e-4,3e-4,-1e-4,9e-4,-4e-4,.0019,-5e-4,3e-4,0,-.0025,3e-4,3e-4,.0011,1e-4,-.0015,-.001,7e-4,7e-4,-7e-4,-7e-4,8e-4,0,1e-4,.0013,-4e-4,.0012,.0014,.0017,4e-4,2e-4,3e-4,-3e-4,-9e-4,1e-4,0,.001,-4e-4],expression:[-.0092,2.8809,1.416,.2018,1.1982,-.9351,1.4492,-.1902,.1749,.0305,-.167,-.1572,-.7354,-.0492,.0115,.0608,.2971,.1179,.0046,-.0997,-.0041,-.0104,.3379,-.1854,.009,.0366,-.0583,.0269,-.0029,-.4175,-8e-4,.1794,.0752,-.0135,.1158,.1234,5e-4,.003,-.0032,.1034,-.0504,-.0055,-.0076,-.0772,.224,.0047,.0229,-.1044,.0162,-.0161,-.0241,-.0083,-.1388,-.0434,-.0125,-.0997,-.0327,-.0111,.1576,-.3911,.0199,.2522,.142,.0059,-.0721,-.0045,.031,-.1136,-.1685,.0641,.0142,.0312,.0426,-.1366,.1011,.0101,-.0157,.0018,-.0103,-.0344,.0907,.0016,.1168,-.0806,.0104,-.0057,.0111]},9:[{mean:[.0038,-.2927,.833],identity:[6e-4,-.0109,.0073,-6e-4,-.0044,.0017,-1e-4,-.0022,-6e-4,-3e-4,.0065,-.0014,-6e-4,-.0051,-.0046,3e-4,-.0029,.003,2e-4,.0038,-6e-4,0,-.0012,6e-4,-4e-4,.0053,-.0075,-2e-4,-7e-4,-.0063,.0014,.0026,.0019,-.0022,.0018,.0028,-1e-4,-.0012,.0011,9e-4,.0019,-.0019,-1e-4,.0012,-.0022,-3e-4,-.0012,4e-4,-8e-4,3e-4,-3e-4,0,.0017,.0021,-4e-4,.0012,.0022,-3e-4,.0026,-3e-4,4e-4,-.0026,.0032,-.0019,3e-4,.0015,1e-4,-.0015,.0013,-1e-4,1e-4,-.0029,0,-2e-4,-.0028,-7e-4,.0019,-3e-4,-2e-4,.0012,9e-4,4e-4,-.001,-.002,-.0016,.0011,-1e-4,3e-4,.0021,2e-4,-.0014,-9e-4,-1e-4,0,-2e-4,-.001,.0015,.0018,1e-4,7e-4,8e-4,.0017,.001,-9e-4,1e-4,4e-4,.0023,-1e-4,.0012,1e-4,-8e-4,2e-4,.0018,6e-4,3e-4,1e-4,.0012,-3e-4,.002,-6e-4,0,-1e-4,-.0022,4e-4,5e-4,.0011,2e-4,-.0013,-.0023,6e-4,6e-4,-5e-4,-5e-4,9e-4,2e-4,2e-4,.0011,-3e-4,.0011,.0015,.0011,3e-4,2e-4,8e-4,-4e-4,-8e-4,3e-4,0,.0012,-1e-4],expression:[.026,.1107,.3257,.1917,.3206,-1.1348,1.0791,-.035,.1549,-.0103,.6953,1e-4,-.3262,.068,.0219,-.0044,.3643,.2178,.0168,-.2478,-.1321,-.0414,-.3782,-.0617,.5088,-.0031,-.0311,-.0497,.0948,-.385,.0148,-.2224,-.1415,-.0074,.0863,-.203,3e-4,-.0081,.0057,.1164,-.0039,.0015,-.0024,.0505,.1532,.0039,-.0148,-.0753,.0163,.0058,-.0339,.0036,.0252,-.0569,-.0041,.0163,-.0361,.0035,-.018,.1266,0,-.0163,-.0046,.0133,-.1656,.2134,.0191,.0057,.0734,.0681,.0039,-.0144,.029,-.074,-.046,.0122,.0072,-.0162,-.0349,-.1234,.0212,-.0355,.0535,.1218,.0043,-.024,.0016]},{mean:[-.0018,-.3037,.8491],identity:[2e-4,-.0112,.0077,-4e-4,-.0044,.0024,1e-4,-.0021,-4e-4,-4e-4,.0066,-.002,-4e-4,-.0052,-.0044,3e-4,-.0032,.0039,4e-4,.0042,-3e-4,2e-4,-.0012,-2e-4,-2e-4,.0052,-.0083,-1e-4,-8e-4,-.0056,.0017,.0024,.0019,-.0023,.002,.0027,-2e-4,-.0013,.002,9e-4,.0017,-.0028,-2e-4,.0012,-.0026,0,-.0016,2e-4,-5e-4,3e-4,-.001,-1e-4,.0016,.0016,-3e-4,.0012,.0012,-3e-4,.0027,-3e-4,3e-4,-.0026,.0037,-.0017,1e-4,.0016,1e-4,-.0015,.0024,1e-4,2e-4,-.0039,0,-3e-4,-.0033,-6e-4,.0017,-4e-4,-4e-4,.0012,.0018,2e-4,-.0012,-.002,-.0017,.0013,-.001,3e-4,.0021,4e-4,-.0012,-6e-4,-2e-4,0,-4e-4,-9e-4,.0016,.0017,4e-4,7e-4,7e-4,.001,9e-4,-8e-4,5e-4,5e-4,.0023,.001,.0013,2e-4,-4e-4,2e-4,.0017,8e-4,3e-4,-1e-4,9e-4,-4e-4,.0019,-5e-4,3e-4,0,-.0025,3e-4,3e-4,.0011,1e-4,-.0015,-.001,7e-4,7e-4,-7e-4,-7e-4,8e-4,0,1e-4,.0013,-4e-4,.0012,.0014,.0017,4e-4,2e-4,3e-4,-3e-4,-9e-4,1e-4,0,.001,-4e-4],expression:[-.0092,2.8809,1.416,.2018,1.1982,-.9351,1.4492,-.1902,.1749,.0305,-.167,-.1572,-.7354,-.0492,.0115,.0608,.2971,.1179,.0046,-.0997,-.0041,-.0104,.3379,-.1854,.009,.0366,-.0583,.0269,-.0029,-.4175,-8e-4,.1794,.0752,-.0135,.1158,.1234,5e-4,.003,-.0032,.1034,-.0504,-.0055,-.0076,-.0772,.224,.0047,.0229,-.1044,.0162,-.0161,-.0241,-.0083,-.1388,-.0434,-.0125,-.0997,-.0327,-.0111,.1576,-.3911,.0199,.2522,.142,.0059,-.0721,-.0045,.031,-.1136,-.1685,.0641,.0142,.0312,.0426,-.1366,.1011,.0101,-.0157,.0018,-.0103,-.0344,.0907,.0016,.1168,-.0806,.0104,-.0057,.0111]}],10:{mean:[-.007,-.6338,.7695],identity:[1e-4,-.0296,.0089,-6e-4,-.0073,-.0065,-1e-4,-.0029,-.0031,-2e-4,.0128,.0065,0,-.0116,-.014,-1e-4,-.0037,-.0052,-5e-4,.0028,.003,-4e-4,.0041,.0015,6e-4,.0088,-.0076,-.0011,-.0015,-.0073,7e-4,-.0011,.0019,-.0011,-5e-4,.0031,-1e-4,-.0018,9e-4,.0018,.0038,.0068,-4e-4,-1e-4,.0061,.0024,.0024,-.0066,-6e-4,.0051,.0014,.002,.005,-.0035,1e-4,-.0034,-.004,-7e-4,.001,-8e-4,1e-4,-5e-4,-.0021,2e-4,.0045,-.0043,-.0012,-.0024,-.0014,6e-4,.0034,.0027,-8e-4,-.0053,.0014,1e-4,.0013,-.0018,6e-4,-.0015,.0029,-2e-4,-.0035,1e-4,-.002,.0012,.0048,.0011,1e-4,-2e-4,-3e-4,-.0012,.0033,6e-4,.002,-.0033,4e-4,.0028,2e-4,8e-4,-1e-4,-.0018,8e-4,.0017,1e-4,9e-4,8e-4,3e-4,.0019,-.001,.001,-7e-4,-.0013,0,1e-4,.0032,-1e-4,1e-4,.0011,-4e-4,5e-4,-7e-4,.0018,-3e-4,2e-4,7e-4,8e-4,-.0014,7e-4,.0015,-6e-4,-1e-4,-4e-4,.0019,-9e-4,-6e-4,-6e-4,-.0012,2e-4,-.0012,-8e-4,4e-4,6e-4,-.0011,3e-4,9e-4,-4e-4,6e-4,-7e-4,-4e-4],expression:[-.0603,2.0527,1.9014,.1025,.6143,.3804,.7881,-.1023,-.0764,.0454,-.2487,-.5073,-.6704,-.031,-.0181,.0466,.0651,-.0726,-.0033,-.0022,.2944,.0101,.1669,-.5225,-.4685,.0236,.0079,.011,.2173,.4529,.0121,-.2104,-.0673,.0225,-.4023,.0317,-9e-4,.0076,-.0032,.0333,.0523,.0129,-.001,-.0319,-.0139,.0015,-.0044,.0247,-5e-4,.0161,.0061,.0074,.0776,-.0176,.007,.055,-.017,.0052,-.1819,.0294,-.0161,-.0337,.0226,-.008,-.0297,.1967,-.0095,.0383,.2039,.0434,.0271,-.0064,-.0037,-.0294,-.024,.0024,-.0137,-.0209,-.0031,.0628,.1003,-.0126,-.056,-.0097,-.0012,-.0041,.0162]},11:{mean:[.2505,.3833,.7793],identity:[.0098,.012,.0077,-6e-4,-3e-4,0,1e-4,.0082,-7e-4,.0019,-.0036,-.0012,2e-4,.0119,-.0039,.001,1e-4,.0031,-.0036,-.0059,-7e-4,.0026,.0028,-.0011,9e-4,-.0032,8e-4,.0029,.0043,3e-4,.0025,-9e-4,.0047,.0016,.0022,.0018,-.001,.0025,-.003,-.001,.0033,.0034,4e-4,-.0052,.0024,-2e-4,.001,-.0014,-6e-4,.0038,-.0015,-6e-4,-.001,-.0011,-4e-4,-.001,4e-4,-7e-4,.0036,-8e-4,-2e-4,-.0019,5e-4,3e-4,-6e-4,-.0024,-.0017,-.0014,6e-4,-4e-4,-.0031,-.0013,-6e-4,.0042,2e-4,-2e-4,-.002,-3e-4,8e-4,.0018,-5e-4,-6e-4,-2e-4,-6e-4,.0025,.0019,.001,8e-4,-.0015,-.0012,-1e-4,-6e-4,-4e-4,.0023,-.001,6e-4,-2e-4,-.001,0,-9e-4,-.002,-.0011,1e-4,0,-1e-4,5e-4,6e-4,9e-4,-6e-4,5e-4,8e-4,-1e-4,-2e-4,-.0017,-6e-4,-4e-4,4e-4,-6e-4,.0012,4e-4,3e-4,-7e-4,3e-4,-2e-4,6e-4,1e-4,5e-4,-.0019,-6e-4,4e-4,7e-4,-1e-4,1e-4,5e-4,.001,-6e-4,-.002,-7e-4,-5e-4,5e-4,3e-4,7e-4,.0014,0,5e-4,-5e-4,-2e-4,3e-4,-6e-4,-1e-4],expression:[-9e-4,-3e-4,.0032,-.003,-.0034,-.0031,.0014,0,4e-4,-.0139,-.0764,.0275,-.002,-.0089,.0031,-.0503,-.0771,.038,-.1323,-.3523,.1368,-.0474,-.0564,.0296,-.0045,.007,-.0013,.0153,.1259,-.0464,.0866,.2175,-.0786,-.0413,-.1248,.0448,-.1777,-.4607,.1782,-5e-4,-.005,.0016,.0629,.1506,-.0624,.0545,.2576,-.0864,-.0231,-.0552,.0244,-.0136,-.0359,.0169,-.1158,-.2996,.1214,-.0235,-.0354,.0165,-.0745,-.1079,.0475,-.0116,-.0039,.0012,.0013,-.0108,-8e-4,.0044,-.0027,-1e-4,-.0694,.0363,.0071,.1462,-.136,.0047,.009,-.0177,.0038,-.0271,.0118,.0011,-.0399,-.0111,.0123]},12:{mean:[-.2981,.3828,.7563],identity:[-.0116,.014,.0054,.0018,5e-4,0,-4e-4,.0068,-.0013,-.0019,-.0048,-5e-4,5e-4,.0108,-.0036,-.0029,-.0018,.0029,.0043,-.0077,6e-4,-.0017,.002,-.0011,-.0014,-.0035,.0015,-.0024,.0011,4e-4,-.0048,2e-4,.0029,-1e-4,-1e-4,.003,.0019,.0035,-.0016,-4e-4,.0039,.0019,1e-4,-.0064,.004,3e-4,.002,-.0021,.0017,.0011,-.001,.0026,.0025,-5e-4,2e-4,-3e-4,-5e-4,-7e-4,9e-4,-4e-4,-.001,-.0022,.001,9e-4,-.0014,7e-4,.0011,-.001,-5e-4,-8e-4,-.0017,-.0021,9e-4,.0036,5e-4,4e-4,-.0031,6e-4,-.0015,.0027,2e-4,1e-4,-.0011,2e-4,-.0011,-.0018,4e-4,-.0013,-2e-4,7e-4,9e-4,-3e-4,.001,-.0021,8e-4,6e-4,-9e-4,4e-4,-7e-4,8e-4,-.002,-.0013,0,7e-4,-.0012,-1e-4,.0014,.0014,-1e-4,.0013,6e-4,6e-4,-.0014,-.0015,-9e-4,1e-4,1e-4,9e-4,7e-4,0,1e-4,-.001,-4e-4,0,-5e-4,1e-4,-3e-4,4e-4,-5e-4,-1e-4,-.0011,2e-4,0,1e-4,8e-4,8e-4,0,-7e-4,-8e-4,0,2e-4,-1e-4,.001,3e-4,4e-4,-2e-4,0,5e-4,.0018,-1e-4],expression:[0,-4e-4,.0028,.0036,-8e-4,-.0026,-.0015,-8e-4,3e-4,.0075,-.0608,.025,.0019,-.0076,.0033,.0379,-.0437,.0335,.0964,-.2452,.1233,.0368,-.0251,.0253,.0033,.0097,-.0021,-.0095,.1171,-.0475,-.064,.1548,-.0718,.0228,-.0831,.0343,-.1924,.6206,-.2771,.0021,-.0143,.0056,-.0705,.2522,-.1116,-.0692,.4229,-.1592,-.0093,.05,-.0185,.0948,-.3196,.1437,-.0184,.0194,-.0131,.0205,-.0353,.0201,.0676,-.135,.0672,.0137,-.0311,.0118,3e-4,-.0077,-2e-4,-.0151,4e-4,-.0058,.029,-.0139,.0163,.1324,.1819,-.0039,.0406,.0501,.0017,.0331,.0161,.0062,-.0235,-.0446,.0047]}}},2372:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.FaceMesh=t.getFaceMesh=t.destroyFaceMesh=t.createFaceMesh=void 0;var a=n(2e3),o=n(7117),s=1,u=new Map;t.createFaceMesh=function(){var e=s++;return u.set(e,new l),o.zcout("face_mesh_t initialized"),e},t.destroyFaceMesh=function(e){u.delete(e)},t.getFaceMesh=function(e){return u.get(e)};var l=function(){function e(){r(this,e),this.render_mean_=new Float32Array,this.render_identity_=new Float32Array(50),this.render_expression_=new Float32Array(29),this.render_uvs_=new Float32Array,this.render_indices_=new Uint16Array,this.vertices_=new Float32Array,this.normals_=new Float32Array,this.normalsCalculated_=!1,this.modelVersion_=-1,this.mirrored_=!1}return i(e,[{key:"loadFromMemory",value:function(e,t,n,r,i){var a=0,o=new Uint16Array(e),s=new Int32Array(e),u=new Float32Array(e),l=function(){var e=s[a++]*s[a++],t=u.subarray(a,a+e);return a+=e,t},c=function(){var e=s[a++],t=o.subarray(2*a,2*a+e);return a+=e/2,t};this.render_mean_=l(),this.render_identity_=l(),this.render_expression_=l(),this.render_uvs_=l();var g=c(),d=a<s.length?c():new Uint16Array,I=a<s.length?c():new Uint16Array,C=a<s.length?c():new Uint16Array,h=a<s.length?c():new Uint16Array;if(t||n||r||i){var f=g.length;t&&(f+=d.length),n&&(f+=I.length),r&&(f+=C.length),i&&(f+=h.length),this.render_indices_=new Uint16Array(f),this.render_indices_.set(g,0);var p=g.length;t&&(this.render_indices_.set(d,p),p+=d.length),n&&(this.render_indices_.set(I,p),p+=I.length),r&&(this.render_indices_.set(C,p),p+=C.length),i&&(this.render_indices_.set(h,p),p+=h.length)}else this.render_indices_=g;this.vertices_=new Float32Array(this.render_mean_),this.normals_=new Float32Array(this.vertices_.length),this.modelVersion_++}},{key:"getVertices",value:function(){return this.vertices_}},{key:"getUVs",value:function(){return this.render_uvs_}},{key:"getIndices",value:function(){if(this.mirrored_){if(!this.render_indices_reversed){this.render_indices_reversed=new Uint16Array(this.render_indices_.length);for(var e=0;e<this.render_indices_.length;e+=3)this.render_indices_reversed[e]=this.render_indices_[e+2],this.render_indices_reversed[e+1]=this.render_indices_[e+1],this.render_indices_reversed[e+2]=this.render_indices_[e]}return this.render_indices_reversed}return this.render_indices_}},{key:"getNormals",value:function(){return this.normalsCalculated_||this.calculateNormals(),this.normals_}},{key:"getModelVersion",value:function(){return this.modelVersion_}},{key:"getLandmarkDataForVertex",value:function(e){for(var t=[this.render_mean_[3*e],this.render_mean_[3*e+1],this.render_mean_[3*e+2]],n=[],r=0;r<50;r++)n.push(this.render_identity_[3*e*50+r]),n.push(this.render_identity_[50*(3*e+1)+r]),n.push(this.render_identity_[50*(3*e+2)+r]);for(var i=[],a=0;a<29;a++)i.push(this.render_expression_[3*e*29+a]),i.push(this.render_expression_[29*(3*e+1)+a]),i.push(this.render_expression_[29*(3*e+2)+a]);return{mean:t,identity:n,expression:i}}},{key:"update",value:function(e,t,n){if(0!==this.render_mean_.length&&0!==this.render_identity_.length&&0!==this.render_expression_.length){this.mirrored_=n,this.vertices_.set(this.render_mean_);for(var r=0;r<e.length;r++)for(var i=0;i<this.vertices_.length;i++)this.vertices_[i]+=e[r]*this.render_identity_[i*e.length+r];for(var a=0;a<t.length;a++)for(var o=0;o<this.vertices_.length;o++)this.vertices_[o]+=t[a]*this.render_expression_[o*t.length+a];if(n)for(var s=0;s<this.vertices_.length;s+=3)this.vertices_[s]*=-1;this.normalsCalculated_=!1}}},{key:"calculateNormals",value:function(){var e=this.getIndices(),t=this.vertices_,n=new Float32Array(e.length);if(t){for(var r=e.length,i=this.normals_,o=new Float32Array([0,0,0]),s=new Float32Array([0,0,0]),u=new Float32Array([0,0,0]),l=0;l<r;l+=3){var c=3*e[l],g=3*e[l+1],d=3*e[l+2];o[0]=t[g]-t[c],o[1]=t[g+1]-t[c+1],o[2]=t[g+2]-t[c+2],s[0]=t[d]-t[c],s[1]=t[d+1]-t[c+1],s[2]=t[d+2]-t[c+2],a.vec3.cross(u,o,s);var I=a.vec3.length(u);n[l]=u[0]/I,n[l+1]=u[1]/I,n[l+2]=u[2]/I}i.fill(0);for(var C=0;C<r;C+=3){var h=3*e[C],f=3*e[C+1],p=3*e[C+2];i[h]+=n[C],i[h+1]+=n[C+1],i[h+2]+=n[C+2],i[f]+=n[C],i[f+1]+=n[C+1],i[f+2]+=n[C+2],i[p]+=n[C],i[p+1]+=n[C+1],i[p+2]+=n[C+2]}for(var A=i.length/3,m=0;m<A;m++){var v=3*m;o[0]=i[v],o[1]=i[v+1],o[2]=i[v+2],a.vec3.normalize(s,o),i[v]=s[0],i[v+1]=s[1],i[v+2]=s[2]}this.normalsCalculated_=!0}}}]),e}();t.FaceMesh=l},4657:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.zappar_client=void 0;var a=n(2363),o=n(2735),s=function(){function e(t){var n=this;r(this,e),this._messageSender=t,this._globalState={log_level:1},this.serializer=new a.MessageSerializer((function(e){n._messageSender(e)})),this.deserializer=new o.MessageDeserializer,this._latestId=1,this._pipeline_state_by_instance=new Map,this._camera_source_state_by_instance=new Map,this._image_tracker_state_by_instance=new Map,this._face_tracker_state_by_instance=new Map,this._face_mesh_state_by_instance=new Map,this._face_landmark_state_by_instance=new Map,this._barcode_finder_state_by_instance=new Map,this._instant_world_tracker_state_by_instance=new Map,this.impl={log_level:function(){return n._globalState.log_level},log_level_set:function(e){n.serializer.sendMessage(33,(function(t){t.logLevel(e)}))},analytics_project_id_set:function(e){n.serializer.sendMessage(30,(function(t){t.string(e)}))},pipeline_create:function(){var e=n._latestId++,t={current_frame_user_data:0,camera_model:new Float32Array([300,300,160,120,0,0]),camera_pose:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),camera_frame_camera_attitude:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),frame_number:0};return n._pipeline_state_by_instance.set(e,t),n.serializer.sendMessage(26,(function(t){t.type(e)})),e},pipeline_destroy:function(e){if(!n._pipeline_state_by_instance.get(e))throw new Error("This object has been destroyed");n._pipeline_state_by_instance.delete(e),n.serializer.sendMessage(27,(function(t){t.type(e)}))},pipeline_frame_update:function(e){if(!n._pipeline_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(9,(function(t){t.type(e)}))},pipeline_frame_number:function(e){var t=n._pipeline_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.frame_number},pipeline_camera_model:function(e){var t=n._pipeline_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.camera_model},pipeline_camera_frame_user_data:function(e){var t=n._pipeline_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.current_frame_user_data},pipeline_camera_frame_submit:function(e,t,r,i,a,o){if(!n._pipeline_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(8,(function(n){n.type(e),n.dataWithLength(t),n.int(r),n.int(i),n.int(a),n.matrix4x4(o)}))},pipeline_camera_frame_camera_attitude:function(e){var t=n._pipeline_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.camera_frame_camera_attitude},pipeline_motion_accelerometer_submit:function(e,t,r,i,a){if(!n._pipeline_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(10,(function(n){n.type(e),n.timestamp(t),n.float(r),n.float(i),n.float(a)}))},pipeline_motion_rotation_rate_submit:function(e,t,r,i,a){if(!n._pipeline_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(11,(function(n){n.type(e),n.timestamp(t),n.float(r),n.float(i),n.float(a)}))},pipeline_motion_attitude_submit:function(e,t,r,i,a){if(!n._pipeline_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(12,(function(n){n.type(e),n.timestamp(t),n.float(r),n.float(i),n.float(a)}))},camera_source_create:function(e,t){var r=n._latestId++;return n._camera_source_state_by_instance.set(r,{}),n.serializer.sendMessage(28,(function(n){n.type(r),n.type(e),n.string(t)})),r},camera_source_destroy:function(e){if(!n._camera_source_state_by_instance.get(e))throw new Error("This object has been destroyed");n._camera_source_state_by_instance.delete(e),n.serializer.sendMessage(29,(function(t){t.type(e)}))},image_tracker_create:function(e){var t=n._latestId++;return n._image_tracker_state_by_instance.set(t,{enabled:!0,target_loaded_version:-1,target_count:0,anchor_count:0,anchor_id:[],anchor_pose:[]}),n.serializer.sendMessage(2,(function(n){n.type(t),n.type(e)})),t},image_tracker_destroy:function(e){if(!n._image_tracker_state_by_instance.get(e))throw new Error("This object has been destroyed");n._image_tracker_state_by_instance.delete(e),n.serializer.sendMessage(13,(function(t){t.type(e)}))},image_tracker_target_load_from_memory:function(e,t){if(!n._image_tracker_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(4,(function(n){n.type(e),n.dataWithLength(t)}))},image_tracker_target_loaded_version:function(e){var t=n._image_tracker_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.target_loaded_version},image_tracker_target_count:function(e){var t=n._image_tracker_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.target_count},image_tracker_enabled:function(e){var t=n._image_tracker_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.enabled},image_tracker_enabled_set:function(e,t){if(!n._image_tracker_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(3,(function(n){n.type(e),n.bool(t)}))},image_tracker_anchor_count:function(e){var t=n._image_tracker_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.anchor_count},image_tracker_anchor_id:function(e,t){var r=n._image_tracker_state_by_instance.get(e);if(!r)throw new Error("This object has been destroyed");return r.anchor_id[t]},image_tracker_anchor_pose_raw:function(e,t){var r=n._image_tracker_state_by_instance.get(e);if(!r)throw new Error("This object has been destroyed");return r.anchor_pose[t]},face_tracker_create:function(e){var t=n._latestId++;return n._face_tracker_state_by_instance.set(t,{enabled:!0,model_loaded:-1,max_faces:1,anchor_count:0,anchor_id:[],anchor_pose:[],anchor_identity_coefficients:[],anchor_expression_coefficients:[]}),n.serializer.sendMessage(19,(function(n){n.type(t),n.type(e)})),t},face_tracker_destroy:function(e){if(!n._face_tracker_state_by_instance.get(e))throw new Error("This object has been destroyed");n._face_tracker_state_by_instance.delete(e),n.serializer.sendMessage(20,(function(t){t.type(e)}))},face_tracker_model_load_from_memory:function(e,t){if(!n._face_tracker_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(21,(function(n){n.type(e),n.dataWithLength(t)}))},face_tracker_model_loaded_version:function(e){var t=n._face_tracker_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.model_loaded},face_tracker_enabled_set:function(e,t){if(!n._face_tracker_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(22,(function(n){n.type(e),n.bool(t)}))},face_tracker_enabled:function(e){var t=n._face_tracker_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.enabled},face_tracker_max_faces_set:function(e,t){if(!n._face_tracker_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(23,(function(n){n.type(e),n.int(t)}))},face_tracker_max_faces:function(e){var t=n._face_tracker_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.max_faces},face_tracker_anchor_count:function(e){var t=n._face_tracker_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.anchor_count},face_tracker_anchor_id:function(e,t){var r=n._face_tracker_state_by_instance.get(e);if(!r)throw new Error("This object has been destroyed");return r.anchor_id[t]},face_tracker_anchor_pose_raw:function(e,t){var r=n._face_tracker_state_by_instance.get(e);if(!r)throw new Error("This object has been destroyed");return r.anchor_pose[t]},face_tracker_anchor_identity_coefficients:function(e,t){var r=n._face_tracker_state_by_instance.get(e);if(!r)throw new Error("This object has been destroyed");return r.anchor_identity_coefficients[t]},face_tracker_anchor_expression_coefficients:function(e,t){var r=n._face_tracker_state_by_instance.get(e);if(!r)throw new Error("This object has been destroyed");return r.anchor_expression_coefficients[t]},face_mesh_create:function(){var e=n._latestId++;return n._face_mesh_state_by_instance.set(e,{}),n.serializer.sendMessage(24,(function(t){t.type(e)})),e},face_mesh_destroy:function(e){if(!n._face_mesh_state_by_instance.get(e))throw new Error("This object has been destroyed");n._face_mesh_state_by_instance.delete(e),n.serializer.sendMessage(25,(function(t){t.type(e)}))},face_landmark_create:function(e){var t=n._latestId++;return n._face_landmark_state_by_instance.set(t,{}),n.serializer.sendMessage(31,(function(n){n.type(t),n.faceLandmarkName(e)})),t},face_landmark_destroy:function(e){if(!n._face_landmark_state_by_instance.get(e))throw new Error("This object has been destroyed");n._face_landmark_state_by_instance.delete(e),n.serializer.sendMessage(32,(function(t){t.type(e)}))},barcode_finder_create:function(e){var t=n._latestId++;return n._barcode_finder_state_by_instance.set(t,{enabled:!0,number_found:0,found_text:[],found_format:[],formats:131071}),n.serializer.sendMessage(15,(function(n){n.type(t),n.type(e)})),t},barcode_finder_destroy:function(e){if(!n._barcode_finder_state_by_instance.get(e))throw new Error("This object has been destroyed");n._barcode_finder_state_by_instance.delete(e),n.serializer.sendMessage(16,(function(t){t.type(e)}))},barcode_finder_enabled_set:function(e,t){if(!n._barcode_finder_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(17,(function(n){n.type(e),n.bool(t)}))},barcode_finder_enabled:function(e){var t=n._barcode_finder_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.enabled},barcode_finder_found_number:function(e){var t=n._barcode_finder_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.number_found},barcode_finder_found_text:function(e,t){var r=n._barcode_finder_state_by_instance.get(e);if(!r)throw new Error("This object has been destroyed");return r.found_text[t]},barcode_finder_found_format:function(e,t){var r=n._barcode_finder_state_by_instance.get(e);if(!r)throw new Error("This object has been destroyed");return r.found_format[t]},barcode_finder_formats:function(e){var t=n._barcode_finder_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.formats},barcode_finder_formats_set:function(e,t){if(!n._barcode_finder_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(18,(function(n){n.type(e),n.barcodeFormat(t)}))},instant_world_tracker_create:function(e){var t=n._latestId++,r={enabled:!0,pose:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};return n._instant_world_tracker_state_by_instance.set(t,r),n.serializer.sendMessage(5,(function(n){n.type(t),n.type(e)})),t},instant_world_tracker_destroy:function(e){if(!n._instant_world_tracker_state_by_instance.get(e))throw new Error("This object has been destroyed");n._instant_world_tracker_state_by_instance.delete(e),n.serializer.sendMessage(14,(function(t){t.type(e)}))},instant_world_tracker_enabled_set:function(e,t){if(!n._instant_world_tracker_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(6,(function(n){n.type(e),n.bool(t)}))},instant_world_tracker_enabled:function(e){var t=n._instant_world_tracker_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.enabled},instant_world_tracker_anchor_pose_raw:function(e){var t=n._instant_world_tracker_state_by_instance.get(e);if(!t)throw new Error("This object has been destroyed");return t.pose},instant_world_tracker_anchor_pose_set_from_camera_offset:function(e,t,r,i,a){if(!n._instant_world_tracker_state_by_instance.get(e))throw new Error("This object has been destroyed");n.serializer.sendMessage(7,(function(n){n.type(e),n.float(t),n.float(r),n.float(i),n.instantTrackerTransformOrientation(a)}))}}}return i(e,[{key:"processMessages",value:function(e){var t=this;this.deserializer.setData(e),this.deserializer.forMessages((function(e,n){switch(e){case 7:var r=n.type(),i=t._pipeline_state_by_instance.get(r);if(!i)return;i.frame_number=n.int();break;case 6:var a=n.type(),o=t._pipeline_state_by_instance.get(a);if(!o)return;o.camera_model=n.cameraModel();break;case 5:var s=n.type(),u=t._pipeline_state_by_instance.get(s);if(!u)return;u.current_frame_user_data=n.int();break;case 11:var l=n.type(),c=t._pipeline_state_by_instance.get(l);if(!c)return;c.camera_frame_camera_attitude=n.matrix4x4();break;case 18:var g=n.type(),d=t._image_tracker_state_by_instance.get(g);if(!d)return;d.target_loaded_version=n.int();break;case 20:var I=n.type(),C=t._image_tracker_state_by_instance.get(I);if(!C)return;C.target_count=n.int();break;case 1:var h=n.type(),f=t._image_tracker_state_by_instance.get(h);if(!f)return;f.anchor_count=n.int();break;case 2:var p=n.type(),A=t._image_tracker_state_by_instance.get(p);if(!A)return;var m=n.int();A.anchor_id[m]=n.string();break;case 3:var v=n.type(),b=t._image_tracker_state_by_instance.get(v);if(!b)return;var y=n.int();b.anchor_pose[y]=n.matrix4x4();break;case 17:var B=n.type(),G=t._face_tracker_state_by_instance.get(B);if(!G)return;G.model_loaded=n.int();break;case 12:var Z=n.type(),w=t._face_tracker_state_by_instance.get(Z);if(!w)return;w.anchor_count=n.int();break;case 13:var _=n.type(),x=t._face_tracker_state_by_instance.get(_);if(!x)return;var S=n.int();x.anchor_id[S]=n.string();break;case 14:var R=n.type(),M=t._face_tracker_state_by_instance.get(R);if(!M)return;var W=n.int();M.anchor_pose[W]=n.matrix4x4();break;case 15:var k=n.type(),V=t._face_tracker_state_by_instance.get(k);if(!V)return;var F=n.int();V.anchor_identity_coefficients[F]=n.identityCoefficients();break;case 16:var E=n.type(),X=t._face_tracker_state_by_instance.get(E);if(!X)return;var H=n.int();X.anchor_expression_coefficients[H]=n.expressionCoefficients();break;case 8:var L=n.type(),z=t._barcode_finder_state_by_instance.get(L);if(!z)return;z.number_found=n.int();break;case 9:var N=n.type(),Y=t._barcode_finder_state_by_instance.get(N);if(!Y)return;var T=n.int();Y.found_text[T]=n.string();break;case 10:var K=n.type(),D=t._barcode_finder_state_by_instance.get(K);if(!D)return;var P=n.int();D.found_format[P]=n.barcodeFormat();break;case 4:var U=n.type(),O=t._instant_world_tracker_state_by_instance.get(U);if(!O)return;O.pose=n.matrix4x4()}}))}}]),e}();t.zappar_client=s},9719:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log_level_t=t.instant_world_tracker_transform_orientation_t=t.face_landmark_name_t=t.barcode_format_t=void 0,function(e){e[e.UNKNOWN=131072]="UNKNOWN",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=4]="CODE_39",e[e.CODE_93=8]="CODE_93",e[e.CODE_128=16]="CODE_128",e[e.DATA_MATRIX=32]="DATA_MATRIX",e[e.EAN_8=64]="EAN_8",e[e.EAN_13=128]="EAN_13",e[e.ITF=256]="ITF",e[e.MAXICODE=512]="MAXICODE",e[e.PDF_417=1024]="PDF_417",e[e.QR_CODE=2048]="QR_CODE",e[e.RSS_14=4096]="RSS_14",e[e.RSS_EXPANDED=8192]="RSS_EXPANDED",e[e.UPC_A=16384]="UPC_A",e[e.UPC_E=32768]="UPC_E",e[e.UPC_EAN_EXTENSION=65536]="UPC_EAN_EXTENSION",e[e.ALL=131071]="ALL"}(t.barcode_format_t||(t.barcode_format_t={})),function(e){e[e.EYE_LEFT=0]="EYE_LEFT",e[e.EYE_RIGHT=1]="EYE_RIGHT",e[e.EAR_LEFT=2]="EAR_LEFT",e[e.EAR_RIGHT=3]="EAR_RIGHT",e[e.NOSE_BRIDGE=4]="NOSE_BRIDGE",e[e.NOSE_TIP=5]="NOSE_TIP",e[e.NOSE_BASE=6]="NOSE_BASE",e[e.LIP_TOP=7]="LIP_TOP",e[e.LIP_BOTTOM=8]="LIP_BOTTOM",e[e.MOUTH_CENTER=9]="MOUTH_CENTER",e[e.CHIN=10]="CHIN",e[e.EYEBROW_LEFT=11]="EYEBROW_LEFT",e[e.EYEBROW_RIGHT=12]="EYEBROW_RIGHT"}(t.face_landmark_name_t||(t.face_landmark_name_t={})),function(e){e[e.WORLD=3]="WORLD",e[e.MINUS_Z_AWAY_FROM_USER=4]="MINUS_Z_AWAY_FROM_USER",e[e.MINUS_Z_HEADING=5]="MINUS_Z_HEADING",e[e.UNCHANGED=6]="UNCHANGED"}(t.instant_world_tracker_transform_orientation_t||(t.instant_world_tracker_transform_orientation_t={})),function(e){e[e.LOG_LEVEL_NONE=0]="LOG_LEVEL_NONE",e[e.LOG_LEVEL_ERROR=1]="LOG_LEVEL_ERROR",e[e.LOG_LEVEL_WARNING=2]="LOG_LEVEL_WARNING",e[e.LOG_LEVEL_VERBOSE=3]="LOG_LEVEL_VERBOSE"}(t.log_level_t||(t.log_level_t={}))},6501:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log_level_t=t.instant_world_tracker_transform_orientation_t=t.face_landmark_name_t=t.barcode_format_t=void 0;var r=n(9719);Object.defineProperty(t,"barcode_format_t",{enumerable:!0,get:function(){return r.barcode_format_t}});var i=n(9719);Object.defineProperty(t,"face_landmark_name_t",{enumerable:!0,get:function(){return i.face_landmark_name_t}});var a=n(9719);Object.defineProperty(t,"instant_world_tracker_transform_orientation_t",{enumerable:!0,get:function(){return a.instant_world_tracker_transform_orientation_t}});var o=n(9719);Object.defineProperty(t,"log_level_t",{enumerable:!0,get:function(){return o.log_level_t}})},2637:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.GLStateManager=void 0;var a=new Map,o=function(){function e(t){var n=this;r(this,e),this._gl=t,this._viewports=[],this._underlyingViewport=this._gl.viewport,this._viewports.push(this._gl.getParameter(this._gl.VIEWPORT)),this._gl.viewport=function(e,t,r,i){n._viewports[n._viewports.length-1]=[e,t,r,i],n._underlyingViewport.call(n._gl,e,t,r,i)}}return i(e,[{key:"push",value:function(){this._viewports.push(this._viewports[this._viewports.length-1])}},{key:"pop",value:function(){var e=this._viewports.pop(),t=this._viewports[this._viewports.length-1];e&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]||this._underlyingViewport.call(this._gl,t[0],t[1],t[2],t[3])}}],[{key:"get",value:function(t){var n=a.get(t);return n||(n=new e(t),a.set(t,n)),n}}]),e}();t.GLStateManager=o},633:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(1506).default,o=n(2205).default,s=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.HTMLElementSource=void 0;var u=n(4985),l=n(4706),c=n(5729),g=n(7916),d=n(2e3),I=n(7117),C=n(2637),h=1,f=new Map,p=function(e){o(n,e);var t=s(n);function n(e,i){var o;r(this,n),(o=t.call(this))._video=e,o._pipeline=i,o._isPaused=!0,o._hadFrames=!1,o._isUserFacing=!1,o._cameraToScreenRotation=0,o._isUploadFrame=!0,o._computedTransformRotation=-1,o._computedFrontCameraRotation=!1,o._cameraUvTransform=d.mat4.create(),o._cameraVertexTransform=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o._framebufferWidth=0,o._framebufferHeight=0,o._framebufferId=null,o._renderTexture=null;var s=o._video;o._video instanceof HTMLVideoElement?s.addEventListener("loadedmetadata",(function(){o._hadFrames=!0})):o._hadFrames=!0,o._resetGLContext=o._resetGLContext.bind(a(o));var l=u.Pipeline.get(o._pipeline);return l&&l.onGLContextReset.bind(o._resetGLContext),o}return i(n,[{key:"_resetGLContext",value:function(){this._currentVideoTexture=void 0,this._framebufferId=null,this._renderTexture=null,this._vertexBuffer=void 0,this._indexBuffer=void 0,this._greyscaleShader=void 0}},{key:"destroy",value:function(){var e=u.Pipeline.get(this._pipeline);e&&e.onGLContextReset.unbind(this._resetGLContext),this.pause(),this._resetGLContext()}},{key:"pause",value:function(){this._isPaused=!0;var e=u.Pipeline.get(this._pipeline);e&&e.currentCameraSource===this&&(e.currentCameraSource=void 0)}},{key:"start",value:function(){var e;this._isPaused&&(this._isUploadFrame=!0,this._video instanceof HTMLVideoElement&&(this._hadFrames=!1)),this._isPaused=!1;var t=u.Pipeline.get(this._pipeline);t&&t.currentCameraSource!==this&&(null===(e=t.currentCameraSource)||void 0===e||e.pause(),t.currentCameraSource=this)}},{key:"getFrame",value:function(e){var t=u.Pipeline.get(this._pipeline);if(t){var n=t.glContext;if(n&&!this._isPaused&&this._hadFrames)try{return this._processFrame(n,this._cameraToScreenRotation,e)}catch(r){console.log("Unable to process frame")}}}},{key:"_processFrame",value:function(e,t,n){var r=u.Pipeline.get(this._pipeline);if(r){if(this._isUploadFrame)return this._currentVideoTexture||(this._currentVideoTexture=r.getVideoTexture()),this._uploadFrame(t,this._isUserFacing),void(this._isUploadFrame=!this._isUploadFrame);if(!n)return this._isUploadFrame=!this._isUploadFrame,this._readFrame(r,e)}}},{key:"_uploadFrame",value:function(e,t){if(this._currentVideoTexture){var n=u.Pipeline.get(this._pipeline);if(n){var r=n.glContext;if(r){var i=C.GLStateManager.get(r);i.push();var a=r.isEnabled(r.SCISSOR_TEST),o=r.isEnabled(r.DEPTH_TEST),s=r.isEnabled(r.BLEND),l=r.isEnabled(r.CULL_FACE),g=r.getParameter(r.ACTIVE_TEXTURE),d=r.getParameter(r.UNPACK_FLIP_Y_WEBGL),I=r.getParameter(r.CURRENT_PROGRAM);r.activeTexture(r.TEXTURE0);var h=r.getParameter(r.TEXTURE_BINDING_2D),f=r.getParameter(r.FRAMEBUFFER_BINDING),p=r.getParameter(r.ARRAY_BUFFER_BINDING),A=r.getParameter(r.ELEMENT_ARRAY_BUFFER_BINDING);r.disable(r.SCISSOR_TEST),r.disable(r.DEPTH_TEST),r.disable(r.BLEND),r.disable(r.CULL_FACE),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),r.bindTexture(r.TEXTURE_2D,this._currentVideoTexture);var m=r.RGBA,v=r.RGBA,b=r.UNSIGNED_BYTE;r.texImage2D(r.TEXTURE_2D,0,m,v,b,this._video);var y=0,B=0;this._video instanceof HTMLVideoElement?(y=this._video.videoWidth,B=this._video.videoHeight):(y=this._video.width,B=this._video.height),B>y&&(B=[y,y=B][0]),this._updateTransforms(e,t);var G=this._getFramebuffer(r,c.profile.dataWidth/4,c.profile.dataHeight),Z=this._getVertexBuffer(r),w=this._getIndexBuffer(r),_=this._getGreyscaleShader(r),x=r.getVertexAttrib(_.aVertexPositionLoc,r.VERTEX_ATTRIB_ARRAY_SIZE),S=r.getVertexAttrib(_.aVertexPositionLoc,r.VERTEX_ATTRIB_ARRAY_TYPE),R=r.getVertexAttrib(_.aVertexPositionLoc,r.VERTEX_ATTRIB_ARRAY_NORMALIZED),M=r.getVertexAttrib(_.aVertexPositionLoc,r.VERTEX_ATTRIB_ARRAY_STRIDE),W=r.getVertexAttribOffset(_.aVertexPositionLoc,r.VERTEX_ATTRIB_ARRAY_POINTER),k=r.getVertexAttrib(_.aVertexPositionLoc,r.VERTEX_ATTRIB_ARRAY_ENABLED),V=r.getVertexAttrib(_.aVertexPositionLoc,r.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING),F=r.getVertexAttrib(_.aTextureCoordLoc,r.VERTEX_ATTRIB_ARRAY_SIZE),E=r.getVertexAttrib(_.aTextureCoordLoc,r.VERTEX_ATTRIB_ARRAY_TYPE),X=r.getVertexAttrib(_.aTextureCoordLoc,r.VERTEX_ATTRIB_ARRAY_NORMALIZED),H=r.getVertexAttrib(_.aTextureCoordLoc,r.VERTEX_ATTRIB_ARRAY_STRIDE),L=r.getVertexAttribOffset(_.aTextureCoordLoc,r.VERTEX_ATTRIB_ARRAY_POINTER),z=r.getVertexAttrib(_.aTextureCoordLoc,r.VERTEX_ATTRIB_ARRAY_ENABLED),N=r.getVertexAttrib(_.aTextureCoordLoc,r.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING);r.bindFramebuffer(r.FRAMEBUFFER,G),r.viewport(0,0,this._framebufferWidth,this._framebufferHeight),r.clear(r.COLOR_BUFFER_BIT),r.bindBuffer(r.ARRAY_BUFFER,Z),r.vertexAttribPointer(_.aVertexPositionLoc,2,r.FLOAT,!1,16,0),r.enableVertexAttribArray(_.aVertexPositionLoc),r.vertexAttribPointer(_.aTextureCoordLoc,2,r.FLOAT,!1,16,8),r.enableVertexAttribArray(_.aTextureCoordLoc),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,w),r.useProgram(_.program),r.uniform1f(_.uTexWidthLoc,c.profile.dataWidth),r.uniformMatrix4fv(_.uUvTransformLoc,!1,this._cameraUvTransform),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this._currentVideoTexture),r.uniform1i(_.uSamplerLoc,0),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0),r.bindBuffer(r.ARRAY_BUFFER,V),r.vertexAttribPointer(_.aVertexPositionLoc,x,S,R,M,W),r.bindBuffer(r.ARRAY_BUFFER,N),r.vertexAttribPointer(_.aTextureCoordLoc,F,E,X,H,L),r.bindBuffer(r.ARRAY_BUFFER,p),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,A),k||r.disableVertexAttribArray(_.aVertexPositionLoc),z||r.disableVertexAttribArray(_.aTextureCoordLoc),r.bindFramebuffer(r.FRAMEBUFFER,f),r.useProgram(I),r.bindTexture(r.TEXTURE_2D,h),r.activeTexture(g),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,d),s&&r.enable(r.BLEND),l&&r.enable(r.CULL_FACE),o&&r.enable(r.DEPTH_TEST),a&&r.enable(r.SCISSOR_TEST),i.pop()}}}}},{key:"_readFrame",value:function(e,t){if(!this._currentVideoTexture)throw new Error("No video texture");var n=this._currentVideoTexture;this._currentVideoTexture=void 0;for(var r=c.profile.dataWidth*c.profile.dataHeight,i=e.cameraPixelArrays.pop();i&&i.byteLength!==r;)i=e.cameraPixelArrays.pop();i||(i=new ArrayBuffer(r));var a=new Uint8Array(i),o=t.getParameter(t.FRAMEBUFFER_BINDING),s=this._getFramebuffer(t,c.profile.dataWidth/4,c.profile.dataHeight);return t.bindFramebuffer(t.FRAMEBUFFER,s),t.readPixels(0,0,this._framebufferWidth,this._framebufferHeight,t.RGBA,t.UNSIGNED_BYTE,a),t.bindFramebuffer(t.FRAMEBUFFER,o),{uvTransform:this._cameraUvTransform,data:i,texture:n,dataWidth:c.profile.dataWidth,dataHeight:c.profile.dataHeight,userFacing:this._computedFrontCameraRotation}}},{key:"_updateTransforms",value:function(e,t){e==this._computedTransformRotation&&t==this._computedFrontCameraRotation||(this._computedTransformRotation=e,this._computedFrontCameraRotation=t,this._cameraUvTransform=this._getCameraUvTransform(),this._cameraVertexTransform=this._getCameraVertexTransform())}},{key:"_getCameraUvTransform",value:function(){switch(this._computedTransformRotation){case 270:return new Float32Array([0,1,0,0,-1,0,0,0,0,0,1,0,1,0,0,1]);case 180:return new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,1,1,0,1]);case 90:return new Float32Array([0,-1,0,0,1,0,0,0,0,0,1,0,0,1,0,1])}return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},{key:"_getCameraVertexTransform",value:function(){var e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];if(!this._computedFrontCameraRotation)return e;switch(this._computedTransformRotation){case 0:case 90:case 180:e[0]=-1;break;case 270:e[5]=-1}return e}},{key:"_getFramebuffer",value:function(e,t,n){if(this._framebufferWidth===t&&this._framebufferHeight===n&&this._framebufferId)return this._framebufferId;if(this._framebufferId&&(e.deleteFramebuffer(this._framebufferId),this._framebufferId=null),this._renderTexture&&(e.deleteTexture(this._renderTexture),this._renderTexture=null),this._framebufferId=e.createFramebuffer(),!this._framebufferId)throw new Error("Unable to create framebuffer");if(e.bindFramebuffer(e.FRAMEBUFFER,this._framebufferId),this._renderTexture=e.createTexture(),!this._renderTexture)throw new Error("Unable to create render texture");e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._renderTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,n,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameterf(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._renderTexture,0);var r=e.checkFramebufferStatus(e.FRAMEBUFFER);if(r!==e.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer not complete: "+r.toString());return this._framebufferWidth=t,this._framebufferHeight=n,e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),this._framebufferId}},{key:"_getVertexBuffer",value:function(e){if(this._vertexBuffer)return this._vertexBuffer;if(this._vertexBuffer=e.createBuffer(),!this._vertexBuffer)throw new Error("Unable to create vertex buffer");e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer);var t=new Float32Array([-1,-1,0,0,-1,1,0,1,1,1,1,1,1,-1,1,0]);return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),this._vertexBuffer}},{key:"_getIndexBuffer",value:function(e){if(this._indexBuffer)return this._indexBuffer;if(this._indexBuffer=e.createBuffer(),!this._indexBuffer)throw new Error("Unable to create index buffer");e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer);var t=new Uint16Array([0,1,2,0,2,3]);return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW),this._indexBuffer}},{key:"_getGreyscaleShader",value:function(e){if(this._greyscaleShader)return this._greyscaleShader;var t=e.createProgram();if(!t)throw new Error("Unable to create program");var n=g.compileShader(e,e.VERTEX_SHADER,A),r=g.compileShader(e,e.FRAGMENT_SHADER,m);e.attachShader(t,n),e.attachShader(t,r),g.linkProgram(e,t);var i=e.getUniformLocation(t,"uTexWidth");if(!i)throw new Error("Unable to get uniform location uTexWidth");var a=e.getUniformLocation(t,"uUvTransform");if(!a)throw new Error("Unable to get uniform location uUvTransform");var o=e.getUniformLocation(t,"uSampler");if(!o)throw new Error("Unable to get uniform location uSampler");return this._greyscaleShader={program:t,aVertexPositionLoc:e.getAttribLocation(t,"aVertexPosition"),aTextureCoordLoc:e.getAttribLocation(t,"aTextureCoord"),uTexWidthLoc:i,uUvTransformLoc:a,uSamplerLoc:o},this._greyscaleShader}}],[{key:"createVideoElementSource",value:function(e,t){var r=h++;return f.set(r,new n(t,e)),I.zcout("html_element_source_t initialized"),r}},{key:"getVideoElementSource",value:function(e){return f.get(e)}}]),n}(l.Source);t.HTMLElementSource=p;var A="\n    attribute vec4 aVertexPosition;\n    attribute vec2 aTextureCoord;\n\n    varying highp vec2 vTextureCoord1;\n    varying highp vec2 vTextureCoord2;\n    varying highp vec2 vTextureCoord3;\n    varying highp vec2 vTextureCoord4;\n\n    uniform float uTexWidth;\n\tuniform mat4 uUvTransform;\n\n    void main(void) {\n      highp vec2 offset1 = vec2(1.5 / uTexWidth, 0);\n      highp vec2 offset2 = vec2(0.5 / uTexWidth, 0);\n\n      gl_Position = aVertexPosition;\n      vTextureCoord1 = (uUvTransform * vec4(aTextureCoord - offset1, 0, 1)).xy;\n      vTextureCoord2 = (uUvTransform * vec4(aTextureCoord - offset2, 0, 1)).xy;\n      vTextureCoord3 = (uUvTransform * vec4(aTextureCoord + offset2, 0, 1)).xy;\n      vTextureCoord4 = (uUvTransform * vec4(aTextureCoord + offset1, 0, 1)).xy;\n    }\n",m="\n  varying highp vec2 vTextureCoord1;\n  varying highp vec2 vTextureCoord2;\n  varying highp vec2 vTextureCoord3;\n  varying highp vec2 vTextureCoord4;\n\n  uniform sampler2D uSampler;\n\n  const lowp vec3 colorWeights = vec3(77.0 / 256.0, 150.0 / 256.0, 29.0 / 256.0);\n\n  void main(void) {\n    lowp vec4 outpx;\n\n    outpx.r = dot(colorWeights, texture2D(uSampler, vTextureCoord1).xyz);\n    outpx.g = dot(colorWeights, texture2D(uSampler, vTextureCoord2).xyz);\n    outpx.b = dot(colorWeights, texture2D(uSampler, vTextureCoord3).xyz);\n    outpx.a = dot(colorWeights, texture2D(uSampler, vTextureCoord4).xyz);\n\n    gl_FragColor = outpx;\n  }\n"},5817:function(e,t,n){"use strict";if(Object.defineProperty(t,"__esModule",{value:!0}),t.log_level_t=t.instant_world_tracker_transform_orientation_t=t.face_landmark_name_t=t.barcode_format_t=t.initialize=void 0,"undefined"!==typeof Z_STANDALONE&&Z_STANDALONE&&document.currentScript){var r=new URL(document.currentScript.src),i=r.toString();if(r.pathname){var a=i.split("/");a.pop(),i=a.join("/")+"/"}n.p=i}var o=n(647),s=n(8273);t.initialize=function(){return console.log("Zappar CV v".concat(s.VERSION)),o.initialize()};var u=n(6501);Object.defineProperty(t,"barcode_format_t",{enumerable:!0,get:function(){return u.barcode_format_t}}),Object.defineProperty(t,"face_landmark_name_t",{enumerable:!0,get:function(){return u.face_landmark_name_t}}),Object.defineProperty(t,"instant_world_tracker_transform_orientation_t",{enumerable:!0,get:function(){return u.instant_world_tracker_transform_orientation_t}}),Object.defineProperty(t,"log_level_t",{enumerable:!0,get:function(){return u.log_level_t}})},7117:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zcwarn=t.zcerr=t.zcout=t.setLogLevel=void 0;var r=n(6501),i=r.log_level_t.LOG_LEVEL_ERROR;t.setLogLevel=function(e){i=e},t.zcout=function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];i>=r.log_level_t.LOG_LEVEL_VERBOSE&&(e=console).log.apply(e,["[Zappar] INFO"].concat(n))},t.zcerr=function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];i>=r.log_level_t.LOG_LEVEL_ERROR&&(e=console).error.apply(e,["[Zappar] ERROR"].concat(n))},t.zcwarn=function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];i>=r.log_level_t.LOG_LEVEL_VERBOSE&&(e=console).log.apply(e,["[Zappar] WARN"].concat(n))}},6776:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MsgManager=void 0;var a=n(1319),o=function(){function e(){r(this,e),this.onOutgoingMessage=new a.Event,this.onIncomingMessage=new a.Event1,this._outgoingMessages=[]}return i(e,[{key:"postIncomingMessage",value:function(e){this.onIncomingMessage.emit(e)}},{key:"postOutgoingMessage",value:function(e,t){this._outgoingMessages.push({msg:e,transferables:t}),this.onOutgoingMessage.emit()}},{key:"getOutgoingMessages",value:function(){var e=this._outgoingMessages;return this._outgoingMessages=[],e}}]),e}();t.MsgManager=o},647:function(e,t,n){"use strict";var r=n(7757),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=void 0;var a,o=n(4657),s=n(1758),u=n(5756),l=n(2e3),c=n(6664),g=n(6794),d=n(2372),I=n(4985),C=n(9138),h=n(633),f=n(1192),p=n(3262),A=n(7117);function m(e){return i(this,void 0,void 0,r.mark((function t(){var i,o,s;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0!==(i=n(7006)).default&&(i=i.default),t.next=4,fetch(i);case 4:return o=t.sent,t.next=7,o.arrayBuffer();case 7:s=t.sent,null===a||void 0===a||a.face_tracker_model_load_from_memory(e,s);case 9:case"end":return t.stop()}}),t)})))}t.initialize=function(){var e=this;if(a)return a;var t=!1;c.launchWorker().then((function(){A.zcout("Fully loaded"),t=!0}));var v=new o.zappar_client((function(e){c.messageManager.postOutgoingMessage({t:"zappar",d:e},[e])}));if(window.location.hostname.toLowerCase().indexOf(".zappar.io")>0){var b=window.location.pathname.split("/");b.length>1&&b[1].length>0&&v.impl.analytics_project_id_set(".wiz"+b[1])}return c.messageManager.onIncomingMessage.bind((function(e){var t,n;switch(e.t){case"zappar":null===(t=I.Pipeline.get(e.p))||void 0===t||t.pendingMessages.push(e.d);break;case"buf":v.serializer.bufferReturn(e.d);break;case"cameraFrameRecycleS2C":var r=e;null===(n=I.Pipeline.get(r.p))||void 0===n||n.cameraTokenReturn(r.token,r.d);break;case"licerr":var i=document.createElement("div");i.innerHTML="Visit <a href='https://docs.zap.works/universal-ar/licensing/' style='color: white;'>our licensing page</a> to find out about hosting on your own domain.",i.style.position="absolute",i.style.bottom="20px",i.style.width="80%",i.style.backgroundColor="black",i.style.color="white",i.style.borderRadius="10px",i.style.padding="10px",i.style.fontFamily="sans-serif",i.style.textAlign="center",i.style.left="10%",i.style.zIndex=Number.MAX_SAFE_INTEGER.toString();var a=document.createElement("span");a.innerText=" (30)",i.append(a);var o=30;setInterval((function(){--o>=0&&(a.innerText=" ("+o.toString()+")")}),1e3),document.body.append(i)}})),a=Object.assign(Object.assign({},v.impl),{loaded:function(){return t},camera_default_device_id:function(e){return e?C.CameraSource.USER_DEFAULT_DEVICE_ID:C.CameraSource.DEFAULT_DEVICE_ID},camera_source_create:function(e,t){return C.CameraSource.create(e,t)},camera_source_destroy:function(e){var t;return null===(t=C.CameraSource.get(e))||void 0===t?void 0:t.destroy()},camera_source_pause:function(e){var t;return null===(t=C.CameraSource.get(e))||void 0===t?void 0:t.pause()},camera_source_start:function(e){var t;return null===(t=C.CameraSource.get(e))||void 0===t?void 0:t.start()},pipeline_create:function(){return I.Pipeline.create(v.impl,c.messageManager)},pipeline_frame_update:function(e){var t;return null===(t=I.Pipeline.get(e))||void 0===t?void 0:t.frameUpdate(v)},pipeline_camera_frame_draw_gl:function(e,t,n,r){var i;null===(i=I.Pipeline.get(e))||void 0===i||i.cameraFrameDrawGL(t,n,r)},draw_plane:function(e,t,n,r,i){s.drawPlane(e,t,n,r,i)},pipeline_draw_face:function(e,t,n,r,i){var a,o=d.getFaceMesh(i);if(!o)return A.zcwarn("attempting to call draw_face on a destroyed zappar_face_mesh_t"),new Uint16Array;null===(a=I.Pipeline.get(e))||void 0===a||a.drawFace(t,n,r,o)},pipeline_draw_face_project:function(e,t,n,r,i,a,o){var s;null===(s=I.Pipeline.get(e))||void 0===s||s.drawFaceProject(t,n,r,i,a,o)},projection_matrix_from_camera_model:u.projectionMatrix,projection_matrix_from_camera_model_ext:u.projectionMatrix,pipeline_process_gl:function(e){var t;return null===(t=I.Pipeline.get(e))||void 0===t?void 0:t.processGL()},pipeline_gl_context_set:function(e,t,n){var r;return null===(r=I.Pipeline.get(e))||void 0===r?void 0:r.glContextSet(t,n)},pipeline_gl_context_lost:function(e){var t;return null===(t=I.Pipeline.get(e))||void 0===t?void 0:t.glContextLost()},pipeline_camera_frame_upload_gl:function(){},pipeline_camera_frame_texture_gl:function(e){var t;return null===(t=I.Pipeline.get(e))||void 0===t?void 0:t.cameraFrameTexture()},pipeline_camera_frame_texture_matrix:function(e,t,n,r){var i;return(null===(i=I.Pipeline.get(e))||void 0===i?void 0:i.cameraFrameTextureMatrix(t,n,r))||l.mat4.create()},pipeline_camera_frame_user_facing:function(e){var t;return(null===(t=I.Pipeline.get(e))||void 0===t?void 0:t.cameraFrameUserFacing())||!1},pipeline_camera_pose_default:function(){return l.mat4.create()},pipeline_camera_pose_with_attitude:function(e,t){var n;return(null===(n=I.Pipeline.get(e))||void 0===n?void 0:n.cameraPoseWithAttitude(t))||l.mat4.create()},pipeline_camera_pose_with_origin:function(e,t){var n=l.mat4.create();return l.mat4.invert(n,t),n},instant_world_tracker_anchor_pose_camera_relative:function(e,t){var n=I.applyScreenCounterRotation(void 0,v.impl.instant_world_tracker_anchor_pose_raw(e));if(t){var r=l.mat4.create();l.mat4.fromScaling(r,[-1,1,1]),l.mat4.multiply(n,r,n),l.mat4.multiply(n,n,r)}return n},instant_world_tracker_anchor_pose:function(e,t,n){var r=I.applyScreenCounterRotation(void 0,v.impl.instant_world_tracker_anchor_pose_raw(e));if(n){var i=l.mat4.create();l.mat4.fromScaling(i,[-1,1,1]),l.mat4.multiply(r,i,r),l.mat4.multiply(r,r,i)}return l.mat4.multiply(r,t,r),r},image_tracker_anchor_pose_camera_relative:function(e,t,n){var r=I.applyScreenCounterRotation(void 0,v.impl.image_tracker_anchor_pose_raw(e,t));if(n){var i=l.mat4.create();l.mat4.fromScaling(i,[-1,1,1]),l.mat4.multiply(r,i,r),l.mat4.multiply(r,r,i)}return r},image_tracker_anchor_pose:function(e,t,n,r){var i=I.applyScreenCounterRotation(void 0,v.impl.image_tracker_anchor_pose_raw(e,t));if(r){var a=l.mat4.create();l.mat4.fromScaling(a,[-1,1,1]),l.mat4.multiply(i,a,i),l.mat4.multiply(i,i,a)}return l.mat4.multiply(i,n,i),i},face_tracker_anchor_pose_camera_relative:function(e,t,n){var r=I.applyScreenCounterRotation(void 0,v.impl.face_tracker_anchor_pose_raw(e,t));if(n){var i=l.mat4.create();l.mat4.fromScaling(i,[-1,1,1]),l.mat4.multiply(r,i,r),l.mat4.multiply(r,r,i)}return r},face_tracker_anchor_pose:function(e,t,n,r){var i=I.applyScreenCounterRotation(void 0,v.impl.face_tracker_anchor_pose_raw(e,t));if(r){var a=l.mat4.create();l.mat4.fromScaling(a,[-1,1,1]),l.mat4.multiply(i,a,i),l.mat4.multiply(i,i,a)}return l.mat4.multiply(i,n,i),i},face_tracker_model_load_default:function(t){return i(e,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t);case 2:case"end":return e.stop()}}),e)})))},face_mesh_create:function(){return d.createFaceMesh()},face_mesh_destroy:function(e){d.destroyFaceMesh(e)},face_mesh_indices:function(e){var t=d.getFaceMesh(e);return t?t.getIndices():(A.zcwarn("attempting to call face_mesh_indices on a destroyed zappar_face_mesh_t"),new Uint16Array)},face_mesh_indices_size:function(e){var t=d.getFaceMesh(e);return t?t.getIndices().length:(A.zcwarn("attempting to call face_mesh_indices_size on a destroyed zappar_face_mesh_t"),0)},face_mesh_uvs:function(e){var t=d.getFaceMesh(e);return t?t.getUVs():(A.zcwarn("attempting to call face_mesh_uvs on a destroyed zappar_face_mesh_t"),new Float32Array)},face_mesh_uvs_size:function(e){var t=d.getFaceMesh(e);return t?t.getUVs().length:(A.zcwarn("attempting to call face_mesh_uvs_size on a destroyed zappar_face_mesh_t"),0)},face_mesh_vertices:function(e){var t=d.getFaceMesh(e);return t?t.getVertices():(A.zcwarn("attempting to call face_mesh_vertices on a destroyed zappar_face_mesh_t"),new Float32Array)},face_mesh_vertices_size:function(e){var t=d.getFaceMesh(e);return t?t.getVertices().length:(A.zcwarn("attempting to call face_mesh_vertices_size on a destroyed zappar_face_mesh_t"),0)},face_mesh_normals:function(e){var t=d.getFaceMesh(e);return t?t.getNormals():(A.zcwarn("attempting to call face_mesh_normals on a destroyed zappar_face_mesh_t"),new Float32Array)},face_mesh_normals_size:function(e){var t=d.getFaceMesh(e);return t?t.getNormals().length:(A.zcwarn("attempting to call face_mesh_normals_size on a destroyed zappar_face_mesh_t"),0)},face_mesh_load_from_memory:function(e,t,n,r,i,a){var o=d.getFaceMesh(e);o?o.loadFromMemory(t,n,r,i,a):A.zcwarn("attempting to call face_mesh_load_from_memory on a destroyed zappar_face_mesh_t")},face_mesh_update:function(e,t,n,r){var i=d.getFaceMesh(e);i?i.update(t,n,r):A.zcwarn("attempting to call face_mesh_update on a destroyed zappar_face_mesh_t")},face_mesh_load_default:function(t){return i(e,void 0,void 0,r.mark((function e(){var i,a,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=d.getFaceMesh(t)){e.next=4;break}return A.zcwarn("attempting to call face_mesh_load_default on a destroyed zappar_face_mesh_t"),e.abrupt("return");case 4:return void 0!==(a=n(8333)).default&&(a=a.default),e.next=8,fetch(a);case 8:return o=e.sent,e.t0=i,e.next=12,o.arrayBuffer();case 12:e.t1=e.sent,e.t0.loadFromMemory.call(e.t0,e.t1,!1,!1,!1,!1);case 14:case"end":return e.stop()}}),e)})))},face_mesh_load_default_face:function(t,a,o,s){return i(e,void 0,void 0,r.mark((function e(){var i,u,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=d.getFaceMesh(t)){e.next=4;break}return A.zcwarn("attempting to call face_mesh_load_default_face on a destroyed zappar_face_mesh_t"),e.abrupt("return");case 4:return void 0!==(u=n(8333)).default&&(u=u.default),e.next=8,fetch(u);case 8:return l=e.sent,e.t0=i,e.next=12,l.arrayBuffer();case 12:e.t1=e.sent,e.t2=a,e.t3=o,e.t4=s,e.t0.loadFromMemory.call(e.t0,e.t1,e.t2,e.t3,e.t4,!1);case 17:case"end":return e.stop()}}),e)})))},face_mesh_load_default_full_head_simplified:function(t,a,o,s,u){return i(e,void 0,void 0,r.mark((function e(){var i,l,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=d.getFaceMesh(t)){e.next=4;break}return A.zcwarn("attempting to call face_mesh_load_default_full_head_simplified on a destroyed zappar_face_mesh_t"),e.abrupt("return");case 4:return void 0!==(l=n(7319)).default&&(l=l.default),e.next=8,fetch(l);case 8:return c=e.sent,e.t0=i,e.next=12,c.arrayBuffer();case 12:e.t1=e.sent,e.t2=a,e.t3=o,e.t4=s,e.t5=u,e.t0.loadFromMemory.call(e.t0,e.t1,e.t2,e.t3,e.t4,e.t5);case 18:case"end":return e.stop()}}),e)})))},face_mesh_loaded_version:function(e){var t=d.getFaceMesh(e);return t?t.getModelVersion():(A.zcwarn("attempting to call face_mesh_load_default on a destroyed zappar_face_mesh_t"),-1)},face_landmark_create:function(e){return f.createFaceLandmark(e)},face_landmark_destroy:function(e){f.destroyFaceLandmark(e)},face_landmark_update:function(e,t,n,r){var i=f.getFaceLandmark(e);i?i.update(t,n,r):A.zcwarn("attempting to call face_landmark_update on a destroyed zappar_face_landmark_t")},face_landmark_anchor_pose:function(e){var t=f.getFaceLandmark(e);return t?t.anchor_pose:(A.zcwarn("attempting to call face_landmark_anchor_pose on a destroyed zappar_face_landmark_t"),l.mat4.create())},html_element_source_create:function(e,t){return h.HTMLElementSource.createVideoElementSource(e,t)},html_element_source_start:function(e){var t;return null===(t=h.HTMLElementSource.getVideoElementSource(e))||void 0===t?void 0:t.start()},html_element_source_pause:function(e){var t;return null===(t=h.HTMLElementSource.getVideoElementSource(e))||void 0===t?void 0:t.pause()},html_element_source_destroy:function(e){var t;return null===(t=h.HTMLElementSource.getVideoElementSource(e))||void 0===t?void 0:t.destroy()},permission_granted_all:g.permissionGrantedAll,permission_granted_camera:g.permissionGrantedCamera,permission_granted_motion:g.permissionGrantedMotion,permission_denied_any:g.permissionDeniedAny,permission_denied_camera:g.permissionDeniedCamera,permission_denied_motion:g.permissionDeniedMotion,permission_request_motion:g.permissionRequestMotion,permission_request_camera:g.permissionRequestCamera,permission_request_all:g.permissionRequestAll,permission_request_ui:g.permissionRequestUI,permission_request_ui_promise:g.permissionRequestUI,permission_denied_ui:g.permissionDeniedUI,browser_incompatible:p.default.incompatible,browser_incompatible_ui:p.default.incompatible_ui,log_level_set:function(e){A.setLogLevel(e),v.impl.log_level_set(e)}})}},6794:function(e,t,n){"use strict";var r=n(7757),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.permissionDeniedUI=t.permissionRequestUI=t.permissionRequestMotion=t.permissionRequestCamera=t.permissionRequestAll=t.permissionGrantedAll=t.permissionDeniedAny=t.permissionDeniedMotion=t.permissionDeniedCamera=t.permissionGrantedMotion=t.permissionGrantedCamera=void 0;var a=new(n(9776).UAParser),o=!1,s=!1,u=!1,l=!1;function c(){return i(this,void 0,void 0,r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!navigator.permissions||!navigator.permissions.query){e.next=11;break}return e.prev=1,e.next=4,navigator.permissions.query({name:"camera"});case 4:t=e.sent,u="denied"===t.state,o="granted"===t.state,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}}),e,null,[[1,9]])})))}function g(){return u||l}function d(){return o&&s}function I(){return i(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:return e.next=4,C();case 4:case"end":return e.stop()}}),e)})))}function C(){return i(this,void 0,void 0,r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:!0});case 3:t=e.sent,t.getTracks().forEach((function(e){return e.stop()})),o=!0,u=!1,e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),o=!1,u=!0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))}function h(){return i(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.DeviceOrientationEvent||!window.DeviceOrientationEvent.requestPermission){e.next=8;break}return e.next=3,window.DeviceOrientationEvent.requestPermission();case 3:if("granted"===e.sent){e.next=8;break}return s=!1,l=!0,e.abrupt("return",!1);case 8:s=!0,l=!1;case 10:case"end":return e.stop()}}),e)})))}window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission||(s=!0),c(),t.permissionGrantedCamera=function(){return o},t.permissionGrantedMotion=function(){return s},t.permissionDeniedCamera=function(){return u},t.permissionDeniedMotion=function(){return l},t.permissionDeniedAny=g,t.permissionGrantedAll=d,t.permissionRequestAll=I,t.permissionRequestCamera=C,t.permissionRequestMotion=h,t.permissionRequestUI=function(){return i(this,void 0,void 0,r.mark((function e(){var t,n,a=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:if(!d()){e.next=4;break}return e.abrupt("return",!0);case 4:return(t=document.createElement("div")).classList.add("zappar-permission-request"),t.innerHTML='\n    <style>\n        .zappar-permission-request {\n            position: fixed;\n            width: 100%;\n            height: 100%;\n            top: 0px;\n            left: 0px;\n            z-index: 1000;\n            background-color: rgba(0, 0, 0, 0.9);\n            font-family: sans-serif;\n            color: white;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n        }\n        .zappar-inner {\n            max-width: 400px;\n            text-align: center;\n        }\n        .zappar-title {\n            font-size: 20px;\n        }\n        .zappar-text {\n            font-size: 14px;\n            padding: 15px;\n        }\n        .zappar-inner > button {\n            background: none;\n            outline: none;\n            border: 2px solid white;\n            border-radius: 10px;\n            color: white;\n            padding: 10px 40px;\n            text-transform: uppercase;\n        }\n    </style>\n    <div class="zappar-inner">\n        <div class="zappar-title">Almost there...</div>\n        <div class="zappar-text">In order to provide this augmented reality experience, we need access to your device\'s camera and motion sensors.</div>\n        <button id="zappar-permission-request-button">Grant Access</button>\n    </div>\n',document.body.append(t),n=t.querySelector("#zappar-permission-request-button"),e.next=11,new Promise((function(e){null===n||void 0===n||n.addEventListener("click",(function(){return i(a,void 0,void 0,r.mark((function n(){return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,I();case 2:t.remove();case 3:return n.next=6,new Promise((function(e){return requestAnimationFrame((function(){return e()}))}));case 6:if(!g()){n.next=9;break}return e(!1),n.abrupt("return");case 9:if(!d()){n.next=12;break}return e(!0),n.abrupt("return");case 12:n.next=3;break;case 14:case"end":return n.stop()}}),n)})))}))}));case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))},t.permissionDeniedUI=function(){if("Chrome"===a.getBrowser().name)!function(){var e=document.createElement("div");e.classList.add("zappar-permission-request"),e.innerHTML='\n    <style>\n        .zappar-permission-request {\n            position: fixed;\n            width: 100%;\n            height: 100%;\n            top: 0px;\n            left: 0px;\n            z-index: 1000;\n            background-color: rgba(0, 0, 0, 0.9);\n            font-family: sans-serif;\n            color: white;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n        }\n        .zappar-inner {\n            width: 400px;\n            text-align: center;\n        }\n        .zappar-title {\n            font-size: 20px;\n        }\n        .zappar-text {\n            font-size: 14px;\n            padding: 15px;\n        }\n        .zappar-inner > button {\n            background: none;\n            outline: none;\n            border: 2px solid white;\n            border-radius: 10px;\n            color: white;\n            padding: 10px 40px;\n            text-transform: uppercase;\n        }\n    </style>\n    <div class="zappar-inner">\n        <div class="zappar-title">Permission is Needed</div>\n        <div class="zappar-text">Permission to access your device\'s camera and motion sensors is necessary for this experience.<br/><br/>To grant access, please tap the ! button in the address bar of your browser, then "Site settings", and finally "Clear and reset". You can then reload the page to try again.</div>\n        <button id="zappar-permission-reload-button">Reload</button>\n    </div>\n',document.body.append(e);var t=e.querySelector("#zappar-permission-reload-button");null===t||void 0===t||t.addEventListener("click",(function(){return window.location.reload()}))}();else!function(){var e=document.createElement("div");e.classList.add("zappar-permission-request"),e.innerHTML='\n    <style>\n        .zappar-permission-request {\n            position: fixed;\n            width: 100%;\n            height: 100%;\n            top: 0px;\n            left: 0px;\n            z-index: 1000;\n            background-color: rgba(0, 0, 0, 0.9);\n            font-family: sans-serif;\n            color: white;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n        }\n        .zappar-inner {\n            max-width: 400px;\n            text-align: center;\n        }\n        .zappar-title {\n            font-size: 20px;\n        }\n        .zappar-text {\n            font-size: 14px;\n            padding: 15px;\n        }\n        .zappar-inner > button {\n            background: none;\n            outline: none;\n            border: 2px solid white;\n            border-radius: 10px;\n            color: white;\n            padding: 10px 40px;\n            text-transform: uppercase;\n        }\n    </style>\n    <div class="zappar-inner">\n        <div class="zappar-title">Permission is Needed</div>\n        <div class="zappar-text">Permission to access your device\'s camera and motion sensors is necessary for this experience. Please reload the page to try again.</div>\n        <button id="zappar-permission-reload-button">Reload</button>\n    </div>\n',document.body.append(e);var t=e.querySelector("#zappar-permission-reload-button");null===t||void 0===t||t.addEventListener("click",(function(){return window.location.reload()}))}()}},4985:function(e,t,n){"use strict";var r=n(3269).default,i=n(4575).default,a=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.applyScreenCounterRotation=t.Pipeline=void 0;var o=n(7183),s=n(2e3),u=n(5756),l=n(224),c=n(2667),g=n(1758),d=n(1319),I=n(7117),C=new Map,h=function(){function e(t,n,r){i(this,e),this._client=t,this._impl=n,this._mgr=r,this.pendingMessages=[],this.cameraTokens=new Map,this.nextCameraToken=1,this.tokensInFlight=0,this.videoTextures=[],this.cameraPixelArrays=[],this.onGLContextReset=new d.Event}return a(e,[{key:"frameUpdate",value:function(e){var t,n=r(this.pendingMessages);try{for(n.s();!(t=n.n()).done;){var i=t.value;e.processMessages(i),this._mgr.postOutgoingMessage({t:"buf",p:this._impl,d:i},[i])}}catch(l){n.e(l)}finally{n.f()}this.pendingMessages=[];var a=this._client.pipeline_camera_frame_user_data(this._impl);if(a){var o,s=r(this.cameraTokens);try{for(s.s();!(o=s.n()).done;){var u=o.value;u[0]<a&&(u[1].texture&&this.videoTextures.push(u[1].texture),this.cameraTokens.delete(u[0]))}}catch(l){s.e(l)}finally{s.f()}}}},{key:"cameraTokenReturn",value:function(e,t){this.cameraPixelArrays.push(t),this.tokensInFlight--}},{key:"getVideoTexture",value:function(){return this.videoTextures.pop()}},{key:"destroy",value:function(){this._client.pipeline_destroy(this._impl),C.delete(this._impl)}},{key:"getCurrentCameraInfo",value:function(){var e=this._client.pipeline_camera_frame_user_data(this._impl);if(e)return this.cameraTokens.get(e)}},{key:"cameraFrameDrawGL",value:function(e,t,n){if(this.glContext){var r=this.getCurrentCameraInfo();r&&(this._cameraDraw||(this._cameraDraw=new o.CameraDraw(this.glContext)),this._cameraDraw.drawCameraFrame(e,t,r,!0===n))}}},{key:"glContextLost",value:function(){this._cameraDraw&&this._cameraDraw.dispose(),this._faceDraw&&this._faceDraw.dispose(),this._faceProjectDraw&&this._faceProjectDraw.dispose(),delete this._cameraDraw,delete this._faceDraw,delete this._faceProjectDraw,g.disposeDrawPlane(),this.onGLContextReset.emit();var e,t=r(this.videoTextures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.glContext&&this.glContext.deleteTexture(n)}}catch(s){t.e(s)}finally{t.f()}this.videoTextures=[];var i,a=r(this.cameraTokens);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.glContext&&o[1].texture&&this.glContext.deleteTexture(o[1].texture),o[1].texture=void 0}}catch(s){a.e(s)}finally{a.f()}this.glContext=void 0}},{key:"glContextSet",value:function(e,t){this.glContextLost(),this.glContext=e,t=t||[];for(var n=0;n<4;n++){var r=t[n]||e.createTexture();r&&(e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),this.videoTextures.push(r))}e.bindTexture(e.TEXTURE_2D,null)}},{key:"drawFace",value:function(e,t,n,r){if(this.glContext){this._faceDraw||(this._faceDraw=new l.FaceDraw(this.glContext));var i=s.mat4.create();s.mat4.multiply(i,e,t),s.mat4.multiply(i,i,n),this._faceDraw.drawFace(i,r)}}},{key:"drawFaceProject",value:function(e,t,n,r,i,a){this.glContext&&(this._faceProjectDraw||(this._faceProjectDraw=new c.FaceDrawProject(this.glContext)),this._faceProjectDraw.drawFace(e,t,n,r,i,a))}},{key:"cameraFrameTexture",value:function(){var e;return null===(e=this.getCurrentCameraInfo())||void 0===e?void 0:e.texture}},{key:"cameraFrameTextureMatrix",value:function(e,t,n){var r=this.getCurrentCameraInfo();return r?o.cameraFrameTextureMatrix(r.dataWidth,r.dataHeight,e,t,r.uvTransform,n):s.mat4.create()}},{key:"cameraFrameUserFacing",value:function(){var e;return(null===(e=this.getCurrentCameraInfo())||void 0===e?void 0:e.userFacing)||!1}},{key:"cameraPoseWithAttitude",value:function(e){var t=f(this.getCurrentCameraInfo(),this._client.pipeline_camera_frame_camera_attitude(this._impl));if(e){var n=s.mat4.create();s.mat4.fromScaling(n,[-1,1,1]),s.mat4.multiply(t,n,t),s.mat4.multiply(t,t,n)}return s.mat4.invert(t,t),t}},{key:"processGL",value:function(){if(this.glContext){if(this.currentCameraSource)if(this.tokensInFlight>0)this.currentCameraSource.getFrame(!0);else{var e=this.currentCameraSource.getFrame(!1);if(e){var t=this.nextCameraToken++;this.cameraTokens.set(t,e);var n={d:e.data,p:this._impl,width:e.dataWidth,height:e.dataHeight,token:t,userFacing:e.userFacing,t:"cameraFrameC2S"};this.tokensInFlight++,this._mgr.postOutgoingMessage(n,[e.data])}}}else I.zcerr("no GL context for camera frames - please call pipeline_gl_context_set")}},{key:"motionAccelerometerSubmit",value:function(e,t,n,r){this._client.pipeline_motion_accelerometer_submit(this._impl,e,t,n,r)}},{key:"motionRotationRateSubmit",value:function(e,t,n,r){this._client.pipeline_motion_rotation_rate_submit(this._impl,e,t,n,r)}},{key:"motionAttitudeSubmit",value:function(e,t,n,r){this._client.pipeline_motion_attitude_submit(this._impl,e,t,n,r)}}],[{key:"create",value:function(t,n){var r=t.pipeline_create();return C.set(r,new e(t,r,n)),r}},{key:"get",value:function(e){return C.get(e)}}]),e}();function f(e,t){var n;n=!!e&&e.userFacing;var r=s.mat4.create();return s.mat4.fromRotation(r,u.cameraRotationForScreenOrientation(n)*Math.PI/180,[0,0,1]),s.mat4.multiply(r,r,t),r}t.Pipeline=h,t.applyScreenCounterRotation=f},5729:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.profile=t.EmbeddedVideoImplementation=void 0;var r=n(9776);!function(e){e[e.OBJECT_URL=0]="OBJECT_URL",e[e.SRC_OBJECT=1]="SRC_OBJECT"}(t.EmbeddedVideoImplementation||(t.EmbeddedVideoImplementation={})),t.profile={deviceMotionMutliplier:-1,blacklisted:!1,showGyroPermissionsWarningIfNecessary:!1,showSafariPermissionsResetIfNecessary:!1,requestHighFrameRate:!1,videoWidth:640,videoHeight:480,dataWidth:320,dataHeight:240,videoElementInDOM:!1},window.zeeProfile=t.profile;var i=new r.UAParser,a=(i.getOS().name||"unknown").toLowerCase(),o=(i.getEngine().name||"unknown").toLowerCase();("webkit"===o&&"ios"!==a&&(t.profile.deviceMotionMutliplier=1,void 0!==window.orientation&&s("15.0")),"webkit"===o&&"ios"===a)&&(t.profile.deviceMotionMutliplier=1,s(i.getOS().version||"15.0"));function s(e){var n=e.split(".");if(n.length>=2){var r=parseInt(n[0]),i=parseInt(n[1]);(r<11||11===r&&i<3)&&(t.profile.blacklisted=!0),(r<12||12===r&&i<2)&&(t.profile.videoElementInDOM=!0),(12===r&&i>=2||r>=13)&&(t.profile.showGyroPermissionsWarningIfNecessary=!0),r>=13&&(t.profile.showSafariPermissionsResetIfNecessary=!0),(r>=12&&i>1||r>=13)&&navigator.mediaDevices&&navigator.mediaDevices.getSupportedConstraints&&navigator.mediaDevices.getSupportedConstraints().frameRate&&(t.profile.requestHighFrameRate=!0,t.profile.videoHeight=360,t.profile.dataHeight=180)}}},2363:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MessageSerializer=void 0;var a=function(){function e(t){var n=this;r(this,e),this._messageSender=t,this._freeBufferPool=[],this._buffer=new ArrayBuffer(16),this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer),this._f64View=new Float64Array(this._buffer),this._u8View=new Uint8Array(this._buffer),this._u8cView=new Uint8ClampedArray(this._buffer),this._u16View=new Uint16Array(this._buffer),this._u32View=new Uint32Array(this._buffer),this._offset=1,this._startOffset=-1,this._timeoutSet=!1,this._appender={int:function(e){return n.int(e)},bool:function(e){return n.int(e?1:0)},float:function(e){return n.float(e)},string:function(e){return n.string(e)},dataWithLength:function(e){return n.arrayBuffer(e)},type:function(e){return n.int(e)},matrix4x4:function(e){return n.float32ArrayBuffer(e)},identityCoefficients:function(e){return n.float32ArrayBuffer(e)},expressionCoefficients:function(e){return n.float32ArrayBuffer(e)},cameraModel:function(e){return n.float32ArrayBuffer(e)},timestamp:function(e){return n.double(e)},barcodeFormat:function(e){return n.int(e)},faceLandmarkName:function(e){return n.int(e)},instantTrackerTransformOrientation:function(e){return n.int(e)},logLevel:function(e){return n.int(e)}},this._freeBufferPool.push(new ArrayBuffer(16)),this._freeBufferPool.push(new ArrayBuffer(16))}return i(e,[{key:"bufferReturn",value:function(e){this._freeBufferPool.push(e)}},{key:"_ensureArrayBuffer",value:function(e){var t=4*(this._offset+e+8);if(!(this._buffer&&this._buffer.byteLength>=t)){var n=void 0;if(!n){var r=t;r--,r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16,r++,n=new ArrayBuffer(r)}var i=this._buffer?this._i32View:void 0;this._buffer=n,this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer),this._f64View=new Float64Array(this._buffer),this._u8View=new Uint8Array(this._buffer),this._u8cView=new Uint8ClampedArray(this._buffer),this._u16View=new Uint16Array(this._buffer),this._u32View=new Uint32Array(this._buffer),i&&this._i32View.set(i.subarray(0,this._offset))}}},{key:"sendMessage",value:function(e,t){this._ensureArrayBuffer(4),this._startOffset=this._offset,this._i32View[this._offset+1]=e,this._offset+=2,t(this._appender),this._i32View[this._startOffset]=this._offset-this._startOffset,this._startOffset=-1,this._sendOneTime()}},{key:"_sendOneTime",value:function(){var e=this;!1===this._timeoutSet&&(this._timeoutSet=!0,setTimeout((function(){e._timeoutSet=!1,e._send()}),0))}},{key:"_send",value:function(){0!==this._freeBufferPool.length?(this._i32View[0]=this._offset,this._messageSender(this._buffer),this._buffer=void 0,this._buffer=this._freeBufferPool.pop(),this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer),this._f64View=new Float64Array(this._buffer),this._u8View=new Uint8Array(this._buffer),this._u8cView=new Uint8ClampedArray(this._buffer),this._u16View=new Uint16Array(this._buffer),this._u32View=new Uint32Array(this._buffer),this._offset=1,this._startOffset=-1):this._sendOneTime()}},{key:"int",value:function(e){this._ensureArrayBuffer(1),this._i32View[this._offset]=e,this._offset++}},{key:"double",value:function(e){this._ensureArrayBuffer(2),this._offset%2===1&&this._offset++,this._f64View[this._offset/2]=e,this._offset+=2}},{key:"float",value:function(e){this._ensureArrayBuffer(1),this._f32View[this._offset]=e,this._offset++}},{key:"int32Array",value:function(e){this._ensureArrayBuffer(e.length);for(var t=0;t<e.length;++t)this._i32View[this._offset+t]=e[t];this._offset+=e.length}},{key:"float32Array",value:function(e){this._ensureArrayBuffer(e.length);for(var t=0;t<e.length;++t)this._f32View[this._offset+t]=e[t];this._offset+=e.length}},{key:"booleanArray",value:function(e){this._ensureArrayBuffer(e.length);for(var t=0;t<e.length;++t)this._i32View[this._offset+t]=e[t]?1:0;this._offset+=e.length}},{key:"uint8ArrayBuffer",value:function(e){this._ensureArrayBuffer(e.byteLength/4),this._i32View[this._offset]=e.byteLength,this._offset++,this._u8View.set(e,4*this._offset),this._offset+=e.byteLength>>2,0!==(3&e.byteLength)&&this._offset++}},{key:"arrayBuffer",value:function(e){var t=new Uint8Array(e);this.uint8ArrayBuffer(t)}},{key:"uint8ClampedArrayBuffer",value:function(e){this._ensureArrayBuffer(e.byteLength/4),this._i32View[this._offset]=e.byteLength,this._offset++,this._u8cView.set(e,4*this._offset),this._offset+=e.byteLength>>2,0!==(3&e.byteLength)&&this._offset++}},{key:"float32ArrayBuffer",value:function(e){this._ensureArrayBuffer(e.byteLength/4),this._i32View[this._offset]=e.length,this._offset++,this._f32View.set(e,this._offset),this._offset+=e.length}},{key:"uint16ArrayBuffer",value:function(e){this._ensureArrayBuffer(e.byteLength/4),this._i32View[this._offset]=e.length,this._offset++;var t=2*this._offset;this._u16View.set(e,t),this._offset+=e.length>>1,0!==(1&e.length)&&this._offset++}},{key:"int32ArrayBuffer",value:function(e){this._ensureArrayBuffer(e.byteLength/4),this._i32View[this._offset]=e.length,this._offset++,this._i32View.set(e,this._offset),this._offset+=e.length}},{key:"uint32ArrayBuffer",value:function(e){this._ensureArrayBuffer(e.byteLength/4),this._i32View[this._offset]=e.length,this._offset++,this._u32View.set(e,this._offset),this._offset+=e.length}},{key:"string",value:function(e){var t=(new TextEncoder).encode(e);this._ensureArrayBuffer(t.byteLength/4),this._i32View[this._offset]=t.byteLength,this._offset++,this._u8View.set(t,4*this._offset),this._offset+=t.byteLength>>2,0!==(3&t.byteLength)&&this._offset++}}]),e}();t.MessageSerializer=a},7916:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.linkProgram=t.compileShader=void 0,t.compileShader=function(e,t,n){var r=e.createShader(t);if(!r)throw new Error("Unable to create shader");e.shaderSource(r,n),e.compileShader(r);var i=e.getShaderInfoLog(r);if(i&&i.trim().length>0)throw new Error("Shader compile error: "+i);return r},t.linkProgram=function(e,t){e.linkProgram(t);var n=e.getProgramInfoLog(t);if(n&&n.trim().length>0)throw new Error("Unable to link: "+n)}},4706:function(e,t,n){"use strict";var r=n(3913).default,i=n(4575).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Source=void 0;var a=r((function e(){i(this,e)}));t.Source=a},8273:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0,t.VERSION="0.3.16"},6664:function(e,t,n){"use strict";var r=n(7757),i=n(3269).default,a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.launchWorker=t.messageManager=void 0;var o,s=n(6776);function u(e){return new Promise((function(t){e.addEventListener("message",(function n(r){"loaded"===r.data&&(e.removeEventListener("message",n),t())}))}))}t.messageManager=new s.MsgManager,(o="undefined"!==typeof Z_STANDALONE&&Z_STANDALONE?n(7567):n(7534)).default&&(o=o.default),t.launchWorker=function(){return a(this,void 0,void 0,r.mark((function e(){var a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(){var e,n=t.messageManager.getOutgoingMessages(),r=i(n);try{for(r.s();!(e=r.n()).done;){var o=e.value;a.postMessage(o.msg,o.transferables)}}catch(s){r.e(s)}finally{r.f()}},(a=new o).postMessage({t:"wasm",url:n(4301).Z}),e.next=5,u(a);case 5:t.messageManager.onOutgoingMessage.bind(s),s(),a.addEventListener("message",(function(e){t.messageManager.postIncomingMessage(e.data)}));case 8:case"end":return e.stop()}}),e)})))}},6874:function(e,t,n){"use strict";var r=n(3038).default,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(6903)),l=o(n(4519)),c=s(n(936)),g=n(5112),d=u.FaceBufferGeometry;(0,g.extend)({FaceBufferGeometry:d});var I=(0,l.forwardRef)((function(e,t){var n=e.fillMouth,i=void 0!==n&&n,a=e.fillEyeLeft,o=void 0!==a&&a,s=e.fillEyeRight,d=void 0!==s&&s,I=e.fillNeck,C=void 0!==I&&I,h=e.fullHead,f=void 0!==h&&h,p=e.children,A=e.trackerGroup,m=l.default.useRef(),v=(0,l.useState)(),b=r(v,2),y=b[0],B=b[1];return(0,l.useEffect)((function(){B(f?(new u.FaceMeshLoader).loadFullHeadSimplified({fillMouth:i,fillEyeLeft:o,fillEyeRight:d,fillNeck:C}):(new u.FaceMeshLoader).loadFace({fillMouth:i,fillEyeLeft:o,fillEyeRight:d}))}),[i,o,d,C]),(0,g.useFrame)((function(){m.current&&A&&A.current&&m.current.updateFromFaceAnchorGroup(A.current)})),y?l.default.createElement("faceBufferGeometry",Object.assign({args:[y],ref:(0,c.default)([m,t])},e),p):null}));t.default=I},6308:function(e,t,n){"use strict";var r=n(3038).default,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(6903)),l=o(n(4519)),c=s(n(936)),g=n(5112),d=(0,l.forwardRef)((function(e,t){var n=e.children,i=e.trackerGroup,a=l.default.useRef(),o=(0,l.useState)((new u.HeadMaskMeshLoader).load()),s=r(o,1)[0];return(0,g.useFrame)((function(){a.current&&i&&i.current&&a.current.updateFromFaceAnchorGroup(i.current)})),s?l.default.createElement("primitive",Object.assign({object:s,ref:(0,c.default)([a,t])},e),n):null}));t.default=d},5202:function(e,t,n){"use strict";var r=n(3038).default,i=n(3913).default,a=n(4575).default,o=n(2205).default,s=n(9842).default,u=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&u(t,e,n);return l(t,e),t},g=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=c(n(6903)),I=c(n(4519)),C=n(2958),h=g(n(936)),f=n(5112),p=g(n(5257)),A=function(e){o(n,e);var t=s(n);function n(){var e;return a(this,n),(e=t.apply(this,arguments)).updateProjectionMatrix=function(){},e}return i(n)}(d.Camera);(0,f.extend)({ZapparCameraAdditional:A});var m=(0,I.forwardRef)((function(e,t){var n=e.userFacing,i=void 0!==n&&n,a=e.rearCameraMirrorMode,o=e.userCameraMirrorMode,s=e.poseMode,u=e.poseAnchorOrigin,l=e.pipeline,c=e.sources,g=e.makeDefault,A=void 0===g||g,m=e.renderPriority,v=void 0===m?2:m,b=e.environmentMap,y=void 0!==b&&b,B=e.permissionRequest,G=void 0===B||B,Z=e.onFirstFrame,w=e.backgroundImageProps,_=(0,f.useThree)((function(e){return e})),x=_.gl,S=_.set,R=(0,I.useState)(!1),M=r(R,2),W=M[0],k=M[1],V=(0,I.useState)(new C.CameraTexture),F=r(V,1)[0],E=(0,I.useMemo)((function(){return y?new d.CameraEnvironmentMap:void 0}),[y]);(0,I.useEffect)((function(){w&&F&&Object.assign(F,w)}),[w,F]);var X=I.default.useRef(),H=(0,I.useState)(!1),L=r(H,2),z=L[0],N=L[1],Y={camera:p.default.camera((function(e){return e}))};return(0,I.useEffect)((function(){(l||d).glContextSet(x.getContext())}),[l,x]),(0,I.useEffect)((function(){A&&S((function(){return{camera:X.current}}))}),[A]),(0,I.useEffect)((function(){X.current&&(Y.camera.set(X.current),z||!G?X.current.start(i):d.permissionRequestUI().then((function(e){N(e),e?X.current.start(i):d.permissionDeniedUI()})))}),[i,G]),(0,I.useEffect)((function(){if(X.current){switch(a){case"poses":X.current.rearCameraMirrorMode=d.CameraMirrorMode.Poses;break;case"css":X.current.rearCameraMirrorMode=d.CameraMirrorMode.CSS;break;default:X.current.rearCameraMirrorMode=d.CameraMirrorMode.None}switch(o){case"none":X.current.userCameraMirrorMode=d.CameraMirrorMode.None;break;case"css":X.current.userCameraMirrorMode=d.CameraMirrorMode.CSS;break;default:X.current.userCameraMirrorMode=d.CameraMirrorMode.Poses}switch(s){case"anchor-origin":X.current.poseMode=d.CameraPoseMode.AnchorOrigin,X.current.poseAnchorOrigin=u;break;case"attitude":X.current.poseMode=d.CameraPoseMode.Attitude;break;default:X.current.poseMode=d.CameraPoseMode.Default}}}),[a,o,s,u]),(0,f.useFrame)((function(e){var t=e.gl,n=e.scene;X.current&&(Z&&!W&&X.current.pipeline.frameNumber()>0&&(k(!0),Z()),null===E||void 0===E||E.update(t,X.current),X.current.updateFrame(t),t.render(n,X.current))}),v),X.current&&(X.current.__r3f.primitive=!0),I.default.createElement(I.default.Fragment,null,I.default.createElement("primitive",{object:F,attach:"background"}),y&&I.default.createElement("primitive",{object:E.environmentMap,attach:"environment"}),I.default.createElement("zapparCameraAdditional",Object.assign({args:[{pipeline:l,userCameraSource:null===c||void 0===c?void 0:c.userCamera,rearCameraSource:null===c||void 0===c?void 0:c.rearCamera,backgroundTexture:F}],ref:(0,h.default)([X,t])},e)))}));t.default=m},9040:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(4519)),a=n(5112),o=n(9465);t.default=function(e){var t=e.children;return i.default.createElement(a.Canvas,Object.assign({flat:!0,resize:{polyfill:o.ResizeObserver},linear:!0,dpr:window.devicePixelRatio,id:"zapparCanvas"},e),t)}},7265:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n(6903)),u=a(n(4519)),l=n(5112),c=o(n(936)),g=o(n(5257)),d=s.FaceLandmarkGroup;(0,l.extend)({FaceLandmarkGroup:d});var I=(0,u.forwardRef)((function(e,t){var n,r=e.children,i=e.trackerGroup,a=e.camera,o=e.target,l=(0,u.useRef)(),d={camera:g.default.camera((function(e){return e})),faceTracker:g.default.faceTracker((function(e){return e}))},I=(null===(n=null===i||void 0===i?void 0:i.current)||void 0===n?void 0:n.faceTracker)?i.current.faceTracker:d.faceTracker.object,C=(null===a||void 0===a?void 0:a.current)?a.current:d.camera.object;return I&&C?u.default.createElement("faceLandmarkGroup",Object.assign({args:[C,I,s.FaceLandmarkName[o.toUpperCase().replace("-","_")]],ref:(0,c.default)([l,t])},e),r):null}));t.default=I},1006:function(e,t,n){"use strict";var r=n(3038).default,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(6903)),l=o(n(4519)),c=n(5112),g=s(n(936)),d=s(n(5257)),I=s(n(6930)),C=u.FaceAnchorGroup;(0,c.extend)({FaceAnchorGroup:C});var h=(0,l.forwardRef)((function(e,t){var n=e.camera,i=e.children,a=e.useFaceTracker,o=e.onNotVisible,s=e.onVisible,c=e.onNewAnchor,C=e.pipeline,h=e.model,f=e.enabled,p=(0,l.useState)(),A=r(p,2),m=A[0],v=A[1],b=l.default.useRef(),y={camera:d.default.camera((function(e){return e})),faceTracker:d.default.faceTracker((function(e){return e}))};(0,l.useEffect)((function(){var e=new u.FaceTracker(C);h?e.loadModel(h):e.loadDefaultModel(),v(e),y.faceTracker.set(e)}),[h,C]);var B=(null===n||void 0===n?void 0:n.current)?n.current:y.camera.object;return(0,l.useEffect)((function(){return m&&(a&&a(m),o&&m.onNotVisible.bind(o),s&&m.onVisible.bind(s),c&&m.onVisible.bind(c)),function(){m&&(o&&m.onNotVisible.unbind(o),s&&m.onVisible.unbind(s),c&&m.onVisible.unbind(c))}}),[a,s,o,b,m]),(0,I.default)(m,f),m&&B?l.default.createElement("faceAnchorGroup",Object.assign({ref:(0,g.default)([b,t]),args:[B,m]},e),i):null}));t.default=h},2550:function(e,t,n){"use strict";var r=n(3038).default,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(6903)),l=o(n(4519)),c=n(5112),g=s(n(936)),d=s(n(5257)),I=s(n(6930)),C=u.ImageAnchorGroup;(0,c.extend)({ImageAnchorGroup:C});var h=(0,l.forwardRef)((function(e,t){var n=e.useImageTracker,i=e.onNotVisible,a=e.onNewAnchor,o=e.onVisible,s=e.targetImage,c=e.camera,C=e.children,h=e.pipeline,f=e.enabled,p=(0,l.useRef)(),A=d.default.camera((function(e){return e})),m=(null===c||void 0===c?void 0:c.current)?c.current:A.object,v=(0,l.useState)(),b=r(v,2),y=b[0],B=b[1];return(0,l.useEffect)((function(){B(new u.ImageTracker(s,h))}),[s,h]),(0,l.useEffect)((function(){return y&&(n&&n(y),i&&y.onNotVisible.bind(i),a&&y.onNewAnchor.bind(a),o&&y.onVisible.bind(o)),function(){i&&(null===y||void 0===y||y.onNotVisible.unbind(i)),a&&(null===y||void 0===y||y.onNewAnchor.unbind(a)),o&&(null===y||void 0===y||y.onVisible.unbind(o))}}),[n,o,a,i,y]),(0,I.default)(y,f),m&&y?l.default.createElement("imageAnchorGroup",Object.assign({ref:(0,g.default)([p,t]),args:[m,y]},e),C):null}));t.default=h},1447:function(e,t,n){"use strict";var r=n(7757),i=n(8926).default,a=n(319).default,o=n(3038).default,s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),u=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return u(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var g=l(n(6903)),d=l(n(4519)),I=n(5112),C=c(n(936)),h=c(n(5257)),f=c(n(9027)),p=c(n(6930)),A=g.InstantWorldAnchorGroup;(0,I.extend)({InstantWorldAnchorGroup:A});var m=(0,d.forwardRef)((function(e,t){var n=e.camera,s=e.placementMode,u=e.children,l=e.placementCameraOffset,c=e.pipeline,A=e.placementUI,m=e.useInstantTracker,v=e.enabled,b=(0,d.useRef)(),y=(0,d.useState)(s),B=o(y,2),G=B[0],Z=B[1];(0,d.useEffect)((function(){Z(s)}),[s,A]);var w=(0,d.useState)(),_=o(w,2),x=_[0],S=_[1];(0,d.useEffect)((function(){S(new g.InstantWorldTracker(c))}),[c]);var R=h.default.camera((function(e){return e})),M=(null===n||void 0===n?void 0:n.current)?n.current:R.object,W=l||{x:0,y:0,z:-5};if((0,d.useEffect)((function(){x&&m&&m(x)}),[m,x]),(0,I.useFrame)((function(){G&&x&&(Array.isArray(W)?x.setAnchorPoseFromCameraOffset.apply(x,a(W)):"number"===typeof W?x.setAnchorPoseFromCameraOffset(0,0,W):W.x&&x.setAnchorPoseFromCameraOffset(W.x,W.y,W.z))})),(0,p.default)(x,v),!M||!x)return null;var k=A?d.default.createElement(f.default,{placementType:A,onInteract:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Z(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}):void 0;return d.default.createElement(d.default.Fragment,null,k,d.default.createElement("instantWorldAnchorGroup",Object.assign({ref:(0,C.default)([b,t]),args:[M,x]},e),u))}));t.default=m},6319:function(e,t,n){"use strict";var r=n(3038).default,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(6903)),u=n(4519);t.default=function(e){var t=e.fallback,n=(0,u.useState)(!0),i=r(n,2),a=i[0],o=i[1];return(0,u.useEffect)((function(){o(!s.browserIncompatible()),a||t||s.browserIncompatibleUI()}),[]),t&&!a?t:null}},5119:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var o=n(4519),s=a(n(6903));t.default=function(e){var t=e.style,n=e.onLoad;return(0,o.useEffect)((function(){var e=new s.DefaultLoaderUI({style:t,onLoad:n});return function(){return e.dispose()}}),[e]),null}},9027:function(e,t,n){"use strict";var r=n(3038).default,i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(4519)),u=n(1292),l={position:"absolute",bottom:"5%",width:"200px",left:"calc(50% - 100px)",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",textAlign:"center",fontFamily:"sans-serif",padding:"10px",userSelect:"none",borderRadius:"5px"};t.default=function(e){var t=e.onInteract,n=e.placementType,i=(0,s.useState)(!0),a=r(i,2),o=a[0],c=a[1],g=(0,s.useState)(!1),d=r(g,2),I=d[0],C=d[1];return(0,s.useLayoutEffect)((function(){t(o)}),[o]),(0,s.useEffect)((function(){C(!0)}),[]),I&&("placement-only"!==n||o)?s.default.createElement(u.Html,{fullscreen:!0,style:{left:"0px",top:"0px"}},s.default.createElement("div",{style:{width:"100%",height:"100%",position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.1)"}},s.default.createElement("div",{id:"ZapparPlacementUIHelper",role:"button",style:l,tabIndex:0,onKeyPress:function(){c((function(e){return!e}))},onClick:function(){c((function(e){return!e}))}},"Tap here to",o?" place ":" pick up ","the object"))):null}},6930:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4519);t.default=function(e,t){(0,r.useEffect)((function(){e&&void 0!==t&&(e.enabled=t)}),[e,t])}},5514:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserCompatibility=t.Loader=t.ZapparCanvas=t.ZapparCamera=t.InstantTracker=t.ImageTracker=t.HeadMaskMesh=t.FaceTracker=t.FaceLandmark=t.FaceBufferGeometry=t.setLogLevel=t.LogLevel=t.Pipeline=t.browserIncompatible=void 0;var i=r(n(317));console.log("Zappar for React Three v".concat(i.default));var a=n(6903);Object.defineProperty(t,"browserIncompatible",{enumerable:!0,get:function(){return a.browserIncompatible}}),Object.defineProperty(t,"Pipeline",{enumerable:!0,get:function(){return a.Pipeline}}),Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return a.LogLevel}}),Object.defineProperty(t,"setLogLevel",{enumerable:!0,get:function(){return a.setLogLevel}});var o=n(6874);Object.defineProperty(t,"FaceBufferGeometry",{enumerable:!0,get:function(){return r(o).default}});var s=n(7265);Object.defineProperty(t,"FaceLandmark",{enumerable:!0,get:function(){return r(s).default}});var u=n(1006);Object.defineProperty(t,"FaceTracker",{enumerable:!0,get:function(){return r(u).default}});var l=n(6308);Object.defineProperty(t,"HeadMaskMesh",{enumerable:!0,get:function(){return r(l).default}});var c=n(2550);Object.defineProperty(t,"ImageTracker",{enumerable:!0,get:function(){return r(c).default}});var g=n(1447);Object.defineProperty(t,"InstantTracker",{enumerable:!0,get:function(){return r(g).default}});var d=n(5202);Object.defineProperty(t,"ZapparCamera",{enumerable:!0,get:function(){return r(d).default}});var I=n(9040);Object.defineProperty(t,"ZapparCanvas",{enumerable:!0,get:function(){return r(I).default}});var C=n(5119);Object.defineProperty(t,"Loader",{enumerable:!0,get:function(){return r(C).default}});var h=n(6319);Object.defineProperty(t,"BrowserCompatibility",{enumerable:!0,get:function(){return r(h).default}})},5257:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(5153)),a=(0,i.default)((function(e){return{object:void 0,set:function(t){return e({object:t})}}})),o=(0,i.default)((function(e){return{object:void 0,set:function(t){return e({object:t})}}})),s=(0,i.default)((function(e){return{object:void 0,set:function(t){return e({object:t})}}})),u=(0,i.default)((function(e){return{object:void 0,set:function(t){return e({object:t})}}}));t.default={camera:a,imageTracker:o,instantTracker:s,faceTracker:u}},317:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="1.2.1"},5153:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var r=n(9439),i=n(4519);function a(e){var t,n=new Set,r=function(e,r){var i="function"===typeof e?e(t):e;if(i!==t){var a=t;t=r?i:Object.assign({},t,i),n.forEach((function(e){return e(t,a)}))}},i=function(){return t},a={setState:r,getState:i,subscribe:function(e,r,a){return r||a?function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");var o=r(t);function s(){var n=r(t);if(!a(o,n)){var i=o;e(o=n,i)}}return n.add(s),function(){return n.delete(s)}}(e,r,a):(n.add(e),function(){return n.delete(e)})},destroy:function(){return n.clear()}};return t=e(r,i,a),a}var o="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?i.useEffect:i.useLayoutEffect;function s(e){var t="function"===typeof e?a(e):e,n=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.getState,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is,s=(0,i.useReducer)((function(e){return e+1}),0),u=(0,r.Z)(s,2),l=u[1],c=t.getState(),g=(0,i.useRef)(c),d=(0,i.useRef)(n),I=(0,i.useRef)(a),C=(0,i.useRef)(!1),h=(0,i.useRef)();void 0===h.current&&(h.current=n(c));var f=!1;(g.current!==c||d.current!==n||I.current!==a||C.current)&&(e=n(c),f=!a(h.current,e)),o((function(){f&&(h.current=e),g.current=c,d.current=n,I.current=a,C.current=!1}));var p=(0,i.useRef)(c);o((function(){var e=function(){try{var e=t.getState(),n=d.current(e);I.current(h.current,n)||(g.current=e,h.current=n,l())}catch(r){C.current=!0,l()}},n=t.subscribe(e);return t.getState()!==p.current&&e(),n}),[]);var A=f?e:h.current;return(0,i.useDebugValue)(A),A};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");var e=[n,t];return{next:function(){var t=e.length<=0;return{value:e.shift(),done:t}}}},n}},4352:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(6525).default,o=n(9754).default,s=n(2205).default,u=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Camera=t.CameraMirrorMode=t.CameraPoseMode=void 0;var l,c,g,d=n(1168),I=n(5483),C=n(8587),h=n(2958);!function(e){e[e.Default=0]="Default",e[e.Attitude=1]="Attitude",e[e.AnchorOrigin=2]="AnchorOrigin"}(l=t.CameraPoseMode||(t.CameraPoseMode={})),function(e){e[e.None=0]="None",e[e.Poses=1]="Poses",e[e.CSS=2]="CSS"}(c=t.CameraMirrorMode||(t.CameraMirrorMode={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.Rear=2]="Rear"}(g||(g={}));var f=function(e){s(n,e);var t=u(n);function n(e){var i;return r(this,n),(i=t.call(this)).poseMode=l.Default,i.rearCameraMirrorMode=c.None,i.userCameraMirrorMode=c.Poses,i._currentMirrorMode=c.None,i.isPerspectiveCamera=!0,i.cameraDirection=g.None,i.hasSetCSSScaleX=!1,i.renderWidth=0,i.renderHeight=0,i.pipeline=e instanceof d.Pipeline?e:(null===e||void 0===e?void 0:e.pipeline)||(0,C.getDefaultPipeline)(),i.rawPose=i.pipeline.cameraPoseDefault(),!e||e instanceof d.Pipeline?(i.rearCameraSource=new C.CameraSource(d.cameraDefaultDeviceID(),i.pipeline),i.userCameraSource=new C.CameraSource(d.cameraDefaultDeviceID(!0),i.pipeline),i.backgroundTexture=new h.CameraTexture):(i.zNear=e.zNear?e.zNear:.1,i.zFar=e.zFar?e.zFar:100,i.rearCameraSource=i.cameraSourceFromOpts(e.rearCameraSource),i.userCameraSource=i.cameraSourceFromOpts(e.userCameraSource,!0),i.backgroundTexture=e.backgroundTexture?e.backgroundTexture:new h.CameraTexture),i.matrixAutoUpdate=!1,document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState?i.resume():i.pause()})),i}return i(n,[{key:"cameraSourceFromOpts",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e instanceof Element?new d.HTMLElementSource(this.pipeline,e):new C.CameraSource(e||d.cameraDefaultDeviceID(t),this.pipeline)}},{key:"pause",value:function(){this.userCameraSource.pause(),this.rearCameraSource.pause()}},{key:"resume",value:function(){switch(this.cameraDirection){case g.User:this.userCameraSource.start();break;case g.Rear:this.rearCameraSource.start()}}},{key:"start",value:function(e){this.cameraDirection=e?g.User:g.Rear,this.resume()}},{key:"stop",value:function(){this.cameraDirection=g.None,this.pause()}},{key:"setPoseModeAnchorOrigin",value:function(e){this.poseAnchorOrigin=e,this.poseMode=l.AnchorOrigin}},{key:"currentMirrorMode",get:function(){return this._currentMirrorMode}},{key:"updateFrame",value:function(e){e.state.reset(),this.pipeline.processGL(),e.state.reset(),this.pipeline.frameUpdate(),this._currentMirrorMode=this.pipeline.cameraFrameUserFacing()?this.userCameraMirrorMode:this.rearCameraMirrorMode;var t=e.domElement;switch(this.currentMirrorMode!==c.CSS&&this.hasSetCSSScaleX?(t.style.transform="",this.hasSetCSSScaleX=!1):this.currentMirrorMode!==c.CSS||this.hasSetCSSScaleX||(t.style.transform="scaleX(-1)",this.hasSetCSSScaleX=!0),this.renderWidth=e.domElement.width,this.renderHeight=e.domElement.height,this._updateProjectionMatrix(),this.poseMode){case l.Default:this.rawPose=this.pipeline.cameraPoseDefault();break;case l.Attitude:this.rawPose=this.pipeline.cameraPoseWithAttitude(this.currentMirrorMode===c.Poses);break;case l.AnchorOrigin:this.rawPose=this.poseAnchorOrigin?this.getOriginPose():this.pipeline.cameraPoseDefault();break;default:this.rawPose=this.pipeline.cameraPoseDefault()}this.backgroundTexture.MirrorMode=this.currentMirrorMode,this.backgroundTexture.update(e,this.pipeline)}},{key:"_updateProjectionMatrix",value:function(){var e=this.pipeline.cameraModel(),t=d.projectionMatrixFromCameraModel(e,this.renderWidth,this.renderHeight,this.zNear,this.zFar);this.projectionMatrix.fromArray(t),"function"===typeof this.projectionMatrixInverse.invert?this.projectionMatrixInverse.copy(this.projectionMatrix).invert():this.projectionMatrixInverse.getInverse(this.projectionMatrix)}},{key:"updateMatrixWorld",value:function(e){this.matrix.fromArray(this.rawPose),this.matrix.decompose(this.position,this.quaternion,this.scale),a(o(n.prototype),"updateMatrixWorld",this).call(this,e)}},{key:"getOriginPose",value:function(){return this.poseAnchorOrigin?this.pipeline.cameraPoseWithOrigin(this.poseAnchorOrigin.poseCameraRelative(this.currentMirrorMode===c.Poses)):this.pipeline.cameraPoseDefault()}},{key:"dispose",value:function(){this.rearCameraSource.destroy(),this.userCameraSource.destroy()}}]),n}(I.THREE.Camera);t.Camera=f},2958:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(2205).default,o=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CameraTexture=void 0;var s=n(4352),u=n(5483),l=function(e){a(n,e);var t=o(n);function n(){var e;return r(this,n),(e=t.apply(this,arguments)).MirrorMode=s.CameraMirrorMode.None,e}return i(n,[{key:"update",value:function(e,t){t.cameraFrameUploadGL();var n=t.cameraFrameTextureGL();if(n){this.encoding=e.outputEncoding;var r=e.properties.get(this);r.__webglTexture=n,r.__webglInit=!0;var i=new u.THREE.Matrix4;i.fromArray(t.cameraFrameTextureMatrix(e.domElement.width,e.domElement.height,this.MirrorMode===s.CameraMirrorMode.Poses));var a=new u.THREE.Matrix3;a.setFromMatrix4(i),a.elements[6]=i.elements[12],a.elements[7]=i.elements[13],a.elements[8]=1,this.matrixAutoUpdate=!1,this.matrix=a}}}]),n}(u.THREE.Texture);t.CameraTexture=l},8271:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CameraEnvironmentMap=void 0;var a=n(5483),o=function(){function e(){r(this,e),this.cubeMapScene=new a.THREE.Scene,this.renderTarget=new a.THREE.WebGLCubeRenderTarget(256,{format:a.THREE.RGBAFormat,generateMipmaps:!0,minFilter:a.THREE.LinearMipmapLinearFilter}),this.cubeCamera=new a.THREE.CubeCamera(.1,1e3,this.renderTarget),this.sphereMaterial=new a.THREE.MeshBasicMaterial({side:a.THREE.DoubleSide}),this.sphereGroup=new a.THREE.Group,this.environmentMap=this.renderTarget.texture,this.cubeMapScene.add(this.cubeCamera);var t=new a.THREE.Mesh(new a.THREE.SphereBufferGeometry(10,16,12),this.sphereMaterial);t.rotation.set(0,-.5*Math.PI,0),this.sphereGroup.add(t),this.cubeMapScene.add(this.sphereGroup)}return i(e,[{key:"dispose",value:function(){this.renderTarget.dispose(),this.sphereMaterial.dispose()}},{key:"update",value:function(e,t){this.environmentMap.encoding=e.outputEncoding,this.sphereMaterial.map=t.backgroundTexture,this.sphereGroup.quaternion.copy(t.quaternion),this.cubeCamera.update(e,this.cubeMapScene)}}]),e}();t.CameraEnvironmentMap=o},8587:function(e,t,n){"use strict";var r=n(3913).default,i=n(4575).default,a=n(2205).default,o=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.glContextLost=t.glContextSet=t.HTMLElementSource=t.CameraSource=t.InstantWorldTracker=t.FaceTracker=t.BarcodeFinder=t.ImageTracker=t.getDefaultPipeline=t.onFrameUpdate=void 0;var s,u=n(1168),l=n(6366);function c(){return s||(s=new u.Pipeline).onFrameUpdate.bind((function(){return t.onFrameUpdate.emit()})),s}t.onFrameUpdate=new l.Event,t.getDefaultPipeline=c;var g=function(e){a(n,e);var t=o(n);function n(e,r){return i(this,n),t.call(this,r||c(),e)}return r(n)}(u.ImageTracker);t.ImageTracker=g;var d=function(e){a(n,e);var t=o(n);function n(e){return i(this,n),t.call(this,e||c())}return r(n)}(u.BarcodeFinder);t.BarcodeFinder=d;var I=function(e){a(n,e);var t=o(n);function n(e){return i(this,n),t.call(this,e||c())}return r(n)}(u.FaceTracker);t.FaceTracker=I;var C=function(e){a(n,e);var t=o(n);function n(e){return i(this,n),t.call(this,e||c())}return r(n)}(u.InstantWorldTracker);t.InstantWorldTracker=C;var h=function(e){a(n,e);var t=o(n);function n(e,r){return i(this,n),t.call(this,r||c(),e)}return r(n)}(u.CameraSource);t.CameraSource=h;var f=function(e){a(n,e);var t=o(n);function n(e,r){return i(this,n),t.call(this,r||c(),e)}return r(n)}(u.HTMLElementSource);t.HTMLElementSource=f,t.glContextSet=function(e){c().glContextSet(e)},t.glContextLost=function(){c().glContextLost()}},5134:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(2205).default,o=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.FaceBufferGeometry=void 0;var s,u=n(5483),l=n(1725),c=function(e){a(n,e);var t=o(n);function n(e){var i;return r(this,n),(i=t.call(this)).hasSetIndices=!1,i.hasSetUVs=!1,i.recalculateNormals=!0,i.setIndex([]),i.setAttribute("position",new u.THREE.Float32BufferAttribute([],3)),i.setAttribute("normal",new u.THREE.Float32BufferAttribute([],3)),i.setAttribute("uv",new u.THREE.Float32BufferAttribute([],2)),e||(s||(s=(new l.FaceMeshLoader).load()),e=s),i._faceMesh=e,i}return i(n,[{key:"_updateIndices",value:function(){this.hasSetIndices||0!==this._faceMesh.indices.length&&(this.setIndex(new u.THREE.Uint16BufferAttribute(this._faceMesh.indices,1)),this.hasSetIndices=!0)}},{key:"_updateUVs",value:function(){this.hasSetUVs||0!==this._faceMesh.uvs.length&&(this.setAttribute("uv",new u.THREE.BufferAttribute(this._faceMesh.uvs,2)),this.hasSetUVs=!0)}},{key:"calculateNormals",get:function(){return this.recalculateNormals},set:function(e){this.recalculateNormals=e,this.recalculateNormals||("function"===typeof this.removeAttribute&&this.removeAttribute("normal"),delete this.normals)}},{key:"updateFromFaceAnchorGroup",value:function(e){0!==this._faceMesh.vertices.length&&e.currentAnchor&&this.updateFromFaceAnchor(e.currentAnchor)}},{key:"updateFromFaceAnchor",value:function(e){this.updateFromIdentityExpression(e.identity,e.expression)}},{key:"updateFromIdentityExpression",value:function(e,t){0!==this._faceMesh.vertices.length&&(this._updateIndices(),this._updateUVs(),this._faceMesh.updateFromIdentityExpression(e,t),this.vertices||(this.vertices=new Float32Array(this._faceMesh.vertices.length),this.verticesAttribute=new u.THREE.BufferAttribute(this.vertices,3),this.setAttribute("position",this.verticesAttribute)),this.vertices.set(this._faceMesh.vertices),this.verticesAttribute&&(this.verticesAttribute.needsUpdate=!0),this.computeBoundingSphere(),this.calculateNormals&&(this.normals||(this.normals=new Float32Array(this._faceMesh.normals.length),this.normalsAttribute=new u.THREE.BufferAttribute(this.normals,3),this.setAttribute("normal",this.normalsAttribute)),this.normals.set(this._faceMesh.normals),this.normalsAttribute&&(this.normalsAttribute.needsUpdate=!0)))}}]),n}(u.THREE.BufferGeometry);t.FaceBufferGeometry=c},6903:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadedPromise=t.loaded=t.browserIncompatibleUI=t.browserIncompatible=t.permissionRequestUI=t.permissionDeniedUI=t.permissionRequest=t.permissionGranted=t.permissionDenied=t.setLogLevel=t.LogLevel=t.Pipeline=t.FaceLandmarkName=t.FaceLandmark=t.FaceMesh=t.getDefaultPipeline=t.glContextLost=t.glContextSet=t.onFrameUpdate=t.HTMLElementSource=t.CameraSource=t.FaceTracker=t.BarcodeFinder=t.InstantWorldTracker=t.ImageTracker=t.CameraEnvironmentMap=t.DefaultLoaderUI=t.LoadingManager=t.LibraryLoader=t.HeadMaskMeshLoader=t.HeadMaskMesh=t.FaceMeshLoader=t.FaceBufferGeometry=t.FaceTrackerLoader=t.FaceLandmarkGroup=t.FaceAnchorGroup=t.InstantWorldAnchorGroup=t.ImageTrackerLoader=t.ImageAnchorGroup=t.CameraMirrorMode=t.CameraPoseMode=t.Camera=void 0;var r=n(4109);console.log("Zappar for ThreeJS v".concat(r.VERSION));var i=n(4352);Object.defineProperty(t,"Camera",{enumerable:!0,get:function(){return i.Camera}}),Object.defineProperty(t,"CameraPoseMode",{enumerable:!0,get:function(){return i.CameraPoseMode}}),Object.defineProperty(t,"CameraMirrorMode",{enumerable:!0,get:function(){return i.CameraMirrorMode}});var a=n(3177);Object.defineProperty(t,"ImageAnchorGroup",{enumerable:!0,get:function(){return a.ImageAnchorGroup}});var o=n(1718);Object.defineProperty(t,"ImageTrackerLoader",{enumerable:!0,get:function(){return o.ImageTrackerLoader}});var s=n(8425);Object.defineProperty(t,"InstantWorldAnchorGroup",{enumerable:!0,get:function(){return s.InstantWorldAnchorGroup}});var u=n(1342);Object.defineProperty(t,"FaceAnchorGroup",{enumerable:!0,get:function(){return u.FaceAnchorGroup}});var l=n(6786);Object.defineProperty(t,"FaceLandmarkGroup",{enumerable:!0,get:function(){return l.FaceLandmarkGroup}});var c=n(7267);Object.defineProperty(t,"FaceTrackerLoader",{enumerable:!0,get:function(){return c.FaceTrackerLoader}});var g=n(5134);Object.defineProperty(t,"FaceBufferGeometry",{enumerable:!0,get:function(){return g.FaceBufferGeometry}});var d=n(1725);Object.defineProperty(t,"FaceMeshLoader",{enumerable:!0,get:function(){return d.FaceMeshLoader}});var I=n(308);Object.defineProperty(t,"HeadMaskMesh",{enumerable:!0,get:function(){return I.HeadMaskMesh}});var C=n(7435);Object.defineProperty(t,"HeadMaskMeshLoader",{enumerable:!0,get:function(){return C.HeadMaskMeshLoader}});var h=n(9205);Object.defineProperty(t,"LibraryLoader",{enumerable:!0,get:function(){return h.LibraryLoader}});var f=n(4892);Object.defineProperty(t,"LoadingManager",{enumerable:!0,get:function(){return f.LoadingManager}}),Object.defineProperty(t,"DefaultLoaderUI",{enumerable:!0,get:function(){return f.DefaultLoaderUI}});var p=n(8271);Object.defineProperty(t,"CameraEnvironmentMap",{enumerable:!0,get:function(){return p.CameraEnvironmentMap}});var A=n(8587);Object.defineProperty(t,"ImageTracker",{enumerable:!0,get:function(){return A.ImageTracker}}),Object.defineProperty(t,"InstantWorldTracker",{enumerable:!0,get:function(){return A.InstantWorldTracker}}),Object.defineProperty(t,"BarcodeFinder",{enumerable:!0,get:function(){return A.BarcodeFinder}}),Object.defineProperty(t,"FaceTracker",{enumerable:!0,get:function(){return A.FaceTracker}}),Object.defineProperty(t,"CameraSource",{enumerable:!0,get:function(){return A.CameraSource}}),Object.defineProperty(t,"HTMLElementSource",{enumerable:!0,get:function(){return A.HTMLElementSource}}),Object.defineProperty(t,"onFrameUpdate",{enumerable:!0,get:function(){return A.onFrameUpdate}}),Object.defineProperty(t,"glContextSet",{enumerable:!0,get:function(){return A.glContextSet}}),Object.defineProperty(t,"glContextLost",{enumerable:!0,get:function(){return A.glContextLost}}),Object.defineProperty(t,"getDefaultPipeline",{enumerable:!0,get:function(){return A.getDefaultPipeline}});var m=n(1168);Object.defineProperty(t,"FaceMesh",{enumerable:!0,get:function(){return m.FaceMesh}}),Object.defineProperty(t,"FaceLandmark",{enumerable:!0,get:function(){return m.FaceLandmark}}),Object.defineProperty(t,"FaceLandmarkName",{enumerable:!0,get:function(){return m.FaceLandmarkName}}),Object.defineProperty(t,"Pipeline",{enumerable:!0,get:function(){return m.Pipeline}}),Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return m.LogLevel}}),Object.defineProperty(t,"setLogLevel",{enumerable:!0,get:function(){return m.setLogLevel}}),Object.defineProperty(t,"permissionDenied",{enumerable:!0,get:function(){return m.permissionDenied}}),Object.defineProperty(t,"permissionGranted",{enumerable:!0,get:function(){return m.permissionGranted}}),Object.defineProperty(t,"permissionRequest",{enumerable:!0,get:function(){return m.permissionRequest}}),Object.defineProperty(t,"permissionDeniedUI",{enumerable:!0,get:function(){return m.permissionDeniedUI}}),Object.defineProperty(t,"permissionRequestUI",{enumerable:!0,get:function(){return m.permissionRequestUI}}),Object.defineProperty(t,"browserIncompatible",{enumerable:!0,get:function(){return m.browserIncompatible}}),Object.defineProperty(t,"browserIncompatibleUI",{enumerable:!0,get:function(){return m.browserIncompatibleUI}}),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return m.loaded}}),Object.defineProperty(t,"loadedPromise",{enumerable:!0,get:function(){return m.loadedPromise}})},1725:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(2205).default,o=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.FaceMeshLoader=void 0;var s=n(1168),u=function(e){a(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new s.FaceMesh,o="__zappar_threejs_face_mesh_".concat(JSON.stringify(e||"default"));return this.manager.itemStart(o),(e?"string"===typeof e?a.load(e):e.customModel?a.load(e.customModel,e.fillMouth,e.fillEyeLeft,e.fillEyeRight,e.fillNeck):a.loadDefaultFace(e.fillMouth,e.fillEyeLeft,e.fillEyeRight):a.loadDefaultFace()).then((function(){null===t||void 0===t||t(a),i.manager.itemEnd(o)})).catch((function(e){null===r||void 0===r||r(e),i.manager.itemError(o),i.manager.itemEnd(o)})),a}},{key:"loadFace",value:function(e,t,n,r){var i=this,a=new s.FaceMesh,o="__zappar_threejs_face_mesh_face_".concat(JSON.stringify(e||"default"));return(e?e.customModel?a.load(e.customModel,e.fillMouth,e.fillEyeLeft,e.fillEyeRight,e.fillNeck):a.loadDefaultFace(e.fillMouth,e.fillEyeLeft,e.fillEyeRight):a.loadDefaultFace()).then((function(){null===t||void 0===t||t(a),i.manager.itemEnd(o)})).catch((function(e){null===r||void 0===r||r(e),i.manager.itemError(o),i.manager.itemEnd(o)})),a}},{key:"loadFullHeadSimplified",value:function(e,t,n,r){var i=this,a=new s.FaceMesh,o="__zappar_threejs_face_mesh_full_head_".concat(JSON.stringify(e||"default"));return(e?e.customModel?a.load(e.customModel,e.fillMouth,e.fillEyeLeft,e.fillEyeRight,e.fillNeck):a.loadDefaultFullHeadSimplified(e.fillMouth,e.fillEyeLeft,e.fillEyeRight,e.fillNeck):a.loadDefaultFullHeadSimplified()).then((function(){null===t||void 0===t||t(a),i.manager.itemEnd(o)})).catch((function(e){null===r||void 0===r||r(e),i.manager.itemError(o),i.manager.itemEnd(o)})),a}},{key:"parse",value:function(){}}]),n}(n(5483).THREE.Loader);t.FaceMeshLoader=u},7267:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(2205).default,o=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.FaceTrackerLoader=void 0;var s=n(5483),u=n(8587),l=function(e){a(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new u.FaceTracker,o=e?a.loadModel(e):a.loadDefaultModel(),s="string"===typeof e?e:"__zappar_threejs_face_tracker_default";return o.then((function(){null===t||void 0===t||t(a),i.manager.itemEnd(s)})).catch((function(e){null===r||void 0===r||r(e),i.manager.itemError(s),i.manager.itemEnd(s)})),a}},{key:"parse",value:function(){}}]),n}(s.THREE.Loader);t.FaceTrackerLoader=l},7435:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(2205).default,o=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.HeadMaskMeshLoader=void 0;var s=n(5483),u=n(308),l="__zappar_threejs_head_mask_mesh",c=function(e){a(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"load",value:function(e,t,n){var r=this;return this.manager.itemStart(l),new u.HeadMaskMesh((function(){null===e||void 0===e||e(),r.manager.itemEnd(l)}),(function(){null===n||void 0===n||n(),r.manager.itemError(l),r.manager.itemEnd(l)}))}},{key:"parse",value:function(){}}]),n}(s.THREE.Loader);t.HeadMaskMeshLoader=c},1718:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(2205).default,o=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ImageTrackerLoader=void 0;var s=n(5483),u=n(8587),l=function(e){a(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new u.ImageTracker;return a.loadTarget(e).then((function(){null===t||void 0===t||t(a),i.manager.itemEnd(e)})).catch((function(t){null===r||void 0===r||r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),a}},{key:"parse",value:function(){}}]),n}(s.THREE.Loader);t.ImageTrackerLoader=l},9205:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(2205).default,o=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.LibraryLoader=void 0;var s=n(6903),u=n(5483),l="__zappar_threejs_library",c=function(e){a(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"load",value:function(e,t,n){var r=this;this.manager.itemStart(l),(0,s.loadedPromise)().then((function(){null===e||void 0===e||e(),r.manager.itemEnd(l)})).catch((function(e){null===n||void 0===n||n(),r.manager.itemError(l),r.manager.itemEnd(l)}))}},{key:"parse",value:function(){}}]),n}(u.THREE.Loader);t.LibraryLoader=c},4892:function(e,t,n){"use strict";var r=n(1506).default,i=n(2205).default,a=n(9842).default,o=n(4575).default,s=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingManager=t.DefaultLoaderUI=void 0;var u=n(5483),l=n(9205),c=function(){function e(t){var n=this;o(this,e),this.lastLoadPercentage=0,this.divs={inner:document.createElement("div"),title:document.createElement("div"),progress:document.createElement("div"),progressValue:document.createElement("div")},this.css={container:{position:"fixed",width:"100%",height:"100%",top:"0px",left:"0px",zIndex:"10000",backgroundColor:"rgba(0,0,0,0.8)",fontFamily:"sans-serif",color:"rgba(255,255,255,1)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",transition:"opacity 500ms"},inner:{maxWidth:"400px",textAlign:"center"},title:{fontSize:"20px"},progress:{background:"rgba(255,255,255, 0.1)",justifyContent:"flex-start",borderRadius:"100px",alignItems:"center",position:"relative",padding:"0 5px",display:"flex",height:"15px",width:"250px",margin:"15px"},progressValue:{boxShadow:"0 10px 40px -10px #fff",borderTopLeftRadius:"100px",borderBottomLeftRadius:"100px",background:"rgba(255,255,255,1)",height:"10px",width:"0",transition:"width 500ms"}},this.updateLoader=function(e){if(!(e<n.lastLoadPercentage)){n.lastLoadPercentage=e;var t=document.getElementById("zappar-loader-progressValue");t.style.width="".concat(e,"%"),t.style.borderTopRightRadius="".concat(e,"px"),t.style.borderBottomRightRadius="".concat(e,"px"),t.addEventListener("transitionend",(function(){100===e&&(n.containerDiv.style.opacity="0",n.containerDiv.addEventListener("transitionend",(function(e){"opacity"===e.propertyName&&n.dispose()})))}))}},this.dispose=function(){n.containerDiv.remove()},this.customStyle=t,this.containerDiv=document.createElement("div")}return s(e,[{key:"initialize",value:function(){for(var e in this.divs)this.divs[e].id="zappar-loader-".concat(e);this.refreshStyle(),this.divs.inner.appendChild(this.divs.title),this.divs.inner.appendChild(this.divs.progress),this.divs.progress.appendChild(this.divs.progressValue),this.containerDiv.appendChild(this.divs.inner),this.divs.title.innerHTML="Loading..",document.body.append(this.containerDiv)}},{key:"refreshStyle",value:function(){var e,t,n,r,i;Object.assign(this.css.container,null===(e=this.customStyle)||void 0===e?void 0:e.container),Object.assign(this.css.inner,null===(t=this.customStyle)||void 0===t?void 0:t.inner),Object.assign(this.css.title,null===(n=this.customStyle)||void 0===n?void 0:n.title),Object.assign(this.css.progress,null===(r=this.customStyle)||void 0===r?void 0:r.progress),Object.assign(this.css.progressValue,null===(i=this.customStyle)||void 0===i?void 0:i.progressValue),Object.assign(this.containerDiv.style,this.css.container),Object.assign(this.divs.inner.style,this.css.inner),Object.assign(this.divs.title.style,this.css.title),Object.assign(this.divs.progress.style,this.css.progress),Object.assign(this.divs.progressValue.style,this.css.progressValue)}}]),e}(),g=function(e){i(n,e);var t=a(n);function n(e){var r;return o(this,n),r=t.call(this,null===e||void 0===e?void 0:e.style),u.THREE.DefaultLoadingManager.onStart=function(){r.initialize()},u.THREE.DefaultLoadingManager.onLoad=function(){var t;null===(t=null===e||void 0===e?void 0:e.onLoad)||void 0===t||t.call(e)},u.THREE.DefaultLoadingManager.onProgress=function(e,t,n){r.updateLoader(t/n*100)},r}return s(n)}(c);t.DefaultLoaderUI=g;var d=function(e){i(n,e);var t=a(n);function n(e){var i;return o(this,n),(i=t.call(this,(function(){var t;return null===(t=null===e||void 0===e?void 0:e.onLoad)||void 0===t?void 0:t.call(e)}),(function(t,n,r){var a;i.ui.customStyle=null===e||void 0===e?void 0:e.style,i.ui.refreshStyle(),null===(a=null===e||void 0===e?void 0:e.onProgress)||void 0===a||a.call(e,t,n,r),i.ui.updateLoader(n/r*100)}),null===e||void 0===e?void 0:e.onError)).ui=new c,i.onStartCallback=void 0,i.onStart=function(){i.ui.initialize(),i.onStartCallback&&i.onStartCallback()},i._onStart=function(e){i.onStartCallback=e},i.dispose=function(){i.ui.dispose()},new l.LibraryLoader(r(i)).load(),i}return s(n)}(u.THREE.LoadingManager);t.LoadingManager=d},308:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(1506).default,o=n(2205).default,s=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.HeadMaskMesh=void 0;var u=n(1168),l=n(5483),c=n(5134),g=function(e){o(n,e);var t=s(n);function n(e,i){var o;return r(this,n),(o=t.call(this)).onLoad=e,o.onError=i,o.faceMesh=new u.FaceMesh,o.faceBufferGeometry=new c.FaceBufferGeometry(o.faceMesh),o.geometry=o.faceBufferGeometry,o.material=new l.THREE.MeshBasicMaterial({colorWrite:!1}),o.faceMesh.loadDefaultFullHeadSimplified(!0,!0,!0,!0).then((function(){var e;return null===(e=o.onLoad)||void 0===e?void 0:e.call(a(o))})).catch((function(){var e;return null===(e=o.onError)||void 0===e?void 0:e.call(a(o))})),o.renderOrder=Number.MIN_SAFE_INTEGER,o}return i(n,[{key:"updateFromFaceAnchorGroup",value:function(e){this.faceBufferGeometry.updateFromFaceAnchorGroup(e)}},{key:"updateFromFaceAnchor",value:function(e){this.faceBufferGeometry.updateFromFaceAnchor(e)}},{key:"updateFromIdentityExpression",value:function(e,t){this.faceBufferGeometry.updateFromIdentityExpression(e,t)}},{key:"dispose",value:function(){this.faceMesh.destroy(),this.faceBufferGeometry.dispose()}}]),n}(l.THREE.Mesh);t.HeadMaskMesh=g},5483:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.THREE=void 0;var r=n(4911);t.THREE=r},1342:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(6525).default,o=n(9754).default,s=n(2205).default,u=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.FaceAnchorGroup=void 0;var l=n(5483),c=n(4352),g=function(e){s(n,e);var t=u(n);function n(e,i,a){var o;return r(this,n),(o=t.call(this)).camera=e,o.faceTracker=i,o.anchorId=a,o.isReady=!1,o.matrixAutoUpdate=!1,o}return i(n,[{key:"updateMatrixWorld",value:function(e){this.currentAnchor&&this.faceTracker.visible.has(this.currentAnchor)||(this.anchorId?this.currentAnchor=this.faceTracker.anchors.get(this.anchorId):this.currentAnchor=this.faceTracker.visible.values().next().value),this.currentAnchor&&(this.matrix.fromArray(this.currentAnchor.pose(this.camera.rawPose,this.camera.currentMirrorMode===c.CameraMirrorMode.Poses)),this.matrix.decompose(this.position,this.quaternion,this.scale)),a(o(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(l.THREE.Group);t.FaceAnchorGroup=g},6786:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(6525).default,o=n(9754).default,s=n(2205).default,u=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.FaceLandmarkGroup=void 0;var l=n(1168),c=n(2e3),g=n(5483),d=n(4352),I=function(e){s(n,e);var t=u(n);function n(e,i,a){var o;return r(this,n),(o=t.call(this)).camera=e,o.faceTracker=i,o.pose=c.mat4.create(),o.landmark=new l.FaceLandmark(a),o.matrixAutoUpdate=!1,o}return i(n,[{key:"updateMatrixWorld",value:function(e){this.currentAnchor&&this.faceTracker.visible.has(this.currentAnchor)||(this.currentAnchor=this.faceTracker.visible.values().next().value),this.currentAnchor&&(this.landmark.updateFromFaceAnchor(this.currentAnchor,this.camera.currentMirrorMode===d.CameraMirrorMode.Poses),c.mat4.multiply(this.pose,this.currentAnchor.pose(this.camera.rawPose,this.camera.currentMirrorMode===d.CameraMirrorMode.Poses),this.landmark.pose),this.matrix.fromArray(this.pose),this.matrix.decompose(this.position,this.quaternion,this.scale)),a(o(n.prototype),"updateMatrixWorld",this).call(this,e)}},{key:"dispose",value:function(){this.landmark.destroy()}}]),n}(g.THREE.Group);t.FaceLandmarkGroup=I},3177:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(6525).default,o=n(9754).default,s=n(2205).default,u=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ImageAnchorGroup=void 0;var l=n(5483),c=n(4352),g=function(e){s(n,e);var t=u(n);function n(e,i,a){var o;return r(this,n),(o=t.call(this)).camera=e,o.imageTracker=i,o.anchorId=a,o.isReady=!1,o.matrixAutoUpdate=!1,o}return i(n,[{key:"updateMatrixWorld",value:function(e){this.currentAnchor&&this.imageTracker.visible.has(this.currentAnchor)||(this.anchorId?this.currentAnchor=this.imageTracker.anchors.get(this.anchorId):this.currentAnchor=this.imageTracker.visible.values().next().value),this.currentAnchor&&(this.matrix.fromArray(this.currentAnchor.pose(this.camera.rawPose,this.camera.currentMirrorMode===c.CameraMirrorMode.Poses)),this.matrix.decompose(this.position,this.quaternion,this.scale)),a(o(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(l.THREE.Group);t.ImageAnchorGroup=g},8425:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default,a=n(6525).default,o=n(9754).default,s=n(2205).default,u=n(9842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.InstantWorldAnchorGroup=void 0;var l=n(5483),c=n(4352),g=function(e){s(n,e);var t=u(n);function n(e,i){var a;return r(this,n),(a=t.call(this)).camera=e,a.instantTracker=i,a.matrixAutoUpdate=!1,a}return i(n,[{key:"setAnchorPoseFromCameraOffset",value:function(e,t,n,r){this.instantTracker.setAnchorPoseFromCameraOffset(e,t,n,r)}},{key:"updateMatrixWorld",value:function(e){this.matrix.fromArray(this.instantTracker.anchor.pose(this.camera.rawPose,this.camera.currentMirrorMode===c.CameraMirrorMode.Poses)),this.matrix.decompose(this.position,this.quaternion,this.scale),a(o(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(l.THREE.Group);t.InstantWorldAnchorGroup=g},4109:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0,t.VERSION="0.3.38"},6081:function(e,t,n){"use strict";var r=n(3269).default,i=n(4575).default,a=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.BarcodeFinder=void 0;var o=n(6366),s=n(5817),u=n(7057),l=function(){function e(t){var n=this;i(this,e),this._pipeline=t,this.onDetection=new o.Event1,this._lastDetected=[],this._found=[],this._formats=[],this._frameUpdate=function(){n._found=[];for(var e=n._z.barcode_finder_found_number(n._impl),t=0;t<e;t++)n._found.push({text:n._z.barcode_finder_found_text(n._impl,t),format:n._z.barcode_finder_found_format(n._impl,t)});if(0!==n._found.length){var i,a=r(n._found);try{e:for(a.s();!(i=a.n()).done;){var o,s=i.value,u=r(n._lastDetected);try{for(u.s();!(o=u.n()).done;){if(o.value.text===s.text)continue e}}catch(l){u.e(l)}finally{u.f()}n.onDetection.emit(s)}}catch(l){a.e(l)}finally{a.f()}n._lastDetected=n._found}},this._pipeline._onFrameUpdateInternal.bind(this._frameUpdate),this._z=u.z(),this._impl=this._z.barcode_finder_create(this._pipeline._getImpl()),this._formats.push.apply(this._formats,[s.barcode_format_t.AZTEC,s.barcode_format_t.CODABAR,s.barcode_format_t.CODE_39,s.barcode_format_t.CODE_93,s.barcode_format_t.CODE_128,s.barcode_format_t.DATA_MATRIX,s.barcode_format_t.EAN_8,s.barcode_format_t.EAN_13,s.barcode_format_t.ITF,s.barcode_format_t.MAXICODE,s.barcode_format_t.PDF_417,s.barcode_format_t.QR_CODE,s.barcode_format_t.RSS_14,s.barcode_format_t.RSS_EXPANDED,s.barcode_format_t.UPC_A,s.barcode_format_t.UPC_E,s.barcode_format_t.UPC_EAN_EXTENSION])}return a(e,[{key:"destroy",value:function(){this._pipeline._onFrameUpdateInternal.unbind(this._frameUpdate),this._found=[],this._lastDetected=[],this._z.barcode_finder_destroy(this._impl)}},{key:"found",get:function(){return this._found}},{key:"enabled",get:function(){return this._z.barcode_finder_enabled(this._impl)},set:function(e){this._z.barcode_finder_enabled_set(this._impl,e)}},{key:"formats",get:function(){return this._formats},set:function(e){this._formats=e.slice();var t,n=0,i=r(this._formats);try{for(i.s();!(t=i.n()).done;){n|=t.value}}catch(a){i.e(a)}finally{i.f()}this._z.barcode_finder_formats_set(this._impl,n)}}]),e}();t.BarcodeFinder=l},7720:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CameraSource=void 0;var a=n(7057),o=function(){function e(t,n){r(this,e),this._z=a.z(),this._impl=this._z.camera_source_create(t._getImpl(),n)}return i(e,[{key:"destroy",value:function(){this._z.camera_source_destroy(this._impl)}},{key:"start",value:function(){this._z.camera_source_start(this._impl)}},{key:"pause",value:function(){this._z.camera_source_pause(this._impl)}}]),e}();t.CameraSource=o},6366:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Event1=t.Event=void 0;var a=function(){function e(){r(this,e),this._funcs=[]}return i(e,[{key:"bind",value:function(e){this._funcs.push(e)}},{key:"unbind",value:function(e){var t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}},{key:"emit",value:function(){for(var e=0,t=this._funcs.length;e<t;e++)this._funcs[e]()}}]),e}();t.Event=a;var o=function(){function e(){r(this,e),this._funcs=[]}return i(e,[{key:"bind",value:function(e){this._funcs.push(e)}},{key:"unbind",value:function(e){var t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}},{key:"emit",value:function(e){for(var t=0,n=this._funcs.length;t<n;t++)this._funcs[t](e)}}]),e}();t.Event1=o},2692:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.FaceLandmark=t.FaceLandmarkName=void 0;var a=n(7057),o=n(2e3),s=n(5817);Object.defineProperty(t,"FaceLandmarkName",{enumerable:!0,get:function(){return s.face_landmark_name_t}});var u=function(){function e(t){r(this,e),this._name=t,this.pose=o.mat4.create(),this._z=a.z(),this._impl=this._z.face_landmark_create(this._name)}return i(e,[{key:"destroy",value:function(){this._z.face_landmark_destroy(this._impl)}},{key:"updateFromFaceAnchor",value:function(e,t){this._z.face_landmark_update(this._impl,e.identity,e.expression,t||!1),this.pose=this._z.face_landmark_anchor_pose(this._impl)}},{key:"updateFromIdentityExpression",value:function(e,t,n){this._z.face_landmark_update(this._impl,e,t,n||!1),this.pose=this._z.face_landmark_anchor_pose(this._impl)}},{key:"_getImpl",value:function(){return this._impl}}]),e}();t.FaceLandmark=u},934:function(e,t,n){"use strict";var r=n(7757),i=n(4575).default,a=n(3913).default,o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FaceMesh=void 0;var s=n(7057),u=function(){function e(){i(this,e),this._z=s.z(),this._impl=this._z.face_mesh_create()}return a(e,[{key:"destroy",value:function(){this._z.face_mesh_destroy(this._impl)}},{key:"load",value:function(e,t,n,i,a){return o(this,void 0,void 0,r.mark((function o(){return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=5;break}return this.loadDefault(),r.abrupt("return");case 5:if("string"!==typeof e){r.next=11;break}return r.next=8,fetch(e);case 8:return r.next=10,r.sent.arrayBuffer();case 10:e=r.sent;case 11:this._z.face_mesh_load_from_memory(this._impl,e,t||!1,n||!1,i||!1,a||!1);case 12:case"end":return r.stop()}}),o,this)})))}},{key:"loadDefault",value:function(){return o(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._z.face_mesh_load_default(this._impl);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"loadDefaultFace",value:function(e,t,n){return o(this,void 0,void 0,r.mark((function i(){return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._z.face_mesh_load_default_face(this._impl,e||!1,t||!1,n||!1);case 2:case"end":return r.stop()}}),i,this)})))}},{key:"loadDefaultFullHeadSimplified",value:function(e,t,n,i){return o(this,void 0,void 0,r.mark((function a(){return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._z.face_mesh_load_default_full_head_simplified(this._impl,e||!1,t||!1,n||!1,i||!1);case 2:case"end":return r.stop()}}),a,this)})))}},{key:"updateFromFaceAnchor",value:function(e,t){this._z.face_mesh_update(this._impl,e.identity,e.expression,t||!1)}},{key:"updateFromIdentityExpression",value:function(e,t,n){this._z.face_mesh_update(this._impl,e,t,n||!1)}},{key:"vertices",get:function(){return this._z.face_mesh_vertices(this._impl)}},{key:"indices",get:function(){return this._z.face_mesh_indices(this._impl)}},{key:"uvs",get:function(){return this._z.face_mesh_uvs(this._impl)}},{key:"normals",get:function(){return this._z.face_mesh_normals(this._impl)}},{key:"_getImpl",value:function(){return this._impl}}]),e}();t.FaceMesh=u},2949:function(e,t,n){"use strict";var r=n(7757),i=n(3269).default,a=n(4575).default,o=n(3913).default,s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FaceTracker=void 0;var u=n(6366),l=n(7057),c=function(){function e(t){var n=this;a(this,e),this._pipeline=t,this.onVisible=new u.Event1,this.onNotVisible=new u.Event1,this.onNewAnchor=new u.Event1,this.visible=new Set,this.anchors=new Map,this._visibleLastFrame=new Set,this._frameUpdate=function(){var e=new Set,t=n.visible;n.visible=n._visibleLastFrame,n._visibleLastFrame=t,n.visible.clear();for(var r=n._z.face_tracker_anchor_count(n._impl),a=function(t){var r=n._z.face_tracker_anchor_id(n._impl,t),i=n.anchors.get(r);i||(i={onVisible:new u.Event,onNotVisible:new u.Event,indx:0,id:r,poseCameraRelative:function(e){return n._z.face_tracker_anchor_pose_camera_relative(n._impl,i.indx,!0===e)},pose:function(e,t){return n._z.face_tracker_anchor_pose(n._impl,i.indx,e,!0===t)},identity:new Float32Array(50),expression:new Float32Array(29),visible:!0},!0,n.anchors.set(r,i),e.add(i)),i.indx=t,i.visible=!0,i.identity=n._z.face_tracker_anchor_identity_coefficients(n._impl,t),i.expression=n._z.face_tracker_anchor_expression_coefficients(n._impl,t),n.visible.add(i)},o=0;o<r;o++)a(o);var s,l=i(e);try{for(l.s();!(s=l.n()).done;){var c=s.value;n.onNewAnchor.emit(c)}}catch(p){l.e(p)}finally{l.f()}var g,d=i(n.visible);try{for(d.s();!(g=d.n()).done;){var I=g.value;n._visibleLastFrame.has(I)?n._visibleLastFrame.delete(I):(n.onVisible.emit(I),I.onVisible.emit())}}catch(p){d.e(p)}finally{d.f()}var C,h=i(n._visibleLastFrame);try{for(h.s();!(C=h.n()).done;){var f=C.value;n.onNotVisible.emit(f),f.onNotVisible.emit()}}catch(p){h.e(p)}finally{h.f()}},this._pipeline._onFrameUpdateInternal.bind(this._frameUpdate),this._z=l.z(),this._impl=this._z.face_tracker_create(this._pipeline._getImpl())}return o(e,[{key:"destroy",value:function(){this._pipeline._onFrameUpdateInternal.unbind(this._frameUpdate),this.anchors.clear(),this.visible.clear(),this._z.face_tracker_destroy(this._impl)}},{key:"loadModel",value:function(e){return s(this,void 0,void 0,r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!==typeof e){t.next=6;break}return t.next=3,fetch(e);case 3:return t.next=5,t.sent.arrayBuffer();case 5:e=t.sent;case 6:this._z.face_tracker_model_load_from_memory(this._impl,e);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"loadDefaultModel",value:function(){return s(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._z.face_tracker_model_load_default(this._impl);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"enabled",get:function(){return this._z.face_tracker_enabled(this._impl)},set:function(e){this._z.face_tracker_enabled_set(this._impl,e)}},{key:"maxFaces",get:function(){return this._z.face_tracker_max_faces(this._impl)},set:function(e){this._z.face_tracker_max_faces_set(this._impl,e)}}]),e}();t.FaceTracker=c},1953:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.HTMLElementSource=void 0;var a=n(7057),o=function(){function e(t,n){r(this,e),this._z=a.z(),this._impl=this._z.html_element_source_create(t._getImpl(),n)}return i(e,[{key:"destroy",value:function(){this._z.html_element_source_destroy(this._impl)}},{key:"start",value:function(){this._z.html_element_source_start(this._impl)}},{key:"pause",value:function(){this._z.html_element_source_pause(this._impl)}}]),e}();t.HTMLElementSource=o},5912:function(e,t,n){"use strict";var r=n(7757),i=n(3269).default,a=n(4575).default,o=n(3913).default,s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ImageTracker=void 0;var u=n(6366),l=n(7057),c=function(){function e(t,n){var r=this;a(this,e),this._pipeline=t,this.onVisible=new u.Event1,this.onNotVisible=new u.Event1,this.onNewAnchor=new u.Event1,this.visible=new Set,this.anchors=new Map,this._visibleLastFrame=new Set,this._frameUpdate=function(){var e=new Set,t=r.visible;r.visible=r._visibleLastFrame,r._visibleLastFrame=t,r.visible.clear();for(var n=r._z.image_tracker_anchor_count(r._impl),a=function(t){var n=r._z.image_tracker_anchor_id(r._impl,t),i=r.anchors.get(n);i||(i={onVisible:new u.Event,onNotVisible:new u.Event,id:n,poseCameraRelative:function(e){return r._z.image_tracker_anchor_pose_camera_relative(r._impl,t,!0===e)},pose:function(e,n){return r._z.image_tracker_anchor_pose(r._impl,t,e,!0===n)},visible:!0},!0,r.anchors.set(n,i),e.add(i)),i.visible=!0,r.visible.add(i)},o=0;o<n;o++)a(o);var s,l=i(e);try{for(l.s();!(s=l.n()).done;){var c=s.value;r.onNewAnchor.emit(c)}}catch(p){l.e(p)}finally{l.f()}var g,d=i(r.visible);try{for(d.s();!(g=d.n()).done;){var I=g.value;r._visibleLastFrame.has(I)?r._visibleLastFrame.delete(I):(r.onVisible.emit(I),I.onVisible.emit())}}catch(p){d.e(p)}finally{d.f()}var C,h=i(r._visibleLastFrame);try{for(h.s();!(C=h.n()).done;){var f=C.value;r.onNotVisible.emit(f),f.onNotVisible.emit()}}catch(p){h.e(p)}finally{h.f()}},this._pipeline._onFrameUpdateInternal.bind(this._frameUpdate),this._z=l.z(),this._impl=this._z.image_tracker_create(this._pipeline._getImpl()),n&&this.loadTarget(n)}return o(e,[{key:"destroy",value:function(){this._pipeline._onFrameUpdateInternal.unbind(this._frameUpdate),this.anchors.clear(),this.visible.clear(),this._z.image_tracker_destroy(this._impl)}},{key:"loadTarget",value:function(e){return s(this,void 0,void 0,r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!==typeof e){t.next=6;break}return t.next=3,fetch(e);case 3:return t.next=5,t.sent.arrayBuffer();case 5:e=t.sent;case 6:this._z.image_tracker_target_load_from_memory(this._impl,e);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"enabled",get:function(){return this._z.image_tracker_enabled(this._impl)},set:function(e){this._z.image_tracker_enabled_set(this._impl,e)}}]),e}();t.ImageTracker=c},1168:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadedPromise=t.loaded=t.browserIncompatibleUI=t.browserIncompatible=t.projectionMatrixFromCameraModel=t.drawPlane=t.invert=t.cameraDefaultDeviceID=t.Event1=t.Event=t.logLevel=t.setLogLevel=t.LogLevel=t.Permission=t.permissionRequestUI=t.permissionRequest=t.permissionDenied=t.permissionGranted=t.permissionDeniedUI=t.FaceLandmark=t.FaceLandmarkName=t.Pipeline=t.HTMLElementSource=t.CameraSource=t.FaceMesh=t.FaceTracker=t.BarcodeFinder=t.InstantWorldTracker=t.ImageTracker=void 0;var r=n(5912);Object.defineProperty(t,"ImageTracker",{enumerable:!0,get:function(){return r.ImageTracker}});var i=n(5533);Object.defineProperty(t,"InstantWorldTracker",{enumerable:!0,get:function(){return i.InstantWorldTracker}});var a=n(6081);Object.defineProperty(t,"BarcodeFinder",{enumerable:!0,get:function(){return a.BarcodeFinder}});var o=n(2949);Object.defineProperty(t,"FaceTracker",{enumerable:!0,get:function(){return o.FaceTracker}});var s=n(934);Object.defineProperty(t,"FaceMesh",{enumerable:!0,get:function(){return s.FaceMesh}});var u=n(7720);Object.defineProperty(t,"CameraSource",{enumerable:!0,get:function(){return u.CameraSource}});var l=n(1953);Object.defineProperty(t,"HTMLElementSource",{enumerable:!0,get:function(){return l.HTMLElementSource}});var c=n(7192);Object.defineProperty(t,"Pipeline",{enumerable:!0,get:function(){return c.Pipeline}});var g=n(2692);Object.defineProperty(t,"FaceLandmarkName",{enumerable:!0,get:function(){return g.FaceLandmarkName}}),Object.defineProperty(t,"FaceLandmark",{enumerable:!0,get:function(){return g.FaceLandmark}});var d=n(5007);Object.defineProperty(t,"permissionDeniedUI",{enumerable:!0,get:function(){return d.permissionDeniedUI}}),Object.defineProperty(t,"permissionGranted",{enumerable:!0,get:function(){return d.permissionGranted}}),Object.defineProperty(t,"permissionDenied",{enumerable:!0,get:function(){return d.permissionDenied}}),Object.defineProperty(t,"permissionRequest",{enumerable:!0,get:function(){return d.permissionRequest}}),Object.defineProperty(t,"permissionRequestUI",{enumerable:!0,get:function(){return d.permissionRequestUI}}),Object.defineProperty(t,"Permission",{enumerable:!0,get:function(){return d.Permission}});var I=n(9725);Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return I.LogLevel}}),Object.defineProperty(t,"setLogLevel",{enumerable:!0,get:function(){return I.setLogLevel}}),Object.defineProperty(t,"logLevel",{enumerable:!0,get:function(){return I.logLevel}});var C=n(6366);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return C.Event}}),Object.defineProperty(t,"Event1",{enumerable:!0,get:function(){return C.Event1}});var h=n(7057);Object.defineProperty(t,"cameraDefaultDeviceID",{enumerable:!0,get:function(){return h.cameraDefaultDeviceID}}),Object.defineProperty(t,"invert",{enumerable:!0,get:function(){return h.invert}}),Object.defineProperty(t,"drawPlane",{enumerable:!0,get:function(){return h.drawPlane}}),Object.defineProperty(t,"projectionMatrixFromCameraModel",{enumerable:!0,get:function(){return h.projectionMatrixFromCameraModel}}),Object.defineProperty(t,"browserIncompatible",{enumerable:!0,get:function(){return h.browserIncompatible}}),Object.defineProperty(t,"browserIncompatibleUI",{enumerable:!0,get:function(){return h.browserIncompatibleUI}}),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return h.loaded}}),Object.defineProperty(t,"loadedPromise",{enumerable:!0,get:function(){return h.loadedPromise}})},5533:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.InstantWorldTracker=void 0;var a=n(5817),o=n(7057),s=function(){function e(t){var n=this;r(this,e),this._pipeline=t,this.anchor={poseCameraRelative:function(e){return n._anchorPoseCameraRelative(e)},pose:function(e,t){return n._anchorPose(e,t)}},this._z=o.z(),this._impl=this._z.instant_world_tracker_create(this._pipeline._getImpl())}return i(e,[{key:"destroy",value:function(){this._z.instant_world_tracker_destroy(this._impl)}},{key:"_anchorPoseCameraRelative",value:function(e){return this._z.instant_world_tracker_anchor_pose_camera_relative(this._impl,!0===e)}},{key:"_anchorPose",value:function(e,t){return this._z.instant_world_tracker_anchor_pose(this._impl,e,!0===t)}},{key:"enabled",get:function(){return this._z.instant_world_tracker_enabled(this._impl)},set:function(e){this._z.instant_world_tracker_enabled_set(this._impl,e)}},{key:"setAnchorPoseFromCameraOffset",value:function(e,t,n,r){this._z.instant_world_tracker_anchor_pose_set_from_camera_offset(this._impl,e,t,n,r||a.instant_world_tracker_transform_orientation_t.MINUS_Z_AWAY_FROM_USER)}}]),e}();t.InstantWorldTracker=s},9725:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setLogLevel=t.logLevel=t.LogLevel=void 0;var r=n(7057),i=n(5817);Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return i.log_level_t}}),t.logLevel=function(){return r.z().log_level()},t.setLogLevel=function(e){r.z().log_level_set(e)}},5007:function(e,t,n){"use strict";var r=n(7757),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.permissionDeniedUI=t.permissionRequestUI=t.permissionRequest=t.permissionDenied=t.permissionGranted=t.Permission=void 0;var a,o=n(7057);!function(e){e[e.CAMERA=0]="CAMERA",e[e.MOTION=1]="MOTION"}(a=t.Permission||(t.Permission={})),t.permissionGranted=function(e){switch(e){case a.CAMERA:return o.z().permission_granted_camera();case a.MOTION:return o.z().permission_granted_motion();default:return o.z().permission_granted_all()}},t.permissionDenied=function(e){switch(e){case a.CAMERA:return o.z().permission_denied_camera();case a.MOTION:return o.z().permission_denied_motion();default:return o.z().permission_denied_any()}},t.permissionRequest=function(e){var t=this;switch(e){case a.CAMERA:o.z().permission_request_camera();break;case a.MOTION:o.z().permission_request_motion();break;default:o.z().permission_request_all()}return new Promise((function(n){return i(t,void 0,void 0,r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,new Promise((function(e){return requestAnimationFrame((function(){return e()}))}));case 3:t.t0=e,t.next=t.t0===a.CAMERA?6:t.t0===a.MOTION?13:20;break;case 6:if(!o.z().permission_granted_camera()){t.next=9;break}return n(!0),t.abrupt("return");case 9:if(!o.z().permission_denied_camera()){t.next=12;break}return n(!1),t.abrupt("return");case 12:case 19:case 26:return t.abrupt("break",27);case 13:if(!o.z().permission_granted_motion()){t.next=16;break}return n(!0),t.abrupt("return");case 16:if(!o.z().permission_denied_motion()){t.next=19;break}return n(!1),t.abrupt("return");case 20:if(!o.z().permission_granted_camera()||!o.z().permission_granted_motion()){t.next=23;break}return n(!0),t.abrupt("return");case 23:if(!o.z().permission_denied_camera()&&!o.z().permission_denied_motion()){t.next=26;break}return n(!1),t.abrupt("return");case 27:t.next=0;break;case 29:case"end":return t.stop()}}),t)})))}))},t.permissionRequestUI=function(){return i(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.z().permission_request_ui_promise();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t.permissionDeniedUI=function(){return o.z().permission_denied_ui()}},7192:function(e,t,n){"use strict";var r=n(4575).default,i=n(3913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Pipeline=void 0;var a=n(7057),o=n(6366),s=function(){function e(){r(this,e),this.onFrameUpdate=new o.Event,this._onFrameUpdateInternal=new o.Event,this._lastFrameNumber=-1,this._z=a.z(),this._impl=this._z.pipeline_create()}return i(e,[{key:"destroy",value:function(){this._z.pipeline_destroy(this._impl)}},{key:"frameUpdate",value:function(){this._z.pipeline_frame_update(this._impl);var e=this._z.pipeline_frame_number(this._impl);e!==this._lastFrameNumber&&(this._lastFrameNumber=e,this._onFrameUpdateInternal.emit(),this.onFrameUpdate.emit())}},{key:"_getImpl",value:function(){return this._impl}},{key:"glContextSet",value:function(e){this._z.pipeline_gl_context_set(this._impl,e)}},{key:"glContextLost",value:function(){this._z.pipeline_gl_context_lost(this._impl)}},{key:"cameraFrameTextureGL",value:function(){return this._z.pipeline_camera_frame_texture_gl(this._impl)}},{key:"cameraFrameTextureMatrix",value:function(e,t,n){return this._z.pipeline_camera_frame_texture_matrix(this._impl,e,t,!0===n)}},{key:"cameraFrameDrawGL",value:function(e,t,n){this._z.pipeline_camera_frame_draw_gl(this._impl,e,t,n)}},{key:"cameraFrameUploadGL",value:function(){this._z.pipeline_camera_frame_upload_gl(this._impl)}},{key:"processGL",value:function(){this._z.pipeline_process_gl(this._impl)}},{key:"cameraModel",value:function(){return this._z.pipeline_camera_model(this._impl)}},{key:"cameraPoseDefault",value:function(){return this._z.pipeline_camera_pose_default(this._impl)}},{key:"cameraPoseWithAttitude",value:function(e){return this._z.pipeline_camera_pose_with_attitude(this._impl,e||!1)}},{key:"cameraPoseWithOrigin",value:function(e){return this._z.pipeline_camera_pose_with_origin(this._impl,e)}},{key:"cameraFrameUserFacing",value:function(){return this._z.pipeline_camera_frame_user_facing(this._impl)}},{key:"drawFace",value:function(e,t,n,r){this._z.pipeline_draw_face(this._impl,e,t,n,r._getImpl())}},{key:"frameNumber",value:function(){return this._z.pipeline_frame_number(this._impl)}}]),e}();t.Pipeline=s},7727:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0,t.VERSION="0.3.17"},7057:function(e,t,n){"use strict";var r=n(7757),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.loadedPromise=t.loaded=t.browserIncompatibleUI=t.browserIncompatible=t.drawPlane=t.projectionMatrixFromCameraModel=t.invert=t.cameraDefaultDeviceID=t.z=void 0;var a,o=n(5817),s=n(2e3),u=n(7727);function l(){return a||(console.log("Zappar JS v".concat(u.VERSION)),a=o.initialize()),a}function c(){return l().loaded()}function g(e){return new Promise((function(t){return setTimeout(t,e)}))}t.z=l,t.cameraDefaultDeviceID=function(e){return l().camera_default_device_id(e||!1)},t.invert=function(e){var t=s.mat4.create();return s.mat4.invert(t,e),t},t.projectionMatrixFromCameraModel=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;return l().projection_matrix_from_camera_model_ext(e,t,n,r,i)},t.drawPlane=function(e,t,n,r,i){l().draw_plane(e,t,n,r,i)},t.browserIncompatible=function(){return l().browser_incompatible()},t.browserIncompatibleUI=function(){l().browser_incompatible_ui()},t.loaded=c,t.loadedPromise=function(){return i(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,g(50);case 5:e.next=0;break;case 7:case"end":return e.stop()}}),e)})))}},1870:function(e){function t(e,t,n){var r,i,a,o,s;function u(){var l=Date.now()-o;l<t&&l>=0?r=setTimeout(u,t-l):(r=null,n||(s=e.apply(a,i),a=i=null))}null==t&&(t=100);var l=function(){a=this,i=arguments,o=Date.now();var l=n&&!r;return r||(r=setTimeout(u,t)),l&&(s=e.apply(a,i),a=i=null),s};return l.clear=function(){r&&(clearTimeout(r),r=null)},l.flush=function(){r&&(s=e.apply(a,i),a=i=null,clearTimeout(r),r=null)},l}t.debounce=t,e.exports=t},580:function(e){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!==i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(a=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!==i--;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;0!==i--;){var o=a[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}},2e3:function(e,t,n){"use strict";n.r(t),n.d(t,{glMatrix:function(){return r},mat2:function(){return i},mat2d:function(){return a},mat3:function(){return o},mat4:function(){return s},quat:function(){return c},quat2:function(){return g},vec2:function(){return d},vec3:function(){return u},vec4:function(){return l}});var r={};n.r(r),n.d(r,{ARRAY_TYPE:function(){return C},EPSILON:function(){return I},RANDOM:function(){return h},equals:function(){return m},setMatrixArrayType:function(){return f},toRadian:function(){return A}});var i={};n.r(i),n.d(i,{LDU:function(){return X},add:function(){return H},adjoint:function(){return x},clone:function(){return b},copy:function(){return y},create:function(){return v},determinant:function(){return S},equals:function(){return N},exactEquals:function(){return z},frob:function(){return E},fromRotation:function(){return k},fromScaling:function(){return V},fromValues:function(){return G},identity:function(){return B},invert:function(){return _},mul:function(){return K},multiply:function(){return R},multiplyScalar:function(){return Y},multiplyScalarAndAdd:function(){return T},rotate:function(){return M},scale:function(){return W},set:function(){return Z},str:function(){return F},sub:function(){return D},subtract:function(){return L},transpose:function(){return w}});var a={};n.r(a),n.d(a,{add:function(){return le},clone:function(){return U},copy:function(){return O},create:function(){return P},determinant:function(){return $},equals:function(){return Ce},exactEquals:function(){return Ie},frob:function(){return ue},fromRotation:function(){return ie},fromScaling:function(){return ae},fromTranslation:function(){return oe},fromValues:function(){return Q},identity:function(){return J},invert:function(){return q},mul:function(){return he},multiply:function(){return ee},multiplyScalar:function(){return ge},multiplyScalarAndAdd:function(){return de},rotate:function(){return te},scale:function(){return ne},set:function(){return j},str:function(){return se},sub:function(){return fe},subtract:function(){return ce},translate:function(){return re}});var o={};n.r(o),n.d(o,{add:function(){return Ne},adjoint:function(){return we},clone:function(){return me},copy:function(){return ve},create:function(){return pe},determinant:function(){return _e},equals:function(){return Pe},exactEquals:function(){return De},frob:function(){return ze},fromMat2d:function(){return Fe},fromMat4:function(){return Ae},fromQuat:function(){return Ee},fromRotation:function(){return ke},fromScaling:function(){return Ve},fromTranslation:function(){return We},fromValues:function(){return be},identity:function(){return Be},invert:function(){return Ze},mul:function(){return Ue},multiply:function(){return xe},multiplyScalar:function(){return Te},multiplyScalarAndAdd:function(){return Ke},normalFromMat4:function(){return Xe},projection:function(){return He},rotate:function(){return Re},scale:function(){return Me},set:function(){return ye},str:function(){return Le},sub:function(){return Oe},subtract:function(){return Ye},translate:function(){return Se},transpose:function(){return Ge}});var s={};n.r(s),n.d(s,{add:function(){return Vt},adjoint:function(){return rt},clone:function(){return Qe},copy:function(){return je},create:function(){return Je},determinant:function(){return it},equals:function(){return Lt},exactEquals:function(){return Ht},frob:function(){return kt},fromQuat:function(){return Zt},fromQuat2:function(){return mt},fromRotation:function(){return Ct},fromRotationTranslation:function(){return At},fromRotationTranslationScale:function(){return Bt},fromRotationTranslationScaleOrigin:function(){return Gt},fromScaling:function(){return It},fromTranslation:function(){return dt},fromValues:function(){return qe},fromXRotation:function(){return ht},fromYRotation:function(){return ft},fromZRotation:function(){return pt},frustum:function(){return wt},getRotation:function(){return yt},getScaling:function(){return bt},getTranslation:function(){return vt},identity:function(){return et},invert:function(){return nt},lookAt:function(){return Rt},mul:function(){return zt},multiply:function(){return at},multiplyScalar:function(){return Et},multiplyScalarAndAdd:function(){return Xt},ortho:function(){return St},perspective:function(){return _t},perspectiveFromFieldOfView:function(){return xt},rotate:function(){return ut},rotateX:function(){return lt},rotateY:function(){return ct},rotateZ:function(){return gt},scale:function(){return st},set:function(){return $e},str:function(){return Wt},sub:function(){return Nt},subtract:function(){return Ft},targetTo:function(){return Mt},translate:function(){return ot},transpose:function(){return tt}});var u={};n.r(u),n.d(u,{add:function(){return Ot},angle:function(){return Gn},bezier:function(){return fn},ceil:function(){return qt},clone:function(){return Tt},copy:function(){return Pt},create:function(){return Yt},cross:function(){return In},dist:function(){return Wn},distance:function(){return on},div:function(){return Mn},divide:function(){return jt},dot:function(){return dn},equals:function(){return xn},exactEquals:function(){return _n},floor:function(){return $t},forEach:function(){return En},fromValues:function(){return Dt},hermite:function(){return hn},inverse:function(){return cn},len:function(){return Vn},length:function(){return Kt},lerp:function(){return Cn},max:function(){return tn},min:function(){return en},mul:function(){return Rn},multiply:function(){return Qt},negate:function(){return ln},normalize:function(){return gn},random:function(){return pn},rotateX:function(){return bn},rotateY:function(){return yn},rotateZ:function(){return Bn},round:function(){return nn},scale:function(){return rn},scaleAndAdd:function(){return an},set:function(){return Ut},sqrDist:function(){return kn},sqrLen:function(){return Fn},squaredDistance:function(){return sn},squaredLength:function(){return un},str:function(){return wn},sub:function(){return Sn},subtract:function(){return Jt},transformMat3:function(){return mn},transformMat4:function(){return An},transformQuat:function(){return vn},zero:function(){return Zn}});var l={};n.r(l),n.d(l,{add:function(){return Yn},ceil:function(){return Pn},clone:function(){return Hn},copy:function(){return zn},create:function(){return Xn},cross:function(){return sr},dist:function(){return mr},distance:function(){return $n},div:function(){return Ar},divide:function(){return Dn},dot:function(){return or},equals:function(){return hr},exactEquals:function(){return Cr},floor:function(){return Un},forEach:function(){return Br},fromValues:function(){return Ln},inverse:function(){return ir},len:function(){return br},length:function(){return tr},lerp:function(){return ur},max:function(){return Jn},min:function(){return On},mul:function(){return pr},multiply:function(){return Kn},negate:function(){return rr},normalize:function(){return ar},random:function(){return lr},round:function(){return Qn},scale:function(){return jn},scaleAndAdd:function(){return qn},set:function(){return Nn},sqrDist:function(){return vr},sqrLen:function(){return yr},squaredDistance:function(){return er},squaredLength:function(){return nr},str:function(){return Ir},sub:function(){return fr},subtract:function(){return Tn},transformMat4:function(){return cr},transformQuat:function(){return gr},zero:function(){return dr}});var c={};n.r(c),n.d(c,{add:function(){return Or},calculateW:function(){return kr},clone:function(){return Kr},conjugate:function(){return zr},copy:function(){return Pr},create:function(){return Gr},dot:function(){return jr},equals:function(){return ai},exactEquals:function(){return ii},exp:function(){return Vr},fromEuler:function(){return Yr},fromMat3:function(){return Nr},fromValues:function(){return Dr},getAngle:function(){return xr},getAxisAngle:function(){return _r},identity:function(){return Zr},invert:function(){return Lr},len:function(){return ei},length:function(){return $r},lerp:function(){return qr},ln:function(){return Fr},mul:function(){return Jr},multiply:function(){return Sr},normalize:function(){return ri},pow:function(){return Er},random:function(){return Hr},rotateX:function(){return Rr},rotateY:function(){return Mr},rotateZ:function(){return Wr},rotationTo:function(){return oi},scale:function(){return Qr},set:function(){return Ur},setAxes:function(){return ui},setAxisAngle:function(){return wr},slerp:function(){return Xr},sqlerp:function(){return si},sqrLen:function(){return ni},squaredLength:function(){return ti},str:function(){return Tr}});var g={};n.r(g),n.d(g,{add:function(){return Wi},clone:function(){return ci},conjugate:function(){return Li},copy:function(){return pi},create:function(){return li},dot:function(){return Ei},equals:function(){return Ui},exactEquals:function(){return Pi},fromMat4:function(){return fi},fromRotation:function(){return hi},fromRotationTranslation:function(){return Ii},fromRotationTranslationValues:function(){return di},fromTranslation:function(){return Ci},fromValues:function(){return gi},getDual:function(){return bi},getReal:function(){return vi},getTranslation:function(){return Gi},identity:function(){return Ai},invert:function(){return Hi},len:function(){return Ni},length:function(){return zi},lerp:function(){return Xi},mul:function(){return Vi},multiply:function(){return ki},normalize:function(){return Ki},rotateAroundAxis:function(){return Mi},rotateByQuatAppend:function(){return Si},rotateByQuatPrepend:function(){return Ri},rotateX:function(){return wi},rotateY:function(){return _i},rotateZ:function(){return xi},scale:function(){return Fi},set:function(){return mi},setDual:function(){return Bi},setReal:function(){return yi},sqrLen:function(){return Ti},squaredLength:function(){return Yi},str:function(){return Di},translate:function(){return Zi}});var d={};n.r(d),n.d(d,{add:function(){return $i},angle:function(){return wa},ceil:function(){return ra},clone:function(){return Ji},copy:function(){return ji},create:function(){return Oi},cross:function(){return Aa},dist:function(){return Fa},distance:function(){return ca},div:function(){return Va},divide:function(){return na},dot:function(){return pa},equals:function(){return Ra},exactEquals:function(){return Sa},floor:function(){return ia},forEach:function(){return Ha},fromValues:function(){return Qi},inverse:function(){return ha},len:function(){return Ma},length:function(){return da},lerp:function(){return ma},max:function(){return oa},min:function(){return aa},mul:function(){return ka},multiply:function(){return ta},negate:function(){return Ca},normalize:function(){return fa},random:function(){return va},rotate:function(){return Za},round:function(){return sa},scale:function(){return ua},scaleAndAdd:function(){return la},set:function(){return qi},sqrDist:function(){return Ea},sqrLen:function(){return Xa},squaredDistance:function(){return ga},squaredLength:function(){return Ia},str:function(){return xa},sub:function(){return Wa},subtract:function(){return ea},transformMat2:function(){return ba},transformMat2d:function(){return ya},transformMat3:function(){return Ba},transformMat4:function(){return Ga},zero:function(){return _a}});var I=1e-6,C="undefined"!==typeof Float32Array?Float32Array:Array,h=Math.random;function f(e){C=e}var p=Math.PI/180;function A(e){return e*p}function m(e,t){return Math.abs(e-t)<=I*Math.max(1,Math.abs(e),Math.abs(t))}function v(){var e=new C(4);return C!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function b(e){var t=new C(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function y(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function B(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function G(e,t,n,r){var i=new C(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function Z(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}function w(e,t){if(e===t){var n=t[1];e[1]=t[2],e[2]=n}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e}function _(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n*a-i*r;return o?(o=1/o,e[0]=a*o,e[1]=-r*o,e[2]=-i*o,e[3]=n*o,e):null}function x(e,t){var n=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=n,e}function S(e){return e[0]*e[3]-e[2]*e[1]}function R(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=n[0],u=n[1],l=n[2],c=n[3];return e[0]=r*s+a*u,e[1]=i*s+o*u,e[2]=r*l+a*c,e[3]=i*l+o*c,e}function M(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+a*s,e[1]=i*u+o*s,e[2]=r*-s+a*u,e[3]=i*-s+o*u,e}function W(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=n[0],u=n[1];return e[0]=r*s,e[1]=i*s,e[2]=a*u,e[3]=o*u,e}function k(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e}function V(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e}function F(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function E(e){return Math.hypot(e[0],e[1],e[2],e[3])}function X(e,t,n,r){return e[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-e[2]*n[1],[e,t,n]}function H(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function L(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function z(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function N(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=t[0],s=t[1],u=t[2],l=t[3];return Math.abs(n-o)<=I*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=I*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=I*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-l)<=I*Math.max(1,Math.abs(a),Math.abs(l))}function Y(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function T(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var K=R,D=L;function P(){var e=new C(6);return C!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function U(e){var t=new C(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function O(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function J(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function Q(e,t,n,r,i,a){var o=new C(6);return o[0]=e,o[1]=t,o[2]=n,o[3]=r,o[4]=i,o[5]=a,o}function j(e,t,n,r,i,a,o){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=o,e}function q(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=n*a-r*i;return u?(u=1/u,e[0]=a*u,e[1]=-r*u,e[2]=-i*u,e[3]=n*u,e[4]=(i*s-a*o)*u,e[5]=(r*o-n*s)*u,e):null}function $(e){return e[0]*e[3]-e[1]*e[2]}function ee(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=n[0],c=n[1],g=n[2],d=n[3],I=n[4],C=n[5];return e[0]=r*l+a*c,e[1]=i*l+o*c,e[2]=r*g+a*d,e[3]=i*g+o*d,e[4]=r*I+a*C+s,e[5]=i*I+o*C+u,e}function te(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=Math.sin(n),c=Math.cos(n);return e[0]=r*c+a*l,e[1]=i*c+o*l,e[2]=r*-l+a*c,e[3]=i*-l+o*c,e[4]=s,e[5]=u,e}function ne(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=n[0],c=n[1];return e[0]=r*l,e[1]=i*l,e[2]=a*c,e[3]=o*c,e[4]=s,e[5]=u,e}function re(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=n[0],c=n[1];return e[0]=r,e[1]=i,e[2]=a,e[3]=o,e[4]=r*l+a*c+s,e[5]=i*l+o*c+u,e}function ie(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e[4]=0,e[5]=0,e}function ae(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function oe(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function se(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function ue(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)}function le(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e}function ce(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e}function ge(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e}function de(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e}function Ie(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function Ce(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=t[0],l=t[1],c=t[2],g=t[3],d=t[4],C=t[5];return Math.abs(n-u)<=I*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-l)<=I*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-c)<=I*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-g)<=I*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(o-d)<=I*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(s-C)<=I*Math.max(1,Math.abs(s),Math.abs(C))}var he=ee,fe=ce;function pe(){var e=new C(9);return C!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Ae(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function me(e){var t=new C(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function ve(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function be(e,t,n,r,i,a,o,s,u){var l=new C(9);return l[0]=e,l[1]=t,l[2]=n,l[3]=r,l[4]=i,l[5]=a,l[6]=o,l[7]=s,l[8]=u,l}function ye(e,t,n,r,i,a,o,s,u,l){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e}function Be(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ge(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Ze(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],g=c*o-s*l,d=-c*a+s*u,I=l*a-o*u,C=n*g+r*d+i*I;return C?(C=1/C,e[0]=g*C,e[1]=(-c*r+i*l)*C,e[2]=(s*r-i*o)*C,e[3]=d*C,e[4]=(c*n-i*u)*C,e[5]=(-s*n+i*a)*C,e[6]=I*C,e[7]=(-l*n+r*u)*C,e[8]=(o*n-r*a)*C,e):null}function we(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8];return e[0]=o*c-s*l,e[1]=i*l-r*c,e[2]=r*s-i*o,e[3]=s*u-a*c,e[4]=n*c-i*u,e[5]=i*a-n*s,e[6]=a*l-o*u,e[7]=r*u-n*l,e[8]=n*o-r*a,e}function _e(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8];return t*(l*a-o*u)+n*(-l*i+o*s)+r*(u*i-a*s)}function xe(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],g=t[8],d=n[0],I=n[1],C=n[2],h=n[3],f=n[4],p=n[5],A=n[6],m=n[7],v=n[8];return e[0]=d*r+I*o+C*l,e[1]=d*i+I*s+C*c,e[2]=d*a+I*u+C*g,e[3]=h*r+f*o+p*l,e[4]=h*i+f*s+p*c,e[5]=h*a+f*u+p*g,e[6]=A*r+m*o+v*l,e[7]=A*i+m*s+v*c,e[8]=A*a+m*u+v*g,e}function Se(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],g=t[8],d=n[0],I=n[1];return e[0]=r,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=d*r+I*o+l,e[7]=d*i+I*s+c,e[8]=d*a+I*u+g,e}function Re(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],g=t[8],d=Math.sin(n),I=Math.cos(n);return e[0]=I*r+d*o,e[1]=I*i+d*s,e[2]=I*a+d*u,e[3]=I*o-d*r,e[4]=I*s-d*i,e[5]=I*u-d*a,e[6]=l,e[7]=c,e[8]=g,e}function Me(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function We(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function ke(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ve(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Fe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function Ee(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n+n,s=r+r,u=i+i,l=n*o,c=r*o,g=r*s,d=i*o,I=i*s,C=i*u,h=a*o,f=a*s,p=a*u;return e[0]=1-g-C,e[3]=c-p,e[6]=d+f,e[1]=c+p,e[4]=1-l-C,e[7]=I-h,e[2]=d-f,e[5]=I+h,e[8]=1-l-g,e}function Xe(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],g=t[9],d=t[10],I=t[11],C=t[12],h=t[13],f=t[14],p=t[15],A=n*s-r*o,m=n*u-i*o,v=n*l-a*o,b=r*u-i*s,y=r*l-a*s,B=i*l-a*u,G=c*h-g*C,Z=c*f-d*C,w=c*p-I*C,_=g*f-d*h,x=g*p-I*h,S=d*p-I*f,R=A*S-m*x+v*_+b*w-y*Z+B*G;return R?(R=1/R,e[0]=(s*S-u*x+l*_)*R,e[1]=(u*w-o*S-l*Z)*R,e[2]=(o*x-s*w+l*G)*R,e[3]=(i*x-r*S-a*_)*R,e[4]=(n*S-i*w+a*Z)*R,e[5]=(r*w-n*x-a*G)*R,e[6]=(h*B-f*y+p*b)*R,e[7]=(f*v-C*B-p*m)*R,e[8]=(C*y-h*v+p*A)*R,e):null}function He(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Le(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function ze(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function Ne(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e}function Ye(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function Te(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e}function Ke(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e}function De(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function Pe(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],c=e[8],g=t[0],d=t[1],C=t[2],h=t[3],f=t[4],p=t[5],A=t[6],m=t[7],v=t[8];return Math.abs(n-g)<=I*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(r-d)<=I*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(i-C)<=I*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(a-h)<=I*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(o-f)<=I*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-p)<=I*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(u-A)<=I*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(l-m)<=I*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(c-v)<=I*Math.max(1,Math.abs(c),Math.abs(v))}var Ue=xe,Oe=Ye;function Je(){var e=new C(16);return C!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Qe(e){var t=new C(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function je(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function qe(e,t,n,r,i,a,o,s,u,l,c,g,d,I,h,f){var p=new C(16);return p[0]=e,p[1]=t,p[2]=n,p[3]=r,p[4]=i,p[5]=a,p[6]=o,p[7]=s,p[8]=u,p[9]=l,p[10]=c,p[11]=g,p[12]=d,p[13]=I,p[14]=h,p[15]=f,p}function $e(e,t,n,r,i,a,o,s,u,l,c,g,d,I,C,h,f){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e[9]=c,e[10]=g,e[11]=d,e[12]=I,e[13]=C,e[14]=h,e[15]=f,e}function et(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function tt(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function nt(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],g=t[9],d=t[10],I=t[11],C=t[12],h=t[13],f=t[14],p=t[15],A=n*s-r*o,m=n*u-i*o,v=n*l-a*o,b=r*u-i*s,y=r*l-a*s,B=i*l-a*u,G=c*h-g*C,Z=c*f-d*C,w=c*p-I*C,_=g*f-d*h,x=g*p-I*h,S=d*p-I*f,R=A*S-m*x+v*_+b*w-y*Z+B*G;return R?(R=1/R,e[0]=(s*S-u*x+l*_)*R,e[1]=(i*x-r*S-a*_)*R,e[2]=(h*B-f*y+p*b)*R,e[3]=(d*y-g*B-I*b)*R,e[4]=(u*w-o*S-l*Z)*R,e[5]=(n*S-i*w+a*Z)*R,e[6]=(f*v-C*B-p*m)*R,e[7]=(c*B-d*v+I*m)*R,e[8]=(o*x-s*w+l*G)*R,e[9]=(r*w-n*x-a*G)*R,e[10]=(C*y-h*v+p*A)*R,e[11]=(g*v-c*y-I*A)*R,e[12]=(s*Z-o*_-u*G)*R,e[13]=(n*_-r*Z+i*G)*R,e[14]=(h*m-C*b-f*A)*R,e[15]=(c*b-g*m+d*A)*R,e):null}function rt(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],g=t[9],d=t[10],I=t[11],C=t[12],h=t[13],f=t[14],p=t[15];return e[0]=s*(d*p-I*f)-g*(u*p-l*f)+h*(u*I-l*d),e[1]=-(r*(d*p-I*f)-g*(i*p-a*f)+h*(i*I-a*d)),e[2]=r*(u*p-l*f)-s*(i*p-a*f)+h*(i*l-a*u),e[3]=-(r*(u*I-l*d)-s*(i*I-a*d)+g*(i*l-a*u)),e[4]=-(o*(d*p-I*f)-c*(u*p-l*f)+C*(u*I-l*d)),e[5]=n*(d*p-I*f)-c*(i*p-a*f)+C*(i*I-a*d),e[6]=-(n*(u*p-l*f)-o*(i*p-a*f)+C*(i*l-a*u)),e[7]=n*(u*I-l*d)-o*(i*I-a*d)+c*(i*l-a*u),e[8]=o*(g*p-I*h)-c*(s*p-l*h)+C*(s*I-l*g),e[9]=-(n*(g*p-I*h)-c*(r*p-a*h)+C*(r*I-a*g)),e[10]=n*(s*p-l*h)-o*(r*p-a*h)+C*(r*l-a*s),e[11]=-(n*(s*I-l*g)-o*(r*I-a*g)+c*(r*l-a*s)),e[12]=-(o*(g*f-d*h)-c*(s*f-u*h)+C*(s*d-u*g)),e[13]=n*(g*f-d*h)-c*(r*f-i*h)+C*(r*d-i*g),e[14]=-(n*(s*f-u*h)-o*(r*f-i*h)+C*(r*u-i*s)),e[15]=n*(s*d-u*g)-o*(r*d-i*g)+c*(r*u-i*s),e}function it(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],g=e[10],d=e[11],I=e[12],C=e[13],h=e[14],f=e[15];return(t*o-n*a)*(g*f-d*h)-(t*s-r*a)*(c*f-d*C)+(t*u-i*a)*(c*h-g*C)+(n*s-r*o)*(l*f-d*I)-(n*u-i*o)*(l*h-g*I)+(r*u-i*s)*(l*C-c*I)}function at(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],g=t[8],d=t[9],I=t[10],C=t[11],h=t[12],f=t[13],p=t[14],A=t[15],m=n[0],v=n[1],b=n[2],y=n[3];return e[0]=m*r+v*s+b*g+y*h,e[1]=m*i+v*u+b*d+y*f,e[2]=m*a+v*l+b*I+y*p,e[3]=m*o+v*c+b*C+y*A,m=n[4],v=n[5],b=n[6],y=n[7],e[4]=m*r+v*s+b*g+y*h,e[5]=m*i+v*u+b*d+y*f,e[6]=m*a+v*l+b*I+y*p,e[7]=m*o+v*c+b*C+y*A,m=n[8],v=n[9],b=n[10],y=n[11],e[8]=m*r+v*s+b*g+y*h,e[9]=m*i+v*u+b*d+y*f,e[10]=m*a+v*l+b*I+y*p,e[11]=m*o+v*c+b*C+y*A,m=n[12],v=n[13],b=n[14],y=n[15],e[12]=m*r+v*s+b*g+y*h,e[13]=m*i+v*u+b*d+y*f,e[14]=m*a+v*l+b*I+y*p,e[15]=m*o+v*c+b*C+y*A,e}function ot(e,t,n){var r,i,a,o,s,u,l,c,g,d,I,C,h=n[0],f=n[1],p=n[2];return t===e?(e[12]=t[0]*h+t[4]*f+t[8]*p+t[12],e[13]=t[1]*h+t[5]*f+t[9]*p+t[13],e[14]=t[2]*h+t[6]*f+t[10]*p+t[14],e[15]=t[3]*h+t[7]*f+t[11]*p+t[15]):(r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],g=t[8],d=t[9],I=t[10],C=t[11],e[0]=r,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=l,e[7]=c,e[8]=g,e[9]=d,e[10]=I,e[11]=C,e[12]=r*h+s*f+g*p+t[12],e[13]=i*h+u*f+d*p+t[13],e[14]=a*h+l*f+I*p+t[14],e[15]=o*h+c*f+C*p+t[15]),e}function st(e,t,n){var r=n[0],i=n[1],a=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ut(e,t,n,r){var i,a,o,s,u,l,c,g,d,C,h,f,p,A,m,v,b,y,B,G,Z,w,_,x,S=r[0],R=r[1],M=r[2],W=Math.hypot(S,R,M);return W<I?null:(S*=W=1/W,R*=W,M*=W,i=Math.sin(n),o=1-(a=Math.cos(n)),s=t[0],u=t[1],l=t[2],c=t[3],g=t[4],d=t[5],C=t[6],h=t[7],f=t[8],p=t[9],A=t[10],m=t[11],v=S*S*o+a,b=R*S*o+M*i,y=M*S*o-R*i,B=S*R*o-M*i,G=R*R*o+a,Z=M*R*o+S*i,w=S*M*o+R*i,_=R*M*o-S*i,x=M*M*o+a,e[0]=s*v+g*b+f*y,e[1]=u*v+d*b+p*y,e[2]=l*v+C*b+A*y,e[3]=c*v+h*b+m*y,e[4]=s*B+g*G+f*Z,e[5]=u*B+d*G+p*Z,e[6]=l*B+C*G+A*Z,e[7]=c*B+h*G+m*Z,e[8]=s*w+g*_+f*x,e[9]=u*w+d*_+p*x,e[10]=l*w+C*_+A*x,e[11]=c*w+h*_+m*x,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function lt(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[4],o=t[5],s=t[6],u=t[7],l=t[8],c=t[9],g=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+l*r,e[5]=o*i+c*r,e[6]=s*i+g*r,e[7]=u*i+d*r,e[8]=l*i-a*r,e[9]=c*i-o*r,e[10]=g*i-s*r,e[11]=d*i-u*r,e}function ct(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],s=t[2],u=t[3],l=t[8],c=t[9],g=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-l*r,e[1]=o*i-c*r,e[2]=s*i-g*r,e[3]=u*i-d*r,e[8]=a*r+l*i,e[9]=o*r+c*i,e[10]=s*r+g*i,e[11]=u*r+d*i,e}function gt(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],s=t[2],u=t[3],l=t[4],c=t[5],g=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+l*r,e[1]=o*i+c*r,e[2]=s*i+g*r,e[3]=u*i+d*r,e[4]=l*i-a*r,e[5]=c*i-o*r,e[6]=g*i-s*r,e[7]=d*i-u*r,e}function dt(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function It(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ct(e,t,n){var r,i,a,o=n[0],s=n[1],u=n[2],l=Math.hypot(o,s,u);return l<I?null:(o*=l=1/l,s*=l,u*=l,r=Math.sin(t),a=1-(i=Math.cos(t)),e[0]=o*o*a+i,e[1]=s*o*a+u*r,e[2]=u*o*a-s*r,e[3]=0,e[4]=o*s*a-u*r,e[5]=s*s*a+i,e[6]=u*s*a+o*r,e[7]=0,e[8]=o*u*a+s*r,e[9]=s*u*a-o*r,e[10]=u*u*a+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function ht(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ft(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pt(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function At(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=r+r,u=i+i,l=a+a,c=r*s,g=r*u,d=r*l,I=i*u,C=i*l,h=a*l,f=o*s,p=o*u,A=o*l;return e[0]=1-(I+h),e[1]=g+A,e[2]=d-p,e[3]=0,e[4]=g-A,e[5]=1-(c+h),e[6]=C+f,e[7]=0,e[8]=d+p,e[9]=C-f,e[10]=1-(c+I),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function mt(e,t){var n=new C(3),r=-t[0],i=-t[1],a=-t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],g=r*r+i*i+a*a+o*o;return g>0?(n[0]=2*(s*o+c*r+u*a-l*i)/g,n[1]=2*(u*o+c*i+l*r-s*a)/g,n[2]=2*(l*o+c*a+s*i-u*r)/g):(n[0]=2*(s*o+c*r+u*a-l*i),n[1]=2*(u*o+c*i+l*r-s*a),n[2]=2*(l*o+c*a+s*i-u*r)),At(e,t,n),e}function vt(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function bt(e,t){var n=t[0],r=t[1],i=t[2],a=t[4],o=t[5],s=t[6],u=t[8],l=t[9],c=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(a,o,s),e[2]=Math.hypot(u,l,c),e}function yt(e,t){var n=new C(3);bt(n,t);var r=1/n[0],i=1/n[1],a=1/n[2],o=t[0]*r,s=t[1]*i,u=t[2]*a,l=t[4]*r,c=t[5]*i,g=t[6]*a,d=t[8]*r,I=t[9]*i,h=t[10]*a,f=o+c+h,p=0;return f>0?(p=2*Math.sqrt(f+1),e[3]=.25*p,e[0]=(g-I)/p,e[1]=(d-u)/p,e[2]=(s-l)/p):o>c&&o>h?(p=2*Math.sqrt(1+o-c-h),e[3]=(g-I)/p,e[0]=.25*p,e[1]=(s+l)/p,e[2]=(d+u)/p):c>h?(p=2*Math.sqrt(1+c-o-h),e[3]=(d-u)/p,e[0]=(s+l)/p,e[1]=.25*p,e[2]=(g+I)/p):(p=2*Math.sqrt(1+h-o-c),e[3]=(s-l)/p,e[0]=(d+u)/p,e[1]=(g+I)/p,e[2]=.25*p),e}function Bt(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=t[3],u=i+i,l=a+a,c=o+o,g=i*u,d=i*l,I=i*c,C=a*l,h=a*c,f=o*c,p=s*u,A=s*l,m=s*c,v=r[0],b=r[1],y=r[2];return e[0]=(1-(C+f))*v,e[1]=(d+m)*v,e[2]=(I-A)*v,e[3]=0,e[4]=(d-m)*b,e[5]=(1-(g+f))*b,e[6]=(h+p)*b,e[7]=0,e[8]=(I+A)*y,e[9]=(h-p)*y,e[10]=(1-(g+C))*y,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function Gt(e,t,n,r,i){var a=t[0],o=t[1],s=t[2],u=t[3],l=a+a,c=o+o,g=s+s,d=a*l,I=a*c,C=a*g,h=o*c,f=o*g,p=s*g,A=u*l,m=u*c,v=u*g,b=r[0],y=r[1],B=r[2],G=i[0],Z=i[1],w=i[2],_=(1-(h+p))*b,x=(I+v)*b,S=(C-m)*b,R=(I-v)*y,M=(1-(d+p))*y,W=(f+A)*y,k=(C+m)*B,V=(f-A)*B,F=(1-(d+h))*B;return e[0]=_,e[1]=x,e[2]=S,e[3]=0,e[4]=R,e[5]=M,e[6]=W,e[7]=0,e[8]=k,e[9]=V,e[10]=F,e[11]=0,e[12]=n[0]+G-(_*G+R*Z+k*w),e[13]=n[1]+Z-(x*G+M*Z+V*w),e[14]=n[2]+w-(S*G+W*Z+F*w),e[15]=1,e}function Zt(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n+n,s=r+r,u=i+i,l=n*o,c=r*o,g=r*s,d=i*o,I=i*s,C=i*u,h=a*o,f=a*s,p=a*u;return e[0]=1-g-C,e[1]=c+p,e[2]=d-f,e[3]=0,e[4]=c-p,e[5]=1-l-C,e[6]=I+h,e[7]=0,e[8]=d+f,e[9]=I-h,e[10]=1-l-g,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function wt(e,t,n,r,i,a,o){var s=1/(n-t),u=1/(i-r),l=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e}function _t(e,t,n,r,i){var a,o=1/Math.tan(t/2);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(r-i),e[10]=(i+r)*a,e[14]=2*i*r*a):(e[10]=-1,e[14]=-2*r),e}function xt(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+s),l=2/(i+a);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(o-s)*u*.5,e[9]=(i-a)*l*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function St(e,t,n,r,i,a,o){var s=1/(t-n),u=1/(r-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(o+a)*l,e[15]=1,e}function Rt(e,t,n,r){var i,a,o,s,u,l,c,g,d,C,h=t[0],f=t[1],p=t[2],A=r[0],m=r[1],v=r[2],b=n[0],y=n[1],B=n[2];return Math.abs(h-b)<I&&Math.abs(f-y)<I&&Math.abs(p-B)<I?et(e):(c=h-b,g=f-y,d=p-B,i=m*(d*=C=1/Math.hypot(c,g,d))-v*(g*=C),a=v*(c*=C)-A*d,o=A*g-m*c,(C=Math.hypot(i,a,o))?(i*=C=1/C,a*=C,o*=C):(i=0,a=0,o=0),s=g*o-d*a,u=d*i-c*o,l=c*a-g*i,(C=Math.hypot(s,u,l))?(s*=C=1/C,u*=C,l*=C):(s=0,u=0,l=0),e[0]=i,e[1]=s,e[2]=c,e[3]=0,e[4]=a,e[5]=u,e[6]=g,e[7]=0,e[8]=o,e[9]=l,e[10]=d,e[11]=0,e[12]=-(i*h+a*f+o*p),e[13]=-(s*h+u*f+l*p),e[14]=-(c*h+g*f+d*p),e[15]=1,e)}function Mt(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=r[0],u=r[1],l=r[2],c=i-n[0],g=a-n[1],d=o-n[2],I=c*c+g*g+d*d;I>0&&(c*=I=1/Math.sqrt(I),g*=I,d*=I);var C=u*d-l*g,h=l*c-s*d,f=s*g-u*c;return(I=C*C+h*h+f*f)>0&&(C*=I=1/Math.sqrt(I),h*=I,f*=I),e[0]=C,e[1]=h,e[2]=f,e[3]=0,e[4]=g*f-d*h,e[5]=d*C-c*f,e[6]=c*h-g*C,e[7]=0,e[8]=c,e[9]=g,e[10]=d,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e}function Wt(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function kt(e){return Math.hypot(e[0],e[1],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Vt(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function Ft(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function Et(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function Xt(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function Ht(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Lt(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],c=e[8],g=e[9],d=e[10],C=e[11],h=e[12],f=e[13],p=e[14],A=e[15],m=t[0],v=t[1],b=t[2],y=t[3],B=t[4],G=t[5],Z=t[6],w=t[7],_=t[8],x=t[9],S=t[10],R=t[11],M=t[12],W=t[13],k=t[14],V=t[15];return Math.abs(n-m)<=I*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(r-v)<=I*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(i-b)<=I*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(a-y)<=I*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(o-B)<=I*Math.max(1,Math.abs(o),Math.abs(B))&&Math.abs(s-G)<=I*Math.max(1,Math.abs(s),Math.abs(G))&&Math.abs(u-Z)<=I*Math.max(1,Math.abs(u),Math.abs(Z))&&Math.abs(l-w)<=I*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(c-_)<=I*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(g-x)<=I*Math.max(1,Math.abs(g),Math.abs(x))&&Math.abs(d-S)<=I*Math.max(1,Math.abs(d),Math.abs(S))&&Math.abs(C-R)<=I*Math.max(1,Math.abs(C),Math.abs(R))&&Math.abs(h-M)<=I*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(f-W)<=I*Math.max(1,Math.abs(f),Math.abs(W))&&Math.abs(p-k)<=I*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(A-V)<=I*Math.max(1,Math.abs(A),Math.abs(V))}var zt=at,Nt=Ft;function Yt(){var e=new C(3);return C!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Tt(e){var t=new C(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Kt(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function Dt(e,t,n){var r=new C(3);return r[0]=e,r[1]=t,r[2]=n,r}function Pt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ut(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function Ot(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Jt(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function Qt(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function jt(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function qt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function $t(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function en(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function tn(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function nn(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function rn(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function an(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function on(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.hypot(n,r,i)}function sn(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function un(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function ln(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function cn(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function gn(e,t){var n=t[0],r=t[1],i=t[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function dn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function In(e,t,n){var r=t[0],i=t[1],a=t[2],o=n[0],s=n[1],u=n[2];return e[0]=i*u-a*s,e[1]=a*o-r*u,e[2]=r*s-i*o,e}function Cn(e,t,n,r){var i=t[0],a=t[1],o=t[2];return e[0]=i+r*(n[0]-i),e[1]=a+r*(n[1]-a),e[2]=o+r*(n[2]-o),e}function hn(e,t,n,r,i,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,l=o*(a-1),c=o*(3-2*a);return e[0]=t[0]*s+n[0]*u+r[0]*l+i[0]*c,e[1]=t[1]*s+n[1]*u+r[1]*l+i[1]*c,e[2]=t[2]*s+n[2]*u+r[2]*l+i[2]*c,e}function fn(e,t,n,r,i,a){var o=1-a,s=o*o,u=a*a,l=s*o,c=3*a*s,g=3*u*o,d=u*a;return e[0]=t[0]*l+n[0]*c+r[0]*g+i[0]*d,e[1]=t[1]*l+n[1]*c+r[1]*g+i[1]*d,e[2]=t[2]*l+n[2]*c+r[2]*g+i[2]*d,e}function pn(e,t){t=t||1;var n=2*h()*Math.PI,r=2*h()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}function An(e,t,n){var r=t[0],i=t[1],a=t[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,e[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,e[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,e[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,e}function mn(e,t,n){var r=t[0],i=t[1],a=t[2];return e[0]=r*n[0]+i*n[3]+a*n[6],e[1]=r*n[1]+i*n[4]+a*n[7],e[2]=r*n[2]+i*n[5]+a*n[8],e}function vn(e,t,n){var r=n[0],i=n[1],a=n[2],o=n[3],s=t[0],u=t[1],l=t[2],c=i*l-a*u,g=a*s-r*l,d=r*u-i*s,I=i*d-a*g,C=a*c-r*d,h=r*g-i*c,f=2*o;return c*=f,g*=f,d*=f,I*=2,C*=2,h*=2,e[0]=s+c+I,e[1]=u+g+C,e[2]=l+d+h,e}function bn(e,t,n,r){var i=[],a=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e}function yn(e,t,n,r){var i=[],a=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e}function Bn(e,t,n,r){var i=[],a=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e}function Gn(e,t){var n=Dt(e[0],e[1],e[2]),r=Dt(t[0],t[1],t[2]);gn(n,n),gn(r,r);var i=dn(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)}function Zn(e){return e[0]=0,e[1]=0,e[2]=0,e}function wn(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function _n(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function xn(e,t){var n=e[0],r=e[1],i=e[2],a=t[0],o=t[1],s=t[2];return Math.abs(n-a)<=I*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=I*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=I*Math.max(1,Math.abs(i),Math.abs(s))}var Sn=Jt,Rn=Qt,Mn=jt,Wn=on,kn=sn,Vn=Kt,Fn=un,En=function(){var e=Yt();return function(t,n,r,i,a,o){var s,u;for(n||(n=3),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}();function Xn(){var e=new C(4);return C!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Hn(e){var t=new C(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Ln(e,t,n,r){var i=new C(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function zn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Nn(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}function Yn(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function Tn(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function Kn(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function Dn(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function Pn(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Un(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function On(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e}function Jn(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e}function Qn(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function jn(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function qn(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}function $n(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.hypot(n,r,i,a)}function er(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return n*n+r*r+i*i+a*a}function tr(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.hypot(t,n,r,i)}function nr(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}function rr(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function ir(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function ar(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),e[0]=n*o,e[1]=r*o,e[2]=i*o,e[3]=a*o,e}function or(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function sr(e,t,n,r){var i=n[0]*r[1]-n[1]*r[0],a=n[0]*r[2]-n[2]*r[0],o=n[0]*r[3]-n[3]*r[0],s=n[1]*r[2]-n[2]*r[1],u=n[1]*r[3]-n[3]*r[1],l=n[2]*r[3]-n[3]*r[2],c=t[0],g=t[1],d=t[2],I=t[3];return e[0]=g*l-d*u+I*s,e[1]=-c*l+d*o-I*a,e[2]=c*u-g*o+I*i,e[3]=-c*s+g*a-d*i,e}function ur(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i+r*(n[0]-i),e[1]=a+r*(n[1]-a),e[2]=o+r*(n[2]-o),e[3]=s+r*(n[3]-s),e}function lr(e,t){var n,r,i,a,o,s;t=t||1;do{o=(n=2*h()-1)*n+(r=2*h()-1)*r}while(o>=1);do{s=(i=2*h()-1)*i+(a=2*h()-1)*a}while(s>=1);var u=Math.sqrt((1-o)/s);return e[0]=t*n,e[1]=t*r,e[2]=t*i*u,e[3]=t*a*u,e}function cr(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,e[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,e[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,e[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,e}function gr(e,t,n){var r=t[0],i=t[1],a=t[2],o=n[0],s=n[1],u=n[2],l=n[3],c=l*r+s*a-u*i,g=l*i+u*r-o*a,d=l*a+o*i-s*r,I=-o*r-s*i-u*a;return e[0]=c*l+I*-o+g*-u-d*-s,e[1]=g*l+I*-s+d*-o-c*-u,e[2]=d*l+I*-u+c*-s-g*-o,e[3]=t[3],e}function dr(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Ir(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Cr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function hr(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=t[0],s=t[1],u=t[2],l=t[3];return Math.abs(n-o)<=I*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=I*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=I*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-l)<=I*Math.max(1,Math.abs(a),Math.abs(l))}var fr=Tn,pr=Kn,Ar=Dn,mr=$n,vr=er,br=tr,yr=nr,Br=function(){var e=Xn();return function(t,n,r,i,a,o){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}();function Gr(){var e=new C(4);return C!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Zr(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function wr(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function _r(e,t){var n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>I?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function xr(e,t){var n=jr(e,t);return Math.acos(2*n*n-1)}function Sr(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=n[0],u=n[1],l=n[2],c=n[3];return e[0]=r*c+o*s+i*l-a*u,e[1]=i*c+o*u+a*s-r*l,e[2]=a*c+o*l+r*u-i*s,e[3]=o*c-r*s-i*u-a*l,e}function Rr(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+o*s,e[1]=i*u+a*s,e[2]=a*u-i*s,e[3]=o*u-r*s,e}function Mr(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u-a*s,e[1]=i*u+o*s,e[2]=a*u+r*s,e[3]=o*u-i*s,e}function Wr(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+i*s,e[1]=i*u-r*s,e[2]=a*u+o*s,e[3]=o*u-a*s,e}function kr(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e}function Vr(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=Math.sqrt(n*n+r*r+i*i),s=Math.exp(a),u=o>0?s*Math.sin(o)/o:0;return e[0]=n*u,e[1]=r*u,e[2]=i*u,e[3]=s*Math.cos(o),e}function Fr(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=Math.sqrt(n*n+r*r+i*i),s=o>0?Math.atan2(o,a)/o:0;return e[0]=n*s,e[1]=r*s,e[2]=i*s,e[3]=.5*Math.log(n*n+r*r+i*i+a*a),e}function Er(e,t,n){return Fr(e,t),Qr(e,e,n),Vr(e,e),e}function Xr(e,t,n,r){var i,a,o,s,u,l=t[0],c=t[1],g=t[2],d=t[3],C=n[0],h=n[1],f=n[2],p=n[3];return(a=l*C+c*h+g*f+d*p)<0&&(a=-a,C=-C,h=-h,f=-f,p=-p),1-a>I?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-r)*i)/o,u=Math.sin(r*i)/o):(s=1-r,u=r),e[0]=s*l+u*C,e[1]=s*c+u*h,e[2]=s*g+u*f,e[3]=s*d+u*p,e}function Hr(e){var t=h(),n=h(),r=h(),i=Math.sqrt(1-t),a=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*n),e[1]=i*Math.cos(2*Math.PI*n),e[2]=a*Math.sin(2*Math.PI*r),e[3]=a*Math.cos(2*Math.PI*r),e}function Lr(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n*n+r*r+i*i+a*a,s=o?1/o:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=a*s,e}function zr(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Nr(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[a]=(t[3*a+i]+t[3*i+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}function Yr(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var a=Math.sin(t),o=Math.cos(t),s=Math.sin(n),u=Math.cos(n),l=Math.sin(r),c=Math.cos(r);return e[0]=a*u*c-o*s*l,e[1]=o*s*c+a*u*l,e[2]=o*u*l-a*s*c,e[3]=o*u*c+a*s*l,e}function Tr(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Kr=Hn,Dr=Ln,Pr=zn,Ur=Nn,Or=Yn,Jr=Sr,Qr=jn,jr=or,qr=ur,$r=tr,ei=$r,ti=nr,ni=ti,ri=ar,ii=Cr,ai=hr,oi=function(){var e=Yt(),t=Dt(1,0,0),n=Dt(0,1,0);return function(r,i,a){var o=dn(i,a);return o<-.999999?(In(e,t,i),Vn(e)<1e-6&&In(e,n,i),gn(e,e),wr(r,e,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(In(e,i,a),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+o,ri(r,r))}}(),si=function(){var e=Gr(),t=Gr();return function(n,r,i,a,o,s){return Xr(e,r,o,s),Xr(t,i,a,s),Xr(n,e,t,2*s*(1-s)),n}}(),ui=function(){var e=pe();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],ri(t,Nr(t,e))}}();function li(){var e=new C(8);return C!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function ci(e){var t=new C(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function gi(e,t,n,r,i,a,o,s){var u=new C(8);return u[0]=e,u[1]=t,u[2]=n,u[3]=r,u[4]=i,u[5]=a,u[6]=o,u[7]=s,u}function di(e,t,n,r,i,a,o){var s=new C(8);s[0]=e,s[1]=t,s[2]=n,s[3]=r;var u=.5*i,l=.5*a,c=.5*o;return s[4]=u*r+l*n-c*t,s[5]=l*r+c*e-u*n,s[6]=c*r+u*t-l*e,s[7]=-u*e-l*t-c*n,s}function Ii(e,t,n){var r=.5*n[0],i=.5*n[1],a=.5*n[2],o=t[0],s=t[1],u=t[2],l=t[3];return e[0]=o,e[1]=s,e[2]=u,e[3]=l,e[4]=r*l+i*u-a*s,e[5]=i*l+a*o-r*u,e[6]=a*l+r*s-i*o,e[7]=-r*o-i*s-a*u,e}function Ci(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e}function hi(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function fi(e,t){var n=Gr();yt(n,t);var r=new C(3);return vt(r,t),Ii(e,n,r),e}function pi(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function Ai(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function mi(e,t,n,r,i,a,o,s,u){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e}var vi=Pr;function bi(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e}var yi=Pr;function Bi(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e}function Gi(e,t){var n=t[4],r=t[5],i=t[6],a=t[7],o=-t[0],s=-t[1],u=-t[2],l=t[3];return e[0]=2*(n*l+a*o+r*u-i*s),e[1]=2*(r*l+a*s+i*o-n*u),e[2]=2*(i*l+a*u+n*s-r*o),e}function Zi(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=.5*n[0],u=.5*n[1],l=.5*n[2],c=t[4],g=t[5],d=t[6],I=t[7];return e[0]=r,e[1]=i,e[2]=a,e[3]=o,e[4]=o*s+i*l-a*u+c,e[5]=o*u+a*s-r*l+g,e[6]=o*l+r*u-i*s+d,e[7]=-r*s-i*u-a*l+I,e}function wi(e,t,n){var r=-t[0],i=-t[1],a=-t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],g=s*o+c*r+u*a-l*i,d=u*o+c*i+l*r-s*a,I=l*o+c*a+s*i-u*r,C=c*o-s*r-u*i-l*a;return Rr(e,t,n),r=e[0],i=e[1],a=e[2],o=e[3],e[4]=g*o+C*r+d*a-I*i,e[5]=d*o+C*i+I*r-g*a,e[6]=I*o+C*a+g*i-d*r,e[7]=C*o-g*r-d*i-I*a,e}function _i(e,t,n){var r=-t[0],i=-t[1],a=-t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],g=s*o+c*r+u*a-l*i,d=u*o+c*i+l*r-s*a,I=l*o+c*a+s*i-u*r,C=c*o-s*r-u*i-l*a;return Mr(e,t,n),r=e[0],i=e[1],a=e[2],o=e[3],e[4]=g*o+C*r+d*a-I*i,e[5]=d*o+C*i+I*r-g*a,e[6]=I*o+C*a+g*i-d*r,e[7]=C*o-g*r-d*i-I*a,e}function xi(e,t,n){var r=-t[0],i=-t[1],a=-t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],g=s*o+c*r+u*a-l*i,d=u*o+c*i+l*r-s*a,I=l*o+c*a+s*i-u*r,C=c*o-s*r-u*i-l*a;return Wr(e,t,n),r=e[0],i=e[1],a=e[2],o=e[3],e[4]=g*o+C*r+d*a-I*i,e[5]=d*o+C*i+I*r-g*a,e[6]=I*o+C*a+g*i-d*r,e[7]=C*o-g*r-d*i-I*a,e}function Si(e,t,n){var r=n[0],i=n[1],a=n[2],o=n[3],s=t[0],u=t[1],l=t[2],c=t[3];return e[0]=s*o+c*r+u*a-l*i,e[1]=u*o+c*i+l*r-s*a,e[2]=l*o+c*a+s*i-u*r,e[3]=c*o-s*r-u*i-l*a,s=t[4],u=t[5],l=t[6],c=t[7],e[4]=s*o+c*r+u*a-l*i,e[5]=u*o+c*i+l*r-s*a,e[6]=l*o+c*a+s*i-u*r,e[7]=c*o-s*r-u*i-l*a,e}function Ri(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=n[0],u=n[1],l=n[2],c=n[3];return e[0]=r*c+o*s+i*l-a*u,e[1]=i*c+o*u+a*s-r*l,e[2]=a*c+o*l+r*u-i*s,e[3]=o*c-r*s-i*u-a*l,s=n[4],u=n[5],l=n[6],c=n[7],e[4]=r*c+o*s+i*l-a*u,e[5]=i*c+o*u+a*s-r*l,e[6]=a*c+o*l+r*u-i*s,e[7]=o*c-r*s-i*u-a*l,e}function Mi(e,t,n,r){if(Math.abs(r)<I)return pi(e,t);var i=Math.hypot(n[0],n[1],n[2]);r*=.5;var a=Math.sin(r),o=a*n[0]/i,s=a*n[1]/i,u=a*n[2]/i,l=Math.cos(r),c=t[0],g=t[1],d=t[2],C=t[3];e[0]=c*l+C*o+g*u-d*s,e[1]=g*l+C*s+d*o-c*u,e[2]=d*l+C*u+c*s-g*o,e[3]=C*l-c*o-g*s-d*u;var h=t[4],f=t[5],p=t[6],A=t[7];return e[4]=h*l+A*o+f*u-p*s,e[5]=f*l+A*s+p*o-h*u,e[6]=p*l+A*u+h*s-f*o,e[7]=A*l-h*o-f*s-p*u,e}function Wi(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e}function ki(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=n[4],u=n[5],l=n[6],c=n[7],g=t[4],d=t[5],I=t[6],C=t[7],h=n[0],f=n[1],p=n[2],A=n[3];return e[0]=r*A+o*h+i*p-a*f,e[1]=i*A+o*f+a*h-r*p,e[2]=a*A+o*p+r*f-i*h,e[3]=o*A-r*h-i*f-a*p,e[4]=r*c+o*s+i*l-a*u+g*A+C*h+d*p-I*f,e[5]=i*c+o*u+a*s-r*l+d*A+C*f+I*h-g*p,e[6]=a*c+o*l+r*u-i*s+I*A+C*p+g*f-d*h,e[7]=o*c-r*s-i*u-a*l+C*A-g*h-d*f-I*p,e}var Vi=ki;function Fi(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e}var Ei=jr;function Xi(e,t,n,r){var i=1-r;return Ei(t,n)<0&&(r=-r),e[0]=t[0]*i+n[0]*r,e[1]=t[1]*i+n[1]*r,e[2]=t[2]*i+n[2]*r,e[3]=t[3]*i+n[3]*r,e[4]=t[4]*i+n[4]*r,e[5]=t[5]*i+n[5]*r,e[6]=t[6]*i+n[6]*r,e[7]=t[7]*i+n[7]*r,e}function Hi(e,t){var n=Yi(t);return e[0]=-t[0]/n,e[1]=-t[1]/n,e[2]=-t[2]/n,e[3]=t[3]/n,e[4]=-t[4]/n,e[5]=-t[5]/n,e[6]=-t[6]/n,e[7]=t[7]/n,e}function Li(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e}var zi=$r,Ni=zi,Yi=ti,Ti=Yi;function Ki(e,t){var n=Yi(t);if(n>0){n=Math.sqrt(n);var r=t[0]/n,i=t[1]/n,a=t[2]/n,o=t[3]/n,s=t[4],u=t[5],l=t[6],c=t[7],g=r*s+i*u+a*l+o*c;e[0]=r,e[1]=i,e[2]=a,e[3]=o,e[4]=(s-r*g)/n,e[5]=(u-i*g)/n,e[6]=(l-a*g)/n,e[7]=(c-o*g)/n}return e}function Di(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function Pi(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]}function Ui(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],c=t[0],g=t[1],d=t[2],C=t[3],h=t[4],f=t[5],p=t[6],A=t[7];return Math.abs(n-c)<=I*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-g)<=I*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(i-d)<=I*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-C)<=I*Math.max(1,Math.abs(a),Math.abs(C))&&Math.abs(o-h)<=I*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-f)<=I*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(u-p)<=I*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(l-A)<=I*Math.max(1,Math.abs(l),Math.abs(A))}function Oi(){var e=new C(2);return C!=Float32Array&&(e[0]=0,e[1]=0),e}function Ji(e){var t=new C(2);return t[0]=e[0],t[1]=e[1],t}function Qi(e,t){var n=new C(2);return n[0]=e,n[1]=t,n}function ji(e,t){return e[0]=t[0],e[1]=t[1],e}function qi(e,t,n){return e[0]=t,e[1]=n,e}function $i(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function ea(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function ta(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function na(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function ra(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function ia(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function aa(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function oa(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}function sa(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function ua(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function la(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}function ca(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.hypot(n,r)}function ga(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function da(e){var t=e[0],n=e[1];return Math.hypot(t,n)}function Ia(e){var t=e[0],n=e[1];return t*t+n*n}function Ca(e,t){return e[0]=-t[0],e[1]=-t[1],e}function ha(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function fa(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function pa(e,t){return e[0]*t[0]+e[1]*t[1]}function Aa(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e}function ma(e,t,n,r){var i=t[0],a=t[1];return e[0]=i+r*(n[0]-i),e[1]=a+r*(n[1]-a),e}function va(e,t){t=t||1;var n=2*h()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e}function ba(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e}function ya(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e}function Ba(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e}function Ga(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}function Za(e,t,n,r){var i=t[0]-n[0],a=t[1]-n[1],o=Math.sin(r),s=Math.cos(r);return e[0]=i*s-a*o+n[0],e[1]=i*o+a*s+n[1],e}function wa(e,t){var n=e[0],r=e[1],i=t[0],a=t[1],o=n*n+r*r;o>0&&(o=1/Math.sqrt(o));var s=i*i+a*a;s>0&&(s=1/Math.sqrt(s));var u=(n*i+r*a)*o*s;return u>1?0:u<-1?Math.PI:Math.acos(u)}function _a(e){return e[0]=0,e[1]=0,e}function xa(e){return"vec2("+e[0]+", "+e[1]+")"}function Sa(e,t){return e[0]===t[0]&&e[1]===t[1]}function Ra(e,t){var n=e[0],r=e[1],i=t[0],a=t[1];return Math.abs(n-i)<=I*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-a)<=I*Math.max(1,Math.abs(r),Math.abs(a))}var Ma=da,Wa=ea,ka=ta,Va=na,Fa=ca,Ea=ga,Xa=Ia,Ha=function(){var e=Oi();return function(t,n,r,i,a,o){var s,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],a(e,e,o),t[s]=e[0],t[s+1]=e[1];return t}}()},537:function(e,t,n){var r="__lodash_hash_undefined__",i=9007199254740991,a="[object Symbol]",o=/^\[object .+?Constructor\]$/,s=/^(?:0|[1-9]\d*)$/,u="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,c=u||l||Function("return this")();function g(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function d(e,t){return!!(e?e.length:0)&&function(e,t,n){if(t!==t)return function(e,t,n,r){var i=e.length,a=n+(r?1:-1);for(;r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}(e,f,n);var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,0)>-1}function I(e,t,n){for(var r=-1,i=e?e.length:0;++r<i;)if(n(t,e[r]))return!0;return!1}function C(e,t){for(var n=-1,r=e?e.length:0,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function h(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function f(e){return e!==e}function p(e,t){return e.has(t)}function A(e,t){return function(n){return e(t(n))}}var m=Array.prototype,v=Function.prototype,b=Object.prototype,y=c["__core-js_shared__"],B=function(){var e=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),G=v.toString,Z=b.hasOwnProperty,w=b.toString,_=RegExp("^"+G.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),x=c.Symbol,S=A(Object.getPrototypeOf,Object),R=b.propertyIsEnumerable,M=m.splice,W=x?x.isConcatSpreadable:void 0,k=Object.getOwnPropertySymbols,V=Math.max,F=O(c,"Map"),E=O(Object,"create");function X(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function H(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function L(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function z(e){var t=-1,n=e?e.length:0;for(this.__data__=new L;++t<n;)this.add(e[t])}function N(e,t){var n=te(e)||ee(e)?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],r=n.length,i=!!r;for(var a in e)!t&&!Z.call(e,a)||i&&("length"==a||q(a,r))||n.push(a);return n}function Y(e,t){for(var n,r,i=e.length;i--;)if((n=e[i][0])===(r=t)||n!==n&&r!==r)return i;return-1}function T(e,t,n,r,i){var a=-1,o=e.length;for(n||(n=j),i||(i=[]);++a<o;){var s=e[a];t>0&&n(s)?t>1?T(s,t-1,n,r,i):h(i,s):r||(i[i.length]=s)}return i}function K(e){if(!ie(e)||(t=e,B&&B in t))return!1;var t,n=re(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}(e)?_:o;return n.test(function(e){if(null!=e){try{return G.call(e)}catch(t){}try{return e+""}catch(t){}}return""}(e))}function D(e){if(!ie(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=function(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||b;return e===n}(e),n=[];for(var r in e)("constructor"!=r||!t&&Z.call(e,r))&&n.push(r);return n}function P(e){return function(e,t,n){var r=t(e);return te(e)?r:h(r,n(e))}(e,oe,Q)}function U(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function O(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return K(n)?n:void 0}X.prototype.clear=function(){this.__data__=E?E(null):{}},X.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},X.prototype.get=function(e){var t=this.__data__;if(E){var n=t[e];return n===r?void 0:n}return Z.call(t,e)?t[e]:void 0},X.prototype.has=function(e){var t=this.__data__;return E?void 0!==t[e]:Z.call(t,e)},X.prototype.set=function(e,t){return this.__data__[e]=E&&void 0===t?r:t,this},H.prototype.clear=function(){this.__data__=[]},H.prototype.delete=function(e){var t=this.__data__,n=Y(t,e);return!(n<0)&&(n==t.length-1?t.pop():M.call(t,n,1),!0)},H.prototype.get=function(e){var t=this.__data__,n=Y(t,e);return n<0?void 0:t[n][1]},H.prototype.has=function(e){return Y(this.__data__,e)>-1},H.prototype.set=function(e,t){var n=this.__data__,r=Y(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},L.prototype.clear=function(){this.__data__={hash:new X,map:new(F||H),string:new X}},L.prototype.delete=function(e){return U(this,e).delete(e)},L.prototype.get=function(e){return U(this,e).get(e)},L.prototype.has=function(e){return U(this,e).has(e)},L.prototype.set=function(e,t){return U(this,e).set(e,t),this},z.prototype.add=z.prototype.push=function(e){return this.__data__.set(e,r),this},z.prototype.has=function(e){return this.__data__.has(e)};var J=k?A(k,Object):ce,Q=k?function(e){for(var t=[];e;)h(t,J(e)),e=S(e);return t}:ce;function j(e){return te(e)||ee(e)||!!(W&&e&&e[W])}function q(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||s.test(e))&&e>-1&&e%1==0&&e<t}function $(e){if("string"==typeof e||function(e){return"symbol"==typeof e||ae(e)&&w.call(e)==a}(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}function ee(e){return function(e){return ae(e)&&ne(e)}(e)&&Z.call(e,"callee")&&(!R.call(e,"callee")||"[object Arguments]"==w.call(e))}var te=Array.isArray;function ne(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}(e.length)&&!re(e)}function re(e){var t=ie(e)?w.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function ie(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function ae(e){return!!e&&"object"==typeof e}function oe(e){return ne(e)?N(e,!0):D(e)}var se,ue,le=(se=function(e,t){return null==e?{}:(t=C(T(t,1),$),function(e,t){return function(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var o=t[r],s=e[o];n(s,o)&&(a[o]=s)}return a}(e=Object(e),t,(function(t,n){return n in e}))}(e,function(e,t,n,r){var i,a=-1,o=d,s=!0,u=e.length,l=[],c=t.length;if(!u)return l;n&&(t=C(t,(i=n,function(e){return i(e)}))),r?(o=I,s=!1):t.length>=200&&(o=p,s=!1,t=new z(t));e:for(;++a<u;){var g=e[a],h=n?n(g):g;if(g=r||0!==g?g:0,s&&h===h){for(var f=c;f--;)if(t[f]===h)continue e;l.push(g)}else o(t,h,r)||l.push(g)}return l}(P(e),t)))},ue=V(void 0===ue?se.length-1:ue,0),function(){for(var e=arguments,t=-1,n=V(e.length-ue,0),r=Array(n);++t<n;)r[t]=e[ue+t];t=-1;for(var i=Array(ue+1);++t<ue;)i[t]=e[t];return i[ue]=r,g(se,this,i)});function ce(){return[]}e.exports=le},103:function(e,t,n){var r=9007199254740991,i="[object Arguments]",a="[object Function]",o="[object GeneratorFunction]",s="[object Symbol]",u="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,c=u||l||Function("return this")();function g(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function d(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var I=Object.prototype,C=I.hasOwnProperty,h=I.toString,f=c.Symbol,p=I.propertyIsEnumerable,A=f?f.isConcatSpreadable:void 0,m=Math.max;function v(e,t,n,r,i){var a=-1,o=e.length;for(n||(n=b),i||(i=[]);++a<o;){var s=e[a];t>0&&n(s)?t>1?v(s,t-1,n,r,i):d(i,s):r||(i[i.length]=s)}return i}function b(e){return B(e)||function(e){return function(e){return G(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?h.call(e):"";return t==a||t==o}(e)}(e)}(e)&&C.call(e,"callee")&&(!p.call(e,"callee")||h.call(e)==i)}(e)||!!(A&&e&&e[A])}function y(e){if("string"==typeof e||function(e){return"symbol"==typeof e||G(e)&&h.call(e)==s}(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}var B=Array.isArray;function G(e){return!!e&&"object"==typeof e}var Z,w,_=(Z=function(e,t){return null==e?{}:function(e,t){return function(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var o=t[r],s=e[o];n(s,o)&&(a[o]=s)}return a}(e=Object(e),t,(function(t,n){return n in e}))}(e,function(e,t){for(var n=-1,r=e?e.length:0,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}(v(t,1),y))},w=m(void 0===w?Z.length-1:w,0),function(){for(var e=arguments,t=-1,n=m(e.length-w,0),r=Array(n);++t<n;)r[t]=e[w+t];t=-1;for(var i=Array(w+1);++t<w;)i[t]=e[t];return i[w]=r,g(Z,this,i)});e.exports=_},8105:function(e){"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function i(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(e,a){for(var o,s,u=i(e),l=1;l<arguments.length;l++){for(var c in o=Object(arguments[l]))n.call(o,c)&&(u[c]=o[c]);if(t){s=t(o);for(var g=0;g<s.length;g++)r.call(o,s[g])&&(u[s[g]]=o[s[g]])}}return u}},5583:function(e,t,n){"use strict";var r=n(1704);function i(){}function a(){}a.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,a,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:i};return n.PropTypes=n,n}},1386:function(e,t,n){e.exports=n(5583)()},1704:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},1571:function(e,t,n){"use strict";var r=n(4519),i=n(8105),a=n(8514);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(o(227));var s=new Set,u={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(u[e]=t,e=0;e<t.length;e++)s.add(t[e])}var g=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,I=Object.prototype.hasOwnProperty,C={},h={};function f(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var p={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){p[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];p[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){p[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){p[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){p[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){p[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){p[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){p[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){p[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var A=/[\-:]([a-z])/g;function m(e){return e[1].toUpperCase()}function v(e,t,n,r){var i=p.hasOwnProperty(t)?p[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!I.call(h,e)||!I.call(C,e)&&(d.test(e)?h[e]=!0:(C[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(A,m);p[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(A,m);p[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(A,m);p[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){p[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),p.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){p[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,y=60103,B=60106,G=60107,Z=60108,w=60114,_=60109,x=60110,S=60112,R=60113,M=60120,W=60115,k=60116,V=60121,F=60128,E=60129,X=60130,H=60131;if("function"===typeof Symbol&&Symbol.for){var L=Symbol.for;y=L("react.element"),B=L("react.portal"),G=L("react.fragment"),Z=L("react.strict_mode"),w=L("react.profiler"),_=L("react.provider"),x=L("react.context"),S=L("react.forward_ref"),R=L("react.suspense"),M=L("react.suspense_list"),W=L("react.memo"),k=L("react.lazy"),V=L("react.block"),L("react.scope"),F=L("react.opaque.id"),E=L("react.debug_trace_mode"),X=L("react.offscreen"),H=L("react.legacy_hidden")}var z,N="function"===typeof Symbol&&Symbol.iterator;function Y(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}function T(e){if(void 0===z)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);z=t&&t[1]||""}return"\n"+z+e}var K=!1;function D(e,t){if(!e||K)return"";K=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var i=u.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s])return"\n"+i[o].replace(" at new "," at ")}while(1<=o&&0<=s);break}}}finally{K=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?T(e):""}function P(e){switch(e.tag){case 5:return T(e.type);case 16:return T("Lazy");case 13:return T("Suspense");case 19:return T("SuspenseList");case 0:case 2:case 15:return e=D(e.type,!1);case 11:return e=D(e.type.render,!1);case 22:return e=D(e.type._render,!1);case 1:return e=D(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case G:return"Fragment";case B:return"Portal";case w:return"Profiler";case Z:return"StrictMode";case R:return"Suspense";case M:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case x:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case S:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case W:return U(e.type);case V:return U(e._render);case k:t=e._payload,e=e._init;try{return U(e(t))}catch(n){}}return null}function O(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function J(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Q(e){e._valueTracker||(e._valueTracker=function(e){var t=J(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function j(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=J(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=O(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=O(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ie(e,t.type,n):t.hasOwnProperty("defaultValue")&&ie(e,t.type,O(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function re(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ie(e,t,n){"number"===t&&q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function ae(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function oe(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+O(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function se(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ue(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:O(n)}}function le(e,t){var n=O(t.value),r=O(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ce(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var ge="http://www.w3.org/1999/xhtml",de="http://www.w3.org/2000/svg";function Ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Ie(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var he,fe,pe=(fe=function(e,t){if(e.namespaceURI!==de||"innerHTML"in e)e.innerHTML=t;else{for((he=he||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=he.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return fe(e,t)}))}:fe);function Ae(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var me={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ve=["Webkit","ms","Moz","O"];function be(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}function ye(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=be(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(me).forEach((function(e){ve.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),me[t]=me[e]}))}));var Be=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ge(e,t){if(t){if(Be[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function Ze(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,xe=null,Se=null;function Re(e){if(e=ri(e)){if("function"!==typeof _e)throw Error(o(280));var t=e.stateNode;t&&(t=ai(t),_e(e.stateNode,e.type,t))}}function Me(e){xe?Se?Se.push(e):Se=[e]:xe=e}function We(){if(xe){var e=xe,t=Se;if(Se=xe=null,Re(e),t)for(e=0;e<t.length;e++)Re(t[e])}}function ke(e,t){return e(t)}function Ve(e,t,n,r,i){return e(t,n,r,i)}function Fe(){}var Ee=ke,Xe=!1,He=!1;function Le(){null===xe&&null===Se||(Fe(),We())}function ze(e,t){var n=e.stateNode;if(null===n)return null;var r=ai(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Ne=!1;if(g)try{var Ye={};Object.defineProperty(Ye,"passive",{get:function(){Ne=!0}}),window.addEventListener("test",Ye,Ye),window.removeEventListener("test",Ye,Ye)}catch(fe){Ne=!1}function Te(e,t,n,r,i,a,o,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var Ke=!1,De=null,Pe=!1,Ue=null,Oe={onError:function(e){Ke=!0,De=e}};function Je(e,t,n,r,i,a,o,s,u){Ke=!1,De=null,Te.apply(Oe,arguments)}function Qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Qe(e)!==e)throw Error(o(188))}function $e(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=Qe(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return qe(i),e;if(a===r)return qe(i),t;a=a.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=a;break}if(u===r){s=!0,r=i,n=a;break}u=u.sibling}if(!s){for(u=a.child;u;){if(u===n){s=!0,n=a,r=i;break}if(u===r){s=!0,r=a,n=i;break}u=u.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function et(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var tt,nt,rt,it,at=!1,ot=[],st=null,ut=null,lt=null,ct=new Map,gt=new Map,dt=[],It="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ct(e,t,n,r,i){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:i,targetContainers:[r]}}function ht(e,t){switch(e){case"focusin":case"focusout":st=null;break;case"dragenter":case"dragleave":ut=null;break;case"mouseover":case"mouseout":lt=null;break;case"pointerover":case"pointerout":ct.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gt.delete(t.pointerId)}}function ft(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e=Ct(t,n,r,i,a),null!==t&&(null!==(t=ri(t))&&nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function pt(e){var t=ni(e.target);if(null!==t){var n=Qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=je(n)))return e.blockedOn=t,void it(e.lanePriority,(function(){a.unstable_runWithPriority(e.priority,(function(){rt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function At(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ri(n))&&nt(t),e.blockedOn=n,!1;t.shift()}return!0}function mt(e,t,n){At(e)&&n.delete(t)}function vt(){for(at=!1;0<ot.length;){var e=ot[0];if(null!==e.blockedOn){null!==(e=ri(e.blockedOn))&&tt(e);break}for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&ot.shift()}null!==st&&At(st)&&(st=null),null!==ut&&At(ut)&&(ut=null),null!==lt&&At(lt)&&(lt=null),ct.forEach(mt),gt.forEach(mt)}function bt(e,t){e.blockedOn===t&&(e.blockedOn=null,at||(at=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,vt)))}function yt(e){function t(t){return bt(t,e)}if(0<ot.length){bt(ot[0],e);for(var n=1;n<ot.length;n++){var r=ot[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==st&&bt(st,e),null!==ut&&bt(ut,e),null!==lt&&bt(lt,e),ct.forEach(t),gt.forEach(t),n=0;n<dt.length;n++)(r=dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<dt.length&&null===(n=dt[0]).blockedOn;)pt(n),null===n.blockedOn&&dt.shift()}function Bt(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Gt={animationend:Bt("Animation","AnimationEnd"),animationiteration:Bt("Animation","AnimationIteration"),animationstart:Bt("Animation","AnimationStart"),transitionend:Bt("Transition","TransitionEnd")},Zt={},wt={};function _t(e){if(Zt[e])return Zt[e];if(!Gt[e])return e;var t,n=Gt[e];for(t in n)if(n.hasOwnProperty(t)&&t in wt)return Zt[e]=n[t];return e}g&&(wt=document.createElement("div").style,"AnimationEvent"in window||(delete Gt.animationend.animation,delete Gt.animationiteration.animation,delete Gt.animationstart.animation),"TransitionEvent"in window||delete Gt.transitionend.transition);var xt=_t("animationend"),St=_t("animationiteration"),Rt=_t("animationstart"),Mt=_t("transitionend"),Wt=new Map,kt=new Map,Vt=["abort","abort",xt,"animationEnd",St,"animationIteration",Rt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Mt,"transitionEnd","waiting","waiting"];function Ft(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1];i="on"+(i[0].toUpperCase()+i.slice(1)),kt.set(r,t),Wt.set(r,i),l(i,[r])}}(0,a.unstable_now)();var Et=8;function Xt(e){if(0!==(1&e))return Et=15,1;if(0!==(2&e))return Et=14,2;if(0!==(4&e))return Et=13,4;var t=24&e;return 0!==t?(Et=12,t):0!==(32&e)?(Et=11,32):0!==(t=192&e)?(Et=10,t):0!==(256&e)?(Et=9,256):0!==(t=3584&e)?(Et=8,t):0!==(4096&e)?(Et=7,4096):0!==(t=4186112&e)?(Et=6,t):0!==(t=62914560&e)?(Et=5,t):67108864&e?(Et=4,67108864):0!==(134217728&e)?(Et=3,134217728):0!==(t=805306368&e)?(Et=2,t):0!==(1073741824&e)?(Et=1,1073741824):(Et=8,e)}function Ht(e,t){var n=e.pendingLanes;if(0===n)return Et=0;var r=0,i=0,a=e.expiredLanes,o=e.suspendedLanes,s=e.pingedLanes;if(0!==a)r=a,i=Et=15;else if(0!==(a=134217727&n)){var u=a&~o;0!==u?(r=Xt(u),i=Et):0!==(s&=a)&&(r=Xt(s),i=Et)}else 0!==(a=n&~o)?(r=Xt(a),i=Et):0!==s&&(r=Xt(s),i=Et);if(0===r)return 0;if(r=n&((0>(r=31-Kt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&o)){if(Xt(t),i<=Et)return t;Et=i}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-Kt(t)),r|=e[n],t&=~i;return r}function Lt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function zt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=Nt(24&~t))?zt(10,t):e;case 10:return 0===(e=Nt(192&~t))?zt(8,t):e;case 8:return 0===(e=Nt(3584&~t))&&(0===(e=Nt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=Nt(805306368&~t))&&(t=268435456),t}throw Error(o(358,e))}function Nt(e){return e&-e}function Yt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Tt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-Kt(t)]=n}var Kt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Dt(e)/Pt|0)|0},Dt=Math.log,Pt=Math.LN2;var Ut=a.unstable_UserBlockingPriority,Ot=a.unstable_runWithPriority,Jt=!0;function Qt(e,t,n,r){Xe||Fe();var i=qt,a=Xe;Xe=!0;try{Ve(i,e,t,n,r)}finally{(Xe=a)||Le()}}function jt(e,t,n,r){Ot(Ut,qt.bind(null,e,t,n,r))}function qt(e,t,n,r){var i;if(Jt)if((i=0===(4&t))&&0<ot.length&&-1<It.indexOf(e))e=Ct(null,e,t,n,r),ot.push(e);else{var a=$t(e,t,n,r);if(null===a)i&&ht(e,r);else{if(i){if(-1<It.indexOf(e))return e=Ct(a,e,t,n,r),void ot.push(e);if(function(e,t,n,r,i){switch(t){case"focusin":return st=ft(st,e,t,n,r,i),!0;case"dragenter":return ut=ft(ut,e,t,n,r,i),!0;case"mouseover":return lt=ft(lt,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return ct.set(a,ft(ct.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,gt.set(a,ft(gt.get(a)||null,e,t,n,r,i)),!0}return!1}(a,e,t,n,r))return;ht(e,r)}Fr(e,t,r,null,n)}}}function $t(e,t,n,r){var i=we(r);if(null!==(i=ni(i))){var a=Qe(i);if(null===a)i=null;else{var o=a.tag;if(13===o){if(null!==(i=je(a)))return i;i=null}else if(3===o){if(a.stateNode.hydrate)return 3===a.tag?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return Fr(e,t,r,i,n),null}var en=null,tn=null,nn=null;function rn(){if(nn)return nn;var e,t,n=tn,r=n.length,i="value"in en?en.value:en.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return nn=i.slice(e,1<t?1-t:void 0)}function an(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function on(){return!0}function sn(){return!1}function un(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?on:sn,this.isPropagationStopped=sn,this}return i(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=on)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=on)},persist:function(){},isPersistent:on}),t}var ln,cn,gn,dn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},In=un(dn),Cn=i({},dn,{view:0,detail:0}),hn=un(Cn),fn=i({},Cn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==gn&&(gn&&"mousemove"===e.type?(ln=e.screenX-gn.screenX,cn=e.screenY-gn.screenY):cn=ln=0,gn=e),ln)},movementY:function(e){return"movementY"in e?e.movementY:cn}}),pn=un(fn),An=un(i({},fn,{dataTransfer:0})),mn=un(i({},Cn,{relatedTarget:0})),vn=un(i({},dn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=i({},dn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=un(bn),Bn=un(i({},dn,{data:0})),Gn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _n(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wn[e])&&!!t[e]}function xn(){return _n}var Sn=i({},Cn,{key:function(e){if(e.key){var t=Gn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=an(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Zn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?an(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?an(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Rn=un(Sn),Mn=un(i({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Wn=un(i({},Cn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),kn=un(i({},dn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Vn=i({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Fn=un(Vn),En=[9,13,27,32],Xn=g&&"CompositionEvent"in window,Hn=null;g&&"documentMode"in document&&(Hn=document.documentMode);var Ln=g&&"TextEvent"in window&&!Hn,zn=g&&(!Xn||Hn&&8<Hn&&11>=Hn),Nn=String.fromCharCode(32),Yn=!1;function Tn(e,t){switch(e){case"keyup":return-1!==En.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Dn=!1;var Pn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Un(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Pn[e.type]:"textarea"===t}function On(e,t,n,r){Me(r),0<(t=Xr(t,"onChange")).length&&(n=new In("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Jn=null,Qn=null;function jn(e){Sr(e,0)}function qn(e){if(j(ii(e)))return e}function $n(e,t){if("change"===e)return t}var er=!1;if(g){var tr;if(g){var nr="oninput"in document;if(!nr){var rr=document.createElement("div");rr.setAttribute("oninput","return;"),nr="function"===typeof rr.oninput}tr=nr}else tr=!1;er=tr&&(!document.documentMode||9<document.documentMode)}function ir(){Jn&&(Jn.detachEvent("onpropertychange",ar),Qn=Jn=null)}function ar(e){if("value"===e.propertyName&&qn(Qn)){var t=[];if(On(t,Qn,e,we(e)),e=jn,Xe)e(t);else{Xe=!0;try{ke(e,t)}finally{Xe=!1,Le()}}}}function or(e,t,n){"focusin"===e?(ir(),Qn=n,(Jn=t).attachEvent("onpropertychange",ar)):"focusout"===e&&ir()}function sr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return qn(Qn)}function ur(e,t){if("click"===e)return qn(t)}function lr(e,t){if("input"===e||"change"===e)return qn(t)}var cr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},gr=Object.prototype.hasOwnProperty;function dr(e,t){if(cr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!gr.call(t,n[r])||!cr(e[n[r]],t[n[r]]))return!1;return!0}function Ir(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Cr(e,t){var n,r=Ir(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ir(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=q((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var Ar=g&&"documentMode"in document&&11>=document.documentMode,mr=null,vr=null,br=null,yr=!1;function Br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;yr||null==mr||mr!==q(r)||("selectionStart"in(r=mr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&dr(br,r)||(br=r,0<(r=Xr(vr,"onSelect")).length&&(t=new In("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}Ft("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Ft("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Ft(Vt,2);for(var Gr="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Zr=0;Zr<Gr.length;Zr++)kt.set(Gr[Zr],0);c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_r=new Set("cancel close invalid load scroll toggle".split(" ").concat(wr));function xr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,s,u,l){if(Je.apply(this,arguments),Ke){if(!Ke)throw Error(o(198));var c=De;Ke=!1,De=null,Pe||(Pe=!0,Ue=c)}}(r,t,void 0,e),e.currentTarget=null}function Sr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==a&&i.isPropagationStopped())break e;xr(i,s,l),a=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,l=s.currentTarget,s=s.listener,u!==a&&i.isPropagationStopped())break e;xr(i,s,l),a=u}}}if(Pe)throw e=Ue,Pe=!1,Ue=null,e}function Rr(e,t){var n=oi(t),r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}var Mr="_reactListening"+Math.random().toString(36).slice(2);function Wr(e){e[Mr]||(e[Mr]=!0,s.forEach((function(t){_r.has(t)||kr(t,!1,e,null),kr(t,!0,e,null)})))}function kr(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=n;if("selectionchange"===e&&9!==n.nodeType&&(a=n.ownerDocument),null!==r&&!t&&_r.has(e)){if("scroll"!==e)return;i|=2,a=r}var o=oi(a),s=e+"__"+(t?"capture":"bubble");o.has(s)||(t&&(i|=4),Vr(a,e,i,t),o.add(s))}function Vr(e,t,n,r){var i=kt.get(t);switch(void 0===i?2:i){case 0:i=Qt;break;case 1:i=jt;break;default:i=qt}n=i.bind(null,t,n,e),i=void 0,!Ne||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Fr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=ni(s)))return;if(5===(u=o.tag)||6===u){r=a=o;continue e}s=s.parentNode}}r=r.return}!function(e,t,n){if(He)return e(t,n);He=!0;try{Ee(e,t,n)}finally{He=!1,Le()}}((function(){var r=a,i=we(n),o=[];e:{var s=Wt.get(e);if(void 0!==s){var u=In,l=e;switch(e){case"keypress":if(0===an(n))break e;case"keydown":case"keyup":u=Rn;break;case"focusin":l="focus",u=mn;break;case"focusout":l="blur",u=mn;break;case"beforeblur":case"afterblur":u=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=An;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Wn;break;case xt:case St:case Rt:u=vn;break;case Mt:u=kn;break;case"scroll":u=hn;break;case"wheel":u=Fn;break;case"copy":case"cut":case"paste":u=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Mn}var c=0!==(4&t),g=!c&&"scroll"===e,d=c?null!==s?s+"Capture":null:s;c=[];for(var I,C=r;null!==C;){var h=(I=C).stateNode;if(5===I.tag&&null!==h&&(I=h,null!==d&&(null!=(h=ze(C,d))&&c.push(Er(C,h,I)))),g)break;C=C.return}0<c.length&&(s=new u(s,l,null,n,i),o.push({event:s,listeners:c}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||0!==(16&t)||!(l=n.relatedTarget||n.fromElement)||!ni(l)&&!l[ei])&&(u||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(l=(l=n.relatedTarget||n.toElement)?ni(l):null)&&(l!==(g=Qe(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(u=null,l=r),u!==l)){if(c=pn,h="onMouseLeave",d="onMouseEnter",C="mouse","pointerout"!==e&&"pointerover"!==e||(c=Mn,h="onPointerLeave",d="onPointerEnter",C="pointer"),g=null==u?s:ii(u),I=null==l?s:ii(l),(s=new c(h,C+"leave",u,n,i)).target=g,s.relatedTarget=I,h=null,ni(i)===r&&((c=new c(d,C+"enter",l,n,i)).target=I,c.relatedTarget=g,h=c),g=h,u&&l)e:{for(d=l,C=0,I=c=u;I;I=Hr(I))C++;for(I=0,h=d;h;h=Hr(h))I++;for(;0<C-I;)c=Hr(c),C--;for(;0<I-C;)d=Hr(d),I--;for(;C--;){if(c===d||null!==d&&c===d.alternate)break e;c=Hr(c),d=Hr(d)}c=null}else c=null;null!==u&&Lr(o,s,u,c,!1),null!==l&&null!==g&&Lr(o,g,l,c,!0)}if("select"===(u=(s=r?ii(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var f=$n;else if(Un(s))if(er)f=lr;else{f=sr;var p=or}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(f=ur);switch(f&&(f=f(e,r))?On(o,f,n,i):(p&&p(e,s,r),"focusout"===e&&(p=s._wrapperState)&&p.controlled&&"number"===s.type&&ie(s,"number",s.value)),p=r?ii(r):window,e){case"focusin":(Un(p)||"true"===p.contentEditable)&&(mr=p,vr=r,br=null);break;case"focusout":br=vr=mr=null;break;case"mousedown":yr=!0;break;case"contextmenu":case"mouseup":case"dragend":yr=!1,Br(o,n,i);break;case"selectionchange":if(Ar)break;case"keydown":case"keyup":Br(o,n,i)}var A;if(Xn)e:{switch(e){case"compositionstart":var m="onCompositionStart";break e;case"compositionend":m="onCompositionEnd";break e;case"compositionupdate":m="onCompositionUpdate";break e}m=void 0}else Dn?Tn(e,n)&&(m="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(m="onCompositionStart");m&&(zn&&"ko"!==n.locale&&(Dn||"onCompositionStart"!==m?"onCompositionEnd"===m&&Dn&&(A=rn()):(tn="value"in(en=i)?en.value:en.textContent,Dn=!0)),0<(p=Xr(r,m)).length&&(m=new Bn(m,e,null,n,i),o.push({event:m,listeners:p}),A?m.data=A:null!==(A=Kn(n))&&(m.data=A))),(A=Ln?function(e,t){switch(e){case"compositionend":return Kn(t);case"keypress":return 32!==t.which?null:(Yn=!0,Nn);case"textInput":return(e=t.data)===Nn&&Yn?null:e;default:return null}}(e,n):function(e,t){if(Dn)return"compositionend"===e||!Xn&&Tn(e,t)?(e=rn(),nn=tn=en=null,Dn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Xr(r,"onBeforeInput")).length&&(i=new Bn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=A))}Sr(o,t)}))}function Er(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Xr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=ze(e,n))&&r.unshift(Er(e,a,i)),null!=(a=ze(e,t))&&r.push(Er(e,a,i))),e=e.return}return r}function Hr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Lr(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==l&&(s=l,i?null!=(u=ze(n,a))&&o.unshift(Er(n,u,s)):i||null!=(u=ze(n,a))&&o.push(Er(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}function zr(){}var Nr=null,Yr=null;function Tr(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Kr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Dr="function"===typeof setTimeout?setTimeout:void 0,Pr="function"===typeof clearTimeout?clearTimeout:void 0;function Ur(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Or(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Jr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Qr=0;var jr=Math.random().toString(36).slice(2),qr="__reactFiber$"+jr,$r="__reactProps$"+jr,ei="__reactContainer$"+jr,ti="__reactEvents$"+jr;function ni(e){var t=e[qr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ei]||n[qr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Jr(e);null!==e;){if(n=e[qr])return n;e=Jr(e)}return t}n=(e=n).parentNode}return null}function ri(e){return!(e=e[qr]||e[ei])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ii(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function ai(e){return e[$r]||null}function oi(e){var t=e[ti];return void 0===t&&(t=e[ti]=new Set),t}var si=[],ui=-1;function li(e){return{current:e}}function ci(e){0>ui||(e.current=si[ui],si[ui]=null,ui--)}function gi(e,t){ui++,si[ui]=e.current,e.current=t}var di={},Ii=li(di),Ci=li(!1),hi=di;function fi(e,t){var n=e.type.contextTypes;if(!n)return di;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ai(){ci(Ci),ci(Ii)}function mi(e,t,n){if(Ii.current!==di)throw Error(o(168));gi(Ii,t),gi(Ci,n)}function vi(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in e))throw Error(o(108,U(t)||"Unknown",a));return i({},n,r)}function bi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||di,hi=Ii.current,gi(Ii,e),gi(Ci,Ci.current),!0}function yi(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=vi(e,t,hi),r.__reactInternalMemoizedMergedChildContext=e,ci(Ci),ci(Ii),gi(Ii,e)):ci(Ci),gi(Ci,n)}var Bi=null,Gi=null,Zi=a.unstable_runWithPriority,wi=a.unstable_scheduleCallback,_i=a.unstable_cancelCallback,xi=a.unstable_shouldYield,Si=a.unstable_requestPaint,Ri=a.unstable_now,Mi=a.unstable_getCurrentPriorityLevel,Wi=a.unstable_ImmediatePriority,ki=a.unstable_UserBlockingPriority,Vi=a.unstable_NormalPriority,Fi=a.unstable_LowPriority,Ei=a.unstable_IdlePriority,Xi={},Hi=void 0!==Si?Si:function(){},Li=null,zi=null,Ni=!1,Yi=Ri(),Ti=1e4>Yi?Ri:function(){return Ri()-Yi};function Ki(){switch(Mi()){case Wi:return 99;case ki:return 98;case Vi:return 97;case Fi:return 96;case Ei:return 95;default:throw Error(o(332))}}function Di(e){switch(e){case 99:return Wi;case 98:return ki;case 97:return Vi;case 96:return Fi;case 95:return Ei;default:throw Error(o(332))}}function Pi(e,t){return e=Di(e),Zi(e,t)}function Ui(e,t,n){return e=Di(e),wi(e,t,n)}function Oi(){if(null!==zi){var e=zi;zi=null,_i(e)}Ji()}function Ji(){if(!Ni&&null!==Li){Ni=!0;var e=0;try{var t=Li;Pi(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Li=null}catch(n){throw null!==Li&&(Li=Li.slice(e+1)),wi(Wi,Oi),n}finally{Ni=!1}}}var Qi=b.ReactCurrentBatchConfig;function ji(e,t){if(e&&e.defaultProps){for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var qi=li(null),$i=null,ea=null,ta=null;function na(){ta=ea=$i=null}function ra(e){var t=qi.current;ci(qi),e.type._context._currentValue=t}function ia(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function aa(e,t){$i=e,ta=ea=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Xo=!0),e.firstContext=null)}function oa(e,t){if(ta!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(ta=e,t=1073741823),t={context:e,observedBits:t,next:null},null===ea){if(null===$i)throw Error(o(308));ea=t,$i.dependencies={lanes:0,firstContext:t,responders:null}}else ea=ea.next=t;return e._currentValue}var sa=!1;function ua(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function la(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ca(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ga(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function da(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ia(e,t,n,r){var a=e.updateQueue;sa=!1;var o=a.firstBaseUpdate,s=a.lastBaseUpdate,u=a.shared.pending;if(null!==u){a.shared.pending=null;var l=u,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var g=e.alternate;if(null!==g){var d=(g=g.updateQueue).lastBaseUpdate;d!==s&&(null===d?g.firstBaseUpdate=c:d.next=c,g.lastBaseUpdate=l)}}if(null!==o){for(d=a.baseState,s=0,g=c=l=null;;){u=o.lane;var I=o.eventTime;if((r&u)===u){null!==g&&(g=g.next={eventTime:I,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var C=e,h=o;switch(u=t,I=n,h.tag){case 1:if("function"===typeof(C=h.payload)){d=C.call(I,d,u);break e}d=C;break e;case 3:C.flags=-4097&C.flags|64;case 0:if(null===(u="function"===typeof(C=h.payload)?C.call(I,d,u):C)||void 0===u)break e;d=i({},d,u);break e;case 2:sa=!0}}null!==o.callback&&(e.flags|=32,null===(u=a.effects)?a.effects=[o]:u.push(o))}else I={eventTime:I,lane:u,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===g?(c=g=I,l=d):g=g.next=I,s|=u;if(null===(o=o.next)){if(null===(u=a.shared.pending))break;o=u.next,u.next=null,a.lastBaseUpdate=u,a.shared.pending=null}}null===g&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=g,Ns|=s,e.lanes=s,e.memoizedState=d}}function Ca(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var ha=(new r.Component).refs;function fa(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:i({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var pa={isMounted:function(e){return!!(e=e._reactInternals)&&Qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=du(),i=Iu(e),a=ca(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),ga(e,a),Cu(e,i,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=du(),i=Iu(e),a=ca(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),ga(e,a),Cu(e,i,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=du(),r=Iu(e),i=ca(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),ga(e,i),Cu(e,r,n)}};function Aa(e,t,n,r,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!dr(n,r)||!dr(i,a))}function ma(e,t,n){var r=!1,i=di,a=t.contextType;return"object"===typeof a&&null!==a?a=oa(a):(i=pi(t)?hi:Ii.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?fi(e,i):di),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=pa,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function va(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&pa.enqueueReplaceState(t,t.state,null)}function ba(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=ha,ua(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=oa(a):(a=pi(t)?hi:Ii.current,i.context=fi(e,a)),Ia(e,n,i,r),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(fa(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&pa.enqueueReplaceState(i,i.state,null),Ia(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4)}var ya=Array.isArray;function Ba(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;t===ha&&(t=r.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function Ga(e,t){if("textarea"!==e.type)throw Error(o(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Za(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Pu(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function s(t){return e&&null===t.alternate&&(t.flags=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Qu(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=Ba(e,t,n),r.return=e,r):((r=Uu(n.type,n.key,n.props,null,e.mode,r)).ref=Ba(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=ju(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function g(e,t,n,r,a){return null===t||7!==t.tag?((t=Ou(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=Qu(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case y:return(n=Uu(t.type,t.key,t.props,null,e.mode,n)).ref=Ba(e,null,t),n.return=e,n;case B:return(t=ju(t,e.mode,n)).return=e,t}if(ya(t)||Y(t))return(t=Ou(t,e.mode,n,null)).return=e,t;Ga(e,t)}return null}function I(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case y:return n.key===i?n.type===G?g(e,t,n.props.children,r,i):l(e,t,n,r):null;case B:return n.key===i?c(e,t,n,r):null}if(ya(n)||Y(n))return null!==i?null:g(e,t,n,r,null);Ga(e,n)}return null}function C(e,t,n,r,i){if("string"===typeof r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case y:return e=e.get(null===r.key?n:r.key)||null,r.type===G?g(t,e,r.props.children,i,r.key):l(t,e,r,i);case B:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(ya(r)||Y(r))return g(t,e=e.get(n)||null,r,i,null);Ga(t,r)}return null}function h(i,o,s,u){for(var l=null,c=null,g=o,h=o=0,f=null;null!==g&&h<s.length;h++){g.index>h?(f=g,g=null):f=g.sibling;var p=I(i,g,s[h],u);if(null===p){null===g&&(g=f);break}e&&g&&null===p.alternate&&t(i,g),o=a(p,o,h),null===c?l=p:c.sibling=p,c=p,g=f}if(h===s.length)return n(i,g),l;if(null===g){for(;h<s.length;h++)null!==(g=d(i,s[h],u))&&(o=a(g,o,h),null===c?l=g:c.sibling=g,c=g);return l}for(g=r(i,g);h<s.length;h++)null!==(f=C(g,i,h,s[h],u))&&(e&&null!==f.alternate&&g.delete(null===f.key?h:f.key),o=a(f,o,h),null===c?l=f:c.sibling=f,c=f);return e&&g.forEach((function(e){return t(i,e)})),l}function f(i,s,u,l){var c=Y(u);if("function"!==typeof c)throw Error(o(150));if(null==(u=c.call(u)))throw Error(o(151));for(var g=c=null,h=s,f=s=0,p=null,A=u.next();null!==h&&!A.done;f++,A=u.next()){h.index>f?(p=h,h=null):p=h.sibling;var m=I(i,h,A.value,l);if(null===m){null===h&&(h=p);break}e&&h&&null===m.alternate&&t(i,h),s=a(m,s,f),null===g?c=m:g.sibling=m,g=m,h=p}if(A.done)return n(i,h),c;if(null===h){for(;!A.done;f++,A=u.next())null!==(A=d(i,A.value,l))&&(s=a(A,s,f),null===g?c=A:g.sibling=A,g=A);return c}for(h=r(i,h);!A.done;f++,A=u.next())null!==(A=C(h,i,f,A.value,l))&&(e&&null!==A.alternate&&h.delete(null===A.key?f:A.key),s=a(A,s,f),null===g?c=A:g.sibling=A,g=A);return e&&h.forEach((function(e){return t(i,e)})),c}return function(e,r,a,u){var l="object"===typeof a&&null!==a&&a.type===G&&null===a.key;l&&(a=a.props.children);var c="object"===typeof a&&null!==a;if(c)switch(a.$$typeof){case y:e:{for(c=a.key,l=r;null!==l;){if(l.key===c){if(7===l.tag){if(a.type===G){n(e,l.sibling),(r=i(l,a.props.children)).return=e,e=r;break e}}else if(l.elementType===a.type){n(e,l.sibling),(r=i(l,a.props)).ref=Ba(e,l,a),r.return=e,e=r;break e}n(e,l);break}t(e,l),l=l.sibling}a.type===G?((r=Ou(a.props.children,e.mode,u,a.key)).return=e,e=r):((u=Uu(a.type,a.key,a.props,null,e.mode,u)).ref=Ba(e,r,a),u.return=e,e=u)}return s(e);case B:e:{for(l=a.key;null!==r;){if(r.key===l){if(4===r.tag&&r.stateNode.containerInfo===a.containerInfo&&r.stateNode.implementation===a.implementation){n(e,r.sibling),(r=i(r,a.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=ju(a,e.mode,u)).return=e,e=r}return s(e)}if("string"===typeof a||"number"===typeof a)return a=""+a,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,a)).return=e,e=r):(n(e,r),(r=Qu(a,e.mode,u)).return=e,e=r),s(e);if(ya(a))return h(e,r,a,u);if(Y(a))return f(e,r,a,u);if(c&&Ga(e,a),"undefined"===typeof a&&!l)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(o(152,U(e.type)||"Component"))}return n(e,r)}}var wa=Za(!0),_a=Za(!1),xa={},Sa=li(xa),Ra=li(xa),Ma=li(xa);function Wa(e){if(e===xa)throw Error(o(174));return e}function ka(e,t){switch(gi(Ma,t),gi(Ra,e),gi(Sa,xa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ce(null,"");break;default:t=Ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ci(Sa),gi(Sa,t)}function Va(){ci(Sa),ci(Ra),ci(Ma)}function Fa(e){Wa(Ma.current);var t=Wa(Sa.current),n=Ce(t,e.type);t!==n&&(gi(Ra,e),gi(Sa,n))}function Ea(e){Ra.current===e&&(ci(Sa),ci(Ra))}var Xa=li(0);function Ha(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var La=null,za=null,Na=!1;function Ya(e,t){var n=Ku(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Ta(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function Ka(e){if(Na){var t=za;if(t){var n=t;if(!Ta(e,t)){if(!(t=Or(n.nextSibling))||!Ta(e,t))return e.flags=-1025&e.flags|2,Na=!1,void(La=e);Ya(La,n)}La=e,za=Or(t.firstChild)}else e.flags=-1025&e.flags|2,Na=!1,La=e}}function Da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;La=e}function Pa(e){if(e!==La)return!1;if(!Na)return Da(e),Na=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Kr(t,e.memoizedProps))for(t=za;t;)Ya(e,t),t=Or(t.nextSibling);if(Da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){za=Or(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}za=null}}else za=La?Or(e.stateNode.nextSibling):null;return!0}function Ua(){za=La=null,Na=!1}var Oa=[];function Ja(){for(var e=0;e<Oa.length;e++)Oa[e]._workInProgressVersionPrimary=null;Oa.length=0}var Qa=b.ReactCurrentDispatcher,ja=b.ReactCurrentBatchConfig,qa=0,$a=null,eo=null,to=null,no=!1,ro=!1;function io(){throw Error(o(321))}function ao(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!cr(e[n],t[n]))return!1;return!0}function oo(e,t,n,r,i,a){if(qa=a,$a=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Qa.current=null===e||null===e.memoizedState?ko:Vo,e=n(r,i),ro){a=0;do{if(ro=!1,!(25>a))throw Error(o(301));a+=1,to=eo=null,t.updateQueue=null,Qa.current=Fo,e=n(r,i)}while(ro)}if(Qa.current=Wo,t=null!==eo&&null!==eo.next,qa=0,to=eo=$a=null,no=!1,t)throw Error(o(300));return e}function so(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===to?$a.memoizedState=to=e:to=to.next=e,to}function uo(){if(null===eo){var e=$a.alternate;e=null!==e?e.memoizedState:null}else e=eo.next;var t=null===to?$a.memoizedState:to.next;if(null!==t)to=t,eo=e;else{if(null===e)throw Error(o(310));e={memoizedState:(eo=e).memoizedState,baseState:eo.baseState,baseQueue:eo.baseQueue,queue:eo.queue,next:null},null===to?$a.memoizedState=to=e:to=to.next=e}return to}function lo(e,t){return"function"===typeof t?t(e):t}function co(e){var t=uo(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=eo,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var u=s=a=null,l=i;do{var c=l.lane;if((qa&c)===c)null!==u&&(u=u.next={lane:0,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),r=l.eagerReducer===e?l.eagerState:e(r,l.action);else{var g={lane:c,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};null===u?(s=u=g,a=r):u=u.next=g,$a.lanes|=c,Ns|=c}l=l.next}while(null!==l&&l!==i);null===u?a=r:u.next=s,cr(r,t.memoizedState)||(Xo=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function go(e){var t=uo(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);cr(a,t.memoizedState)||(Xo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Io(e,t,n){var r=t._getVersion;r=r(t._source);var i=t._workInProgressVersionPrimary;if(null!==i?e=i===r:(e=e.mutableReadLanes,(e=(qa&e)===e)&&(t._workInProgressVersionPrimary=r,Oa.push(t))),e)return n(t._source);throw Oa.push(t),Error(o(350))}function Co(e,t,n,r){var i=ks;if(null===i)throw Error(o(349));var a=t._getVersion,s=a(t._source),u=Qa.current,l=u.useState((function(){return Io(i,t,n)})),c=l[1],g=l[0];l=to;var d=e.memoizedState,I=d.refs,C=I.getSnapshot,h=d.source;d=d.subscribe;var f=$a;return e.memoizedState={refs:I,source:t,subscribe:r},u.useEffect((function(){I.getSnapshot=n,I.setSnapshot=c;var e=a(t._source);if(!cr(s,e)){e=n(t._source),cr(g,e)||(c(e),e=Iu(f),i.mutableReadLanes|=e&i.pendingLanes),e=i.mutableReadLanes,i.entangledLanes|=e;for(var r=i.entanglements,o=e;0<o;){var u=31-Kt(o),l=1<<u;r[u]|=e,o&=~l}}}),[n,t,r]),u.useEffect((function(){return r(t._source,(function(){var e=I.getSnapshot,n=I.setSnapshot;try{n(e(t._source));var r=Iu(f);i.mutableReadLanes|=r&i.pendingLanes}catch(a){n((function(){throw a}))}}))}),[t,r]),cr(C,n)&&cr(h,t)&&cr(d,r)||((e={pending:null,dispatch:null,lastRenderedReducer:lo,lastRenderedState:g}).dispatch=c=Mo.bind(null,$a,e),l.queue=e,l.baseQueue=null,g=Io(i,t,n),l.memoizedState=l.baseState=g),g}function ho(e,t,n){return Co(uo(),e,t,n)}function fo(e){var t=so();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:lo,lastRenderedState:e}).dispatch=Mo.bind(null,$a,e),[t.memoizedState,e]}function po(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=$a.updateQueue)?(t={lastEffect:null},$a.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ao(e){return e={current:e},so().memoizedState=e}function mo(){return uo().memoizedState}function vo(e,t,n,r){var i=so();$a.flags|=e,i.memoizedState=po(1|t,n,void 0,void 0===r?null:r)}function bo(e,t,n,r){var i=uo();r=void 0===r?null:r;var a=void 0;if(null!==eo){var o=eo.memoizedState;if(a=o.destroy,null!==r&&ao(r,o.deps))return void po(t,n,a,r)}$a.flags|=e,i.memoizedState=po(1|t,n,a,r)}function yo(e,t){return vo(516,4,e,t)}function Bo(e,t){return bo(516,4,e,t)}function Go(e,t){return bo(4,2,e,t)}function Zo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function wo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,bo(4,2,Zo.bind(null,t,e),n)}function _o(){}function xo(e,t){var n=uo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ao(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function So(e,t){var n=uo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ao(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ro(e,t){var n=Ki();Pi(98>n?98:n,(function(){e(!0)})),Pi(97<n?97:n,(function(){var n=ja.transition;ja.transition=1;try{e(!1),t()}finally{ja.transition=n}}))}function Mo(e,t,n){var r=du(),i=Iu(e),a={lane:i,action:n,eagerReducer:null,eagerState:null,next:null},o=t.pending;if(null===o?a.next=a:(a.next=o.next,o.next=a),t.pending=a,o=e.alternate,e===$a||null!==o&&o===$a)ro=no=!0;else{if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,u=o(s,n);if(a.eagerReducer=o,a.eagerState=u,cr(u,s))return}catch(l){}Cu(e,i,r)}}var Wo={readContext:oa,useCallback:io,useContext:io,useEffect:io,useImperativeHandle:io,useLayoutEffect:io,useMemo:io,useReducer:io,useRef:io,useState:io,useDebugValue:io,useDeferredValue:io,useTransition:io,useMutableSource:io,useOpaqueIdentifier:io,unstable_isNewReconciler:!1},ko={readContext:oa,useCallback:function(e,t){return so().memoizedState=[e,void 0===t?null:t],e},useContext:oa,useEffect:yo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,vo(4,2,Zo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return vo(4,2,e,t)},useMemo:function(e,t){var n=so();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=so();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Mo.bind(null,$a,e),[r.memoizedState,e]},useRef:Ao,useState:fo,useDebugValue:_o,useDeferredValue:function(e){var t=fo(e),n=t[0],r=t[1];return yo((function(){var t=ja.transition;ja.transition=1;try{r(e)}finally{ja.transition=t}}),[e]),n},useTransition:function(){var e=fo(!1),t=e[0];return Ao(e=Ro.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=so();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},Co(r,e,t,n)},useOpaqueIdentifier:function(){if(Na){var e=!1,t=function(e){return{$$typeof:F,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(Qr++).toString(36))),Error(o(355))})),n=fo(t)[1];return 0===(2&$a.mode)&&($a.flags|=516,po(5,(function(){n("r:"+(Qr++).toString(36))}),void 0,null)),t}return fo(t="r:"+(Qr++).toString(36)),t},unstable_isNewReconciler:!1},Vo={readContext:oa,useCallback:xo,useContext:oa,useEffect:Bo,useImperativeHandle:wo,useLayoutEffect:Go,useMemo:So,useReducer:co,useRef:mo,useState:function(){return co(lo)},useDebugValue:_o,useDeferredValue:function(e){var t=co(lo),n=t[0],r=t[1];return Bo((function(){var t=ja.transition;ja.transition=1;try{r(e)}finally{ja.transition=t}}),[e]),n},useTransition:function(){var e=co(lo)[0];return[mo().current,e]},useMutableSource:ho,useOpaqueIdentifier:function(){return co(lo)[0]},unstable_isNewReconciler:!1},Fo={readContext:oa,useCallback:xo,useContext:oa,useEffect:Bo,useImperativeHandle:wo,useLayoutEffect:Go,useMemo:So,useReducer:go,useRef:mo,useState:function(){return go(lo)},useDebugValue:_o,useDeferredValue:function(e){var t=go(lo),n=t[0],r=t[1];return Bo((function(){var t=ja.transition;ja.transition=1;try{r(e)}finally{ja.transition=t}}),[e]),n},useTransition:function(){var e=go(lo)[0];return[mo().current,e]},useMutableSource:ho,useOpaqueIdentifier:function(){return go(lo)[0]},unstable_isNewReconciler:!1},Eo=b.ReactCurrentOwner,Xo=!1;function Ho(e,t,n,r){t.child=null===e?_a(t,null,n,r):wa(t,e.child,n,r)}function Lo(e,t,n,r,i){n=n.render;var a=t.ref;return aa(t,i),r=oo(e,t,n,r,a,i),null===e||Xo?(t.flags|=1,Ho(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,as(e,t,i))}function zo(e,t,n,r,i,a){if(null===e){var o=n.type;return"function"!==typeof o||Du(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Uu(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,No(e,t,o,r,i,a))}return o=e.child,0===(i&a)&&(i=o.memoizedProps,(n=null!==(n=n.compare)?n:dr)(i,r)&&e.ref===t.ref)?as(e,t,a):(t.flags|=1,(e=Pu(o,r)).ref=t.ref,e.return=t,t.child=e)}function No(e,t,n,r,i,a){if(null!==e&&dr(e.memoizedProps,r)&&e.ref===t.ref){if(Xo=!1,0===(a&i))return t.lanes=e.lanes,as(e,t,a);0!==(16384&e.flags)&&(Xo=!0)}return Ko(e,t,n,r,a)}function Yo(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},yu(t,n);else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},yu(t,e),null;t.memoizedState={baseLanes:0},yu(t,null!==a?a.baseLanes:n)}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,yu(t,r);return Ho(e,t,i,n),t.child}function To(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function Ko(e,t,n,r,i){var a=pi(n)?hi:Ii.current;return a=fi(t,a),aa(t,i),n=oo(e,t,n,r,a,i),null===e||Xo?(t.flags|=1,Ho(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,as(e,t,i))}function Do(e,t,n,r,i){if(pi(n)){var a=!0;bi(t)}else a=!1;if(aa(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),ma(t,n,r),ba(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,l=n.contextType;"object"===typeof l&&null!==l?l=oa(l):l=fi(t,l=pi(n)?hi:Ii.current);var c=n.getDerivedStateFromProps,g="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;g||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==l)&&va(t,o,r,l),sa=!1;var d=t.memoizedState;o.state=d,Ia(t,r,o,i),u=t.memoizedState,s!==r||d!==u||Ci.current||sa?("function"===typeof c&&(fa(t,n,c,r),u=t.memoizedState),(s=sa||Aa(t,n,s,r,d,u,l))?(g||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4)):("function"===typeof o.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=l,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4),r=!1)}else{o=t.stateNode,la(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:ji(t.type,s),o.props=l,g=t.pendingProps,d=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=oa(u):u=fi(t,u=pi(n)?hi:Ii.current);var I=n.getDerivedStateFromProps;(c="function"===typeof I||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==g||d!==u)&&va(t,o,r,u),sa=!1,d=t.memoizedState,o.state=d,Ia(t,r,o,i);var C=t.memoizedState;s!==g||d!==C||Ci.current||sa?("function"===typeof I&&(fa(t,n,I,r),C=t.memoizedState),(l=sa||Aa(t,n,l,r,d,C,u))?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,C,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,C,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=C),o.props=r,o.state=C,o.context=u,r=l):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),r=!1)}return Po(e,t,n,r,a,i)}function Po(e,t,n,r,i,a){To(e,t);var o=0!==(64&t.flags);if(!r&&!o)return i&&yi(t,n,!1),as(e,t,a);r=t.stateNode,Eo.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=wa(t,e.child,null,a),t.child=wa(t,null,s,a)):Ho(e,t,s,a),t.memoizedState=r.state,i&&yi(t,n,!0),t.child}function Uo(e){var t=e.stateNode;t.pendingContext?mi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&mi(0,t.context,!1),ka(e,t.containerInfo)}var Oo,Jo,Qo,jo={dehydrated:null,retryLane:0};function qo(e,t,n){var r,i=t.pendingProps,a=Xa.current,o=!1;return(r=0!==(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(o=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(a|=1),gi(Xa,1&a),null===e?(void 0!==i.fallback&&Ka(t),e=i.children,a=i.fallback,o?(e=$o(t,e,a,n),t.child.memoizedState={baseLanes:n},t.memoizedState=jo,e):"number"===typeof i.unstable_expectedLoadTime?(e=$o(t,e,a,n),t.child.memoizedState={baseLanes:n},t.memoizedState=jo,t.lanes=33554432,e):((n=Ju({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,o?(i=ts(e,t,i.children,i.fallback,n),o=t.child,a=e.child.memoizedState,o.memoizedState=null===a?{baseLanes:n}:{baseLanes:a.baseLanes|n},o.childLanes=e.childLanes&~n,t.memoizedState=jo,i):(n=es(e,t,i.children,n),t.memoizedState=null,n))}function $o(e,t,n,r){var i=e.mode,a=e.child;return t={mode:"hidden",children:t},0===(2&i)&&null!==a?(a.childLanes=0,a.pendingProps=t):a=Ju(t,i,0,null),n=Ou(n,i,r,null),a.return=e,n.return=e,a.sibling=n,e.child=a,n}function es(e,t,n,r){var i=e.child;return e=i.sibling,n=Pu(i,{mode:"visible",children:n}),0===(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function ts(e,t,n,r,i){var a=t.mode,o=e.child;e=o.sibling;var s={mode:"hidden",children:n};return 0===(2&a)&&t.child!==o?((n=t.child).childLanes=0,n.pendingProps=s,null!==(o=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=o,o.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Pu(o,s),null!==e?r=Pu(e,r):(r=Ou(r,a,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function ns(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ia(e.return,t)}function rs(e,t,n,r,i,a){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,lastEffect:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i,o.lastEffect=a)}function is(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Ho(e,t,r.children,n),0!==(2&(r=Xa.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ns(e,n);else if(19===e.tag)ns(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(gi(Xa,r),0===(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Ha(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),rs(t,!1,i,n,a,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Ha(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}rs(t,!0,n,null,a,t.lastEffect);break;case"together":rs(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function as(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ns|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Pu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function os(e,t){if(!Na)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ss(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return pi(t.type)&&Ai(),null;case 3:return Va(),ci(Ci),ci(Ii),Ja(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Pa(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:Ea(t);var a=Wa(Ma.current);if(n=t.type,null!==e&&null!=t.stateNode)Jo(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(o(166));return null}if(e=Wa(Sa.current),Pa(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[qr]=t,r[$r]=s,n){case"dialog":Rr("cancel",r),Rr("close",r);break;case"iframe":case"object":case"embed":Rr("load",r);break;case"video":case"audio":for(e=0;e<wr.length;e++)Rr(wr[e],r);break;case"source":Rr("error",r);break;case"img":case"image":case"link":Rr("error",r),Rr("load",r);break;case"details":Rr("toggle",r);break;case"input":ee(r,s),Rr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Rr("invalid",r);break;case"textarea":ue(r,s),Rr("invalid",r)}for(var l in Ge(n,s),e=null,s)s.hasOwnProperty(l)&&(a=s[l],"children"===l?"string"===typeof a?r.textContent!==a&&(e=["children",a]):"number"===typeof a&&r.textContent!==""+a&&(e=["children",""+a]):u.hasOwnProperty(l)&&null!=a&&"onScroll"===l&&Rr("scroll",r));switch(n){case"input":Q(r),re(r,s,!0);break;case"textarea":Q(r),ce(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=zr)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(l=9===a.nodeType?a:a.ownerDocument,e===ge&&(e=Ie(n)),e===ge?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[qr]=t,e[$r]=r,Oo(e,t),t.stateNode=e,l=Ze(n,r),n){case"dialog":Rr("cancel",e),Rr("close",e),a=r;break;case"iframe":case"object":case"embed":Rr("load",e),a=r;break;case"video":case"audio":for(a=0;a<wr.length;a++)Rr(wr[a],e);a=r;break;case"source":Rr("error",e),a=r;break;case"img":case"image":case"link":Rr("error",e),Rr("load",e),a=r;break;case"details":Rr("toggle",e),a=r;break;case"input":ee(e,r),a=$(e,r),Rr("invalid",e);break;case"option":a=ae(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=i({},r,{value:void 0}),Rr("invalid",e);break;case"textarea":ue(e,r),a=se(e,r),Rr("invalid",e);break;default:a=r}Ge(n,a);var c=a;for(s in c)if(c.hasOwnProperty(s)){var g=c[s];"style"===s?ye(e,g):"dangerouslySetInnerHTML"===s?null!=(g=g?g.__html:void 0)&&pe(e,g):"children"===s?"string"===typeof g?("textarea"!==n||""!==g)&&Ae(e,g):"number"===typeof g&&Ae(e,""+g):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(u.hasOwnProperty(s)?null!=g&&"onScroll"===s&&Rr("scroll",e):null!=g&&v(e,s,g,l))}switch(n){case"input":Q(e),re(e,r,!1);break;case"textarea":Q(e),ce(e);break;case"option":null!=r.value&&e.setAttribute("value",""+O(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?oe(e,!!r.multiple,s,!1):null!=r.defaultValue&&oe(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=zr)}Tr(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Qo(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));n=Wa(Ma.current),Wa(Sa.current),Pa(t)?(r=t.stateNode,n=t.memoizedProps,r[qr]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[qr]=t,t.stateNode=r)}return null;case 13:return ci(Xa),r=t.memoizedState,0!==(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&Pa(t):n=null!==e.memoizedState,r&&!n&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Xa.current)?0===Hs&&(Hs=3):(0!==Hs&&3!==Hs||(Hs=4),null===ks||0===(134217727&Ns)&&0===(134217727&Ys)||Au(ks,Fs))),(r||n)&&(t.flags|=4),null);case 4:return Va(),null===e&&Wr(t.stateNode.containerInfo),null;case 10:return ra(t),null;case 19:if(ci(Xa),null===(r=t.memoizedState))return null;if(s=0!==(64&t.flags),null===(l=r.rendering))if(s)os(r,!1);else{if(0!==Hs||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(l=Ha(e))){for(t.flags|=64,os(r,!1),null!==(s=l.updateQueue)&&(t.updateQueue=s,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return gi(Xa,1&Xa.current|2),t.child}e=e.sibling}null!==r.tail&&Ti()>Ps&&(t.flags|=64,s=!0,os(r,!1),t.lanes=33554432)}else{if(!s)if(null!==(e=Ha(l))){if(t.flags|=64,s=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),os(r,!0),null===r.tail&&"hidden"===r.tailMode&&!l.alternate&&!Na)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Ti()-r.renderingStartTime>Ps&&1073741824!==n&&(t.flags|=64,s=!0,os(r,!1),t.lanes=33554432);r.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=r.last)?n.sibling=l:t.child=l,r.last=l)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Ti(),n.sibling=null,t=Xa.current,gi(Xa,s?1&t|2:1&t),n):null;case 23:case 24:return Bu(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(o(156,t.tag))}function us(e){switch(e.tag){case 1:pi(e.type)&&Ai();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Va(),ci(Ci),ci(Ii),Ja(),0!==(64&(t=e.flags)))throw Error(o(285));return e.flags=-4097&t|64,e;case 5:return Ea(e),null;case 13:return ci(Xa),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return ci(Xa),null;case 4:return Va(),null;case 10:return ra(e),null;case 23:case 24:return Bu(),null;default:return null}}function ls(e,t){try{var n="",r=t;do{n+=P(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i}}function cs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}Oo=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Jo=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Wa(Sa.current);var o,s=null;switch(n){case"input":a=$(e,a),r=$(e,r),s=[];break;case"option":a=ae(e,a),r=ae(e,r),s=[];break;case"select":a=i({},a,{value:void 0}),r=i({},r,{value:void 0}),s=[];break;case"textarea":a=se(e,a),r=se(e,r),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=zr)}for(g in Ge(n,r),n=null,a)if(!r.hasOwnProperty(g)&&a.hasOwnProperty(g)&&null!=a[g])if("style"===g){var l=a[g];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==g&&"children"!==g&&"suppressContentEditableWarning"!==g&&"suppressHydrationWarning"!==g&&"autoFocus"!==g&&(u.hasOwnProperty(g)?s||(s=[]):(s=s||[]).push(g,null));for(g in r){var c=r[g];if(l=null!=a?a[g]:void 0,r.hasOwnProperty(g)&&c!==l&&(null!=c||null!=l))if("style"===g)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(g,n)),n=c;else"dangerouslySetInnerHTML"===g?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(g,c)):"children"===g?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(g,""+c):"suppressContentEditableWarning"!==g&&"suppressHydrationWarning"!==g&&(u.hasOwnProperty(g)?(null!=c&&"onScroll"===g&&Rr("scroll",e),s||l===c||(s=[])):"object"===typeof c&&null!==c&&c.$$typeof===F?c.toString():(s=s||[]).push(g,c))}n&&(s=s||[]).push("style",n);var g=s;(t.updateQueue=g)&&(t.flags|=4)}},Qo=function(e,t,n,r){n!==r&&(t.flags|=4)};var gs="function"===typeof WeakMap?WeakMap:Map;function ds(e,t,n){(n=ca(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Qs||(Qs=!0,js=r),cs(0,t)},n}function Is(e,t,n){(n=ca(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return cs(0,t),r(i)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===qs?qs=new Set([this]):qs.add(this),cs(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var Cs="function"===typeof WeakSet?WeakSet:Set;function hs(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){zu(e,n)}else t.current=null}function fs(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:ji(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&Ur(t.stateNode.containerInfo))}throw Error(o(163))}function ps(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var i=e;r=i.next,0!==(4&(i=i.tag))&&0!==(1&i)&&(Xu(n,e),Eu(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:ji(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&Ca(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}Ca(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Tr(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&yt(n)))))}throw Error(o(163))}function As(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"===typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var i=n.memoizedProps.style;i=void 0!==i&&null!==i&&i.hasOwnProperty("display")?i.display:null,r.style.display=be("display",i)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function ms(e,t){if(Gi&&"function"===typeof Gi.onCommitFiberUnmount)try{Gi.onCommitFiberUnmount(Bi,t)}catch(a){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,i=r.destroy;if(r=r.tag,void 0!==i)if(0!==(4&r))Xu(t,n);else{r=t;try{i()}catch(a){zu(r,a)}}n=n.next}while(n!==e)}break;case 1:if(hs(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(a){zu(t,a)}break;case 5:hs(t);break;case 4:Zs(e,t)}}function vs(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function bs(e){return 5===e.tag||3===e.tag||4===e.tag}function ys(e){e:{for(var t=e.return;null!==t;){if(bs(t))break e;t=t.return}throw Error(o(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(o(161))}16&n.flags&&(Ae(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||bs(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?Bs(e,n,t):Gs(e,n,t)}function Bs(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=zr));else if(4!==r&&null!==(e=e.child))for(Bs(e,t,n),e=e.sibling;null!==e;)Bs(e,t,n),e=e.sibling}function Gs(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(Gs(e,t,n),e=e.sibling;null!==e;)Gs(e,t,n),e=e.sibling}function Zs(e,t){for(var n,r,i=t,a=!1;;){if(!a){a=i.return;e:for(;;){if(null===a)throw Error(o(160));switch(n=a.stateNode,a.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}a=a.return}a=!0}if(5===i.tag||6===i.tag){e:for(var s=e,u=i,l=u;;)if(ms(s,l),null!==l.child&&4!==l.tag)l.child.return=l,l=l.child;else{if(l===u)break e;for(;null===l.sibling;){if(null===l.return||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}r?(s=n,u=i.stateNode,8===s.nodeType?s.parentNode.removeChild(u):s.removeChild(u)):n.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){n=i.stateNode.containerInfo,r=!0,i.child.return=i,i=i.child;continue}}else if(ms(e,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;4===(i=i.return).tag&&(a=!1)}i.sibling.return=i.return,i=i.sibling}}function ws(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3===(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var i=null!==e?e.memoizedProps:r;e=t.type;var a=t.updateQueue;if(t.updateQueue=null,null!==a){for(n[$r]=r,"input"===e&&"radio"===r.type&&null!=r.name&&te(n,r),Ze(e,i),t=Ze(e,r),i=0;i<a.length;i+=2){var s=a[i],u=a[i+1];"style"===s?ye(n,u):"dangerouslySetInnerHTML"===s?pe(n,u):"children"===s?Ae(n,u):v(n,s,u,t)}switch(e){case"input":ne(n,r);break;case"textarea":le(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(a=r.value)?oe(n,!!r.multiple,a,!1):e!==!!r.multiple&&(null!=r.defaultValue?oe(n,!!r.multiple,r.defaultValue,!0):oe(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(o(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,yt(n.containerInfo)));case 13:return null!==t.memoizedState&&(Ds=Ti(),As(t.child,!0)),void _s(t);case 19:return void _s(t);case 23:case 24:return void As(t,null!==t.memoizedState)}throw Error(o(163))}function _s(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Cs),t.forEach((function(t){var r=Yu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function xs(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Ss=Math.ceil,Rs=b.ReactCurrentDispatcher,Ms=b.ReactCurrentOwner,Ws=0,ks=null,Vs=null,Fs=0,Es=0,Xs=li(0),Hs=0,Ls=null,zs=0,Ns=0,Ys=0,Ts=0,Ks=null,Ds=0,Ps=1/0;function Us(){Ps=Ti()+500}var Os,Js=null,Qs=!1,js=null,qs=null,$s=!1,eu=null,tu=90,nu=[],ru=[],iu=null,au=0,ou=null,su=-1,uu=0,lu=0,cu=null,gu=!1;function du(){return 0!==(48&Ws)?Ti():-1!==su?su:su=Ti()}function Iu(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===Ki()?1:2;if(0===uu&&(uu=zs),0!==Qi.transition){0!==lu&&(lu=null!==Ks?Ks.pendingLanes:0),e=uu;var t=4186112&~lu;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=Ki(),0!==(4&Ws)&&98===e?e=zt(12,uu):e=zt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),uu),e}function Cu(e,t,n){if(50<au)throw au=0,ou=null,Error(o(185));if(null===(e=hu(e,t)))return null;Tt(e,t,n),e===ks&&(Ys|=t,4===Hs&&Au(e,Fs));var r=Ki();1===t?0!==(8&Ws)&&0===(48&Ws)?mu(e):(fu(e,n),0===Ws&&(Us(),Oi())):(0===(4&Ws)||98!==r&&99!==r||(null===iu?iu=new Set([e]):iu.add(e)),fu(e,n)),Ks=e}function hu(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function fu(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var u=31-Kt(s),l=1<<u,c=a[u];if(-1===c){if(0===(l&r)||0!==(l&i)){c=t,Xt(l);var g=Et;a[u]=10<=g?c+250:6<=g?c+5e3:-1}}else c<=t&&(e.expiredLanes|=l);s&=~l}if(r=Ht(e,e===ks?Fs:0),t=Et,0===r)null!==n&&(n!==Xi&&_i(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Xi&&_i(n)}15===t?(n=mu.bind(null,e),null===Li?(Li=[n],zi=wi(Wi,Ji)):Li.push(n),n=Xi):14===t?n=Ui(99,mu.bind(null,e)):(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(o(358,e))}}(t),n=Ui(n,pu.bind(null,e))),e.callbackPriority=t,e.callbackNode=n}}function pu(e){if(su=-1,lu=uu=0,0!==(48&Ws))throw Error(o(327));var t=e.callbackNode;if(Fu()&&e.callbackNode!==t)return null;var n=Ht(e,e===ks?Fs:0);if(0===n)return null;var r=n,i=Ws;Ws|=16;var a=wu();for(ks===e&&Fs===r||(Us(),Gu(e,r));;)try{Su();break}catch(u){Zu(e,u)}if(na(),Rs.current=a,Ws=i,null!==Vs?r=0:(ks=null,Fs=0,r=Hs),0!==(zs&Ys))Gu(e,0);else if(0!==r){if(2===r&&(Ws|=64,e.hydrate&&(e.hydrate=!1,Ur(e.containerInfo)),0!==(n=Lt(e))&&(r=_u(e,n))),1===r)throw t=Ls,Gu(e,0),Au(e,n),fu(e,Ti()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(o(345));case 2:case 5:Wu(e);break;case 3:if(Au(e,n),(62914560&n)===n&&10<(r=Ds+500-Ti())){if(0!==Ht(e,0))break;if(((i=e.suspendedLanes)&n)!==n){du(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Dr(Wu.bind(null,e),r);break}Wu(e);break;case 4:if(Au(e,n),(4186112&n)===n)break;for(r=e.eventTimes,i=-1;0<n;){var s=31-Kt(n);a=1<<s,(s=r[s])>i&&(i=s),n&=~a}if(n=i,10<(n=(120>(n=Ti()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ss(n/1960))-n)){e.timeoutHandle=Dr(Wu.bind(null,e),n);break}Wu(e);break;default:throw Error(o(329))}}return fu(e,Ti()),e.callbackNode===t?pu.bind(null,e):null}function Au(e,t){for(t&=~Ts,t&=~Ys,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Kt(t),r=1<<n;e[n]=-1,t&=~r}}function mu(e){if(0!==(48&Ws))throw Error(o(327));if(Fu(),e===ks&&0!==(e.expiredLanes&Fs)){var t=Fs,n=_u(e,t);0!==(zs&Ys)&&(n=_u(e,t=Ht(e,t)))}else n=_u(e,t=Ht(e,0));if(0!==e.tag&&2===n&&(Ws|=64,e.hydrate&&(e.hydrate=!1,Ur(e.containerInfo)),0!==(t=Lt(e))&&(n=_u(e,t))),1===n)throw n=Ls,Gu(e,0),Au(e,t),fu(e,Ti()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Wu(e),fu(e,Ti()),null}function vu(e,t){var n=Ws;Ws|=1;try{return e(t)}finally{0===(Ws=n)&&(Us(),Oi())}}function bu(e,t){var n=Ws;Ws&=-2,Ws|=8;try{return e(t)}finally{0===(Ws=n)&&(Us(),Oi())}}function yu(e,t){gi(Xs,Es),Es|=t,zs|=t}function Bu(){Es=Xs.current,ci(Xs)}function Gu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Pr(n)),null!==Vs)for(n=Vs.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ai();break;case 3:Va(),ci(Ci),ci(Ii),Ja();break;case 5:Ea(r);break;case 4:Va();break;case 13:case 19:ci(Xa);break;case 10:ra(r);break;case 23:case 24:Bu()}n=n.return}ks=e,Vs=Pu(e.current,null),Fs=Es=zs=t,Hs=0,Ls=null,Ts=Ys=Ns=0}function Zu(e,t){for(;;){var n=Vs;try{if(na(),Qa.current=Wo,no){for(var r=$a.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}no=!1}if(qa=0,to=eo=$a=null,ro=!1,Ms.current=null,null===n||null===n.return){Hs=1,Ls=t,Vs=null;break}e:{var a=e,o=n.return,s=n,u=t;if(t=Fs,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==u&&"object"===typeof u&&"function"===typeof u.then){var l=u;if(0===(2&s.mode)){var c=s.alternate;c?(s.updateQueue=c.updateQueue,s.memoizedState=c.memoizedState,s.lanes=c.lanes):(s.updateQueue=null,s.memoizedState=null)}var g=0!==(1&Xa.current),d=o;do{var I;if(I=13===d.tag){var C=d.memoizedState;if(null!==C)I=null!==C.dehydrated;else{var h=d.memoizedProps;I=void 0!==h.fallback&&(!0!==h.unstable_avoidThisFallback||!g)}}if(I){var f=d.updateQueue;if(null===f){var p=new Set;p.add(l),d.updateQueue=p}else f.add(l);if(0===(2&d.mode)){if(d.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var A=ca(-1,1);A.tag=2,ga(s,A)}s.lanes|=1;break e}u=void 0,s=t;var m=a.pingCache;if(null===m?(m=a.pingCache=new gs,u=new Set,m.set(l,u)):void 0===(u=m.get(l))&&(u=new Set,m.set(l,u)),!u.has(s)){u.add(s);var v=Nu.bind(null,a,l,s);l.then(v,v)}d.flags|=4096,d.lanes=t;break e}d=d.return}while(null!==d);u=Error((U(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Hs&&(Hs=2),u=ls(u,s),d=o;do{switch(d.tag){case 3:a=u,d.flags|=4096,t&=-t,d.lanes|=t,da(d,ds(0,a,t));break e;case 1:a=u;var b=d.type,y=d.stateNode;if(0===(64&d.flags)&&("function"===typeof b.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===qs||!qs.has(y)))){d.flags|=4096,t&=-t,d.lanes|=t,da(d,Is(d,a,t));break e}}d=d.return}while(null!==d)}Mu(n)}catch(B){t=B,Vs===n&&null!==n&&(Vs=n=n.return);continue}break}}function wu(){var e=Rs.current;return Rs.current=Wo,null===e?Wo:e}function _u(e,t){var n=Ws;Ws|=16;var r=wu();for(ks===e&&Fs===t||Gu(e,t);;)try{xu();break}catch(i){Zu(e,i)}if(na(),Ws=n,Rs.current=r,null!==Vs)throw Error(o(261));return ks=null,Fs=0,Hs}function xu(){for(;null!==Vs;)Ru(Vs)}function Su(){for(;null!==Vs&&!xi();)Ru(Vs)}function Ru(e){var t=Os(e.alternate,e,Es);e.memoizedProps=e.pendingProps,null===t?Mu(e):Vs=t,Ms.current=null}function Mu(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(n=ss(n,t,Es)))return void(Vs=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&Es)||0===(4&n.mode)){for(var r=0,i=n.child;null!==i;)r|=i.lanes|i.childLanes,i=i.sibling;n.childLanes=r}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=us(t)))return n.flags&=2047,void(Vs=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(Vs=t);Vs=t=e}while(null!==t);0===Hs&&(Hs=5)}function Wu(e){var t=Ki();return Pi(99,ku.bind(null,e,t)),null}function ku(e,t){do{Fu()}while(null!==eu);if(0!==(48&Ws))throw Error(o(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null;var r=n.lanes|n.childLanes,i=r,a=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;for(var s=e.eventTimes,u=e.expirationTimes;0<a;){var l=31-Kt(a),c=1<<l;i[l]=0,s[l]=-1,u[l]=-1,a&=~c}if(null!==iu&&0===(24&r)&&iu.has(e)&&iu.delete(e),e===ks&&(Vs=ks=null,Fs=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(i=Ws,Ws|=32,Ms.current=null,Nr=Jt,pr(s=fr())){if("selectionStart"in s)u={start:s.selectionStart,end:s.selectionEnd};else e:if(u=(u=s.ownerDocument)&&u.defaultView||window,(c=u.getSelection&&u.getSelection())&&0!==c.rangeCount){u=c.anchorNode,a=c.anchorOffset,l=c.focusNode,c=c.focusOffset;try{u.nodeType,l.nodeType}catch(w){u=null;break e}var g=0,d=-1,I=-1,C=0,h=0,f=s,p=null;t:for(;;){for(var A;f!==u||0!==a&&3!==f.nodeType||(d=g+a),f!==l||0!==c&&3!==f.nodeType||(I=g+c),3===f.nodeType&&(g+=f.nodeValue.length),null!==(A=f.firstChild);)p=f,f=A;for(;;){if(f===s)break t;if(p===u&&++C===a&&(d=g),p===l&&++h===c&&(I=g),null!==(A=f.nextSibling))break;p=(f=p).parentNode}f=A}u=-1===d||-1===I?null:{start:d,end:I}}else u=null;u=u||{start:0,end:0}}else u=null;Yr={focusedElem:s,selectionRange:u},Jt=!1,cu=null,gu=!1,Js=r;do{try{Vu()}catch(w){if(null===Js)throw Error(o(330));zu(Js,w),Js=Js.nextEffect}}while(null!==Js);cu=null,Js=r;do{try{for(s=e;null!==Js;){var m=Js.flags;if(16&m&&Ae(Js.stateNode,""),128&m){var v=Js.alternate;if(null!==v){var b=v.ref;null!==b&&("function"===typeof b?b(null):b.current=null)}}switch(1038&m){case 2:ys(Js),Js.flags&=-3;break;case 6:ys(Js),Js.flags&=-3,ws(Js.alternate,Js);break;case 1024:Js.flags&=-1025;break;case 1028:Js.flags&=-1025,ws(Js.alternate,Js);break;case 4:ws(Js.alternate,Js);break;case 8:Zs(s,u=Js);var y=u.alternate;vs(u),null!==y&&vs(y)}Js=Js.nextEffect}}catch(w){if(null===Js)throw Error(o(330));zu(Js,w),Js=Js.nextEffect}}while(null!==Js);if(b=Yr,v=fr(),m=b.focusedElem,s=b.selectionRange,v!==m&&m&&m.ownerDocument&&hr(m.ownerDocument.documentElement,m)){null!==s&&pr(m)&&(v=s.start,void 0===(b=s.end)&&(b=v),"selectionStart"in m?(m.selectionStart=v,m.selectionEnd=Math.min(b,m.value.length)):(b=(v=m.ownerDocument||document)&&v.defaultView||window).getSelection&&(b=b.getSelection(),u=m.textContent.length,y=Math.min(s.start,u),s=void 0===s.end?y:Math.min(s.end,u),!b.extend&&y>s&&(u=s,s=y,y=u),u=Cr(m,y),a=Cr(m,s),u&&a&&(1!==b.rangeCount||b.anchorNode!==u.node||b.anchorOffset!==u.offset||b.focusNode!==a.node||b.focusOffset!==a.offset)&&((v=v.createRange()).setStart(u.node,u.offset),b.removeAllRanges(),y>s?(b.addRange(v),b.extend(a.node,a.offset)):(v.setEnd(a.node,a.offset),b.addRange(v))))),v=[];for(b=m;b=b.parentNode;)1===b.nodeType&&v.push({element:b,left:b.scrollLeft,top:b.scrollTop});for("function"===typeof m.focus&&m.focus(),m=0;m<v.length;m++)(b=v[m]).element.scrollLeft=b.left,b.element.scrollTop=b.top}Jt=!!Nr,Yr=Nr=null,e.current=n,Js=r;do{try{for(m=e;null!==Js;){var B=Js.flags;if(36&B&&ps(m,Js.alternate,Js),128&B){v=void 0;var G=Js.ref;if(null!==G){var Z=Js.stateNode;Js.tag,v=Z,"function"===typeof G?G(v):G.current=v}}Js=Js.nextEffect}}catch(w){if(null===Js)throw Error(o(330));zu(Js,w),Js=Js.nextEffect}}while(null!==Js);Js=null,Hi(),Ws=i}else e.current=n;if($s)$s=!1,eu=e,tu=t;else for(Js=r;null!==Js;)t=Js.nextEffect,Js.nextEffect=null,8&Js.flags&&((B=Js).sibling=null,B.stateNode=null),Js=t;if(0===(r=e.pendingLanes)&&(qs=null),1===r?e===ou?au++:(au=0,ou=e):au=0,n=n.stateNode,Gi&&"function"===typeof Gi.onCommitFiberRoot)try{Gi.onCommitFiberRoot(Bi,n,void 0,64===(64&n.current.flags))}catch(w){}if(fu(e,Ti()),Qs)throw Qs=!1,e=js,js=null,e;return 0!==(8&Ws)||Oi(),null}function Vu(){for(;null!==Js;){var e=Js.alternate;gu||null===cu||(0!==(8&Js.flags)?et(Js,cu)&&(gu=!0):13===Js.tag&&xs(e,Js)&&et(Js,cu)&&(gu=!0));var t=Js.flags;0!==(256&t)&&fs(e,Js),0===(512&t)||$s||($s=!0,Ui(97,(function(){return Fu(),null}))),Js=Js.nextEffect}}function Fu(){if(90!==tu){var e=97<tu?97:tu;return tu=90,Pi(e,Hu)}return!1}function Eu(e,t){nu.push(t,e),$s||($s=!0,Ui(97,(function(){return Fu(),null})))}function Xu(e,t){ru.push(t,e),$s||($s=!0,Ui(97,(function(){return Fu(),null})))}function Hu(){if(null===eu)return!1;var e=eu;if(eu=null,0!==(48&Ws))throw Error(o(331));var t=Ws;Ws|=32;var n=ru;ru=[];for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1],s=i.destroy;if(i.destroy=void 0,"function"===typeof s)try{s()}catch(l){if(null===a)throw Error(o(330));zu(a,l)}}for(n=nu,nu=[],r=0;r<n.length;r+=2){i=n[r],a=n[r+1];try{var u=i.create;i.destroy=u()}catch(l){if(null===a)throw Error(o(330));zu(a,l)}}for(u=e.current.firstEffect;null!==u;)e=u.nextEffect,u.nextEffect=null,8&u.flags&&(u.sibling=null,u.stateNode=null),u=e;return Ws=t,Oi(),!0}function Lu(e,t,n){ga(e,t=ds(0,t=ls(n,t),1)),t=du(),null!==(e=hu(e,1))&&(Tt(e,1,t),fu(e,t))}function zu(e,t){if(3===e.tag)Lu(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Lu(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===qs||!qs.has(r))){var i=Is(n,e=ls(t,e),1);if(ga(n,i),i=du(),null!==(n=hu(n,1)))Tt(n,1,i),fu(n,i);else if("function"===typeof r.componentDidCatch&&(null===qs||!qs.has(r)))try{r.componentDidCatch(t,e)}catch(a){}break}}n=n.return}}function Nu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=du(),e.pingedLanes|=e.suspendedLanes&n,ks===e&&(Fs&n)===n&&(4===Hs||3===Hs&&(62914560&Fs)===Fs&&500>Ti()-Ds?Gu(e,0):Ts|=n),fu(e,t)}function Yu(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===Ki()?1:2:(0===uu&&(uu=zs),0===(t=Nt(62914560&~uu))&&(t=4194304))),n=du(),null!==(e=hu(e,t))&&(Tt(e,t,n),fu(e,n))}function Tu(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Ku(e,t,n,r){return new Tu(e,t,n,r)}function Du(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pu(e,t){var n=e.alternate;return null===n?((n=Ku(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Uu(e,t,n,r,i,a){var s=2;if(r=e,"function"===typeof e)Du(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case G:return Ou(n.children,i,a,t);case E:s=8,i|=16;break;case Z:s=8,i|=1;break;case w:return(e=Ku(12,n,t,8|i)).elementType=w,e.type=w,e.lanes=a,e;case R:return(e=Ku(13,n,t,i)).type=R,e.elementType=R,e.lanes=a,e;case M:return(e=Ku(19,n,t,i)).elementType=M,e.lanes=a,e;case X:return Ju(n,i,a,t);case H:return(e=Ku(24,n,t,i)).elementType=H,e.lanes=a,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case _:s=10;break e;case x:s=9;break e;case S:s=11;break e;case W:s=14;break e;case k:s=16,r=null;break e;case V:s=22;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Ku(s,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Ou(e,t,n,r){return(e=Ku(7,e,r,t)).lanes=n,e}function Ju(e,t,n,r){return(e=Ku(23,e,r,t)).elementType=X,e.lanes=n,e}function Qu(e,t,n){return(e=Ku(6,e,null,t)).lanes=n,e}function ju(e,t,n){return(t=Ku(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qu(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Yt(0),this.expirationTimes=Yt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yt(0),this.mutableSourceEagerHydrationData=null}function $u(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:B,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function el(e,t,n,r){var i=t.current,a=du(),s=Iu(i);e:if(n){t:{if(Qe(n=n._reactInternals)!==n||1!==n.tag)throw Error(o(170));var u=n;do{switch(u.tag){case 3:u=u.stateNode.context;break t;case 1:if(pi(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break t}}u=u.return}while(null!==u);throw Error(o(171))}if(1===n.tag){var l=n.type;if(pi(l)){n=vi(n,l,u);break e}}n=u}else n=di;return null===t.context?t.context=n:t.pendingContext=n,(t=ca(a,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),ga(i,t),Cu(i,s,a),s}function tl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function nl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function rl(e,t){nl(e,t),(e=e.alternate)&&nl(e,t)}function il(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new qu(e,t,null!=n&&!0===n.hydrate),t=Ku(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,ua(t),e[ei]=n.current,Wr(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var i=(t=r[e])._getVersion;i=i(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,i]:n.mutableSourceEagerHydrationData.push(t,i)}this._internalRoot=n}function al(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ol(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a._internalRoot;if("function"===typeof i){var s=i;i=function(){var e=tl(o);s.call(e)}}el(t,o,e,i)}else{if(a=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new il(e,0,t?{hydrate:!0}:void 0)}(n,r),o=a._internalRoot,"function"===typeof i){var u=i;i=function(){var e=tl(o);u.call(e)}}bu((function(){el(t,o,e,i)}))}return tl(o)}function sl(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!al(t))throw Error(o(200));return $u(e,t,null,n)}Os=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||Ci.current)Xo=!0;else{if(0===(n&r)){switch(Xo=!1,t.tag){case 3:Uo(t),Ua();break;case 5:Fa(t);break;case 1:pi(t.type)&&bi(t);break;case 4:ka(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var i=t.type._context;gi(qi,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?qo(e,t,n):(gi(Xa,1&Xa.current),null!==(t=as(e,t,n))?t.sibling:null);gi(Xa,1&Xa.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(64&e.flags)){if(r)return is(e,t,n);t.flags|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),gi(Xa,Xa.current),r)break;return null;case 23:case 24:return t.lanes=0,Yo(e,t,n)}return as(e,t,n)}Xo=0!==(16384&e.flags)}else Xo=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=fi(t,Ii.current),aa(t,n),i=oo(null,t,r,e,i,n),t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,pi(r)){var a=!0;bi(t)}else a=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,ua(t);var s=r.getDerivedStateFromProps;"function"===typeof s&&fa(t,r,s,e),i.updater=pa,t.stateNode=i,i._reactInternals=t,ba(t,r,e,n),t=Po(null,t,r,!0,a,n)}else t.tag=0,Ho(null,t,i,n),t=t.child;return t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(a=i._init)(i._payload),t.type=i,a=t.tag=function(e){if("function"===typeof e)return Du(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===S)return 11;if(e===W)return 14}return 2}(i),e=ji(i,e),a){case 0:t=Ko(null,t,i,e,n);break e;case 1:t=Do(null,t,i,e,n);break e;case 11:t=Lo(null,t,i,e,n);break e;case 14:t=zo(null,t,i,ji(i.type,e),r,n);break e}throw Error(o(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ko(e,t,r,i=t.elementType===r?i:ji(r,i),n);case 1:return r=t.type,i=t.pendingProps,Do(e,t,r,i=t.elementType===r?i:ji(r,i),n);case 3:if(Uo(t),r=t.updateQueue,null===e||null===r)throw Error(o(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,la(e,t),Ia(t,r,null,n),(r=t.memoizedState.element)===i)Ua(),t=as(e,t,n);else{if((a=(i=t.stateNode).hydrate)&&(za=Or(t.stateNode.containerInfo.firstChild),La=t,a=Na=!0),a){if(null!=(e=i.mutableSourceEagerHydrationData))for(i=0;i<e.length;i+=2)(a=e[i])._workInProgressVersionPrimary=e[i+1],Oa.push(a);for(n=_a(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Ho(e,t,r,n),Ua();t=t.child}return t;case 5:return Fa(t),null===e&&Ka(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,s=i.children,Kr(r,i)?s=null:null!==a&&Kr(r,a)&&(t.flags|=16),To(e,t),Ho(e,t,s,n),t.child;case 6:return null===e&&Ka(t),null;case 13:return qo(e,t,n);case 4:return ka(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wa(t,null,r,n):Ho(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Lo(e,t,r,i=t.elementType===r?i:ji(r,i),n);case 7:return Ho(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ho(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value;var u=t.type._context;if(gi(qi,u._currentValue),u._currentValue=a,null!==s)if(u=s.value,0===(a=cr(u,a)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(u,a):1073741823))){if(s.children===i.children&&!Ci.current){t=as(e,t,n);break e}}else for(null!==(u=t.child)&&(u.return=t);null!==u;){var l=u.dependencies;if(null!==l){s=u.child;for(var c=l.firstContext;null!==c;){if(c.context===r&&0!==(c.observedBits&a)){1===u.tag&&((c=ca(-1,n&-n)).tag=2,ga(u,c)),u.lanes|=n,null!==(c=u.alternate)&&(c.lanes|=n),ia(u.return,n),l.lanes|=n;break}c=c.next}}else s=10===u.tag&&u.type===t.type?null:u.child;if(null!==s)s.return=u;else for(s=u;null!==s;){if(s===t){s=null;break}if(null!==(u=s.sibling)){u.return=s.return,s=u;break}s=s.return}u=s}Ho(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(a=t.pendingProps).children,aa(t,n),r=r(i=oa(i,a.unstable_observedBits)),t.flags|=1,Ho(e,t,r,n),t.child;case 14:return a=ji(i=t.type,t.pendingProps),zo(e,t,i,a=ji(i.type,a),r,n);case 15:return No(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ji(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,pi(r)?(e=!0,bi(t)):e=!1,aa(t,n),ma(t,r,i),ba(t,r,i,n),Po(null,t,r,!0,e,n);case 19:return is(e,t,n);case 23:case 24:return Yo(e,t,n)}throw Error(o(156,t.tag))},il.prototype.render=function(e){el(e,this._internalRoot,null,null)},il.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;el(null,e,null,(function(){t[ei]=null}))},tt=function(e){13===e.tag&&(Cu(e,4,du()),rl(e,4))},nt=function(e){13===e.tag&&(Cu(e,67108864,du()),rl(e,67108864))},rt=function(e){if(13===e.tag){var t=du(),n=Iu(e);Cu(e,n,t),rl(e,n)}},it=function(e,t){return t()},_e=function(e,t,n){switch(t){case"input":if(ne(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=ai(r);if(!i)throw Error(o(90));j(r),ne(r,i)}}}break;case"textarea":le(e,n);break;case"select":null!=(t=n.value)&&oe(e,!!n.multiple,t,!1)}},ke=vu,Ve=function(e,t,n,r,i){var a=Ws;Ws|=4;try{return Pi(98,e.bind(null,t,n,r,i))}finally{0===(Ws=a)&&(Us(),Oi())}},Fe=function(){0===(49&Ws)&&(function(){if(null!==iu){var e=iu;iu=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,fu(e,Ti())}))}Oi()}(),Fu())},Ee=function(e,t){var n=Ws;Ws|=2;try{return e(t)}finally{0===(Ws=n)&&(Us(),Oi())}};var ul={Events:[ri,ii,ai,Me,We,Fu,{current:!1}]},ll={findFiberByHostInstance:ni,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},cl={bundleType:ll.bundleType,version:ll.version,rendererPackageName:ll.rendererPackageName,rendererConfig:ll.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=$e(e))?null:e.stateNode},findFiberByHostInstance:ll.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var gl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gl.isDisabled&&gl.supportsFiber)try{Bi=gl.inject(cl),Gi=gl}catch(fe){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ul,t.createPortal=sl,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw Error(o(268,Object.keys(e)))}return e=null===(e=$e(t))?null:e.stateNode},t.flushSync=function(e,t){var n=Ws;if(0!==(48&n))return e(t);Ws|=1;try{if(e)return Pi(99,e.bind(null,t))}finally{Ws=n,Oi()}},t.hydrate=function(e,t,n){if(!al(t))throw Error(o(200));return ol(null,e,t,!0,n)},t.render=function(e,t,n){if(!al(t))throw Error(o(200));return ol(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!al(e))throw Error(o(40));return!!e._reactRootContainer&&(bu((function(){ol(null,null,e,!1,(function(){e._reactRootContainer=null,e[ei]=null}))})),!0)},t.unstable_batchedUpdates=vu,t.unstable_createPortal=function(e,t){return sl(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!al(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return ol(e,t,n,!1,r)},t.version="17.0.2"},4453:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(1571)},936:function(e,t,n){"use strict";n.r(t),t.default=function(e){return function(t){e.forEach((function(e){"function"===typeof e?e(t):null!=e&&(e.current=t)}))}}},1614:function(e,t,n){(e=n.nmd(e)).exports=function(t){var r={},i=n(8105),a=n(4519),o=n(8514);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=60103,c=60106,g=60107,d=60108,I=60114,C=60109,h=60110,f=60112,p=60113,A=60120,m=60115,v=60116,b=60121,y=60129,B=60130,G=60131;if("function"===typeof Symbol&&Symbol.for){var Z=Symbol.for;l=Z("react.element"),c=Z("react.portal"),g=Z("react.fragment"),d=Z("react.strict_mode"),I=Z("react.profiler"),C=Z("react.provider"),h=Z("react.context"),f=Z("react.forward_ref"),p=Z("react.suspense"),A=Z("react.suspense_list"),m=Z("react.memo"),v=Z("react.lazy"),b=Z("react.block"),Z("react.scope"),y=Z("react.debug_trace_mode"),B=Z("react.offscreen"),G=Z("react.legacy_hidden")}var w="function"===typeof Symbol&&Symbol.iterator;function _(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=w&&e[w]||e["@@iterator"])?e:null}function x(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case c:return"Portal";case I:return"Profiler";case d:return"StrictMode";case p:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case h:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case f:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case m:return x(e.type);case b:return x(e._render);case v:t=e._payload,e=e._init;try{return x(e(t))}catch(n){}}return null}function S(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function R(e){if(S(e)!==e)throw Error(s(188))}function M(e){var t=e.alternate;if(!t){if(null===(t=S(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return R(i),e;if(a===r)return R(i),t;a=a.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,u=i.child;u;){if(u===n){o=!0,n=i,r=a;break}if(u===r){o=!0,r=i,n=a;break}u=u.sibling}if(!o){for(u=a.child;u;){if(u===n){o=!0,n=a,r=i;break}if(u===r){o=!0,r=a,n=i;break}u=u.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}function W(e){if(!(e=M(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function k(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var V,F=t.getPublicInstance,E=t.getRootHostContext,X=t.getChildHostContext,H=t.prepareForCommit,L=t.resetAfterCommit,z=t.createInstance,N=t.appendInitialChild,Y=t.finalizeInitialChildren,T=t.prepareUpdate,K=t.shouldSetTextContent,D=t.createTextInstance,P=t.scheduleTimeout,U=t.cancelTimeout,O=t.noTimeout,J=t.isPrimaryRenderer,Q=t.supportsMutation,j=t.supportsPersistence,q=t.supportsHydration,$=t.getInstanceFromNode,ee=t.makeOpaqueHydratingObject,te=t.makeClientId,ne=t.beforeActiveInstanceBlur,re=t.afterActiveInstanceBlur,ie=t.preparePortalMount,ae=t.supportsTestSelectors,oe=t.findFiberRoot,se=t.getBoundingRect,ue=t.getTextContent,le=t.isHiddenSubtree,ce=t.matchAccessibilityRole,ge=t.setFocusIfFocusable,de=t.setupIntersectionObserver,Ie=t.appendChild,Ce=t.appendChildToContainer,he=t.commitTextUpdate,fe=t.commitMount,pe=t.commitUpdate,Ae=t.insertBefore,me=t.insertInContainerBefore,ve=t.removeChild,be=t.removeChildFromContainer,ye=t.resetTextContent,Be=t.hideInstance,Ge=t.hideTextInstance,Ze=t.unhideInstance,we=t.unhideTextInstance,_e=t.clearContainer,xe=t.cloneInstance,Se=t.createContainerChildSet,Re=t.appendChildToContainerChildSet,Me=t.finalizeContainerChildren,We=t.replaceContainerChildren,ke=t.cloneHiddenInstance,Ve=t.cloneHiddenTextInstance,Fe=t.canHydrateInstance,Ee=t.canHydrateTextInstance,Xe=t.isSuspenseInstancePending,He=t.isSuspenseInstanceFallback,Le=t.getNextHydratableSibling,ze=t.getFirstHydratableChild,Ne=t.hydrateInstance,Ye=t.hydrateTextInstance,Te=t.getNextHydratableInstanceAfterSuspenseInstance,Ke=t.commitHydratedContainer,De=t.commitHydratedSuspenseInstance;function Pe(e){if(void 0===V)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);V=t&&t[1]||""}return"\n"+V+e}var Ue=!1;function Oe(e,t){if(!e||Ue)return"";Ue=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var i=u.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s])return"\n"+i[o].replace(" at new "," at ")}while(1<=o&&0<=s);break}}}finally{Ue=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Pe(e):""}var Je=[],Qe=-1;function je(e){return{current:e}}function qe(e){0>Qe||(e.current=Je[Qe],Je[Qe]=null,Qe--)}function $e(e,t){Qe++,Je[Qe]=e.current,e.current=t}var et={},tt=je(et),nt=je(!1),rt=et;function it(e,t){var n=e.type.contextTypes;if(!n)return et;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function at(e){return null!==(e=e.childContextTypes)&&void 0!==e}function ot(){qe(nt),qe(tt)}function st(e,t,n){if(tt.current!==et)throw Error(s(168));$e(tt,t),$e(nt,n)}function ut(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in e))throw Error(s(108,x(t)||"Unknown",a));return i({},n,r)}function lt(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||et,rt=tt.current,$e(tt,e),$e(nt,nt.current),!0}function ct(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=ut(e,t,rt),r.__reactInternalMemoizedMergedChildContext=e,qe(nt),qe(tt),$e(tt,e)):qe(nt),$e(nt,n)}var gt=null,dt=null;(0,o.unstable_now)();var It=0,Ct=8;function ht(e){if(0!==(1&e))return Ct=15,1;if(0!==(2&e))return Ct=14,2;if(0!==(4&e))return Ct=13,4;var t=24&e;return 0!==t?(Ct=12,t):0!==(32&e)?(Ct=11,32):0!==(t=192&e)?(Ct=10,t):0!==(256&e)?(Ct=9,256):0!==(t=3584&e)?(Ct=8,t):0!==(4096&e)?(Ct=7,4096):0!==(t=4186112&e)?(Ct=6,t):0!==(t=62914560&e)?(Ct=5,t):67108864&e?(Ct=4,67108864):0!==(134217728&e)?(Ct=3,134217728):0!==(t=805306368&e)?(Ct=2,t):0!==(1073741824&e)?(Ct=1,1073741824):(Ct=8,e)}function ft(e,t){var n=e.pendingLanes;if(0===n)return Ct=0;var r=0,i=0,a=e.expiredLanes,o=e.suspendedLanes,s=e.pingedLanes;if(0!==a)r=a,i=Ct=15;else if(0!==(a=134217727&n)){var u=a&~o;0!==u?(r=ht(u),i=Ct):0!==(s&=a)&&(r=ht(s),i=Ct)}else 0!==(a=n&~o)?(r=ht(a),i=Ct):0!==s&&(r=ht(s),i=Ct);if(0===r)return 0;if(r=n&((0>(r=31-yt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&o)){if(ht(t),i<=Ct)return t;Ct=i}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-yt(t)),r|=e[n],t&=~i;return r}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function At(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=mt(24&~t))?At(10,t):e;case 10:return 0===(e=mt(192&~t))?At(8,t):e;case 8:return 0===(e=mt(3584&~t))&&(0===(e=mt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=mt(805306368&~t))&&(t=268435456),t}throw Error(s(358,e))}function mt(e){return e&-e}function vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function bt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-yt(t)]=n}var yt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Bt(e)/Gt|0)|0},Bt=Math.log,Gt=Math.LN2;var Zt=o.unstable_runWithPriority,wt=o.unstable_scheduleCallback,_t=o.unstable_cancelCallback,xt=o.unstable_shouldYield,St=o.unstable_requestPaint,Rt=o.unstable_now,Mt=o.unstable_getCurrentPriorityLevel,Wt=o.unstable_ImmediatePriority,kt=o.unstable_UserBlockingPriority,Vt=o.unstable_NormalPriority,Ft=o.unstable_LowPriority,Et=o.unstable_IdlePriority,Xt={},Ht=void 0!==St?St:function(){},Lt=null,zt=null,Nt=!1,Yt=Rt(),Tt=1e4>Yt?Rt:function(){return Rt()-Yt};function Kt(){switch(Mt()){case Wt:return 99;case kt:return 98;case Vt:return 97;case Ft:return 96;case Et:return 95;default:throw Error(s(332))}}function Dt(e){switch(e){case 99:return Wt;case 98:return kt;case 97:return Vt;case 96:return Ft;case 95:return Et;default:throw Error(s(332))}}function Pt(e,t){return e=Dt(e),Zt(e,t)}function Ut(e,t,n){return e=Dt(e),wt(e,t,n)}function Ot(){if(null!==zt){var e=zt;zt=null,_t(e)}Jt()}function Jt(){if(!Nt&&null!==Lt){Nt=!0;var e=0;try{var t=Lt;Pt(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Lt=null}catch(n){throw null!==Lt&&(Lt=Lt.slice(e+1)),wt(Wt,Ot),n}finally{Nt=!1}}}var Qt=u.ReactCurrentBatchConfig;var jt="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},qt=Object.prototype.hasOwnProperty;function $t(e,t){if(jt(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!qt.call(t,n[r])||!jt(e[n[r]],t[n[r]]))return!1;return!0}function en(e){switch(e.tag){case 5:return Pe(e.type);case 16:return Pe("Lazy");case 13:return Pe("Suspense");case 19:return Pe("SuspenseList");case 0:case 2:case 15:return e=Oe(e.type,!1);case 11:return e=Oe(e.type.render,!1);case 22:return e=Oe(e.type._render,!1);case 1:return e=Oe(e.type,!0);default:return""}}function tn(e,t){if(e&&e.defaultProps){for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var nn=je(null),rn=null,an=null,on=null;function sn(){on=an=rn=null}function un(e,t){e=e.type._context,J?($e(nn,e._currentValue),e._currentValue=t):($e(nn,e._currentValue2),e._currentValue2=t)}function ln(e){var t=nn.current;qe(nn),e=e.type._context,J?e._currentValue=t:e._currentValue2=t}function cn(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function gn(e,t){rn=e,on=an=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Yr=!0),e.firstContext=null)}function dn(e,t){if(on!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(on=e,t=1073741823),t={context:e,observedBits:t,next:null},null===an){if(null===rn)throw Error(s(308));an=t,rn.dependencies={lanes:0,firstContext:t,responders:null}}else an=an.next=t;return J?e._currentValue:e._currentValue2}var In=!1;function Cn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function hn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function pn(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function An(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function mn(e,t,n,r){var a=e.updateQueue;In=!1;var o=a.firstBaseUpdate,s=a.lastBaseUpdate,u=a.shared.pending;if(null!==u){a.shared.pending=null;var l=u,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var g=e.alternate;if(null!==g){var d=(g=g.updateQueue).lastBaseUpdate;d!==s&&(null===d?g.firstBaseUpdate=c:d.next=c,g.lastBaseUpdate=l)}}if(null!==o){for(d=a.baseState,s=0,g=c=l=null;;){u=o.lane;var I=o.eventTime;if((r&u)===u){null!==g&&(g=g.next={eventTime:I,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var C=e,h=o;switch(u=t,I=n,h.tag){case 1:if("function"===typeof(C=h.payload)){d=C.call(I,d,u);break e}d=C;break e;case 3:C.flags=-4097&C.flags|64;case 0:if(null===(u="function"===typeof(C=h.payload)?C.call(I,d,u):C)||void 0===u)break e;d=i({},d,u);break e;case 2:In=!0}}null!==o.callback&&(e.flags|=32,null===(u=a.effects)?a.effects=[o]:u.push(o))}else I={eventTime:I,lane:u,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===g?(c=g=I,l=d):g=g.next=I,s|=u;if(null===(o=o.next)){if(null===(u=a.shared.pending))break;o=u.next,u.next=null,a.lastBaseUpdate=u,a.shared.pending=null}}null===g&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=g,ga|=s,e.lanes=s,e.memoizedState=d}}function vn(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var bn=(new a.Component).refs;function yn(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:i({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Bn={isMounted:function(e){return!!(e=e._reactInternals)&&S(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ea(),i=Xa(e),a=fn(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),pn(e,a),Ha(e,i,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ea(),i=Xa(e),a=fn(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),pn(e,a),Ha(e,i,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ea(),r=Xa(e),i=fn(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),pn(e,i),Ha(e,r,n)}};function Gn(e,t,n,r,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!$t(n,r)||!$t(i,a))}function Zn(e,t,n){var r=!1,i=et,a=t.contextType;return"object"===typeof a&&null!==a?a=dn(a):(i=at(t)?rt:tt.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?it(e,i):et),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Bn,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function wn(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Bn.enqueueReplaceState(t,t.state,null)}function _n(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=bn,Cn(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=dn(a):(a=at(t)?rt:tt.current,i.context=it(e,a)),mn(e,n,i,r),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(yn(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Bn.enqueueReplaceState(i,i.state,null),mn(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4)}var xn=Array.isArray;function Sn(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;t===bn&&(t=r.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Rn(e,t){if("textarea"!==e.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Mn(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Go(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function o(t){return e&&null===t.alternate&&(t.flags=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=xo(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=Sn(e,t,n),r.return=e,r):((r=Zo(n.type,n.key,n.props,null,e.mode,r)).ref=Sn(e,t,n),r.return=e,r)}function I(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=So(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function C(e,t,n,r,a){return null===t||7!==t.tag?((t=wo(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=xo(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case l:return(n=Zo(t.type,t.key,t.props,null,e.mode,n)).ref=Sn(e,null,t),n.return=e,n;case c:return(t=So(t,e.mode,n)).return=e,t}if(xn(t)||_(t))return(t=wo(t,e.mode,n,null)).return=e,t;Rn(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case l:return n.key===i?n.type===g?C(e,t,n.props.children,r,i):d(e,t,n,r):null;case c:return n.key===i?I(e,t,n,r):null}if(xn(n)||_(n))return null!==i?null:C(e,t,n,r,null);Rn(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case l:return e=e.get(null===r.key?n:r.key)||null,r.type===g?C(t,e,r.props.children,i,r.key):d(t,e,r,i);case c:return I(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(xn(r)||_(r))return C(t,e=e.get(n)||null,r,i,null);Rn(t,r)}return null}function A(i,o,s,u){for(var l=null,c=null,g=o,d=o=0,I=null;null!==g&&d<s.length;d++){g.index>d?(I=g,g=null):I=g.sibling;var C=f(i,g,s[d],u);if(null===C){null===g&&(g=I);break}e&&g&&null===C.alternate&&t(i,g),o=a(C,o,d),null===c?l=C:c.sibling=C,c=C,g=I}if(d===s.length)return n(i,g),l;if(null===g){for(;d<s.length;d++)null!==(g=h(i,s[d],u))&&(o=a(g,o,d),null===c?l=g:c.sibling=g,c=g);return l}for(g=r(i,g);d<s.length;d++)null!==(I=p(g,i,d,s[d],u))&&(e&&null!==I.alternate&&g.delete(null===I.key?d:I.key),o=a(I,o,d),null===c?l=I:c.sibling=I,c=I);return e&&g.forEach((function(e){return t(i,e)})),l}function m(i,o,u,l){var c=_(u);if("function"!==typeof c)throw Error(s(150));if(null==(u=c.call(u)))throw Error(s(151));for(var g=c=null,d=o,I=o=0,C=null,A=u.next();null!==d&&!A.done;I++,A=u.next()){d.index>I?(C=d,d=null):C=d.sibling;var m=f(i,d,A.value,l);if(null===m){null===d&&(d=C);break}e&&d&&null===m.alternate&&t(i,d),o=a(m,o,I),null===g?c=m:g.sibling=m,g=m,d=C}if(A.done)return n(i,d),c;if(null===d){for(;!A.done;I++,A=u.next())null!==(A=h(i,A.value,l))&&(o=a(A,o,I),null===g?c=A:g.sibling=A,g=A);return c}for(d=r(i,d);!A.done;I++,A=u.next())null!==(A=p(d,i,I,A.value,l))&&(e&&null!==A.alternate&&d.delete(null===A.key?I:A.key),o=a(A,o,I),null===g?c=A:g.sibling=A,g=A);return e&&d.forEach((function(e){return t(i,e)})),c}return function(e,r,a,u){var d="object"===typeof a&&null!==a&&a.type===g&&null===a.key;d&&(a=a.props.children);var I="object"===typeof a&&null!==a;if(I)switch(a.$$typeof){case l:e:{for(I=a.key,d=r;null!==d;){if(d.key===I){if(7===d.tag){if(a.type===g){n(e,d.sibling),(r=i(d,a.props.children)).return=e,e=r;break e}}else if(d.elementType===a.type){n(e,d.sibling),(r=i(d,a.props)).ref=Sn(e,d,a),r.return=e,e=r;break e}n(e,d);break}t(e,d),d=d.sibling}a.type===g?((r=wo(a.props.children,e.mode,u,a.key)).return=e,e=r):((u=Zo(a.type,a.key,a.props,null,e.mode,u)).ref=Sn(e,r,a),u.return=e,e=u)}return o(e);case c:e:{for(d=a.key;null!==r;){if(r.key===d){if(4===r.tag&&r.stateNode.containerInfo===a.containerInfo&&r.stateNode.implementation===a.implementation){n(e,r.sibling),(r=i(r,a.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=So(a,e.mode,u)).return=e,e=r}return o(e)}if("string"===typeof a||"number"===typeof a)return a=""+a,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,a)).return=e,e=r):(n(e,r),(r=xo(a,e.mode,u)).return=e,e=r),o(e);if(xn(a))return A(e,r,a,u);if(_(a))return m(e,r,a,u);if(I&&Rn(e,a),"undefined"===typeof a&&!d)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(s(152,x(e.type)||"Component"))}return n(e,r)}}var Wn=Mn(!0),kn=Mn(!1),Vn={},Fn=je(Vn),En=je(Vn),Xn=je(Vn);function Hn(e){if(e===Vn)throw Error(s(174));return e}function Ln(e,t){$e(Xn,t),$e(En,e),$e(Fn,Vn),e=E(t),qe(Fn),$e(Fn,e)}function zn(){qe(Fn),qe(En),qe(Xn)}function Nn(e){var t=Hn(Xn.current),n=Hn(Fn.current);n!==(t=X(n,e.type,t))&&($e(En,e),$e(Fn,t))}function Yn(e){En.current===e&&(qe(Fn),qe(En))}var Tn=je(0);function Kn(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Xe(n)||He(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Dn=null,Pn=null,Un=!1;function On(e,t){var n=yo(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Jn(e,t){switch(e.tag){case 5:return null!==(t=Fe(t,e.type,e.pendingProps))&&(e.stateNode=t,!0);case 6:return null!==(t=Ee(t,e.pendingProps))&&(e.stateNode=t,!0);default:return!1}}function Qn(e){if(Un){var t=Pn;if(t){var n=t;if(!Jn(e,t)){if(!(t=Le(n))||!Jn(e,t))return e.flags=-1025&e.flags|2,Un=!1,void(Dn=e);On(Dn,n)}Dn=e,Pn=ze(t)}else e.flags=-1025&e.flags|2,Un=!1,Dn=e}}function jn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Dn=e}function qn(e){if(!q||e!==Dn)return!1;if(!Un)return jn(e),Un=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!K(t,e.memoizedProps))for(t=Pn;t;)On(e,t),t=Le(t);if(jn(e),13===e.tag){if(!q)throw Error(s(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));Pn=Te(e)}else Pn=Dn?Le(e.stateNode):null;return!0}function $n(){q&&(Pn=Dn=null,Un=!1)}var er=[];function tr(){for(var e=0;e<er.length;e++){var t=er[e];J?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}er.length=0}var nr=u.ReactCurrentDispatcher,rr=u.ReactCurrentBatchConfig,ir=0,ar=null,or=null,sr=null,ur=!1,lr=!1;function cr(){throw Error(s(321))}function gr(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!jt(e[n],t[n]))return!1;return!0}function dr(e,t,n,r,i,a){if(ir=a,ar=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,nr.current=null===e||null===e.memoizedState?Hr:Lr,e=n(r,i),lr){a=0;do{if(lr=!1,!(25>a))throw Error(s(301));a+=1,sr=or=null,t.updateQueue=null,nr.current=zr,e=n(r,i)}while(lr)}if(nr.current=Xr,t=null!==or&&null!==or.next,ir=0,sr=or=ar=null,ur=!1,t)throw Error(s(300));return e}function Ir(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===sr?ar.memoizedState=sr=e:sr=sr.next=e,sr}function Cr(){if(null===or){var e=ar.alternate;e=null!==e?e.memoizedState:null}else e=or.next;var t=null===sr?ar.memoizedState:sr.next;if(null!==t)sr=t,or=e;else{if(null===e)throw Error(s(310));e={memoizedState:(or=e).memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},null===sr?ar.memoizedState=sr=e:sr=sr.next=e}return sr}function hr(e,t){return"function"===typeof t?t(e):t}function fr(e){var t=Cr(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=or,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var u=o=a=null,l=i;do{var c=l.lane;if((ir&c)===c)null!==u&&(u=u.next={lane:0,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),r=l.eagerReducer===e?l.eagerState:e(r,l.action);else{var g={lane:c,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};null===u?(o=u=g,a=r):u=u.next=g,ar.lanes|=c,ga|=c}l=l.next}while(null!==l&&l!==i);null===u?a=r:u.next=o,jt(r,t.memoizedState)||(Yr=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function pr(e){var t=Cr(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);jt(a,t.memoizedState)||(Yr=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Ar(e,t,n){var r=t._getVersion;r=r(t._source);var i=J?t._workInProgressVersionPrimary:t._workInProgressVersionSecondary;if(null!==i?e=i===r:(e=e.mutableReadLanes,(e=(ir&e)===e)&&(J?t._workInProgressVersionPrimary=r:t._workInProgressVersionSecondary=r,er.push(t))),e)return n(t._source);throw er.push(t),Error(s(350))}function mr(e,t,n,r){var i=ra;if(null===i)throw Error(s(349));var a=t._getVersion,o=a(t._source),u=nr.current,l=u.useState((function(){return Ar(i,t,n)})),c=l[1],g=l[0];l=sr;var d=e.memoizedState,I=d.refs,C=I.getSnapshot,h=d.source;d=d.subscribe;var f=ar;return e.memoizedState={refs:I,source:t,subscribe:r},u.useEffect((function(){I.getSnapshot=n,I.setSnapshot=c;var e=a(t._source);if(!jt(o,e)){e=n(t._source),jt(g,e)||(c(e),e=Xa(f),i.mutableReadLanes|=e&i.pendingLanes),e=i.mutableReadLanes,i.entangledLanes|=e;for(var r=i.entanglements,s=e;0<s;){var u=31-yt(s),l=1<<u;r[u]|=e,s&=~l}}}),[n,t,r]),u.useEffect((function(){return r(t._source,(function(){var e=I.getSnapshot,n=I.setSnapshot;try{n(e(t._source));var r=Xa(f);i.mutableReadLanes|=r&i.pendingLanes}catch(a){n((function(){throw a}))}}))}),[t,r]),jt(C,n)&&jt(h,t)&&jt(d,r)||((e={pending:null,dispatch:null,lastRenderedReducer:hr,lastRenderedState:g}).dispatch=c=Er.bind(null,ar,e),l.queue=e,l.baseQueue=null,g=Ar(i,t,n),l.memoizedState=l.baseState=g),g}function vr(e,t,n){return mr(Cr(),e,t,n)}function br(e){var t=Ir();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:hr,lastRenderedState:e}).dispatch=Er.bind(null,ar,e),[t.memoizedState,e]}function yr(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ar.updateQueue)?(t={lastEffect:null},ar.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Br(e){return e={current:e},Ir().memoizedState=e}function Gr(){return Cr().memoizedState}function Zr(e,t,n,r){var i=Ir();ar.flags|=e,i.memoizedState=yr(1|t,n,void 0,void 0===r?null:r)}function wr(e,t,n,r){var i=Cr();r=void 0===r?null:r;var a=void 0;if(null!==or){var o=or.memoizedState;if(a=o.destroy,null!==r&&gr(r,o.deps))return void yr(t,n,a,r)}ar.flags|=e,i.memoizedState=yr(1|t,n,a,r)}function _r(e,t){return Zr(516,4,e,t)}function xr(e,t){return wr(516,4,e,t)}function Sr(e,t){return wr(4,2,e,t)}function Rr(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Mr(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,wr(4,2,Rr.bind(null,t,e),n)}function Wr(){}function kr(e,t){var n=Cr();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&gr(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Vr(e,t){var n=Cr();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&gr(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Fr(e,t){var n=Kt();Pt(98>n?98:n,(function(){e(!0)})),Pt(97<n?97:n,(function(){var n=rr.transition;rr.transition=1;try{e(!1),t()}finally{rr.transition=n}}))}function Er(e,t,n){var r=Ea(),i=Xa(e),a={lane:i,action:n,eagerReducer:null,eagerState:null,next:null},o=t.pending;if(null===o?a.next=a:(a.next=o.next,o.next=a),t.pending=a,o=e.alternate,e===ar||null!==o&&o===ar)lr=ur=!0;else{if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,u=o(s,n);if(a.eagerReducer=o,a.eagerState=u,jt(u,s))return}catch(l){}Ha(e,i,r)}}var Xr={readContext:dn,useCallback:cr,useContext:cr,useEffect:cr,useImperativeHandle:cr,useLayoutEffect:cr,useMemo:cr,useReducer:cr,useRef:cr,useState:cr,useDebugValue:cr,useDeferredValue:cr,useTransition:cr,useMutableSource:cr,useOpaqueIdentifier:cr,unstable_isNewReconciler:!1},Hr={readContext:dn,useCallback:function(e,t){return Ir().memoizedState=[e,void 0===t?null:t],e},useContext:dn,useEffect:_r,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Zr(4,2,Rr.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Zr(4,2,e,t)},useMemo:function(e,t){var n=Ir();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ir();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Er.bind(null,ar,e),[r.memoizedState,e]},useRef:Br,useState:br,useDebugValue:Wr,useDeferredValue:function(e){var t=br(e),n=t[0],r=t[1];return _r((function(){var t=rr.transition;rr.transition=1;try{r(e)}finally{rr.transition=t}}),[e]),n},useTransition:function(){var e=br(!1),t=e[0];return Br(e=Fr.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=Ir();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},mr(r,e,t,n)},useOpaqueIdentifier:function(){if(Un){var e=!1,t=ee((function(){throw e||(e=!0,n(te())),Error(s(355))})),n=br(t)[1];return 0===(2&ar.mode)&&(ar.flags|=516,yr(5,(function(){n(te())}),void 0,null)),t}return br(t=te()),t},unstable_isNewReconciler:!1},Lr={readContext:dn,useCallback:kr,useContext:dn,useEffect:xr,useImperativeHandle:Mr,useLayoutEffect:Sr,useMemo:Vr,useReducer:fr,useRef:Gr,useState:function(){return fr(hr)},useDebugValue:Wr,useDeferredValue:function(e){var t=fr(hr),n=t[0],r=t[1];return xr((function(){var t=rr.transition;rr.transition=1;try{r(e)}finally{rr.transition=t}}),[e]),n},useTransition:function(){var e=fr(hr)[0];return[Gr().current,e]},useMutableSource:vr,useOpaqueIdentifier:function(){return fr(hr)[0]},unstable_isNewReconciler:!1},zr={readContext:dn,useCallback:kr,useContext:dn,useEffect:xr,useImperativeHandle:Mr,useLayoutEffect:Sr,useMemo:Vr,useReducer:pr,useRef:Gr,useState:function(){return pr(hr)},useDebugValue:Wr,useDeferredValue:function(e){var t=pr(hr),n=t[0],r=t[1];return xr((function(){var t=rr.transition;rr.transition=1;try{r(e)}finally{rr.transition=t}}),[e]),n},useTransition:function(){var e=pr(hr)[0];return[Gr().current,e]},useMutableSource:vr,useOpaqueIdentifier:function(){return pr(hr)[0]},unstable_isNewReconciler:!1},Nr=u.ReactCurrentOwner,Yr=!1;function Tr(e,t,n,r){t.child=null===e?kn(t,null,n,r):Wn(t,e.child,n,r)}function Kr(e,t,n,r,i){n=n.render;var a=t.ref;return gn(t,i),r=dr(e,t,n,r,a,i),null===e||Yr?(t.flags|=1,Tr(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,gi(e,t,i))}function Dr(e,t,n,r,i,a){if(null===e){var o=n.type;return"function"!==typeof o||Bo(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Zo(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Pr(e,t,o,r,i,a))}return o=e.child,0===(i&a)&&(i=o.memoizedProps,(n=null!==(n=n.compare)?n:$t)(i,r)&&e.ref===t.ref)?gi(e,t,a):(t.flags|=1,(e=Go(o,r)).ref=t.ref,e.return=t,t.child=e)}function Pr(e,t,n,r,i,a){if(null!==e&&$t(e.memoizedProps,r)&&e.ref===t.ref){if(Yr=!1,0===(a&i))return t.lanes=e.lanes,gi(e,t,a);0!==(16384&e.flags)&&(Yr=!0)}return Jr(e,t,n,r,a)}function Ur(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},Pa(t,n);else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},Pa(t,e),null;t.memoizedState={baseLanes:0},Pa(t,null!==a?a.baseLanes:n)}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Pa(t,r);return Tr(e,t,i,n),t.child}function Or(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function Jr(e,t,n,r,i){var a=at(n)?rt:tt.current;return a=it(t,a),gn(t,i),n=dr(e,t,n,r,a,i),null===e||Yr?(t.flags|=1,Tr(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,gi(e,t,i))}function Qr(e,t,n,r,i){if(at(n)){var a=!0;lt(t)}else a=!1;if(gn(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Zn(t,n,r),_n(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,l=n.contextType;"object"===typeof l&&null!==l?l=dn(l):l=it(t,l=at(n)?rt:tt.current);var c=n.getDerivedStateFromProps,g="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;g||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==l)&&wn(t,o,r,l),In=!1;var d=t.memoizedState;o.state=d,mn(t,r,o,i),u=t.memoizedState,s!==r||d!==u||nt.current||In?("function"===typeof c&&(yn(t,n,c,r),u=t.memoizedState),(s=In||Gn(t,n,s,r,d,u,l))?(g||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4)):("function"===typeof o.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=l,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4),r=!1)}else{o=t.stateNode,hn(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:tn(t.type,s),o.props=l,g=t.pendingProps,d=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=dn(u):u=it(t,u=at(n)?rt:tt.current);var I=n.getDerivedStateFromProps;(c="function"===typeof I||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==g||d!==u)&&wn(t,o,r,u),In=!1,d=t.memoizedState,o.state=d,mn(t,r,o,i);var C=t.memoizedState;s!==g||d!==C||nt.current||In?("function"===typeof I&&(yn(t,n,I,r),C=t.memoizedState),(l=In||Gn(t,n,l,r,d,C,u))?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,C,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,C,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=C),o.props=r,o.state=C,o.context=u,r=l):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),r=!1)}return jr(e,t,n,r,a,i)}function jr(e,t,n,r,i,a){Or(e,t);var o=0!==(64&t.flags);if(!r&&!o)return i&&ct(t,n,!1),gi(e,t,a);r=t.stateNode,Nr.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Wn(t,e.child,null,a),t.child=Wn(t,null,s,a)):Tr(e,t,s,a),t.memoizedState=r.state,i&&ct(t,n,!0),t.child}function qr(e){var t=e.stateNode;t.pendingContext?st(0,t.pendingContext,t.pendingContext!==t.context):t.context&&st(0,t.context,!1),Ln(e,t.containerInfo)}var $r,ei,ti,ni,ri={dehydrated:null,retryLane:0};function ii(e,t,n){var r,i=t.pendingProps,a=Tn.current,o=!1;return(r=0!==(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(o=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(a|=1),$e(Tn,1&a),null===e?(void 0!==i.fallback&&Qn(t),e=i.children,a=i.fallback,o?(e=ai(t,e,a,n),t.child.memoizedState={baseLanes:n},t.memoizedState=ri,e):"number"===typeof i.unstable_expectedLoadTime?(e=ai(t,e,a,n),t.child.memoizedState={baseLanes:n},t.memoizedState=ri,t.lanes=33554432,e):((n=_o({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,o?(i=si(e,t,i.children,i.fallback,n),o=t.child,a=e.child.memoizedState,o.memoizedState=null===a?{baseLanes:n}:{baseLanes:a.baseLanes|n},o.childLanes=e.childLanes&~n,t.memoizedState=ri,i):(n=oi(e,t,i.children,n),t.memoizedState=null,n))}function ai(e,t,n,r){var i=e.mode,a=e.child;return t={mode:"hidden",children:t},0===(2&i)&&null!==a?(a.childLanes=0,a.pendingProps=t):a=_o(t,i,0,null),n=wo(n,i,r,null),a.return=e,n.return=e,a.sibling=n,e.child=a,n}function oi(e,t,n,r){var i=e.child;return e=i.sibling,n=Go(i,{mode:"visible",children:n}),0===(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function si(e,t,n,r,i){var a=t.mode,o=e.child;e=o.sibling;var s={mode:"hidden",children:n};return 0===(2&a)&&t.child!==o?((n=t.child).childLanes=0,n.pendingProps=s,null!==(o=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=o,o.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Go(o,s),null!==e?r=Go(e,r):(r=wo(r,a,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function ui(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),cn(e.return,t)}function li(e,t,n,r,i,a){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,lastEffect:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i,o.lastEffect=a)}function ci(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Tr(e,t,r.children,n),0!==(2&(r=Tn.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ui(e,n);else if(19===e.tag)ui(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if($e(Tn,r),0===(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Kn(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),li(t,!1,i,n,a,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Kn(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}li(t,!0,n,null,a,t.lastEffect);break;case"together":li(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function gi(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),ga|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Go(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Go(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function di(e){e.flags|=4}if(Q)$r=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)N(e,n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},ei=function(){},ti=function(e,t,n,r,i){if((e=e.memoizedProps)!==r){var a=t.stateNode,o=Hn(Fn.current);n=T(a,n,e,r,i,o),(t.updateQueue=n)&&di(t)}},ni=function(e,t,n,r){n!==r&&di(t)};else if(j){$r=function(e,t,n,r){for(var i=t.child;null!==i;){if(5===i.tag){var a=i.stateNode;n&&r&&(a=ke(a,i.type,i.memoizedProps,i)),N(e,a)}else if(6===i.tag)a=i.stateNode,n&&r&&(a=Ve(a,i.memoizedProps,i)),N(e,a);else if(4!==i.tag){if(13===i.tag&&0!==(4&i.flags)&&(a=null!==i.memoizedState)){var o=i.child;if(null!==o&&(null!==o.child&&(o.child.return=o,$r(e,o,!0,a)),null!==(a=o.sibling))){a.return=i,i=a;continue}}if(null!==i.child){i.child.return=i,i=i.child;continue}}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};var Ii=function e(t,n,r,i){for(var a=n.child;null!==a;){if(5===a.tag){var o=a.stateNode;r&&i&&(o=ke(o,a.type,a.memoizedProps,a)),Re(t,o)}else if(6===a.tag)o=a.stateNode,r&&i&&(o=Ve(o,a.memoizedProps,a)),Re(t,o);else if(4!==a.tag){if(13===a.tag&&0!==(4&a.flags)&&(o=null!==a.memoizedState)){var s=a.child;if(null!==s&&(null!==s.child&&(s.child.return=s,e(t,s,!0,o)),null!==(o=s.sibling))){o.return=a,a=o;continue}}if(null!==a.child){a.child.return=a,a=a.child;continue}}if(a===n)break;for(;null===a.sibling;){if(null===a.return||a.return===n)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};ei=function(e){var t=e.stateNode;if(null!==e.firstEffect){var n=t.containerInfo,r=Se(n);Ii(r,e,!1,!1),t.pendingChildren=r,di(e),Me(n,r)}},ti=function(e,t,n,r,i){var a=e.stateNode,o=e.memoizedProps;if((e=null===t.firstEffect)&&o===r)t.stateNode=a;else{var s=t.stateNode,u=Hn(Fn.current),l=null;o!==r&&(l=T(s,n,o,r,i,u)),e&&null===l?t.stateNode=a:(a=xe(a,l,n,o,r,t,e,s),Y(a,n,r,i,u)&&di(t),t.stateNode=a,e?di(t):$r(a,t,!1,!1))}},ni=function(e,t,n,r){n!==r?(e=Hn(Xn.current),n=Hn(Fn.current),t.stateNode=D(r,e,n,t),di(t)):t.stateNode=e.stateNode}}else ei=function(){},ti=function(){},ni=function(){};function Ci(e,t){if(!Un)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function hi(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return at(t.type)&&ot(),null;case 3:return zn(),qe(nt),qe(tt),tr(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(qn(t)?di(t):r.hydrate||(t.flags|=256)),ei(t),null;case 5:Yn(t);var i=Hn(Xn.current);if(n=t.type,null!==e&&null!=t.stateNode)ti(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(s(166));return null}if(e=Hn(Fn.current),qn(t)){if(!q)throw Error(s(175));e=Ne(t.stateNode,t.type,t.memoizedProps,i,e,t),t.updateQueue=e,null!==e&&di(t)}else{var a=z(n,r,i,e,t);$r(a,t,!1,!1),t.stateNode=a,Y(a,n,r,i,e)&&di(t)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)ni(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(e=Hn(Xn.current),i=Hn(Fn.current),qn(t)){if(!q)throw Error(s(176));Ye(t.stateNode,t.memoizedProps,t)&&di(t)}else t.stateNode=D(r,e,i,t)}return null;case 13:return qe(Tn),r=t.memoizedState,0!==(64&t.flags)?(t.lanes=n,t):(r=null!==r,i=!1,null===e?void 0!==t.memoizedProps.fallback&&qn(t):i=null!==e.memoizedState,r&&!i&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Tn.current)?0===ua&&(ua=3):(0!==ua&&3!==ua||(ua=4),null===ra||0===(134217727&ga)&&0===(134217727&da)||Ya(ra,aa))),j&&r&&(t.flags|=4),Q&&(r||i)&&(t.flags|=4),null);case 4:return zn(),ei(t),null===e&&ie(t.stateNode.containerInfo),null;case 10:return ln(t),null;case 19:if(qe(Tn),null===(r=t.memoizedState))return null;if(i=0!==(64&t.flags),null===(a=r.rendering))if(i)Ci(r,!1);else{if(0!==ua||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(a=Kn(e))){for(t.flags|=64,Ci(r,!1),null!==(e=a.updateQueue)&&(t.updateQueue=e,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,e=n,r=t.child;null!==r;)n=e,(i=r).flags&=2,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null,null===(a=i.alternate)?(i.childLanes=0,i.lanes=n,i.child=null,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,n=a.dependencies,i.dependencies=null===n?null:{lanes:n.lanes,firstContext:n.firstContext}),r=r.sibling;return $e(Tn,1&Tn.current|2),t.child}e=e.sibling}null!==r.tail&&Tt()>fa&&(t.flags|=64,i=!0,Ci(r,!1),t.lanes=33554432)}else{if(!i)if(null!==(e=Kn(a))){if(t.flags|=64,i=!0,null!==(e=e.updateQueue)&&(t.updateQueue=e,t.flags|=4),Ci(r,!0),null===r.tail&&"hidden"===r.tailMode&&!a.alternate&&!Un)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Tt()-r.renderingStartTime>fa&&1073741824!==n&&(t.flags|=64,i=!0,Ci(r,!1),t.lanes=33554432);r.isBackwards?(a.sibling=t.child,t.child=a):(null!==(e=r.last)?e.sibling=a:t.child=a,r.last=a)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Tt(),e.sibling=null,t=Tn.current,$e(Tn,i?1&t|2:1&t),e):null;case 23:case 24:return Ua(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(s(156,t.tag))}function fi(e){switch(e.tag){case 1:at(e.type)&&ot();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(zn(),qe(nt),qe(tt),tr(),0!==(64&(t=e.flags)))throw Error(s(285));return e.flags=-4097&t|64,e;case 5:return Yn(e),null;case 13:return qe(Tn),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return qe(Tn),null;case 4:return zn(),null;case 10:return ln(e),null;case 23:case 24:return Ua(),null;default:return null}}function pi(e,t){try{var n="",r=t;do{n+=en(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i}}function Ai(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var mi="function"===typeof WeakMap?WeakMap:Map;function vi(e,t,n){(n=fn(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){va||(va=!0,ba=r),Ai(0,t)},n}function bi(e,t,n){(n=fn(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return Ai(0,t),r(i)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===ya?ya=new Set([this]):ya.add(this),Ai(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var yi="function"===typeof WeakSet?WeakSet:Set;function Bi(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){co(e,n)}else t.current=null}function Gi(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:tn(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(Q&&256&t.flags&&_e(t.stateNode.containerInfo))}throw Error(s(163))}function Zi(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==t)}}function wi(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var i=e;r=i.next,0!==(4&(i=i.tag))&&0!==(1&i)&&(so(n,e),oo(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:tn(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&vn(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=F(n.child.stateNode);break;case 1:e=n.child.stateNode}vn(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&fe(e,n.type,n.memoizedProps,n));case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(q&&null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&De(n)))))}throw Error(s(163))}function _i(e,t){if(Q)for(var n=e;;){if(5===n.tag){var r=n.stateNode;t?Be(r):Ze(n.stateNode,n.memoizedProps)}else if(6===n.tag)r=n.stateNode,t?Ge(r):we(r,n.memoizedProps);else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function xi(e,t){if(dt&&"function"===typeof dt.onCommitFiberUnmount)try{dt.onCommitFiberUnmount(gt,t)}catch(a){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,i=r.destroy;if(r=r.tag,void 0!==i)if(0!==(4&r))so(t,n);else{r=t;try{i()}catch(a){co(r,a)}}n=n.next}while(n!==e)}break;case 1:if(Bi(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(a){co(t,a)}break;case 5:Bi(t);break;case 4:Q?Fi(e,t):j&&j&&(t=t.stateNode.containerInfo,e=Se(t),We(t,e))}}function Si(e,t){for(var n=t;;)if(xi(e,n),null===n.child||Q&&4===n.tag){if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}else n.child.return=n,n=n.child}function Ri(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function Mi(e){return 5===e.tag||3===e.tag||4===e.tag}function Wi(e){if(Q){e:{for(var t=e.return;null!==t;){if(Mi(t))break e;t=t.return}throw Error(s(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(s(161))}16&n.flags&&(ye(t),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||Mi(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?ki(e,n,t):Vi(e,n,t)}}function ki(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?me(n,e,t):Ce(n,e);else if(4!==r&&null!==(e=e.child))for(ki(e,t,n),e=e.sibling;null!==e;)ki(e,t,n),e=e.sibling}function Vi(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?Ae(n,e,t):Ie(n,e);else if(4!==r&&null!==(e=e.child))for(Vi(e,t,n),e=e.sibling;null!==e;)Vi(e,t,n),e=e.sibling}function Fi(e,t){for(var n,r,i=t,a=!1;;){if(!a){a=i.return;e:for(;;){if(null===a)throw Error(s(160));switch(n=a.stateNode,a.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}a=a.return}a=!0}if(5===i.tag||6===i.tag)Si(e,i),r?be(n,i.stateNode):ve(n,i.stateNode);else if(4===i.tag){if(null!==i.child){n=i.stateNode.containerInfo,r=!0,i.child.return=i,i=i.child;continue}}else if(xi(e,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;4===(i=i.return).tag&&(a=!1)}i.sibling.return=i.return,i=i.sibling}}function Ei(e,t){if(Q){switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void Zi(3,t);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps;e=null!==e?e.memoizedProps:r;var i=t.type,a=t.updateQueue;t.updateQueue=null,null!==a&&pe(n,a,i,e,r,t)}return;case 6:if(null===t.stateNode)throw Error(s(162));return n=t.memoizedProps,void he(t.stateNode,null!==e?e.memoizedProps:n,n);case 3:return void(q&&(t=t.stateNode,t.hydrate&&(t.hydrate=!1,Ke(t.containerInfo))));case 13:return Xi(t),void Hi(t);case 19:return void Hi(t);case 23:case 24:return void _i(t,null!==t.memoizedState)}throw Error(s(163))}switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void Zi(3,t);case 12:case 23:case 24:return;case 13:return Xi(t),void Hi(t);case 19:return void Hi(t);case 3:q&&((n=t.stateNode).hydrate&&(n.hydrate=!1,Ke(n.containerInfo)))}e:if(j){switch(t.tag){case 1:case 5:case 6:case 20:break e;case 3:case 4:t=t.stateNode,We(t.containerInfo,t.pendingChildren);break e}throw Error(s(163))}}function Xi(e){null!==e.memoizedState&&(ha=Tt(),Q&&_i(e.child,!0))}function Hi(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new yi),t.forEach((function(t){var r=Io.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Li(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var zi=0,Ni=1,Yi=2,Ti=3,Ki=4;if("function"===typeof Symbol&&Symbol.for){var Di=Symbol.for;zi=Di("selector.component"),Ni=Di("selector.has_pseudo_class"),Yi=Di("selector.role"),Ti=Di("selector.test_id"),Ki=Di("selector.text")}function Pi(e){var t=$(e);if(null!=t){if("string"!==typeof t.memoizedProps["data-testname"])throw Error(s(364));return t}if(null===(e=oe(e)))throw Error(s(362));return e.stateNode.current}function Ui(e,t){switch(t.$$typeof){case zi:if(e.type===t.value)return!0;break;case Ni:e:{t=t.value,e=[e,0];for(var n=0;n<e.length;){var r=e[n++],i=e[n++],a=t[i];if(5!==r.tag||!le(r)){for(;null!=a&&Ui(r,a);)a=t[++i];if(i===t.length){t=!0;break e}for(r=r.child;null!==r;)e.push(r,i),r=r.sibling}}t=!1}return t;case Yi:if(5===e.tag&&ce(e.stateNode,t.value))return!0;break;case Ki:if((5===e.tag||6===e.tag)&&(null!==(e=ue(e))&&0<=e.indexOf(t.value)))return!0;break;case Ti:if(5===e.tag&&("string"===typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase()))return!0;break;default:throw Error(s(365,t))}return!1}function Oi(e){switch(e.$$typeof){case zi:return"<"+(x(e.value)||"Unknown")+">";case Ni:return":has("+(Oi(e)||"")+")";case Yi:return'[role="'+e.value+'"]';case Ki:return'"'+e.value+'"';case Ti:return'[data-testname="'+e.value+'"]';default:throw Error(s(365,e))}}function Ji(e,t){var n=[];e=[e,0];for(var r=0;r<e.length;){var i=e[r++],a=e[r++],o=t[a];if(5!==i.tag||!le(i)){for(;null!=o&&Ui(i,o);)o=t[++a];if(a===t.length)n.push(i);else for(i=i.child;null!==i;)e.push(i,a),i=i.sibling}}return n}function Qi(e,t){if(!ae)throw Error(s(363));e=Ji(e=Pi(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var r=e[n++];if(5===r.tag)le(r)||t.push(r.stateNode);else for(r=r.child;null!==r;)e.push(r),r=r.sibling}return t}var ji=null;var qi=Math.ceil,$i=u.ReactCurrentDispatcher,ea=u.ReactCurrentOwner,ta=u.IsSomeRendererActing,na=0,ra=null,ia=null,aa=0,oa=0,sa=je(0),ua=0,la=null,ca=0,ga=0,da=0,Ia=0,Ca=null,ha=0,fa=1/0;function pa(){fa=Tt()+500}var Aa,ma=null,va=!1,ba=null,ya=null,Ba=!1,Ga=null,Za=90,wa=[],_a=[],xa=null,Sa=0,Ra=null,Ma=-1,Wa=0,ka=0,Va=null,Fa=!1;function Ea(){return 0!==(48&na)?Tt():-1!==Ma?Ma:Ma=Tt()}function Xa(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===Kt()?1:2;if(0===Wa&&(Wa=ca),0!==Qt.transition){0!==ka&&(ka=null!==Ca?Ca.pendingLanes:0),e=Wa;var t=4186112&~ka;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=Kt(),0!==(4&na)&&98===e?e=At(12,Wa):e=At(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),Wa),e}function Ha(e,t,n){if(50<Sa)throw Sa=0,Ra=null,Error(s(185));if(null===(e=La(e,t)))return null;bt(e,t,n),e===ra&&(da|=t,4===ua&&Ya(e,aa));var r=Kt();1===t?0!==(8&na)&&0===(48&na)?Ta(e):(za(e,n),0===na&&(pa(),Ot())):(0===(4&na)||98!==r&&99!==r||(null===xa?xa=new Set([e]):xa.add(e)),za(e,n)),Ca=e}function La(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function za(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,o=e.pendingLanes;0<o;){var u=31-yt(o),l=1<<u,c=a[u];if(-1===c){if(0===(l&r)||0!==(l&i)){c=t,ht(l);var g=Ct;a[u]=10<=g?c+250:6<=g?c+5e3:-1}}else c<=t&&(e.expiredLanes|=l);o&=~l}if(r=ft(e,e===ra?aa:0),t=Ct,0===r)null!==n&&(n!==Xt&&_t(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Xt&&_t(n)}15===t?(n=Ta.bind(null,e),null===Lt?(Lt=[n],zt=wt(Wt,Jt)):Lt.push(n),n=Xt):14===t?n=Ut(99,Ta.bind(null,e)):(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(s(358,e))}}(t),n=Ut(n,Na.bind(null,e))),e.callbackPriority=t,e.callbackNode=n}}function Na(e){if(Ma=-1,ka=Wa=0,0!==(48&na))throw Error(s(327));var t=e.callbackNode;if(ao()&&e.callbackNode!==t)return null;var n=ft(e,e===ra?aa:0);if(0===n)return null;var r=n,i=na;na|=16;var a=Qa();for(ra===e&&aa===r||(pa(),Oa(e,r));;)try{$a();break}catch(u){Ja(e,u)}if(sn(),$i.current=a,na=i,null!==ia?r=0:(ra=null,aa=0,r=ua),0!==(ca&da))Oa(e,0);else if(0!==r){if(2===r&&(na|=64,e.hydrate&&(e.hydrate=!1,_e(e.containerInfo)),0!==(n=pt(e))&&(r=ja(e,n))),1===r)throw t=la,Oa(e,0),Ya(e,n),za(e,Tt()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(s(345));case 2:case 5:no(e);break;case 3:if(Ya(e,n),(62914560&n)===n&&10<(r=ha+500-Tt())){if(0!==ft(e,0))break;if(((i=e.suspendedLanes)&n)!==n){Ea(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=P(no.bind(null,e),r);break}no(e);break;case 4:if(Ya(e,n),(4186112&n)===n)break;for(r=e.eventTimes,i=-1;0<n;){var o=31-yt(n);a=1<<o,(o=r[o])>i&&(i=o),n&=~a}if(n=i,10<(n=(120>(n=Tt()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*qi(n/1960))-n)){e.timeoutHandle=P(no.bind(null,e),n);break}no(e);break;default:throw Error(s(329))}}return za(e,Tt()),e.callbackNode===t?Na.bind(null,e):null}function Ya(e,t){for(t&=~Ia,t&=~da,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-yt(t),r=1<<n;e[n]=-1,t&=~r}}function Ta(e){if(0!==(48&na))throw Error(s(327));if(ao(),e===ra&&0!==(e.expiredLanes&aa)){var t=aa,n=ja(e,t);0!==(ca&da)&&(n=ja(e,t=ft(e,t)))}else n=ja(e,t=ft(e,0));if(0!==e.tag&&2===n&&(na|=64,e.hydrate&&(e.hydrate=!1,_e(e.containerInfo)),0!==(t=pt(e))&&(n=ja(e,t))),1===n)throw n=la,Oa(e,0),Ya(e,t),za(e,Tt()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,no(e),za(e,Tt()),null}function Ka(e,t){var n=na;na|=1;try{return e(t)}finally{0===(na=n)&&(pa(),Ot())}}function Da(e,t){var n=na;if(0!==(48&n))return e(t);na|=1;try{if(e)return Pt(99,e.bind(null,t))}finally{na=n,Ot()}}function Pa(e,t){$e(sa,oa),oa|=t,ca|=t}function Ua(){oa=sa.current,qe(sa)}function Oa(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==O&&(e.timeoutHandle=O,U(n)),null!==ia)for(n=ia.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&ot();break;case 3:zn(),qe(nt),qe(tt),tr();break;case 5:Yn(r);break;case 4:zn();break;case 13:case 19:qe(Tn);break;case 10:ln(r);break;case 23:case 24:Ua()}n=n.return}ra=e,ia=Go(e.current,null),aa=oa=ca=t,ua=0,la=null,Ia=da=ga=0}function Ja(e,t){for(;;){var n=ia;try{if(sn(),nr.current=Xr,ur){for(var r=ar.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ur=!1}if(ir=0,sr=or=ar=null,lr=!1,ea.current=null,null===n||null===n.return){ua=1,la=t,ia=null;break}e:{var a=e,o=n.return,s=n,u=t;if(t=aa,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==u&&"object"===typeof u&&"function"===typeof u.then){var l=u;if(0===(2&s.mode)){var c=s.alternate;c?(s.updateQueue=c.updateQueue,s.memoizedState=c.memoizedState,s.lanes=c.lanes):(s.updateQueue=null,s.memoizedState=null)}var g=0!==(1&Tn.current),d=o;do{var I;if(I=13===d.tag){var C=d.memoizedState;if(null!==C)I=null!==C.dehydrated;else{var h=d.memoizedProps;I=void 0!==h.fallback&&(!0!==h.unstable_avoidThisFallback||!g)}}if(I){var f=d.updateQueue;if(null===f){var p=new Set;p.add(l),d.updateQueue=p}else f.add(l);if(0===(2&d.mode)){if(d.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var A=fn(-1,1);A.tag=2,pn(s,A)}s.lanes|=1;break e}u=void 0,s=t;var m=a.pingCache;if(null===m?(m=a.pingCache=new mi,u=new Set,m.set(l,u)):void 0===(u=m.get(l))&&(u=new Set,m.set(l,u)),!u.has(s)){u.add(s);var v=go.bind(null,a,l,s);l.then(v,v)}d.flags|=4096,d.lanes=t;break e}d=d.return}while(null!==d);u=Error((x(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==ua&&(ua=2),u=pi(u,s),d=o;do{switch(d.tag){case 3:a=u,d.flags|=4096,t&=-t,d.lanes|=t,An(d,vi(0,a,t));break e;case 1:a=u;var b=d.type,y=d.stateNode;if(0===(64&d.flags)&&("function"===typeof b.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===ya||!ya.has(y)))){d.flags|=4096,t&=-t,d.lanes|=t,An(d,bi(d,a,t));break e}}d=d.return}while(null!==d)}to(n)}catch(B){t=B,ia===n&&null!==n&&(ia=n=n.return);continue}break}}function Qa(){var e=$i.current;return $i.current=Xr,null===e?Xr:e}function ja(e,t){var n=na;na|=16;var r=Qa();for(ra===e&&aa===t||Oa(e,t);;)try{qa();break}catch(i){Ja(e,i)}if(sn(),na=n,$i.current=r,null!==ia)throw Error(s(261));return ra=null,aa=0,ua}function qa(){for(;null!==ia;)eo(ia)}function $a(){for(;null!==ia&&!xt();)eo(ia)}function eo(e){var t=Aa(e.alternate,e,oa);e.memoizedProps=e.pendingProps,null===t?to(e):ia=t,ea.current=null}function to(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(n=hi(n,t,oa)))return void(ia=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&oa)||0===(4&n.mode)){for(var r=0,i=n.child;null!==i;)r|=i.lanes|i.childLanes,i=i.sibling;n.childLanes=r}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=fi(t)))return n.flags&=2047,void(ia=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(ia=t);ia=t=e}while(null!==t);0===ua&&(ua=5)}function no(e){var t=Kt();return Pt(99,ro.bind(null,e,t)),null}function ro(e,t){do{ao()}while(null!==Ga);if(0!==(48&na))throw Error(s(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null;var r=n.lanes|n.childLanes,i=r,a=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;for(var o=e.eventTimes,u=e.expirationTimes;0<a;){var l=31-yt(a),c=1<<l;i[l]=0,o[l]=-1,u[l]=-1,a&=~c}if(null!==xa&&0===(24&r)&&xa.has(e)&&xa.delete(e),e===ra&&(ia=ra=null,aa=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){i=na,na|=32,ea.current=null,Va=H(e.containerInfo),Fa=!1,ma=r;do{try{io()}catch(A){if(null===ma)throw Error(s(330));co(ma,A),ma=ma.nextEffect}}while(null!==ma);Va=null,ma=r;do{try{for(o=e;null!==ma;){var g=ma.flags;if(16&g&&Q&&ye(ma.stateNode),128&g){var d=ma.alternate;if(null!==d){var I=d.ref;null!==I&&("function"===typeof I?I(null):I.current=null)}}switch(1038&g){case 2:Wi(ma),ma.flags&=-3;break;case 6:Wi(ma),ma.flags&=-3,Ei(ma.alternate,ma);break;case 1024:ma.flags&=-1025;break;case 1028:ma.flags&=-1025,Ei(ma.alternate,ma);break;case 4:Ei(ma.alternate,ma);break;case 8:u=o,a=ma,Q?Fi(u,a):Si(u,a);var C=a.alternate;Ri(a),null!==C&&Ri(C)}ma=ma.nextEffect}}catch(A){if(null===ma)throw Error(s(330));co(ma,A),ma=ma.nextEffect}}while(null!==ma);Fa&&re(),L(e.containerInfo),e.current=n,ma=r;do{try{for(g=e;null!==ma;){var h=ma.flags;if(36&h&&wi(g,ma.alternate,ma),128&h){d=void 0;var f=ma.ref;if(null!==f){var p=ma.stateNode;if(5===ma.tag)d=F(p);else d=p;"function"===typeof f?f(d):f.current=d}}ma=ma.nextEffect}}catch(A){if(null===ma)throw Error(s(330));co(ma,A),ma=ma.nextEffect}}while(null!==ma);ma=null,Ht(),na=i}else e.current=n;if(Ba)Ba=!1,Ga=e,Za=t;else for(ma=r;null!==ma;)t=ma.nextEffect,ma.nextEffect=null,8&ma.flags&&((h=ma).sibling=null,h.stateNode=null),ma=t;if(0===(r=e.pendingLanes)&&(ya=null),1===r?e===Ra?Sa++:(Sa=0,Ra=e):Sa=0,n=n.stateNode,dt&&"function"===typeof dt.onCommitFiberRoot)try{dt.onCommitFiberRoot(gt,n,void 0,64===(64&n.current.flags))}catch(A){}if(za(e,Tt()),va)throw va=!1,e=ba,ba=null,e;return 0!==(8&na)||Ot(),null}function io(){for(;null!==ma;){var e=ma.alternate;Fa||null===Va||(0!==(8&ma.flags)?k(ma,Va)&&(Fa=!0,ne()):13===ma.tag&&Li(e,ma)&&k(ma,Va)&&(Fa=!0,ne()));var t=ma.flags;0!==(256&t)&&Gi(e,ma),0===(512&t)||Ba||(Ba=!0,Ut(97,(function(){return ao(),null}))),ma=ma.nextEffect}}function ao(){if(90!==Za){var e=97<Za?97:Za;return Za=90,Pt(e,uo)}return!1}function oo(e,t){wa.push(t,e),Ba||(Ba=!0,Ut(97,(function(){return ao(),null})))}function so(e,t){_a.push(t,e),Ba||(Ba=!0,Ut(97,(function(){return ao(),null})))}function uo(){if(null===Ga)return!1;var e=Ga;if(Ga=null,0!==(48&na))throw Error(s(331));var t=na;na|=32;var n=_a;_a=[];for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1],o=i.destroy;if(i.destroy=void 0,"function"===typeof o)try{o()}catch(l){if(null===a)throw Error(s(330));co(a,l)}}for(n=wa,wa=[],r=0;r<n.length;r+=2){i=n[r],a=n[r+1];try{var u=i.create;i.destroy=u()}catch(l){if(null===a)throw Error(s(330));co(a,l)}}for(u=e.current.firstEffect;null!==u;)e=u.nextEffect,u.nextEffect=null,8&u.flags&&(u.sibling=null,u.stateNode=null),u=e;return na=t,Ot(),!0}function lo(e,t,n){pn(e,t=vi(0,t=pi(n,t),1)),t=Ea(),null!==(e=La(e,1))&&(bt(e,1,t),za(e,t))}function co(e,t){if(3===e.tag)lo(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){lo(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===ya||!ya.has(r))){var i=bi(n,e=pi(t,e),1);if(pn(n,i),i=Ea(),null!==(n=La(n,1)))bt(n,1,i),za(n,i);else if("function"===typeof r.componentDidCatch&&(null===ya||!ya.has(r)))try{r.componentDidCatch(t,e)}catch(a){}break}}n=n.return}}function go(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Ea(),e.pingedLanes|=e.suspendedLanes&n,ra===e&&(aa&n)===n&&(4===ua||3===ua&&(62914560&aa)===aa&&500>Tt()-ha?Oa(e,0):Ia|=n),za(e,t)}function Io(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===Kt()?1:2:(0===Wa&&(Wa=ca),0===(t=mt(62914560&~Wa))&&(t=4194304))),n=Ea(),null!==(e=La(e,t))&&(bt(e,t,n),za(e,n))}Aa=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||nt.current)Yr=!0;else{if(0===(n&r)){switch(Yr=!1,t.tag){case 3:qr(t),$n();break;case 5:Nn(t);break;case 1:at(t.type)&&lt(t);break;case 4:Ln(t,t.stateNode.containerInfo);break;case 10:un(t,t.memoizedProps.value);break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?ii(e,t,n):($e(Tn,1&Tn.current),null!==(t=gi(e,t,n))?t.sibling:null);$e(Tn,1&Tn.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(64&e.flags)){if(r)return ci(e,t,n);t.flags|=64}var i=t.memoizedState;if(null!==i&&(i.rendering=null,i.tail=null,i.lastEffect=null),$e(Tn,Tn.current),r)break;return null;case 23:case 24:return t.lanes=0,Ur(e,t,n)}return gi(e,t,n)}Yr=0!==(16384&e.flags)}else Yr=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=it(t,tt.current),gn(t,n),i=dr(null,t,r,e,i,n),t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,at(r)){var a=!0;lt(t)}else a=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Cn(t);var o=r.getDerivedStateFromProps;"function"===typeof o&&yn(t,r,o,e),i.updater=Bn,t.stateNode=i,i._reactInternals=t,_n(t,r,e,n),t=jr(null,t,r,!0,a,n)}else t.tag=0,Tr(null,t,i,n),t=t.child;return t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(a=i._init)(i._payload),t.type=i,a=t.tag=function(e){if("function"===typeof e)return Bo(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===f)return 11;if(e===m)return 14}return 2}(i),e=tn(i,e),a){case 0:t=Jr(null,t,i,e,n);break e;case 1:t=Qr(null,t,i,e,n);break e;case 11:t=Kr(null,t,i,e,n);break e;case 14:t=Dr(null,t,i,tn(i.type,e),r,n);break e}throw Error(s(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,Jr(e,t,r,i=t.elementType===r?i:tn(r,i),n);case 1:return r=t.type,i=t.pendingProps,Qr(e,t,r,i=t.elementType===r?i:tn(r,i),n);case 3:if(qr(t),r=t.updateQueue,null===e||null===r)throw Error(s(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,hn(e,t),mn(t,r,null,n),(r=t.memoizedState.element)===i)$n(),t=gi(e,t,n);else{if((a=(i=t.stateNode).hydrate)&&(q?(Pn=ze(t.stateNode.containerInfo),Dn=t,a=Un=!0):a=!1),a){if(q&&null!=(e=i.mutableSourceEagerHydrationData))for(i=0;i<e.length;i+=2)a=e[i],o=e[i+1],J?a._workInProgressVersionPrimary=o:a._workInProgressVersionSecondary=o,er.push(a);for(n=kn(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Tr(e,t,r,n),$n();t=t.child}return t;case 5:return Nn(t),null===e&&Qn(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,o=i.children,K(r,i)?o=null:null!==a&&K(r,a)&&(t.flags|=16),Or(e,t),Tr(e,t,o,n),t.child;case 6:return null===e&&Qn(t),null;case 13:return ii(e,t,n);case 4:return Ln(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Wn(t,null,r,n):Tr(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Kr(e,t,r,i=t.elementType===r?i:tn(r,i),n);case 7:return Tr(e,t,t.pendingProps,n),t.child;case 8:case 12:return Tr(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,un(t,a=i.value),null!==o){var u=o.value;if(0===(a=jt(u,a)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(u,a):1073741823))){if(o.children===i.children&&!nt.current){t=gi(e,t,n);break e}}else for(null!==(u=t.child)&&(u.return=t);null!==u;){var l=u.dependencies;if(null!==l){o=u.child;for(var c=l.firstContext;null!==c;){if(c.context===r&&0!==(c.observedBits&a)){1===u.tag&&((c=fn(-1,n&-n)).tag=2,pn(u,c)),u.lanes|=n,null!==(c=u.alternate)&&(c.lanes|=n),cn(u.return,n),l.lanes|=n;break}c=c.next}}else o=10===u.tag&&u.type===t.type?null:u.child;if(null!==o)o.return=u;else for(o=u;null!==o;){if(o===t){o=null;break}if(null!==(u=o.sibling)){u.return=o.return,o=u;break}o=o.return}u=o}}Tr(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(a=t.pendingProps).children,gn(t,n),r=r(i=dn(i,a.unstable_observedBits)),t.flags|=1,Tr(e,t,r,n),t.child;case 14:return a=tn(i=t.type,t.pendingProps),Dr(e,t,i,a=tn(i.type,a),r,n);case 15:return Pr(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:tn(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,at(r)?(e=!0,lt(t)):e=!1,gn(t,n),Zn(t,r,i),_n(t,r,i,n),jr(null,t,r,!0,e,n);case 19:return ci(e,t,n);case 23:case 24:return Ur(e,t,n)}throw Error(s(156,t.tag))};var Co={current:!1},ho=o.unstable_flushAllWithoutAsserting,fo="function"===typeof ho;function po(){if(void 0!==ho)return ho();for(var e=!1;ao();)e=!0;return e}function Ao(t){try{po(),function(t){if(null===ji)try{var n=("require"+Math.random()).slice(0,7);ji=(e&&e[n]).call(e,"timers").setImmediate}catch(r){ji=function(e){var t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(void 0)}}ji(t)}((function(){po()?Ao(t):t()}))}catch(n){t(n)}}var mo=0,vo=!1;function bo(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function yo(e,t,n,r){return new bo(e,t,n,r)}function Bo(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Go(e,t){var n=e.alternate;return null===n?((n=yo(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Zo(e,t,n,r,i,a){var o=2;if(r=e,"function"===typeof e)Bo(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case g:return wo(n.children,i,a,t);case y:o=8,i|=16;break;case d:o=8,i|=1;break;case I:return(e=yo(12,n,t,8|i)).elementType=I,e.type=I,e.lanes=a,e;case p:return(e=yo(13,n,t,i)).type=p,e.elementType=p,e.lanes=a,e;case A:return(e=yo(19,n,t,i)).elementType=A,e.lanes=a,e;case B:return _o(n,i,a,t);case G:return(e=yo(24,n,t,i)).elementType=G,e.lanes=a,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case h:o=9;break e;case f:o=11;break e;case m:o=14;break e;case v:o=16,r=null;break e;case b:o=22;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=yo(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function wo(e,t,n,r){return(e=yo(7,e,r,t)).lanes=n,e}function _o(e,t,n,r){return(e=yo(23,e,r,t)).elementType=B,e.lanes=n,e}function xo(e,t,n){return(e=yo(6,e,null,t)).lanes=n,e}function So(e,t,n){return(t=yo(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ro(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=O,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),q&&(this.mutableSourceEagerHydrationData=null)}function Mo(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw Error(s(268,Object.keys(e)))}return null===(e=W(t))?null:e.stateNode}function Wo(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ko(e,t){Wo(e,t),(e=e.alternate)&&Wo(e,t)}function Vo(e){return null===(e=W(e))?null:e.stateNode}function Fo(){return null}return r.IsThisRendererActing=Co,r.act=function(e){function t(){mo--,ta.current=n,Co.current=r}!1===vo&&(vo=!0,console.error("act(...) is not supported in production builds of React, and might not behave as expected.")),mo++;var n=ta.current,r=Co.current;ta.current=!0,Co.current=!0;try{var i=Ka(e)}catch(a){throw t(),a}if(null!==i&&"object"===typeof i&&"function"===typeof i.then)return{then:function(e,r){i.then((function(){1<mo||!0===fo&&!0===n?(t(),e()):Ao((function(n){t(),n?r(n):e()}))}),(function(e){t(),r(e)}))}};try{1!==mo||!1!==fo&&!1!==n||po(),t()}catch(a){throw t(),a}return{then:function(e){e()}}},r.attemptContinuousHydration=function(e){13===e.tag&&(Ha(e,67108864,Ea()),ko(e,67108864))},r.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=Ea(),n=Xa(e);Ha(e,n,t),ko(e,n)}},r.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.hydrate){var n=ht(t.pendingLanes);t.expiredLanes|=n&t.pendingLanes,za(t,Tt()),0===(48&na)&&(pa(),Ot())}break;case 13:var r=Ea();Da((function(){return Ha(e,1,r)})),ko(e,4)}},r.attemptUserBlockingHydration=function(e){13===e.tag&&(Ha(e,4,Ea()),ko(e,4))},r.batchedEventUpdates=function(e,t){var n=na;na|=2;try{return e(t)}finally{0===(na=n)&&(pa(),Ot())}},r.batchedUpdates=Ka,r.createComponentSelector=function(e){return{$$typeof:zi,value:e}},r.createContainer=function(e,t,n){return e=new Ro(e,t,n),t=yo(3,null,null,2===t?7:1===t?3:0),e.current=t,t.stateNode=e,Cn(t),e},r.createHasPsuedoClassSelector=function(e){return{$$typeof:Ni,value:e}},r.createPortal=function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:c,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}},r.createRoleSelector=function(e){return{$$typeof:Yi,value:e}},r.createTestNameSelector=function(e){return{$$typeof:Ti,value:e}},r.createTextSelector=function(e){return{$$typeof:Ki,value:e}},r.deferredUpdates=function(e){return Pt(97,e)},r.discreteUpdates=function(e,t,n,r,i){var a=na;na|=4;try{return Pt(98,e.bind(null,t,n,r,i))}finally{0===(na=a)&&(pa(),Ot())}},r.findAllNodes=Qi,r.findBoundingRects=function(e,t){if(!ae)throw Error(s(363));t=Qi(e,t),e=[];for(var n=0;n<t.length;n++)e.push(se(t[n]));for(t=e.length-1;0<t;t--)for(var r=(n=e[t]).x,i=r+n.width,a=n.y,o=a+n.height,u=t-1;0<=u;u--)if(t!==u){var l=e[u],c=l.x,g=c+l.width,d=l.y,I=d+l.height;if(r>=c&&a>=d&&i<=g&&o<=I){e.splice(t,1);break}if(!(r!==c||n.width!==l.width||I<a||d>o)){d>a&&(l.height+=d-a,l.y=a),I<o&&(l.height=o-d),e.splice(t,1);break}if(!(a!==d||n.height!==l.height||g<r||c>i)){c>r&&(l.width+=c-r,l.x=r),g<i&&(l.width=i-c),e.splice(t,1);break}}return e},r.findHostInstance=Mo,r.findHostInstanceWithNoPortals=function(e){return null===(e=function(e){if(!(e=M(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child&&4!==t.tag)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}(e))?null:20===e.tag?e.stateNode.instance:e.stateNode},r.findHostInstanceWithWarning=function(e){return Mo(e)},r.flushControlled=function(e){var t=na;na|=1;try{Pt(99,e)}finally{0===(na=t)&&(pa(),Ot())}},r.flushDiscreteUpdates=function(){0===(49&na)&&(function(){if(null!==xa){var e=xa;xa=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,za(e,Tt())}))}Ot()}(),ao())},r.flushPassiveEffects=ao,r.flushSync=Da,r.focusWithin=function(e,t){if(!ae)throw Error(s(363));for(t=Ji(e=Pi(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++];if(!le(n)){if(5===n.tag&&ge(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},r.getCurrentUpdateLanePriority=function(){return It},r.getFindAllNodesFailureDescription=function(e,t){if(!ae)throw Error(s(363));var n=0,r=[];e=[Pi(e),0];for(var i=0;i<e.length;){var a=e[i++],o=e[i++],u=t[o];if((5!==a.tag||!le(a))&&(Ui(a,u)&&(r.push(Oi(u)),++o>n&&(n=o)),o<t.length))for(a=a.child;null!==a;)e.push(a,o),a=a.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(Oi(t[n]));return"findAllNodes was able to match part of the selector:\n  "+r.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},r.getPublicRootInstance=function(e){return(e=e.current).child?5===e.child.tag?F(e.child.stateNode):e.child.stateNode:null},r.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:u.ReactCurrentDispatcher,findHostInstanceByFiber:Vo,findFiberByHostInstance:e.findFiberByHostInstance||Fo,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null},"undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!t.isDisabled&&t.supportsFiber)try{gt=t.inject(e),dt=t}catch(n){}e=!0}return e},r.observeVisibleRects=function(e,t,n,r){if(!ae)throw Error(s(363));e=Qi(e,t);var i=de(e,n,r).disconnect;return{disconnect:function(){i()}}},r.registerMutableSourceForHydration=function(e,t){var n=t._getVersion;n=n(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n)},r.runWithPriority=function(e,t){var n=It;try{return It=e,t()}finally{It=n}},r.shouldSuspend=function(){return!1},r.unbatchedUpdates=function(e,t){var n=na;na&=-2,na|=8;try{return e(t)}finally{0===(na=n)&&(pa(),Ot())}},r.updateContainer=function(e,t,n,r){var i=t.current,a=Ea(),o=Xa(i);e:if(n){t:{if(S(n=n._reactInternals)!==n||1!==n.tag)throw Error(s(170));var u=n;do{switch(u.tag){case 3:u=u.stateNode.context;break t;case 1:if(at(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break t}}u=u.return}while(null!==u);throw Error(s(171))}if(1===n.tag){var l=n.type;if(at(l)){n=ut(n,l,u);break e}}n=u}else n=et;return null===t.context?t.context=n:t.pendingContext=n,(t=fn(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),pn(i,t),Ha(i,o,a),o},r}},438:function(e,t,n){"use strict";e.exports=n(1614)},3238:function(e,t,n){"use strict";n(8105);var r=n(4519),i=60103;if(t.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var a=Symbol.for;i=a("react.element"),t.Fragment=a("react.fragment")}var o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s=Object.prototype.hasOwnProperty,u={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,a={},l=null,c=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)s.call(t,r)&&!u.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:l,ref:c,props:a,_owner:o.current}}t.jsx=l,t.jsxs=l},3149:function(e,t,n){"use strict";var r=n(8105),i=60103,a=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var o=60109,s=60110,u=60112;t.Suspense=60113;var l=60115,c=60116;if("function"===typeof Symbol&&Symbol.for){var g=Symbol.for;i=g("react.element"),a=g("react.portal"),t.Fragment=g("react.fragment"),t.StrictMode=g("react.strict_mode"),t.Profiler=g("react.profiler"),o=g("react.provider"),s=g("react.context"),u=g("react.forward_ref"),t.Suspense=g("react.suspense"),l=g("react.memo"),c=g("react.lazy")}var d="function"===typeof Symbol&&Symbol.iterator;function I(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},h={};function f(e,t,n){this.props=e,this.context=t,this.refs=h,this.updater=n||C}function p(){}function A(e,t,n){this.props=e,this.context=t,this.refs=h,this.updater=n||C}f.prototype.isReactComponent={},f.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(I(85));this.updater.enqueueSetState(this,e,t,"setState")},f.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},p.prototype=f.prototype;var m=A.prototype=new p;m.constructor=A,r(m,f.prototype),m.isPureReactComponent=!0;var v={current:null},b=Object.prototype.hasOwnProperty,y={key:!0,ref:!0,__self:!0,__source:!0};function B(e,t,n){var r,a={},o=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)b.call(t,r)&&!y.hasOwnProperty(r)&&(a[r]=t[r]);var u=arguments.length-2;if(1===u)a.children=n;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(r in u=e.defaultProps)void 0===a[r]&&(a[r]=u[r]);return{$$typeof:i,type:e,key:o,ref:s,props:a,_owner:v.current}}function G(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var Z=/\/+/g;function w(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function _(e,t,n,r,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case i:case a:u=!0}}if(u)return o=o(u=e),e=""===r?"."+w(u,0):r,Array.isArray(o)?(n="",null!=e&&(n=e.replace(Z,"$&/")+"/"),_(o,t,n,"",(function(e){return e}))):null!=o&&(G(o)&&(o=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,n+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(Z,"$&/")+"/")+e)),t.push(o)),1;if(u=0,r=""===r?".":r+":",Array.isArray(e))for(var l=0;l<e.length;l++){var c=r+w(s=e[l],l);u+=_(s,t,n,c,o)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),l=0;!(s=e.next()).done;)u+=_(s=s.value,t,n,c=r+w(s,l++),o);else if("object"===s)throw t=""+e,Error(I(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return u}function x(e,t,n){if(null==e)return e;var r=[],i=0;return _(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function S(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var R={current:null};function M(){var e=R.current;if(null===e)throw Error(I(321));return e}var W={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:v,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:x,forEach:function(e,t,n){x(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return x(e,(function(){t++})),t},toArray:function(e){return x(e,(function(e){return e}))||[]},only:function(e){if(!G(e))throw Error(I(143));return e}},t.Component=f,t.PureComponent=A,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(I(267,e));var a=r({},e.props),o=e.key,s=e.ref,u=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,u=v.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)b.call(t,c)&&!y.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=n;else if(1<c){l=Array(c);for(var g=0;g<c;g++)l[g]=arguments[g+2];a.children=l}return{$$typeof:i,type:e.type,key:o,ref:s,props:a,_owner:u}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:s,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=B,t.createFactory=function(e){var t=B.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=G,t.lazy=function(e){return{$$typeof:c,_payload:{_status:-1,_result:e},_init:S}},t.memo=function(e,t){return{$$typeof:l,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return M().useCallback(e,t)},t.useContext=function(e,t){return M().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return M().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return M().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return M().useLayoutEffect(e,t)},t.useMemo=function(e,t){return M().useMemo(e,t)},t.useReducer=function(e,t,n){return M().useReducer(e,t,n)},t.useRef=function(e){return M().useRef(e)},t.useState=function(e){return M().useState(e)},t.version="17.0.2"},4519:function(e,t,n){"use strict";e.exports=n(3149)},2556:function(e,t,n){"use strict";e.exports=n(3238)},9780:function(e){var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(M){u=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof f?t:f,a=Object.create(i.prototype),o=new x(r||[]);return a._invoke=function(e,t,n){var r=g;return function(i,a){if(r===I)throw new Error("Generator is already running");if(r===C){if("throw"===i)throw a;return R()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=Z(o,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===g)throw r=C,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=I;var u=c(e,t,n);if("normal"===u.type){if(r=n.done?C:d,u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=C,n.method="throw",n.arg=u.arg)}}}(e,n,o),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(M){return{type:"throw",arg:M}}}e.wrap=l;var g="suspendedStart",d="suspendedYield",I="executing",C="completed",h={};function f(){}function p(){}function A(){}var m={};u(m,a,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(S([])));b&&b!==n&&r.call(b,a)&&(m=b);var y=A.prototype=f.prototype=Object.create(m);function B(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function G(e,t){function n(i,a,o,s){var u=c(e[i],e,a);if("throw"!==u.type){var l=u.arg,g=l.value;return g&&"object"===typeof g&&r.call(g,"__await")?t.resolve(g.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(g).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}))}s(u.arg)}var i;this._invoke=function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}}function Z(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,Z(e,n),"throw"===n.method))return h;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var i=c(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function S(e){if(e){var n=e[a];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:R}}function R(){return{value:t,done:!0}}return p.prototype=A,u(y,"constructor",A),u(A,"constructor",p),p.displayName=u(A,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,A):(e.__proto__=A,u(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},B(G.prototype),u(G.prototype,o,(function(){return this})),e.AsyncIterator=G,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new G(l(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},B(y),u(y,s,"Generator"),u(y,a,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=S,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:S(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),h}},e}(e.exports);try{regeneratorRuntime=t}catch(n){"object"===typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},7154:function(e,t){"use strict";var n,r,i,a;if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var l=null,c=null,g=function e(){if(null!==l)try{var n=t.unstable_now();l(!0,n),l=null}catch(r){throw setTimeout(e,0),r}};n=function(e){null!==l?setTimeout(n,0,e):(l=e,setTimeout(g,0))},r=function(e,t){c=setTimeout(e,t)},i=function(){clearTimeout(c)},t.unstable_shouldYield=function(){return!1},a=t.unstable_forceFrameRate=function(){}}else{var d=window.setTimeout,I=window.clearTimeout;if("undefined"!==typeof console){var C=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof C&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var h=!1,f=null,p=-1,A=5,m=0;t.unstable_shouldYield=function(){return t.unstable_now()>=m},a=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5};var v=new MessageChannel,b=v.port2;v.port1.onmessage=function(){if(null!==f){var e=t.unstable_now();m=e+A;try{f(!0,e)?b.postMessage(null):(h=!1,f=null)}catch(n){throw b.postMessage(null),n}}else h=!1},n=function(e){f=e,h||(h=!0,b.postMessage(null))},r=function(e,n){p=d((function(){e(t.unstable_now())}),n)},i=function(){I(p),p=-1}}function y(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<Z(i,t)))break e;e[r]=t,e[n]=i,n=r}}function B(e){return void 0===(e=e[0])?null:e}function G(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var a=2*(r+1)-1,o=e[a],s=a+1,u=e[s];if(void 0!==o&&0>Z(o,n))void 0!==u&&0>Z(u,o)?(e[r]=u,e[s]=n,r=s):(e[r]=o,e[a]=n,r=a);else{if(!(void 0!==u&&0>Z(u,n)))break e;e[r]=u,e[s]=n,r=s}}}return t}return null}function Z(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var w=[],_=[],x=1,S=null,R=3,M=!1,W=!1,k=!1;function V(e){for(var t=B(_);null!==t;){if(null===t.callback)G(_);else{if(!(t.startTime<=e))break;G(_),t.sortIndex=t.expirationTime,y(w,t)}t=B(_)}}function F(e){if(k=!1,V(e),!W)if(null!==B(w))W=!0,n(E);else{var t=B(_);null!==t&&r(F,t.startTime-e)}}function E(e,n){W=!1,k&&(k=!1,i()),M=!0;var a=R;try{for(V(n),S=B(w);null!==S&&(!(S.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=S.callback;if("function"===typeof o){S.callback=null,R=S.priorityLevel;var s=o(S.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?S.callback=s:S===B(w)&&G(w),V(n)}else G(w);S=B(w)}if(null!==S)var u=!0;else{var l=B(_);null!==l&&r(F,l.startTime-n),u=!1}return u}finally{S=null,R=a,M=!1}}var X=a;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){W||M||(W=!0,n(E))},t.unstable_getCurrentPriorityLevel=function(){return R},t.unstable_getFirstCallbackNode=function(){return B(w)},t.unstable_next=function(e){switch(R){case 1:case 2:case 3:var t=3;break;default:t=R}var n=R;R=t;try{return e()}finally{R=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=X,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=R;R=e;try{return t()}finally{R=n}},t.unstable_scheduleCallback=function(e,a,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return e={id:x++,callback:a,priorityLevel:e,startTime:o,expirationTime:u=o+u,sortIndex:-1},o>s?(e.sortIndex=o,y(_,e),null===B(w)&&e===B(_)&&(k?i():k=!0,r(F,o-s))):(e.sortIndex=u,y(w,e),W||M||(W=!0,n(E))),e},t.unstable_wrapCallback=function(e){var t=R;return function(){var n=R;R=t;try{return e.apply(this,arguments)}finally{R=n}}}},8514:function(e,t,n){"use strict";e.exports=n(7154)},4911:function(e,t,n){"use strict";n.r(t),n.d(t,{ACESFilmicToneMapping:function(){return pe},AddEquation:function(){return z},AddOperation:function(){return de},AdditiveAnimationBlendMode:function(){return un},AdditiveBlending:function(){return E},AlphaFormat:function(){return je},AlwaysDepth:function(){return re},AlwaysStencilFunc:function(){return Ln},AmbientLight:function(){return Og},AmbientLightProbe:function(){return pd},AnimationClip:function(){return Jc},AnimationLoader:function(){return rg},AnimationMixer:function(){return Qd},AnimationObjectGroup:function(){return Od},AnimationUtils:function(){return Ec},ArcCurve:function(){return gg},ArrayCamera:function(){return lu},ArrowHelper:function(){return zI},Audio:function(){return xd},AudioAnalyser:function(){return Vd},AudioContext:function(){return Cd},AudioListener:function(){return _d},AudioLoader:function(){return hd},AxesHelper:function(){return NI},AxisHelper:function(){return zC},BackSide:function(){return R},BasicDepthPacking:function(){return vn},BasicShadowMap:function(){return Z},BinaryTextureLoader:function(){return DC},Bone:function(){return Ou},BooleanKeyframeTrack:function(){return Yc},BoundingBoxHelper:function(){return NC},Box2:function(){return oI},Box3:function(){return Zr},Box3Helper:function(){return XI},BoxBufferGeometry:function(){return La},BoxGeometry:function(){return La},BoxHelper:function(){return EI},BufferAttribute:function(){return qi},BufferGeometry:function(){return ma},BufferGeometryLoader:function(){return nd},ByteType:function(){return ze},Cache:function(){return jc},Camera:function(){return Ka},CameraHelper:function(){return MI},CanvasRenderer:function(){return UC},CanvasTexture:function(){return Bl},CatmullRomCurve3:function(){return pg},CineonToneMapping:function(){return fe},CircleBufferGeometry:function(){return Zl},CircleGeometry:function(){return Zl},ClampToEdgeWrapping:function(){return _e},Clock:function(){return bd},Color:function(){return Oi},ColorKeyframeTrack:function(){return Tc},CompressedTexture:function(){return yl},CompressedTextureLoader:function(){return ig},ConeBufferGeometry:function(){return _l},ConeGeometry:function(){return _l},CubeCamera:function(){return Ua},CubeReflectionMapping:function(){return ve},CubeRefractionMapping:function(){return be},CubeTexture:function(){return Oa},CubeTextureLoader:function(){return og},CubeUVReflectionMapping:function(){return Ge},CubeUVRefractionMapping:function(){return Ze},CubicBezierCurve:function(){return bg},CubicBezierCurve3:function(){return yg},CubicInterpolant:function(){return Hc},CullFaceBack:function(){return y},CullFaceFront:function(){return B},CullFaceFrontBack:function(){return G},CullFaceNone:function(){return b},Curve:function(){return lg},CurvePath:function(){return Sg},CustomBlending:function(){return L},CustomToneMapping:function(){return Ae},CylinderBufferGeometry:function(){return wl},CylinderGeometry:function(){return wl},Cylindrical:function(){return iI},DataTexture:function(){return Qa},DataTexture2DArray:function(){return bo},DataTexture3D:function(){return yo},DataTextureLoader:function(){return sg},DataUtils:function(){return KI},DecrementStencilOp:function(){return xn},DecrementWrapStencilOp:function(){return Rn},DefaultLoadingManager:function(){return $c},DepthFormat:function(){return rt},DepthStencilFormat:function(){return it},DepthTexture:function(){return Gl},DirectionalLight:function(){return Ug},DirectionalLightHelper:function(){return xI},DiscreteInterpolant:function(){return zc},DodecahedronBufferGeometry:function(){return Sl},DodecahedronGeometry:function(){return Sl},DoubleSide:function(){return M},DstAlphaFactor:function(){return j},DstColorFactor:function(){return $},DynamicBufferAttribute:function(){return RC},DynamicCopyUsage:function(){return Un},DynamicDrawUsage:function(){return Nn},DynamicReadUsage:function(){return Kn},EdgesGeometry:function(){return Vl},EdgesHelper:function(){return YC},EllipseCurve:function(){return cg},EqualDepth:function(){return oe},EqualStencilFunc:function(){return Vn},EquirectangularReflectionMapping:function(){return ye},EquirectangularRefractionMapping:function(){return Be},Euler:function(){return li},EventDispatcher:function(){return jn},ExtrudeBufferGeometry:function(){return lc},ExtrudeGeometry:function(){return lc},FaceColors:function(){return mC},FileLoader:function(){return ng},FlatShading:function(){return W},Float16BufferAttribute:function(){return oa},Float32Attribute:function(){return HC},Float32BufferAttribute:function(){return sa},Float64Attribute:function(){return LC},Float64BufferAttribute:function(){return ua},FloatType:function(){return De},Fog:function(){return Au},FogExp2:function(){return pu},Font:function(){return ld},FontLoader:function(){return Id},FrontSide:function(){return S},Frustum:function(){return $a},GLBufferAttribute:function(){return $d},GLSL1:function(){return Jn},GLSL3:function(){return Qn},GammaEncoding:function(){return Cn},GreaterDepth:function(){return ue},GreaterEqualDepth:function(){return se},GreaterEqualStencilFunc:function(){return Hn},GreaterStencilFunc:function(){return En},GridHelper:function(){return BI},Group:function(){return cu},HalfFloatType:function(){return Pe},HemisphereLight:function(){return kg},HemisphereLightHelper:function(){return yI},HemisphereLightProbe:function(){return fd},IcosahedronBufferGeometry:function(){return gc},IcosahedronGeometry:function(){return gc},ImageBitmapLoader:function(){return sd},ImageLoader:function(){return ag},ImageUtils:function(){return Cr},ImmediateRenderObject:function(){return cI},IncrementStencilOp:function(){return _n},IncrementWrapStencilOp:function(){return Sn},InstancedBufferAttribute:function(){return td},InstancedBufferGeometry:function(){return ed},InstancedInterleavedBuffer:function(){return qd},InstancedMesh:function(){return nl},Int16Attribute:function(){return VC},Int16BufferAttribute:function(){return na},Int32Attribute:function(){return EC},Int32BufferAttribute:function(){return ia},Int8Attribute:function(){return MC},Int8BufferAttribute:function(){return $i},IntType:function(){return Te},InterleavedBuffer:function(){return vu},InterleavedBufferAttribute:function(){return yu},Interpolant:function(){return Xc},InterpolateDiscrete:function(){return en},InterpolateLinear:function(){return tn},InterpolateSmooth:function(){return nn},InvertStencilOp:function(){return Mn},JSONLoader:function(){return OC},KeepStencilOp:function(){return Zn},KeyframeTrack:function(){return Nc},LOD:function(){return Nu},LatheBufferGeometry:function(){return dc},LatheGeometry:function(){return dc},Layers:function(){return ci},LensFlare:function(){return QC},LessDepth:function(){return ie},LessEqualDepth:function(){return ae},LessEqualStencilFunc:function(){return Fn},LessStencilFunc:function(){return kn},Light:function(){return Wg},LightProbe:function(){return jg},Line:function(){return ll},Line3:function(){return lI},LineBasicMaterial:function(){return rl},LineCurve:function(){return Bg},LineCurve3:function(){return Gg},LineDashedMaterial:function(){return Vc},LineLoop:function(){return Il},LinePieces:function(){return pC},LineSegments:function(){return dl},LineStrip:function(){return fC},LinearEncoding:function(){return dn},LinearFilter:function(){return Ve},LinearInterpolant:function(){return Lc},LinearMipMapLinearFilter:function(){return He},LinearMipMapNearestFilter:function(){return Ee},LinearMipmapLinearFilter:function(){return Xe},LinearMipmapNearestFilter:function(){return Fe},LinearToneMapping:function(){return Ce},Loader:function(){return eg},LoaderUtils:function(){return $g},LoadingManager:function(){return qc},LogLuvEncoding:function(){return fn},LoopOnce:function(){return jt},LoopPingPong:function(){return $t},LoopRepeat:function(){return qt},LuminanceAlphaFormat:function(){return tt},LuminanceFormat:function(){return et},MOUSE:function(){return m},Material:function(){return Ni},MaterialLoader:function(){return qg},Math:function(){return cr},MathUtils:function(){return cr},Matrix3:function(){return Ir},Matrix4:function(){return $r},MaxEquation:function(){return K},Mesh:function(){return Xa},MeshBasicMaterial:function(){return Ji},MeshDepthMaterial:function(){return ru},MeshDistanceMaterial:function(){return iu},MeshFaceMaterial:function(){return bC},MeshLambertMaterial:function(){return Wc},MeshMatcapMaterial:function(){return kc},MeshNormalMaterial:function(){return Mc},MeshPhongMaterial:function(){return Sc},MeshPhysicalMaterial:function(){return xc},MeshStandardMaterial:function(){return _c},MeshToonMaterial:function(){return Rc},MinEquation:function(){return T},MirroredRepeatWrapping:function(){return xe},MixOperation:function(){return ge},MultiMaterial:function(){return yC},MultiplyBlending:function(){return H},MultiplyOperation:function(){return ce},NearestFilter:function(){return Se},NearestMipMapLinearFilter:function(){return ke},NearestMipMapNearestFilter:function(){return Me},NearestMipmapLinearFilter:function(){return We},NearestMipmapNearestFilter:function(){return Re},NeverDepth:function(){return ne},NeverStencilFunc:function(){return Wn},NoBlending:function(){return V},NoColors:function(){return AC},NoToneMapping:function(){return Ie},NormalAnimationBlendMode:function(){return sn},NormalBlending:function(){return F},NotEqualDepth:function(){return le},NotEqualStencilFunc:function(){return Xn},NumberKeyframeTrack:function(){return Kc},Object3D:function(){return Gi},ObjectLoader:function(){return rd},ObjectSpaceNormalMap:function(){return Bn},OctahedronBufferGeometry:function(){return Ic},OctahedronGeometry:function(){return Ic},OneFactor:function(){return P},OneMinusDstAlphaFactor:function(){return q},OneMinusDstColorFactor:function(){return ee},OneMinusSrcAlphaFactor:function(){return Q},OneMinusSrcColorFactor:function(){return O},OrthographicCamera:function(){return Dg},PCFShadowMap:function(){return w},PCFSoftShadowMap:function(){return _},PMREMGenerator:function(){return lC},ParametricBufferGeometry:function(){return Cc},ParametricGeometry:function(){return Cc},Particle:function(){return GC},ParticleBasicMaterial:function(){return _C},ParticleSystem:function(){return ZC},ParticleSystemMaterial:function(){return xC},Path:function(){return Rg},PerspectiveCamera:function(){return Da},Plane:function(){return xi},PlaneBufferGeometry:function(){return no},PlaneGeometry:function(){return no},PlaneHelper:function(){return HI},PointCloud:function(){return BC},PointCloudMaterial:function(){return wC},PointLight:function(){return Kg},PointLightHelper:function(){return AI},Points:function(){return ml},PointsMaterial:function(){return Cl},PolarGridHelper:function(){return GI},PolyhedronBufferGeometry:function(){return xl},PolyhedronGeometry:function(){return xl},PositionalAudio:function(){return kd},PropertyBinding:function(){return Ud},PropertyMixer:function(){return Fd},QuadraticBezierCurve:function(){return Zg},QuadraticBezierCurve3:function(){return wg},Quaternion:function(){return br},QuaternionKeyframeTrack:function(){return Pc},QuaternionLinearInterpolant:function(){return Dc},REVISION:function(){return A},RGBADepthPacking:function(){return bn},RGBAFormat:function(){return $e},RGBAIntegerFormat:function(){return ct},RGBA_ASTC_10x10_Format:function(){return kt},RGBA_ASTC_10x5_Format:function(){return Rt},RGBA_ASTC_10x6_Format:function(){return Mt},RGBA_ASTC_10x8_Format:function(){return Wt},RGBA_ASTC_12x10_Format:function(){return Vt},RGBA_ASTC_12x12_Format:function(){return Ft},RGBA_ASTC_4x4_Format:function(){return yt},RGBA_ASTC_5x4_Format:function(){return Bt},RGBA_ASTC_5x5_Format:function(){return Gt},RGBA_ASTC_6x5_Format:function(){return Zt},RGBA_ASTC_6x6_Format:function(){return wt},RGBA_ASTC_8x5_Format:function(){return _t},RGBA_ASTC_8x6_Format:function(){return xt},RGBA_ASTC_8x8_Format:function(){return St},RGBA_BPTC_Format:function(){return Et},RGBA_ETC2_EAC_Format:function(){return bt},RGBA_PVRTC_2BPPV1_Format:function(){return At},RGBA_PVRTC_4BPPV1_Format:function(){return pt},RGBA_S3TC_DXT1_Format:function(){return dt},RGBA_S3TC_DXT3_Format:function(){return It},RGBA_S3TC_DXT5_Format:function(){return Ct},RGBDEncoding:function(){return mn},RGBEEncoding:function(){return hn},RGBEFormat:function(){return nt},RGBFormat:function(){return qe},RGBIntegerFormat:function(){return lt},RGBM16Encoding:function(){return An},RGBM7Encoding:function(){return pn},RGB_ETC1_Format:function(){return mt},RGB_ETC2_Format:function(){return vt},RGB_PVRTC_2BPPV1_Format:function(){return ft},RGB_PVRTC_4BPPV1_Format:function(){return ht},RGB_S3TC_DXT1_Format:function(){return gt},RGFormat:function(){return st},RGIntegerFormat:function(){return ut},RawShaderMaterial:function(){return wc},Ray:function(){return qr},Raycaster:function(){return eI},RectAreaLight:function(){return Jg},RedFormat:function(){return at},RedIntegerFormat:function(){return ot},ReinhardToneMapping:function(){return he},RepeatWrapping:function(){return we},ReplaceStencilOp:function(){return wn},ReverseSubtractEquation:function(){return Y},RingBufferGeometry:function(){return hc},RingGeometry:function(){return hc},SRGB8_ALPHA8_ASTC_10x10_Format:function(){return Ot},SRGB8_ALPHA8_ASTC_10x5_Format:function(){return Dt},SRGB8_ALPHA8_ASTC_10x6_Format:function(){return Pt},SRGB8_ALPHA8_ASTC_10x8_Format:function(){return Ut},SRGB8_ALPHA8_ASTC_12x10_Format:function(){return Jt},SRGB8_ALPHA8_ASTC_12x12_Format:function(){return Qt},SRGB8_ALPHA8_ASTC_4x4_Format:function(){return Xt},SRGB8_ALPHA8_ASTC_5x4_Format:function(){return Ht},SRGB8_ALPHA8_ASTC_5x5_Format:function(){return Lt},SRGB8_ALPHA8_ASTC_6x5_Format:function(){return zt},SRGB8_ALPHA8_ASTC_6x6_Format:function(){return Nt},SRGB8_ALPHA8_ASTC_8x5_Format:function(){return Yt},SRGB8_ALPHA8_ASTC_8x6_Format:function(){return Tt},SRGB8_ALPHA8_ASTC_8x8_Format:function(){return Kt},Scene:function(){return mu},SceneUtils:function(){return JC},ShaderChunk:function(){return ro},ShaderLib:function(){return ao},ShaderMaterial:function(){return Ta},ShadowMaterial:function(){return Zc},Shape:function(){return Mg},ShapeBufferGeometry:function(){return fc},ShapeGeometry:function(){return fc},ShapePath:function(){return ud},ShapeUtils:function(){return oc},ShortType:function(){return Ne},Skeleton:function(){return ju},SkeletonHelper:function(){return fI},SkinnedMesh:function(){return Uu},SmoothShading:function(){return k},Sphere:function(){return Kr},SphereBufferGeometry:function(){return pc},SphereGeometry:function(){return pc},Spherical:function(){return rI},SphericalHarmonics3:function(){return Qg},SplineCurve:function(){return _g},SpotLight:function(){return Lg},SpotLightHelper:function(){return dI},Sprite:function(){return Xu},SpriteMaterial:function(){return Gu},SrcAlphaFactor:function(){return J},SrcAlphaSaturateFactor:function(){return te},SrcColorFactor:function(){return U},StaticCopyUsage:function(){return Pn},StaticDrawUsage:function(){return zn},StaticReadUsage:function(){return Tn},StereoCamera:function(){return vd},StreamCopyUsage:function(){return On},StreamDrawUsage:function(){return Yn},StreamReadUsage:function(){return Dn},StringKeyframeTrack:function(){return Uc},SubtractEquation:function(){return N},SubtractiveBlending:function(){return X},TOUCH:function(){return v},TangentSpaceNormalMap:function(){return yn},TetrahedronBufferGeometry:function(){return Ac},TetrahedronGeometry:function(){return Ac},TextBufferGeometry:function(){return mc},TextGeometry:function(){return mc},Texture:function(){return fr},TextureLoader:function(){return ug},TorusBufferGeometry:function(){return vc},TorusGeometry:function(){return vc},TorusKnotBufferGeometry:function(){return bc},TorusKnotGeometry:function(){return bc},Triangle:function(){return Li},TriangleFanDrawMode:function(){return gn},TriangleStripDrawMode:function(){return cn},TrianglesDrawMode:function(){return ln},TubeBufferGeometry:function(){return yc},TubeGeometry:function(){return yc},UVMapping:function(){return me},Uint16Attribute:function(){return FC},Uint16BufferAttribute:function(){return ra},Uint32Attribute:function(){return XC},Uint32BufferAttribute:function(){return aa},Uint8Attribute:function(){return WC},Uint8BufferAttribute:function(){return ea},Uint8ClampedAttribute:function(){return kC},Uint8ClampedBufferAttribute:function(){return ta},Uniform:function(){return jd},UniformsLib:function(){return io},UniformsUtils:function(){return Ya},UnsignedByteType:function(){return Le},UnsignedInt248Type:function(){return Qe},UnsignedIntType:function(){return Ke},UnsignedShort4444Type:function(){return Ue},UnsignedShort5551Type:function(){return Oe},UnsignedShort565Type:function(){return Je},UnsignedShortType:function(){return Ye},VSMShadowMap:function(){return x},Vector2:function(){return gr},Vector3:function(){return yr},Vector4:function(){return Ar},VectorKeyframeTrack:function(){return Oc},Vertex:function(){return SC},VertexColors:function(){return vC},VideoTexture:function(){return bl},WebGL1Renderer:function(){return fu},WebGLCubeRenderTarget:function(){return Ja},WebGLMultisampleRenderTarget:function(){return vr},WebGLRenderTarget:function(){return mr},WebGLRenderTargetCube:function(){return PC},WebGLRenderer:function(){return hu},WebGLUtils:function(){return uu},WireframeGeometry:function(){return Bc},WireframeHelper:function(){return TC},WrapAroundEnding:function(){return on},XHRLoader:function(){return KC},ZeroCurvatureEnding:function(){return rn},ZeroFactor:function(){return D},ZeroSlopeEnding:function(){return an},ZeroStencilOp:function(){return Gn},sRGBEncoding:function(){return In}});for(var r,i=n(5861),a=n(7762),o=n(4942),s=n(9439),u=n(6215),l=n(1752),c=n(1120),g=n(7326),d=n(136),I=n(9388),C=n(5671),h=n(3144),f=n(7757),p=n.n(f),A="128",m={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},v={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},b=0,y=1,B=2,G=3,Z=0,w=1,_=2,x=3,S=0,R=1,M=2,W=1,k=2,V=0,F=1,E=2,X=3,H=4,L=5,z=100,N=101,Y=102,T=103,K=104,D=200,P=201,U=202,O=203,J=204,Q=205,j=206,q=207,$=208,ee=209,te=210,ne=0,re=1,ie=2,ae=3,oe=4,se=5,ue=6,le=7,ce=0,ge=1,de=2,Ie=0,Ce=1,he=2,fe=3,pe=4,Ae=5,me=300,ve=301,be=302,ye=303,Be=304,Ge=306,Ze=307,we=1e3,_e=1001,xe=1002,Se=1003,Re=1004,Me=1004,We=1005,ke=1005,Ve=1006,Fe=1007,Ee=1007,Xe=1008,He=1008,Le=1009,ze=1010,Ne=1011,Ye=1012,Te=1013,Ke=1014,De=1015,Pe=1016,Ue=1017,Oe=1018,Je=1019,Qe=1020,je=1021,qe=1022,$e=1023,et=1024,tt=1025,nt=$e,rt=1026,it=1027,at=1028,ot=1029,st=1030,ut=1031,lt=1032,ct=1033,gt=33776,dt=33777,It=33778,Ct=33779,ht=35840,ft=35841,pt=35842,At=35843,mt=36196,vt=37492,bt=37496,yt=37808,Bt=37809,Gt=37810,Zt=37811,wt=37812,_t=37813,xt=37814,St=37815,Rt=37816,Mt=37817,Wt=37818,kt=37819,Vt=37820,Ft=37821,Et=36492,Xt=37840,Ht=37841,Lt=37842,zt=37843,Nt=37844,Yt=37845,Tt=37846,Kt=37847,Dt=37848,Pt=37849,Ut=37850,Ot=37851,Jt=37852,Qt=37853,jt=2200,qt=2201,$t=2202,en=2300,tn=2301,nn=2302,rn=2400,an=2401,on=2402,sn=2500,un=2501,ln=0,cn=1,gn=2,dn=3e3,In=3001,Cn=3007,hn=3002,fn=3003,pn=3004,An=3005,mn=3006,vn=3200,bn=3201,yn=0,Bn=1,Gn=0,Zn=7680,wn=7681,_n=7682,xn=7683,Sn=34055,Rn=34056,Mn=5386,Wn=512,kn=513,Vn=514,Fn=515,En=516,Xn=517,Hn=518,Ln=519,zn=35044,Nn=35048,Yn=35040,Tn=35045,Kn=35049,Dn=35041,Pn=35046,Un=35050,On=35042,Jn="100",Qn="300 es",jn=function(){function e(){(0,C.Z)(this,e)}return(0,h.Z)(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}}},{key:"dispatchEvent",value:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e);e.target=null}}}}]),e}(),qn=[],$n=0;$n<256;$n++)qn[$n]=($n<16?"0":"")+$n.toString(16);var er=1234567,tr=Math.PI/180,nr=180/Math.PI;function rr(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(qn[255&e]+qn[e>>8&255]+qn[e>>16&255]+qn[e>>24&255]+"-"+qn[255&t]+qn[t>>8&255]+"-"+qn[t>>16&15|64]+qn[t>>24&255]+"-"+qn[63&n|128]+qn[n>>8&255]+"-"+qn[n>>16&255]+qn[n>>24&255]+qn[255&r]+qn[r>>8&255]+qn[r>>16&255]+qn[r>>24&255]).toUpperCase()}function ir(e,t,n){return Math.max(t,Math.min(n,e))}function ar(e,t){return(e%t+t)%t}function or(e,t,n){return(1-n)*e+n*t}function sr(e){return 0===(e&e-1)&&0!==e}function ur(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function lr(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}var cr=Object.freeze({__proto__:null,DEG2RAD:tr,RAD2DEG:nr,generateUUID:rr,clamp:ir,euclideanModulo:ar,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:or,damp:function(e,t,n,r){return or(e,t,1-Math.exp(-n*r))},pingpong:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(ar(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&(er=e%2147483647),((er=16807*er%2147483647)-1)/2147483646},degToRad:function(e){return e*tr},radToDeg:function(e){return e*nr},isPowerOfTwo:sr,ceilPowerOfTwo:ur,floorPowerOfTwo:lr,setQuaternionFromProperEuler:function(e,t,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),u=o(n/2),l=a((t+r)/2),c=o((t+r)/2),g=a((t-r)/2),d=o((t-r)/2),I=a((r-t)/2),C=o((r-t)/2);switch(i){case"XYX":e.set(s*c,u*g,u*d,s*l);break;case"YZY":e.set(u*d,s*c,u*g,s*l);break;case"ZXZ":e.set(u*g,u*d,s*c,s*l);break;case"XZX":e.set(s*c,u*C,u*I,s*l);break;case"YXY":e.set(u*I,s*c,u*C,s*l);break;case"ZYZ":e.set(u*C,u*I,s*c,s*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}}),gr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.Z)(this,e),this.x=t,this.y=n}return(0,h.Z)(e,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){var e=Math.atan2(-this.y,-this.x)+Math.PI;return e}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}}]),e}();gr.prototype.isVector2=!0;var dr,Ir=function(){function e(){(0,C.Z)(this,e),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}return(0,h.Z)(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,u){var l=this.elements;return l[0]=e,l[1]=r,l[2]=o,l[3]=t,l[4]=i,l[5]=s,l[6]=n,l[7]=a,l[8]=u,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],u=n[1],l=n[4],c=n[7],g=n[2],d=n[5],I=n[8],C=r[0],h=r[3],f=r[6],p=r[1],A=r[4],m=r[7],v=r[2],b=r[5],y=r[8];return i[0]=a*C+o*p+s*v,i[3]=a*h+o*A+s*b,i[6]=a*f+o*m+s*y,i[1]=u*C+l*p+c*v,i[4]=u*h+l*A+c*b,i[7]=u*f+l*m+c*y,i[2]=g*C+d*p+I*v,i[5]=g*h+d*A+I*b,i[8]=g*f+d*m+I*y,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8];return t*a*l-t*o*u-n*i*l+n*o*s+r*i*u-r*a*s}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=l*a-o*u,g=o*s-l*i,d=u*i-a*s,I=t*c+n*g+r*d;if(0===I)return this.set(0,0,0,0,0,0,0,0,0);var C=1/I;return e[0]=c*C,e[1]=(r*u-l*n)*C,e[2]=(o*n-r*a)*C,e[3]=g*C,e[4]=(l*t-r*s)*C,e[5]=(r*i-o*t)*C,e[6]=d*C,e[7]=(n*s-u*t)*C,e[8]=(a*t-n*i)*C,this}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}},{key:"getNormalMatrix",value:function(e){return this.setFromMatrix4(e).invert().transpose()}},{key:"transposeIntoArray",value:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},{key:"setUvTransform",value:function(e,t,n,r,i,a,o){var s=Math.cos(i),u=Math.sin(i);return this.set(n*s,n*u,-n*(s*a+u*o)+a+e,-r*u,r*s,-r*(-u*a+s*o)+o+t,0,0,1),this}},{key:"scale",value:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],a=r[3],o=r[6],s=r[1],u=r[4],l=r[7];return r[0]=t*i+n*s,r[3]=t*a+n*u,r[6]=t*o+n*l,r[1]=-n*i+t*s,r[4]=-n*a+t*u,r[7]=-n*o+t*l,this}},{key:"translate",value:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<9;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),e}();Ir.prototype.isMatrix3=!0;var Cr=function(){function e(){(0,C.Z)(this,e)}return(0,h.Z)(e,null,[{key:"getDataURL",value:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===dr&&(dr=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),dr.width=e.width,dr.height=e.height;var n=dr.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=dr}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}}]),e}(),hr=0,fr=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.DEFAULT_IMAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_MAPPING,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_e,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_e,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ve,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Xe,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:$e,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Le,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,I=arguments.length>9&&void 0!==arguments[9]?arguments[9]:dn;return(0,C.Z)(this,n),e=t.call(this),Object.defineProperty((0,g.Z)(e),"id",{value:hr++}),e.uuid=rr(),e.name="",e.image=r,e.mipmaps=[],e.mapping=i,e.wrapS=a,e.wrapT=o,e.magFilter=s,e.minFilter=u,e.anisotropy=d,e.format=l,e.internalFormat=null,e.type=c,e.offset=new gr(0,0),e.repeat=new gr(1,1),e.center=new gr(0,0),e.rotation=0,e.matrixAutoUpdate=!0,e.matrix=new Ir,e.generateMipmaps=!0,e.premultiplyAlpha=!1,e.flipY=!0,e.unpackAlignment=4,e.encoding=I,e.version=0,e.onUpdate=null,e}return(0,h.Z)(n,[{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=rr()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var a=0,o=r.length;a<o;a++)r[a].isDataTexture?i.push(pr(r[a].image)):i.push(pr(r[a]))}else i=pr(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(e){if(this.mapping!==me)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case we:e.x=e.x-Math.floor(e.x);break;case _e:e.x=e.x<0?0:1;break;case xe:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case we:e.y=e.y-Math.floor(e.y);break;case _e:e.y=e.y<0?0:1;break;case xe:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),n}(jn);function pr(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?Cr.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}fr.DEFAULT_IMAGE=void 0,fr.DEFAULT_MAPPING=me,fr.prototype.isTexture=!0;var Ar=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,C.Z)(this,e),this.x=t,this.y=n,this.z=r,this.w=i}return(0,h.Z)(e,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}},{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"setAxisAngleFromQuaternion",value:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}},{key:"setAxisAngleFromRotationMatrix",value:function(e){var t,n,r,i,a=.01,o=.1,s=e.elements,u=s[0],l=s[4],c=s[8],g=s[1],d=s[5],I=s[9],C=s[2],h=s[6],f=s[10];if(Math.abs(l-g)<a&&Math.abs(c-C)<a&&Math.abs(I-h)<a){if(Math.abs(l+g)<o&&Math.abs(c+C)<o&&Math.abs(I+h)<o&&Math.abs(u+d+f-3)<o)return this.set(1,0,0,0),this;t=Math.PI;var p=(u+1)/2,A=(d+1)/2,m=(f+1)/2,v=(l+g)/4,b=(c+C)/4,y=(I+h)/4;return p>A&&p>m?p<a?(n=0,r=.707106781,i=.707106781):(r=v/(n=Math.sqrt(p)),i=b/n):A>m?A<a?(n=.707106781,r=0,i=.707106781):(n=v/(r=Math.sqrt(A)),i=y/r):m<a?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(m)),r=y/i),this.set(n,r,i,t),this}var B=Math.sqrt((h-I)*(h-I)+(c-C)*(c-C)+(g-l)*(g-l));return Math.abs(B)<.001&&(B=1),this.x=(h-I)/B,this.y=(c-C)/B,this.z=(g-l)/B,this.w=Math.acos((u+d+f-1)/2),this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}]),e}();Ar.prototype.isVector4=!0;var mr=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){var a;return(0,C.Z)(this,n),(a=t.call(this)).width=e,a.height=r,a.depth=1,a.scissor=new Ar(0,0,e,r),a.scissorTest=!1,a.viewport=new Ar(0,0,e,r),i=i||{},a.texture=new fr(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),a.texture.image={},a.texture.image.width=e,a.texture.image.height=r,a.texture.image.depth=1,a.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,a.texture.minFilter=void 0!==i.minFilter?i.minFilter:Ve,a.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,a.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,a.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,a}return(0,h.Z)(n,[{key:"setTexture",value:function(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}},{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(jn);mr.prototype.isWebGLRenderTarget=!0;var vr=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){var a;return(0,C.Z)(this,n),(a=t.call(this,e,r,i)).samples=4,a}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.samples=e.samples,this}}]),n}(mr);vr.prototype.isWebGLMultisampleRenderTarget=!0;var br=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,C.Z)(this,e),this._x=t,this._y=n,this._z=r,this._w=i}return(0,h.Z)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,a=e._order,o=Math.cos,s=Math.sin,u=o(n/2),l=o(r/2),c=o(i/2),g=s(n/2),d=s(r/2),I=s(i/2);switch(a){case"XYZ":this._x=g*l*c+u*d*I,this._y=u*d*c-g*l*I,this._z=u*l*I+g*d*c,this._w=u*l*c-g*d*I;break;case"YXZ":this._x=g*l*c+u*d*I,this._y=u*d*c-g*l*I,this._z=u*l*I-g*d*c,this._w=u*l*c+g*d*I;break;case"ZXY":this._x=g*l*c-u*d*I,this._y=u*d*c+g*l*I,this._z=u*l*I+g*d*c,this._w=u*l*c-g*d*I;break;case"ZYX":this._x=g*l*c-u*d*I,this._y=u*d*c+g*l*I,this._z=u*l*I-g*d*c,this._w=u*l*c+g*d*I;break;case"YZX":this._x=g*l*c+u*d*I,this._y=u*d*c+g*l*I,this._z=u*l*I-g*d*c,this._w=u*l*c-g*d*I;break;case"XZY":this._x=g*l*c-u*d*I,this._y=u*d*c-g*l*I,this._z=u*l*I+g*d*c,this._w=u*l*c+g*d*I;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],o=t[5],s=t[9],u=t[2],l=t[6],c=t[10],g=n+o+c;if(g>0){var d=.5/Math.sqrt(g+1);this._w=.25/d,this._x=(l-s)*d,this._y=(i-u)*d,this._z=(a-r)*d}else if(n>o&&n>c){var I=2*Math.sqrt(1+n-o-c);this._w=(l-s)/I,this._x=.25*I,this._y=(r+a)/I,this._z=(i+u)/I}else if(o>c){var C=2*Math.sqrt(1+o-n-c);this._w=(i-u)/C,this._x=(r+a)/C,this._y=.25*C,this._z=(s+l)/C}else{var h=2*Math.sqrt(1+c-n-o);this._w=(a-r)/h,this._x=(i+u)/h,this._y=(s+l)/h,this._z=.25*h}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(e,t){var n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}},{key:"angleTo",value:function(e){return 2*Math.acos(Math.abs(ir(this.dot(e),-1,1)))}},{key:"rotateTowards",value:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}},{key:"premultiply",value:function(e){return this.multiplyQuaternions(e,this)}},{key:"multiplyQuaternions",value:function(e,t){var n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,u=t._z,l=t._w;return this._x=n*l+a*o+r*u-i*s,this._y=r*l+a*s+i*o-n*u,this._z=i*l+a*u+n*s-r*o,this._w=a*l-n*o-r*s-i*u,this._onChangeCallback(),this}},{key:"slerp",value:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var u=1-t;return this._w=u*a+t*this._w,this._x=u*n+t*this._x,this._y=u*r+t*this._y,this._z=u*i+t*this._z,this.normalize(),this._onChangeCallback(),this}var l=Math.sqrt(s),c=Math.atan2(l,o),g=Math.sin((1-t)*c)/l,d=Math.sin(t*c)/l;return this._w=a*g+this._w*d,this._x=n*g+this._x*d,this._y=r*g+this._y*d,this._z=i*g+this._z*d,this._onChangeCallback(),this}},{key:"slerpQuaternions",value:function(e,t,n){this.copy(e).slerp(t,n)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}},{key:"fromBufferAttribute",value:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}],[{key:"slerp",value:function(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)}},{key:"slerpFlat",value:function(e,t,n,r,i,a,o){var s=n[r+0],u=n[r+1],l=n[r+2],c=n[r+3],g=i[a+0],d=i[a+1],I=i[a+2],C=i[a+3];if(0===o)return e[t+0]=s,e[t+1]=u,e[t+2]=l,void(e[t+3]=c);if(1===o)return e[t+0]=g,e[t+1]=d,e[t+2]=I,void(e[t+3]=C);if(c!==C||s!==g||u!==d||l!==I){var h=1-o,f=s*g+u*d+l*I+c*C,p=f>=0?1:-1,A=1-f*f;if(A>Number.EPSILON){var m=Math.sqrt(A),v=Math.atan2(m,f*p);h=Math.sin(h*v)/m,o=Math.sin(o*v)/m}var b=o*p;if(s=s*h+g*b,u=u*h+d*b,l=l*h+I*b,c=c*h+C*b,h===1-o){var y=1/Math.sqrt(s*s+u*u+l*l+c*c);s*=y,u*=y,l*=y,c*=y}}e[t]=s,e[t+1]=u,e[t+2]=l,e[t+3]=c}},{key:"multiplyQuaternionsFlat",value:function(e,t,n,r,i,a){var o=n[r],s=n[r+1],u=n[r+2],l=n[r+3],c=i[a],g=i[a+1],d=i[a+2],I=i[a+3];return e[t]=o*I+l*c+s*d-u*g,e[t+1]=s*I+l*g+u*c-o*d,e[t+2]=u*I+l*d+o*g-s*c,e[t+3]=l*I-o*c-s*g-u*d,e}}]),e}();br.prototype.isQuaternion=!0;var yr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,C.Z)(this,e),this.x=t,this.y=n,this.z=r}return(0,h.Z)(e,[{key:"set",value:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyEuler",value:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Gr.setFromEuler(e))}},{key:"applyAxisAngle",value:function(e,t){return this.applyQuaternion(Gr.setFromAxisAngle(e,t))}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}},{key:"applyNormalMatrix",value:function(e){return this.applyMatrix3(e).normalize()}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,u=s*t+a*r-o*n,l=s*n+o*t-i*r,c=s*r+i*n-a*t,g=-i*t-a*n-o*r;return this.x=u*s+g*-i+l*-o-c*-a,this.y=l*s+g*-a+c*-i-u*-o,this.z=c*s+g*-o+u*-a-l*-i,this}},{key:"project",value:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}},{key:"unproject",value:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}},{key:"cross",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}},{key:"crossVectors",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this}},{key:"projectOnVector",value:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}},{key:"projectOnPlane",value:function(e){return Br.copy(this).projectOnVector(e),this.sub(Br)}},{key:"reflect",value:function(e){return this.sub(Br.copy(e).multiplyScalar(2*this.dot(e)))}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(ir(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}},{key:"setFromSpherical",value:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}},{key:"setFromSphericalCoords",value:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}},{key:"setFromCylindrical",value:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}},{key:"setFromCylindricalCoords",value:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}},{key:"setFromMatrixPosition",value:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}},{key:"setFromMatrixColumn",value:function(e,t){return this.fromArray(e.elements,4*t)}},{key:"setFromMatrix3Column",value:function(e,t){return this.fromArray(e.elements,3*t)}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}]),e}();yr.prototype.isVector3=!0;var Br=new yr,Gr=new br,Zr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yr(1/0,1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yr(-1/0,-1/0,-1/0);(0,C.Z)(this,e),this.min=t,this.max=n}return(0,h.Z)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromArray",value:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,u=e.length;s<u;s+=3){var l=e[s],c=e[s+1],g=e[s+2];l<t&&(t=l),c<n&&(n=c),g<r&&(r=g),l>i&&(i=l),c>a&&(a=c),g>o&&(o=g)}return this.min.set(t,n,r),this.max.set(i,a,o),this}},{key:"setFromBufferAttribute",value:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,u=e.count;s<u;s++){var l=e.getX(s),c=e.getY(s),g=e.getZ(s);l<t&&(t=l),c<n&&(n=c),g<r&&(r=g),l>i&&(i=l),c>a&&(a=c),g>o&&(o=g)}return this.min.set(t,n,r),this.max.set(i,a,o),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=_r.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"setFromObject",value:function(e){return this.makeEmpty(),this.expandByObject(e)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new yr),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new yr),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"expandByObject",value:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),xr.copy(t.boundingBox),xr.applyMatrix4(e.matrixWorld),this.union(xr));for(var n=e.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}},{key:"getParameter",value:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new yr),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"intersectsSphere",value:function(e){return this.clampPoint(e.center,_r),_r.distanceToSquared(e.center)<=e.radius*e.radius}},{key:"intersectsPlane",value:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}},{key:"intersectsTriangle",value:function(e){if(this.isEmpty())return!1;this.getCenter(Fr),Er.subVectors(this.max,Fr),Sr.subVectors(e.a,Fr),Rr.subVectors(e.b,Fr),Mr.subVectors(e.c,Fr),Wr.subVectors(Rr,Sr),kr.subVectors(Mr,Rr),Vr.subVectors(Sr,Mr);var t=[0,-Wr.z,Wr.y,0,-kr.z,kr.y,0,-Vr.z,Vr.y,Wr.z,0,-Wr.x,kr.z,0,-kr.x,Vr.z,0,-Vr.x,-Wr.y,Wr.x,0,-kr.y,kr.x,0,-Vr.y,Vr.x,0];return!!Lr(t,Sr,Rr,Mr,Er)&&(!!Lr(t=[1,0,0,0,1,0,0,0,1],Sr,Rr,Mr,Er)&&(Xr.crossVectors(Wr,kr),Lr(t=[Xr.x,Xr.y,Xr.z],Sr,Rr,Mr,Er)))}},{key:"clampPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new yr),t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return _r.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"getBoundingSphere",value:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(_r).length(),e}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"applyMatrix4",value:function(e){return this.isEmpty()||(wr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),wr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),wr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),wr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),wr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),wr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),wr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),wr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(wr)),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();Zr.prototype.isBox3=!0;var wr=[new yr,new yr,new yr,new yr,new yr,new yr,new yr,new yr],_r=new yr,xr=new Zr,Sr=new yr,Rr=new yr,Mr=new yr,Wr=new yr,kr=new yr,Vr=new yr,Fr=new yr,Er=new yr,Xr=new yr,Hr=new yr;function Lr(e,t,n,r,i){for(var a=0,o=e.length-3;a<=o;a+=3){Hr.fromArray(e,a);var s=i.x*Math.abs(Hr.x)+i.y*Math.abs(Hr.y)+i.z*Math.abs(Hr.z),u=t.dot(Hr),l=n.dot(Hr),c=r.dot(Hr);if(Math.max(-Math.max(u,l,c),Math.min(u,l,c))>s)return!1}return!0}var zr=new Zr,Nr=new yr,Yr=new yr,Tr=new yr,Kr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;(0,C.Z)(this,e),this.center=t,this.radius=n}return(0,h.Z)(e,[{key:"set",value:function(e,t){return this.center.copy(e),this.radius=t,this}},{key:"setFromPoints",value:function(e,t){var n=this.center;void 0!==t?n.copy(t):zr.setFromPoints(e).getCenter(n);for(var r=0,i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}},{key:"copy",value:function(e){return this.center.copy(e.center),this.radius=e.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(e){return e.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}},{key:"intersectsBox",value:function(e){return e.intersectsSphere(this)}},{key:"intersectsPlane",value:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new yr),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}},{key:"getBoundingBox",value:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Zr),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}},{key:"applyMatrix4",value:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}},{key:"translate",value:function(e){return this.center.add(e),this}},{key:"expandByPoint",value:function(e){Tr.subVectors(e,this.center);var t=Tr.lengthSq();if(t>this.radius*this.radius){var n=Math.sqrt(t),r=.5*(n-this.radius);this.center.add(Tr.multiplyScalar(r/n)),this.radius+=r}return this}},{key:"union",value:function(e){return Yr.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Nr.copy(e.center).add(Yr)),this.expandByPoint(Nr.copy(e.center).sub(Yr)),this}},{key:"equals",value:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Dr=new yr,Pr=new yr,Ur=new yr,Or=new yr,Jr=new yr,Qr=new yr,jr=new yr,qr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yr(0,0,-1);(0,C.Z)(this,e),this.origin=t,this.direction=n}return(0,h.Z)(e,[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}},{key:"at",value:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new yr),t.copy(this.direction).multiplyScalar(e).add(this.origin)}},{key:"lookAt",value:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this}},{key:"recast",value:function(e){return this.origin.copy(this.at(e,Dr)),this}},{key:"closestPointToPoint",value:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new yr),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=Dr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Dr.copy(this.direction).multiplyScalar(t).add(this.origin),Dr.distanceToSquared(e))}},{key:"distanceSqToSegment",value:function(e,t,n,r){Pr.copy(e).add(t).multiplyScalar(.5),Ur.copy(t).sub(e).normalize(),Or.copy(this.origin).sub(Pr);var i,a,o,s,u=.5*e.distanceTo(t),l=-this.direction.dot(Ur),c=Or.dot(this.direction),g=-Or.dot(Ur),d=Or.lengthSq(),I=Math.abs(1-l*l);if(I>0)if(a=l*c-g,s=u*I,(i=l*g-c)>=0)if(a>=-s)if(a<=s){var C=1/I;o=(i*=C)*(i+l*(a*=C)+2*c)+a*(l*i+a+2*g)+d}else a=u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*g)+d;else a=-u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*g)+d;else a<=-s?o=-(i=Math.max(0,-(-l*u+c)))*i+(a=i>0?-u:Math.min(Math.max(-u,-g),u))*(a+2*g)+d:a<=s?(i=0,o=(a=Math.min(Math.max(-u,-g),u))*(a+2*g)+d):o=-(i=Math.max(0,-(l*u+c)))*i+(a=i>0?u:Math.min(Math.max(-u,-g),u))*(a+2*g)+d;else a=l>0?-u:u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*g)+d;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(Ur).multiplyScalar(a).add(Pr),o}},{key:"intersectSphere",value:function(e,t){Dr.subVectors(e.center,this.origin);var n=Dr.dot(this.direction),r=Dr.dot(Dr)-n*n,i=e.radius*e.radius;if(r>i)return null;var a=Math.sqrt(i-r),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)}},{key:"intersectsSphere",value:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}},{key:"distanceToPlane",value:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}},{key:"intersectPlane",value:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}},{key:"intersectsPlane",value:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}},{key:"intersectBox",value:function(e,t){var n,r,i,a,o,s,u=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,g=this.origin;return u>=0?(n=(e.min.x-g.x)*u,r=(e.max.x-g.x)*u):(n=(e.max.x-g.x)*u,r=(e.min.x-g.x)*u),l>=0?(i=(e.min.y-g.y)*l,a=(e.max.y-g.y)*l):(i=(e.max.y-g.y)*l,a=(e.min.y-g.y)*l),n>a||i>r?null:((i>n||n!==n)&&(n=i),(a<r||r!==r)&&(r=a),c>=0?(o=(e.min.z-g.z)*c,s=(e.max.z-g.z)*c):(o=(e.max.z-g.z)*c,s=(e.min.z-g.z)*c),n>s||o>r?null:((o>n||n!==n)&&(n=o),(s<r||r!==r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}},{key:"intersectsBox",value:function(e){return null!==this.intersectBox(e,Dr)}},{key:"intersectTriangle",value:function(e,t,n,r,i){Jr.subVectors(t,e),Qr.subVectors(n,e),jr.crossVectors(Jr,Qr);var a,o=this.direction.dot(jr);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Or.subVectors(this.origin,e);var s=a*this.direction.dot(Qr.crossVectors(Or,Qr));if(s<0)return null;var u=a*this.direction.dot(Jr.cross(Or));if(u<0)return null;if(s+u>o)return null;var l=-a*Or.dot(jr);return l<0?null:this.at(l/o,i)}},{key:"applyMatrix4",value:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}},{key:"equals",value:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),$r=function(){function e(){(0,C.Z)(this,e),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}return(0,h.Z)(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,u,l,c,g,d,I,C,h){var f=this.elements;return f[0]=e,f[4]=t,f[8]=n,f[12]=r,f[1]=i,f[5]=a,f[9]=o,f[13]=s,f[2]=u,f[6]=l,f[10]=c,f[14]=g,f[3]=d,f[7]=I,f[11]=C,f[15]=h,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}},{key:"copyPosition",value:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}},{key:"setFromMatrix3",value:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(e){var t=this.elements,n=e.elements,r=1/ei.setFromMatrixColumn(e,0).length(),i=1/ei.setFromMatrixColumn(e,1).length(),a=1/ei.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromEuler",value:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),u=Math.sin(r),l=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var g=a*l,d=a*c,I=o*l,C=o*c;t[0]=s*l,t[4]=-s*c,t[8]=u,t[1]=d+I*u,t[5]=g-C*u,t[9]=-o*s,t[2]=C-g*u,t[6]=I+d*u,t[10]=a*s}else if("YXZ"===e.order){var h=s*l,f=s*c,p=u*l,A=u*c;t[0]=h+A*o,t[4]=p*o-f,t[8]=a*u,t[1]=a*c,t[5]=a*l,t[9]=-o,t[2]=f*o-p,t[6]=A+h*o,t[10]=a*s}else if("ZXY"===e.order){var m=s*l,v=s*c,b=u*l,y=u*c;t[0]=m-y*o,t[4]=-a*c,t[8]=b+v*o,t[1]=v+b*o,t[5]=a*l,t[9]=y-m*o,t[2]=-a*u,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){var B=a*l,G=a*c,Z=o*l,w=o*c;t[0]=s*l,t[4]=Z*u-G,t[8]=B*u+w,t[1]=s*c,t[5]=w*u+B,t[9]=G*u-Z,t[2]=-u,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var _=a*s,x=a*u,S=o*s,R=o*u;t[0]=s*l,t[4]=R-_*c,t[8]=S*c+x,t[1]=c,t[5]=a*l,t[9]=-o*l,t[2]=-u*l,t[6]=x*c+S,t[10]=_-R*c}else if("XZY"===e.order){var M=a*s,W=a*u,k=o*s,V=o*u;t[0]=s*l,t[4]=-c,t[8]=u*l,t[1]=M*c+V,t[5]=a*l,t[9]=W*c-k,t[2]=k*c-W,t[6]=o*l,t[10]=V*c+M}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(e){return this.compose(ni,e,ri)}},{key:"lookAt",value:function(e,t,n){var r=this.elements;return oi.subVectors(e,t),0===oi.lengthSq()&&(oi.z=1),oi.normalize(),ii.crossVectors(n,oi),0===ii.lengthSq()&&(1===Math.abs(n.z)?oi.x+=1e-4:oi.z+=1e-4,oi.normalize(),ii.crossVectors(n,oi)),ii.normalize(),ai.crossVectors(oi,ii),r[0]=ii.x,r[4]=ai.x,r[8]=oi.x,r[1]=ii.y,r[5]=ai.y,r[9]=oi.y,r[2]=ii.z,r[6]=ai.z,r[10]=oi.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],u=n[12],l=n[1],c=n[5],g=n[9],d=n[13],I=n[2],C=n[6],h=n[10],f=n[14],p=n[3],A=n[7],m=n[11],v=n[15],b=r[0],y=r[4],B=r[8],G=r[12],Z=r[1],w=r[5],_=r[9],x=r[13],S=r[2],R=r[6],M=r[10],W=r[14],k=r[3],V=r[7],F=r[11],E=r[15];return i[0]=a*b+o*Z+s*S+u*k,i[4]=a*y+o*w+s*R+u*V,i[8]=a*B+o*_+s*M+u*F,i[12]=a*G+o*x+s*W+u*E,i[1]=l*b+c*Z+g*S+d*k,i[5]=l*y+c*w+g*R+d*V,i[9]=l*B+c*_+g*M+d*F,i[13]=l*G+c*x+g*W+d*E,i[2]=I*b+C*Z+h*S+f*k,i[6]=I*y+C*w+h*R+f*V,i[10]=I*B+C*_+h*M+f*F,i[14]=I*G+C*x+h*W+f*E,i[3]=p*b+A*Z+m*S+v*k,i[7]=p*y+A*w+m*R+v*V,i[11]=p*B+A*_+m*M+v*F,i[15]=p*G+A*x+m*W+v*E,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],u=e[13],l=e[2],c=e[6],g=e[10],d=e[14];return e[3]*(+i*s*c-r*u*c-i*o*g+n*u*g+r*o*d-n*s*d)+e[7]*(+t*s*d-t*u*g+i*a*g-r*a*d+r*u*l-i*s*l)+e[11]*(+t*u*c-t*o*d-i*a*c+n*a*d+i*o*l-n*u*l)+e[15]*(-r*o*l-t*s*c+t*o*g+r*a*c-n*a*g+n*s*l)}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}},{key:"setPosition",value:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],g=e[10],d=e[11],I=e[12],C=e[13],h=e[14],f=e[15],p=c*h*u-C*g*u+C*s*d-o*h*d-c*s*f+o*g*f,A=I*g*u-l*h*u-I*s*d+a*h*d+l*s*f-a*g*f,m=l*C*u-I*c*u+I*o*d-a*C*d-l*o*f+a*c*f,v=I*c*s-l*C*s-I*o*g+a*C*g+l*o*h-a*c*h,b=t*p+n*A+r*m+i*v;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var y=1/b;return e[0]=p*y,e[1]=(C*g*i-c*h*i-C*r*d+n*h*d+c*r*f-n*g*f)*y,e[2]=(o*h*i-C*s*i+C*r*u-n*h*u-o*r*f+n*s*f)*y,e[3]=(c*s*i-o*g*i-c*r*u+n*g*u+o*r*d-n*s*d)*y,e[4]=A*y,e[5]=(l*h*i-I*g*i+I*r*d-t*h*d-l*r*f+t*g*f)*y,e[6]=(I*s*i-a*h*i-I*r*u+t*h*u+a*r*f-t*s*f)*y,e[7]=(a*g*i-l*s*i+l*r*u-t*g*u-a*r*d+t*s*d)*y,e[8]=m*y,e[9]=(I*c*i-l*C*i-I*n*d+t*C*d+l*n*f-t*c*f)*y,e[10]=(a*C*i-I*o*i+I*n*u-t*C*u-a*n*f+t*o*f)*y,e[11]=(l*o*i-a*c*i-l*n*u+t*c*u+a*n*d-t*o*d)*y,e[12]=v*y,e[13]=(l*C*r-I*c*r+I*n*g-t*C*g-l*n*h+t*c*h)*y,e[14]=(I*o*r-a*C*r-I*n*s+t*C*s+a*n*h-t*o*h)*y,e[15]=(a*c*r-l*o*r+l*n*s-t*c*s-a*n*g+t*o*g)*y,this}},{key:"scale",value:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}},{key:"getMaxScaleOnAxis",value:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}},{key:"makeTranslation",value:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}},{key:"makeRotationY",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,u=i*a,l=i*o;return this.set(u*a+n,u*o-r*s,u*s+r*o,0,u*o+r*s,l*o+n,l*s-r*a,0,u*s-r*o,l*s+r*a,i*s*s+n,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this}},{key:"compose",value:function(e,t,n){var r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,u=i+i,l=a+a,c=o+o,g=i*u,d=i*l,I=i*c,C=a*l,h=a*c,f=o*c,p=s*u,A=s*l,m=s*c,v=n.x,b=n.y,y=n.z;return r[0]=(1-(C+f))*v,r[1]=(d+m)*v,r[2]=(I-A)*v,r[3]=0,r[4]=(d-m)*b,r[5]=(1-(g+f))*b,r[6]=(h+p)*b,r[7]=0,r[8]=(I+A)*y,r[9]=(h-p)*y,r[10]=(1-(g+C))*y,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}},{key:"decompose",value:function(e,t,n){var r=this.elements,i=ei.set(r[0],r[1],r[2]).length(),a=ei.set(r[4],r[5],r[6]).length(),o=ei.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],ti.copy(this);var s=1/i,u=1/a,l=1/o;return ti.elements[0]*=s,ti.elements[1]*=s,ti.elements[2]*=s,ti.elements[4]*=u,ti.elements[5]*=u,ti.elements[6]*=u,ti.elements[8]*=l,ti.elements[9]*=l,ti.elements[10]*=l,t.setFromRotationMatrix(ti),n.x=i,n.y=a,n.z=o,this}},{key:"makePerspective",value:function(e,t,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(t-e),u=2*i/(n-r),l=(t+e)/(t-e),c=(n+r)/(n-r),g=-(a+i)/(a-i),d=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=u,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=g,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}},{key:"makeOrthographic",value:function(e,t,n,r,i,a){var o=this.elements,s=1/(t-e),u=1/(n-r),l=1/(a-i),c=(t+e)*s,g=(n+r)*u,d=(a+i)*l;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-g,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<16;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}]),e}();$r.prototype.isMatrix4=!0;var ei=new yr,ti=new $r,ni=new yr(0,0,0),ri=new yr(1,1,1),ii=new yr,ai=new yr,oi=new yr,si=new $r,ui=new br,li=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.DefaultOrder;(0,C.Z)(this,e),this._x=t,this._y=n,this._z=r,this._order=i}return(0,h.Z)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e,t,n){var r=e.elements,i=r[0],a=r[4],o=r[8],s=r[1],u=r[5],l=r[9],c=r[2],g=r[6],d=r[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(ir(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-l,d),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(g,u),this._z=0);break;case"YXZ":this._x=Math.asin(-ir(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(s,u)):(this._y=Math.atan2(-c,i),this._z=0);break;case"ZXY":this._x=Math.asin(ir(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-ir(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(g,d),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(ir(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,u),this._y=Math.atan2(-c,i)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-ir(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(g,u),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-l,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!1!==n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(e,t,n){return si.makeRotationFromQuaternion(e),this.setFromRotationMatrix(si,t,n)}},{key:"setFromVector3",value:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)}},{key:"reorder",value:function(e){return ui.setFromEuler(this),this.setFromQuaternion(ui,e)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}},{key:"fromArray",value:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}},{key:"toVector3",value:function(e){return e?e.set(this._x,this._y,this._z):new yr(this._x,this._y,this._z)}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}]),e}();li.prototype.isEuler=!0,li.DefaultOrder="XYZ",li.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var ci=function(){function e(){(0,C.Z)(this,e),this.mask=1}return(0,h.Z)(e,[{key:"set",value:function(e){this.mask=1<<e|0}},{key:"enable",value:function(e){this.mask|=1<<e|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(e){this.mask^=1<<e|0}},{key:"disable",value:function(e){this.mask&=~(1<<e|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(e){return 0!==(this.mask&e.mask)}}]),e}(),gi=0,di=new yr,Ii=new br,Ci=new $r,hi=new yr,fi=new yr,pi=new yr,Ai=new br,mi=new yr(1,0,0),vi=new yr(0,1,0),bi=new yr(0,0,1),yi={type:"added"},Bi={type:"removed"},Gi=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e;(0,C.Z)(this,n),e=t.call(this),Object.defineProperty((0,g.Z)(e),"id",{value:gi++}),e.uuid=rr(),e.name="",e.type="Object3D",e.parent=null,e.children=[],e.up=n.DefaultUp.clone();var r=new yr,i=new li,a=new br,o=new yr(1,1,1);return i._onChange((function(){a.setFromEuler(i,!1)})),a._onChange((function(){i.setFromQuaternion(a,void 0,!1)})),Object.defineProperties((0,g.Z)(e),{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new $r},normalMatrix:{value:new Ir}}),e.matrix=new $r,e.matrixWorld=new $r,e.matrixAutoUpdate=n.DefaultMatrixAutoUpdate,e.matrixWorldNeedsUpdate=!1,e.layers=new ci,e.visible=!0,e.castShadow=!1,e.receiveShadow=!1,e.frustumCulled=!0,e.renderOrder=0,e.animations=[],e.userData={},e}return(0,h.Z)(n,[{key:"onBeforeRender",value:function(){}},{key:"onAfterRender",value:function(){}},{key:"applyMatrix4",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}},{key:"applyQuaternion",value:function(e){return this.quaternion.premultiply(e),this}},{key:"setRotationFromAxisAngle",value:function(e,t){this.quaternion.setFromAxisAngle(e,t)}},{key:"setRotationFromEuler",value:function(e){this.quaternion.setFromEuler(e,!0)}},{key:"setRotationFromMatrix",value:function(e){this.quaternion.setFromRotationMatrix(e)}},{key:"setRotationFromQuaternion",value:function(e){this.quaternion.copy(e)}},{key:"rotateOnAxis",value:function(e,t){return Ii.setFromAxisAngle(e,t),this.quaternion.multiply(Ii),this}},{key:"rotateOnWorldAxis",value:function(e,t){return Ii.setFromAxisAngle(e,t),this.quaternion.premultiply(Ii),this}},{key:"rotateX",value:function(e){return this.rotateOnAxis(mi,e)}},{key:"rotateY",value:function(e){return this.rotateOnAxis(vi,e)}},{key:"rotateZ",value:function(e){return this.rotateOnAxis(bi,e)}},{key:"translateOnAxis",value:function(e,t){return di.copy(e).applyQuaternion(this.quaternion),this.position.add(di.multiplyScalar(t)),this}},{key:"translateX",value:function(e){return this.translateOnAxis(mi,e)}},{key:"translateY",value:function(e){return this.translateOnAxis(vi,e)}},{key:"translateZ",value:function(e){return this.translateOnAxis(bi,e)}},{key:"localToWorld",value:function(e){return e.applyMatrix4(this.matrixWorld)}},{key:"worldToLocal",value:function(e){return e.applyMatrix4(Ci.copy(this.matrixWorld).invert())}},{key:"lookAt",value:function(e,t,n){e.isVector3?hi.copy(e):hi.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),fi.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ci.lookAt(fi,hi,this.up):Ci.lookAt(hi,fi,this.up),this.quaternion.setFromRotationMatrix(Ci),r&&(Ci.extractRotation(r.matrixWorld),Ii.setFromRotationMatrix(Ci),this.quaternion.premultiply(Ii.invert()))}},{key:"add",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(yi)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}},{key:"remove",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Bi)),this}},{key:"clear",value:function(){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.parent=null,t.dispatchEvent(Bi)}return this.children.length=0,this}},{key:"attach",value:function(e){return this.updateWorldMatrix(!0,!1),Ci.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Ci.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ci),this.add(e),e.updateWorldMatrix(!1,!0),this}},{key:"getObjectById",value:function(e){return this.getObjectByProperty("id",e)}},{key:"getObjectByName",value:function(e){return this.getObjectByProperty("name",e)}},{key:"getObjectByProperty",value:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}},{key:"getWorldPosition",value:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new yr),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}},{key:"getWorldQuaternion",value:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new br),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fi,e,pi),e}},{key:"getWorldScale",value:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new yr),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(fi,Ai,e),e}},{key:"getWorldDirection",value:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new yr),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}},{key:"raycast",value:function(){}},{key:"traverse",value:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)}},{key:"traverseVisible",value:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}}},{key:"traverseAncestors",value:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}},{key:"updateMatrix",value:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}},{key:"updateMatrixWorld",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}},{key:"updateWorldMatrix",value:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,u=o.length;s<u;s++){var l=o[s];i(e.shapes,l)}else i(e.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var c=[],g=0,d=this.material.length;g<d;g++)c.push(i(e.materials,this.material[g]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(var I=0;I<this.children.length;I++)r.children.push(this.children[I].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var C=0;C<this.animations.length;C++){var h=this.animations[C];r.animations.push(i(e.animations,h))}}if(t){var f=B(e.geometries),p=B(e.materials),A=B(e.textures),m=B(e.images),v=B(e.shapes),b=B(e.skeletons),y=B(e.animations);f.length>0&&(n.geometries=f),p.length>0&&(n.materials=p),A.length>0&&(n.textures=A),m.length>0&&(n.images=m),v.length>0&&(n.shapes=v),b.length>0&&(n.skeletons=b),y.length>0&&(n.animations=y)}return n.object=r,n;function B(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}}},{key:"clone",value:function(e){return(new this.constructor).copy(this,e)}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}]),n}(jn);Gi.DefaultUp=new yr(0,1,0),Gi.DefaultMatrixAutoUpdate=!0,Gi.prototype.isObject3D=!0;var Zi=new yr,wi=new yr,_i=new Ir,xi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yr(1,0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.Z)(this,e),this.normal=t,this.constant=n}return(0,h.Z)(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(e,t,n){var r=Zi.subVectors(n,t).cross(wi.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new yr),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}},{key:"intersectLine",value:function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new yr);var n=e.delta(Zi),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(n).multiplyScalar(i).add(e.start)}},{key:"intersectsLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectsBox",value:function(e){return e.intersectsPlane(this)}},{key:"intersectsSphere",value:function(e){return e.intersectsPlane(this)}},{key:"coplanarPoint",value:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new yr),e.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(e,t){var n=t||_i.getNormalMatrix(e),r=this.coplanarPoint(Zi).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}},{key:"translate",value:function(e){return this.constant-=e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();xi.prototype.isPlane=!0;var Si=new yr,Ri=new yr,Mi=new yr,Wi=new yr,ki=new yr,Vi=new yr,Fi=new yr,Ei=new yr,Xi=new yr,Hi=new yr,Li=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yr,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yr;(0,C.Z)(this,e),this.a=t,this.b=n,this.c=r}return(0,h.Z)(e,[{key:"set",value:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}},{key:"setFromPointsAndIndices",value:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}},{key:"getArea",value:function(){return Si.subVectors(this.c,this.b),Ri.subVectors(this.a,this.b),.5*Si.cross(Ri).length()}},{key:"getMidpoint",value:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new yr),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(t){return e.getNormal(this.a,this.b,this.c,t)}},{key:"getPlane",value:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new xi),e.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}},{key:"getUV",value:function(t,n,r,i,a){return e.getUV(t,this.a,this.b,this.c,n,r,i,a)}},{key:"containsPoint",value:function(t){return e.containsPoint(t,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(t){return e.isFrontFacing(this.a,this.b,this.c,t)}},{key:"intersectsBox",value:function(e){return e.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new yr);var n,r,i=this.a,a=this.b,o=this.c;ki.subVectors(a,i),Vi.subVectors(o,i),Ei.subVectors(e,i);var s=ki.dot(Ei),u=Vi.dot(Ei);if(s<=0&&u<=0)return t.copy(i);Xi.subVectors(e,a);var l=ki.dot(Xi),c=Vi.dot(Xi);if(l>=0&&c<=l)return t.copy(a);var g=s*c-l*u;if(g<=0&&s>=0&&l<=0)return n=s/(s-l),t.copy(i).addScaledVector(ki,n);Hi.subVectors(e,o);var d=ki.dot(Hi),I=Vi.dot(Hi);if(I>=0&&d<=I)return t.copy(o);var C=d*u-s*I;if(C<=0&&u>=0&&I<=0)return r=u/(u-I),t.copy(i).addScaledVector(Vi,r);var h=l*I-d*c;if(h<=0&&c-l>=0&&d-I>=0)return Fi.subVectors(o,a),r=(c-l)/(c-l+(d-I)),t.copy(a).addScaledVector(Fi,r);var f=1/(h+C+g);return n=C*f,r=g*f,t.copy(i).addScaledVector(ki,n).addScaledVector(Vi,r)}},{key:"equals",value:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}],[{key:"getNormal",value:function(e,t,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new yr),r.subVectors(n,t),Si.subVectors(e,t),r.cross(Si);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}},{key:"getBarycoord",value:function(e,t,n,r,i){Si.subVectors(r,t),Ri.subVectors(n,t),Mi.subVectors(e,t);var a=Si.dot(Si),o=Si.dot(Ri),s=Si.dot(Mi),u=Ri.dot(Ri),l=Ri.dot(Mi),c=a*u-o*o;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new yr),0===c)return i.set(-2,-1,-1);var g=1/c,d=(u*s-o*l)*g,I=(a*l-o*s)*g;return i.set(1-d-I,I,d)}},{key:"containsPoint",value:function(e,t,n,r){return this.getBarycoord(e,t,n,r,Wi),Wi.x>=0&&Wi.y>=0&&Wi.x+Wi.y<=1}},{key:"getUV",value:function(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,Wi),s.set(0,0),s.addScaledVector(i,Wi.x),s.addScaledVector(a,Wi.y),s.addScaledVector(o,Wi.z),s}},{key:"isFrontFacing",value:function(e,t,n,r){return Si.subVectors(n,t),Ri.subVectors(e,t),Si.cross(Ri).dot(r)<0}}]),e}(),zi=0;function Ni(){Object.defineProperty(this,"id",{value:zi++}),this.uuid=rr(),this.name="",this.type="Material",this.fog=!0,this.blending=F,this.side=S,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=J,this.blendDst=Q,this.blendEquation=z,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ae,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Ln,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Zn,this.stencilZFail=Zn,this.stencilZPass=Zn,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Ni.prototype=Object.assign(Object.create(jn.prototype),{constructor:Ni,isMaterial:!0,onBuild:function(){},onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===W;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==F&&(n.blending=this.blending),this.side!==S&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Ni.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}});var Yi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ti={h:0,s:0,l:0},Ki={h:0,s:0,l:0};function Di(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function Pi(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Ui(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var Oi=function(){function e(t,n,r){return(0,C.Z)(this,e),void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}return(0,h.Z)(e,[{key:"set",value:function(e){return e&&e.isColor?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e),this}},{key:"setScalar",value:function(e){return this.r=e,this.g=e,this.b=e,this}},{key:"setHex",value:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}},{key:"setRGB",value:function(e,t,n){return this.r=e,this.g=t,this.b=n,this}},{key:"setHSL",value:function(e,t,n){if(e=ar(e,1),t=ir(t,0,1),n=ir(n,0,1),0===t)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=Di(i,r,e+1/3),this.g=Di(i,r,e),this.b=Di(i,r,e-1/3)}return this}},{key:"setStyle",value:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){var r,i=n[1],a=n[2];switch(i){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,u=parseInt(r[3],10)/100;return t(r[4]),this.setHSL(o,s,u)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){var l=n[1],c=l.length;if(3===c)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}},{key:"setColorName",value:function(e){var t=Yi[e.toLowerCase()];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copyGammaToLinear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}},{key:"copyLinearToGamma",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this}},{key:"convertGammaToLinear",value:function(e){return this.copyGammaToLinear(this,e),this}},{key:"convertLinearToGamma",value:function(e){return this.copyLinearToGamma(this,e),this}},{key:"copySRGBToLinear",value:function(e){return this.r=Pi(e.r),this.g=Pi(e.g),this.b=Pi(e.b),this}},{key:"copyLinearToSRGB",value:function(e){return this.r=Ui(e.r),this.g=Ui(e.g),this.b=Ui(e.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}},{key:"getHexString",value:function(){return("000000"+this.getHex().toString(16)).slice(-6)}},{key:"getHSL",value:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,i=this.g,a=this.b,o=Math.max(r,i,a),s=Math.min(r,i,a),u=(s+o)/2;if(s===o)t=0,n=0;else{var l=o-s;switch(n=u<=.5?l/(o+s):l/(2-o-s),o){case r:t=(i-a)/l+(i<a?6:0);break;case i:t=(a-r)/l+2;break;case a:t=(r-i)/l+4}t/=6}return e.h=t,e.s=n,e.l=u,e}},{key:"getStyle",value:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}},{key:"offsetHSL",value:function(e,t,n){return this.getHSL(Ti),Ti.h+=e,Ti.s+=t,Ti.l+=n,this.setHSL(Ti.h,Ti.s,Ti.l),this}},{key:"add",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}},{key:"addColors",value:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}},{key:"addScalar",value:function(e){return this.r+=e,this.g+=e,this.b+=e,this}},{key:"sub",value:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}},{key:"multiply",value:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}},{key:"multiplyScalar",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this}},{key:"lerp",value:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}},{key:"lerpColors",value:function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}},{key:"lerpHSL",value:function(e,t){this.getHSL(Ti),e.getHSL(Ki);var n=or(Ti.h,Ki.h,t),r=or(Ti.s,Ki.s,t),i=or(Ti.l,Ki.l,t);return this.setHSL(n,r,i),this}},{key:"equals",value:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},{key:"fromBufferAttribute",value:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}},{key:"toJSON",value:function(){return this.getHex()}}]),e}();Oi.NAMES=Yi,Oi.prototype.isColor=!0,Oi.prototype.r=1,Oi.prototype.g=1,Oi.prototype.b=1;var Ji=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="MeshBasicMaterial",r.color=new Oi(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=ce,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this}}]),n}(Ni);Ji.prototype.isMeshBasicMaterial=!0;var Qi=new yr,ji=new gr,qi=function(){function e(t,n,r){if((0,C.Z)(this,e),Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=n,this.count=void 0!==t?t.length/n:0,this.normalized=!0===r,this.usage=zn,this.updateRange={offset:0,count:-1},this.version=0,this.onUploadCallback=function(){}}return(0,h.Z)(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"copy",value:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}},{key:"copyAt",value:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"copyArray",value:function(e){return this.array.set(e),this}},{key:"copyColorsArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new Oi),t[n++]=a.r,t[n++]=a.g,t[n++]=a.b}return this}},{key:"copyVector2sArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new gr),t[n++]=a.x,t[n++]=a.y}return this}},{key:"copyVector3sArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new yr),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z}return this}},{key:"copyVector4sArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new Ar),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z,t[n++]=a.w}return this}},{key:"applyMatrix3",value:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)ji.fromBufferAttribute(this,t),ji.applyMatrix3(e),this.setXY(t,ji.x,ji.y);else if(3===this.itemSize)for(var r=0,i=this.count;r<i;r++)Qi.fromBufferAttribute(this,r),Qi.applyMatrix3(e),this.setXYZ(r,Qi.x,Qi.y,Qi.z);return this}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.count;t<n;t++)Qi.x=this.getX(t),Qi.y=this.getY(t),Qi.z=this.getZ(t),Qi.applyMatrix4(e),this.setXYZ(t,Qi.x,Qi.y,Qi.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)Qi.x=this.getX(t),Qi.y=this.getY(t),Qi.z=this.getZ(t),Qi.applyNormalMatrix(e),this.setXYZ(t,Qi.x,Qi.y,Qi.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)Qi.x=this.getX(t),Qi.y=this.getY(t),Qi.z=this.getZ(t),Qi.transformDirection(e),this.setXYZ(t,Qi.x,Qi.y,Qi.z);return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"getX",value:function(e){return this.array[e*this.itemSize]}},{key:"setX",value:function(e,t){return this.array[e*this.itemSize]=t,this}},{key:"getY",value:function(e){return this.array[e*this.itemSize+1]}},{key:"setY",value:function(e,t){return this.array[e*this.itemSize+1]=t,this}},{key:"getZ",value:function(e){return this.array[e*this.itemSize+2]}},{key:"setZ",value:function(e,t){return this.array[e*this.itemSize+2]=t,this}},{key:"getW",value:function(e){return this.array[e*this.itemSize+3]}},{key:"setW",value:function(e,t){return this.array[e*this.itemSize+3]=t,this}},{key:"setXY",value:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"clone",value:function(){return new this.constructor(this.array,this.itemSize).copy(this)}},{key:"toJSON",value:function(){var e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==zn&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}]),e}();qi.prototype.isBufferAttribute=!0;var $i=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){return(0,C.Z)(this,n),t.call(this,new Int8Array(e),r,i)}return(0,h.Z)(n)}(qi),ea=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){return(0,C.Z)(this,n),t.call(this,new Uint8Array(e),r,i)}return(0,h.Z)(n)}(qi),ta=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){return(0,C.Z)(this,n),t.call(this,new Uint8ClampedArray(e),r,i)}return(0,h.Z)(n)}(qi),na=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){return(0,C.Z)(this,n),t.call(this,new Int16Array(e),r,i)}return(0,h.Z)(n)}(qi),ra=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){return(0,C.Z)(this,n),t.call(this,new Uint16Array(e),r,i)}return(0,h.Z)(n)}(qi),ia=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){return(0,C.Z)(this,n),t.call(this,new Int32Array(e),r,i)}return(0,h.Z)(n)}(qi),aa=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){return(0,C.Z)(this,n),t.call(this,new Uint32Array(e),r,i)}return(0,h.Z)(n)}(qi),oa=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){return(0,C.Z)(this,n),t.call(this,new Uint16Array(e),r,i)}return(0,h.Z)(n)}(qi);oa.prototype.isFloat16BufferAttribute=!0;var sa=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){return(0,C.Z)(this,n),t.call(this,new Float32Array(e),r,i)}return(0,h.Z)(n)}(qi),ua=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){return(0,C.Z)(this,n),t.call(this,new Float64Array(e),r,i)}return(0,h.Z)(n)}(qi);function la(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}var ca={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function ga(e,t){return new ca[e](t)}var da=0,Ia=new $r,Ca=new Gi,ha=new yr,fa=new Zr,pa=new Zr,Aa=new yr,ma=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e;return(0,C.Z)(this,n),e=t.call(this),Object.defineProperty((0,g.Z)(e),"id",{value:da++}),e.uuid=rr(),e.name="",e.type="BufferGeometry",e.index=null,e.attributes={},e.morphAttributes={},e.morphTargetsRelative=!1,e.groups=[],e.boundingBox=null,e.boundingSphere=null,e.drawRange={start:0,count:1/0},e.userData={},e}return(0,h.Z)(n,[{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(e){return Array.isArray(e)?this.index=new(la(e)>65535?aa:ra)(e,1):this.index=e,this}},{key:"getAttribute",value:function(e){return this.attributes[e]}},{key:"setAttribute",value:function(e,t){return this.attributes[e]=t,this}},{key:"deleteAttribute",value:function(e){return delete this.attributes[e],this}},{key:"hasAttribute",value:function(e){return void 0!==this.attributes[e]}},{key:"addGroup",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}},{key:"clearGroups",value:function(){this.groups=[]}},{key:"setDrawRange",value:function(e,t){this.drawRange.start=e,this.drawRange.count=t}},{key:"applyMatrix4",value:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new Ir).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"rotateX",value:function(e){return Ia.makeRotationX(e),this.applyMatrix4(Ia),this}},{key:"rotateY",value:function(e){return Ia.makeRotationY(e),this.applyMatrix4(Ia),this}},{key:"rotateZ",value:function(e){return Ia.makeRotationZ(e),this.applyMatrix4(Ia),this}},{key:"translate",value:function(e,t,n){return Ia.makeTranslation(e,t,n),this.applyMatrix4(Ia),this}},{key:"scale",value:function(e,t,n){return Ia.makeScale(e,t,n),this.applyMatrix4(Ia),this}},{key:"lookAt",value:function(e){return Ca.lookAt(e),Ca.updateMatrix(),this.applyMatrix4(Ca.matrix),this}},{key:"center",value:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ha).negate(),this.translate(ha.x,ha.y,ha.z),this}},{key:"setFromPoints",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new sa(t,3)),this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new Zr);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new yr(-1/0,-1/0,-1/0),new yr(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];fa.setFromBufferAttribute(i),this.morphTargetsRelative?(Aa.addVectors(this.boundingBox.min,fa.min),this.boundingBox.expandByPoint(Aa),Aa.addVectors(this.boundingBox.max,fa.max),this.boundingBox.expandByPoint(Aa)):(this.boundingBox.expandByPoint(fa.min),this.boundingBox.expandByPoint(fa.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new Kr);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new yr,1/0);if(e){var n=this.boundingSphere.center;if(fa.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var a=t[r];pa.setFromBufferAttribute(a),this.morphTargetsRelative?(Aa.addVectors(fa.min,pa.min),fa.expandByPoint(Aa),Aa.addVectors(fa.max,pa.max),fa.expandByPoint(Aa)):(fa.expandByPoint(pa.min),fa.expandByPoint(pa.max))}fa.getCenter(n);for(var o=0,s=0,u=e.count;s<u;s++)Aa.fromBufferAttribute(e,s),o=Math.max(o,n.distanceToSquared(Aa));if(t)for(var l=0,c=t.length;l<c;l++)for(var g=t[l],d=this.morphTargetsRelative,I=0,C=g.count;I<C;I++)Aa.fromBufferAttribute(g,I),d&&(ha.fromBufferAttribute(e,I),Aa.add(ha)),o=Math.max(o,n.distanceToSquared(Aa));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}},{key:"computeFaceNormals",value:function(){}},{key:"computeTangents",value:function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,r=t.position.array,i=t.normal.array,a=t.uv.array,o=r.length/3;void 0===t.tangent&&this.setAttribute("tangent",new qi(new Float32Array(4*o),4));for(var s=t.tangent.array,u=[],l=[],c=0;c<o;c++)u[c]=new yr,l[c]=new yr;var g=new yr,d=new yr,I=new yr,C=new gr,h=new gr,f=new gr,p=new yr,A=new yr,m=this.groups;0===m.length&&(m=[{start:0,count:n.length}]);for(var v=0,b=m.length;v<b;++v)for(var y=m[v],B=y.start,G=B,Z=B+y.count;G<Z;G+=3)E(n[G+0],n[G+1],n[G+2]);for(var w=new yr,_=new yr,x=new yr,S=new yr,R=0,M=m.length;R<M;++R)for(var W=m[R],k=W.start,V=k,F=k+W.count;V<F;V+=3)X(n[V+0]),X(n[V+1]),X(n[V+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function E(e,t,n){g.fromArray(r,3*e),d.fromArray(r,3*t),I.fromArray(r,3*n),C.fromArray(a,2*e),h.fromArray(a,2*t),f.fromArray(a,2*n),d.sub(g),I.sub(g),h.sub(C),f.sub(C);var i=1/(h.x*f.y-f.x*h.y);isFinite(i)&&(p.copy(d).multiplyScalar(f.y).addScaledVector(I,-h.y).multiplyScalar(i),A.copy(I).multiplyScalar(h.x).addScaledVector(d,-f.x).multiplyScalar(i),u[e].add(p),u[t].add(p),u[n].add(p),l[e].add(A),l[t].add(A),l[n].add(A))}function X(e){x.fromArray(i,3*e),S.copy(x);var t=u[e];w.copy(t),w.sub(x.multiplyScalar(x.dot(t))).normalize(),_.crossVectors(S,t);var n=_.dot(l[e])<0?-1:1;s[4*e]=w.x,s[4*e+1]=w.y,s[4*e+2]=w.z,s[4*e+3]=n}}},{key:"computeVertexNormals",value:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new qi(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,i=n.count;r<i;r++)n.setXYZ(r,0,0,0);var a=new yr,o=new yr,s=new yr,u=new yr,l=new yr,c=new yr,g=new yr,d=new yr;if(e)for(var I=0,C=e.count;I<C;I+=3){var h=e.getX(I+0),f=e.getX(I+1),p=e.getX(I+2);a.fromBufferAttribute(t,h),o.fromBufferAttribute(t,f),s.fromBufferAttribute(t,p),g.subVectors(s,o),d.subVectors(a,o),g.cross(d),u.fromBufferAttribute(n,h),l.fromBufferAttribute(n,f),c.fromBufferAttribute(n,p),u.add(g),l.add(g),c.add(g),n.setXYZ(h,u.x,u.y,u.z),n.setXYZ(f,l.x,l.y,l.z),n.setXYZ(p,c.x,c.y,c.z)}else for(var A=0,m=t.count;A<m;A+=3)a.fromBufferAttribute(t,A+0),o.fromBufferAttribute(t,A+1),s.fromBufferAttribute(t,A+2),g.subVectors(s,o),d.subVectors(a,o),g.cross(d),n.setXYZ(A+0,g.x,g.y,g.z),n.setXYZ(A+1,g.x,g.y,g.z),n.setXYZ(A+2,g.x,g.y,g.z);this.normalizeNormals(),n.needsUpdate=!0}}},{key:"merge",value:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,a=e.attributes[r],o=a.array,s=a.itemSize*t,u=Math.min(o.length,i.length-s),l=0,c=s;l<u;l++,c++)i[c]=o[l];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)}},{key:"normalizeNormals",value:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Aa.fromBufferAttribute(e,t),Aa.normalize(),e.setXYZ(t,Aa.x,Aa.y,Aa.z)}},{key:"toNonIndexed",value:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r),o=0,s=0,u=0,l=t.length;u<l;u++){o=t[u]*r;for(var c=0;c<r;c++)a[s++]=n[o++]}return new qi(a,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var t=new n,r=this.index.array,i=this.attributes;for(var a in i){var o=e(i[a],r);t.setAttribute(a,o)}var s=this.morphAttributes;for(var u in s){for(var l=[],c=s[u],g=0,d=c.length;g<d;g++){var I=e(c[g],r);l.push(I)}t.morphAttributes[u]=l}t.morphTargetsRelative=this.morphTargetsRelative;for(var C=this.groups,h=0,f=C.length;h<f;h++){var p=C[h];t.addGroup(p.start,p.count,p.materialIndex)}return t}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var a in i){var o=i[a];e.data.attributes[a]=o.toJSON(e.data)}var s={},u=!1;for(var l in this.morphAttributes){for(var c=this.morphAttributes[l],g=[],d=0,I=c.length;d<I;d++){var C=c[d];g.push(C.toJSON(e.data))}g.length>0&&(s[l]=g,u=!0)}u&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var h=this.groups;h.length>0&&(e.data.groups=JSON.parse(JSON.stringify(h)));var f=this.boundingSphere;return null!==f&&(e.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),e}},{key:"clone",value:function(){return(new n).copy(this)}},{key:"copy",value:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone(t));var r=e.attributes;for(var i in r){var a=r[i];this.setAttribute(i,a.clone(t))}var o=e.morphAttributes;for(var s in o){for(var u=[],l=o[s],c=0,g=l.length;c<g;c++)u.push(l[c].clone(t));this.morphAttributes[s]=u}this.morphTargetsRelative=e.morphTargetsRelative;for(var d=e.groups,I=0,C=d.length;I<C;I++){var h=d[I];this.addGroup(h.start,h.count,h.materialIndex)}var f=e.boundingBox;null!==f&&(this.boundingBox=f.clone());var p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(jn);ma.prototype.isBufferGeometry=!0;var va=new $r,ba=new qr,ya=new Kr,Ba=new yr,Ga=new yr,Za=new yr,wa=new yr,_a=new yr,xa=new yr,Sa=new yr,Ra=new yr,Ma=new yr,Wa=new gr,ka=new gr,Va=new gr,Fa=new yr,Ea=new yr,Xa=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ma,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ji;return(0,C.Z)(this,n),(e=t.call(this)).type="Mesh",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}},{key:"updateMorphTargets",value:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}},{key:"raycast",value:function(e,t){var n,r=this.geometry,i=this.material,a=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),ya.copy(r.boundingSphere),ya.applyMatrix4(a),!1!==e.ray.intersectsSphere(ya)&&(va.copy(a).invert(),ba.copy(e.ray).applyMatrix4(va),null===r.boundingBox||!1!==ba.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var o=r.index,s=r.attributes.position,u=r.morphAttributes.position,l=r.morphTargetsRelative,c=r.attributes.uv,g=r.attributes.uv2,d=r.groups,I=r.drawRange;if(null!==o)if(Array.isArray(i))for(var C=0,h=d.length;C<h;C++)for(var f=d[C],p=i[f.materialIndex],A=Math.max(f.start,I.start),m=Math.min(f.start+f.count,I.start+I.count);A<m;A+=3){var v=o.getX(A),b=o.getX(A+1),y=o.getX(A+2);(n=Ha(this,p,e,ba,s,u,l,c,g,v,b,y))&&(n.faceIndex=Math.floor(A/3),n.face.materialIndex=f.materialIndex,t.push(n))}else for(var B=Math.max(0,I.start),G=Math.min(o.count,I.start+I.count);B<G;B+=3){var Z=o.getX(B),w=o.getX(B+1),_=o.getX(B+2);(n=Ha(this,i,e,ba,s,u,l,c,g,Z,w,_))&&(n.faceIndex=Math.floor(B/3),t.push(n))}else if(void 0!==s)if(Array.isArray(i))for(var x=0,S=d.length;x<S;x++)for(var R=d[x],M=i[R.materialIndex],W=Math.max(R.start,I.start),k=Math.min(R.start+R.count,I.start+I.count);W<k;W+=3){(n=Ha(this,M,e,ba,s,u,l,c,g,W,W+1,W+2))&&(n.faceIndex=Math.floor(W/3),n.face.materialIndex=R.materialIndex,t.push(n))}else for(var V=Math.max(0,I.start),F=Math.min(s.count,I.start+I.count);V<F;V+=3){(n=Ha(this,i,e,ba,s,u,l,c,g,V,V+1,V+2))&&(n.faceIndex=Math.floor(V/3),t.push(n))}}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}]),n}(Gi);function Ha(e,t,n,r,i,a,o,s,u,l,c,g){Ba.fromBufferAttribute(i,l),Ga.fromBufferAttribute(i,c),Za.fromBufferAttribute(i,g);var d=e.morphTargetInfluences;if(t.morphTargets&&a&&d){Sa.set(0,0,0),Ra.set(0,0,0),Ma.set(0,0,0);for(var I=0,C=a.length;I<C;I++){var h=d[I],f=a[I];0!==h&&(wa.fromBufferAttribute(f,l),_a.fromBufferAttribute(f,c),xa.fromBufferAttribute(f,g),o?(Sa.addScaledVector(wa,h),Ra.addScaledVector(_a,h),Ma.addScaledVector(xa,h)):(Sa.addScaledVector(wa.sub(Ba),h),Ra.addScaledVector(_a.sub(Ga),h),Ma.addScaledVector(xa.sub(Za),h)))}Ba.add(Sa),Ga.add(Ra),Za.add(Ma)}e.isSkinnedMesh&&t.skinning&&(e.boneTransform(l,Ba),e.boneTransform(c,Ga),e.boneTransform(g,Za));var p=function(e,t,n,r,i,a,o,s){if(null===(t.side===R?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,t.side!==M,s)))return null;Ea.copy(s),Ea.applyMatrix4(e.matrixWorld);var u=n.ray.origin.distanceTo(Ea);return u<n.near||u>n.far?null:{distance:u,point:Ea.clone(),object:e}}(e,t,n,r,Ba,Ga,Za,Fa);if(p){s&&(Wa.fromBufferAttribute(s,l),ka.fromBufferAttribute(s,c),Va.fromBufferAttribute(s,g),p.uv=Li.getUV(Fa,Ba,Ga,Za,Wa,ka,Va,new gr)),u&&(Wa.fromBufferAttribute(u,l),ka.fromBufferAttribute(u,c),Va.fromBufferAttribute(u,g),p.uv2=Li.getUV(Fa,Ba,Ga,Za,Wa,ka,Va,new gr));var A={a:l,b:c,c:g,normal:new yr,materialIndex:0};Li.getNormal(Ba,Ga,Za,A.normal),p.face=A}return p}Xa.prototype.isMesh=!0;var La=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;(0,C.Z)(this,n),(e=t.call(this)).type="BoxGeometry",e.parameters={width:r,height:i,depth:a,widthSegments:o,heightSegments:s,depthSegments:u};var l=(0,g.Z)(e);o=Math.floor(o),s=Math.floor(s),u=Math.floor(u);var c=[],d=[],I=[],h=[],f=0,p=0;function A(e,t,n,r,i,a,o,s,u,g,C){for(var A=a/u,m=o/g,v=a/2,b=o/2,y=s/2,B=u+1,G=g+1,Z=0,w=0,_=new yr,x=0;x<G;x++)for(var S=x*m-b,R=0;R<B;R++){var M=R*A-v;_[e]=M*r,_[t]=S*i,_[n]=y,d.push(_.x,_.y,_.z),_[e]=0,_[t]=0,_[n]=s>0?1:-1,I.push(_.x,_.y,_.z),h.push(R/u),h.push(1-x/g),Z+=1}for(var W=0;W<g;W++)for(var k=0;k<u;k++){var V=f+k+B*W,F=f+k+B*(W+1),E=f+(k+1)+B*(W+1),X=f+(k+1)+B*W;c.push(V,F,X),c.push(F,E,X),w+=6}l.addGroup(p,w,C),p+=w,f+=Z}return A("z","y","x",-1,-1,a,i,r,u,s,0),A("z","y","x",1,-1,a,i,-r,u,s,1),A("x","z","y",1,1,r,a,i,o,u,2),A("x","z","y",1,-1,r,a,-i,o,u,3),A("x","y","z",1,-1,r,i,a,o,s,4),A("x","y","z",-1,-1,r,i,-a,o,s,5),e.setIndex(c),e.setAttribute("position",new sa(d,3)),e.setAttribute("normal",new sa(I,3)),e.setAttribute("uv",new sa(h,2)),e}return(0,h.Z)(n)}(ma);function za(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function Na(e){for(var t={},n=0;n<e.length;n++){var r=za(e[n]);for(var i in r)t[i]=r[i]}return t}var Ya={clone:za,merge:Na},Ta=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="ShaderMaterial",r.defines={},r.uniforms={},r.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",r.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",r.linewidth=1,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.lights=!1,r.clipping=!1,r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},r.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},r.index0AttributeName=void 0,r.uniformsNeedUpdate=!1,r.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),r.setValues(e)),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=za(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}},{key:"toJSON",value:function(e){var t=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this,e);for(var r in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){var i=this.uniforms[r].value;i&&i.isTexture?t.uniforms[r]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[r]={type:"m4",value:i.toArray()}:t.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var a={};for(var o in this.extensions)!0===this.extensions[o]&&(a[o]=!0);return Object.keys(a).length>0&&(t.extensions=a),t}}]),n}(Ni);Ta.prototype.isShaderMaterial=!0;var Ka=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e;return(0,C.Z)(this,n),(e=t.call(this)).type="Camera",e.matrixWorldInverse=new $r,e.projectionMatrix=new $r,e.projectionMatrixInverse=new $r,e}return(0,h.Z)(n,[{key:"copy",value:function(e,t){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}},{key:"getWorldDirection",value:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new yr),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}},{key:"updateMatrixWorld",value:function(e){(0,l.Z)((0,c.Z)(n.prototype),"updateMatrixWorld",this).call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"updateWorldMatrix",value:function(e,t){(0,l.Z)((0,c.Z)(n.prototype),"updateWorldMatrix",this).call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),n}(Gi);Ka.prototype.isCamera=!0;var Da=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;return(0,C.Z)(this,n),(e=t.call(this)).type="PerspectiveCamera",e.fov=r,e.zoom=1,e.near=a,e.far=o,e.focus=10,e.aspect=i,e.view=null,e.filmGauge=35,e.filmOffset=0,e.updateProjectionMatrix(),e}return(0,h.Z)(n,[{key:"copy",value:function(e,t){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}},{key:"setFocalLength",value:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*nr*Math.atan(t),this.updateProjectionMatrix()}},{key:"getFocalLength",value:function(){var e=Math.tan(.5*tr*this.fov);return.5*this.getFilmHeight()/e}},{key:"getEffectiveFOV",value:function(){return 2*nr*Math.atan(Math.tan(.5*tr*this.fov)/this.zoom)}},{key:"getFilmWidth",value:function(){return this.filmGauge*Math.min(this.aspect,1)}},{key:"getFilmHeight",value:function(){return this.filmGauge/Math.max(this.aspect,1)}},{key:"setViewOffset",value:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=this.near,t=e*Math.tan(.5*tr*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,t-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var u=this.filmOffset;0!==u&&(i+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}]),n}(Ka);Da.prototype.isPerspectiveCamera=!0;var Pa=90,Ua=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){var a;if((0,C.Z)(this,n),(a=t.call(this)).type="CubeCamera",!0!==i.isWebGLCubeRenderTarget)return console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."),(0,u.Z)(a);a.renderTarget=i;var o=new Da(Pa,1,e,r);o.layers=a.layers,o.up.set(0,-1,0),o.lookAt(new yr(1,0,0)),a.add(o);var s=new Da(Pa,1,e,r);s.layers=a.layers,s.up.set(0,-1,0),s.lookAt(new yr(-1,0,0)),a.add(s);var l=new Da(Pa,1,e,r);l.layers=a.layers,l.up.set(0,0,1),l.lookAt(new yr(0,1,0)),a.add(l);var c=new Da(Pa,1,e,r);c.layers=a.layers,c.up.set(0,0,-1),c.lookAt(new yr(0,-1,0)),a.add(c);var g=new Da(Pa,1,e,r);g.layers=a.layers,g.up.set(0,-1,0),g.lookAt(new yr(0,0,1)),a.add(g);var d=new Da(Pa,1,e,r);return d.layers=a.layers,d.up.set(0,-1,0),d.lookAt(new yr(0,0,-1)),a.add(d),a}return(0,h.Z)(n,[{key:"update",value:function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=(0,s.Z)(this.children,6),i=r[0],a=r[1],o=r[2],u=r[3],l=r[4],c=r[5],g=e.xr.enabled,d=e.getRenderTarget();e.xr.enabled=!1;var I=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,a),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,u),e.setRenderTarget(n,4),e.render(t,l),n.texture.generateMipmaps=I,e.setRenderTarget(n,5),e.render(t,c),e.setRenderTarget(d),e.xr.enabled=g}}]),n}(Gi),Oa=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i,a,o,s,u,l,c,g){var d;return(0,C.Z)(this,n),e=void 0!==e?e:[],r=void 0!==r?r:ve,u=void 0!==u?u:qe,(d=t.call(this,e,r,i,a,o,s,u,l,c,g))._needsFlipEnvMap=!0,d.flipY=!1,d}return(0,h.Z)(n,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}]),n}(fr);Oa.prototype.isCubeTexture=!0;var Ja=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){var a;return(0,C.Z)(this,n),Number.isInteger(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=i),a=t.call(this,e,e,r),r=r||{},a.texture=new Oa(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),a.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,a.texture.minFilter=void 0!==r.minFilter?r.minFilter:Ve,a.texture._needsFlipEnvMap=!1,a}return(0,h.Z)(n,[{key:"fromEquirectangularTexture",value:function(e,t){this.texture.type=t.type,this.texture.format=$e,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new La(5,5,5),o=new Ta({name:"CubemapFromEquirect",uniforms:za(n),vertexShader:r,fragmentShader:i,side:R,blending:V});o.uniforms.tEquirect.value=t;var s=new Xa(a,o),u=t.minFilter;return t.minFilter===Xe&&(t.minFilter=Ve),new Ua(1,10,this).update(e,s),t.minFilter=u,s.geometry.dispose(),s.material.dispose(),this}},{key:"clear",value:function(e,t,n,r){for(var i=e.getRenderTarget(),a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}]),n}(mr);Ja.prototype.isWebGLCubeRenderTarget=!0;var Qa=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i,a,o,s,u,l,c,g,d,I){var h;return(0,C.Z)(this,n),(h=t.call(this,null,s,u,l,c,g,a,o,d,I)).image={data:e||null,width:r||1,height:i||1},h.magFilter=void 0!==c?c:Se,h.minFilter=void 0!==g?g:Se,h.generateMipmaps=!1,h.flipY=!1,h.unpackAlignment=1,h.needsUpdate=!0,h}return(0,h.Z)(n)}(fr);Qa.prototype.isDataTexture=!0;var ja=new Kr,qa=new yr,$a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xi,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xi,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new xi,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new xi,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new xi,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new xi;(0,C.Z)(this,e),this.planes=[t,n,r,i,a,o]}return(0,h.Z)(e,[{key:"set",value:function(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this}},{key:"copy",value:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=n[5],l=n[6],c=n[7],g=n[8],d=n[9],I=n[10],C=n[11],h=n[12],f=n[13],p=n[14],A=n[15];return t[0].setComponents(o-r,c-s,C-g,A-h).normalize(),t[1].setComponents(o+r,c+s,C+g,A+h).normalize(),t[2].setComponents(o+i,c+u,C+d,A+f).normalize(),t[3].setComponents(o-i,c-u,C-d,A-f).normalize(),t[4].setComponents(o-a,c-l,C-I,A-p).normalize(),t[5].setComponents(o+a,c+l,C+I,A+p).normalize(),this}},{key:"intersectsObject",value:function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),ja.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(ja)}},{key:"intersectsSprite",value:function(e){return ja.center.set(0,0,0),ja.radius=.7071067811865476,ja.applyMatrix4(e.matrixWorld),this.intersectsSphere(ja)}},{key:"intersectsSphere",value:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0}},{key:"intersectsBox",value:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(qa.x=r.normal.x>0?e.max.x:e.min.x,qa.y=r.normal.y>0?e.max.y:e.min.y,qa.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(qa)<0)return!1}return!0}},{key:"containsPoint",value:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function eo(){var e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function to(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){var a=r.get(t);(!a||a.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var o=r.get(t);void 0===o?r.set(t,function(t,r){var i=t.array,a=t.usage,o=e.createBuffer();e.bindBuffer(r,o),e.bufferData(r,i,a),t.onUploadCallback();var s=5126;return i instanceof Float32Array?s=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?t.isFloat16BufferAttribute?n?s=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=5123:i instanceof Int16Array?s=5122:i instanceof Uint32Array?s=5125:i instanceof Int32Array?s=5124:i instanceof Int8Array?s=5120:i instanceof Uint8Array&&(s=5121),{buffer:o,type:s,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):o.version<t.version&&(!function(t,r,i){var a=r.array,o=r.updateRange;e.bindBuffer(i,t),-1===o.count?e.bufferSubData(i,0,a):(n?e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}(o.buffer,t,i),o.version=t.version)}}}}var no=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,C.Z)(this,n),(e=t.call(this)).type="PlaneGeometry",e.parameters={width:r,height:i,widthSegments:a,heightSegments:o};for(var s=r/2,u=i/2,l=Math.floor(a),c=Math.floor(o),g=l+1,d=c+1,I=r/l,h=i/c,f=[],p=[],A=[],m=[],v=0;v<d;v++)for(var b=v*h-u,y=0;y<g;y++){var B=y*I-s;p.push(B,-b,0),A.push(0,0,1),m.push(y/l),m.push(1-v/c)}for(var G=0;G<c;G++)for(var Z=0;Z<l;Z++){var w=Z+g*G,_=Z+g*(G+1),x=Z+1+g*(G+1),S=Z+1+g*G;f.push(w,_,S),f.push(_,x,S)}return e.setIndex(f),e.setAttribute("position",new sa(p,3)),e.setAttribute("normal",new sa(A,3)),e.setAttribute("uv",new sa(m,2)),e}return(0,h.Z)(n)}(ma),ro={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},io={common:{diffuse:{value:new Oi(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ir},uv2Transform:{value:new Ir},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new gr(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Oi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Oi(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ir}},sprite:{diffuse:{value:new Oi(15658734)},opacity:{value:1},center:{value:new gr(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ir}}},ao={basic:{uniforms:Na([io.common,io.specularmap,io.envmap,io.aomap,io.lightmap,io.fog]),vertexShader:ro.meshbasic_vert,fragmentShader:ro.meshbasic_frag},lambert:{uniforms:Na([io.common,io.specularmap,io.envmap,io.aomap,io.lightmap,io.emissivemap,io.fog,io.lights,{emissive:{value:new Oi(0)}}]),vertexShader:ro.meshlambert_vert,fragmentShader:ro.meshlambert_frag},phong:{uniforms:Na([io.common,io.specularmap,io.envmap,io.aomap,io.lightmap,io.emissivemap,io.bumpmap,io.normalmap,io.displacementmap,io.fog,io.lights,{emissive:{value:new Oi(0)},specular:{value:new Oi(1118481)},shininess:{value:30}}]),vertexShader:ro.meshphong_vert,fragmentShader:ro.meshphong_frag},standard:{uniforms:Na([io.common,io.envmap,io.aomap,io.lightmap,io.emissivemap,io.bumpmap,io.normalmap,io.displacementmap,io.roughnessmap,io.metalnessmap,io.fog,io.lights,{emissive:{value:new Oi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ro.meshphysical_vert,fragmentShader:ro.meshphysical_frag},toon:{uniforms:Na([io.common,io.aomap,io.lightmap,io.emissivemap,io.bumpmap,io.normalmap,io.displacementmap,io.gradientmap,io.fog,io.lights,{emissive:{value:new Oi(0)}}]),vertexShader:ro.meshtoon_vert,fragmentShader:ro.meshtoon_frag},matcap:{uniforms:Na([io.common,io.bumpmap,io.normalmap,io.displacementmap,io.fog,{matcap:{value:null}}]),vertexShader:ro.meshmatcap_vert,fragmentShader:ro.meshmatcap_frag},points:{uniforms:Na([io.points,io.fog]),vertexShader:ro.points_vert,fragmentShader:ro.points_frag},dashed:{uniforms:Na([io.common,io.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ro.linedashed_vert,fragmentShader:ro.linedashed_frag},depth:{uniforms:Na([io.common,io.displacementmap]),vertexShader:ro.depth_vert,fragmentShader:ro.depth_frag},normal:{uniforms:Na([io.common,io.bumpmap,io.normalmap,io.displacementmap,{opacity:{value:1}}]),vertexShader:ro.normal_vert,fragmentShader:ro.normal_frag},sprite:{uniforms:Na([io.sprite,io.fog]),vertexShader:ro.sprite_vert,fragmentShader:ro.sprite_frag},background:{uniforms:{uvTransform:{value:new Ir},t2D:{value:null}},vertexShader:ro.background_vert,fragmentShader:ro.background_frag},cube:{uniforms:Na([io.envmap,{opacity:{value:1}}]),vertexShader:ro.cube_vert,fragmentShader:ro.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ro.equirect_vert,fragmentShader:ro.equirect_frag},distanceRGBA:{uniforms:Na([io.common,io.displacementmap,{referencePosition:{value:new yr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ro.distanceRGBA_vert,fragmentShader:ro.distanceRGBA_frag},shadow:{uniforms:Na([io.lights,io.fog,{color:{value:new Oi(0)},opacity:{value:1}}]),vertexShader:ro.shadow_vert,fragmentShader:ro.shadow_frag}};function oo(e,t,n,r,i){var a,o,s=new Oi(0),u=0,l=null,c=0,g=null;function d(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,i)}return{getClearColor:function(){return s},setClearColor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;s.set(e),d(s,u=t)},getClearAlpha:function(){return u},setClearAlpha:function(e){d(s,u=e)},render:function(n,i,I,C){var h=!0===i.isScene?i.background:null;h&&h.isTexture&&(h=t.get(h));var f=e.xr,p=f.getSession&&f.getSession();p&&"additive"===p.environmentBlendMode&&(h=null),null===h?d(s,u):h&&h.isColor&&(d(h,1),C=!0),(e.autoClear||C)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),h&&(h.isCubeTexture||h.mapping===Ge)?(void 0===o&&((o=new Xa(new La(1,1,1),new Ta({name:"BackgroundCubeMaterial",uniforms:za(ao.cube.uniforms),vertexShader:ao.cube.vertexShader,fragmentShader:ao.cube.fragmentShader,side:R,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(o)),o.material.uniforms.envMap.value=h,o.material.uniforms.flipEnvMap.value=h.isCubeTexture&&h._needsFlipEnvMap?-1:1,l===h&&c===h.version&&g===e.toneMapping||(o.material.needsUpdate=!0,l=h,c=h.version,g=e.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null)):h&&h.isTexture&&(void 0===a&&((a=new Xa(new no(2,2),new Ta({name:"BackgroundMaterial",uniforms:za(ao.background.uniforms),vertexShader:ao.background.vertexShader,fragmentShader:ao.background.fragmentShader,side:S,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(a)),a.material.uniforms.t2D.value=h,!0===h.matrixAutoUpdate&&h.updateMatrix(),a.material.uniforms.uvTransform.value.copy(h.matrix),l===h&&c===h.version&&g===e.toneMapping||(a.material.needsUpdate=!0,l=h,c=h.version,g=e.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null))}}}function so(e,t,n,r){var i=e.getParameter(34921),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==a,s={},u=d(null),l=u;function c(t){return r.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function g(t){return r.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function d(e){for(var t=[],n=[],r=[],a=0;a<i;a++)t[a]=0,n[a]=0,r[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function I(){for(var e=l.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function C(e){h(e,0)}function h(n,i){var a=l.newAttributes,o=l.enabledAttributes,s=l.attributeDivisors;(a[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==i)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function f(){for(var t=l.newAttributes,n=l.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function p(t,n,i,a,o,s){!0!==r.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,n,i,a,o,s):e.vertexAttribIPointer(t,n,i,o,s)}function A(){m(),l!==u&&c((l=u).object)}function m(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:function(i,u,g,A,m){var v=!1;if(o){var b=function(t,n,i){var o=!0===i.wireframe,u=s[t.id];void 0===u&&(u={},s[t.id]=u);var l=u[n.id];void 0===l&&(l={},u[n.id]=l);var c=l[o];void 0===c&&(c=d(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),l[o]=c);return c}(A,g,u);l!==b&&c((l=b).object),v=function(e,t){var n=l.attributes,r=e.attributes,i=0;for(var a in r){var o=n[a],s=r[a];if(void 0===o)return!0;if(o.attribute!==s)return!0;if(o.data!==s.data)return!0;i++}return l.attributesNum!==i||l.index!==t}(A,m),v&&function(e,t){var n={},r=e.attributes,i=0;for(var a in r){var o=r[a],s={};s.attribute=o,o.data&&(s.data=o.data),n[a]=s,i++}l.attributes=n,l.attributesNum=i,l.index=t}(A,m)}else{var y=!0===u.wireframe;l.geometry===A.id&&l.program===g.id&&l.wireframe===y||(l.geometry=A.id,l.program=g.id,l.wireframe=y,v=!0)}!0===i.isInstancedMesh&&(v=!0),null!==m&&n.update(m,34963),v&&(!function(i,a,o,s){if(!1===r.isWebGL2&&(i.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;I();var u=s.attributes,l=o.getAttributes(),c=a.defaultAttributeValues;for(var g in l){var d=l[g];if(d>=0){var A=u[g];if(void 0!==A){var m=A.normalized,v=A.itemSize,b=n.get(A);if(void 0===b)continue;var y=b.buffer,B=b.type,G=b.bytesPerElement;if(A.isInterleavedBufferAttribute){var Z=A.data,w=Z.stride,_=A.offset;Z&&Z.isInstancedInterleavedBuffer?(h(d,Z.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=Z.meshPerAttribute*Z.count)):C(d),e.bindBuffer(34962,y),p(d,v,B,m,w*G,_*G)}else A.isInstancedBufferAttribute?(h(d,A.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=A.meshPerAttribute*A.count)):C(d),e.bindBuffer(34962,y),p(d,v,B,m,0,0)}else if("instanceMatrix"===g){var x=n.get(i.instanceMatrix);if(void 0===x)continue;var S=x.buffer,R=x.type;h(d+0,1),h(d+1,1),h(d+2,1),h(d+3,1),e.bindBuffer(34962,S),e.vertexAttribPointer(d+0,4,R,!1,64,0),e.vertexAttribPointer(d+1,4,R,!1,64,16),e.vertexAttribPointer(d+2,4,R,!1,64,32),e.vertexAttribPointer(d+3,4,R,!1,64,48)}else if("instanceColor"===g){var M=n.get(i.instanceColor);if(void 0===M)continue;var W=M.buffer,k=M.type;h(d,1),e.bindBuffer(34962,W),e.vertexAttribPointer(d,3,k,!1,12,0)}else if(void 0!==c){var V=c[g];if(void 0!==V)switch(V.length){case 2:e.vertexAttrib2fv(d,V);break;case 3:e.vertexAttrib3fv(d,V);break;case 4:e.vertexAttrib4fv(d,V);break;default:e.vertexAttrib1fv(d,V)}}}}f()}(i,u,g,A),null!==m&&e.bindBuffer(34963,n.get(m).buffer))},reset:A,resetDefaultState:m,dispose:function(){for(var e in A(),s){var t=s[e];for(var n in t){var r=t[n];for(var i in r)g(r[i].object),delete r[i];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var i in r)g(r[i].object),delete r[i];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var i in r)g(r[i].object),delete r[i];delete n[e.id]}}},initAttributes:I,enableAttribute:C,disableUnusedAttributes:f}}function uo(e,t,n,r){var i,a=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=function(r,o,s){if(0!==s){var u,l;if(a)u=e,l="drawArraysInstanced";else if(l="drawArraysInstancedANGLE",null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[l](i,r,o,s),n.update(o,i,s)}}}function lo(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var a="undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!==typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var u=!0===n.logarithmicDepthBuffer,l=e.getParameter(34930),c=e.getParameter(35660),g=e.getParameter(3379),d=e.getParameter(34076),I=e.getParameter(34921),C=e.getParameter(36347),h=e.getParameter(36348),f=e.getParameter(36349),p=c>0,A=a||t.has("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:u,maxTextures:l,maxVertexTextures:c,maxTextureSize:g,maxCubemapSize:d,maxAttributes:I,maxVertexUniforms:C,maxVaryings:h,maxFragmentUniforms:f,vertexTextures:p,floatFragmentTextures:A,floatVertexTextures:p&&A,maxSamples:a?e.getParameter(36183):0}}function co(e){var t=this,n=null,r=0,i=!1,a=!1,o=new xi,s=new Ir,u={value:null,needsUpdate:!1};function l(){u.value!==n&&(u.value=n,u.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function c(e,n,r,i){var a=null!==e?e.length:0,l=null;if(0!==a){if(l=u.value,!0!==i||null===l){var c=r+4*a,g=n.matrixWorldInverse;s.getNormalMatrix(g),(null===l||l.length<c)&&(l=new Float32Array(c));for(var d=0,I=r;d!==a;++d,I+=4)o.copy(e[d]).applyMatrix4(g,s),o.normal.toArray(l,I),l[I+3]=o.constant}u.value=l,u.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,l}this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,a){var o=0!==e.length||t||0!==r||i;return i=t,n=c(e,a,0),r=e.length,o},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1,l()},this.setState=function(t,o,s){var g=t.clippingPlanes,d=t.clipIntersection,I=t.clipShadows,C=e.get(t);if(!i||null===g||0===g.length||a&&!I)a?c(null):l();else{var h=a?0:r,f=4*h,p=C.clippingState||null;u.value=p,p=c(g,o,f,s);for(var A=0;A!==f;++A)p[A]=n[A];C.clippingState=p,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=h}}}function go(e){var t=new WeakMap;function n(e,t){return t===ye?e.mapping=ve:t===Be&&(e.mapping=be),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){var a=i.mapping;if(a===ye||a===Be){if(t.has(i))return n(t.get(i).texture,i.mapping);var o=i.image;if(o&&o.height>0){var s=e.getRenderTarget(),u=new Ja(o.height/2);return u.fromEquirectangularTexture(e,i),t.set(i,u),e.setRenderTarget(s),i.addEventListener("dispose",r),n(u.texture,i.mapping)}return null}}return i},dispose:function(){t=new WeakMap}}}function Io(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function Co(e,t,n,r){var i={},a=new WeakMap;function o(e){var s=e.target;for(var u in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[u]);s.removeEventListener("dispose",o),delete i[s.id];var l=a.get(s);l&&(t.remove(l),a.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,i=e.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var u=0,l=s.length;u<l;u+=3){var c=s[u+0],g=s[u+1],d=s[u+2];n.push(c,g,g,d,d,c)}}else{var I=i.array;o=i.version;for(var C=0,h=I.length/3-1;C<h;C+=3){var f=C+0,p=C+1,A=C+2;n.push(f,p,p,A,A,f)}}var m=new(la(n)>65535?aa:ra)(n,1);m.version=o;var v=a.get(e);v&&t.remove(v),a.set(e,m)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",o),i[t.id]=!0,n.memory.geometries++),t},update:function(e){var n=e.attributes;for(var r in n)t.update(n[r],34962);var i=e.morphAttributes;for(var a in i)for(var o=i[a],s=0,u=o.length;s<u;s++)t.update(o[s],34962)},getWireframeAttribute:function(e){var t=a.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return a.get(e)}}}function ho(e,t,n,r){var i,a,o,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,a,t*o),n.update(r,i,1)},this.renderInstances=function(r,u,l){if(0!==l){var c,g;if(s)c=e,g="drawElementsInstanced";else if(g="drawElementsInstancedANGLE",null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[g](i,u,a,r*o,l),n.update(u,i,l)}}}function fo(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function po(e,t){return e[0]-t[0]}function Ao(e,t){return Math.abs(t[1])-Math.abs(e[1])}function mo(e){for(var t={},n=new Float32Array(8),r=[],i=0;i<8;i++)r[i]=[i,0];return{update:function(i,a,o,s){var u=i.morphTargetInfluences,l=void 0===u?0:u.length,c=t[a.id];if(void 0===c){c=[];for(var g=0;g<l;g++)c[g]=[g,0];t[a.id]=c}for(var d=0;d<l;d++){var I=c[d];I[0]=d,I[1]=u[d]}c.sort(Ao);for(var C=0;C<8;C++)C<l&&c[C][1]?(r[C][0]=c[C][0],r[C][1]=c[C][1]):(r[C][0]=Number.MAX_SAFE_INTEGER,r[C][1]=0);r.sort(po);for(var h=o.morphTargets&&a.morphAttributes.position,f=o.morphNormals&&a.morphAttributes.normal,p=0,A=0;A<8;A++){var m=r[A],v=m[0],b=m[1];v!==Number.MAX_SAFE_INTEGER&&b?(h&&a.getAttribute("morphTarget"+A)!==h[v]&&a.setAttribute("morphTarget"+A,h[v]),f&&a.getAttribute("morphNormal"+A)!==f[v]&&a.setAttribute("morphNormal"+A,f[v]),n[A]=b,p+=b):(h&&!0===a.hasAttribute("morphTarget"+A)&&a.deleteAttribute("morphTarget"+A),f&&!0===a.hasAttribute("morphNormal"+A)&&a.deleteAttribute("morphNormal"+A),n[A]=0)}var y=a.morphTargetsRelative?1:1-p;s.getUniforms().setValue(e,"morphTargetBaseInfluence",y),s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function vo(e,t,n,r){var i=new WeakMap;function a(e){var t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){var o=r.render.frame,s=e.geometry,u=t.get(e,s);return i.get(u)!==o&&(t.update(u),i.set(u,o)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",a)&&e.addEventListener("dispose",a),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),u},dispose:function(){i=new WeakMap}}}ao.physical={uniforms:Na([ao.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new gr(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Oi(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:ro.meshphysical_vert,fragmentShader:ro.meshphysical_frag};var bo=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,C.Z)(this,n),(e=t.call(this,null)).image={data:r,width:i,height:a,depth:o},e.magFilter=Se,e.minFilter=Se,e.wrapR=_e,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e.needsUpdate=!0,e}return(0,h.Z)(n)}(fr);bo.prototype.isDataTexture2DArray=!0;var yo=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,C.Z)(this,n),(e=t.call(this,null)).image={data:r,width:i,height:a,depth:o},e.magFilter=Se,e.minFilter=Se,e.wrapR=_e,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e.needsUpdate=!0,e}return(0,h.Z)(n)}(fr);yo.prototype.isDataTexture3D=!0;var Bo=new fr,Go=new bo,Zo=new yo,wo=new Oa,_o=[],xo=[],So=new Float32Array(16),Ro=new Float32Array(9),Mo=new Float32Array(4);function Wo(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,a=_o[i];if(void 0===a&&(a=new Float32Array(i),_o[i]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function ko(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Vo(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function Fo(e,t){var n=xo[t];void 0===n&&(n=new Int32Array(t),xo[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Eo(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Xo(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(ko(n,t))return;e.uniform2fv(this.addr,t),Vo(n,t)}}function Ho(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(ko(n,t))return;e.uniform3fv(this.addr,t),Vo(n,t)}}function Lo(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(ko(n,t))return;e.uniform4fv(this.addr,t),Vo(n,t)}}function zo(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(ko(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Vo(n,t)}else{if(ko(n,r))return;Mo.set(r),e.uniformMatrix2fv(this.addr,!1,Mo),Vo(n,r)}}function No(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(ko(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Vo(n,t)}else{if(ko(n,r))return;Ro.set(r),e.uniformMatrix3fv(this.addr,!1,Ro),Vo(n,r)}}function Yo(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(ko(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Vo(n,t)}else{if(ko(n,r))return;So.set(r),e.uniformMatrix4fv(this.addr,!1,So),Vo(n,r)}}function To(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Ko(e,t){var n=this.cache;ko(n,t)||(e.uniform2iv(this.addr,t),Vo(n,t))}function Do(e,t){var n=this.cache;ko(n,t)||(e.uniform3iv(this.addr,t),Vo(n,t))}function Po(e,t){var n=this.cache;ko(n,t)||(e.uniform4iv(this.addr,t),Vo(n,t))}function Uo(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Oo(e,t){var n=this.cache;ko(n,t)||(e.uniform2uiv(this.addr,t),Vo(n,t))}function Jo(e,t){var n=this.cache;ko(n,t)||(e.uniform3uiv(this.addr,t),Vo(n,t))}function Qo(e,t){var n=this.cache;ko(n,t)||(e.uniform4uiv(this.addr,t),Vo(n,t))}function jo(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||Bo,i)}function qo(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Zo,i)}function $o(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||wo,i)}function es(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Go,i)}function ts(e,t){e.uniform1fv(this.addr,t)}function ns(e,t){var n=Wo(t,this.size,2);e.uniform2fv(this.addr,n)}function rs(e,t){var n=Wo(t,this.size,3);e.uniform3fv(this.addr,n)}function is(e,t){var n=Wo(t,this.size,4);e.uniform4fv(this.addr,n)}function as(e,t){var n=Wo(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function os(e,t){var n=Wo(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function ss(e,t){var n=Wo(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function us(e,t){e.uniform1iv(this.addr,t)}function ls(e,t){e.uniform2iv(this.addr,t)}function cs(e,t){e.uniform3iv(this.addr,t)}function gs(e,t){e.uniform4iv(this.addr,t)}function ds(e,t){e.uniform1uiv(this.addr,t)}function Is(e,t){e.uniform2uiv(this.addr,t)}function Cs(e,t){e.uniform3uiv(this.addr,t)}function hs(e,t){e.uniform4uiv(this.addr,t)}function fs(e,t,n){var r=t.length,i=Fo(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTexture2D(t[a]||Bo,i[a])}function ps(e,t,n){var r=t.length,i=Fo(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTextureCube(t[a]||wo,i[a])}function As(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Eo;case 35664:return Xo;case 35665:return Ho;case 35666:return Lo;case 35674:return zo;case 35675:return No;case 35676:return Yo;case 5124:case 35670:return To;case 35667:case 35671:return Ko;case 35668:case 35672:return Do;case 35669:case 35673:return Po;case 5125:return Uo;case 36294:return Oo;case 36295:return Jo;case 36296:return Qo;case 35678:case 36198:case 36298:case 36306:case 35682:return jo;case 35679:case 36299:case 36307:return qo;case 35680:case 36300:case 36308:case 36293:return $o;case 36289:case 36303:case 36311:case 36292:return es}}(t.type)}function ms(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return ts;case 35664:return ns;case 35665:return rs;case 35666:return is;case 35674:return as;case 35675:return os;case 35676:return ss;case 5124:case 35670:return us;case 35667:case 35671:return ls;case 35668:case 35672:return cs;case 35669:case 35673:return gs;case 5125:return ds;case 36294:return Is;case 36295:return Cs;case 36296:return hs;case 35678:case 36198:case 36298:case 36306:case 35682:return fs;case 35680:case 36300:case 36308:case 36293:return ps}}(t.type)}function vs(e){this.id=e,this.seq=[],this.map={}}ms.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Vo(t,e)},vs.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(e,t[o.id],n)}};var bs=/(\w+)(\])?(\[|\.)?/g;function ys(e,t){e.seq.push(t),e.map[t.id]=t}function Bs(e,t,n){var r=e.name,i=r.length;for(bs.lastIndex=0;;){var a=bs.exec(r),o=bs.lastIndex,s=a[1],u="]"===a[2],l=a[3];if(u&&(s|=0),void 0===l||"["===l&&o+2===i){ys(n,void 0===l?new As(s,e,t):new ms(s,e,t));break}var c=n.map[s];void 0===c&&ys(n,c=new vs(s)),n=c}}function Gs(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var i=e.getActiveUniform(t,r);Bs(i,e.getUniformLocation(t,i.name),this)}}function Zs(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}Gs.prototype.setValue=function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)},Gs.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},Gs.upload=function(e,t,n,r){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}},Gs.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var a=e[r];a.id in t&&n.push(a)}return n};var ws=0;function _s(e){switch(e){case dn:return["Linear","( value )"];case In:return["sRGB","( value )"];case hn:return["RGBE","( value )"];case pn:return["RGBM","( value, 7.0 )"];case An:return["RGBM","( value, 16.0 )"];case mn:return["RGBD","( value, 256.0 )"];case Cn:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case fn:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function xs(e,t,n){var r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function Ss(e,t){var n=_s(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Rs(e,t){var n=_s(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Ms(e,t){var n;switch(t){case Ce:n="Linear";break;case he:n="Reinhard";break;case fe:n="OptimizedCineon";break;case pe:n="ACESFilmic";break;case Ae:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Ws(e){return""!==e}function ks(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Vs(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Fs=/^[ \t]*#include +<([\w\d./]+)>/gm;function Es(e){return e.replace(Fs,Xs)}function Xs(e,t){var n=ro[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Es(n)}var Hs=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Ls=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function zs(e){return e.replace(Ls,Ys).replace(Hs,Ns)}function Ns(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Ys(e,t,n,r)}function Ys(e,t,n,r){for(var i="",a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function Ts(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Ks(e,t,n,r){var i,a,o=e.getContext(),s=n.defines,u=n.vertexShader,l=n.fragmentShader,c=function(e){var t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===w?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===_?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===x&&(t="SHADOWMAP_TYPE_VSM"),t}(n),g=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case ve:case be:t="ENVMAP_TYPE_CUBE";break;case Ge:case Ze:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),d=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case be:case Ze:t="ENVMAP_MODE_REFRACTION"}return t}(n),I=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case ce:t="ENVMAP_BLENDING_MULTIPLY";break;case ge:t="ENVMAP_BLENDING_MIX";break;case de:t="ENVMAP_BLENDING_ADD"}return t}(n),C=e.gammaFactor>0?e.gammaFactor:1,h=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ws).join("\n")}(n),f=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(s),p=o.createProgram(),A=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((i=[f].filter(Ws).join("\n")).length>0&&(i+="\n"),(a=[h,f].filter(Ws).join("\n")).length>0&&(a+="\n")):(i=[Ts(n),"#define SHADER_NAME "+n.shaderName,f,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+C,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ws).join("\n"),a=[h,Ts(n),"#define SHADER_NAME "+n.shaderName,f,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+C,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+g:"",n.envMap?"#define "+d:"",n.envMap?"#define "+I:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Ie?"#define TONE_MAPPING":"",n.toneMapping!==Ie?ro.tonemapping_pars_fragment:"",n.toneMapping!==Ie?Ms("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",ro.encodings_pars_fragment,n.map?Ss("mapTexelToLinear",n.mapEncoding):"",n.matcap?Ss("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?Ss("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?Ss("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?Ss("lightMapTexelToLinear",n.lightMapEncoding):"",Rs("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Ws).join("\n")),u=Vs(u=ks(u=Es(u),n),n),l=Vs(l=ks(l=Es(l),n),n),u=zs(u),l=zs(l),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(A="#version 300 es\n",i=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,a=["#define varying in",n.glslVersion===Qn?"":"out highp vec4 pc_fragColor;",n.glslVersion===Qn?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+a);var m,v,b=A+a+l,y=Zs(o,35633,A+i+u),B=Zs(o,35632,b);if(o.attachShader(p,y),o.attachShader(p,B),void 0!==n.index0AttributeName?o.bindAttribLocation(p,0,n.index0AttributeName):!0===n.morphTargets&&o.bindAttribLocation(p,0,"position"),o.linkProgram(p),e.debug.checkShaderErrors){var G=o.getProgramInfoLog(p).trim(),Z=o.getShaderInfoLog(y).trim(),S=o.getShaderInfoLog(B).trim(),R=!0,M=!0;if(!1===o.getProgramParameter(p,35714)){R=!1;var W=xs(o,y,"vertex"),k=xs(o,B,"fragment");console.error("THREE.WebGLProgram: shader error: ",o.getError(),"35715",o.getProgramParameter(p,35715),"gl.getProgramInfoLog",G,W,k)}else""!==G?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",G):""!==Z&&""!==S||(M=!1);M&&(this.diagnostics={runnable:R,programLog:G,vertexShader:{log:Z,prefix:i},fragmentShader:{log:S,prefix:a}})}return o.deleteShader(y),o.deleteShader(B),this.getUniforms=function(){return void 0===m&&(m=new Gs(o,p)),m},this.getAttributes=function(){return void 0===v&&(v=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),i=0;i<r;i++){var a=e.getActiveAttrib(t,i).name;n[a]=e.getAttribLocation(t,a)}return n}(o,p)),v},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(p),this.program=void 0},this.name=n.shaderName,this.id=ws++,this.cacheKey=t,this.usedTimes=1,this.program=p,this.vertexShader=y,this.fragmentShader=B,this}function Ds(e,t,n,r,i,a){var o=[],s=r.isWebGL2,u=r.logarithmicDepthBuffer,l=r.floatVertexTextures,c=r.maxVertexUniforms,g=r.vertexTextures,d=r.precision,I={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},C=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function h(e){var t;return e&&e.isTexture?t=e.encoding:e&&e.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=dn,t}return{getParameters:function(i,o,C,f,p){var A,m,v=f.fog,b=i.isMeshStandardMaterial?f.environment:null,y=t.get(i.envMap||b),B=I[i.type],G=p.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(l)return 1024;var n=c,r=Math.floor((n-20)/4),i=Math.min(r,t.length);return i<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}(p):0;if(null!==i.precision&&(d=r.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",d,"instead."),B){var Z=ao[B];A=Z.vertexShader,m=Z.fragmentShader}else A=i.vertexShader,m=i.fragmentShader;var w=e.getRenderTarget();return{isWebGL2:s,shaderID:B,shaderName:i.type,vertexShader:A,fragmentShader:m,defines:i.defines,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:d,instancing:!0===p.isInstancedMesh,instancingColor:!0===p.isInstancedMesh&&null!==p.instanceColor,supportsVertexTextures:g,outputEncoding:null!==w?h(w.texture):e.outputEncoding,map:!!i.map,mapEncoding:h(i.map),matcap:!!i.matcap,matcapEncoding:h(i.matcap),envMap:!!y,envMapMode:y&&y.mapping,envMapEncoding:h(y),envMapCubeUV:!!y&&(y.mapping===Ge||y.mapping===Ze),lightMap:!!i.lightMap,lightMapEncoding:h(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:h(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:i.normalMapType===Bn,tangentSpaceNormalMap:i.normalMapType===yn,clearcoatMap:!!i.clearcoatMap,clearcoatRoughnessMap:!!i.clearcoatRoughnessMap,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,transmissionMap:!!i.transmissionMap,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexAlphas:!0===i.vertexColors&&p.geometry&&p.geometry.attributes.color&&4===p.geometry.attributes.color.itemSize,vertexUvs:!!i.map||!!i.bumpMap||!!i.normalMap||!!i.specularMap||!!i.alphaMap||!!i.emissiveMap||!!i.roughnessMap||!!i.metalnessMap||!!i.clearcoatMap||!!i.clearcoatRoughnessMap||!!i.clearcoatNormalMap||!!i.displacementMap||!!i.transmissionMap,uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.transmissionMap)&&!!i.displacementMap,fog:!!v,useFog:i.fog,fogExp2:v&&v.isFogExp2,flatShading:!!i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:u,skinning:i.skinning&&G>0,maxBones:G,useVertexTexture:l,morphTargets:i.morphTargets,morphNormals:i.morphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&C.length>0,shadowMapType:e.shadowMap.type,toneMapping:i.toneMapped?e.toneMapping:Ie,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:i.side===M,flipSided:i.side===R,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawBuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:s||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:s||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:s||n.has("EXT_shader_texture_lod"),customProgramCacheKey:i.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(!1===t.isRawShaderMaterial){for(var i=0;i<C.length;i++)n.push(t[C[i]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=I[e.type];if(n){var r=ao[n];t=Ya.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,a=0,s=o.length;a<s;a++){var u=o[a];if(u.cacheKey===n){++(r=u).usedTimes;break}}return void 0===r&&(r=new Ks(e,n,t,i),o.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){var t=o.indexOf(e);o[t]=o[o.length-1],o.pop(),e.destroy()}},programs:o}}function Ps(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Us(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Os(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Js(e){var t=[],n=0,r=[],i=[],a={id:-1};function o(r,i,o,s,u,l){var c=t[n],g=e.get(o);return void 0===c?(c={id:r.id,object:r,geometry:i,material:o,program:g.program||a,groupOrder:s,renderOrder:r.renderOrder,z:u,group:l},t[n]=c):(c.id=r.id,c.object=r,c.geometry=i,c.material=o,c.program=g.program||a,c.groupOrder=s,c.renderOrder=r.renderOrder,c.z=u,c.group=l),n++,c}return{opaque:r,transparent:i,init:function(){n=0,r.length=0,i.length=0},push:function(e,t,n,a,s,u){var l=o(e,t,n,a,s,u);(!0===n.transparent?i:r).push(l)},unshift:function(e,t,n,a,s,u){var l=o(e,t,n,a,s,u);(!0===n.transparent?i:r).unshift(l)},finish:function(){for(var e=n,r=t.length;e<r;e++){var i=t[e];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(e,t){r.length>1&&r.sort(e||Us),i.length>1&&i.sort(t||Os)}}}function Qs(e){var t=new WeakMap;return{get:function(n,r){var i;return!1===t.has(n)?(i=new Js(e),t.set(n,[i])):r>=t.get(n).length?(i=new Js(e),t.get(n).push(i)):i=t.get(n)[r],i},dispose:function(){t=new WeakMap}}}function js(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new yr,color:new Oi};break;case"SpotLight":n={position:new yr,direction:new yr,color:new Oi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new yr,color:new Oi,distance:0,decay:0};break;case"HemisphereLight":n={direction:new yr,skyColor:new Oi,groundColor:new Oi};break;case"RectAreaLight":n={color:new Oi,position:new yr,halfWidth:new yr,halfHeight:new yr}}return e[t.id]=n,n}}}var qs=0;function $s(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function eu(e,t){for(var n=new js,r=function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gr};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gr,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},a=0;a<9;a++)i.probe.push(new yr);var o=new yr,s=new $r,u=new $r;return{setup:function(a){for(var o=0,s=0,u=0,l=0;l<9;l++)i.probe[l].set(0,0,0);var c=0,g=0,d=0,I=0,C=0,h=0,f=0,p=0;a.sort($s);for(var A=0,m=a.length;A<m;A++){var v=a[A],b=v.color,y=v.intensity,B=v.distance,G=v.shadow&&v.shadow.map?v.shadow.map.texture:null;if(v.isAmbientLight)o+=b.r*y,s+=b.g*y,u+=b.b*y;else if(v.isLightProbe)for(var Z=0;Z<9;Z++)i.probe[Z].addScaledVector(v.sh.coefficients[Z],y);else if(v.isDirectionalLight){var w=n.get(v);if(w.color.copy(v.color).multiplyScalar(v.intensity),v.castShadow){var _=v.shadow,x=r.get(v);x.shadowBias=_.bias,x.shadowNormalBias=_.normalBias,x.shadowRadius=_.radius,x.shadowMapSize=_.mapSize,i.directionalShadow[c]=x,i.directionalShadowMap[c]=G,i.directionalShadowMatrix[c]=v.shadow.matrix,h++}i.directional[c]=w,c++}else if(v.isSpotLight){var S=n.get(v);if(S.position.setFromMatrixPosition(v.matrixWorld),S.color.copy(b).multiplyScalar(y),S.distance=B,S.coneCos=Math.cos(v.angle),S.penumbraCos=Math.cos(v.angle*(1-v.penumbra)),S.decay=v.decay,v.castShadow){var R=v.shadow,M=r.get(v);M.shadowBias=R.bias,M.shadowNormalBias=R.normalBias,M.shadowRadius=R.radius,M.shadowMapSize=R.mapSize,i.spotShadow[d]=M,i.spotShadowMap[d]=G,i.spotShadowMatrix[d]=v.shadow.matrix,p++}i.spot[d]=S,d++}else if(v.isRectAreaLight){var W=n.get(v);W.color.copy(b).multiplyScalar(y),W.halfWidth.set(.5*v.width,0,0),W.halfHeight.set(0,.5*v.height,0),i.rectArea[I]=W,I++}else if(v.isPointLight){var k=n.get(v);if(k.color.copy(v.color).multiplyScalar(v.intensity),k.distance=v.distance,k.decay=v.decay,v.castShadow){var V=v.shadow,F=r.get(v);F.shadowBias=V.bias,F.shadowNormalBias=V.normalBias,F.shadowRadius=V.radius,F.shadowMapSize=V.mapSize,F.shadowCameraNear=V.camera.near,F.shadowCameraFar=V.camera.far,i.pointShadow[g]=F,i.pointShadowMap[g]=G,i.pointShadowMatrix[g]=v.shadow.matrix,f++}i.point[g]=k,g++}else if(v.isHemisphereLight){var E=n.get(v);E.skyColor.copy(v.color).multiplyScalar(y),E.groundColor.copy(v.groundColor).multiplyScalar(y),i.hemi[C]=E,C++}}I>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=io.LTC_FLOAT_1,i.rectAreaLTC2=io.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=io.LTC_HALF_1,i.rectAreaLTC2=io.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=o,i.ambient[1]=s,i.ambient[2]=u;var X=i.hash;X.directionalLength===c&&X.pointLength===g&&X.spotLength===d&&X.rectAreaLength===I&&X.hemiLength===C&&X.numDirectionalShadows===h&&X.numPointShadows===f&&X.numSpotShadows===p||(i.directional.length=c,i.spot.length=d,i.rectArea.length=I,i.point.length=g,i.hemi.length=C,i.directionalShadow.length=h,i.directionalShadowMap.length=h,i.pointShadow.length=f,i.pointShadowMap.length=f,i.spotShadow.length=p,i.spotShadowMap.length=p,i.directionalShadowMatrix.length=h,i.pointShadowMatrix.length=f,i.spotShadowMatrix.length=p,X.directionalLength=c,X.pointLength=g,X.spotLength=d,X.rectAreaLength=I,X.hemiLength=C,X.numDirectionalShadows=h,X.numPointShadows=f,X.numSpotShadows=p,i.version=qs++)},setupView:function(e,t){for(var n=0,r=0,a=0,l=0,c=0,g=t.matrixWorldInverse,d=0,I=e.length;d<I;d++){var C=e[d];if(C.isDirectionalLight){var h=i.directional[n];h.direction.setFromMatrixPosition(C.matrixWorld),o.setFromMatrixPosition(C.target.matrixWorld),h.direction.sub(o),h.direction.transformDirection(g),n++}else if(C.isSpotLight){var f=i.spot[a];f.position.setFromMatrixPosition(C.matrixWorld),f.position.applyMatrix4(g),f.direction.setFromMatrixPosition(C.matrixWorld),o.setFromMatrixPosition(C.target.matrixWorld),f.direction.sub(o),f.direction.transformDirection(g),a++}else if(C.isRectAreaLight){var p=i.rectArea[l];p.position.setFromMatrixPosition(C.matrixWorld),p.position.applyMatrix4(g),u.identity(),s.copy(C.matrixWorld),s.premultiply(g),u.extractRotation(s),p.halfWidth.set(.5*C.width,0,0),p.halfHeight.set(0,.5*C.height,0),p.halfWidth.applyMatrix4(u),p.halfHeight.applyMatrix4(u),l++}else if(C.isPointLight){var A=i.point[r];A.position.setFromMatrixPosition(C.matrixWorld),A.position.applyMatrix4(g),r++}else if(C.isHemisphereLight){var m=i.hemi[c];m.direction.setFromMatrixPosition(C.matrixWorld),m.direction.transformDirection(g),m.direction.normalize(),c++}}},state:i}}function tu(e,t){var n=new eu(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(){n.setup(r)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function nu(e,t){var n=new WeakMap;return{get:function(r){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!1===n.has(r)?(i=new tu(e,t),n.set(r,[i])):a>=n.get(r).length?(i=new tu(e,t),n.get(r).push(i)):i=n.get(r)[a],i},dispose:function(){n=new WeakMap}}}var ru=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="MeshDepthMaterial",r.depthPacking=vn,r.skinning=!1,r.morphTargets=!1,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}]),n}(Ni);ru.prototype.isMeshDepthMaterial=!0;var iu=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="MeshDistanceMaterial",r.referencePosition=new yr,r.nearDistance=1,r.farDistance=1e3,r.skinning=!1,r.morphTargets=!1,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.fog=!1,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}]),n}(Ni);iu.prototype.isMeshDistanceMaterial=!0;function au(e,t,n){var r=new $a,i=new gr,a=new gr,o=new Ar,s=[],u=[],l={},c=n.maxTextureSize,g={0:R,1:S,2:M},d=new Ta({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new gr},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),I=d.clone();I.defines.HORIZONTAL_PASS=1;var C=new ma;C.setAttribute("position",new qi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var h=new Xa(C,d),f=this;function p(n,r){var i=t.update(h);d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,d,h,null),I.uniforms.shadow_pass.value=n.mapPass.texture,I.uniforms.resolution.value=n.mapSize,I.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,I,h,null)}function A(e,t,n){var r=e<<0|t<<1|n<<2,i=s[r];return void 0===i&&(i=new ru({depthPacking:bn,morphTargets:e,skinning:t}),s[r]=i),i}function m(e,t,n){var r=e<<0|t<<1|n<<2,i=u[r];return void 0===i&&(i=new iu({morphTargets:e,skinning:t}),u[r]=i),i}function v(t,n,r,i,a,o,s){var u=null,c=A,d=t.customDepthMaterial;if(!0===i.isPointLight&&(c=m,d=t.customDistanceMaterial),void 0===d){var I=!1;!0===r.morphTargets&&(I=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);var C=!1;!0===t.isSkinnedMesh&&(!0===r.skinning?C=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),u=c(I,C,!0===t.isInstancedMesh)}else u=d;if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var h=u.uuid,f=r.uuid,p=l[h];void 0===p&&(p={},l[h]=p);var v=p[f];void 0===v&&(v=u.clone(),p[f]=v),u=v}return u.visible=r.visible,u.wireframe=r.wireframe,u.side=s===x?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:g[r.side],u.clipShadows=r.clipShadows,u.clippingPlanes=r.clippingPlanes,u.clipIntersection=r.clipIntersection,u.wireframeLinewidth=r.wireframeLinewidth,u.linewidth=r.linewidth,!0===i.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(i.matrixWorld),u.nearDistance=a,u.farDistance=o),u}function b(n,i,a,o,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===x)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var u=t.update(n),l=n.material;if(Array.isArray(l))for(var c=u.groups,g=0,d=c.length;g<d;g++){var I=c[g],C=l[I.materialIndex];if(C&&C.visible){var h=v(n,u,C,o,a.near,a.far,s);e.renderBufferDirect(a,null,u,h,n,I)}}else if(l.visible){var f=v(n,u,l,o,a.near,a.far,s);e.renderBufferDirect(a,null,u,f,n,null)}}for(var p=n.children,A=0,m=p.length;A<m;A++)b(p[A],i,a,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=w,this.render=function(t,n,s){if(!1!==f.enabled&&(!1!==f.autoUpdate||!1!==f.needsUpdate)&&0!==t.length){var u=e.getRenderTarget(),l=e.getActiveCubeFace(),g=e.getActiveMipmapLevel(),d=e.state;d.setBlending(V),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var I=0,C=t.length;I<C;I++){var h=t[I],A=h.shadow;if(void 0!==A){if(!1!==A.autoUpdate||!1!==A.needsUpdate){i.copy(A.mapSize);var m=A.getFrameExtents();if(i.multiply(m),a.copy(A.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(a.x=Math.floor(c/m.x),i.x=a.x*m.x,A.mapSize.x=a.x),i.y>c&&(a.y=Math.floor(c/m.y),i.y=a.y*m.y,A.mapSize.y=a.y)),null===A.map&&!A.isPointLightShadow&&this.type===x){var v={minFilter:Ve,magFilter:Ve,format:$e};A.map=new mr(i.x,i.y,v),A.map.texture.name=h.name+".shadowMap",A.mapPass=new mr(i.x,i.y,v),A.camera.updateProjectionMatrix()}if(null===A.map){var y={minFilter:Se,magFilter:Se,format:$e};A.map=new mr(i.x,i.y,y),A.map.texture.name=h.name+".shadowMap",A.camera.updateProjectionMatrix()}e.setRenderTarget(A.map),e.clear();for(var B=A.getViewportCount(),G=0;G<B;G++){var Z=A.getViewport(G);o.set(a.x*Z.x,a.y*Z.y,a.x*Z.z,a.y*Z.w),d.viewport(o),A.updateMatrices(h,G),r=A.getFrustum(),b(n,s,A.camera,h,this.type)}A.isPointLightShadow||this.type!==x||p(A,s),A.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",h,"has no shadow.")}f.needsUpdate=!1,e.setRenderTarget(u,l,g)}}}function ou(e,t,n){var r,i,a=n.isWebGL2;var s=new function(){var t=!1,n=new Ar,r=null,i=new Ar(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},u=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){e?me(2929):ve(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case ne:e.depthFunc(512);break;case re:e.depthFunc(519);break;case ie:e.depthFunc(513);break;case ae:e.depthFunc(515);break;case oe:e.depthFunc(514);break;case se:e.depthFunc(518);break;case ue:e.depthFunc(516);break;case le:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},l=new function(){var t=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,l=null;return{setTest:function(e){t||(e?me(2960):ve(2960))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&u===r||(e.stencilOp(t,n,r),o=t,s=n,u=r)},setLocked:function(e){t=e},setClear:function(t){l!==t&&(e.clearStencil(t),l=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,l=null}}},c={},g=null,d={},I=null,C=!1,h=null,f=null,p=null,A=null,m=null,v=null,G=null,Z=!1,w=null,_=null,x=null,S=null,W=null,k=e.getParameter(35661),ce=!1,ge=0,de=e.getParameter(7938);-1!==de.indexOf("WebGL")?(ge=parseFloat(/^WebGL (\d)/.exec(de)[1]),ce=ge>=1):-1!==de.indexOf("OpenGL ES")&&(ge=parseFloat(/^OpenGL ES (\d)/.exec(de)[1]),ce=ge>=2);var Ie=null,Ce={},he=new Ar(0,0,e.canvas.width,e.canvas.height),fe=new Ar(0,0,e.canvas.width,e.canvas.height);function pe(t,n,r){var i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var o=0;o<r;o++)e.texImage2D(n+o,0,6408,1,1,0,6408,5121,i);return a}var Ae={};function me(t){!0!==c[t]&&(e.enable(t),c[t]=!0)}function ve(t){!1!==c[t]&&(e.disable(t),c[t]=!1)}Ae[3553]=pe(3553,3553,1),Ae[34067]=pe(34067,34069,6),s.setClear(0,0,0,1),u.setClear(1),l.setClear(0),me(2929),u.setFunc(ae),Ze(!1),we(y),me(2884),Ge(V);var be=(r={},(0,o.Z)(r,z,32774),(0,o.Z)(r,N,32778),(0,o.Z)(r,Y,32779),r);if(a)be[T]=32775,be[K]=32776;else{var ye=t.get("EXT_blend_minmax");null!==ye&&(be[T]=ye.MIN_EXT,be[K]=ye.MAX_EXT)}var Be=(i={},(0,o.Z)(i,D,0),(0,o.Z)(i,P,1),(0,o.Z)(i,U,768),(0,o.Z)(i,J,770),(0,o.Z)(i,te,776),(0,o.Z)(i,$,774),(0,o.Z)(i,j,772),(0,o.Z)(i,O,769),(0,o.Z)(i,Q,771),(0,o.Z)(i,ee,775),(0,o.Z)(i,q,773),i);function Ge(t,n,r,i,a,o,s,u){if(t!==V){if(!1===C&&(me(3042),C=!0),t===L)a=a||n,o=o||r,s=s||i,n===f&&a===m||(e.blendEquationSeparate(be[n],be[a]),f=n,m=a),r===p&&i===A&&o===v&&s===G||(e.blendFuncSeparate(Be[r],Be[i],Be[o],Be[s]),p=r,A=i,v=o,G=s),h=t,Z=null;else if(t!==h||u!==Z){if(f===z&&m===z||(e.blendEquation(32774),f=z,m=z),u)switch(t){case F:e.blendFuncSeparate(1,771,1,771);break;case E:e.blendFunc(1,1);break;case X:e.blendFuncSeparate(0,0,769,771);break;case H:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case F:e.blendFuncSeparate(770,771,1,771);break;case E:e.blendFunc(770,1);break;case X:e.blendFunc(0,769);break;case H:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}p=null,A=null,v=null,G=null,h=t,Z=u}}else!0===C&&(ve(3042),C=!1)}function Ze(t){w!==t&&(t?e.frontFace(2304):e.frontFace(2305),w=t)}function we(t){t!==b?(me(2884),t!==_&&(t===y?e.cullFace(1029):t===B?e.cullFace(1028):e.cullFace(1032))):ve(2884),_=t}function _e(t,n,r){t?(me(32823),S===n&&W===r||(e.polygonOffset(n,r),S=n,W=r)):ve(32823)}function xe(t){void 0===t&&(t=33984+k-1),Ie!==t&&(e.activeTexture(t),Ie=t)}return{buffers:{color:s,depth:u,stencil:l},enable:me,disable:ve,bindFramebuffer:function(t,n){null===n&&null!==g&&(n=g),d[t]!==n&&(e.bindFramebuffer(t,n),d[t]=n,a&&(36009===t&&(d[36160]=n),36160===t&&(d[36009]=n)))},bindXRFramebuffer:function(t){t!==g&&(e.bindFramebuffer(36160,t),g=t)},useProgram:function(t){return I!==t&&(e.useProgram(t),I=t,!0)},setBlending:Ge,setMaterial:function(e,t){e.side===M?ve(2884):me(2884);var n=e.side===R;t&&(n=!n),Ze(n),e.blending===F&&!1===e.transparent?Ge(V):Ge(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),u.setFunc(e.depthFunc),u.setTest(e.depthTest),u.setMask(e.depthWrite),s.setMask(e.colorWrite);var r=e.stencilWrite;l.setTest(r),r&&(l.setMask(e.stencilWriteMask),l.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),l.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),_e(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?me(32926):ve(32926)},setFlipSided:Ze,setCullFace:we,setLineWidth:function(t){t!==x&&(ce&&e.lineWidth(t),x=t)},setPolygonOffset:_e,setScissorTest:function(e){e?me(3089):ve(3089)},activeTexture:xe,bindTexture:function(t,n){null===Ie&&xe();var r=Ce[Ie];void 0===r&&(r={type:void 0,texture:void 0},Ce[Ie]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||Ae[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=Ce[Ie];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===he.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),he.copy(t))},viewport:function(t){!1===fe.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),fe.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===a&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),c={},Ie=null,Ce={},g=null,d={},I=null,C=!1,h=null,f=null,p=null,A=null,m=null,v=null,G=null,Z=!1,w=null,_=null,x=null,S=null,W=null,he.set(0,0,e.canvas.width,e.canvas.height),fe.set(0,0,e.canvas.width,e.canvas.height),s.reset(),u.reset(),l.reset()}}}function su(e,t,n,r,i,a,s){var u,l,c,g=i.isWebGL2,d=i.maxTextures,I=i.maxCubemapSize,C=i.maxTextureSize,h=i.maxSamples,f=new WeakMap,p=!1;try{p="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(N){}function A(e,t){return p?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function m(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?lr:Math.floor,o=a(i*e.width),s=a(i*e.height);void 0===c&&(c=A(o,s));var u=n?A(o,s):c;return u.width=o,u.height=s,u.getContext("2d").drawImage(e,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+s+")."),u}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function v(e){return sr(e.width)&&sr(e.height)}function b(e,t){return e.generateMipmaps&&t&&e.minFilter!==Se&&e.minFilter!==Ve}function y(t,n,i,a){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log2(Math.max(i,a))}function B(n,r,i){if(!1===g)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var a=r;return 6403===r&&(5126===i&&(a=33326),5131===i&&(a=33325),5121===i&&(a=33321)),6407===r&&(5126===i&&(a=34837),5131===i&&(a=34843),5121===i&&(a=32849)),6408===r&&(5126===i&&(a=34836),5131===i&&(a=34842),5121===i&&(a=32856)),33325!==a&&33326!==a&&34842!==a&&34836!==a||t.get("EXT_color_buffer_float"),a}function G(e){return e===Se||e===Re||e===We?9728:9729}function Z(t){var n=t.target;n.removeEventListener("dispose",Z),function(t){var n=r.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),r.remove(t)}(n),n.isVideoTexture&&f.delete(n),s.memory.textures--}function w(t){var n=t.target;n.removeEventListener("dispose",w),function(t){var n=t.texture,i=r.get(t),a=r.get(n);if(!t)return;void 0!==a.__webglTexture&&e.deleteTexture(a.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(var o=0;o<6;o++)e.deleteFramebuffer(i.__webglFramebuffer[o]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[o]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&e.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer);r.remove(n),r.remove(t)}(n),s.memory.textures--}var _=0;function x(e,t){var i=r.get(e);if(e.isVideoTexture&&function(e){var t=s.render.frame;f.get(e)!==t&&(f.set(e,t),e.update())}(e),e.version>0&&i.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void V(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function S(t,i){var o=r.get(t);t.version>0&&o.__version!==t.version?function(t,r,i){if(6!==r.image.length)return;k(t,r),n.activeTexture(33984+i),n.bindTexture(34067,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);for(var o=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),s=r.image[0]&&r.image[0].isDataTexture,u=[],l=0;l<6;l++)u[l]=o||s?s?r.image[l].image:r.image[l]:m(r.image[l],!1,!0,I);var c,d=u[0],C=v(d)||g,h=a.convert(r.format),f=a.convert(r.type),p=B(r.internalFormat,h,f);if(W(34067,r,C),o){for(var A=0;A<6;A++){c=u[A].mipmaps;for(var G=0;G<c.length;G++){var Z=c[G];r.format!==$e&&r.format!==qe?null!==h?n.compressedTexImage2D(34069+A,G,p,Z.width,Z.height,0,Z.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+A,G,p,Z.width,Z.height,0,h,f,Z.data)}}t.__maxMipLevel=c.length-1}else{c=r.mipmaps;for(var w=0;w<6;w++)if(s){n.texImage2D(34069+w,0,p,u[w].width,u[w].height,0,h,f,u[w].data);for(var _=0;_<c.length;_++){var x=c[_].image[w].image;n.texImage2D(34069+w,_+1,p,x.width,x.height,0,h,f,x.data)}}else{n.texImage2D(34069+w,0,p,h,f,u[w]);for(var S=0;S<c.length;S++){var R=c[S];n.texImage2D(34069+w,S+1,p,h,f,R.image[w])}}t.__maxMipLevel=c.length}b(r,C)&&y(34067,r,d.width,d.height);t.__version=r.version,r.onUpdate&&r.onUpdate(r)}(o,t,i):(n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture))}var R=(u={},(0,o.Z)(u,we,10497),(0,o.Z)(u,_e,33071),(0,o.Z)(u,xe,33648),u),M=(l={},(0,o.Z)(l,Se,9728),(0,o.Z)(l,Re,9984),(0,o.Z)(l,We,9986),(0,o.Z)(l,Ve,9729),(0,o.Z)(l,Fe,9985),(0,o.Z)(l,Xe,9987),l);function W(n,a,o){if(o?(e.texParameteri(n,10242,R[a.wrapS]),e.texParameteri(n,10243,R[a.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,R[a.wrapR]),e.texParameteri(n,10240,M[a.magFilter]),e.texParameteri(n,10241,M[a.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),a.wrapS===_e&&a.wrapT===_e||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,G(a.magFilter)),e.texParameteri(n,10241,G(a.minFilter)),a.minFilter!==Se&&a.minFilter!==Ve&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){var s=t.get("EXT_texture_filter_anisotropic");if(a.type===De&&!1===t.has("OES_texture_float_linear"))return;if(!1===g&&a.type===Pe&&!1===t.has("OES_texture_half_float_linear"))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function k(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",Z),t.__webglTexture=e.createTexture(),s.memory.textures++)}function V(t,r,i){var o=3553;r.isDataTexture2DArray&&(o=35866),r.isDataTexture3D&&(o=32879),k(t,r),n.activeTexture(33984+i),n.bindTexture(o,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);var s,u=function(e){return!g&&(e.wrapS!==_e||e.wrapT!==_e||e.minFilter!==Se&&e.minFilter!==Ve)}(r)&&!1===v(r.image),l=m(r.image,u,!1,C),c=v(l)||g,d=a.convert(r.format),I=a.convert(r.type),h=B(r.internalFormat,d,I);W(o,r,c);var f=r.mipmaps;if(r.isDepthTexture)h=6402,g?h=r.type===De?36012:r.type===Ke?33190:r.type===Qe?35056:33189:r.type===De&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===rt&&6402===h&&r.type!==Ye&&r.type!==Ke&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Ye,I=a.convert(r.type)),r.format===it&&6402===h&&(h=34041,r.type!==Qe&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Qe,I=a.convert(r.type))),n.texImage2D(3553,0,h,l.width,l.height,0,d,I,null);else if(r.isDataTexture)if(f.length>0&&c){for(var p=0,A=f.length;p<A;p++)s=f[p],n.texImage2D(3553,p,h,s.width,s.height,0,d,I,s.data);r.generateMipmaps=!1,t.__maxMipLevel=f.length-1}else n.texImage2D(3553,0,h,l.width,l.height,0,d,I,l.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(var G=0,Z=f.length;G<Z;G++)s=f[G],r.format!==$e&&r.format!==qe?null!==d?n.compressedTexImage2D(3553,G,h,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,G,h,s.width,s.height,0,d,I,s.data);t.__maxMipLevel=f.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,h,l.width,l.height,l.depth,0,d,I,l.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,h,l.width,l.height,l.depth,0,d,I,l.data),t.__maxMipLevel=0;else if(f.length>0&&c){for(var w=0,_=f.length;w<_;w++)s=f[w],n.texImage2D(3553,w,h,d,I,s);r.generateMipmaps=!1,t.__maxMipLevel=f.length-1}else n.texImage2D(3553,0,h,d,I,l),t.__maxMipLevel=0;b(r,c)&&y(o,r,l.width,l.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function F(t,i,o,s){var u=i.texture,l=a.convert(u.format),c=a.convert(u.type),g=B(u.internalFormat,l,c);32879===s||35866===s?n.texImage3D(s,0,g,i.width,i.height,i.depth,0,l,c,null):n.texImage2D(s,0,g,i.width,i.height,0,l,c,null),n.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,r.get(u).__webglTexture,0),n.bindFramebuffer(36160,null)}function E(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){var i=33189;if(r){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===De?i=36012:o.type===Ke&&(i=33190));var s=H(n);e.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else e.renderbufferStorage(36161,i,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(r){var u=H(n);e.renderbufferStorageMultisample(36161,u,35056,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var l=n.texture,c=a.convert(l.format),g=a.convert(l.type),d=B(l.internalFormat,c,g);if(r){var I=H(n);e.renderbufferStorageMultisample(36161,I,d,n.width,n.height)}else e.renderbufferStorage(36161,d,n.width,n.height)}e.bindRenderbuffer(36161,null)}function X(t){var i=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),x(i.depthTexture,0);var a=r.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===rt)e.framebufferTexture2D(36160,36096,3553,a,0);else{if(i.depthTexture.format!==it)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,a,0)}}(i.__webglFramebuffer,t)}else if(a){i.__webglDepthbuffer=[];for(var o=0;o<6;o++)n.bindFramebuffer(36160,i.__webglFramebuffer[o]),i.__webglDepthbuffer[o]=e.createRenderbuffer(),E(i.__webglDepthbuffer[o],t,!1)}else n.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),E(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function H(e){return g&&e.isWebGLMultisampleRenderTarget?Math.min(h,e.samples):0}var L=!1,z=!1;this.allocateTextureUnit=function(){var e=_;return e>=d&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+d),_+=1,e},this.resetTextureUnits=function(){_=0},this.setTexture2D=x,this.setTexture2DArray=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?V(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?V(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=S,this.setupRenderTarget=function(t){var i=t.texture,o=r.get(t),u=r.get(i);t.addEventListener("dispose",w),u.__webglTexture=e.createTexture(),u.__version=i.version,s.memory.textures++;var l=!0===t.isWebGLCubeRenderTarget,c=!0===t.isWebGLMultisampleRenderTarget,d=i.isDataTexture3D||i.isDataTexture2DArray,I=v(t)||g;if(!g||i.format!==qe||i.type!==De&&i.type!==Pe||(i.format=$e,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),l){o.__webglFramebuffer=[];for(var C=0;C<6;C++)o.__webglFramebuffer[C]=e.createFramebuffer()}else if(o.__webglFramebuffer=e.createFramebuffer(),c)if(g){o.__webglMultisampledFramebuffer=e.createFramebuffer(),o.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,o.__webglColorRenderbuffer);var h=a.convert(i.format),f=a.convert(i.type),p=B(i.internalFormat,h,f),A=H(t);e.renderbufferStorageMultisample(36161,A,p,t.width,t.height),n.bindFramebuffer(36160,o.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,o.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(o.__webglDepthRenderbuffer=e.createRenderbuffer(),E(o.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(l){n.bindTexture(34067,u.__webglTexture),W(34067,i,I);for(var m=0;m<6;m++)F(o.__webglFramebuffer[m],t,36064,34069+m);b(i,I)&&y(34067,i,t.width,t.height),n.bindTexture(34067,null)}else{var G=3553;if(d)if(g)G=i.isDataTexture3D?32879:35866;else console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.");n.bindTexture(G,u.__webglTexture),W(G,i,I),F(o.__webglFramebuffer,t,36064,G),b(i,I)&&y(3553,i,t.width,t.height),n.bindTexture(3553,null)}t.depthBuffer&&X(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(b(t,v(e)||g)){var i=e.isWebGLCubeRenderTarget?34067:3553,a=r.get(t).__webglTexture;n.bindTexture(i,a),y(i,t,e.width,e.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(g){var i=t.width,a=t.height,o=16384;t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024);var s=r.get(t);n.bindFramebuffer(36008,s.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,s.__webglFramebuffer),e.blitFramebuffer(0,0,i,a,0,0,i,a,o,9728),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,s.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===L&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),L=!0),e=e.texture),x(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),z=!0),e=e.texture),S(e,t)}}function uu(e,t,n){var r=n.isWebGL2;return{convert:function(e){var n;if(e===Le)return 5121;if(e===Ue)return 32819;if(e===Oe)return 32820;if(e===Je)return 33635;if(e===ze)return 5120;if(e===Ne)return 5122;if(e===Ye)return 5123;if(e===Te)return 5124;if(e===Ke)return 5125;if(e===De)return 5126;if(e===Pe)return r?5131:null!==(n=t.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(e===je)return 6406;if(e===qe)return 6407;if(e===$e)return 6408;if(e===et)return 6409;if(e===tt)return 6410;if(e===rt)return 6402;if(e===it)return 34041;if(e===at)return 6403;if(e===ot)return 36244;if(e===st)return 33319;if(e===ut)return 33320;if(e===lt)return 36248;if(e===ct)return 36249;if(e===gt||e===dt||e===It||e===Ct){if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(e===gt)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===dt)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===It)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Ct)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===ht||e===ft||e===pt||e===At){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===ht)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===ft)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===pt)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===At)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===mt)return null!==(n=t.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===vt||e===bt)&&null!==(n=t.get("WEBGL_compressed_texture_etc"))){if(e===vt)return n.COMPRESSED_RGB8_ETC2;if(e===bt)return n.COMPRESSED_RGBA8_ETC2_EAC}return e===yt||e===Bt||e===Gt||e===Zt||e===wt||e===_t||e===xt||e===St||e===Rt||e===Mt||e===Wt||e===kt||e===Vt||e===Ft||e===Xt||e===Ht||e===Lt||e===zt||e===Nt||e===Yt||e===Tt||e===Kt||e===Dt||e===Pt||e===Ut||e===Ot||e===Jt||e===Qt?null!==(n=t.get("WEBGL_compressed_texture_astc"))?e:null:e===Et?null!==(n=t.get("EXT_texture_compression_bptc"))?e:null:e===Qe?r?34042:null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}var lu=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,C.Z)(this,n),(e=t.call(this)).cameras=r,e}return(0,h.Z)(n)}(Da);lu.prototype.isArrayCamera=!0;var cu=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e;return(0,C.Z)(this,n),(e=t.call(this)).type="Group",e}return(0,h.Z)(n)}(Gi);cu.prototype.isGroup=!0;var gu={type:"move"},du=function(){function e(){(0,C.Z)(this,e),this._targetRay=null,this._grip=null,this._hand=null}return(0,h.Z)(e,[{key:"getHandSpace",value:function(){return null===this._hand&&(this._hand=new cu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}},{key:"getTargetRaySpace",value:function(){return null===this._targetRay&&(this._targetRay=new cu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new yr,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new yr),this._targetRay}},{key:"getGripSpace",value:function(){return null===this._grip&&(this._grip=new cu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new yr,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new yr),this._grip}},{key:"dispatchEvent",value:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}},{key:"disconnect",value:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}},{key:"update",value:function(e,t,n){var r=null,i=null,o=null,s=this._targetRay,u=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==s&&null!==(r=t.getPose(e.targetRaySpace,n))&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(gu)),l&&e.hand){o=!0;var c,g=(0,a.Z)(e.hand.values());try{for(g.s();!(c=g.n()).done;){var d=c.value,I=t.getJointPose(d,n);if(void 0===l.joints[d.jointName]){var C=new cu;C.matrixAutoUpdate=!1,C.visible=!1,l.joints[d.jointName]=C,l.add(C)}var h=l.joints[d.jointName];null!==I&&(h.matrix.fromArray(I.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.jointRadius=I.radius),h.visible=null!==I}}catch(m){g.e(m)}finally{g.f()}var f=l.joints["index-finger-tip"],p=l.joints["thumb-tip"],A=f.position.distanceTo(p.position);l.inputState.pinching&&A>.025?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&A<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==u&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,n))&&(u.matrix.fromArray(i.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),i.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(i.linearVelocity)):u.hasLinearVelocity=!1,i.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(i.angularVelocity)):u.hasAngularVelocity=!1);return null!==s&&(s.visible=null!==r),null!==u&&(u.visible=null!==i),null!==l&&(l.visible=null!==o),this}}]),e}(),Iu=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var a;(0,C.Z)(this,n),a=t.call(this);var o=(0,g.Z)(a),s=e.state,u=null,l=1,c=null,d="local-floor",I=null,h=[],f=new Map,A=new Da;A.layers.enable(1),A.viewport=new Ar;var m=new Da;m.layers.enable(2),m.viewport=new Ar;var v=[A,m],b=new lu;b.layers.enable(1),b.layers.enable(2);var y=null,B=null;function G(e){var t=f.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function Z(){f.forEach((function(e,t){e.disconnect(t)})),f.clear(),y=null,B=null,s.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),M.stop(),o.isPresenting=!1,o.dispatchEvent({type:"sessionend"})}function w(e){for(var t=u.inputSources,n=0;n<h.length;n++)f.set(t[n],h[n]);for(var r=0;r<e.removed.length;r++){var i=e.removed[r],a=f.get(i);a&&(a.dispatchEvent({type:"disconnected",data:i}),f.delete(i))}for(var o=0;o<e.added.length;o++){var s=e.added[o],l=f.get(s);l&&l.dispatchEvent({type:"connected",data:s})}}a.enabled=!1,a.isPresenting=!1,a.getController=function(e){var t=h[e];return void 0===t&&(t=new du,h[e]=t),t.getTargetRaySpace()},a.getControllerGrip=function(e){var t=h[e];return void 0===t&&(t=new du,h[e]=t),t.getGripSpace()},a.getHand=function(e){var t=h[e];return void 0===t&&(t=new du,h[e]=t),t.getHandSpace()},a.setFramebufferScaleFactor=function(e){l=e,!0===o.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},a.setReferenceSpaceType=function(e){d=e,!0===o.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},a.getReferenceSpace=function(){return c},a.getSession=function(){return u},a.setSession=function(){var e=(0,i.Z)(p().mark((function e(t){var n,i,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(u=t)){e.next=24;break}if(u.addEventListener("select",G),u.addEventListener("selectstart",G),u.addEventListener("selectend",G),u.addEventListener("squeeze",G),u.addEventListener("squeezestart",G),u.addEventListener("squeezeend",G),u.addEventListener("end",Z),u.addEventListener("inputsourceschange",w),!0===(n=r.getContextAttributes()).xrCompatible){e.next=14;break}return e.next=14,r.makeXRCompatible();case 14:return i={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:l},a=new XRWebGLLayer(u,r,i),u.updateRenderState({baseLayer:a}),e.next=19,u.requestReferenceSpace(d);case 19:c=e.sent,M.setContext(u),M.start(),o.isPresenting=!0,o.dispatchEvent({type:"sessionstart"});case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var _=new yr,x=new yr;function S(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}a.getCamera=function(e){b.near=m.near=A.near=e.near,b.far=m.far=A.far=e.far,y===b.near&&B===b.far||(u.updateRenderState({depthNear:b.near,depthFar:b.far}),y=b.near,B=b.far);var t=e.parent,n=b.cameras;S(b,t);for(var r=0;r<n.length;r++)S(n[r],t);e.matrixWorld.copy(b.matrixWorld),e.matrix.copy(b.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);for(var i=e.children,a=0,o=i.length;a<o;a++)i[a].updateMatrixWorld(!0);return 2===n.length?function(e,t,n){_.setFromMatrixPosition(t.matrixWorld),x.setFromMatrixPosition(n.matrixWorld);var r=_.distanceTo(x),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],l=(i[9]-1)/i[5],c=(i[8]-1)/i[0],g=(a[8]+1)/a[0],d=o*c,I=o*g,C=r/(-c+g),h=C*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(h),e.translateZ(C),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();var f=o+C,p=s+C,A=d-h,m=I+(r-h),v=u*s/p*f,b=l*s/p*f;e.projectionMatrix.makePerspective(A,m,v,b,f,p)}(b,A,m):b.projectionMatrix.copy(A.projectionMatrix),b};var R=null;var M=new eo;return M.setAnimationLoop((function(e,t){if(null!==(I=t.getViewerPose(c))){var n=I.views,r=u.renderState.baseLayer;s.bindXRFramebuffer(r.framebuffer);var i=!1;n.length!==b.cameras.length&&(b.cameras.length=0,i=!0);for(var a=0;a<n.length;a++){var o=n[a],l=r.getViewport(o),g=v[a];g.matrix.fromArray(o.transform.matrix),g.projectionMatrix.fromArray(o.projectionMatrix),g.viewport.set(l.x,l.y,l.width,l.height),0===a&&b.matrix.copy(g.matrix),!0===i&&b.cameras.push(g)}}for(var d=u.inputSources,C=0;C<h.length;C++){var f=h[C],p=d[C];f.update(p,t,c)}R&&R(e,t)})),a.setAnimationLoop=function(e){R=e},a.dispose=function(){},a}return(0,h.Z)(n)}(jn);function Cu(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap);var r,i,a=e.get(n).envMap;if(a){t.envMap.value=a,t.flipEnvMap.value=a.isCubeTexture&&a._needsFlipEnvMap?-1:1,t.reflectivity.value=n.reflectivity,t.refractionRatio.value=n.refractionRatio;var o=e.get(a).__maxMipLevel;void 0!==o&&(t.maxMipLevel.value=o)}n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(r=n.clearcoatRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),n.aoMap?i=n.aoMap:n.lightMap&&(i=n.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,n.side===R&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),n.side===R&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,i,a){r.isMeshBasicMaterial?t(e,r):r.isMeshLambertMaterial?(t(e,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,r)):r.isMeshToonMaterial?(t(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===R&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===R&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshPhongMaterial?(t(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===R&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===R&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshStandardMaterial?(t(e,r),r.isMeshPhysicalMaterial?function(e,t){n(e,t),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen);t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap);t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap);t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===R&&e.clearcoatNormalScale.value.negate());e.transmission.value=t.transmission,t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap)}(e,r):n(e,r)):r.isMeshMatcapMaterial?(t(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===R&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===R&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDepthMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDistanceMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?(t(e,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===R&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===R&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,r,i,a):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function hu(e){var t=void 0!==(e=e||{}).canvas?e.canvas:function(){var e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return e.style.display="block",e}(),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,l=void 0!==e.powerPreference?e.powerPreference:"default",c=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,g=null,d=null,I=[],C=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=dn,this.physicallyCorrectLights=!1,this.toneMapping=Ie,this.toneMappingExposure=1;var h=this,f=!1,p=0,A=0,m=null,v=-1,b=null,y=new Ar,B=new Ar,G=null,Z=t.width,w=t.height,_=1,x=null,S=null,R=new Ar(0,0,Z,w),M=new Ar(0,0,Z,w),W=!1,k=new $a,V=!1,F=!1,E=new $r,X=new yr,H={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function L(){return null===m?_:1}var z,N,Y,T,K,D,P,U,O,J,Q,j,q,$,ee,te,ne,re,ie,ae,oe,se,ue=n;function le(e,n){for(var r=0;r<e.length;r++){var i=e[r],a=t.getContext(i,n);if(null!==a)return a}return null}try{var ce={alpha:r,depth:i,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:l,failIfMajorPerformanceCaveat:c};if(t.addEventListener("webglcontextlost",he,!1),t.addEventListener("webglcontextrestored",fe,!1),null===ue){var ge=["webgl2","webgl","experimental-webgl"];if(!0===h.isWebGL1Renderer&&ge.shift(),null===(ue=le(ge,ce)))throw le(ge)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ue.getShaderPrecisionFormat&&(ue.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(xe){throw console.error("THREE.WebGLRenderer: "+xe.message),xe}function de(){z=new Io(ue),N=new lo(ue,z,e),z.init(N),oe=new uu(ue,z,N),Y=new ou(ue,z,N),T=new fo(ue),K=new Ps,D=new su(ue,z,Y,K,N,oe,T),P=new go(h),U=new to(ue,N),se=new so(ue,z,U,N),O=new Co(ue,U,T,se),J=new vo(ue,O,U,T),re=new mo(ue),ee=new co(K),Q=new Ds(h,P,z,N,se,ee),j=new Cu(K),q=new Qs(K),$=new nu(z,N),ne=new oo(h,P,Y,J,s),te=new au(h,J,N),ie=new uo(ue,z,T,N),ae=new ho(ue,z,T,N),T.programs=Q.programs,h.capabilities=N,h.extensions=z,h.properties=K,h.renderLists=q,h.shadowMap=te,h.state=Y,h.info=T}de();var Ce=new Iu(h,ue);function he(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),f=!0}function fe(){console.log("THREE.WebGLRenderer: Context Restored."),f=!1;var e=T.autoReset,t=te.enabled,n=te.autoUpdate,r=te.needsUpdate,i=te.type;de(),T.autoReset=e,te.enabled=t,te.autoUpdate=n,te.needsUpdate=r,te.type=i}function pe(e){var t=e.target;t.removeEventListener("dispose",pe),function(e){(function(e){var t=K.get(e).programs;void 0!==t&&t.forEach((function(e){Q.releaseProgram(e)}))})(e),K.remove(e)}(t)}this.xr=Ce,this.getContext=function(){return ue},this.getContextAttributes=function(){return ue.getContextAttributes()},this.forceContextLoss=function(){var e=z.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=z.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return _},this.setPixelRatio=function(e){void 0!==e&&(_=e,this.setSize(Z,w,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new gr),e.set(Z,w)},this.setSize=function(e,n,r){Ce.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Z=e,w=n,t.width=Math.floor(e*_),t.height=Math.floor(n*_),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new gr),e.set(Z*_,w*_).floor()},this.setDrawingBufferSize=function(e,n,r){Z=e,w=n,_=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new Ar),e.copy(y)},this.getViewport=function(e){return e.copy(R)},this.setViewport=function(e,t,n,r){e.isVector4?R.set(e.x,e.y,e.z,e.w):R.set(e,t,n,r),Y.viewport(y.copy(R).multiplyScalar(_).floor())},this.getScissor=function(e){return e.copy(M)},this.setScissor=function(e,t,n,r){e.isVector4?M.set(e.x,e.y,e.z,e.w):M.set(e,t,n,r),Y.scissor(B.copy(M).multiplyScalar(_).floor())},this.getScissorTest=function(){return W},this.setScissorTest=function(e){Y.setScissorTest(W=e)},this.setOpaqueSort=function(e){x=e},this.setTransparentSort=function(e){S=e},this.getClearColor=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),e=new Oi),e.copy(ne.getClearColor())},this.setClearColor=function(){ne.setClearColor.apply(ne,arguments)},this.getClearAlpha=function(){return ne.getClearAlpha()},this.setClearAlpha=function(){ne.setClearAlpha.apply(ne,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),ue.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",he,!1),t.removeEventListener("webglcontextrestored",fe,!1),q.dispose(),$.dispose(),K.dispose(),P.dispose(),J.dispose(),se.dispose(),Ce.dispose(),Ce.removeEventListener("sessionstart",me),Ce.removeEventListener("sessionend",ve),be.stop()},this.renderBufferImmediate=function(e,t){se.initAttributes();var n=K.get(e);e.hasPositions&&!n.position&&(n.position=ue.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=ue.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=ue.createBuffer()),e.hasColors&&!n.color&&(n.color=ue.createBuffer());var r=t.getAttributes();e.hasPositions&&(ue.bindBuffer(34962,n.position),ue.bufferData(34962,e.positionArray,35048),se.enableAttribute(r.position),ue.vertexAttribPointer(r.position,3,5126,!1,0,0)),e.hasNormals&&(ue.bindBuffer(34962,n.normal),ue.bufferData(34962,e.normalArray,35048),se.enableAttribute(r.normal),ue.vertexAttribPointer(r.normal,3,5126,!1,0,0)),e.hasUvs&&(ue.bindBuffer(34962,n.uv),ue.bufferData(34962,e.uvArray,35048),se.enableAttribute(r.uv),ue.vertexAttribPointer(r.uv,2,5126,!1,0,0)),e.hasColors&&(ue.bindBuffer(34962,n.color),ue.bufferData(34962,e.colorArray,35048),se.enableAttribute(r.color),ue.vertexAttribPointer(r.color,3,5126,!1,0,0)),se.disableUnusedAttributes(),ue.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=H);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=_e(e,t,r,i);Y.setMaterial(r,o);var u=n.index,l=n.attributes.position;if(null===u){if(void 0===l||0===l.count)return}else if(0===u.count)return;var c,g=1;!0===r.wireframe&&(u=O.getWireframeAttribute(n),g=2),(r.morphTargets||r.morphNormals)&&re.update(i,n,r,s),se.setup(i,r,s,n,u);var d=ie;null!==u&&(c=U.get(u),(d=ae).setIndex(c));var I=null!==u?u.count:l.count,C=n.drawRange.start*g,h=n.drawRange.count*g,f=null!==a?a.start*g:0,p=null!==a?a.count*g:1/0,A=Math.max(C,f),m=Math.min(I,C+h,f+p)-1,v=Math.max(0,m-A+1);if(0!==v){if(i.isMesh)!0===r.wireframe?(Y.setLineWidth(r.wireframeLinewidth*L()),d.setMode(1)):d.setMode(4);else if(i.isLine){var b=r.linewidth;void 0===b&&(b=1),Y.setLineWidth(b*L()),i.isLineSegments?d.setMode(1):i.isLineLoop?d.setMode(2):d.setMode(3)}else i.isPoints?d.setMode(0):i.isSprite&&d.setMode(4);if(i.isInstancedMesh)d.renderInstances(A,v,i.count);else if(n.isInstancedBufferGeometry){var y=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(A,v,y)}else d.render(A,v)}},this.compile=function(e,t){(d=$.get(e)).init(),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(),e.traverse((function(t){var n=t.material;if(n)if(Array.isArray(n))for(var r=0;r<n.length;r++){Ze(n[r],e,t)}else Ze(n,e,t)}))};var Ae=null;function me(){be.stop()}function ve(){be.start()}var be=new eo;function ye(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||k.intersectsSprite(e)){r&&X.setFromMatrixPosition(e.matrixWorld).applyMatrix4(E);var i=J.update(e),a=e.material;a.visible&&g.push(e,i,a,n,X.z,null)}}else if(e.isImmediateRenderObject)r&&X.setFromMatrixPosition(e.matrixWorld).applyMatrix4(E),g.push(e,null,e.material,n,X.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==T.render.frame&&(e.skeleton.update(),e.skeleton.frame=T.render.frame),!e.frustumCulled||k.intersectsObject(e))){r&&X.setFromMatrixPosition(e.matrixWorld).applyMatrix4(E);var o=J.update(e),s=e.material;if(Array.isArray(s))for(var u=o.groups,l=0,c=u.length;l<c;l++){var I=u[l],C=s[I.materialIndex];C&&C.visible&&g.push(e,o,C,n,X.z,I)}else s.visible&&g.push(e,o,s,n,X.z,null)}for(var h=e.children,f=0,p=h.length;f<p;f++)ye(h[f],t,n,r)}}function Be(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,i=0,a=e.length;i<a;i++){var o=e[i],s=o.object,u=o.geometry,l=null===r?o.material:r,c=o.group;if(n.isArrayCamera)for(var g=n.cameras,I=0,C=g.length;I<C;I++){var h=g[I];s.layers.test(h.layers)&&(Y.viewport(y.copy(h.viewport)),d.setupLightsView(h),Ge(s,t,h,u,l,c))}else Ge(s,t,n,u,l,c)}}function Ge(e,t,n,r,i,a){if(e.onBeforeRender(h,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var o=_e(n,t,i,e);Y.setMaterial(i),se.reset(),function(e,t){e.render((function(e){h.renderBufferImmediate(e,t)}))}(e,o)}else h.renderBufferDirect(n,t,r,i,e,a);e.onAfterRender(h,t,n,r,i,a)}function Ze(e,t,n){!0!==t.isScene&&(t=H);var r=K.get(e),i=d.state.lights,a=d.state.shadowsArray,o=i.state.version,s=Q.getParameters(e,i.state,a,t,n),u=Q.getProgramCacheKey(s),l=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=P.get(e.envMap||r.environment),void 0===l&&(e.addEventListener("dispose",pe),l=new Map,r.programs=l);var c=l.get(u);if(void 0!==c){if(r.currentProgram===c&&r.lightsStateVersion===o)return we(e,s),c}else s.uniforms=Q.getUniforms(e),e.onBuild(s,h),e.onBeforeCompile(s,h),c=Q.acquireProgram(s,u),l.set(u,c),r.uniforms=s.uniforms;var g=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(g.clippingPlanes=ee.uniform),we(e,s),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=o,r.needsLights&&(g.ambientLightColor.value=i.state.ambient,g.lightProbe.value=i.state.probe,g.directionalLights.value=i.state.directional,g.directionalLightShadows.value=i.state.directionalShadow,g.spotLights.value=i.state.spot,g.spotLightShadows.value=i.state.spotShadow,g.rectAreaLights.value=i.state.rectArea,g.ltc_1.value=i.state.rectAreaLTC1,g.ltc_2.value=i.state.rectAreaLTC2,g.pointLights.value=i.state.point,g.pointLightShadows.value=i.state.pointShadow,g.hemisphereLights.value=i.state.hemi,g.directionalShadowMap.value=i.state.directionalShadowMap,g.directionalShadowMatrix.value=i.state.directionalShadowMatrix,g.spotShadowMap.value=i.state.spotShadowMap,g.spotShadowMatrix.value=i.state.spotShadowMatrix,g.pointShadowMap.value=i.state.pointShadowMap,g.pointShadowMatrix.value=i.state.pointShadowMatrix);var I=c.getUniforms(),C=Gs.seqWithValue(I.seq,g);return r.currentProgram=c,r.uniformsList=C,c}function we(e,t){var n=K.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas}function _e(e,t,n,r){!0!==t.isScene&&(t=H),D.resetTextureUnits();var i=t.fog,a=n.isMeshStandardMaterial?t.environment:null,o=null===m?h.outputEncoding:m.texture.encoding,s=P.get(n.envMap||a),u=!0===n.vertexColors&&r.geometry&&r.geometry.attributes.color&&4===r.geometry.attributes.color.itemSize,l=K.get(n),c=d.state.lights;if(!0===V&&(!0===F||e!==b)){var g=e===b&&n.id===v;ee.setState(n,e,g)}var I=!1;n.version===l.__version?l.needsLights&&l.lightsStateVersion!==c.state.version||l.outputEncoding!==o||r.isInstancedMesh&&!1===l.instancing?I=!0:r.isInstancedMesh||!0!==l.instancing?l.envMap!==s||n.fog&&l.fog!==i?I=!0:void 0===l.numClippingPlanes||l.numClippingPlanes===ee.numPlanes&&l.numIntersection===ee.numIntersection?l.vertexAlphas!==u&&(I=!0):I=!0:I=!0:(I=!0,l.__version=n.version);var C=l.currentProgram;!0===I&&(C=Ze(n,t,r));var f,p,A=!1,y=!1,B=!1,G=C.getUniforms(),Z=l.uniforms;if(Y.useProgram(C.program)&&(A=!0,y=!0,B=!0),n.id!==v&&(v=n.id,y=!0),A||b!==e){if(G.setValue(ue,"projectionMatrix",e.projectionMatrix),N.logarithmicDepthBuffer&&G.setValue(ue,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),b!==e&&(b=e,y=!0,B=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var x=G.map.cameraPosition;void 0!==x&&x.setValue(ue,X.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&G.setValue(ue,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&G.setValue(ue,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){G.setOptional(ue,r,"bindMatrix"),G.setOptional(ue,r,"bindMatrixInverse");var S=r.skeleton;if(S){var R=S.bones;if(N.floatVertexTextures){if(null===S.boneTexture){var M=Math.sqrt(4*R.length);M=ur(M),M=Math.max(M,4);var W=new Float32Array(M*M*4);W.set(S.boneMatrices);var k=new Qa(W,M,M,$e,De);S.boneMatrices=W,S.boneTexture=k,S.boneTextureSize=M}G.setValue(ue,"boneTexture",S.boneTexture,D),G.setValue(ue,"boneTextureSize",S.boneTextureSize)}else G.setOptional(ue,S,"boneMatrices")}}return(y||l.receiveShadow!==r.receiveShadow)&&(l.receiveShadow=r.receiveShadow,G.setValue(ue,"receiveShadow",r.receiveShadow)),y&&(G.setValue(ue,"toneMappingExposure",h.toneMappingExposure),l.needsLights&&(p=B,(f=Z).ambientLightColor.needsUpdate=p,f.lightProbe.needsUpdate=p,f.directionalLights.needsUpdate=p,f.directionalLightShadows.needsUpdate=p,f.pointLights.needsUpdate=p,f.pointLightShadows.needsUpdate=p,f.spotLights.needsUpdate=p,f.spotLightShadows.needsUpdate=p,f.rectAreaLights.needsUpdate=p,f.hemisphereLights.needsUpdate=p),i&&n.fog&&j.refreshFogUniforms(Z,i),j.refreshMaterialUniforms(Z,n,_,w),Gs.upload(ue,l.uniformsList,Z,D)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Gs.upload(ue,l.uniformsList,Z,D),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&G.setValue(ue,"center",r.center),G.setValue(ue,"modelViewMatrix",r.modelViewMatrix),G.setValue(ue,"normalMatrix",r.normalMatrix),G.setValue(ue,"modelMatrix",r.matrixWorld),C}be.setAnimationLoop((function(e){Ae&&Ae(e)})),"undefined"!==typeof window&&be.setContext(window),this.setAnimationLoop=function(e){Ae=e,Ce.setAnimationLoop(e),null===e?be.stop():be.start()},Ce.addEventListener("sessionstart",me),Ce.addEventListener("sessionend",ve),this.render=function(e,t){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),void 0===t||!0===t.isCamera){if(!0!==f){!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===Ce.enabled&&!0===Ce.isPresenting&&(t=Ce.getCamera(t)),!0===e.isScene&&e.onBeforeRender(h,e,t,n||m),(d=$.get(e,C.length)).init(),C.push(d),E.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),k.setFromProjectionMatrix(E),F=this.localClippingEnabled,V=ee.init(this.clippingPlanes,F,t),(g=q.get(e,I.length)).init(),I.push(g),ye(e,t,0,h.sortObjects),g.finish(),!0===h.sortObjects&&g.sort(x,S),!0===V&&ee.beginShadows();var i=d.state.shadowsArray;te.render(i,e,t),d.setupLights(),d.setupLightsView(t),!0===V&&ee.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),ne.render(g,e,t,r);var a=g.opaque,o=g.transparent;a.length>0&&Be(a,e,t),o.length>0&&Be(o,e,t),null!==m&&(D.updateRenderTargetMipmap(m),D.updateMultisampleRenderTarget(m)),!0===e.isScene&&e.onAfterRender(h,e,t),Y.buffers.depth.setTest(!0),Y.buffers.depth.setMask(!0),Y.buffers.color.setMask(!0),Y.setPolygonOffset(!1),se.resetDefaultState(),v=-1,b=null,C.pop(),d=C.length>0?C[C.length-1]:null,I.pop(),g=I.length>0?I[I.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return p},this.getActiveMipmapLevel=function(){return A},this.getRenderTarget=function(){return m},this.setRenderTarget=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;m=e,p=t,A=n,e&&void 0===K.get(e).__webglFramebuffer&&D.setupRenderTarget(e);var r=null,i=!1,a=!1;if(e){var o=e.texture;(o.isDataTexture3D||o.isDataTexture2DArray)&&(a=!0);var s=K.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=s[t],i=!0):r=e.isWebGLMultisampleRenderTarget?K.get(e).__webglMultisampledFramebuffer:s,y.copy(e.viewport),B.copy(e.scissor),G=e.scissorTest}else y.copy(R).multiplyScalar(_).floor(),B.copy(M).multiplyScalar(_).floor(),G=W;if(Y.bindFramebuffer(36160,r),Y.viewport(y),Y.scissor(B),Y.setScissorTest(G),i){var u=K.get(e.texture);ue.framebufferTexture2D(36160,36064,34069+t,u.__webglTexture,n)}else if(a){var l=K.get(e.texture),c=t||0;ue.framebufferTextureLayer(36160,36064,l.__webglTexture,n||0,c)}},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(e&&e.isWebGLRenderTarget){var s=K.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){Y.bindFramebuffer(36160,s);try{var u=e.texture,l=u.format,c=u.type;if(l!==$e&&oe.convert(l)!==ue.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var g=c===Pe&&(z.has("EXT_color_buffer_half_float")||N.isWebGL2&&z.has("EXT_color_buffer_float"));if(c!==Le&&oe.convert(c)!==ue.getParameter(35738)&&(c!==De||!(N.isWebGL2||z.has("OES_texture_float")||z.has("WEBGL_color_buffer_float")))&&!g)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ue.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&ue.readPixels(t,n,r,i,oe.convert(l),oe.convert(c),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{var d=null!==m?K.get(m).__webglFramebuffer:null;Y.bindFramebuffer(36160,d)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.pow(2,-n),i=Math.floor(t.image.width*r),a=Math.floor(t.image.height*r),o=oe.convert(t.format);D.setTexture2D(t,0),ue.copyTexImage2D(3553,n,o,e.x,e.y,i,a,0),Y.unbindTexture()},this.copyTextureToTexture=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.image.width,a=t.image.height,o=oe.convert(n.format),s=oe.convert(n.type);D.setTexture2D(n,0),ue.pixelStorei(37440,n.flipY),ue.pixelStorei(37441,n.premultiplyAlpha),ue.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?ue.texSubImage2D(3553,r,e.x,e.y,i,a,o,s,t.image.data):t.isCompressedTexture?ue.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):ue.texSubImage2D(3553,r,e.x,e.y,o,s,t.image),0===r&&n.generateMipmaps&&ue.generateMipmap(3553),Y.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(h.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var a,o=n.image,s=o.width,u=o.height,l=o.data,c=oe.convert(r.format),g=oe.convert(r.type);if(r.isDataTexture3D)D.setTexture3D(r,0),a=32879;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");D.setTexture2DArray(r,0),a=35866}ue.pixelStorei(37440,r.flipY),ue.pixelStorei(37441,r.premultiplyAlpha),ue.pixelStorei(3317,r.unpackAlignment);var d=ue.getParameter(3314),I=ue.getParameter(32878),C=ue.getParameter(3316),f=ue.getParameter(3315),p=ue.getParameter(32877);ue.pixelStorei(3314,s),ue.pixelStorei(32878,u),ue.pixelStorei(3316,e.min.x),ue.pixelStorei(3315,e.min.y),ue.pixelStorei(32877,e.min.z),ue.texSubImage3D(a,i,t.x,t.y,t.z,e.max.x-e.min.x+1,e.max.y-e.min.y+1,e.max.z-e.min.z+1,c,g,l),ue.pixelStorei(3314,d),ue.pixelStorei(32878,I),ue.pixelStorei(3316,C),ue.pixelStorei(3315,f),ue.pixelStorei(32877,p),0===i&&r.generateMipmaps&&ue.generateMipmap(a),Y.unbindTexture()}},this.initTexture=function(e){D.setTexture2D(e,0),Y.unbindTexture()},this.resetState=function(){p=0,A=0,m=null,Y.reset(),se.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var fu=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){return(0,C.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n)}(hu);fu.prototype.isWebGL1Renderer=!0;var pu=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;(0,C.Z)(this,e),this.name="",this.color=new Oi(t),this.density=n}return(0,h.Z)(e,[{key:"clone",value:function(){return new e(this.color,this.density)}},{key:"toJSON",value:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}]),e}();pu.prototype.isFogExp2=!0;var Au=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;(0,C.Z)(this,e),this.name="",this.color=new Oi(t),this.near=n,this.far=r}return(0,h.Z)(e,[{key:"clone",value:function(){return new e(this.color,this.near,this.far)}},{key:"toJSON",value:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}]),e}();Au.prototype.isFog=!0;var mu=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e;return(0,C.Z)(this,n),(e=t.call(this)).type="Scene",e.background=null,e.environment=null,e.fog=null,e.overrideMaterial=null,e.autoUpdate=!0,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:(0,g.Z)(e)})),e}return(0,h.Z)(n,[{key:"copy",value:function(e,t){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}},{key:"toJSON",value:function(e){var t=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}]),n}(Gi);mu.prototype.isScene=!0;var vu=function(){function e(t,n){(0,C.Z)(this,e),this.array=t,this.stride=n,this.count=void 0!==t?t.length/n:0,this.usage=zn,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=rr(),this.onUploadCallback=function(){}}return(0,h.Z)(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"copy",value:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}},{key:"copyAt",value:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"clone",value:function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=rr()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var n=new e(new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),this.stride);return n.setUsage(this.usage),n}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"toJSON",value:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=rr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}]),e}();vu.prototype.isInterleavedBuffer=!0;var bu=new yr,yu=function(){function e(t,n,r,i){(0,C.Z)(this,e),this.name="",this.data=t,this.itemSize=n,this.offset=r,this.normalized=!0===i}return(0,h.Z)(e,[{key:"count",get:function(){return this.data.count}},{key:"array",get:function(){return this.data.array}},{key:"needsUpdate",set:function(e){this.data.needsUpdate=e}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.data.count;t<n;t++)bu.x=this.getX(t),bu.y=this.getY(t),bu.z=this.getZ(t),bu.applyMatrix4(e),this.setXYZ(t,bu.x,bu.y,bu.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)bu.x=this.getX(t),bu.y=this.getY(t),bu.z=this.getZ(t),bu.applyNormalMatrix(e),this.setXYZ(t,bu.x,bu.y,bu.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)bu.x=this.getX(t),bu.y=this.getY(t),bu.z=this.getZ(t),bu.transformDirection(e),this.setXYZ(t,bu.x,bu.y,bu.z);return this}},{key:"setX",value:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}},{key:"setY",value:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}},{key:"setZ",value:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}},{key:"setW",value:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}},{key:"getX",value:function(e){return this.data.array[e*this.data.stride+this.offset]}},{key:"getY",value:function(e){return this.data.array[e*this.data.stride+this.offset+1]}},{key:"getZ",value:function(e){return this.data.array[e*this.data.stride+this.offset+2]}},{key:"getW",value:function(e){return this.data.array[e*this.data.stride+this.offset+3]}},{key:"setXY",value:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}},{key:"clone",value:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var n=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,a=0;a<this.itemSize;a++)n.push(this.data.array[i+a]);return new qi(new this.array.constructor(n),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new e(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}},{key:"toJSON",value:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}]),e}();yu.prototype.isInterleavedBufferAttribute=!0;var Bu,Gu=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="SpriteMaterial",r.color=new Oi(16777215),r.map=null,r.alphaMap=null,r.rotation=0,r.sizeAttenuation=!0,r.transparent=!0,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}]),n}(Ni);Gu.prototype.isSpriteMaterial=!0;var Zu=new yr,wu=new yr,_u=new yr,xu=new gr,Su=new gr,Ru=new $r,Mu=new yr,Wu=new yr,ku=new yr,Vu=new gr,Fu=new gr,Eu=new gr,Xu=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;if((0,C.Z)(this,n),(r=t.call(this)).type="Sprite",void 0===Bu){Bu=new ma;var i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),a=new vu(i,5);Bu.setIndex([0,1,2,0,2,3]),Bu.setAttribute("position",new yu(a,3,0,!1)),Bu.setAttribute("uv",new yu(a,2,3,!1))}return r.geometry=Bu,r.material=void 0!==e?e:new Gu,r.center=new gr(.5,.5),r}return(0,h.Z)(n,[{key:"raycast",value:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),wu.setFromMatrixScale(this.matrixWorld),Ru.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),_u.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&wu.multiplyScalar(-_u.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var a=this.center;Hu(Mu.set(-.5,-.5,0),_u,a,wu,n,r),Hu(Wu.set(.5,-.5,0),_u,a,wu,n,r),Hu(ku.set(.5,.5,0),_u,a,wu,n,r),Vu.set(0,0),Fu.set(1,0),Eu.set(1,1);var o=e.ray.intersectTriangle(Mu,Wu,ku,!1,Zu);if(null!==o||(Hu(Wu.set(-.5,.5,0),_u,a,wu,n,r),Fu.set(0,1),null!==(o=e.ray.intersectTriangle(Mu,ku,Wu,!1,Zu)))){var s=e.ray.origin.distanceTo(Zu);s<e.near||s>e.far||t.push({distance:s,point:Zu.clone(),uv:Li.getUV(Zu,Mu,Wu,ku,Vu,Fu,Eu,new gr),face:null,object:this})}}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}]),n}(Gi);function Hu(e,t,n,r,i,a){xu.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(Su.x=a*xu.x-i*xu.y,Su.y=i*xu.x+a*xu.y):Su.copy(xu),e.copy(t),e.x+=Su.x,e.y+=Su.y,e.applyMatrix4(Ru)}Xu.prototype.isSprite=!0;var Lu=new yr,zu=new yr,Nu=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e;return(0,C.Z)(this,n),(e=t.call(this))._currentLevel=0,e.type="LOD",Object.defineProperties((0,g.Z)(e),{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),e.autoUpdate=!0,e}return(0,h.Z)(n,[{key:"copy",value:function(e){(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e,!1);for(var t=e.levels,r=0,i=t.length;r<i;r++){var a=t[r];this.addLevel(a.object.clone(),a.distance)}return this.autoUpdate=e.autoUpdate,this}},{key:"addLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t=Math.abs(t);var n,r=this.levels;for(n=0;n<r.length&&!(t<r[n].distance);n++);return r.splice(n,0,{distance:t,object:e}),this.add(e),this}},{key:"getCurrentLevel",value:function(){return this._currentLevel}},{key:"getObjectForDistance",value:function(e){var t=this.levels;if(t.length>0){var n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null}},{key:"raycast",value:function(e,t){if(this.levels.length>0){Lu.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Lu);this.getObjectForDistance(n).raycast(e,t)}}},{key:"update",value:function(e){var t=this.levels;if(t.length>1){Lu.setFromMatrixPosition(e.matrixWorld),zu.setFromMatrixPosition(this.matrixWorld);var n,r,i=Lu.distanceTo(zu)/e.zoom;for(t[0].object.visible=!0,n=1,r=t.length;n<r&&i>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}}},{key:"toJSON",value:function(e){var t=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var r=this.levels,i=0,a=r.length;i<a;i++){var o=r[i];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}]),n}(Gi),Yu=new yr,Tu=new Ar,Ku=new Ar,Du=new yr,Pu=new $r,Uu=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i;return(0,C.Z)(this,n),(i=t.call(this,e,r)).type="SkinnedMesh",i.bindMode="attached",i.bindMatrix=new $r,i.bindMatrixInverse=new $r,i}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}},{key:"bind",value:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}},{key:"pose",value:function(){this.skeleton.pose()}},{key:"normalizeSkinWeights",value:function(){for(var e=new Ar,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}},{key:"updateMatrixWorld",value:function(e){(0,l.Z)((0,c.Z)(n.prototype),"updateMatrixWorld",this).call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}},{key:"boneTransform",value:function(e,t){var n=this.skeleton,r=this.geometry;Tu.fromBufferAttribute(r.attributes.skinIndex,e),Ku.fromBufferAttribute(r.attributes.skinWeight,e),Yu.fromBufferAttribute(r.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var i=0;i<4;i++){var a=Ku.getComponent(i);if(0!==a){var o=Tu.getComponent(i);Pu.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),t.addScaledVector(Du.copy(Yu).applyMatrix4(Pu),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}]),n}(Xa);Uu.prototype.isSkinnedMesh=!0;var Ou=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e;return(0,C.Z)(this,n),(e=t.call(this)).type="Bone",e}return(0,h.Z)(n)}(Gi);Ou.prototype.isBone=!0;var Ju=new $r,Qu=new $r,ju=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(0,C.Z)(this,e),this.uuid=rr(),this.bones=t.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}return(0,h.Z)(e,[{key:"init",value:function(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new $r)}}},{key:"calculateInverses",value:function(){this.boneInverses.length=0;for(var e=0,t=this.bones.length;e<t;e++){var n=new $r;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}},{key:"pose",value:function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,i=this.bones.length;r<i;r++){var a=this.bones[r];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}}},{key:"update",value:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:Qu;Ju.multiplyMatrices(o,t[i]),Ju.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}},{key:"clone",value:function(){return new e(this.bones,this.boneInverses)}},{key:"getBoneByName",value:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}},{key:"dispose",value:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}},{key:"fromJSON",value:function(e,t){this.uuid=e.uuid;for(var n=0,r=e.bones.length;n<r;n++){var i=e.bones[n],a=t[i];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),a=new Ou),this.bones.push(a),this.boneInverses.push((new $r).fromArray(e.boneInverses[n]))}return this.init(),this}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;for(var t=this.bones,n=this.boneInverses,r=0,i=t.length;r<i;r++){var a=t[r];e.bones.push(a.uuid);var o=n[r];e.boneInverses.push(o.toArray())}return e}}]),e}(),qu=new $r,$u=new $r,el=[],tl=new Xa,nl=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){var a;return(0,C.Z)(this,n),(a=t.call(this,e,r)).instanceMatrix=new qi(new Float32Array(16*i),16),a.instanceColor=null,a.count=i,a.frustumCulled=!1,a}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}},{key:"getColorAt",value:function(e,t){t.fromArray(this.instanceColor.array,3*e)}},{key:"getMatrixAt",value:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)}},{key:"raycast",value:function(e,t){var n=this.matrixWorld,r=this.count;if(tl.geometry=this.geometry,tl.material=this.material,void 0!==tl.material)for(var i=0;i<r;i++){this.getMatrixAt(i,qu),$u.multiplyMatrices(n,qu),tl.matrixWorld=$u,tl.raycast(e,el);for(var a=0,o=el.length;a<o;a++){var s=el[a];s.instanceId=i,s.object=this,t.push(s)}el.length=0}}},{key:"setColorAt",value:function(e,t){null===this.instanceColor&&(this.instanceColor=new qi(new Float32Array(3*this.count),3)),t.toArray(this.instanceColor.array,3*e)}},{key:"setMatrixAt",value:function(e,t){t.toArray(this.instanceMatrix.array,16*e)}},{key:"updateMorphTargets",value:function(){}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(Xa);nl.prototype.isInstancedMesh=!0;var rl=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="LineBasicMaterial",r.color=new Oi(16777215),r.linewidth=1,r.linecap="round",r.linejoin="round",r.morphTargets=!1,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this}}]),n}(Ni);rl.prototype.isLineBasicMaterial=!0;var il=new yr,al=new yr,ol=new $r,sl=new qr,ul=new Kr,ll=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ma,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new rl;return(0,C.Z)(this,n),(e=t.call(this)).type="Line",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.material=e.material,this.geometry=e.geometry,this}},{key:"computeLineDistances",value:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)il.fromBufferAttribute(t,r-1),al.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=il.distanceTo(al);e.setAttribute("lineDistance",new sa(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),ul.copy(n.boundingSphere),ul.applyMatrix4(r),ul.radius+=i,!1!==e.ray.intersectsSphere(ul)){ol.copy(r).invert(),sl.copy(e.ray).applyMatrix4(ol);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,u=new yr,l=new yr,c=new yr,g=new yr,d=this.isLineSegments?2:1;if(n.isBufferGeometry){var I=n.index,C=n.attributes.position;if(null!==I)for(var h=Math.max(0,a.start),f=Math.min(I.count,a.start+a.count)-1;h<f;h+=d){var p=I.getX(h),A=I.getX(h+1);if(u.fromBufferAttribute(C,p),l.fromBufferAttribute(C,A),!(sl.distanceSqToSegment(u,l,g,c)>s)){g.applyMatrix4(this.matrixWorld);var m=e.ray.origin.distanceTo(g);m<e.near||m>e.far||t.push({distance:m,point:c.clone().applyMatrix4(this.matrixWorld),index:h,face:null,faceIndex:null,object:this})}}else for(var v=Math.max(0,a.start),b=Math.min(C.count,a.start+a.count)-1;v<b;v+=d){if(u.fromBufferAttribute(C,v),l.fromBufferAttribute(C,v+1),!(sl.distanceSqToSegment(u,l,g,c)>s)){g.applyMatrix4(this.matrixWorld);var y=e.ray.origin.distanceTo(g);y<e.near||y>e.far||t.push({distance:y,point:c.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}},{key:"updateMorphTargets",value:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}]),n}(Gi);ll.prototype.isLine=!0;var cl=new yr,gl=new yr,dl=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i;return(0,C.Z)(this,n),(i=t.call(this,e,r)).type="LineSegments",i}return(0,h.Z)(n,[{key:"computeLineDistances",value:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)cl.fromBufferAttribute(t,r),gl.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+cl.distanceTo(gl);e.setAttribute("lineDistance",new sa(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}]),n}(ll);dl.prototype.isLineSegments=!0;var Il=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i;return(0,C.Z)(this,n),(i=t.call(this,e,r)).type="LineLoop",i}return(0,h.Z)(n)}(ll);Il.prototype.isLineLoop=!0;var Cl=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="PointsMaterial",r.color=new Oi(16777215),r.map=null,r.alphaMap=null,r.size=1,r.sizeAttenuation=!0,r.morphTargets=!1,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this}}]),n}(Ni);Cl.prototype.isPointsMaterial=!0;var hl=new $r,fl=new qr,pl=new Kr,Al=new yr,ml=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ma,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Cl;return(0,C.Z)(this,n),(e=t.call(this)).type="Points",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.material=e.material,this.geometry=e.geometry,this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),pl.copy(n.boundingSphere),pl.applyMatrix4(r),pl.radius+=i,!1!==e.ray.intersectsSphere(pl)){hl.copy(r).invert(),fl.copy(e.ray).applyMatrix4(hl);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o;if(n.isBufferGeometry){var u=n.index,l=n.attributes.position;if(null!==u)for(var c=Math.max(0,a.start),g=Math.min(u.count,a.start+a.count);c<g;c++){var d=u.getX(c);Al.fromBufferAttribute(l,d),vl(Al,d,s,r,e,t,this)}else for(var I=Math.max(0,a.start),C=Math.min(l.count,a.start+a.count);I<C;I++)Al.fromBufferAttribute(l,I),vl(Al,I,s,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}},{key:"updateMorphTargets",value:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}]),n}(Gi);function vl(e,t,n,r,i,a,o){var s=fl.distanceSqToPoint(e);if(s<n){var u=new yr;fl.closestPointToPoint(e,u),u.applyMatrix4(r);var l=i.ray.origin.distanceTo(u);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(s),point:u,index:t,face:null,object:o})}}ml.prototype.isPoints=!0;var bl=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i,a,o,s,u,l,c){var d;(0,C.Z)(this,n),(d=t.call(this,e,r,i,a,o,s,u,l,c)).format=void 0!==u?u:qe,d.minFilter=void 0!==s?s:Ve,d.magFilter=void 0!==o?o:Ve,d.generateMipmaps=!1;var I=(0,g.Z)(d);return"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){I.needsUpdate=!0,e.requestVideoFrameCallback(t)})),d}return(0,h.Z)(n,[{key:"clone",value:function(){return new this.constructor(this.image).copy(this)}},{key:"update",value:function(){var e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}]),n}(fr);bl.prototype.isVideoTexture=!0;var yl=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i,a,o,s,u,l,c,g,d,I){var h;return(0,C.Z)(this,n),(h=t.call(this,null,s,u,l,c,g,a,o,d,I)).image={width:r,height:i},h.mipmaps=e,h.flipY=!1,h.generateMipmaps=!1,h}return(0,h.Z)(n)}(fr);yl.prototype.isCompressedTexture=!0;var Bl=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i,a,o,s,u,l,c){var g;return(0,C.Z)(this,n),(g=t.call(this,e,r,i,a,o,s,u,l,c)).needsUpdate=!0,g}return(0,h.Z)(n)}(fr);Bl.prototype.isCanvasTexture=!0;var Gl=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i,a,o,s,u,l,c,g){var d;if((0,C.Z)(this,n),(g=void 0!==g?g:rt)!==rt&&g!==it)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===i&&g===rt&&(i=Ye),void 0===i&&g===it&&(i=Qe),(d=t.call(this,null,a,o,s,u,l,g,i,c)).image={width:e,height:r},d.magFilter=void 0!==u?u:Se,d.minFilter=void 0!==l?l:Se,d.flipY=!1,d.generateMipmaps=!1,d}return(0,h.Z)(n)}(fr);Gl.prototype.isDepthTexture=!0;var Zl=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;(0,C.Z)(this,n),(e=t.call(this)).type="CircleGeometry",e.parameters={radius:r,segments:i,thetaStart:a,thetaLength:o},i=Math.max(3,i);var s=[],u=[],l=[],c=[],g=new yr,d=new gr;u.push(0,0,0),l.push(0,0,1),c.push(.5,.5);for(var I=0,h=3;I<=i;I++,h+=3){var f=a+I/i*o;g.x=r*Math.cos(f),g.y=r*Math.sin(f),u.push(g.x,g.y,g.z),l.push(0,0,1),d.x=(u[h]/r+1)/2,d.y=(u[h+1]/r+1)/2,c.push(d.x,d.y)}for(var p=1;p<=i;p++)s.push(p,p+1,0);return e.setIndex(s),e.setAttribute("position",new sa(u,3)),e.setAttribute("normal",new sa(l,3)),e.setAttribute("uv",new sa(c,2)),e}return(0,h.Z)(n)}(ma),wl=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;(0,C.Z)(this,n),(e=t.call(this)).type="CylinderGeometry",e.parameters={radiusTop:r,radiusBottom:i,height:a,radialSegments:o,heightSegments:s,openEnded:u,thetaStart:l,thetaLength:c};var d=(0,g.Z)(e);o=Math.floor(o),s=Math.floor(s);var I=[],h=[],f=[],p=[],A=0,m=[],v=a/2,b=0;function y(){for(var e=new yr,t=new yr,n=0,u=(i-r)/a,g=0;g<=s;g++){for(var C=[],y=g/s,B=y*(i-r)+r,G=0;G<=o;G++){var Z=G/o,w=Z*c+l,_=Math.sin(w),x=Math.cos(w);t.x=B*_,t.y=-y*a+v,t.z=B*x,h.push(t.x,t.y,t.z),e.set(_,u,x).normalize(),f.push(e.x,e.y,e.z),p.push(Z,1-y),C.push(A++)}m.push(C)}for(var S=0;S<o;S++)for(var R=0;R<s;R++){var M=m[R][S],W=m[R+1][S],k=m[R+1][S+1],V=m[R][S+1];I.push(M,W,V),I.push(W,k,V),n+=6}d.addGroup(b,n,0),b+=n}function B(e){for(var t=A,n=new gr,a=new yr,s=0,u=!0===e?r:i,g=!0===e?1:-1,C=1;C<=o;C++)h.push(0,v*g,0),f.push(0,g,0),p.push(.5,.5),A++;for(var m=A,y=0;y<=o;y++){var B=y/o*c+l,G=Math.cos(B),Z=Math.sin(B);a.x=u*Z,a.y=v*g,a.z=u*G,h.push(a.x,a.y,a.z),f.push(0,g,0),n.x=.5*G+.5,n.y=.5*Z*g+.5,p.push(n.x,n.y),A++}for(var w=0;w<o;w++){var _=t+w,x=m+w;!0===e?I.push(x,x+1,_):I.push(x+1,x,_),s+=3}d.addGroup(b,s,!0===e?1:2),b+=s}return y(),!1===u&&(r>0&&B(!0),i>0&&B(!1)),e.setIndex(I),e.setAttribute("position",new sa(h,3)),e.setAttribute("normal",new sa(f,3)),e.setAttribute("uv",new sa(p,2)),e}return(0,h.Z)(n)}(ma),_l=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;return(0,C.Z)(this,n),(e=t.call(this,0,r,i,a,o,s,u,l)).type="ConeGeometry",e.parameters={radius:r,height:i,radialSegments:a,heightSegments:o,openEnded:s,thetaStart:u,thetaLength:l},e}return(0,h.Z)(n)}(wl),xl=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,C.Z)(this,n),(i=t.call(this)).type="PolyhedronGeometry",i.parameters={vertices:e,indices:r,radius:a,detail:o};var s=[],u=[];function l(e){for(var t=new yr,n=new yr,i=new yr,a=0;a<r.length;a+=3)f(r[a+0],t),f(r[a+1],n),f(r[a+2],i),c(t,n,i,e)}function c(e,t,n,r){for(var i=r+1,a=[],o=0;o<=i;o++){a[o]=[];for(var s=e.clone().lerp(n,o/i),u=t.clone().lerp(n,o/i),l=i-o,c=0;c<=l;c++)a[o][c]=0===c&&o===i?s:s.clone().lerp(u,c/l)}for(var g=0;g<i;g++)for(var d=0;d<2*(i-g)-1;d++){var I=Math.floor(d/2);d%2===0?(h(a[g][I+1]),h(a[g+1][I]),h(a[g][I])):(h(a[g][I+1]),h(a[g+1][I+1]),h(a[g+1][I]))}}function g(e){for(var t=new yr,n=0;n<s.length;n+=3)t.x=s[n+0],t.y=s[n+1],t.z=s[n+2],t.normalize().multiplyScalar(e),s[n+0]=t.x,s[n+1]=t.y,s[n+2]=t.z}function d(){for(var e=new yr,t=0;t<s.length;t+=3){e.x=s[t+0],e.y=s[t+1],e.z=s[t+2];var n=m(e)/2/Math.PI+.5,r=v(e)/Math.PI+.5;u.push(n,1-r)}p(),I()}function I(){for(var e=0;e<u.length;e+=6){var t=u[e+0],n=u[e+2],r=u[e+4],i=Math.max(t,n,r),a=Math.min(t,n,r);i>.9&&a<.1&&(t<.2&&(u[e+0]+=1),n<.2&&(u[e+2]+=1),r<.2&&(u[e+4]+=1))}}function h(e){s.push(e.x,e.y,e.z)}function f(t,n){var r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function p(){for(var e=new yr,t=new yr,n=new yr,r=new yr,i=new gr,a=new gr,o=new gr,l=0,c=0;l<s.length;l+=9,c+=6){e.set(s[l+0],s[l+1],s[l+2]),t.set(s[l+3],s[l+4],s[l+5]),n.set(s[l+6],s[l+7],s[l+8]),i.set(u[c+0],u[c+1]),a.set(u[c+2],u[c+3]),o.set(u[c+4],u[c+5]),r.copy(e).add(t).add(n).divideScalar(3);var g=m(r);A(i,c+0,e,g),A(a,c+2,t,g),A(o,c+4,n,g)}}function A(e,t,n,r){r<0&&1===e.x&&(u[t]=e.x-1),0===n.x&&0===n.z&&(u[t]=r/2/Math.PI+.5)}function m(e){return Math.atan2(e.z,-e.x)}function v(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}return l(o),g(a),d(),i.setAttribute("position",new sa(s,3)),i.setAttribute("normal",new sa(s.slice(),3)),i.setAttribute("uv",new sa(u,2)),0===o?i.computeVertexNormals():i.normalizeNormals(),i}return(0,h.Z)(n)}(ma),Sl=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.Z)(this,n);var a=(1+Math.sqrt(5))/2,o=1/a,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-a,0,-o,a,0,o,-a,0,o,a,-o,-a,0,-o,a,0,o,-a,0,o,a,0,-a,0,-o,a,0,-o,-a,0,o,a,0,o],u=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];return(e=t.call(this,s,u,r,i)).type="DodecahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,h.Z)(n)}(xl),Rl=new yr,Ml=new yr,Wl=new yr,kl=new Li,Vl=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i;if((0,C.Z)(this,n),(i=t.call(this)).type="EdgesGeometry",i.parameters={thresholdAngle:r},r=void 0!==r?r:1,!0===e.isGeometry)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),(0,u.Z)(i);for(var a=Math.pow(10,4),o=Math.cos(tr*r),s=e.getIndex(),l=e.getAttribute("position"),c=s?s.count:l.count,g=[0,0,0],d=["a","b","c"],I=new Array(3),h={},f=[],p=0;p<c;p+=3){s?(g[0]=s.getX(p),g[1]=s.getX(p+1),g[2]=s.getX(p+2)):(g[0]=p,g[1]=p+1,g[2]=p+2);var A=kl.a,m=kl.b,v=kl.c;if(A.fromBufferAttribute(l,g[0]),m.fromBufferAttribute(l,g[1]),v.fromBufferAttribute(l,g[2]),kl.getNormal(Wl),I[0]="".concat(Math.round(A.x*a),",").concat(Math.round(A.y*a),",").concat(Math.round(A.z*a)),I[1]="".concat(Math.round(m.x*a),",").concat(Math.round(m.y*a),",").concat(Math.round(m.z*a)),I[2]="".concat(Math.round(v.x*a),",").concat(Math.round(v.y*a),",").concat(Math.round(v.z*a)),I[0]!==I[1]&&I[1]!==I[2]&&I[2]!==I[0])for(var b=0;b<3;b++){var y=(b+1)%3,B=I[b],G=I[y],Z=kl[d[b]],w=kl[d[y]],_="".concat(B,"_").concat(G),x="".concat(G,"_").concat(B);x in h&&h[x]?(Wl.dot(h[x].normal)<=o&&(f.push(Z.x,Z.y,Z.z),f.push(w.x,w.y,w.z)),h[x]=null):_ in h||(h[_]={index0:g[b],index1:g[y],normal:Wl.clone()})}}for(var S in h)if(h[S]){var R=h[S],M=R.index0,W=R.index1;Rl.fromBufferAttribute(l,M),Ml.fromBufferAttribute(l,W),f.push(Rl.x,Rl.y,Rl.z),f.push(Ml.x,Ml.y,Ml.z)}return i.setAttribute("position",new sa(f,3)),i}return(0,h.Z)(n)}(ma),Fl=function(e,t,n){n=n||2;var r,i,a,o,s,u,l,c=t&&t.length,g=c?t[0]*n:e.length,d=El(e,0,g,n,!0),I=[];if(!d||d.next===d.prev)return I;if(c&&(d=function(e,t,n,r){var i,a,o,s=[];for(i=0,a=t.length;i<a;i++)(o=El(e,t[i]*r,i<a-1?t[i+1]*r:e.length,r,!1))===o.next&&(o.steiner=!0),s.push(Ul(o));for(s.sort(Tl),i=0;i<s.length;i++)Kl(s[i],n),n=Xl(n,n.next);return n}(e,t,d,n)),e.length>80*n){r=a=e[0],i=o=e[1];for(var C=n;C<g;C+=n)(s=e[C])<r&&(r=s),(u=e[C+1])<i&&(i=u),s>a&&(a=s),u>o&&(o=u);l=0!==(l=Math.max(a-r,o-i))?1/l:0}return Hl(d,I,n,r,i,l),I};function El(e,t,n,r,i){var a,o;if(i===function(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r)>0)for(a=t;a<n;a+=r)o=rc(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=rc(a,e[a],e[a+1],o);return o&&jl(o,o.next)&&(ic(o),o=o.next),o}function Xl(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!jl(r,r.next)&&0!==Ql(r.prev,r,r.next))r=r.next;else{if(ic(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function Hl(e,t,n,r,i,a,o){if(e){!o&&a&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=Pl(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,a,o,s,u,l=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<l&&(s++,r=r.nextZ);t++);for(u=l;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,l*=2}while(o>1)}(i)}(e,r,i,a);for(var s,u,l=e;e.prev!==e.next;)if(s=e.prev,u=e.next,a?zl(e,r,i,a):Ll(e))t.push(s.i/n),t.push(e.i/n),t.push(u.i/n),ic(e),e=u.next,l=u.next;else if((e=u)===l){o?1===o?Hl(e=Nl(Xl(e),t,n),t,n,r,i,a,2):2===o&&Yl(e,t,n,r,i,a):Hl(Xl(e),t,n,r,i,a,1);break}}}function Ll(e){var t=e.prev,n=e,r=e.next;if(Ql(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(Ol(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Ql(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function zl(e,t,n,r){var i=e.prev,a=e,o=e.next;if(Ql(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,u=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,g=Pl(s,u,t,n,r),d=Pl(l,c,t,n,r),I=e.prevZ,C=e.nextZ;I&&I.z>=g&&C&&C.z<=d;){if(I!==e.prev&&I!==e.next&&Ol(i.x,i.y,a.x,a.y,o.x,o.y,I.x,I.y)&&Ql(I.prev,I,I.next)>=0)return!1;if(I=I.prevZ,C!==e.prev&&C!==e.next&&Ol(i.x,i.y,a.x,a.y,o.x,o.y,C.x,C.y)&&Ql(C.prev,C,C.next)>=0)return!1;C=C.nextZ}for(;I&&I.z>=g;){if(I!==e.prev&&I!==e.next&&Ol(i.x,i.y,a.x,a.y,o.x,o.y,I.x,I.y)&&Ql(I.prev,I,I.next)>=0)return!1;I=I.prevZ}for(;C&&C.z<=d;){if(C!==e.prev&&C!==e.next&&Ol(i.x,i.y,a.x,a.y,o.x,o.y,C.x,C.y)&&Ql(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function Nl(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!jl(i,a)&&ql(i,r,r.next,a)&&tc(i,a)&&tc(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),ic(r),ic(r.next),r=e=a),r=r.next}while(r!==e);return Xl(r)}function Yl(e,t,n,r,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Jl(o,s)){var u=nc(o,s);return o=Xl(o,o.next),u=Xl(u,u.next),Hl(o,t,n,r,i,a),void Hl(u,t,n,r,i,a)}s=s.next}o=o.next}while(o!==e)}function Tl(e,t){return e.x-t.x}function Kl(e,t){if(t=function(e,t){var n,r=t,i=e.x,a=e.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o){if(o=s,s===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===o)return n;var u,l=n,c=n.x,g=n.y,d=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&Ol(a<g?i:o,a,c,g,a<g?o:i,a,r.x,r.y)&&(u=Math.abs(a-r.y)/(i-r.x),tc(r,e)&&(u<d||u===d&&(r.x>n.x||r.x===n.x&&Dl(n,r)))&&(n=r,d=u)),r=r.next}while(r!==l);return n}(e,t),t){var n=nc(t,e);Xl(t,t.next),Xl(n,n.next)}}function Dl(e,t){return Ql(e.prev,e,t.prev)<0&&Ql(t.next,e,e.next)<0}function Pl(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ul(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Ol(e,t,n,r,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(r-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function Jl(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&ql(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(tc(e,t)&&tc(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!==n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Ql(e.prev,e,t.prev)||Ql(e,t.prev,t))||jl(e,t)&&Ql(e.prev,e,e.next)>0&&Ql(t.prev,t,t.next)>0)}function Ql(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function jl(e,t){return e.x===t.x&&e.y===t.y}function ql(e,t,n,r){var i=ec(Ql(e,t,n)),a=ec(Ql(e,t,r)),o=ec(Ql(n,r,e)),s=ec(Ql(n,r,t));return i!==a&&o!==s||(!(0!==i||!$l(e,n,t))||(!(0!==a||!$l(e,r,t))||(!(0!==o||!$l(n,e,r))||!(0!==s||!$l(n,t,r)))))}function $l(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function ec(e){return e>0?1:e<0?-1:0}function tc(e,t){return Ql(e.prev,e,e.next)<0?Ql(e,t,e.next)>=0&&Ql(e,e.prev,t)>=0:Ql(e,t,e.prev)<0||Ql(e,e.next,t)<0}function nc(e,t){var n=new ac(e.i,e.x,e.y),r=new ac(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function rc(e,t,n,r){var i=new ac(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function ic(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ac(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var oc=function(){function e(){(0,C.Z)(this,e)}return(0,h.Z)(e,null,[{key:"area",value:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n}},{key:"isClockWise",value:function(t){return e.area(t)<0}},{key:"triangulateShape",value:function(e,t){var n=[],r=[],i=[];sc(e),uc(n,e);var a=e.length;t.forEach(sc);for(var o=0;o<t.length;o++)r.push(a),a+=t[o].length,uc(n,t[o]);for(var s=Fl(n,r),u=0;u<s.length;u+=3)i.push(s.slice(u,u+3));return i}}]),e}();function sc(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function uc(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var lc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i;(0,C.Z)(this,n),(i=t.call(this)).type="ExtrudeGeometry",i.parameters={shapes:e,options:r},e=Array.isArray(e)?e:[e];for(var a=(0,g.Z)(i),o=[],s=[],u=0,l=e.length;u<l;u++){c(e[u])}function c(e){var t=[],n=void 0!==r.curveSegments?r.curveSegments:12,i=void 0!==r.steps?r.steps:1,u=void 0!==r.depth?r.depth:100,l=void 0===r.bevelEnabled||r.bevelEnabled,c=void 0!==r.bevelThickness?r.bevelThickness:6,g=void 0!==r.bevelSize?r.bevelSize:c-2,d=void 0!==r.bevelOffset?r.bevelOffset:0,I=void 0!==r.bevelSegments?r.bevelSegments:3,C=r.extrudePath,h=void 0!==r.UVGenerator?r.UVGenerator:cc;void 0!==r.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=r.amount);var f,p,A,m,v,b=!1;C&&(f=C.getSpacedPoints(i),b=!0,l=!1,p=C.computeFrenetFrames(i,!1),A=new yr,m=new yr,v=new yr),l||(I=0,c=0,g=0,d=0);var y=e.extractPoints(n),B=y.shape,G=y.holes;if(!oc.isClockWise(B)){B=B.reverse();for(var Z=0,w=G.length;Z<w;Z++){var _=G[Z];oc.isClockWise(_)&&(G[Z]=_.reverse())}}for(var x=oc.triangulateShape(B,G),S=B,R=0,M=G.length;R<M;R++){var W=G[R];B=B.concat(W)}function k(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var V=B.length,F=x.length;function E(e,t,n){var r,i,a,o=e.x-t.x,s=e.y-t.y,u=n.x-e.x,l=n.y-e.y,c=o*o+s*s,g=o*l-s*u;if(Math.abs(g)>Number.EPSILON){var d=Math.sqrt(c),I=Math.sqrt(u*u+l*l),C=t.x-s/d,h=t.y+o/d,f=((n.x-l/I-C)*l-(n.y+u/I-h)*u)/(o*l-s*u),p=(r=C+o*f-e.x)*r+(i=h+s*f-e.y)*i;if(p<=2)return new gr(r,i);a=Math.sqrt(p/2)}else{var A=!1;o>Number.EPSILON?u>Number.EPSILON&&(A=!0):o<-Number.EPSILON?u<-Number.EPSILON&&(A=!0):Math.sign(s)===Math.sign(l)&&(A=!0),A?(r=-s,i=o,a=Math.sqrt(c)):(r=o,i=s,a=Math.sqrt(c/2))}return new gr(r/a,i/a)}for(var X=[],H=0,L=S.length,z=L-1,N=H+1;H<L;H++,z++,N++)z===L&&(z=0),N===L&&(N=0),X[H]=E(S[H],S[z],S[N]);for(var Y,T=[],K=X.concat(),D=0,P=G.length;D<P;D++){var U=G[D];Y=[];for(var O=0,J=U.length,Q=J-1,j=O+1;O<J;O++,Q++,j++)Q===J&&(Q=0),j===J&&(j=0),Y[O]=E(U[O],U[Q],U[j]);T.push(Y),K=K.concat(Y)}for(var q=0;q<I;q++){for(var $=q/I,ee=c*Math.cos($*Math.PI/2),te=g*Math.sin($*Math.PI/2)+d,ne=0,re=S.length;ne<re;ne++){var ie=k(S[ne],X[ne],te);Me(ie.x,ie.y,-ee)}for(var ae=0,oe=G.length;ae<oe;ae++){var se=G[ae];Y=T[ae];for(var ue=0,le=se.length;ue<le;ue++){var ce=k(se[ue],Y[ue],te);Me(ce.x,ce.y,-ee)}}}for(var ge=g+d,de=0;de<V;de++){var Ie=l?k(B[de],K[de],ge):B[de];b?(m.copy(p.normals[0]).multiplyScalar(Ie.x),A.copy(p.binormals[0]).multiplyScalar(Ie.y),v.copy(f[0]).add(m).add(A),Me(v.x,v.y,v.z)):Me(Ie.x,Ie.y,0)}for(var Ce=1;Ce<=i;Ce++)for(var he=0;he<V;he++){var fe=l?k(B[he],K[he],ge):B[he];b?(m.copy(p.normals[Ce]).multiplyScalar(fe.x),A.copy(p.binormals[Ce]).multiplyScalar(fe.y),v.copy(f[Ce]).add(m).add(A),Me(v.x,v.y,v.z)):Me(fe.x,fe.y,u/i*Ce)}for(var pe=I-1;pe>=0;pe--){for(var Ae=pe/I,me=c*Math.cos(Ae*Math.PI/2),ve=g*Math.sin(Ae*Math.PI/2)+d,be=0,ye=S.length;be<ye;be++){var Be=k(S[be],X[be],ve);Me(Be.x,Be.y,u+me)}for(var Ge=0,Ze=G.length;Ge<Ze;Ge++){var we=G[Ge];Y=T[Ge];for(var _e=0,xe=we.length;_e<xe;_e++){var Se=k(we[_e],Y[_e],ve);b?Me(Se.x,Se.y+f[i-1].y,f[i-1].x+me):Me(Se.x,Se.y,u+me)}}}function Re(e,t){for(var n=e.length;--n>=0;){var r=n,a=n-1;a<0&&(a=e.length-1);for(var o=0,s=i+2*I;o<s;o++){var u=V*o,l=V*(o+1);ke(t+r+u,t+a+u,t+a+l,t+r+l)}}}function Me(e,n,r){t.push(e),t.push(n),t.push(r)}function We(e,t,n){Ve(e),Ve(t),Ve(n);var r=o.length/3,i=h.generateTopUV(a,o,r-3,r-2,r-1);Fe(i[0]),Fe(i[1]),Fe(i[2])}function ke(e,t,n,r){Ve(e),Ve(t),Ve(r),Ve(t),Ve(n),Ve(r);var i=o.length/3,s=h.generateSideWallUV(a,o,i-6,i-3,i-2,i-1);Fe(s[0]),Fe(s[1]),Fe(s[3]),Fe(s[1]),Fe(s[2]),Fe(s[3])}function Ve(e){o.push(t[3*e+0]),o.push(t[3*e+1]),o.push(t[3*e+2])}function Fe(e){s.push(e.x),s.push(e.y)}!function(){var e=o.length/3;if(l){for(var t=0,n=V*t,r=0;r<F;r++){var s=x[r];We(s[2]+n,s[1]+n,s[0]+n)}n=V*(t=i+2*I);for(var u=0;u<F;u++){var c=x[u];We(c[0]+n,c[1]+n,c[2]+n)}}else{for(var g=0;g<F;g++){var d=x[g];We(d[2],d[1],d[0])}for(var C=0;C<F;C++){var h=x[C];We(h[0]+V*i,h[1]+V*i,h[2]+V*i)}}a.addGroup(e,o.length/3-e,0)}(),function(){var e=o.length/3,t=0;Re(S,t),t+=S.length;for(var n=0,r=G.length;n<r;n++){var i=G[n];Re(i,t),t+=i.length}a.addGroup(e,o.length/3-e,1)}()}return i.setAttribute("position",new sa(o,3)),i.setAttribute("uv",new sa(s,2)),i.computeVertexNormals(),i}return(0,h.Z)(n,[{key:"toJSON",value:function(){var e=ma.prototype.toJSON.call(this);return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}}]),n}(ma),cc={generateTopUV:function(e,t,n,r,i){var a=t[3*n],o=t[3*n+1],s=t[3*r],u=t[3*r+1],l=t[3*i],c=t[3*i+1];return[new gr(a,o),new gr(s,u),new gr(l,c)]},generateSideWallUV:function(e,t,n,r,i,a){var o=t[3*n],s=t[3*n+1],u=t[3*n+2],l=t[3*r],c=t[3*r+1],g=t[3*r+2],d=t[3*i],I=t[3*i+1],C=t[3*i+2],h=t[3*a],f=t[3*a+1],p=t[3*a+2];return Math.abs(s-c)<.01?[new gr(o,1-u),new gr(l,1-g),new gr(d,1-C),new gr(h,1-p)]:[new gr(s,1-u),new gr(c,1-g),new gr(I,1-C),new gr(f,1-p)]}};var gc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.Z)(this,n);var a=(1+Math.sqrt(5))/2,o=[-1,a,0,1,a,0,-1,-a,0,1,-a,0,0,-1,a,0,1,a,0,-1,-a,0,1,-a,a,0,-1,a,0,1,-a,0,-1,-a,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];return(e=t.call(this,o,s,r,i)).type="IcosahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,h.Z)(n)}(xl),dc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;(0,C.Z)(this,n),(r=t.call(this)).type="LatheGeometry",r.parameters={points:e,segments:i,phiStart:a,phiLength:o},i=Math.floor(i),o=ir(o,0,2*Math.PI);for(var s=[],u=[],l=[],c=1/i,g=new yr,d=new gr,I=0;I<=i;I++)for(var h=a+I*c*o,f=Math.sin(h),p=Math.cos(h),A=0;A<=e.length-1;A++)g.x=e[A].x*f,g.y=e[A].y,g.z=e[A].x*p,u.push(g.x,g.y,g.z),d.x=I/i,d.y=A/(e.length-1),l.push(d.x,d.y);for(var m=0;m<i;m++)for(var v=0;v<e.length-1;v++){var b=v+m*e.length,y=b,B=b+e.length,G=b+e.length+1,Z=b+1;s.push(y,B,Z),s.push(B,G,Z)}if(r.setIndex(s),r.setAttribute("position",new sa(u,3)),r.setAttribute("uv",new sa(l,2)),r.computeVertexNormals(),o===2*Math.PI)for(var w=r.attributes.normal.array,_=new yr,x=new yr,S=new yr,R=i*e.length*3,M=0,W=0;M<e.length;M++,W+=3)_.x=w[W+0],_.y=w[W+1],_.z=w[W+2],x.x=w[R+W+0],x.y=w[R+W+1],x.z=w[R+W+2],S.addVectors(_,x).normalize(),w[W+0]=w[R+W+0]=S.x,w[W+1]=w[R+W+1]=S.y,w[W+2]=w[R+W+2]=S.z;return r}return(0,h.Z)(n)}(ma),Ic=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.Z)(this,n);var a=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],o=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];return(e=t.call(this,a,o,r,i)).type="OctahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,h.Z)(n)}(xl),Cc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){var a;(0,C.Z)(this,n),(a=t.call(this)).type="ParametricGeometry",a.parameters={func:e,slices:r,stacks:i};var o=[],s=[],u=[],l=[],c=1e-5,g=new yr,d=new yr,I=new yr,h=new yr,f=new yr;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var p=r+1,A=0;A<=i;A++)for(var m=A/i,v=0;v<=r;v++){var b=v/r;e(b,m,d),s.push(d.x,d.y,d.z),b-c>=0?(e(b-c,m,I),h.subVectors(d,I)):(e(b+c,m,I),h.subVectors(I,d)),m-c>=0?(e(b,m-c,I),f.subVectors(d,I)):(e(b,m+c,I),f.subVectors(I,d)),g.crossVectors(h,f).normalize(),u.push(g.x,g.y,g.z),l.push(b,m)}for(var y=0;y<i;y++)for(var B=0;B<r;B++){var G=y*p+B,Z=y*p+B+1,w=(y+1)*p+B+1,_=(y+1)*p+B;o.push(G,Z,_),o.push(Z,w,_)}return a.setIndex(o),a.setAttribute("position",new sa(s,3)),a.setAttribute("normal",new sa(u,3)),a.setAttribute("uv",new sa(l,2)),a}return(0,h.Z)(n)}(ma),hc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;(0,C.Z)(this,n),(e=t.call(this)).type="RingGeometry",e.parameters={innerRadius:r,outerRadius:i,thetaSegments:a,phiSegments:o,thetaStart:s,thetaLength:u},a=Math.max(3,a);for(var l=[],c=[],g=[],d=[],I=r,h=(i-r)/(o=Math.max(1,o)),f=new yr,p=new gr,A=0;A<=o;A++){for(var m=0;m<=a;m++){var v=s+m/a*u;f.x=I*Math.cos(v),f.y=I*Math.sin(v),c.push(f.x,f.y,f.z),g.push(0,0,1),p.x=(f.x/i+1)/2,p.y=(f.y/i+1)/2,d.push(p.x,p.y)}I+=h}for(var b=0;b<o;b++)for(var y=b*(a+1),B=0;B<a;B++){var G=B+y,Z=G,w=G+a+1,_=G+a+2,x=G+1;l.push(Z,w,x),l.push(w,_,x)}return e.setIndex(l),e.setAttribute("position",new sa(c,3)),e.setAttribute("normal",new sa(g,3)),e.setAttribute("uv",new sa(d,2)),e}return(0,h.Z)(n)}(ma),fc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;(0,C.Z)(this,n),(r=t.call(this)).type="ShapeGeometry",r.parameters={shapes:e,curveSegments:i};var a=[],o=[],s=[],u=[],l=0,c=0;if(!1===Array.isArray(e))d(e);else for(var g=0;g<e.length;g++)d(e[g]),r.addGroup(l,c,g),l+=c,c=0;function d(e){var t=o.length/3,n=e.extractPoints(i),r=n.shape,l=n.holes;!1===oc.isClockWise(r)&&(r=r.reverse());for(var g=0,d=l.length;g<d;g++){var I=l[g];!0===oc.isClockWise(I)&&(l[g]=I.reverse())}for(var C=oc.triangulateShape(r,l),h=0,f=l.length;h<f;h++){var p=l[h];r=r.concat(p)}for(var A=0,m=r.length;A<m;A++){var v=r[A];o.push(v.x,v.y,0),s.push(0,0,1),u.push(v.x,v.y)}for(var b=0,y=C.length;b<y;b++){var B=C[b],G=B[0]+t,Z=B[1]+t,w=B[2]+t;a.push(G,Z,w),c+=3}}return r.setIndex(a),r.setAttribute("position",new sa(o,3)),r.setAttribute("normal",new sa(s,3)),r.setAttribute("uv",new sa(u,2)),r}return(0,h.Z)(n,[{key:"toJSON",value:function(){var e=ma.prototype.toJSON.call(this);return function(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}}]),n}(ma);var pc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;(0,C.Z)(this,n),(e=t.call(this)).type="SphereGeometry",e.parameters={radius:r,widthSegments:i,heightSegments:a,phiStart:o,phiLength:s,thetaStart:u,thetaLength:l},i=Math.max(3,Math.floor(i)),a=Math.max(2,Math.floor(a));for(var c=Math.min(u+l,Math.PI),g=0,d=[],I=new yr,h=new yr,f=[],p=[],A=[],m=[],v=0;v<=a;v++){var b=[],y=v/a,B=0;0==v&&0==u?B=.5/i:v==a&&c==Math.PI&&(B=-.5/i);for(var G=0;G<=i;G++){var Z=G/i;I.x=-r*Math.cos(o+Z*s)*Math.sin(u+y*l),I.y=r*Math.cos(u+y*l),I.z=r*Math.sin(o+Z*s)*Math.sin(u+y*l),p.push(I.x,I.y,I.z),h.copy(I).normalize(),A.push(h.x,h.y,h.z),m.push(Z+B,1-y),b.push(g++)}d.push(b)}for(var w=0;w<a;w++)for(var _=0;_<i;_++){var x=d[w][_+1],S=d[w][_],R=d[w+1][_],M=d[w+1][_+1];(0!==w||u>0)&&f.push(x,S,M),(w!==a-1||c<Math.PI)&&f.push(S,R,M)}return e.setIndex(f),e.setAttribute("position",new sa(p,3)),e.setAttribute("normal",new sa(A,3)),e.setAttribute("uv",new sa(m,2)),e}return(0,h.Z)(n)}(ma),Ac=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.Z)(this,n);var a=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],o=[2,1,0,0,3,2,1,3,0,2,3,1];return(e=t.call(this,a,o,r,i)).type="TetrahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,h.Z)(n)}(xl),mc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,C.Z)(this,n);var a=i.font;if(!a||!a.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),(0,u.Z)(r,new ma);var o=a.generateShapes(e,i.size);return i.depth=void 0!==i.height?i.height:50,void 0===i.bevelThickness&&(i.bevelThickness=10),void 0===i.bevelSize&&(i.bevelSize=8),void 0===i.bevelEnabled&&(i.bevelEnabled=!1),(r=t.call(this,o,i)).type="TextGeometry",r}return(0,h.Z)(n)}(lc),vc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;(0,C.Z)(this,n),(e=t.call(this)).type="TorusGeometry",e.parameters={radius:r,tube:i,radialSegments:a,tubularSegments:o,arc:s},a=Math.floor(a),o=Math.floor(o);for(var u=[],l=[],c=[],g=[],d=new yr,I=new yr,h=new yr,f=0;f<=a;f++)for(var p=0;p<=o;p++){var A=p/o*s,m=f/a*Math.PI*2;I.x=(r+i*Math.cos(m))*Math.cos(A),I.y=(r+i*Math.cos(m))*Math.sin(A),I.z=i*Math.sin(m),l.push(I.x,I.y,I.z),d.x=r*Math.cos(A),d.y=r*Math.sin(A),h.subVectors(I,d).normalize(),c.push(h.x,h.y,h.z),g.push(p/o),g.push(f/a)}for(var v=1;v<=a;v++)for(var b=1;b<=o;b++){var y=(o+1)*v+b-1,B=(o+1)*(v-1)+b-1,G=(o+1)*(v-1)+b,Z=(o+1)*v+b;u.push(y,B,Z),u.push(B,G,Z)}return e.setIndex(u),e.setAttribute("position",new sa(l,3)),e.setAttribute("normal",new sa(c,3)),e.setAttribute("uv",new sa(g,2)),e}return(0,h.Z)(n)}(ma),bc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;(0,C.Z)(this,n),(e=t.call(this)).type="TorusKnotGeometry",e.parameters={radius:r,tube:i,tubularSegments:a,radialSegments:o,p:s,q:u},a=Math.floor(a),o=Math.floor(o);for(var l=[],c=[],g=[],d=[],I=new yr,h=new yr,f=new yr,p=new yr,A=new yr,m=new yr,v=new yr,b=0;b<=a;++b){var y=b/a*s*Math.PI*2;k(y,s,u,r,f),k(y+.01,s,u,r,p),m.subVectors(p,f),v.addVectors(p,f),A.crossVectors(m,v),v.crossVectors(A,m),A.normalize(),v.normalize();for(var B=0;B<=o;++B){var G=B/o*Math.PI*2,Z=-i*Math.cos(G),w=i*Math.sin(G);I.x=f.x+(Z*v.x+w*A.x),I.y=f.y+(Z*v.y+w*A.y),I.z=f.z+(Z*v.z+w*A.z),c.push(I.x,I.y,I.z),h.subVectors(I,f).normalize(),g.push(h.x,h.y,h.z),d.push(b/a),d.push(B/o)}}for(var _=1;_<=a;_++)for(var x=1;x<=o;x++){var S=(o+1)*(_-1)+(x-1),R=(o+1)*_+(x-1),M=(o+1)*_+x,W=(o+1)*(_-1)+x;l.push(S,R,W),l.push(R,M,W)}function k(e,t,n,r,i){var a=Math.cos(e),o=Math.sin(e),s=n/t*e,u=Math.cos(s);i.x=r*(2+u)*.5*a,i.y=r*(2+u)*o*.5,i.z=r*Math.sin(s)*.5}return e.setIndex(l),e.setAttribute("position",new sa(c,3)),e.setAttribute("normal",new sa(g,3)),e.setAttribute("uv",new sa(d,2)),e}return(0,h.Z)(n)}(ma),yc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,C.Z)(this,n),(r=t.call(this)).type="TubeGeometry",r.parameters={path:e,tubularSegments:i,radius:a,radialSegments:o,closed:s};var u=e.computeFrenetFrames(i,s);r.tangents=u.tangents,r.normals=u.normals,r.binormals=u.binormals;var l=new yr,c=new yr,g=new gr,d=new yr,I=[],h=[],f=[],p=[];function A(){for(var e=0;e<i;e++)m(e);m(!1===s?i:0),b(),v()}function m(t){d=e.getPointAt(t/i,d);for(var n=u.normals[t],r=u.binormals[t],s=0;s<=o;s++){var g=s/o*Math.PI*2,C=Math.sin(g),f=-Math.cos(g);c.x=f*n.x+C*r.x,c.y=f*n.y+C*r.y,c.z=f*n.z+C*r.z,c.normalize(),h.push(c.x,c.y,c.z),l.x=d.x+a*c.x,l.y=d.y+a*c.y,l.z=d.z+a*c.z,I.push(l.x,l.y,l.z)}}function v(){for(var e=1;e<=i;e++)for(var t=1;t<=o;t++){var n=(o+1)*(e-1)+(t-1),r=(o+1)*e+(t-1),a=(o+1)*e+t,s=(o+1)*(e-1)+t;p.push(n,r,s),p.push(r,a,s)}}function b(){for(var e=0;e<=i;e++)for(var t=0;t<=o;t++)g.x=e/i,g.y=t/o,f.push(g.x,g.y)}return A(),r.setIndex(p),r.setAttribute("position",new sa(I,3)),r.setAttribute("normal",new sa(h,3)),r.setAttribute("uv",new sa(f,2)),r}return(0,h.Z)(n,[{key:"toJSON",value:function(){var e=ma.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e}}]),n}(ma),Bc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;if((0,C.Z)(this,n),(r=t.call(this)).type="WireframeGeometry",!0===e.isGeometry)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),(0,u.Z)(r);var i=[],a=[0,0],o={},s=new yr;if(null!==e.index){var l=e.attributes.position,c=e.index,g=e.groups;0===g.length&&(g=[{start:0,count:c.count,materialIndex:0}]);for(var d=0,I=g.length;d<I;++d)for(var h=g[d],f=h.start,p=f,A=f+h.count;p<A;p+=3)for(var m=0;m<3;m++){var v=c.getX(p+m),b=c.getX(p+(m+1)%3);a[0]=Math.min(v,b),a[1]=Math.max(v,b);var y=a[0]+","+a[1];void 0===o[y]&&(o[y]={index1:a[0],index2:a[1]})}for(var B in o){var G=o[B];s.fromBufferAttribute(l,G.index1),i.push(s.x,s.y,s.z),s.fromBufferAttribute(l,G.index2),i.push(s.x,s.y,s.z)}}else for(var Z=e.attributes.position,w=0,_=Z.count/3;w<_;w++)for(var x=0;x<3;x++){var S=3*w+x;s.fromBufferAttribute(Z,S),i.push(s.x,s.y,s.z);var R=3*w+(x+1)%3;s.fromBufferAttribute(Z,R),i.push(s.x,s.y,s.z)}return r.setAttribute("position",new sa(i,3)),r}return(0,h.Z)(n)}(ma),Gc=Object.freeze({__proto__:null,BoxGeometry:La,BoxBufferGeometry:La,CircleGeometry:Zl,CircleBufferGeometry:Zl,ConeGeometry:_l,ConeBufferGeometry:_l,CylinderGeometry:wl,CylinderBufferGeometry:wl,DodecahedronGeometry:Sl,DodecahedronBufferGeometry:Sl,EdgesGeometry:Vl,ExtrudeGeometry:lc,ExtrudeBufferGeometry:lc,IcosahedronGeometry:gc,IcosahedronBufferGeometry:gc,LatheGeometry:dc,LatheBufferGeometry:dc,OctahedronGeometry:Ic,OctahedronBufferGeometry:Ic,ParametricGeometry:Cc,ParametricBufferGeometry:Cc,PlaneGeometry:no,PlaneBufferGeometry:no,PolyhedronGeometry:xl,PolyhedronBufferGeometry:xl,RingGeometry:hc,RingBufferGeometry:hc,ShapeGeometry:fc,ShapeBufferGeometry:fc,SphereGeometry:pc,SphereBufferGeometry:pc,TetrahedronGeometry:Ac,TetrahedronBufferGeometry:Ac,TextGeometry:mc,TextBufferGeometry:mc,TorusGeometry:vc,TorusBufferGeometry:vc,TorusKnotGeometry:bc,TorusKnotBufferGeometry:bc,TubeGeometry:yc,TubeBufferGeometry:yc,WireframeGeometry:Bc}),Zc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="ShadowMaterial",r.color=new Oi(0),r.transparent=!0,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this}}]),n}(Ni);Zc.prototype.isShadowMaterial=!0;var wc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this,e)).type="RawShaderMaterial",r}return(0,h.Z)(n)}(Ta);wc.prototype.isRawShaderMaterial=!0;var _c=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).defines={STANDARD:""},r.type="MeshStandardMaterial",r.color=new Oi(16777215),r.roughness=1,r.metalness=0,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Oi(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=yn,r.normalScale=new gr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.roughnessMap=null,r.metalnessMap=null,r.alphaMap=null,r.envMap=null,r.envMapIntensity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.vertexTangents=!1,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this.vertexTangents=e.vertexTangents,this}}]),n}(Ni);_c.prototype.isMeshStandardMaterial=!0;var xc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).defines={STANDARD:"",PHYSICAL:""},r.type="MeshPhysicalMaterial",r.clearcoat=0,r.clearcoatMap=null,r.clearcoatRoughness=0,r.clearcoatRoughnessMap=null,r.clearcoatNormalScale=new gr(1,1),r.clearcoatNormalMap=null,r.reflectivity=.5,Object.defineProperty((0,g.Z)(r),"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=ir(2.5*(e-1)/(e+1),0,1)}}),r.sheen=null,r.transmission=0,r.transmissionMap=null,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new Oi).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this}}]),n}(_c);xc.prototype.isMeshPhysicalMaterial=!0;var Sc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="MeshPhongMaterial",r.color=new Oi(16777215),r.specular=new Oi(1118481),r.shininess=30,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Oi(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=yn,r.normalScale=new gr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=ce,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}]),n}(Ni);Sc.prototype.isMeshPhongMaterial=!0;var Rc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).defines={TOON:""},r.type="MeshToonMaterial",r.color=new Oi(16777215),r.map=null,r.gradientMap=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Oi(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=yn,r.normalScale=new gr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}]),n}(Ni);Rc.prototype.isMeshToonMaterial=!0;var Mc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="MeshNormalMaterial",r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=yn,r.normalScale=new gr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}]),n}(Ni);Mc.prototype.isMeshNormalMaterial=!0;var Wc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="MeshLambertMaterial",r.color=new Oi(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Oi(0),r.emissiveIntensity=1,r.emissiveMap=null,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=ce,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}]),n}(Ni);Wc.prototype.isMeshLambertMaterial=!0;var kc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).defines={MATCAP:""},r.type="MeshMatcapMaterial",r.color=new Oi(16777215),r.matcap=null,r.map=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=yn,r.normalScale=new gr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}]),n}(Ni);kc.prototype.isMeshMatcapMaterial=!0;var Vc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="LineDashedMaterial",r.scale=1,r.dashSize=3,r.gapSize=1,r.setValues(e),r}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}]),n}(rl);Vc.prototype.isLineDashedMaterial=!0;var Fc=Object.freeze({__proto__:null,ShadowMaterial:Zc,SpriteMaterial:Gu,RawShaderMaterial:wc,ShaderMaterial:Ta,PointsMaterial:Cl,MeshPhysicalMaterial:xc,MeshStandardMaterial:_c,MeshPhongMaterial:Sc,MeshToonMaterial:Rc,MeshNormalMaterial:Mc,MeshLambertMaterial:Wc,MeshDepthMaterial:ru,MeshDistanceMaterial:iu,MeshBasicMaterial:Ji,MeshMatcapMaterial:kc,LineDashedMaterial:Vc,LineBasicMaterial:rl,Material:Ni}),Ec={arraySlice:function(e,t,n){return Ec.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*t,u=0;u!==t;++u)i[o++]=e[s+u];return i},flattenJSON:function(e,t,n,r){for(var i=1,a=e[0];void 0!==a&&void 0===a[r];)a=e[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(t.push(a.time),n.push.apply(n,o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(t.push(a.time),o.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(t.push(a.time),n.push(o)),a=e[i++]}while(void 0!==a)}},subclip:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,a=e.clone();a.name=t;for(var o=[],s=0;s<a.tracks.length;++s){for(var u=a.tracks[s],l=u.getValueSize(),c=[],g=[],d=0;d<u.times.length;++d){var I=u.times[d]*i;if(!(I<n||I>=r)){c.push(u.times[d]);for(var C=0;C<l;++C)g.push(u.values[d*l+C])}}0!==c.length&&(u.times=Ec.convertArray(c,u.times.constructor),u.values=Ec.convertArray(g,u.values.constructor),o.push(u))}a.tracks=o;for(var h=1/0,f=0;f<a.tracks.length;++f)h>a.tracks[f].times[0]&&(h=a.tracks[f].times[0]);for(var p=0;p<a.tracks.length;++p)a.tracks[p].shift(-1*h);return a.resetDuration(),a},makeClipAdditive:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;r<=0&&(r=30);for(var i=n.tracks.length,a=t/r,o=function(t){var r=n.tracks[t],i=r.ValueTypeName;if("bool"===i||"string"===i)return"continue";var o=e.tracks.find((function(e){return e.name===r.name&&e.ValueTypeName===i}));if(void 0===o)return"continue";var s=0,u=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=u/3);var l=0,c=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(l=c/3);var g=r.times.length-1,d=void 0;if(a<=r.times[0]){var I=s,C=u-s;d=Ec.arraySlice(r.values,I,C)}else if(a>=r.times[g]){var h=g*u+s,f=h+u-s;d=Ec.arraySlice(r.values,h,f)}else{var p=r.createInterpolant(),A=s,m=u-s;p.evaluate(a),d=Ec.arraySlice(p.resultBuffer,A,m)}"quaternion"===i&&(new br).fromArray(d).normalize().conjugate().toArray(d);for(var v=o.times.length,b=0;b<v;++b){var y=b*c+l;if("quaternion"===i)br.multiplyQuaternionsFlat(o.values,y,d,0,o.values,y);else for(var B=c-2*l,G=0;G<B;++G)o.values[y+G]-=d[G]}},s=0;s<i;++s)o(s);return e.blendMode=un,e}},Xc=function(){function e(t,n,r,i){(0,C.Z)(this,e),this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}return(0,h.Z)(e,[{key:"evaluate",value:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var a;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===o)break;if(i=r,e<(r=t[++n]))break t}a=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(var u=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===u)break;if(r=i,e>=(i=t[--n-1]))break t}a=n,n=0}for(;n<a;){var l=n+a>>>1;e<t[l]?a=l:n=l+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}},{key:"getSettings_",value:function(){return this.settings||this.DefaultSettings_}},{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,a=0;a!==r;++a)t[a]=n[i+a];return t}},{key:"interpolate_",value:function(){throw new Error("call to abstract method")}},{key:"intervalChanged_",value:function(){}}]),e}();Xc.prototype.beforeStart_=Xc.prototype.copySampleValue_,Xc.prototype.afterEnd_=Xc.prototype.copySampleValue_;var Hc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i,a){var o;return(0,C.Z)(this,n),(o=t.call(this,e,r,i,a))._weightPrev=-0,o._offsetPrev=-0,o._weightNext=-0,o._offsetNext=-0,o.DefaultSettings_={endingStart:rn,endingEnd:rn},o}return(0,h.Z)(n,[{key:"intervalChanged_",value:function(e,t,n){var r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case an:i=e,o=2*t-n;break;case on:o=t+r[i=r.length-2]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case an:a=e,s=2*n-t;break;case on:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}var u=.5*(n-t),l=this.valueSize;this._weightPrev=u/(t-o),this._weightNext=u/(s-n),this._offsetPrev=i*l,this._offsetNext=a*l}},{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=this._offsetPrev,c=this._offsetNext,g=this._weightPrev,d=this._weightNext,I=(n-t)/(r-t),C=I*I,h=C*I,f=-g*h+2*g*C-g*I,p=(1+g)*h+(-1.5-2*g)*C+(-.5+g)*I+1,A=(-1-d)*h+(1.5+d)*C+.5*I,m=d*h-d*C,v=0;v!==o;++v)i[v]=f*a[l+v]+p*a[u+v]+A*a[s+v]+m*a[c+v];return i}}]),n}(Xc),Lc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i,a){return(0,C.Z)(this,n),t.call(this,e,r,i,a)}return(0,h.Z)(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=(n-t)/(r-t),c=1-l,g=0;g!==o;++g)i[g]=a[u+g]*c+a[s+g]*l;return i}}]),n}(Xc),zc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i,a){return(0,C.Z)(this,n),t.call(this,e,r,i,a)}return(0,h.Z)(n,[{key:"interpolate_",value:function(e){return this.copySampleValue_(e-1)}}]),n}(Xc),Nc=function(){function e(t,n,r,i){if((0,C.Z)(this,e),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Ec.convertArray(n,this.TimeBufferType),this.values=Ec.convertArray(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}return(0,h.Z)(e,[{key:"InterpolantFactoryMethodDiscrete",value:function(e){return new zc(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodLinear",value:function(e){return new Lc(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodSmooth",value:function(e){return new Hc(this.times,this.values,this.getValueSize(),e)}},{key:"setInterpolation",value:function(e){var t;switch(e){case en:t=this.InterpolantFactoryMethodDiscrete;break;case tn:t=this.InterpolantFactoryMethodLinear;break;case nn:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return en;case this.InterpolantFactoryMethodLinear:return tn;case this.InterpolantFactoryMethodSmooth:return nn}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this}},{key:"scale",value:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this}},{key:"trim",value:function(e,t){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=Ec.arraySlice(n,i,a),this.values=Ec.arraySlice(this.values,i*o,a*o)}return this}},{key:"validate",value:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"===typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==r&&Ec.isTypedArray(r))for(var u=0,l=r.length;u!==l;++u){var c=r[u];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,c),e=!1;break}}return e}},{key:"optimize",value:function(){for(var e=Ec.arraySlice(this.times),t=Ec.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===nn,i=e.length-1,a=1,o=1;o<i;++o){var s=!1,u=e[o];if(u!==e[o+1]&&(1!==o||u!==e[0]))if(r)s=!0;else for(var l=o*n,c=l-n,g=l+n,d=0;d!==n;++d){var I=t[l+d];if(I!==t[c+d]||I!==t[g+d]){s=!0;break}}if(s){if(o!==a){e[a]=e[o];for(var C=o*n,h=a*n,f=0;f!==n;++f)t[h+f]=t[C+f]}++a}}if(i>0){e[a]=e[i];for(var p=i*n,A=a*n,m=0;m!==n;++m)t[A+m]=t[p+m];++a}return a!==e.length?(this.times=Ec.arraySlice(e,0,a),this.values=Ec.arraySlice(t,0,a*n)):(this.times=e,this.values=t),this}},{key:"clone",value:function(){var e=Ec.arraySlice(this.times,0),t=Ec.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}],[{key:"toJSON",value:function(e){var t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:Ec.convertArray(e.times,Array),values:Ec.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}]),e}();Nc.prototype.TimeBufferType=Float32Array,Nc.prototype.ValueBufferType=Float32Array,Nc.prototype.DefaultInterpolation=tn;var Yc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){return(0,C.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n)}(Nc);Yc.prototype.ValueTypeName="bool",Yc.prototype.ValueBufferType=Array,Yc.prototype.DefaultInterpolation=en,Yc.prototype.InterpolantFactoryMethodLinear=void 0,Yc.prototype.InterpolantFactoryMethodSmooth=void 0;var Tc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){return(0,C.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n)}(Nc);Tc.prototype.ValueTypeName="color";var Kc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){return(0,C.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n)}(Nc);Kc.prototype.ValueTypeName="number";var Dc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i,a){return(0,C.Z)(this,n),t.call(this,e,r,i,a)}return(0,h.Z)(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t),u=e*o,l=u+o;u!==l;u+=4)br.slerpFlat(i,0,a,u-o,a,u,s);return i}}]),n}(Xc),Pc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){return(0,C.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n,[{key:"InterpolantFactoryMethodLinear",value:function(e){return new Dc(this.times,this.values,this.getValueSize(),e)}}]),n}(Nc);Pc.prototype.ValueTypeName="quaternion",Pc.prototype.DefaultInterpolation=tn,Pc.prototype.InterpolantFactoryMethodSmooth=void 0;var Uc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){return(0,C.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n)}(Nc);Uc.prototype.ValueTypeName="string",Uc.prototype.ValueBufferType=Array,Uc.prototype.DefaultInterpolation=en,Uc.prototype.InterpolantFactoryMethodLinear=void 0,Uc.prototype.InterpolantFactoryMethodSmooth=void 0;var Oc=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){return(0,C.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n)}(Nc);Oc.prototype.ValueTypeName="vector";var Jc=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:sn;(0,C.Z)(this,e),this.name=t,this.tracks=r,this.duration=n,this.blendMode=i,this.uuid=rr(),this.duration<0&&this.resetDuration()}return(0,h.Z)(e,[{key:"resetDuration",value:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}},{key:"trim",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}},{key:"validate",value:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}},{key:"optimize",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}},{key:"clone",value:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}},{key:"toJSON",value:function(){return this.constructor.toJSON(this)}}],[{key:"parse",value:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,a=n.length;i!==a;++i)t.push(Qc(n[i]).scale(r));var o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}},{key:"toJSON",value:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},i=0,a=n.length;i!==a;++i)t.push(Nc.toJSON(n[i]));return r}},{key:"CreateFromMorphTargetSequence",value:function(e,t,n,r){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],u=[];s.push((o+i-1)%i,o,(o+1)%i),u.push(0,1,0);var l=Ec.getKeyframeOrder(s);s=Ec.sortedArray(s,1,l),u=Ec.sortedArray(u,1,l),r||0!==s[0]||(s.push(i),u.push(u[0])),a.push(new Kc(".morphTargetInfluences["+t[o].name+"]",s,u).scale(1/n))}return new this(e,-1,a)}},{key:"findByName",value:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}},{key:"CreateClipsFromMorphTargetSequences",value:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],u=s.name.match(i);if(u&&u.length>1){var l=u[1],c=r[l];c||(r[l]=c=[]),c.push(s)}}var g=[];for(var d in r)g.push(this.CreateFromMorphTargetSequence(d,r[d],t,n));return g}},{key:"parseAnimation",value:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var a=[],o=[];Ec.flattenJSON(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.fps||30,o=e.blendMode,s=e.length||-1,u=e.hierarchy||[],l=0;l<u.length;l++){var c=u[l].keys;if(c&&0!==c.length)if(c[0].morphTargets){var g={},d=void 0;for(d=0;d<c.length;d++)if(c[d].morphTargets)for(var I=0;I<c[d].morphTargets.length;I++)g[c[d].morphTargets[I]]=-1;for(var C in g){for(var h=[],f=[],p=0;p!==c[d].morphTargets.length;++p){var A=c[d];h.push(A.time),f.push(A.morphTarget===C?1:0)}r.push(new Kc(".morphTargetInfluence["+C+"]",h,f))}s=g.length*(a||1)}else{var m=".bones["+t[l].name+"]";n(Oc,m+".position",c,"pos",r),n(Pc,m+".quaternion",c,"rot",r),n(Oc,m+".scale",c,"scl",r)}}return 0===r.length?null:new this(i,s,r,o)}}]),e}();function Qc(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Kc;case"vector":case"vector2":case"vector3":case"vector4":return Oc;case"color":return Tc;case"quaternion":return Pc;case"bool":case"boolean":return Yc;case"string":return Uc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];Ec.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var jc={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},qc=(0,h.Z)((function e(t,n,r){(0,C.Z)(this,e);var i=this,a=!1,o=0,s=0,u=void 0,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=r,this.itemStart=function(e){s++,!1===a&&void 0!==i.onStart&&i.onStart(e,o,s),a=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,s),o===s&&(a=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return u?u(e):e},this.setURLModifier=function(e){return u=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){var t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=l.length;t<n;t+=2){var r=l[t],i=l[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}})),$c=new qc,eg=function(){function e(t){(0,C.Z)(this,e),this.manager=void 0!==t?t:$c,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}return(0,h.Z)(e,[{key:"load",value:function(){}},{key:"loadAsync",value:function(e,t){var n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}},{key:"parse",value:function(){}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setWithCredentials",value:function(e){return this.withCredentials=e,this}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"setRequestHeader",value:function(e){return this.requestHeader=e,this}}]),e}(),tg={},ng=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){return(0,C.Z)(this,n),t.call(this,e)}return(0,h.Z)(n,[{key:"load",value:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=jc.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;if(void 0===tg[e]){var o,s=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var u=s[1],l=!!s[2],c=s[3];c=decodeURIComponent(c),l&&(c=atob(c));try{var g,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var I=new Uint8Array(c.length),C=0;C<c.length;C++)I[C]=c.charCodeAt(C);g="blob"===d?new Blob([I.buffer],{type:u}):I.buffer;break;case"document":var h=new DOMParser;g=h.parseFromString(c,u);break;case"json":g=JSON.parse(c);break;default:g=c}setTimeout((function(){t&&t(g),i.manager.itemEnd(e)}),0)}catch(p){setTimeout((function(){r&&r(p),i.manager.itemError(e),i.manager.itemEnd(e)}),0)}}else{for(var f in tg[e]=[],tg[e].push({onLoad:t,onProgress:n,onError:r}),(o=new XMLHttpRequest).open("GET",e,!0),o.addEventListener("load",(function(t){var n=this.response,r=tg[e];if(delete tg[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),jc.add(e,n);for(var a=0,o=r.length;a<o;a++){var s=r[a];s.onLoad&&s.onLoad(n)}i.manager.itemEnd(e)}else{for(var u=0,l=r.length;u<l;u++){var c=r[u];c.onError&&c.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}}),!1),o.addEventListener("progress",(function(t){for(var n=tg[e],r=0,i=n.length;r<i;r++){var a=n[r];a.onProgress&&a.onProgress(t)}}),!1),o.addEventListener("error",(function(t){var n=tg[e];delete tg[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),o.addEventListener("abort",(function(t){var n=tg[e];delete tg[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(o.responseType=this.responseType),void 0!==this.withCredentials&&(o.withCredentials=this.withCredentials),o.overrideMimeType&&o.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)o.setRequestHeader(f,this.requestHeader[f]);o.send(null)}return i.manager.itemStart(e),o}tg[e].push({onLoad:t,onProgress:n,onError:r})}},{key:"setResponseType",value:function(e){return this.responseType=e,this}},{key:"setMimeType",value:function(e){return this.mimeType=e,this}}]),n}(eg),rg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){return(0,C.Z)(this,n),t.call(this,e)}return(0,h.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new ng(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(a){r?r(a):console.error(a),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=Jc.parse(e[n]);t.push(r)}return t}}]),n}(eg),ig=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){return(0,C.Z)(this,n),t.call(this,e)}return(0,h.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=[],o=new yl,s=new ng(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);var u=0;function l(l){s.load(e[l],(function(e){var n=i.parse(e,!0);a[l]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(o.minFilter=Ve),o.image=a,o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,r)}if(Array.isArray(e))for(var c=0,g=e.length;c<g;++c)l(c);else s.load(e,(function(e){var n=i.parse(e,!0);if(n.isCubemap){for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){a[s]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+u]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}o.image=a}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=Ve),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,r);return o}}]),n}(eg),ag=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){return(0,C.Z)(this,n),t.call(this,e)}return(0,h.Z)(n,[{key:"load",value:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=jc.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",u,!1),jc.add(e,this),t&&t(this),i.manager.itemEnd(e)}function u(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",u,!1),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",u,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}]),n}(eg),og=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){return(0,C.Z)(this,n),t.call(this,e)}return(0,h.Z)(n,[{key:"load",value:function(e,t,n,r){var i=new Oa,a=new ag(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(e[n],(function(e){i.images[n]=e,6===++o&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(var u=0;u<e.length;++u)s(u);return i}}]),n}(eg),sg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){return(0,C.Z)(this,n),t.call(this,e)}return(0,h.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new Qa,o=new ng(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(e,(function(e){var n=i.parse(e);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:_e,a.wrapT=void 0!==n.wrapT?n.wrapT:_e,a.magFilter=void 0!==n.magFilter?n.magFilter:Ve,a.minFilter=void 0!==n.minFilter?n.minFilter:Ve,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(a.encoding=n.encoding),void 0!==n.flipY&&(a.flipY=n.flipY),void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=Xe),1===n.mipmapCount&&(a.minFilter=Ve),void 0!==n.generateMipmaps&&(a.generateMipmaps=n.generateMipmaps),a.needsUpdate=!0,t&&t(a,n))}),n,r),a}}]),n}(eg),ug=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){return(0,C.Z)(this,n),t.call(this,e)}return(0,h.Z)(n,[{key:"load",value:function(e,t,n,r){var i=new fr,a=new ag(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(n){i.image=n;var r=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=r?qe:$e,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}]),n}(eg),lg=function(){function e(){(0,C.Z)(this,e),this.type="Curve",this.arcLengthDivisions=200}return(0,h.Z)(e,[{key:"getPoint",value:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}},{key:"getPointAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)}},{key:"getPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}},{key:"getLength",value:function(){var e=this.getLengths();return e[e.length-1]}},{key:"getLengths",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),i=0;n.push(0);for(var a=1;a<=e;a++)i+=(t=this.getPoint(a/e)).distanceTo(r),n.push(i),r=t;return this.cacheArcLengths=n,n}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.getLengths()}},{key:"getUtoTmapping",value:function(e,t){var n,r=this.getLengths(),i=0,a=r.length;n=t||e*r[a-1];for(var o,s=0,u=a-1;s<=u;)if((o=r[i=Math.floor(s+(u-s)/2)]-n)<0)s=i+1;else{if(!(o>0)){u=i;break}u=i-1}if(r[i=u]===n)return i/(a-1);var l=r[i];return(i+(n-l)/(r[i+1]-l))/(a-1)}},{key:"getTangent",value:function(e,t){var n=1e-4,r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);var a=this.getPoint(r),o=this.getPoint(i),s=t||(a.isVector2?new gr:new yr);return s.copy(o).sub(a).normalize(),s}},{key:"getTangentAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getTangent(n,t)}},{key:"computeFrenetFrames",value:function(e,t){for(var n=new yr,r=[],i=[],a=[],o=new yr,s=new $r,u=0;u<=e;u++){var l=u/e;r[u]=this.getTangentAt(l,new yr),r[u].normalize()}i[0]=new yr,a[0]=new yr;var c=Number.MAX_VALUE,g=Math.abs(r[0].x),d=Math.abs(r[0].y),I=Math.abs(r[0].z);g<=c&&(c=g,n.set(1,0,0)),d<=c&&(c=d,n.set(0,1,0)),I<=c&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),a[0].crossVectors(r[0],i[0]);for(var C=1;C<=e;C++){if(i[C]=i[C-1].clone(),a[C]=a[C-1].clone(),o.crossVectors(r[C-1],r[C]),o.length()>Number.EPSILON){o.normalize();var h=Math.acos(ir(r[C-1].dot(r[C]),-1,1));i[C].applyMatrix4(s.makeRotationAxis(o,h))}a[C].crossVectors(r[C],i[C])}if(!0===t){var f=Math.acos(ir(i[0].dot(i[e]),-1,1));f/=e,r[0].dot(o.crossVectors(i[0],i[e]))>0&&(f=-f);for(var p=1;p<=e;p++)i[p].applyMatrix4(s.makeRotationAxis(r[p],f*p)),a[p].crossVectors(r[p],i[p])}return{tangents:r,normals:i,binormals:a}}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}},{key:"fromJSON",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}]),e}(),cg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return(0,C.Z)(this,n),(e=t.call(this)).type="EllipseCurve",e.aX=r,e.aY=i,e.xRadius=a,e.yRadius=o,e.aStartAngle=s,e.aEndAngle=u,e.aClockwise=l,e.aRotation=c,e}return(0,h.Z)(n,[{key:"getPoint",value:function(e,t){for(var n=t||new gr,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),u=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var l=Math.cos(this.aRotation),c=Math.sin(this.aRotation),g=s-this.aX,d=u-this.aY;s=g*l-d*c+this.aX,u=g*c+d*l+this.aY}return n.set(s,u)}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}},{key:"fromJSON",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"fromJSON",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}]),n}(lg);cg.prototype.isEllipseCurve=!0;var gg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i,a,o,s){var u;return(0,C.Z)(this,n),(u=t.call(this,e,r,i,i,a,o,s)).type="ArcCurve",u}return(0,h.Z)(n)}(cg);function dg(){var e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){var u=(t-e)/a-(n-e)/(a+o)+(n-t)/o,l=(n-t)/o-(r-t)/(o+s)+(r-n)/s;i(t,n,u*=o,l*=o)},calc:function(i){var a=i*i;return e+t*i+n*a+r*(a*i)}}}gg.prototype.isArcCurve=!0;var Ig=new yr,Cg=new dg,hg=new dg,fg=new dg,pg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;return(0,C.Z)(this,n),(e=t.call(this)).type="CatmullRomCurve3",e.points=r,e.closed=i,e.curveType=a,e.tension=o,e}return(0,h.Z)(n,[{key:"getPoint",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yr,i=r,a=this.points,o=a.length,s=(o-(this.closed?0:1))*e,u=Math.floor(s),l=s-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/o)+1)*o:0===l&&u===o-1&&(u=o-2,l=1),this.closed||u>0?t=a[(u-1)%o]:(Ig.subVectors(a[0],a[1]).add(a[0]),t=Ig);var c=a[u%o],g=a[(u+1)%o];if(this.closed||u+2<o?n=a[(u+2)%o]:(Ig.subVectors(a[o-1],a[o-2]).add(a[o-1]),n=Ig),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,I=Math.pow(t.distanceToSquared(c),d),C=Math.pow(c.distanceToSquared(g),d),h=Math.pow(g.distanceToSquared(n),d);C<1e-4&&(C=1),I<1e-4&&(I=C),h<1e-4&&(h=C),Cg.initNonuniformCatmullRom(t.x,c.x,g.x,n.x,I,C,h),hg.initNonuniformCatmullRom(t.y,c.y,g.y,n.y,I,C,h),fg.initNonuniformCatmullRom(t.z,c.z,g.z,n.z,I,C,h)}else"catmullrom"===this.curveType&&(Cg.initCatmullRom(t.x,c.x,g.x,n.x,this.tension),hg.initCatmullRom(t.y,c.y,g.y,n.y,this.tension),fg.initCatmullRom(t.z,c.z,g.z,n.z,this.tension));return i.set(Cg.calc(l),hg.calc(l),fg.calc(l)),i}},{key:"copy",value:function(e){(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}},{key:"fromJSON",value:function(e){(0,l.Z)((0,c.Z)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new yr).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}]),n}(lg);function Ag(e,t,n,r,i){var a=.5*(r-t),o=.5*(i-n),s=e*e;return(2*n-2*r+a+o)*(e*s)+(-3*n+3*r-2*a-o)*s+a*e+n}function mg(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function vg(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}pg.prototype.isCatmullRomCurve3=!0;var bg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new gr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gr,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new gr,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new gr;return(0,C.Z)(this,n),(e=t.call(this)).type="CubicBezierCurve",e.v0=r,e.v1=i,e.v2=a,e.v3=o,e}return(0,h.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gr,n=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(vg(e,r.x,i.x,a.x,o.x),vg(e,r.y,i.y,a.y,o.y)),n}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(lg);bg.prototype.isCubicBezierCurve=!0;var yg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yr,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yr,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new yr;return(0,C.Z)(this,n),(e=t.call(this)).type="CubicBezierCurve3",e.v0=r,e.v1=i,e.v2=a,e.v3=o,e}return(0,h.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yr,n=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(vg(e,r.x,i.x,a.x,o.x),vg(e,r.y,i.y,a.y,o.y),vg(e,r.z,i.z,a.z,o.z)),n}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(lg);yg.prototype.isCubicBezierCurve3=!0;var Bg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new gr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gr;return(0,C.Z)(this,n),(e=t.call(this)).type="LineCurve",e.v1=r,e.v2=i,e}return(0,h.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gr,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"getTangent",value:function(e,t){var n=t||new gr;return n.copy(this.v2).sub(this.v1).normalize(),n}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(lg);Bg.prototype.isLineCurve=!0;var Gg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yr;return(0,C.Z)(this,n),(e=t.call(this)).type="LineCurve3",e.isLineCurve3=!0,e.v1=r,e.v2=i,e}return(0,h.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yr,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(lg),Zg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new gr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gr,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new gr;return(0,C.Z)(this,n),(e=t.call(this)).type="QuadraticBezierCurve",e.v0=r,e.v1=i,e.v2=a,e}return(0,h.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gr,n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(mg(e,r.x,i.x,a.x),mg(e,r.y,i.y,a.y)),n}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(lg);Zg.prototype.isQuadraticBezierCurve=!0;var wg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yr,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yr;return(0,C.Z)(this,n),(e=t.call(this)).type="QuadraticBezierCurve3",e.v0=r,e.v1=i,e.v2=a,e}return(0,h.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yr,n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(mg(e,r.x,i.x,a.x),mg(e,r.y,i.y,a.y),mg(e,r.z,i.z,a.z)),n}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(lg);wg.prototype.isQuadraticBezierCurve3=!0;var _g=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,C.Z)(this,n),(e=t.call(this)).type="SplineCurve",e.points=r,e}return(0,h.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gr,n=t,r=this.points,i=(r.length-1)*e,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],u=r[a],l=r[a>r.length-2?r.length-1:a+1],c=r[a>r.length-3?r.length-1:a+2];return n.set(Ag(o,s.x,u.x,l.x,c.x),Ag(o,s.y,u.y,l.y,c.y)),n}},{key:"copy",value:function(e){(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e}},{key:"fromJSON",value:function(e){(0,l.Z)((0,c.Z)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new gr).fromArray(i))}return this}}]),n}(lg);_g.prototype.isSplineCurve=!0;var xg=Object.freeze({__proto__:null,ArcCurve:gg,CatmullRomCurve3:pg,CubicBezierCurve:bg,CubicBezierCurve3:yg,EllipseCurve:cg,LineCurve:Bg,LineCurve3:Gg,QuadraticBezierCurve:Zg,QuadraticBezierCurve3:wg,SplineCurve:_g}),Sg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e;return(0,C.Z)(this,n),(e=t.call(this)).type="CurvePath",e.curves=[],e.autoClose=!1,e}return(0,h.Z)(n,[{key:"add",value:function(e){this.curves.push(e)}},{key:"closePath",value:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Bg(t,e))}},{key:"getPoint",value:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var i=n[r]-t,a=this.curves[r],o=a.getLength(),s=0===o?0:1-i/o;return a.getPointAt(s)}r++}return null}},{key:"getLength",value:function(){var e=this.getCurveLengths();return e[e.length-1]}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}},{key:"getCurveLengths",value:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}},{key:"getPoints",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),u=0;u<s.length;u++){var l=s[u];e&&e.equals(l)||(n.push(l),e=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},{key:"copy",value:function(e){(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){(0,l.Z)((0,c.Z)(n.prototype),"fromJSON",this).call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push((new xg[i.type]).fromJSON(i))}return this}}]),n}(lg),Rg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="Path",r.currentPoint=new gr,e&&r.setFromPoints(e),r}return(0,h.Z)(n,[{key:"setFromPoints",value:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}},{key:"moveTo",value:function(e,t){return this.currentPoint.set(e,t),this}},{key:"lineTo",value:function(e,t){var n=new Bg(this.currentPoint.clone(),new gr(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){var i=new Zg(this.currentPoint.clone(),new gr(e,t),new gr(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){var o=new bg(this.currentPoint.clone(),new gr(e,t),new gr(n,r),new gr(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this}},{key:"splineThru",value:function(e){var t=[this.currentPoint.clone()].concat(e),n=new _g(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}},{key:"arc",value:function(e,t,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,i,a),this}},{key:"absarc",value:function(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this}},{key:"ellipse",value:function(e,t,n,r,i,a,o,s){var u=this.currentPoint.x,l=this.currentPoint.y;return this.absellipse(e+u,t+l,n,r,i,a,o,s),this}},{key:"absellipse",value:function(e,t,n,r,i,a,o,s){var u=new cg(e,t,n,r,i,a,o,s);if(this.curves.length>0){var l=u.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(u);var c=u.getPoint(1);return this.currentPoint.copy(c),this}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.currentPoint.copy(e.currentPoint),this}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this);return e.currentPoint=this.currentPoint.toArray(),e}},{key:"fromJSON",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"fromJSON",this).call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}]),n}(Sg),Mg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this,e)).uuid=rr(),r.type="Shape",r.holes=[],r}return(0,h.Z)(n,[{key:"getPointsHoles",value:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}},{key:"extractPoints",value:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}},{key:"copy",value:function(e){(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){(0,l.Z)((0,c.Z)(n.prototype),"fromJSON",this).call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push((new Rg).fromJSON(i))}return this}}]),n}(Rg),Wg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,C.Z)(this,n),(r=t.call(this)).type="Light",r.color=new Oi(e),r.intensity=i,r}return(0,h.Z)(n,[{key:"dispose",value:function(){}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this}},{key:"toJSON",value:function(e){var t=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}]),n}(Gi);Wg.prototype.isLight=!0;var kg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){var a;return(0,C.Z)(this,n),(a=t.call(this,e,i)).type="HemisphereLight",a.position.copy(Gi.DefaultUp),a.updateMatrix(),a.groundColor=new Oi(r),a}return(0,h.Z)(n,[{key:"copy",value:function(e){return Wg.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}]),n}(Wg);kg.prototype.isHemisphereLight=!0;var Vg=new $r,Fg=new yr,Eg=new yr,Xg=function(){function e(t){(0,C.Z)(this,e),this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new gr(512,512),this.map=null,this.mapPass=null,this.matrix=new $r,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new $a,this._frameExtents=new gr(1,1),this._viewportCount=1,this._viewports=[new Ar(0,0,1,1)]}return(0,h.Z)(e,[{key:"getViewportCount",value:function(){return this._viewportCount}},{key:"getFrustum",value:function(){return this._frustum}},{key:"updateMatrices",value:function(e){var t=this.camera,n=this.matrix;Fg.setFromMatrixPosition(e.matrixWorld),t.position.copy(Fg),Eg.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Eg),t.updateMatrixWorld(),Vg.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Vg),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}},{key:"getViewport",value:function(e){return this._viewports[e]}},{key:"getFrameExtents",value:function(){return this._frameExtents}},{key:"dispose",value:function(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}},{key:"copy",value:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}]),e}(),Hg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e;return(0,C.Z)(this,n),(e=t.call(this,new Da(50,1,.5,500))).focus=1,e}return(0,h.Z)(n,[{key:"updateMatrices",value:function(e){var t=this.camera,r=2*nr*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;r===t.fov&&i===t.aspect&&a===t.far||(t.fov=r,t.aspect=i,t.far=a,t.updateProjectionMatrix()),(0,l.Z)((0,c.Z)(n.prototype),"updateMatrices",this).call(this,e)}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.focus=e.focus,this}}]),n}(Xg);Hg.prototype.isSpotLightShadow=!0;var Lg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return(0,C.Z)(this,n),(i=t.call(this,e,r)).type="SpotLight",i.position.copy(Gi.DefaultUp),i.updateMatrix(),i.target=new Gi,i.distance=a,i.angle=o,i.penumbra=s,i.decay=u,i.shadow=new Hg,i}return(0,h.Z)(n,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(Wg);Lg.prototype.isSpotLight=!0;var zg=new $r,Ng=new yr,Yg=new yr,Tg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e;return(0,C.Z)(this,n),(e=t.call(this,new Da(90,1,.5,500)))._frameExtents=new gr(4,2),e._viewportCount=6,e._viewports=[new Ar(2,1,1,1),new Ar(0,1,1,1),new Ar(3,1,1,1),new Ar(1,1,1,1),new Ar(3,0,1,1),new Ar(1,0,1,1)],e._cubeDirections=[new yr(1,0,0),new yr(-1,0,0),new yr(0,0,1),new yr(0,0,-1),new yr(0,1,0),new yr(0,-1,0)],e._cubeUps=[new yr(0,1,0),new yr(0,1,0),new yr(0,1,0),new yr(0,1,0),new yr(0,0,1),new yr(0,0,-1)],e}return(0,h.Z)(n,[{key:"updateMatrices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),Ng.setFromMatrixPosition(e.matrixWorld),n.position.copy(Ng),Yg.copy(n.position),Yg.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Yg),n.updateMatrixWorld(),r.makeTranslation(-Ng.x,-Ng.y,-Ng.z),zg.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(zg)}}]),n}(Xg);Tg.prototype.isPointLightShadow=!0;var Kg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,C.Z)(this,n),(i=t.call(this,e,r)).type="PointLight",i.distance=a,i.decay=o,i.shadow=new Tg,i}return(0,h.Z)(n,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}]),n}(Wg);Kg.prototype.isPointLight=!0;var Dg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;return(0,C.Z)(this,n),(e=t.call(this)).type="OrthographicCamera",e.zoom=1,e.view=null,e.left=r,e.right=i,e.top=a,e.bottom=o,e.near=s,e.far=u,e.updateProjectionMatrix(),e}return(0,h.Z)(n,[{key:"copy",value:function(e,t){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}},{key:"setViewOffset",value:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var u=(this.right-this.left)/this.view.fullWidth/this.zoom,l=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(i+=u*this.view.offsetX)+u*this.view.width,s=(o-=l*this.view.offsetY)-l*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}]),n}(Ka);Dg.prototype.isOrthographicCamera=!0;var Pg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){return(0,C.Z)(this,n),t.call(this,new Dg(-5,5,5,-5,.5,500))}return(0,h.Z)(n)}(Xg);Pg.prototype.isDirectionalLightShadow=!0;var Ug=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i;return(0,C.Z)(this,n),(i=t.call(this,e,r)).type="DirectionalLight",i.position.copy(Gi.DefaultUp),i.updateMatrix(),i.target=new Gi,i.shadow=new Pg,i}return(0,h.Z)(n,[{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(Wg);Ug.prototype.isDirectionalLight=!0;var Og=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i;return(0,C.Z)(this,n),(i=t.call(this,e,r)).type="AmbientLight",i}return(0,h.Z)(n)}(Wg);Og.prototype.isAmbientLight=!0;var Jg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return(0,C.Z)(this,n),(i=t.call(this,e,r)).type="RectAreaLight",i.width=a,i.height=o,i}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.width=e.width,this.height=e.height,this}},{key:"toJSON",value:function(e){var t=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}]),n}(Wg);Jg.prototype.isRectAreaLight=!0;var Qg=function(){function e(){(0,C.Z)(this,e),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new yr)}return(0,h.Z)(e,[{key:"set",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}},{key:"zero",value:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}},{key:"getAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*r*1.092548),t.addScaledVector(a[5],r*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],n*i*1.092548),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}},{key:"getIrradianceAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*r),t.addScaledVector(a[5],.858086*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}},{key:"add",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}},{key:"addScaledSH",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}},{key:"scale",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}},{key:"lerp",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}},{key:"equals",value:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}},{key:"copy",value:function(e){return this.set(e.coefficients)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}],[{key:"getBasisAt",value:function(e,t){var n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}]),e}();Qg.prototype.isSphericalHarmonics3=!0;var jg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Qg,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,C.Z)(this,n),(e=t.call(this,void 0,i)).sh=r,e}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.sh.copy(e.sh),this}},{key:"fromJSON",value:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}},{key:"toJSON",value:function(e){var t=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.sh=this.sh.toArray(),t}}]),n}(Wg);jg.prototype.isLightProbe=!0;var qg=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this,e)).textures={},r}return(0,h.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new ng(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(a){r?r(a):console.error(a),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new Fc[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=(new Oi).setHex(e.sheen)),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(r.morphNormals=e.morphNormals),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.vertexTangents&&(r.vertexTangents=e.vertexTangents),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"===typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var i in e.uniforms){var a=e.uniforms[i];switch(r.uniforms[i]={},a.type){case"t":r.uniforms[i].value=n(a.value);break;case"c":r.uniforms[i].value=(new Oi).setHex(a.value);break;case"v2":r.uniforms[i].value=(new gr).fromArray(a.value);break;case"v3":r.uniforms[i].value=(new yr).fromArray(a.value);break;case"v4":r.uniforms[i].value=(new Ar).fromArray(a.value);break;case"m3":r.uniforms[i].value=(new Ir).fromArray(a.value);break;case"m4":r.uniforms[i].value=(new $r).fromArray(a.value);break;default:r.uniforms[i].value=a.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var o in e.extensions)r.extensions[o]=e.extensions[o];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new gr).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new gr).fromArray(e.clearcoatNormalScale)),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),r}},{key:"setTextures",value:function(e){return this.textures=e,this}}]),n}(eg),$g=function(){function e(){(0,C.Z)(this,e)}return(0,h.Z)(e,null,[{key:"decodeText",value:function(e){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(i){return t}}},{key:"extractUrlBase",value:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}}]),e}(),ed=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e;return(0,C.Z)(this,n),(e=t.call(this)).type="InstancedBufferGeometry",e.instanceCount=1/0,e}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.instanceCount=e.instanceCount,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this,this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}]),n}(ma);ed.prototype.isInstancedBufferGeometry=!0;var td=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i,a){var o;return(0,C.Z)(this,n),"number"===typeof i&&(a=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),(o=t.call(this,e,r,i)).meshPerAttribute=a||1,o}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"toJSON",value:function(){var e=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}]),n}(qi);td.prototype.isInstancedBufferAttribute=!0;var nd=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){return(0,C.Z)(this,n),t.call(this,e)}return(0,h.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new ng(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(a){r?r(a):console.error(a),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t={},n={};function r(e,r){if(void 0!==t[r])return t[r];var i=e.interleavedBuffers[r],a=function(e,t){if(void 0!==n[t])return n[t];var r=e.arrayBuffers[t],i=new Uint32Array(r).buffer;return n[t]=i,i}(e,i.buffer),o=ga(i.type,a),s=new vu(o,i.stride);return s.uuid=i.uuid,t[r]=s,s}var i=e.isInstancedBufferGeometry?new ed:new ma,a=e.data.index;if(void 0!==a){var o=ga(a.type,a.array);i.setIndex(new qi(o,1))}var s=e.data.attributes;for(var u in s){var l=s[u],c=void 0;if(l.isInterleavedBufferAttribute){var g=r(e.data,l.data);c=new yu(g,l.itemSize,l.offset,l.normalized)}else{var d=ga(l.type,l.array);c=new(l.isInstancedBufferAttribute?td:qi)(d,l.itemSize,l.normalized)}void 0!==l.name&&(c.name=l.name),void 0!==l.usage&&c.setUsage(l.usage),void 0!==l.updateRange&&(c.updateRange.offset=l.updateRange.offset,c.updateRange.count=l.updateRange.count),i.setAttribute(u,c)}var I=e.data.morphAttributes;if(I)for(var C in I){for(var h=I[C],f=[],p=0,A=h.length;p<A;p++){var m=h[p],v=void 0;if(m.isInterleavedBufferAttribute){var b=r(e.data,m.data);v=new yu(b,m.itemSize,m.offset,m.normalized)}else{var y=ga(m.type,m.array);v=new qi(y,m.itemSize,m.normalized)}void 0!==m.name&&(v.name=m.name),f.push(v)}i.morphAttributes[C]=f}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);var B=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==B)for(var G=0,Z=B.length;G!==Z;++G){var w=B[G];i.addGroup(w.start,w.count,w.materialIndex)}var _=e.data.boundingSphere;if(void 0!==_){var x=new yr;void 0!==_.center&&x.fromArray(_.center),i.boundingSphere=new Kr(x,_.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}]),n}(eg),rd=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){return(0,C.Z)(this,n),t.call(this,e)}return(0,h.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=""===this.path?$g.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;var o=new ng(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){var a=null;try{a=JSON.parse(n)}catch(s){return void 0!==r&&r(s),void console.error("THREE:ObjectLoader: Can't parse "+e+".",s.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(a,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)}},{key:"parse",value:function(e,t){var n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,(function(){void 0!==t&&t(u)})),o=this.parseTextures(e.textures,a),s=this.parseMaterials(e.materials,o),u=this.parseObject(e.object,i,s,n),l=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,l),void 0!==t){var c=!1;for(var g in a)if(a[g]instanceof HTMLImageElement){c=!0;break}!1===c&&t(u)}return u}},{key:"parseShapes",value:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new Mg).fromJSON(e[n]);t[i.uuid]=i}return t}},{key:"parseSkeletons",value:function(e,t){var n={},r={};if(t.traverse((function(e){e.isBone&&(r[e.uuid]=e)})),void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=(new ju).fromJSON(e[i],r);n[o.uuid]=o}return n}},{key:"parseGeometries",value:function(e,t){var n,r={};if(void 0!==e)for(var i=new nd,a=0,o=e.length;a<o;a++){var s=void 0,u=e[a];switch(u.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new Gc[u.type](u.width,u.height,u.widthSegments,u.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":s=new Gc[u.type](u.width,u.height,u.depth,u.widthSegments,u.heightSegments,u.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Gc[u.type](u.radius,u.segments,u.thetaStart,u.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Gc[u.type](u.radiusTop,u.radiusBottom,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Gc[u.type](u.radius,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Gc[u.type](u.radius,u.widthSegments,u.heightSegments,u.phiStart,u.phiLength,u.thetaStart,u.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Gc[u.type](u.radius,u.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Gc[u.type](u.innerRadius,u.outerRadius,u.thetaSegments,u.phiSegments,u.thetaStart,u.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Gc[u.type](u.radius,u.tube,u.radialSegments,u.tubularSegments,u.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Gc[u.type](u.radius,u.tube,u.tubularSegments,u.radialSegments,u.p,u.q);break;case"TubeGeometry":case"TubeBufferGeometry":s=new Gc[u.type]((new xg[u.path.type]).fromJSON(u.path),u.tubularSegments,u.radius,u.radialSegments,u.closed);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Gc[u.type](u.points,u.segments,u.phiStart,u.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Gc[u.type](u.vertices,u.indices,u.radius,u.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":n=[];for(var l=0,c=u.shapes.length;l<c;l++){var g=t[u.shapes[l]];n.push(g)}s=new Gc[u.type](n,u.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":n=[];for(var d=0,I=u.shapes.length;d<I;d++){var C=t[u.shapes[d]];n.push(C)}var h=u.options.extrudePath;void 0!==h&&(u.options.extrudePath=(new xg[h.type]).fromJSON(h)),s=new Gc[u.type](n,u.options);break;case"BufferGeometry":case"InstancedBufferGeometry":s=i.parse(u);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+u.type+'"');continue}s.uuid=u.uuid,void 0!==u.name&&(s.name=u.name),!0===s.isBufferGeometry&&void 0!==u.userData&&(s.userData=u.userData),r[u.uuid]=s}return r}},{key:"parseMaterials",value:function(e,t){var n={},r={};if(void 0!==e){var i=new qg;i.setTextures(t);for(var a=0,o=e.length;a<o;a++){var s=e[a];if("MultiMaterial"===s.type){for(var u=[],l=0;l<s.materials.length;l++){var c=s.materials[l];void 0===n[c.uuid]&&(n[c.uuid]=i.parse(c)),u.push(n[c.uuid])}r[s.uuid]=u}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r}},{key:"parseAnimations",value:function(e){var t={};if(void 0!==e)for(var n=0;n<e.length;n++){var r=e[n],i=Jc.parse(r);t[i.uuid]=i}return t}},{key:"parseImages",value:function(e,t){var n,r=this,i={};function a(e){if("string"===typeof e){var t=e;return function(e){return r.manager.itemStart(e),n.load(e,(function(){r.manager.itemEnd(e)}),void 0,(function(){r.manager.itemError(e),r.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t)}return e.data?{data:ga(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){var o=new qc(t);(n=new ag(o)).setCrossOrigin(this.crossOrigin);for(var s=0,u=e.length;s<u;s++){var l=e[s],c=l.url;if(Array.isArray(c)){i[l.uuid]=[];for(var g=0,d=c.length;g<d;g++){var I=a(c[g]);null!==I&&(I instanceof HTMLImageElement?i[l.uuid].push(I):i[l.uuid].push(new Qa(I.data,I.width,I.height)))}}else{var C=a(l.url);null!==C&&(i[l.uuid]=C)}}}return i}},{key:"parseTextures",value:function(e,t){function n(e,t){return"number"===typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=e[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=void 0,u=t[o.image];Array.isArray(u)?(s=new Oa(u),6===u.length&&(s.needsUpdate=!0)):(s=u&&u.data?new Qa(u.data,u.width,u.height):new fr(u),u&&(s.needsUpdate=!0)),s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=n(o.mapping,id)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=n(o.wrap[0],ad),s.wrapT=n(o.wrap[1],ad)),void 0!==o.format&&(s.format=o.format),void 0!==o.type&&(s.type=o.type),void 0!==o.encoding&&(s.encoding=o.encoding),void 0!==o.minFilter&&(s.minFilter=n(o.minFilter,od)),void 0!==o.magFilter&&(s.magFilter=n(o.magFilter,od)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(s.unpackAlignment=o.unpackAlignment),r[o.uuid]=s}return r}},{key:"parseObject",value:function(e,t,n,r){var i,a,o;function s(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function u(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var a=e[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),t.push(n[a])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":i=new mu,void 0!==e.background&&Number.isInteger(e.background)&&(i.background=new Oi(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?i.fog=new Au(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(i.fog=new pu(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":i=new Da(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(i.focus=e.focus),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.filmGauge&&(i.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(i.filmOffset=e.filmOffset),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"OrthographicCamera":i=new Dg(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"AmbientLight":i=new Og(e.color,e.intensity);break;case"DirectionalLight":i=new Ug(e.color,e.intensity);break;case"PointLight":i=new Kg(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":i=new Jg(e.color,e.intensity,e.width,e.height);break;case"SpotLight":i=new Lg(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":i=new kg(e.color,e.groundColor,e.intensity);break;case"LightProbe":i=(new jg).fromJSON(e);break;case"SkinnedMesh":a=s(e.geometry),o=u(e.material),i=new Uu(a,o),void 0!==e.bindMode&&(i.bindMode=e.bindMode),void 0!==e.bindMatrix&&i.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(i.skeleton=e.skeleton);break;case"Mesh":a=s(e.geometry),o=u(e.material),i=new Xa(a,o);break;case"InstancedMesh":a=s(e.geometry),o=u(e.material);var l=e.count,c=e.instanceMatrix,g=e.instanceColor;(i=new nl(a,o,l)).instanceMatrix=new qi(new Float32Array(c.array),16),void 0!==g&&(i.instanceColor=new qi(new Float32Array(g.array),g.itemSize));break;case"LOD":i=new Nu;break;case"Line":i=new ll(s(e.geometry),u(e.material));break;case"LineLoop":i=new Il(s(e.geometry),u(e.material));break;case"LineSegments":i=new dl(s(e.geometry),u(e.material));break;case"PointCloud":case"Points":i=new ml(s(e.geometry),u(e.material));break;case"Sprite":i=new Xu(u(e.material));break;case"Group":i=new cu;break;case"Bone":i=new Ou;break;default:i=new Gi}if(i.uuid=e.uuid,void 0!==e.name&&(i.name=e.name),void 0!==e.matrix?(i.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(i.matrixAutoUpdate=e.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(void 0!==e.position&&i.position.fromArray(e.position),void 0!==e.rotation&&i.rotation.fromArray(e.rotation),void 0!==e.quaternion&&i.quaternion.fromArray(e.quaternion),void 0!==e.scale&&i.scale.fromArray(e.scale)),void 0!==e.castShadow&&(i.castShadow=e.castShadow),void 0!==e.receiveShadow&&(i.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(i.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(i.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(i.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&i.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(i.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.frustumCulled&&(i.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(i.renderOrder=e.renderOrder),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.layers&&(i.layers.mask=e.layers),void 0!==e.children)for(var d=e.children,I=0;I<d.length;I++)i.add(this.parseObject(d[I],t,n,r));if(void 0!==e.animations)for(var C=e.animations,h=0;h<C.length;h++){var f=C[h];i.animations.push(r[f])}if("LOD"===e.type){void 0!==e.autoUpdate&&(i.autoUpdate=e.autoUpdate);for(var p=e.levels,A=0;A<p.length;A++){var m=p[A],v=i.getObjectByProperty("uuid",m.object);void 0!==v&&i.addLevel(v,m.distance)}}return i}},{key:"bindSkeletons",value:function(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){var n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}},{key:"setTexturePath",value:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}]),n}(eg),id={UVMapping:me,CubeReflectionMapping:ve,CubeRefractionMapping:be,EquirectangularReflectionMapping:ye,EquirectangularRefractionMapping:Be,CubeUVReflectionMapping:Ge,CubeUVRefractionMapping:Ze},ad={RepeatWrapping:we,ClampToEdgeWrapping:_e,MirroredRepeatWrapping:xe},od={NearestFilter:Se,NearestMipmapNearestFilter:Re,NearestMipmapLinearFilter:We,LinearFilter:Ve,LinearMipmapNearestFilter:Fe,LinearMipmapLinearFilter:Xe},sd=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),r=t.call(this,e),"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),r.options={premultiplyAlpha:"none"},r}return(0,h.Z)(n,[{key:"setOptions",value:function(e){return this.options=e,this}},{key:"load",value:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=jc.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){jc.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}}]),n}(eg);sd.prototype.isImageBitmapLoader=!0;var ud=function(){function e(){(0,C.Z)(this,e),this.type="ShapePath",this.color=new Oi,this.subPaths=[],this.currentPath=null}return(0,h.Z)(e,[{key:"moveTo",value:function(e,t){return this.currentPath=new Rg,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}},{key:"lineTo",value:function(e,t){return this.currentPath.lineTo(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this}},{key:"splineThru",value:function(e){return this.currentPath.splineThru(e),this}},{key:"toShapes",value:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],a=new Mg;a.curves=i.curves,t.push(a)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=t[i],s=t[a],u=s.x-o.x,l=s.y-o.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(o=t[a],u=-u,s=t[i],l=-l),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var c=l*(e.x-o.x)-u*(e.y-o.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var i,a,o,s=oc.isClockWise,u=this.subPaths;if(0===u.length)return[];if(!0===t)return n(u);var l=[];if(1===u.length)return a=u[0],(o=new Mg).curves=a.curves,l.push(o),l;var c=!s(u[0].getPoints());c=e?!c:c;var g,d,I=[],C=[],h=[],f=0;C[f]=void 0,h[f]=[];for(var p=0,A=u.length;p<A;p++)i=s(g=(a=u[p]).getPoints()),(i=e?!i:i)?(!c&&C[f]&&f++,C[f]={s:new Mg,p:g},C[f].s.curves=a.curves,c&&f++,h[f]=[]):h[f].push({h:a,p:g[0]});if(!C[0])return n(u);if(C.length>1){for(var m=!1,v=[],b=0,y=C.length;b<y;b++)I[b]=[];for(var B=0,G=C.length;B<G;B++)for(var Z=h[B],w=0;w<Z.length;w++){for(var _=Z[w],x=!0,S=0;S<C.length;S++)r(_.p,C[S].p)&&(B!==S&&v.push({froms:B,tos:S,hole:w}),x?(x=!1,I[S].push(_)):m=!0);x&&I[B].push(_)}v.length>0&&(m||(h=I))}for(var R=0,M=C.length;R<M;R++){o=C[R].s,l.push(o);for(var W=0,k=(d=h[R]).length;W<k;W++)o.holes.push(d[W].h)}return l}}]),e}(),ld=function(){function e(t){(0,C.Z)(this,e),this.type="Font",this.data=t}return(0,h.Z)(e,[{key:"generateShapes",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=[],r=cd(e,t,this.data),i=0,a=r.length;i<a;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}]),e}();function cd(e,t,n){for(var r=Array.from(e),i=t/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,o=[],s=0,u=0,l=0;l<r.length;l++){var c=r[l];if("\n"===c)s=0,u-=a;else{var g=gd(c,i,s,u,n);s+=g.offsetX,o.push(g.path)}}return o}function gd(e,t,n,r,i){var a=i.glyphs[e]||i.glyphs["?"];if(a){var o,s,u,l,c,g,d,I,C=new ud;if(a.o)for(var h=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),f=0,p=h.length;f<p;){switch(h[f++]){case"m":o=h[f++]*t+n,s=h[f++]*t+r,C.moveTo(o,s);break;case"l":o=h[f++]*t+n,s=h[f++]*t+r,C.lineTo(o,s);break;case"q":u=h[f++]*t+n,l=h[f++]*t+r,c=h[f++]*t+n,g=h[f++]*t+r,C.quadraticCurveTo(c,g,u,l);break;case"b":u=h[f++]*t+n,l=h[f++]*t+r,c=h[f++]*t+n,g=h[f++]*t+r,d=h[f++]*t+n,I=h[f++]*t+r,C.bezierCurveTo(c,g,d,I,u,l)}}return{offsetX:a.ha*t,path:C}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".")}ld.prototype.isFont=!0;var dd,Id=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){return(0,C.Z)(this,n),t.call(this,e)}return(0,h.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new ng(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(a){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var r=i.parse(n);t&&t(r)}),n,r)}},{key:"parse",value:function(e){return new ld(e)}}]),n}(eg),Cd={getContext:function(){return void 0===dd&&(dd=new(window.AudioContext||window.webkitAudioContext)),dd},setContext:function(e){dd=e}},hd=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){return(0,C.Z)(this,n),t.call(this,e)}return(0,h.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new ng(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{var a=n.slice(0);Cd.getContext().decodeAudioData(a,(function(e){t(e)}))}catch(o){r?r(o):console.error(o),i.manager.itemError(e)}}),n,r)}}]),n}(eg),fd=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;(0,C.Z)(this,n),i=t.call(this,void 0,a);var o=(new Oi).set(e),s=(new Oi).set(r),u=new yr(o.r,o.g,o.b),l=new yr(s.r,s.g,s.b),c=Math.sqrt(Math.PI),g=c*Math.sqrt(.75);return i.sh.coefficients[0].copy(u).add(l).multiplyScalar(c),i.sh.coefficients[1].copy(u).sub(l).multiplyScalar(g),i}return(0,h.Z)(n)}(jg);fd.prototype.isHemisphereLightProbe=!0;var pd=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,C.Z)(this,n),r=t.call(this,void 0,i);var a=(new Oi).set(e);return r.sh.coefficients[0].set(a.r,a.g,a.b).multiplyScalar(2*Math.sqrt(Math.PI)),r}return(0,h.Z)(n)}(jg);pd.prototype.isAmbientLightProbe=!0;var Ad=new $r,md=new $r,vd=function(){function e(){(0,C.Z)(this,e),this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Da,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Da,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}return(0,h.Z)(e,[{key:"update",value:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var n,r,i=e.projectionMatrix.clone(),a=t.eyeSep/2,o=a*t.near/t.focus,s=t.near*Math.tan(tr*t.fov*.5)/t.zoom;md.elements[12]=-a,Ad.elements[12]=a,n=-s*t.aspect+o,r=s*t.aspect+o,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*t.aspect-o,r=s*t.aspect-o,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(md),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Ad)}}]),e}(),bd=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,C.Z)(this,e),this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return(0,h.Z)(e,[{key:"start",value:function(){this.startTime=yd(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=yd();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}]),e}();function yd(){return("undefined"===typeof performance?Date:performance).now()}var Bd=new yr,Gd=new br,Zd=new yr,wd=new yr,_d=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e;return(0,C.Z)(this,n),(e=t.call(this)).type="AudioListener",e.context=Cd.getContext(),e.gain=e.context.createGain(),e.gain.connect(e.context.destination),e.filter=null,e.timeDelta=0,e._clock=new bd,e}return(0,h.Z)(n,[{key:"getInput",value:function(){return this.gain}},{key:"removeFilter",value:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}},{key:"getFilter",value:function(){return this.filter}},{key:"setFilter",value:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}},{key:"getMasterVolume",value:function(){return this.gain.gain.value}},{key:"setMasterVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}},{key:"updateMatrixWorld",value:function(e){(0,l.Z)((0,c.Z)(n.prototype),"updateMatrixWorld",this).call(this,e);var t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Bd,Gd,Zd),wd.set(0,0,-1).applyQuaternion(Gd),t.positionX){var i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Bd.x,i),t.positionY.linearRampToValueAtTime(Bd.y,i),t.positionZ.linearRampToValueAtTime(Bd.z,i),t.forwardX.linearRampToValueAtTime(wd.x,i),t.forwardY.linearRampToValueAtTime(wd.y,i),t.forwardZ.linearRampToValueAtTime(wd.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(Bd.x,Bd.y,Bd.z),t.setOrientation(wd.x,wd.y,wd.z,r.x,r.y,r.z)}}]),n}(Gi),xd=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).type="Audio",r.listener=e,r.context=e.context,r.gain=r.context.createGain(),r.gain.connect(e.getInput()),r.autoplay=!1,r.buffer=null,r.detune=0,r.loop=!1,r.loopStart=0,r.loopEnd=0,r.offset=0,r.duration=void 0,r.playbackRate=1,r.isPlaying=!1,r.hasPlaybackControl=!0,r.source=null,r.sourceType="empty",r._startedAt=0,r._progress=0,r._connected=!1,r.filters=[],r}return(0,h.Z)(n,[{key:"getOutput",value:function(){return this.gain}},{key:"setNodeSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}},{key:"setMediaElementSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}},{key:"setMediaStreamSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}},{key:"setBuffer",value:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")}},{key:"pause",value:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"stop",value:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"connect",value:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}},{key:"disconnect",value:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}},{key:"getFilters",value:function(){return this.filters}},{key:"setFilters",value:function(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}},{key:"setDetune",value:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}},{key:"getDetune",value:function(){return this.detune}},{key:"getFilter",value:function(){return this.getFilters()[0]}},{key:"setFilter",value:function(e){return this.setFilters(e?[e]:[])}},{key:"setPlaybackRate",value:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"onEnded",value:function(){this.isPlaying=!1}},{key:"getLoop",value:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}},{key:"setLoop",value:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"setLoopStart",value:function(e){return this.loopStart=e,this}},{key:"setLoopEnd",value:function(e){return this.loopEnd=e,this}},{key:"getVolume",value:function(){return this.gain.gain.value}},{key:"setVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}]),n}(Gi),Sd=new yr,Rd=new br,Md=new yr,Wd=new yr,kd=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this,e)).panner=r.context.createPanner(),r.panner.panningModel="HRTF",r.panner.connect(r.gain),r}return(0,h.Z)(n,[{key:"getOutput",value:function(){return this.panner}},{key:"getRefDistance",value:function(){return this.panner.refDistance}},{key:"setRefDistance",value:function(e){return this.panner.refDistance=e,this}},{key:"getRolloffFactor",value:function(){return this.panner.rolloffFactor}},{key:"setRolloffFactor",value:function(e){return this.panner.rolloffFactor=e,this}},{key:"getDistanceModel",value:function(){return this.panner.distanceModel}},{key:"setDistanceModel",value:function(e){return this.panner.distanceModel=e,this}},{key:"getMaxDistance",value:function(){return this.panner.maxDistance}},{key:"setMaxDistance",value:function(e){return this.panner.maxDistance=e,this}},{key:"setDirectionalCone",value:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}},{key:"updateMatrixWorld",value:function(e){if((0,l.Z)((0,c.Z)(n.prototype),"updateMatrixWorld",this).call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(Sd,Rd,Md),Wd.set(0,0,1).applyQuaternion(Rd);var t=this.panner;if(t.positionX){var r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Sd.x,r),t.positionY.linearRampToValueAtTime(Sd.y,r),t.positionZ.linearRampToValueAtTime(Sd.z,r),t.orientationX.linearRampToValueAtTime(Wd.x,r),t.orientationY.linearRampToValueAtTime(Wd.y,r),t.orientationZ.linearRampToValueAtTime(Wd.z,r)}else t.setPosition(Sd.x,Sd.y,Sd.z),t.setOrientation(Wd.x,Wd.y,Wd.z)}}}]),n}(xd),Vd=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;(0,C.Z)(this,e),this.analyser=t.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}return(0,h.Z)(e,[{key:"getFrequencyData",value:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},{key:"getAverageFrequency",value:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}]),e}(),Fd=function(){function e(t,n,r){var i,a,o;switch((0,C.Z)(this,e),this.binding=t,this.valueSize=r,n){case"quaternion":i=this._slerp,a=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":i=this._select,a=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:i=this._lerp,a=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=a,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}return(0,h.Z)(e,[{key:"accumulate",value:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a}},{key:"accumulateAdditive",value:function(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}},{key:"apply",value:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){var s=t*this._origIndex;this._mixBufferRegion(n,r,s,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(var u=t,l=t+t;u!==l;++u)if(n[u]!==n[u+t]){o.setValue(n,r);break}}},{key:"saveOriginalState",value:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(var i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}},{key:"restoreOriginalState",value:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)}},{key:"_setAdditiveIdentityNumeric",value:function(){for(var e=this._addIndex*this.valueSize,t=e+this.valueSize,n=e;n<t;n++)this.buffer[n]=0}},{key:"_setAdditiveIdentityQuaternion",value:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}},{key:"_setAdditiveIdentityOther",value:function(){for(var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}},{key:"_select",value:function(e,t,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)e[t+a]=e[n+a]}},{key:"_slerp",value:function(e,t,n,r){br.slerpFlat(e,t,e,t,e,n,r)}},{key:"_slerpAdditive",value:function(e,t,n,r,i){var a=this._workIndex*i;br.multiplyQuaternionsFlat(e,a,e,t,e,n),br.slerpFlat(e,t,e,t,e,a,r)}},{key:"_lerp",value:function(e,t,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=t+o;e[s]=e[s]*a+e[n+o]*r}}},{key:"_lerpAdditive",value:function(e,t,n,r,i){for(var a=0;a!==i;++a){var o=t+a;e[o]=e[o]+e[n+a]*r}}}]),e}(),Ed="\\[\\]\\.:\\/",Xd=new RegExp("[\\[\\]\\.:\\/]","g"),Hd="[^\\[\\]\\.:\\/]",Ld="[^"+Ed.replace("\\.","")+"]",zd=/((?:WC+[\/:])*)/.source.replace("WC",Hd),Nd=/(WCOD+)?/.source.replace("WCOD",Ld),Yd=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Hd),Td=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Hd),Kd=new RegExp("^"+zd+Nd+Yd+Td+"$"),Dd=["material","materials","bones"],Pd=function(){function e(t,n,r){(0,C.Z)(this,e);var i=r||Ud.parseTrackName(n);this._targetGroup=t,this._bindings=t.subscribe_(n,i)}return(0,h.Z)(e,[{key:"getValue",value:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}},{key:"setValue",value:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}},{key:"bind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}},{key:"unbind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}]),e}(),Ud=function(){function e(t,n,r){(0,C.Z)(this,e),this.path=n,this.parsedPath=r||e.parseTrackName(n),this.node=e.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}return(0,h.Z)(e,[{key:"_getValue_unavailable",value:function(){}},{key:"_setValue_unavailable",value:function(){}},{key:"_getValue_direct",value:function(e,t){e[t]=this.node[this.propertyName]}},{key:"_getValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]}},{key:"_getValue_arrayElement",value:function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}},{key:"_getValue_toArray",value:function(e,t){this.resolvedProperty.toArray(e,t)}},{key:"_setValue_direct",value:function(e,t){this.targetObject[this.propertyName]=e[t]}},{key:"_setValue_direct_setNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_direct_setMatrixWorldNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]}},{key:"_setValue_array_setNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}},{key:"_setValue_array_setMatrixWorldNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_arrayElement",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}},{key:"_setValue_arrayElement_setNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_arrayElement_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_fromArray",value:function(e,t){this.resolvedProperty.fromArray(e,t)}},{key:"_setValue_fromArray_setNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}},{key:"_setValue_fromArray_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_getValue_unbound",value:function(e,t){this.bind(),this.getValue(e,t)}},{key:"_setValue_unbound",value:function(e,t){this.bind(),this.setValue(e,t)}},{key:"bind",value:function(){var t=this.node,n=this.parsedPath,r=n.objectName,i=n.propertyName,a=n.propertyIndex;if(t||(t=e.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var o=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===o){o=s;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var u=t[i];if(void 0!==u){var l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[a]&&(a=t.morphTargetDictionary[a])}c=this.BindingType.ArrayElement,this.resolvedProperty=u,this.propertyIndex=a}else void 0!==u.fromArray&&void 0!==u.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(c=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=i;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else{var g=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+g+"."+i+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")}},{key:"unbind",value:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}],[{key:"create",value:function(t,n,r){return t&&t.isAnimationObjectGroup?new e.Composite(t,n,r):new e(t,n,r)}},{key:"sanitizeNodeName",value:function(e){return e.replace(/\s/g,"_").replace(Xd,"")}},{key:"parseTrackName",value:function(e){var t=Kd.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Dd.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}},{key:"findNode",value:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===t||i.uuid===t)return i;var a=e(i.children);if(a)return a}return null}(e.children);if(r)return r}return null}}]),e}();Ud.Composite=Pd,Ud.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Ud.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Ud.prototype.GetterByBindingType=[Ud.prototype._getValue_direct,Ud.prototype._getValue_array,Ud.prototype._getValue_arrayElement,Ud.prototype._getValue_toArray],Ud.prototype.SetterByBindingTypeAndVersioning=[[Ud.prototype._setValue_direct,Ud.prototype._setValue_direct_setNeedsUpdate,Ud.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ud.prototype._setValue_array,Ud.prototype._setValue_array_setNeedsUpdate,Ud.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ud.prototype._setValue_arrayElement,Ud.prototype._setValue_arrayElement_setNeedsUpdate,Ud.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ud.prototype._setValue_fromArray,Ud.prototype._setValue_fromArray_setNeedsUpdate,Ud.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var Od=function(){function e(){(0,C.Z)(this,e),this.uuid=rr(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}return(0,h.Z)(e,[{key:"add",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,a=i.length,o=void 0,s=e.length,u=this.nCachedObjects_,l=0,c=arguments.length;l!==c;++l){var g=arguments[l],d=g.uuid,I=t[d];if(void 0===I){I=s++,t[d]=I,e.push(g);for(var C=0,h=a;C!==h;++C)i[C].push(new Ud(g,n[C],r[C]))}else if(I<u){o=e[I];var f=--u,p=e[f];t[p.uuid]=I,e[I]=p,t[d]=f,e[f]=g;for(var A=0,m=a;A!==m;++A){var v=i[A],b=v[f],y=v[I];v[I]=b,void 0===y&&(y=new Ud(g,n[A],r[A])),v[f]=y}}else e[I]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}},{key:"remove",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],u=s.uuid,l=t[u];if(void 0!==l&&l>=i){var c=i++,g=e[c];t[g.uuid]=l,e[l]=g,t[u]=c,e[c]=s;for(var d=0,I=r;d!==I;++d){var C=n[d],h=C[c],f=C[l];C[l]=h,C[c]=f}}}this.nCachedObjects_=i}},{key:"uncache",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=e.length,o=0,s=arguments.length;o!==s;++o){var u=arguments[o],l=u.uuid,c=t[l];if(void 0!==c)if(delete t[l],c<i){var g=--i,d=e[g],I=--a,C=e[I];t[d.uuid]=c,e[c]=d,t[C.uuid]=g,e[g]=C,e.pop();for(var h=0,f=r;h!==f;++h){var p=n[h],A=p[g],m=p[I];p[c]=A,p[g]=m,p.pop()}}else{var v=--a,b=e[v];v>0&&(t[b.uuid]=c),e[c]=b,e.pop();for(var y=0,B=r;y!==B;++y){var G=n[y];G[c]=G[v],G.pop()}}}this.nCachedObjects_=i}},{key:"subscribe_",value:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,u=s.length,l=this.nCachedObjects_,c=new Array(u);r=i.length,n[e]=r,a.push(e),o.push(t),i.push(c);for(var g=l,d=s.length;g!==d;++g){var I=s[g];c[g]=new Ud(I,e,t)}return c}},{key:"unsubscribe_",value:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}]),e}();Od.prototype.isAnimationObjectGroup=!0;var Jd=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.blendMode;(0,C.Z)(this,e),this._mixer=t,this._clip=n,this._localRoot=r,this.blendMode=i;for(var a=n.tracks,o=a.length,s=new Array(o),u={endingStart:rn,endingEnd:rn},l=0;l!==o;++l){var c=a[l].createInterpolant(null);s[l]=c,c.settings=u}this._interpolantSettings=u,this._interpolants=s,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}return(0,h.Z)(e,[{key:"play",value:function(){return this._mixer._activateAction(this),this}},{key:"stop",value:function(){return this._mixer._deactivateAction(this),this.reset()}},{key:"reset",value:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}},{key:"isRunning",value:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}},{key:"isScheduled",value:function(){return this._mixer._isActiveAction(this)}},{key:"startAt",value:function(e){return this._startTime=e,this}},{key:"setLoop",value:function(e,t){return this.loop=e,this.repetitions=t,this}},{key:"setEffectiveWeight",value:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}},{key:"getEffectiveWeight",value:function(){return this._effectiveWeight}},{key:"fadeIn",value:function(e){return this._scheduleFading(e,0,1)}},{key:"fadeOut",value:function(e){return this._scheduleFading(e,1,0)}},{key:"crossFadeFrom",value:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,a=i/r,o=r/i;e.warp(1,a,t),this.warp(o,1,t)}return this}},{key:"crossFadeTo",value:function(e,t,n){return e.crossFadeFrom(this,t,n)}},{key:"stopFading",value:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"setEffectiveTimeScale",value:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}},{key:"getEffectiveTimeScale",value:function(){return this._effectiveTimeScale}},{key:"setDuration",value:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}},{key:"syncWith",value:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}},{key:"halt",value:function(e){return this.warp(this._effectiveTimeScale,0,e)}},{key:"warp",value:function(e,t,n){var r=this._mixer,i=r.time,a=this.timeScale,o=this._timeScaleInterpolant;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,u=o.sampleValues;return s[0]=i,s[1]=i+n,u[0]=e/a,u[1]=t/a,this}},{key:"stopWarping",value:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"getMixer",value:function(){return this._mixer}},{key:"getClip",value:function(){return this._clip}},{key:"getRoot",value:function(){return this._localRoot||this._mixer._root}},{key:"_update",value:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(e-i)*n;if(a<0||0===n)return;this._startTime=null,t=n*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0){var u=this._interpolants,l=this._propertyBindings;if(this.blendMode===un)for(var c=0,g=u.length;c!==g;++c)u[c].evaluate(o),l[c].accumulateAdditive(s);else for(var d=0,I=u.length;d!==I;++d)u[d].evaluate(o),l[d].accumulate(r,s)}}else this._updateWeight(e)}},{key:"_updateWeight",value:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}},{key:"_updateTimeScale",value:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t}},{key:"_updateTime",value:function(e){var t=this._clip.duration,n=this.loop,r=this.time+e,i=this._loopCount,a=n===$t;if(0===e)return-1===i?r:a&&1===(1&i)?t-r:r;if(n===jt){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=t||r<0){var o=Math.floor(r/t);r-=t*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var u=e<0;this._setEndings(u,!u,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&1===(1&i))return t-r}return r}},{key:"_setEndings",value:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=an,r.endingEnd=an):(r.endingStart=e?this.zeroSlopeAtStart?an:rn:on,r.endingEnd=t?this.zeroSlopeAtEnd?an:rn:on)}},{key:"_scheduleFading",value:function(e,t,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this}}]),e}(),Qd=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this))._root=e,r._initMemoryManager(),r._accuIndex=0,r.time=0,r.timeScale=1,r}return(0,h.Z)(n,[{key:"_bindAction",value:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,u=this._bindingsByRootAndName,l=u[s];void 0===l&&(l={},u[s]=l);for(var c=0;c!==i;++c){var g=r[c],d=g.name,I=l[d];if(void 0!==I)a[c]=I;else{if(void 0!==(I=a[c])){null===I._cacheIndex&&(++I.referenceCount,this._addInactiveBinding(I,s,d));continue}var C=t&&t._propertyBindings[c].binding.parsedPath;++(I=new Fd(Ud.create(n,d,C),g.ValueTypeName,g.getValueSize())).referenceCount,this._addInactiveBinding(I,s,d),a[c]=I}o[c].resultBuffer=I.buffer}}},{key:"_activateAction",value:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0===s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}},{key:"_deactivateAction",value:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0===--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}},{key:"_initMemoryManager",value:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}},{key:"_isActiveAction",value:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions}},{key:"_addInactiveAction",value:function(e,t,n){var r=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}},{key:"_removeInactiveAction",value:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,u=s[s.length-1],l=e._byClipCacheIndex;u._byClipCacheIndex=l,s[l]=u,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)}},{key:"_removeInactiveBindingsForAction",value:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0===--i.referenceCount&&this._removeInactiveBinding(i)}}},{key:"_lendAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_takeBackAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_addInactiveBinding",value:function(e,t,n){var r=this._bindingsByRootAndName,i=this._bindings,a=r[t];void 0===a&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)}},{key:"_removeInactiveBinding",value:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=t[t.length-1],u=e._cacheIndex;s._cacheIndex=u,t[u]=s,t.pop(),delete o[i],0===Object.keys(o).length&&delete a[r]}},{key:"_lendBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_takeBackBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_lendControlInterpolant",value:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new Lc(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n}},{key:"_takeBackControlInterpolant",value:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}},{key:"clipAction",value:function(e,t,n){var r=t||this._root,i=r.uuid,a="string"===typeof e?Jc.findByName(r,e):e,o=null!==a?a.uuid:e,s=this._actionsByClip[o],u=null;if(void 0===n&&(n=null!==a?a.blendMode:sn),void 0!==s){var l=s.actionByRoot[i];if(void 0!==l&&l.blendMode===n)return l;u=s.knownActions[0],null===a&&(a=u._clip)}if(null===a)return null;var c=new Jd(this,a,t,n);return this._bindAction(c,u),this._addInactiveAction(c,o,i),c}},{key:"existingAction",value:function(e,t){var n=t||this._root,r=n.uuid,i="string"===typeof e?Jc.findByName(n,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null}},{key:"stopAllAction",value:function(){for(var e=this._actions,t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}},{key:"update",value:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1,o=0;o!==n;++o){t[o]._update(r,e,i,a)}for(var s=this._bindings,u=this._nActiveBindings,l=0;l!==u;++l)s[l].apply(a);return this}},{key:"setTime",value:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}},{key:"getRoot",value:function(){return this._root}},{key:"uncacheClip",value:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var u=a[o];this._deactivateAction(u);var l=u._cacheIndex,c=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,c._cacheIndex=l,t[l]=c,t.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}}},{key:"uncacheRoot",value:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}}},{key:"uncacheAction",value:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}]),n}(jn);Qd.prototype._controlInterpolantsResultBuffer=new Float32Array(1);var jd=function(){function e(t){(0,C.Z)(this,e),"string"===typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}return(0,h.Z)(e,[{key:"clone",value:function(){return new e(void 0===this.value.clone?this.value:this.value.clone())}}]),e}(),qd=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,C.Z)(this,n),(i=t.call(this,e,r)).meshPerAttribute=a||1,i}return(0,h.Z)(n,[{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"clone",value:function(e){var t=(0,l.Z)((0,c.Z)(n.prototype),"clone",this).call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t}},{key:"toJSON",value:function(e){var t=(0,l.Z)((0,c.Z)(n.prototype),"toJSON",this).call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}]),n}(vu);qd.prototype.isInstancedInterleavedBuffer=!0;var $d=function(){function e(t,n,r,i,a){(0,C.Z)(this,e),this.buffer=t,this.type=n,this.itemSize=r,this.elementSize=i,this.count=a,this.version=0}return(0,h.Z)(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setBuffer",value:function(e){return this.buffer=e,this}},{key:"setType",value:function(e,t){return this.type=e,this.elementSize=t,this}},{key:"setItemSize",value:function(e){return this.itemSize=e,this}},{key:"setCount",value:function(e){return this.count=e,this}}]),e}();$d.prototype.isGLBufferAttribute=!0;var eI=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;(0,C.Z)(this,e),this.ray=new qr(t,n),this.near=r,this.far=i,this.camera=null,this.layers=new ci,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}return(0,h.Z)(e,[{key:"set",value:function(e,t){this.ray.set(e,t)}},{key:"setFromCamera",value:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}},{key:"intersectObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return nI(e,this,n,t),n.sort(tI),n}},{key:"intersectObjects",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=0,i=e.length;r<i;r++)nI(e[r],this,n,t);return n.sort(tI),n}}]),e}();function tI(e,t){return e.distance-t.distance}function nI(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var i=e.children,a=0,o=i.length;a<o;a++)nI(i[a],t,n,!0)}var rI=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,C.Z)(this,e),this.radius=t,this.phi=n,this.theta=r,this}return(0,h.Z)(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}},{key:"makeSafe",value:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(ir(t/this.radius,-1,1))),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),iI=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,C.Z)(this,e),this.radius=t,this.theta=n,this.y=r,this}return(0,h.Z)(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),aI=new gr,oI=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new gr(1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gr(-1/0,-1/0);(0,C.Z)(this,e),this.min=t,this.max=n}return(0,h.Z)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=aI.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new gr),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new gr),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}},{key:"getParameter",value:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new gr),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}},{key:"clampPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new gr),t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return aI.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();oI.prototype.isBox2=!0;var sI=new yr,uI=new yr,lI=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yr;(0,C.Z)(this,e),this.start=t,this.end=n}return(0,h.Z)(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new yr),e.addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new yr),e.subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new yr),this.delta(t).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){sI.subVectors(e,this.start),uI.subVectors(this.end,this.start);var n=uI.dot(uI),r=uI.dot(sI)/n;return t&&(r=ir(r,0,1)),r}},{key:"closestPointToPoint",value:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new yr),this.delta(n).multiplyScalar(r).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),cI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;return(0,C.Z)(this,n),(r=t.call(this)).material=e,r.render=function(){},r.hasPositions=!1,r.hasNormals=!1,r.hasColors=!1,r.hasUvs=!1,r.positionArray=null,r.normalArray=null,r.colorArray=null,r.uvArray=null,r.count=0,r}return(0,h.Z)(n)}(Gi);cI.prototype.isImmediateRenderObject=!0;var gI=new yr,dI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var i;(0,C.Z)(this,n),(i=t.call(this)).light=e,i.light.updateMatrixWorld(),i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=r;for(var a=new ma,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],s=0,u=1;s<32;s++,u++){var l=s/32*Math.PI*2,c=u/32*Math.PI*2;o.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}a.setAttribute("position",new sa(o,3));var g=new rl({fog:!1,toneMapped:!1});return i.cone=new dl(a,g),i.add(i.cone),i.update(),i}return(0,h.Z)(n,[{key:"dispose",value:function(){this.cone.geometry.dispose(),this.cone.material.dispose()}},{key:"update",value:function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),gI.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(gI),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}]),n}(Gi),II=new yr,CI=new $r,hI=new $r,fI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;(0,C.Z)(this,n);for(var i=pI(e),a=new ma,o=[],s=[],u=new Oi(0,0,1),l=new Oi(0,1,0),c=0;c<i.length;c++){var g=i[c];g.parent&&g.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),s.push(u.r,u.g,u.b),s.push(l.r,l.g,l.b))}a.setAttribute("position",new sa(o,3)),a.setAttribute("color",new sa(s,3));var d=new rl({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(r=t.call(this,a,d)).type="SkeletonHelper",r.isSkeletonHelper=!0,r.root=e,r.bones=i,r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r}return(0,h.Z)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.bones,r=this.geometry,i=r.getAttribute("position");hI.copy(this.root.matrixWorld).invert();for(var a=0,o=0;a<t.length;a++){var s=t[a];s.parent&&s.parent.isBone&&(CI.multiplyMatrices(hI,s.matrixWorld),II.setFromMatrixPosition(CI),i.setXYZ(o,II.x,II.y,II.z),CI.multiplyMatrices(hI,s.parent.matrixWorld),II.setFromMatrixPosition(CI),i.setXYZ(o+1,II.x,II.y,II.z),o+=2)}r.getAttribute("position").needsUpdate=!0,(0,l.Z)((0,c.Z)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(dl);function pI(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,pI(e.children[n]));return t}var AI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){var a;(0,C.Z)(this,n);var o=new pc(r,4,2),s=new Ji({wireframe:!0,fog:!1,toneMapped:!1});return(a=t.call(this,o,s)).light=e,a.light.updateMatrixWorld(),a.color=i,a.type="PointLightHelper",a.matrix=a.light.matrixWorld,a.matrixAutoUpdate=!1,a.update(),a}return(0,h.Z)(n,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}},{key:"update",value:function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}]),n}(Xa),mI=new yr,vI=new Oi,bI=new Oi,yI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){var a;(0,C.Z)(this,n),(a=t.call(this)).light=e,a.light.updateMatrixWorld(),a.matrix=e.matrixWorld,a.matrixAutoUpdate=!1,a.color=i;var o=new Ic(r);o.rotateY(.5*Math.PI),a.material=new Ji({wireframe:!0,fog:!1,toneMapped:!1}),void 0===a.color&&(a.material.vertexColors=!0);var s=o.getAttribute("position"),u=new Float32Array(3*s.count);return o.setAttribute("color",new qi(u,3)),a.add(new Xa(o,a.material)),a.update(),a}return(0,h.Z)(n,[{key:"dispose",value:function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}},{key:"update",value:function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");vI.copy(this.light.color),bI.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?vI:bI;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(mI.setFromMatrixPosition(this.light.matrixWorld).negate())}}]),n}(Gi),BI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;(0,C.Z)(this,n),a=new Oi(a),o=new Oi(o);for(var s=i/2,u=r/i,l=r/2,c=[],g=[],d=0,I=0,h=-l;d<=i;d++,h+=u){c.push(-l,0,h,l,0,h),c.push(h,0,-l,h,0,l);var f=d===s?a:o;f.toArray(g,I),I+=3,f.toArray(g,I),I+=3,f.toArray(g,I),I+=3,f.toArray(g,I),I+=3}var p=new ma;p.setAttribute("position",new sa(c,3)),p.setAttribute("color",new sa(g,3));var A=new rl({vertexColors:!0,toneMapped:!1});return(e=t.call(this,p,A)).type="GridHelper",e}return(0,h.Z)(n)}(dl),GI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;(0,C.Z)(this,n),s=new Oi(s),u=new Oi(u);for(var l=[],c=[],g=0;g<=i;g++){var d=g/i*(2*Math.PI),I=Math.sin(d)*r,h=Math.cos(d)*r;l.push(0,0,0),l.push(I,0,h);var f=1&g?s:u;c.push(f.r,f.g,f.b),c.push(f.r,f.g,f.b)}for(var p=0;p<=a;p++)for(var A=1&p?s:u,m=r-r/a*p,v=0;v<o;v++){var b=v/o*(2*Math.PI),y=Math.sin(b)*m,B=Math.cos(b)*m;l.push(y,0,B),c.push(A.r,A.g,A.b),b=(v+1)/o*(2*Math.PI),y=Math.sin(b)*m,B=Math.cos(b)*m,l.push(y,0,B),c.push(A.r,A.g,A.b)}var G=new ma;G.setAttribute("position",new sa(l,3)),G.setAttribute("color",new sa(c,3));var Z=new rl({vertexColors:!0,toneMapped:!1});return(e=t.call(this,G,Z)).type="PolarGridHelper",e}return(0,h.Z)(n)}(dl),ZI=new yr,wI=new yr,_I=new yr,xI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e,r,i){var a;(0,C.Z)(this,n),(a=t.call(this)).light=e,a.light.updateMatrixWorld(),a.matrix=e.matrixWorld,a.matrixAutoUpdate=!1,a.color=i,void 0===r&&(r=1);var o=new ma;o.setAttribute("position",new sa([-r,r,0,r,r,0,r,-r,0,-r,-r,0,-r,r,0],3));var s=new rl({fog:!1,toneMapped:!1});return a.lightPlane=new ll(o,s),a.add(a.lightPlane),(o=new ma).setAttribute("position",new sa([0,0,0,0,0,1],3)),a.targetLine=new ll(o,s),a.add(a.targetLine),a.update(),a}return(0,h.Z)(n,[{key:"dispose",value:function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}},{key:"update",value:function(){ZI.setFromMatrixPosition(this.light.matrixWorld),wI.setFromMatrixPosition(this.light.target.matrixWorld),_I.subVectors(wI,ZI),this.lightPlane.lookAt(wI),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(wI),this.targetLine.scale.z=_I.length()}}]),n}(Gi),SI=new yr,RI=new Ka,MI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r;(0,C.Z)(this,n);var i=new ma,a=new rl({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],s=[],u={},l=new Oi(16755200),c=new Oi(16711680),g=new Oi(43775),d=new Oi(16777215),I=new Oi(3355443);function h(e,t,n){f(e,n),f(t,n)}function f(e,t){o.push(0,0,0),s.push(t.r,t.g,t.b),void 0===u[e]&&(u[e]=[]),u[e].push(o.length/3-1)}return h("n1","n2",l),h("n2","n4",l),h("n4","n3",l),h("n3","n1",l),h("f1","f2",l),h("f2","f4",l),h("f4","f3",l),h("f3","f1",l),h("n1","f1",l),h("n2","f2",l),h("n3","f3",l),h("n4","f4",l),h("p","n1",c),h("p","n2",c),h("p","n3",c),h("p","n4",c),h("u1","u2",g),h("u2","u3",g),h("u3","u1",g),h("c","t",d),h("p","c",I),h("cn1","cn2",I),h("cn3","cn4",I),h("cf1","cf2",I),h("cf3","cf4",I),i.setAttribute("position",new sa(o,3)),i.setAttribute("color",new sa(s,3)),(r=t.call(this,i,a)).type="CameraHelper",r.camera=e,r.camera.updateProjectionMatrix&&r.camera.updateProjectionMatrix(),r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r.pointMap=u,r.update(),r}return(0,h.Z)(n,[{key:"update",value:function(){var e=this.geometry,t=this.pointMap;RI.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),WI("c",t,e,RI,0,0,-1),WI("t",t,e,RI,0,0,1),WI("n1",t,e,RI,-1,-1,-1),WI("n2",t,e,RI,1,-1,-1),WI("n3",t,e,RI,-1,1,-1),WI("n4",t,e,RI,1,1,-1),WI("f1",t,e,RI,-1,-1,1),WI("f2",t,e,RI,1,-1,1),WI("f3",t,e,RI,-1,1,1),WI("f4",t,e,RI,1,1,1),WI("u1",t,e,RI,.7,1.1,-1),WI("u2",t,e,RI,-.7,1.1,-1),WI("u3",t,e,RI,0,2,-1),WI("cf1",t,e,RI,-1,0,1),WI("cf2",t,e,RI,1,0,1),WI("cf3",t,e,RI,0,-1,1),WI("cf4",t,e,RI,0,1,1),WI("cn1",t,e,RI,-1,0,-1),WI("cn2",t,e,RI,1,0,-1),WI("cn3",t,e,RI,0,-1,-1),WI("cn4",t,e,RI,0,1,-1),e.getAttribute("position").needsUpdate=!0}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}(dl);function WI(e,t,n,r,i,a,o){SI.set(i,a,o).unproject(r);var s=t[e];if(void 0!==s)for(var u=n.getAttribute("position"),l=0,c=s.length;l<c;l++)u.setXYZ(s[l],SI.x,SI.y,SI.z)}var kI,VI,FI=new Zr,EI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;(0,C.Z)(this,n);var a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new Float32Array(24),s=new ma;return s.setIndex(new qi(a,1)),s.setAttribute("position",new qi(o,3)),(r=t.call(this,s,new rl({color:i,toneMapped:!1}))).object=e,r.type="BoxHelper",r.matrixAutoUpdate=!1,r.update(),r}return(0,h.Z)(n,[{key:"update",value:function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&FI.setFromObject(this.object),!FI.isEmpty()){var t=FI.min,n=FI.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}},{key:"setFromObject",value:function(e){return this.object=e,this.update(),this}},{key:"copy",value:function(e){return dl.prototype.copy.call(this,e),this.object=e.object,this}}]),n}(dl),XI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;(0,C.Z)(this,n);var a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new ma;return s.setIndex(new qi(a,1)),s.setAttribute("position",new sa(o,3)),(r=t.call(this,s,new rl({color:i,toneMapped:!1}))).box=e,r.type="Box3Helper",r.geometry.computeBoundingSphere(),r}return(0,h.Z)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),(0,l.Z)((0,c.Z)(n.prototype),"updateMatrixWorld",this).call(this,e))}}]),n}(dl),HI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960;(0,C.Z)(this,n);var o=a,s=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],u=new ma;u.setAttribute("position",new sa(s,3)),u.computeBoundingSphere(),(r=t.call(this,u,new rl({color:o,toneMapped:!1}))).type="PlaneHelper",r.plane=e,r.size=i;var l=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],c=new ma;return c.setAttribute("position",new sa(l,3)),c.computeBoundingSphere(),r.add(new Xa(c,new Ji({color:o,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),r}return(0,h.Z)(n,[{key:"updateMatrixWorld",value:function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?R:S,this.lookAt(this.plane.normal),(0,l.Z)((0,c.Z)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(ll),LI=new yr,zI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yr(0,0,1),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yr(0,0,0),a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*a,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*s;return(0,C.Z)(this,n),(e=t.call(this)).type="ArrowHelper",void 0===kI&&((kI=new ma).setAttribute("position",new sa([0,0,0,0,1,0],3)),(VI=new wl(0,.5,1,5,1)).translate(0,-.5,0)),e.position.copy(i),e.line=new ll(kI,new rl({color:o,toneMapped:!1})),e.line.matrixAutoUpdate=!1,e.add(e.line),e.cone=new Xa(VI,new Ji({color:o,toneMapped:!1})),e.cone.matrixAutoUpdate=!1,e.add(e.cone),e.setDirection(r),e.setLength(a,s,u),e}return(0,h.Z)(n,[{key:"setDirection",value:function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{LI.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(LI,t)}}},{key:"setLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}},{key:"setColor",value:function(e){this.line.material.color.set(e),this.cone.material.color.set(e)}},{key:"copy",value:function(e){return(0,l.Z)((0,c.Z)(n.prototype),"copy",this).call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}]),n}(Gi),NI=function(e){(0,d.Z)(n,e);var t=(0,I.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;(0,C.Z)(this,n);var i=[0,0,0,r,0,0,0,0,0,0,r,0,0,0,0,0,0,r],a=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],o=new ma;o.setAttribute("position",new sa(i,3)),o.setAttribute("color",new sa(a,3));var s=new rl({vertexColors:!0,toneMapped:!1});return(e=t.call(this,o,s)).type="AxesHelper",e}return(0,h.Z)(n,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}(dl),YI=new Float32Array(1),TI=new Int32Array(YI.buffer),KI=function(){function e(){(0,C.Z)(this,e)}return(0,h.Z)(e,null,[{key:"toHalfFloat",value:function(e){YI[0]=e;var t=TI[0],n=t>>16&32768,r=t>>12&2047,i=t>>23&255;return i<103?n:i>142?(n|=31744,n|=(255==i?0:1)&&8388607&t):i<113?n|=((r|=2048)>>114-i)+(r>>113-i&1):(n|=i-112<<10|r>>1,n+=1&r)}}]),e}(),DI=Math.pow(2,8),PI=[.125,.215,.35,.446,.526,.582],UI=5+PI.length,OI=20,JI=(r={},(0,o.Z)(r,dn,0),(0,o.Z)(r,In,1),(0,o.Z)(r,hn,2),(0,o.Z)(r,pn,3),(0,o.Z)(r,An,4),(0,o.Z)(r,mn,5),(0,o.Z)(r,Cn,6),r),QI=new Ji({side:R,depthWrite:!1,depthTest:!1}),jI=new Xa(new La,QI),qI=new Dg,$I=gC(),eC=$I._lodPlanes,tC=$I._sizeLods,nC=$I._sigmas,rC=new Oi,iC=null,aC=(1+Math.sqrt(5))/2,oC=1/aC,sC=[new yr(1,1,1),new yr(-1,1,1),new yr(1,1,-1),new yr(-1,1,-1),new yr(0,aC,oC),new yr(0,aC,-oC),new yr(oC,0,aC),new yr(-oC,0,aC),new yr(aC,oC,0),new yr(-aC,oC,0)];function uC(e){var t=Math.max(e.r,e.g,e.b),n=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);return e.multiplyScalar(Math.pow(2,-n)),(n+128)/255}var lC=function(){function e(t){(0,C.Z)(this,e),this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=function(e){var t=new Float32Array(e),n=new yr(0,1,0);return new wc({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:JI[dn]},outputEncoding:{value:JI[dn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:V,depthTest:!1,depthWrite:!1})}(OI),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}return(0,h.Z)(e,[{key:"fromScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;iC=this._renderer.getRenderTarget();var i=this._allocateTargets();return this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}},{key:"fromEquirectangular",value:function(e){return this._fromTexture(e)}},{key:"fromCubemap",value:function(e){return this._fromTexture(e)}},{key:"compileCubemapShader",value:function(){null===this._cubemapShader&&(this._cubemapShader=hC(),this._compileMaterial(this._cubemapShader))}},{key:"compileEquirectangularShader",value:function(){null===this._equirectShader&&(this._equirectShader=CC(),this._compileMaterial(this._equirectShader))}},{key:"dispose",value:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var e=0;e<eC.length;e++)eC[e].dispose()}},{key:"_cleanup",value:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(iC),e.scissorTest=!1,IC(e,0,0,e.width,e.height)}},{key:"_fromTexture",value:function(e){iC=this._renderer.getRenderTarget();var t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}},{key:"_allocateTargets",value:function(e){var t={magFilter:Se,minFilter:Se,generateMipmaps:!1,type:Le,format:nt,encoding:cC(e)?e.encoding:hn,depthBuffer:!1},n=dC(t);return n.depthBuffer=!e,this._pingPongRenderTarget=dC(t),n}},{key:"_compileMaterial",value:function(e){var t=new Xa(eC[0],e);this._renderer.compile(t,qI)}},{key:"_sceneToCubeUV",value:function(e,t,n,r){var i=new Da(90,1,t,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,u=s.autoClear,l=s.outputEncoding,c=s.toneMapping;s.getClearColor(rC),s.toneMapping=Ie,s.outputEncoding=dn,s.autoClear=!1;var g=!1,d=e.background;if(d){if(d.isColor){QI.color.copy(d).convertSRGBToLinear(),e.background=null;var I=uC(QI.color);QI.opacity=I,g=!0}}else{QI.color.copy(rC).convertSRGBToLinear();var C=uC(QI.color);QI.opacity=C,g=!0}for(var h=0;h<6;h++){var f=h%3;0==f?(i.up.set(0,a[h],0),i.lookAt(o[h],0,0)):1==f?(i.up.set(0,0,a[h]),i.lookAt(0,o[h],0)):(i.up.set(0,a[h],0),i.lookAt(0,0,o[h])),IC(r,f*DI,h>2?DI:0,DI,DI),s.setRenderTarget(r),g&&s.render(jI,i),s.render(e,i)}s.toneMapping=c,s.outputEncoding=l,s.autoClear=u}},{key:"_textureToCubeUV",value:function(e,t){var n=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=hC()):null==this._equirectShader&&(this._equirectShader=CC());var r=e.isCubeTexture?this._cubemapShader:this._equirectShader,i=new Xa(eC[0],r),a=r.uniforms;a.envMap.value=e,e.isCubeTexture||a.texelSize.value.set(1/e.image.width,1/e.image.height),a.inputEncoding.value=JI[e.encoding],a.outputEncoding.value=JI[t.texture.encoding],IC(t,0,0,3*DI,2*DI),n.setRenderTarget(t),n.render(i,qI)}},{key:"_applyPMREM",value:function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<UI;r++){var i=Math.sqrt(nC[r]*nC[r]-nC[r-1]*nC[r-1]),a=sC[(r-1)%sC.length];this._blur(e,r-1,r,i,a)}t.autoClear=n}},{key:"_blur",value:function(e,t,n,r,i){var a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}},{key:"_halfBlur",value:function(e,t,n,r,i,a,o){var s=this._renderer,u=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var l=new Xa(eC[r],u),c=u.uniforms,g=tC[n]-1,d=isFinite(i)?Math.PI/(2*g):2*Math.PI/39,I=i/d,C=isFinite(i)?1+Math.floor(3*I):OI;C>OI&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(C," samples when the maximum is set to ").concat(OI));for(var h=[],f=0,p=0;p<OI;++p){var A=p/I,m=Math.exp(-A*A/2);h.push(m),0==p?f+=m:p<C&&(f+=2*m)}for(var v=0;v<h.length;v++)h[v]=h[v]/f;c.envMap.value=e.texture,c.samples.value=C,c.weights.value=h,c.latitudinal.value="latitudinal"===a,o&&(c.poleAxis.value=o),c.dTheta.value=d,c.mipInt.value=8-n,c.inputEncoding.value=JI[e.texture.encoding],c.outputEncoding.value=JI[e.texture.encoding];var b=tC[r];IC(t,3*Math.max(0,DI-2*b),(0===r?0:2*DI)+2*b*(r>4?r-8+4:0),3*b,2*b),s.setRenderTarget(t),s.render(l,qI)}}]),e}();function cC(e){return void 0!==e&&e.type===Le&&(e.encoding===dn||e.encoding===In||e.encoding===Cn)}function gC(){for(var e=[],t=[],n=[],r=8,i=0;i<UI;i++){var a=Math.pow(2,r);t.push(a);var o=1/a;i>4?o=PI[i-8+4-1]:0==i&&(o=0),n.push(o);for(var s=1/(a-1),u=-s/2,l=1+s/2,c=[u,u,l,u,l,l,u,u,l,l,u,l],g=new Float32Array(108),d=new Float32Array(72),I=new Float32Array(36),C=0;C<6;C++){var h=C%3*2/3-1,f=C>2?0:-1,p=[h,f,0,h+2/3,f,0,h+2/3,f+1,0,h,f,0,h+2/3,f+1,0,h,f+1,0];g.set(p,18*C),d.set(c,12*C);var A=[C,C,C,C,C,C];I.set(A,6*C)}var m=new ma;m.setAttribute("position",new qi(g,3)),m.setAttribute("uv",new qi(d,2)),m.setAttribute("faceIndex",new qi(I,1)),e.push(m),r>4&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}function dC(e){var t=new mr(3*DI,3*DI,e);return t.texture.mapping=Ge,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function IC(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function CC(){var e=new gr(1,1);return new wc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:JI[dn]},outputEncoding:{value:JI[dn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:V,depthTest:!1,depthWrite:!1})}function hC(){return new wc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:JI[dn]},outputEncoding:{value:JI[dn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:V,depthTest:!1,depthWrite:!1})}var fC=0,pC=1,AC=0,mC=1,vC=2;function bC(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function yC(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function BC(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new ml(e,t)}function GC(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Xu(e)}function ZC(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new ml(e,t)}function wC(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Cl(e)}function _C(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Cl(e)}function xC(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Cl(e)}function SC(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new yr(e,t,n)}function RC(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new qi(e,t).setUsage(Nn)}function MC(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new $i(e,t)}function WC(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new ea(e,t)}function kC(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ta(e,t)}function VC(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new na(e,t)}function FC(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new ra(e,t)}function EC(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new ia(e,t)}function XC(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new aa(e,t)}function HC(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new sa(e,t)}function LC(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new ua(e,t)}function zC(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new NI(e)}function NC(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new EI(e,t)}function YC(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new dl(new Vl(e.geometry),new rl({color:void 0!==t?t:16777215}))}function TC(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new dl(new Bc(e.geometry),new rl({color:void 0!==t?t:16777215}))}function KC(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new ng(e)}function DC(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new sg(e)}function PC(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Ja(e,n)}function UC(){console.error("THREE.CanvasRenderer has been removed")}function OC(){console.error("THREE.JSONLoader has been removed.")}lg.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(lg.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Rg.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},BI.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},fI.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},eg.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),$g.extractUrlBase(e)},eg.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},oI.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},oI.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},oI.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},oI.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},Zr.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Zr.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Zr.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Zr.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Zr.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},Kr.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},$a.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},lI.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Ir.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},Ir.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Ir.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Ir.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Ir.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Ir.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},$r.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},$r.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},$r.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new yr).setFromMatrixColumn(this,3)},$r.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},$r.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},$r.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},$r.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},$r.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},$r.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},$r.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},$r.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},$r.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},$r.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},$r.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},$r.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},$r.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},$r.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},$r.prototype.makeFrustum=function(e,t,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,a)},$r.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},xi.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},br.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},br.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},qr.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},qr.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},qr.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Li.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Li.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},Li.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},Li.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},Li.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},Li.barycoordFromPoint=function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Li.getBarycoord(e,t,n,r,i)},Li.normal=function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Li.getNormal(e,t,n,r)},Mg.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},Mg.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new lc(this,e)},Mg.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new fc(this,e)},gr.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},gr.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},gr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},yr.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},yr.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},yr.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},yr.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},yr.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},yr.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},yr.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},yr.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},yr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ar.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Ar.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Gi.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},Gi.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Gi.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},Gi.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Gi.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(Gi.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Xa.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Xa.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),ln},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Uu.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Da.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Wg.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(qi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Nn},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Nn)}}}),qi.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Nn:zn),this},qi.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},qi.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},ma.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},ma.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new qi(arguments[1],arguments[2])))},ma.prototype.addDrawCall=function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},ma.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},ma.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},ma.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},ma.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(ma.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),vu.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Nn:zn),this},vu.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},lc.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},lc.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},lc.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},mu.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},jd.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Ni.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Oi}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===W}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(Ta.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),hu.prototype.clearTarget=function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},hu.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},hu.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},hu.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},hu.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},hu.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},hu.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},hu.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},hu.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},hu.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},hu.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},hu.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},hu.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},hu.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},hu.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},hu.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},hu.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},hu.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},hu.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},hu.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},hu.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},hu.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},hu.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},hu.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},hu.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(hu.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?In:dn}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(au.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(mr.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),xd.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new hd).load(e,(function(e){t.setBuffer(e)})),this},Vd.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ua.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},Ua.prototype.clear=function(e,t,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,r)},Cr.crossOrigin=void 0,Cr.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new ug;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},Cr.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new og;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},Cr.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Cr.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var JC={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function QC(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:A}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=A)},8356:function(e){var t=function e(){function t(e){return i.appendChild(e.dom),e}function n(e){for(var t=0;t<i.children.length;t++)i.children[t].style.display=t===e?"block":"none";r=e}var r=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",(function(e){e.preventDefault(),n(++r%i.children.length)}),!1);var a=(performance||Date).now(),o=a,s=0,u=t(new e.Panel("FPS","#0ff","#002")),l=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new e.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:i,addPanel:t,showPanel:n,begin:function(){a=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(l.update(e-a,200),e>o+1e3&&(u.update(1e3*s/(e-o),100),o=e,s=0,c)){var t=performance.memory;c.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){a=this.end()},domElement:i,setMode:n}};t.Panel=function(e,t,n){var r=1/0,i=0,a=Math.round,o=a(window.devicePixelRatio||1),s=80*o,u=48*o,l=3*o,c=2*o,g=3*o,d=15*o,I=74*o,C=30*o,h=document.createElement("canvas");h.width=s,h.height=u,h.style.cssText="width:80px;height:48px";var f=h.getContext("2d");return f.font="bold "+9*o+"px Helvetica,Arial,sans-serif",f.textBaseline="top",f.fillStyle=n,f.fillRect(0,0,s,u),f.fillStyle=t,f.fillText(e,l,c),f.fillRect(g,d,I,C),f.fillStyle=n,f.globalAlpha=.9,f.fillRect(g,d,I,C),{dom:h,update:function(u,p){r=Math.min(r,u),i=Math.max(i,u),f.fillStyle=n,f.globalAlpha=1,f.fillRect(0,0,s,d),f.fillStyle=t,f.fillText(a(u)+" "+e+" ("+a(r)+"-"+a(i)+")",l,c),f.drawImage(h,g+o,d,I-o,C,g,d,I-o,C),f.fillRect(g+I-o,d,o,C),f.fillStyle=n,f.globalAlpha=.9,f.fillRect(g+I-o,d,o,a((1-u/p)*C))}}},e.exports=t},9776:function(e,t,n){var r;!function(i,a){"use strict";var o="function",s="undefined",u="object",l="string",c="model",g="name",d="type",I="vendor",C="version",h="architecture",f="console",p="mobile",A="tablet",m="smarttv",v="wearable",b="embedded",y="Amazon",B="Apple",G="ASUS",Z="BlackBerry",w="Firefox",_="Google",x="Huawei",S="LG",R="Microsoft",M="Motorola",W="Opera",k="Samsung",V="Sony",F="Xiaomi",E="Zebra",X="Facebook",H=function(e){var t={};for(var n in e)t[e[n].toUpperCase()]=e[n];return t},L=function(e,t){return typeof e===l&&-1!==z(t).indexOf(z(e))},z=function(e){return e.toLowerCase()},N=function(e,t){if(typeof e===l)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof t===s?e:e.substring(0,255)},Y=function(e,t){for(var n,r,i,s,l,c,g=0;g<t.length&&!l;){var d=t[g],I=t[g+1];for(n=r=0;n<d.length&&!l;)if(l=d[n++].exec(e))for(i=0;i<I.length;i++)c=l[++r],typeof(s=I[i])===u&&s.length>0?2==s.length?typeof s[1]==o?this[s[0]]=s[1].call(this,c):this[s[0]]=s[1]:3==s.length?typeof s[1]!==o||s[1].exec&&s[1].test?this[s[0]]=c?c.replace(s[1],s[2]):a:this[s[0]]=c?s[1].call(this,c,s[2]):a:4==s.length&&(this[s[0]]=c?s[3].call(this,c.replace(s[1],s[2])):a):this[s]=c||a;g+=2}},T=function(e,t){for(var n in t)if(typeof t[n]===u&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(L(t[n][r],e))return"?"===n?a:n}else if(L(t[n],e))return"?"===n?a:n;return e},K={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},D={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[C,[g,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[C,[g,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[g,C],[/opios[\/ ]+([\w\.]+)/i],[C,[g,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[C,[g,W]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[g,C],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[C,[g,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[C,[g,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[C,[g,"WeChat"]],[/konqueror\/([\w\.]+)/i],[C,[g,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[C,[g,"IE"]],[/yabrowser\/([\w\.]+)/i],[C,[g,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[g,/(.+)/,"$1 Secure Browser"],C],[/\bfocus\/([\w\.]+)/i],[C,[g,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[C,[g,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[C,[g,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[C,[g,"Dolphin"]],[/coast\/([\w\.]+)/i],[C,[g,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[C,[g,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[C,[g,w]],[/\bqihu|(qi?ho?o?|360)browser/i],[[g,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[g,/(.+)/,"$1 Browser"],C],[/(comodo_dragon)\/([\w\.]+)/i],[[g,/_/g," "],C],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[g,C],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[g],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[g,X],C],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[g,C],[/\bgsa\/([\w\.]+) .*safari\//i],[C,[g,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[C,[g,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[g,"Chrome WebView"],C],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[C,[g,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[g,C],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[C,[g,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[C,g],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[g,[C,T,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[g,C],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[g,"Netscape"],C],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[C,[g,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[g,C]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[h,"amd64"]],[/(ia32(?=;))/i],[[h,z]],[/((?:i[346]|x)86)[;\)]/i],[[h,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[h,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[h,"armhf"]],[/windows (ce|mobile); ppc;/i],[[h,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[h,/ower/,"",z]],[/(sun4\w)[;\)]/i],[[h,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[h,z]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[c,[I,k],[d,A]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[c,[I,k],[d,p]],[/\((ip(?:hone|od)[\w ]*);/i],[c,[I,B],[d,p]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[c,[I,B],[d,A]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[c,[I,x],[d,A]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[c,[I,x],[d,p]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[c,/_/g," "],[I,F],[d,p]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[c,/_/g," "],[I,F],[d,A]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[c,[I,"OPPO"],[d,p]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[c,[I,"Vivo"],[d,p]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[c,[I,"Realme"],[d,p]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[c,[I,M],[d,p]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[c,[I,M],[d,A]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[c,[I,S],[d,A]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[c,[I,S],[d,p]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[c,[I,"Lenovo"],[d,A]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[c,/_/g," "],[I,"Nokia"],[d,p]],[/(pixel c)\b/i],[c,[I,_],[d,A]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[c,[I,_],[d,p]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[c,[I,V],[d,p]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[c,"Xperia Tablet"],[I,V],[d,A]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[c,[I,"OnePlus"],[d,p]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[c,[I,y],[d,A]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[c,/(.+)/g,"Fire Phone $1"],[I,y],[d,p]],[/(playbook);[-\w\),; ]+(rim)/i],[c,I,[d,A]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[c,[I,Z],[d,p]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[c,[I,G],[d,A]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[c,[I,G],[d,p]],[/(nexus 9)/i],[c,[I,"HTC"],[d,A]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[I,[c,/_/g," "],[d,p]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[c,[I,"Acer"],[d,A]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[c,[I,"Meizu"],[d,p]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[c,[I,"Sharp"],[d,p]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[I,c,[d,p]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[I,c,[d,A]],[/(surface duo)/i],[c,[I,R],[d,A]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[c,[I,"Fairphone"],[d,p]],[/(u304aa)/i],[c,[I,"AT&T"],[d,p]],[/\bsie-(\w*)/i],[c,[I,"Siemens"],[d,p]],[/\b(rct\w+) b/i],[c,[I,"RCA"],[d,A]],[/\b(venue[\d ]{2,7}) b/i],[c,[I,"Dell"],[d,A]],[/\b(q(?:mv|ta)\w+) b/i],[c,[I,"Verizon"],[d,A]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[c,[I,"Barnes & Noble"],[d,A]],[/\b(tm\d{3}\w+) b/i],[c,[I,"NuVision"],[d,A]],[/\b(k88) b/i],[c,[I,"ZTE"],[d,A]],[/\b(nx\d{3}j) b/i],[c,[I,"ZTE"],[d,p]],[/\b(gen\d{3}) b.+49h/i],[c,[I,"Swiss"],[d,p]],[/\b(zur\d{3}) b/i],[c,[I,"Swiss"],[d,A]],[/\b((zeki)?tb.*\b) b/i],[c,[I,"Zeki"],[d,A]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[I,"Dragon Touch"],c,[d,A]],[/\b(ns-?\w{0,9}) b/i],[c,[I,"Insignia"],[d,A]],[/\b((nxa|next)-?\w{0,9}) b/i],[c,[I,"NextBook"],[d,A]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[I,"Voice"],c,[d,p]],[/\b(lvtel\-)?(v1[12]) b/i],[[I,"LvTel"],c,[d,p]],[/\b(ph-1) /i],[c,[I,"Essential"],[d,p]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[c,[I,"Envizen"],[d,A]],[/\b(trio[-\w\. ]+) b/i],[c,[I,"MachSpeed"],[d,A]],[/\btu_(1491) b/i],[c,[I,"Rotor"],[d,A]],[/(shield[\w ]+) b/i],[c,[I,"Nvidia"],[d,A]],[/(sprint) (\w+)/i],[I,c,[d,p]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[I,R],[d,p]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[c,[I,E],[d,A]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[c,[I,E],[d,p]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[I,c,[d,f]],[/droid.+; (shield) bui/i],[c,[I,"Nvidia"],[d,f]],[/(playstation [345portablevi]+)/i],[c,[I,V],[d,f]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[c,[I,R],[d,f]],[/smart-tv.+(samsung)/i],[I,[d,m]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[I,k],[d,m]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[I,S],[d,m]],[/(apple) ?tv/i],[I,[c,"Apple TV"],[d,m]],[/crkey/i],[[c,"Chromecast"],[I,_],[d,m]],[/droid.+aft(\w)( bui|\))/i],[c,[I,y],[d,m]],[/\(dtv[\);].+(aquos)/i],[c,[I,"Sharp"],[d,m]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[I,N],[c,N],[d,m]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[d,m]],[/((pebble))app/i],[I,c,[d,v]],[/droid.+; (glass) \d/i],[c,[I,_],[d,v]],[/droid.+; (wt63?0{2,3})\)/i],[c,[I,E],[d,v]],[/(quest( 2)?)/i],[c,[I,X],[d,v]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[I,[d,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[c,[d,p]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[c,[d,A]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[d,A]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[d,p]],[/(android[-\w\. ]{0,9});.+buil/i],[c,[I,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[C,[g,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[C,[g,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[g,C],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[C,g]],os:[[/microsoft (windows) (vista|xp)/i],[g,C],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[g,[C,T,K]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[g,"Windows"],[C,T,K]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[C,/_/g,"."],[g,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[g,"Mac OS"],[C,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[C,g],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[g,C],[/\(bb(10);/i],[C,[g,Z]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[C,[g,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[C,[g,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[C,[g,"webOS"]],[/crkey\/([\d\.]+)/i],[C,[g,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[g,"Chromium OS"],C],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[g,C],[/(sunos) ?([\w\.\d]*)/i],[[g,"Solaris"],C],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[g,C]]},P=function e(t,n){if(typeof t===u&&(n=t,t=a),!(this instanceof e))return new e(t,n).getResult();var r=t||(typeof i!==s&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),o=n?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2===0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(D,n):D;return this.getBrowser=function(){var e,t={};return t.name=a,t.version=a,Y.call(t,r,o.browser),t.major=typeof(e=t.version)===l?e.replace(/[^\d\.]/g,"").split(".")[0]:a,t},this.getCPU=function(){var e={};return e.architecture=a,Y.call(e,r,o.cpu),e},this.getDevice=function(){var e={};return e.vendor=a,e.model=a,e.type=a,Y.call(e,r,o.device),e},this.getEngine=function(){var e={};return e.name=a,e.version=a,Y.call(e,r,o.engine),e},this.getOS=function(){var e={};return e.name=a,e.version=a,Y.call(e,r,o.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=typeof e===l&&e.length>255?N(e,255):e,this},this.setUA(r),this};P.VERSION="0.7.30",P.BROWSER=H([g,C,"major"]),P.CPU=H([h]),P.DEVICE=H([c,I,d,f,p,m,A,v,b]),P.ENGINE=P.OS=H([g,C]),typeof t!==s?(e.exports&&(t=e.exports=P),t.UAParser=P):n.amdO?(r=function(){return P}.call(t,n,t,e))===a||(e.exports=r):typeof i!==s&&(i.UAParser=P);var U=typeof i!==s&&(i.jQuery||i.Zepto);if(U&&!U.ua){var O=new P;U.ua=O.getResult(),U.ua.get=function(){return O.getUA()},U.ua.set=function(e){O.setUA(e);var t=O.getResult();for(var n in t)U.ua[n]=t[n]}}}("object"===typeof window?window:this)},1652:function(e,t,n){"use strict";n.d(t,{G:function(){return c}});var r=n(3433),i=n(7762),a=n(580),o=n.n(a),s=[];function u(e,t,n){var a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=(0,i.Z)(t);try{for(l.s();!(a=l.n()).done;){var c=a.value;if(o()(n,c.args)){if(u)return;if(c.error)throw c.error;if(c.response)return c.response;throw c.promise}}}catch(d){l.e(d)}finally{l.f()}var g={args:n,promise:e.apply(void 0,(0,r.Z)(n)).then((function(e){return g.response=null==e||e})).catch((function(e){return g.error=null!=e?e:"unknown error"})).then((function(){s>0&&setTimeout((function(){var e=t.indexOf(g);-1!==e&&t.splice(e,1)}),s)}))};if(t.push(g),!u)throw g.promise}function l(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(void 0===n||0===n.length)e.splice(0,e.length);else{var i=e.find((function(e){return o()(n,e.args)}));if(i){var a=e.indexOf(i);-1!==a&&e.splice(a,1)}}}function c(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return u(e,s,n,c.lifespan)}c.lifespan=0,c.clear=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.apply(void 0,[s].concat(t))},c.preload=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];u(e,s,n,c.lifespan,!0)},c.peek=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r;return null==(r=s.find((function(e){return o()(t,e.args)})))?void 0:r.response}},5401:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(9439),i=n(4519);function a(e){var t,n=new Set,r=function(e,r){var i="function"===typeof e?e(t):e;if(i!==t){var a=t;t=r?i:Object.assign({},t,i),n.forEach((function(e){return e(t,a)}))}},i=function(){return t},a={setState:r,getState:i,subscribe:function(e,r,a){return r||a?function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");var o=r(t);function s(){var n=r(t);if(!a(o,n)){var i=o;e(o=n,i)}}return n.add(s),function(){return n.delete(s)}}(e,r,a):(n.add(e),function(){return n.delete(e)})},destroy:function(){return n.clear()}};return t=e(r,i,a),a}var o="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?i.useEffect:i.useLayoutEffect;function s(e){var t="function"===typeof e?a(e):e,n=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.getState,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is,s=(0,i.useReducer)((function(e){return e+1}),0),u=(0,r.Z)(s,2),l=u[1],c=t.getState(),g=(0,i.useRef)(c),d=(0,i.useRef)(n),I=(0,i.useRef)(a),C=(0,i.useRef)(!1),h=(0,i.useRef)();void 0===h.current&&(h.current=n(c));var f=!1;(g.current!==c||d.current!==n||I.current!==a||C.current)&&(e=n(c),f=!a(h.current,e)),o((function(){f&&(h.current=e),g.current=c,d.current=n,I.current=a,C.current=!1}));var p=(0,i.useRef)(c);o((function(){var e=function(){try{var e=t.getState(),n=d.current(e);I.current(h.current,n)||(g.current=e,h.current=n,l())}catch(r){C.current=!0,l()}},n=t.subscribe(e);return t.getState()!==p.current&&e(),n}),[]);var A=f?e:h.current;return(0,i.useDebugValue)(A),A};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");var e=[n,t];return{next:function(){var t=e.length<=0;return{value:e.shift(),done:t}}}},n}},8333:function(e,t,n){"use strict";n.r(t),t.default=n.p+"b4f46e148a3b3b5aef90717d8d60e3fc.zbin"},7319:function(e,t,n){"use strict";n.r(t),t.default=n.p+"f7b62a3a53b5c9b3222ba8dc53cb8b11.zbin"},7006:function(e,t,n){"use strict";n.r(t),t.default=n.p+"482727c0e7dd40d73f5aae47f238ad61.zbin"},4301:function(e,t){"use strict";t.Z="./zcv.wasm"},7534:function(e,t,n){"use strict";function r(){return new Worker(n.p+"static/js/worker.ab53b058.worker.js")}n.r(t),n.d(t,{default:function(){return r}})},7567:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var r=n(477),i=n.n(r);function a(){return i()('!function(){var e={228:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},858:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},575:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},913:function(e){function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},269:function(e,t,n){var r=n(379);e.exports=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){c=!0,o=e},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw o}}}},e.exports.__esModule=!0,e.exports.default=e.exports},884:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(c){u=!0,a=c}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return i}},e.exports.__esModule=!0,e.exports.default=e.exports},521:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},38:function(e,t,n){var r=n(858),a=n(884),i=n(379),o=n(521);e.exports=function(e,t){return r(e)||a(e,t)||i(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},379:function(e,t,n){var r=n(228);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},757:function(e,t,n){e.exports=n(780)},735:function(e,t,n){"use strict";var r=n(575).default,a=n(913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MessageDeserializer=void 0;var i=function(){function e(){var t=this;r(this,e),this._buffer=new ArrayBuffer(0),this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer),this._f64View=new Float64Array(this._buffer),this._u8View=new Uint8Array(this._buffer),this._u16View=new Uint16Array(this._buffer),this._u32View=new Uint32Array(this._buffer),this._offset=0,this._length=0,this._startOffset=-1,this._processor={int:function(){return t._i32View[t._startOffset++]},bool:function(){return 1===t._i32View[t._startOffset++]},type:function(){return t._i32View[t._startOffset++]},float:function(){return t._f32View[t._startOffset++]},timestamp:function(){t._startOffset%2===1&&t._startOffset++;var e=t._f64View[t._startOffset/2];return t._startOffset+=2,e},string:function(){var e=t._i32View[t._startOffset++],n=(new TextDecoder).decode(new Uint8Array(t._buffer,4*t._startOffset,e));return t._startOffset+=e>>2,0!==(3&e)&&t._startOffset++,n},dataWithLength:function(){var e=t._i32View[t._startOffset++],n=new Uint8Array(e);return n.set(t._u8View.subarray(4*t._startOffset,4*t._startOffset+e)),t._startOffset+=n.byteLength>>2,0!==(3&n.byteLength)&&t._startOffset++,n.buffer},matrix4x4:function(){var e=t._i32View[t._startOffset++],n=new Float32Array(e);return n.set(t._f32View.subarray(t._startOffset,t._startOffset+16)),t._startOffset+=e,n},identityCoefficients:function(){var e=t._i32View[t._startOffset++],n=new Float32Array(e);return n.set(t._f32View.subarray(t._startOffset,t._startOffset+50)),t._startOffset+=e,n},expressionCoefficients:function(){var e=t._i32View[t._startOffset++],n=new Float32Array(e);return n.set(t._f32View.subarray(t._startOffset,t._startOffset+29)),t._startOffset+=e,n},cameraModel:function(){var e=t._i32View[t._startOffset++],n=new Float32Array(e);return n.set(t._f32View.subarray(t._startOffset,t._startOffset+6)),t._startOffset+=e,n},barcodeFormat:function(){return t._i32View[t._startOffset++]},faceLandmarkName:function(){return t._i32View[t._startOffset++]},instantTrackerTransformOrientation:function(){return t._i32View[t._startOffset++]},logLevel:function(){return t._i32View[t._startOffset++]}}}return a(e,[{key:"setData",value:function(e){this._buffer=e,this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer),this._f64View=new Float64Array(this._buffer),this._u8View=new Uint8Array(this._buffer),this._u16View=new Uint16Array(this._buffer),this._u32View=new Uint32Array(this._buffer),this._offset=0,this._length=0,e.byteLength>=4&&(this._offset=1,this._length=this._i32View[0]),this._startOffset=-1}},{key:"hasMessage",value:function(){return this._offset+1<this._length}},{key:"forMessages",value:function(e){for(;this.hasMessage();){var t=this._i32View[this._offset],n=this._i32View[this._offset+1];this._startOffset=this._offset+2,this._offset+=t,e(n,this._processor)}}}]),e}();t.MessageDeserializer=i},319:function(e,t,n){"use strict";var r=n(575).default,a=n(913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Event5=t.Event3=t.Event2=t.Event1=t.Event=void 0;var i=function(){function e(){r(this,e),this._funcs=[]}return a(e,[{key:"bind",value:function(e){this._funcs.push(e)}},{key:"unbind",value:function(e){var t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}},{key:"emit",value:function(){for(var e=0,t=this._funcs.length;e<t;e++)this._funcs[e]()}}]),e}();t.Event=i;var o=function(){function e(){r(this,e),this._funcs=[]}return a(e,[{key:"bind",value:function(e){this._funcs.push(e)}},{key:"unbind",value:function(e){var t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}},{key:"emit",value:function(e){for(var t=0,n=this._funcs.length;t<n;t++)this._funcs[t](e)}}]),e}();t.Event1=o;var u=function(){function e(){r(this,e),this._funcs=[]}return a(e,[{key:"bind",value:function(e){this._funcs.push(e)}},{key:"unbind",value:function(e){var t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}},{key:"emit",value:function(e,t){for(var n=0,r=this._funcs.length;n<r;n++)this._funcs[n](e,t)}}]),e}();t.Event2=u;var c=function(){function e(){r(this,e),this._funcs=[]}return a(e,[{key:"bind",value:function(e){this._funcs.push(e)}},{key:"unbind",value:function(e){var t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}},{key:"emit",value:function(e,t,n){for(var r=0,a=this._funcs.length;r<a;r++)this._funcs[r](e,t,n)}}]),e}();t.Event3=c;var f=function(){function e(){r(this,e),this._funcs=[]}return a(e,[{key:"bind",value:function(e){this._funcs.push(e)}},{key:"unbind",value:function(e){var t=this._funcs.indexOf(e);t>-1&&this._funcs.splice(t,1)}},{key:"emit",value:function(e,t,n,r,a){for(var i=0,o=this._funcs.length;i<o;i++)this._funcs[i](e,t,n,r,a)}}]),e}();t.Event5=f},832:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRuntimeObject=void 0,t.getRuntimeObject=function(e){var t=e.cwrap("zappar_log_level","number",[]),n=e.cwrap("zappar_log_level_set",null,["number"]),r=e.cwrap("zappar_analytics_project_id_set",null,["string"]),a=e.cwrap("zappar_pipeline_create","number",[]),i=e.cwrap("zappar_pipeline_destroy",null,["number"]),o=e.cwrap("zappar_pipeline_frame_update",null,["number"]),u=e.cwrap("zappar_pipeline_frame_number","number",["number"]),c=e.cwrap("zappar_pipeline_camera_model","number",["number"]),f=e.cwrap("zappar_pipeline_camera_frame_user_data","number",["number"]),s=e.cwrap("zappar_pipeline_camera_frame_submit",null,["number","number","number","number","number","number","number"]),_=e.cwrap("zappar_pipeline_camera_frame_camera_attitude","number",["number"]),l=e.cwrap("zappar_pipeline_motion_accelerometer_submit",null,["number","number","number","number","number"]),p=e.cwrap("zappar_pipeline_motion_rotation_rate_submit",null,["number","number","number","number","number"]),d=e.cwrap("zappar_pipeline_motion_attitude_submit",null,["number","number","number","number","number"]),m=e.cwrap("zappar_camera_source_create","number",["number","string"]),h=e.cwrap("zappar_camera_source_destroy",null,["number"]),y=e.cwrap("zappar_image_tracker_create","number",["number"]),b=e.cwrap("zappar_image_tracker_destroy",null,["number"]),v=e.cwrap("zappar_image_tracker_target_load_from_memory",null,["number","number","number"]),g=e.cwrap("zappar_image_tracker_target_loaded_version","number",["number"]),w=e.cwrap("zappar_image_tracker_target_count","number",["number"]),M=e.cwrap("zappar_image_tracker_enabled","number",["number"]),k=e.cwrap("zappar_image_tracker_enabled_set",null,["number","number"]),x=e.cwrap("zappar_image_tracker_anchor_count","number",["number"]),z=e.cwrap("zappar_image_tracker_anchor_id","string",["number","number"]),A=e.cwrap("zappar_image_tracker_anchor_pose_raw","number",["number","number"]),L=e.cwrap("zappar_face_tracker_create","number",["number"]),E=e.cwrap("zappar_face_tracker_destroy",null,["number"]),O=e.cwrap("zappar_face_tracker_model_load_from_memory",null,["number","number","number"]),S=e.cwrap("zappar_face_tracker_model_loaded_version","number",["number"]),C=e.cwrap("zappar_face_tracker_enabled_set",null,["number","number"]),T=e.cwrap("zappar_face_tracker_enabled","number",["number"]),P=e.cwrap("zappar_face_tracker_max_faces_set",null,["number","number"]),I=e.cwrap("zappar_face_tracker_max_faces","number",["number"]),B=e.cwrap("zappar_face_tracker_anchor_count","number",["number"]),F=e.cwrap("zappar_face_tracker_anchor_id","string",["number","number"]),j=e.cwrap("zappar_face_tracker_anchor_pose_raw","number",["number","number"]),D=e.cwrap("zappar_face_tracker_anchor_identity_coefficients","number",["number","number"]),R=e.cwrap("zappar_face_tracker_anchor_expression_coefficients","number",["number","number"]),V=e.cwrap("zappar_face_mesh_create","number",[]),q=e.cwrap("zappar_face_mesh_destroy",null,["number"]),G=e.cwrap("zappar_face_landmark_create","number",["number"]),N=e.cwrap("zappar_face_landmark_destroy",null,["number"]),U=e.cwrap("zappar_barcode_finder_create","number",["number"]),W=e.cwrap("zappar_barcode_finder_destroy",null,["number"]),H=e.cwrap("zappar_barcode_finder_enabled_set",null,["number","number"]),Z=e.cwrap("zappar_barcode_finder_enabled","number",["number"]),Y=e.cwrap("zappar_barcode_finder_found_number","number",["number"]),X=e.cwrap("zappar_barcode_finder_found_text","string",["number","number"]),K=e.cwrap("zappar_barcode_finder_found_format","number",["number","number"]),J=e.cwrap("zappar_barcode_finder_formats","number",["number"]),Q=e.cwrap("zappar_barcode_finder_formats_set",null,["number","number"]),$=e.cwrap("zappar_instant_world_tracker_create","number",["number"]),ee=e.cwrap("zappar_instant_world_tracker_destroy",null,["number"]),te=e.cwrap("zappar_instant_world_tracker_enabled_set",null,["number","number"]),ne=e.cwrap("zappar_instant_world_tracker_enabled","number",["number"]),re=e.cwrap("zappar_instant_world_tracker_anchor_pose_raw","number",["number"]),ae=e.cwrap("zappar_instant_world_tracker_anchor_pose_set_from_camera_offset",null,["number","number","number","number","number"]),ie=32,oe=e._malloc(ie),ue=64,ce=e._malloc(ue);return{log_level:function(){return t()},log_level_set:function(e){return n(e)},analytics_project_id_set:function(e){return r(e)},pipeline_create:function(){return a()},pipeline_destroy:function(){i()},pipeline_frame_update:function(e){return o(e)},pipeline_frame_number:function(e){return u(e)},pipeline_camera_model:function(t){var n=c(t),r=new Float32Array(6);return r.set(e.HEAPF32.subarray(n/4,6+n/4)),n=r},pipeline_camera_frame_user_data:function(e){return f(e)},pipeline_camera_frame_submit:function(t,n,r,a,i,o){ie<n.byteLength&&(e._free(oe),ie=n.byteLength,oe=e._malloc(ie));var u=oe,c=n.byteLength;e.HEAPU8.set(new Uint8Array(n),oe);var f=r,_=a,l=i;ue<o.byteLength&&(e._free(ue),ue=o.byteLength,ce=e._malloc(ue));var p=ce;return e.HEAPF32.set(o,ce/4),s(t,u,c,f,_,l,p)},pipeline_camera_frame_camera_attitude:function(t){var n=_(t),r=new Float32Array(16);return r.set(e.HEAPF32.subarray(n/4,16+n/4)),n=r},pipeline_motion_accelerometer_submit:function(e,t,n,r,a){return l(e,t,n,r,a)},pipeline_motion_rotation_rate_submit:function(e,t,n,r,a){return p(e,t,n,r,a)},pipeline_motion_attitude_submit:function(e,t,n,r,a){return d(e,t,n,r,a)},camera_source_create:function(e,t){return m(e,t)},camera_source_destroy:function(){h()},image_tracker_create:function(e){return y(e)},image_tracker_destroy:function(){b()},image_tracker_target_load_from_memory:function(t,n){ie<n.byteLength&&(e._free(oe),ie=n.byteLength,oe=e._malloc(ie));var r=oe,a=n.byteLength;return e.HEAPU8.set(new Uint8Array(n),oe),v(t,r,a)},image_tracker_target_loaded_version:function(e){return g(e)},image_tracker_target_count:function(e){return w(e)},image_tracker_enabled:function(e){var t=M(e);return t=1===t},image_tracker_enabled_set:function(e,t){return k(e,t?1:0)},image_tracker_anchor_count:function(e){return x(e)},image_tracker_anchor_id:function(e,t){return z(e,t)},image_tracker_anchor_pose_raw:function(t,n){var r=A(t,n),a=new Float32Array(16);return a.set(e.HEAPF32.subarray(r/4,16+r/4)),r=a},face_tracker_create:function(e){return L(e)},face_tracker_destroy:function(){E()},face_tracker_model_load_from_memory:function(t,n){ie<n.byteLength&&(e._free(oe),ie=n.byteLength,oe=e._malloc(ie));var r=oe,a=n.byteLength;return e.HEAPU8.set(new Uint8Array(n),oe),O(t,r,a)},face_tracker_model_loaded_version:function(e){return S(e)},face_tracker_enabled_set:function(e,t){return C(e,t?1:0)},face_tracker_enabled:function(e){var t=T(e);return t=1===t},face_tracker_max_faces_set:function(e,t){return P(e,t)},face_tracker_max_faces:function(e){return I(e)},face_tracker_anchor_count:function(e){return B(e)},face_tracker_anchor_id:function(e,t){return F(e,t)},face_tracker_anchor_pose_raw:function(t,n){var r=j(t,n),a=new Float32Array(16);return a.set(e.HEAPF32.subarray(r/4,16+r/4)),r=a},face_tracker_anchor_identity_coefficients:function(t,n){var r=D(t,n),a=new Float32Array(50);return a.set(e.HEAPF32.subarray(r/4,50+r/4)),r=a},face_tracker_anchor_expression_coefficients:function(t,n){var r=R(t,n),a=new Float32Array(29);return a.set(e.HEAPF32.subarray(r/4,29+r/4)),r=a},face_mesh_create:function(){return V()},face_mesh_destroy:function(){q()},face_landmark_create:function(e){return G(e)},face_landmark_destroy:function(){N()},barcode_finder_create:function(e){return U(e)},barcode_finder_destroy:function(){W()},barcode_finder_enabled_set:function(e,t){return H(e,t?1:0)},barcode_finder_enabled:function(e){var t=Z(e);return t=1===t},barcode_finder_found_number:function(e){return Y(e)},barcode_finder_found_text:function(e,t){return X(e,t)},barcode_finder_found_format:function(e,t){return K(e,t)},barcode_finder_formats:function(e){return J(e)},barcode_finder_formats_set:function(e,t){return Q(e,t)},instant_world_tracker_create:function(e){return $(e)},instant_world_tracker_destroy:function(){ee()},instant_world_tracker_enabled_set:function(e,t){return te(e,t?1:0)},instant_world_tracker_enabled:function(e){var t=ne(e);return t=1===t},instant_world_tracker_anchor_pose_raw:function(t){var n=re(t),r=new Float32Array(16);return r.set(e.HEAPF32.subarray(n/4,16+n/4)),n=r},instant_world_tracker_anchor_pose_set_from_camera_offset:function(e,t,n,r,a){return ae(e,t,n,r,a)}}}},370:function(e,t,n){"use strict";var r=n(38).default,a=n(269).default,i=n(575).default,o=n(913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.zappar_server=void 0;var u=n(363),c=n(735),f=function(){function e(t,n){i(this,e),this._impl=t,this._sender=n,this._deserializer=new c.MessageDeserializer,this.serializersByPipelineId=new Map,this._pipeline_id_by_pipeline_id=new Map,this._pipeline_by_instance=new Map,this._pipeline_id_by_camera_source_id=new Map,this._camera_source_by_instance=new Map,this._pipeline_id_by_image_tracker_id=new Map,this._image_tracker_by_instance=new Map,this._pipeline_id_by_face_tracker_id=new Map,this._face_tracker_by_instance=new Map,this._pipeline_id_by_face_mesh_id=new Map,this._face_mesh_by_instance=new Map,this._pipeline_id_by_face_landmark_id=new Map,this._face_landmark_by_instance=new Map,this._pipeline_id_by_barcode_finder_id=new Map,this._barcode_finder_by_instance=new Map,this._pipeline_id_by_instant_world_tracker_id=new Map,this._instant_world_tracker_by_instance=new Map}return o(e,[{key:"processBuffer",value:function(e){var t=this;this._deserializer.setData(e),this._deserializer.forMessages((function(e,n){switch(e){case 33:t._impl.log_level_set(n.logLevel());break;case 30:t._impl.analytics_project_id_set(n.string());break;case 26:var r=n.type(),a=t._impl.pipeline_create();t._pipeline_by_instance.set(r,a),t._pipeline_id_by_pipeline_id.set(r,r),t.serializersByPipelineId.set(r,new u.MessageSerializer((function(e){t._sender(r,e)})));break;case 27:var i=n.type(),o=t._pipeline_by_instance.get(i);if(void 0===o)return;t._impl.pipeline_destroy(o),t._pipeline_by_instance.delete(i);break;case 9:var c=n.type(),f=t._pipeline_by_instance.get(c);if(void 0===f)return;t._impl.pipeline_frame_update(f);break;case 8:var s=n.type(),_=t._pipeline_by_instance.get(s);if(void 0===_)return;t._impl.pipeline_camera_frame_submit(_,n.dataWithLength(),n.int(),n.int(),n.int(),n.matrix4x4());break;case 10:var l=n.type(),p=t._pipeline_by_instance.get(l);if(void 0===p)return;t._impl.pipeline_motion_accelerometer_submit(p,n.timestamp(),n.float(),n.float(),n.float());break;case 11:var d=n.type(),m=t._pipeline_by_instance.get(d);if(void 0===m)return;t._impl.pipeline_motion_rotation_rate_submit(m,n.timestamp(),n.float(),n.float(),n.float());break;case 12:var h=n.type(),y=t._pipeline_by_instance.get(h);if(void 0===y)return;t._impl.pipeline_motion_attitude_submit(y,n.timestamp(),n.float(),n.float(),n.float());break;case 28:var b=n.type(),v=n.type(),g=t._pipeline_by_instance.get(v),w=n.string(),M=t._impl.camera_source_create(g,w);t._camera_source_by_instance.set(b,M),t._pipeline_id_by_camera_source_id.set(b,v);break;case 29:var k=n.type(),x=t._camera_source_by_instance.get(k);if(void 0===x)return;t._impl.camera_source_destroy(x),t._camera_source_by_instance.delete(k);break;case 2:var z=n.type(),A=n.type(),L=t._pipeline_by_instance.get(A),E=t._impl.image_tracker_create(L);t._image_tracker_by_instance.set(z,E),t._pipeline_id_by_image_tracker_id.set(z,A);break;case 13:var O=n.type(),S=t._image_tracker_by_instance.get(O);if(void 0===S)return;t._impl.image_tracker_destroy(S),t._image_tracker_by_instance.delete(O);break;case 4:var C=n.type(),T=t._image_tracker_by_instance.get(C);if(void 0===T)return;t._impl.image_tracker_target_load_from_memory(T,n.dataWithLength());break;case 3:var P=n.type(),I=t._image_tracker_by_instance.get(P);if(void 0===I)return;t._impl.image_tracker_enabled_set(I,n.bool());break;case 19:var B=n.type(),F=n.type(),j=t._pipeline_by_instance.get(F),D=t._impl.face_tracker_create(j);t._face_tracker_by_instance.set(B,D),t._pipeline_id_by_face_tracker_id.set(B,F);break;case 20:var R=n.type(),V=t._face_tracker_by_instance.get(R);if(void 0===V)return;t._impl.face_tracker_destroy(V),t._face_tracker_by_instance.delete(R);break;case 21:var q=n.type(),G=t._face_tracker_by_instance.get(q);if(void 0===G)return;t._impl.face_tracker_model_load_from_memory(G,n.dataWithLength());break;case 22:var N=n.type(),U=t._face_tracker_by_instance.get(N);if(void 0===U)return;t._impl.face_tracker_enabled_set(U,n.bool());break;case 23:var W=n.type(),H=t._face_tracker_by_instance.get(W);if(void 0===H)return;t._impl.face_tracker_max_faces_set(H,n.int());break;case 24:var Z=n.type(),Y=t._impl.face_mesh_create();t._face_mesh_by_instance.set(Z,Y);break;case 25:var X=n.type(),K=t._face_mesh_by_instance.get(X);if(void 0===K)return;t._impl.face_mesh_destroy(K),t._face_mesh_by_instance.delete(X);break;case 31:var J=n.type(),Q=n.faceLandmarkName(),$=t._impl.face_landmark_create(Q);t._face_landmark_by_instance.set(J,$);break;case 32:var ee=n.type(),te=t._face_landmark_by_instance.get(ee);if(void 0===te)return;t._impl.face_landmark_destroy(te),t._face_landmark_by_instance.delete(ee);break;case 15:var ne=n.type(),re=n.type(),ae=t._pipeline_by_instance.get(re),ie=t._impl.barcode_finder_create(ae);t._barcode_finder_by_instance.set(ne,ie),t._pipeline_id_by_barcode_finder_id.set(ne,re);break;case 16:var oe=n.type(),ue=t._barcode_finder_by_instance.get(oe);if(void 0===ue)return;t._impl.barcode_finder_destroy(ue),t._barcode_finder_by_instance.delete(oe);break;case 17:var ce=n.type(),fe=t._barcode_finder_by_instance.get(ce);if(void 0===fe)return;t._impl.barcode_finder_enabled_set(fe,n.bool());break;case 18:var se=n.type(),_e=t._barcode_finder_by_instance.get(se);if(void 0===_e)return;t._impl.barcode_finder_formats_set(_e,n.barcodeFormat());break;case 5:var le=n.type(),pe=n.type(),de=t._pipeline_by_instance.get(pe),me=t._impl.instant_world_tracker_create(de);t._instant_world_tracker_by_instance.set(le,me),t._pipeline_id_by_instant_world_tracker_id.set(le,pe);break;case 14:var he=n.type(),ye=t._instant_world_tracker_by_instance.get(he);if(void 0===ye)return;t._impl.instant_world_tracker_destroy(ye),t._instant_world_tracker_by_instance.delete(he);break;case 6:var be=n.type(),ve=t._instant_world_tracker_by_instance.get(be);if(void 0===ve)return;t._impl.instant_world_tracker_enabled_set(ve,n.bool());break;case 7:var ge=n.type(),we=t._instant_world_tracker_by_instance.get(ge);if(void 0===we)return;t._impl.instant_world_tracker_anchor_pose_set_from_camera_offset(we,n.float(),n.float(),n.float(),n.instantTrackerTransformOrientation())}}))}},{key:"exploreState",value:function(){var e,t=this,n=a(this._pipeline_by_instance);try{var i=function(){var n=r(e.value,2),a=n[0],i=n[1],o=t._pipeline_id_by_pipeline_id.get(a);if(!o)return"continue";var u=t.serializersByPipelineId.get(o);if(!u)return"continue";u.sendMessage(7,(function(e){e.type(a),e.int(t._impl.pipeline_frame_number(i))})),u.sendMessage(6,(function(e){e.type(a),e.cameraModel(t._impl.pipeline_camera_model(i))})),u.sendMessage(5,(function(e){e.type(a),e.int(t._impl.pipeline_camera_frame_user_data(i))})),u.sendMessage(11,(function(e){e.type(a),e.matrix4x4(t._impl.pipeline_camera_frame_camera_attitude(i))}))};for(n.s();!(e=n.n()).done;)i()}catch(P){n.e(P)}finally{n.f()}var o,u=a(this._camera_source_by_instance);try{for(u.s();!(o=u.n()).done;){var c=r(o.value,2),f=c[0],s=(c[1],this._pipeline_id_by_camera_source_id.get(f));if(s)this.serializersByPipelineId.get(s)}}catch(P){u.e(P)}finally{u.f()}var _,l=a(this._image_tracker_by_instance);try{var p=function(){var e=r(_.value,2),n=e[0],a=e[1],i=t._pipeline_id_by_image_tracker_id.get(n);if(!i)return"continue";var o=t.serializersByPipelineId.get(i);if(!o)return"continue";o.sendMessage(18,(function(e){e.type(n),e.int(t._impl.image_tracker_target_loaded_version(a))})),o.sendMessage(20,(function(e){e.type(n),e.int(t._impl.image_tracker_target_count(a))})),o.sendMessage(1,(function(e){e.type(n),e.int(t._impl.image_tracker_anchor_count(a))}));for(var u=function(e){o.sendMessage(2,(function(r){r.type(n),r.int(e),r.string(t._impl.image_tracker_anchor_id(a,e))}))},c=0;c<t._impl.image_tracker_anchor_count(a);c++)u(c);for(var f=function(e){o.sendMessage(3,(function(r){r.type(n),r.int(e),r.matrix4x4(t._impl.image_tracker_anchor_pose_raw(a,e))}))},s=0;s<t._impl.image_tracker_anchor_count(a);s++)f(s)};for(l.s();!(_=l.n()).done;)p()}catch(P){l.e(P)}finally{l.f()}var d,m=a(this._face_tracker_by_instance);try{var h=function(){var e=r(d.value,2),n=e[0],a=e[1],i=t._pipeline_id_by_face_tracker_id.get(n);if(!i)return"continue";var o=t.serializersByPipelineId.get(i);if(!o)return"continue";o.sendMessage(17,(function(e){e.type(n),e.int(t._impl.face_tracker_model_loaded_version(a))})),o.sendMessage(12,(function(e){e.type(n),e.int(t._impl.face_tracker_anchor_count(a))}));for(var u=function(e){o.sendMessage(13,(function(r){r.type(n),r.int(e),r.string(t._impl.face_tracker_anchor_id(a,e))}))},c=0;c<t._impl.face_tracker_anchor_count(a);c++)u(c);for(var f=function(e){o.sendMessage(14,(function(r){r.type(n),r.int(e),r.matrix4x4(t._impl.face_tracker_anchor_pose_raw(a,e))}))},s=0;s<t._impl.face_tracker_anchor_count(a);s++)f(s);for(var _=function(e){o.sendMessage(15,(function(r){r.type(n),r.int(e),r.identityCoefficients(t._impl.face_tracker_anchor_identity_coefficients(a,e))}))},l=0;l<t._impl.face_tracker_anchor_count(a);l++)_(l);for(var p=function(e){o.sendMessage(16,(function(r){r.type(n),r.int(e),r.expressionCoefficients(t._impl.face_tracker_anchor_expression_coefficients(a,e))}))},m=0;m<t._impl.face_tracker_anchor_count(a);m++)p(m)};for(m.s();!(d=m.n()).done;)h()}catch(P){m.e(P)}finally{m.f()}var y,b=a(this._face_mesh_by_instance);try{for(b.s();!(y=b.n()).done;){var v=r(y.value,2),g=v[0],w=(v[1],this._pipeline_id_by_face_mesh_id.get(g));if(w)this.serializersByPipelineId.get(w)}}catch(P){b.e(P)}finally{b.f()}var M,k=a(this._face_landmark_by_instance);try{for(k.s();!(M=k.n()).done;){var x=r(M.value,2),z=x[0],A=(x[1],this._pipeline_id_by_face_landmark_id.get(z));if(A)this.serializersByPipelineId.get(A)}}catch(P){k.e(P)}finally{k.f()}var L,E=a(this._barcode_finder_by_instance);try{var O=function(){var e=r(L.value,2),n=e[0],a=e[1],i=t._pipeline_id_by_barcode_finder_id.get(n);if(!i)return"continue";var o=t.serializersByPipelineId.get(i);if(!o)return"continue";o.sendMessage(8,(function(e){e.type(n),e.int(t._impl.barcode_finder_found_number(a))}));for(var u=function(e){o.sendMessage(9,(function(r){r.type(n),r.int(e),r.string(t._impl.barcode_finder_found_text(a,e))}))},c=0;c<t._impl.barcode_finder_found_number(a);c++)u(c);for(var f=function(e){o.sendMessage(10,(function(r){r.type(n),r.int(e),r.barcodeFormat(t._impl.barcode_finder_found_format(a,e))}))},s=0;s<t._impl.barcode_finder_found_number(a);s++)f(s)};for(E.s();!(L=E.n()).done;)O()}catch(P){E.e(P)}finally{E.f()}var S,C=a(this._instant_world_tracker_by_instance);try{var T=function(){var e=r(S.value,2),n=e[0],a=e[1],i=t._pipeline_id_by_instant_world_tracker_id.get(n);if(!i)return"continue";var o=t.serializersByPipelineId.get(i);if(!o)return"continue";o.sendMessage(4,(function(e){e.type(n),e.matrix4x4(t._impl.instant_world_tracker_anchor_pose_raw(a))}))};for(C.s();!(S=C.n()).done;)T()}catch(P){C.e(P)}finally{C.f()}}}]),e}();t.zappar_server=f},776:function(e,t,n){"use strict";var r=n(575).default,a=n(913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MsgManager=void 0;var i=n(319),o=function(){function e(){r(this,e),this.onOutgoingMessage=new i.Event,this.onIncomingMessage=new i.Event1,this._outgoingMessages=[]}return a(e,[{key:"postIncomingMessage",value:function(e){this.onIncomingMessage.emit(e)}},{key:"postOutgoingMessage",value:function(e,t){this._outgoingMessages.push({msg:e,transferables:t}),this.onOutgoingMessage.emit()}},{key:"getOutgoingMessages",value:function(){var e=this._outgoingMessages;return this._outgoingMessages=[],e}}]),e}();t.MsgManager=o},363:function(e,t,n){"use strict";var r=n(575).default,a=n(913).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MessageSerializer=void 0;var i=function(){function e(t){var n=this;r(this,e),this._messageSender=t,this._freeBufferPool=[],this._buffer=new ArrayBuffer(16),this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer),this._f64View=new Float64Array(this._buffer),this._u8View=new Uint8Array(this._buffer),this._u8cView=new Uint8ClampedArray(this._buffer),this._u16View=new Uint16Array(this._buffer),this._u32View=new Uint32Array(this._buffer),this._offset=1,this._startOffset=-1,this._timeoutSet=!1,this._appender={int:function(e){return n.int(e)},bool:function(e){return n.int(e?1:0)},float:function(e){return n.float(e)},string:function(e){return n.string(e)},dataWithLength:function(e){return n.arrayBuffer(e)},type:function(e){return n.int(e)},matrix4x4:function(e){return n.float32ArrayBuffer(e)},identityCoefficients:function(e){return n.float32ArrayBuffer(e)},expressionCoefficients:function(e){return n.float32ArrayBuffer(e)},cameraModel:function(e){return n.float32ArrayBuffer(e)},timestamp:function(e){return n.double(e)},barcodeFormat:function(e){return n.int(e)},faceLandmarkName:function(e){return n.int(e)},instantTrackerTransformOrientation:function(e){return n.int(e)},logLevel:function(e){return n.int(e)}},this._freeBufferPool.push(new ArrayBuffer(16)),this._freeBufferPool.push(new ArrayBuffer(16))}return a(e,[{key:"bufferReturn",value:function(e){this._freeBufferPool.push(e)}},{key:"_ensureArrayBuffer",value:function(e){var t=4*(this._offset+e+8);if(!(this._buffer&&this._buffer.byteLength>=t)){var n=void 0;if(!n){var r=t;r--,r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16,r++,n=new ArrayBuffer(r)}var a=this._buffer?this._i32View:void 0;this._buffer=n,this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer),this._f64View=new Float64Array(this._buffer),this._u8View=new Uint8Array(this._buffer),this._u8cView=new Uint8ClampedArray(this._buffer),this._u16View=new Uint16Array(this._buffer),this._u32View=new Uint32Array(this._buffer),a&&this._i32View.set(a.subarray(0,this._offset))}}},{key:"sendMessage",value:function(e,t){this._ensureArrayBuffer(4),this._startOffset=this._offset,this._i32View[this._offset+1]=e,this._offset+=2,t(this._appender),this._i32View[this._startOffset]=this._offset-this._startOffset,this._startOffset=-1,this._sendOneTime()}},{key:"_sendOneTime",value:function(){var e=this;!1===this._timeoutSet&&(this._timeoutSet=!0,setTimeout((function(){e._timeoutSet=!1,e._send()}),0))}},{key:"_send",value:function(){0!==this._freeBufferPool.length?(this._i32View[0]=this._offset,this._messageSender(this._buffer),this._buffer=void 0,this._buffer=this._freeBufferPool.pop(),this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer),this._f64View=new Float64Array(this._buffer),this._u8View=new Uint8Array(this._buffer),this._u8cView=new Uint8ClampedArray(this._buffer),this._u16View=new Uint16Array(this._buffer),this._u32View=new Uint32Array(this._buffer),this._offset=1,this._startOffset=-1):this._sendOneTime()}},{key:"int",value:function(e){this._ensureArrayBuffer(1),this._i32View[this._offset]=e,this._offset++}},{key:"double",value:function(e){this._ensureArrayBuffer(2),this._offset%2===1&&this._offset++,this._f64View[this._offset/2]=e,this._offset+=2}},{key:"float",value:function(e){this._ensureArrayBuffer(1),this._f32View[this._offset]=e,this._offset++}},{key:"int32Array",value:function(e){this._ensureArrayBuffer(e.length);for(var t=0;t<e.length;++t)this._i32View[this._offset+t]=e[t];this._offset+=e.length}},{key:"float32Array",value:function(e){this._ensureArrayBuffer(e.length);for(var t=0;t<e.length;++t)this._f32View[this._offset+t]=e[t];this._offset+=e.length}},{key:"booleanArray",value:function(e){this._ensureArrayBuffer(e.length);for(var t=0;t<e.length;++t)this._i32View[this._offset+t]=e[t]?1:0;this._offset+=e.length}},{key:"uint8ArrayBuffer",value:function(e){this._ensureArrayBuffer(e.byteLength/4),this._i32View[this._offset]=e.byteLength,this._offset++,this._u8View.set(e,4*this._offset),this._offset+=e.byteLength>>2,0!==(3&e.byteLength)&&this._offset++}},{key:"arrayBuffer",value:function(e){var t=new Uint8Array(e);this.uint8ArrayBuffer(t)}},{key:"uint8ClampedArrayBuffer",value:function(e){this._ensureArrayBuffer(e.byteLength/4),this._i32View[this._offset]=e.byteLength,this._offset++,this._u8cView.set(e,4*this._offset),this._offset+=e.byteLength>>2,0!==(3&e.byteLength)&&this._offset++}},{key:"float32ArrayBuffer",value:function(e){this._ensureArrayBuffer(e.byteLength/4),this._i32View[this._offset]=e.length,this._offset++,this._f32View.set(e,this._offset),this._offset+=e.length}},{key:"uint16ArrayBuffer",value:function(e){this._ensureArrayBuffer(e.byteLength/4),this._i32View[this._offset]=e.length,this._offset++;var t=2*this._offset;this._u16View.set(e,t),this._offset+=e.length>>1,0!==(1&e.length)&&this._offset++}},{key:"int32ArrayBuffer",value:function(e){this._ensureArrayBuffer(e.byteLength/4),this._i32View[this._offset]=e.length,this._offset++,this._i32View.set(e,this._offset),this._offset+=e.length}},{key:"uint32ArrayBuffer",value:function(e){this._ensureArrayBuffer(e.byteLength/4),this._i32View[this._offset]=e.length,this._offset++,this._u32View.set(e,this._offset),this._offset+=e.length}},{key:"string",value:function(e){var t=(new TextEncoder).encode(e);this._ensureArrayBuffer(t.byteLength/4),this._i32View[this._offset]=t.byteLength,this._offset++,this._u8View.set(t,4*this._offset),this._offset+=t.byteLength>>2,0!==(3&t.byteLength)&&this._offset++}}]),e}();t.MessageSerializer=i},407:function(e,t,n){"use strict";var r=n(757),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.launchWorkerServer=t.messageManager=void 0;var i=n(177),o=n(832),u=n(370),c=n(776),f=n(0);t.messageManager=new c.MsgManager,t.launchWorkerServer=function(e){return a(this,void 0,void 0,r.mark((function n(){var a;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=i.default({locateFile:function(t,n){return t.endsWith("zcv.wasm")?e:n+t},onRuntimeInitialized:function(){var e=o.getRuntimeObject(a),n=new u.zappar_server(e,(function(e,n){t.messageManager.postOutgoingMessage({p:e,t:"zappar",d:n},[n])}));t.messageManager.postOutgoingMessage("loaded",[]),t.messageManager.onIncomingMessage.bind((function(r){var a;switch(r.t){case"zappar":n.processBuffer(r.d),t.messageManager.postOutgoingMessage({t:"buf",d:r.d},[r.d]);break;case"buf":null===(a=n.serializersByPipelineId.get(r.p))||void 0===a||a.bufferReturn(r.d);break;case"cameraFrameC2S":var i=r,o=f.mat4.create();i.userFacing&&f.mat4.fromScaling(o,[-1,1,-1]);var u=n._pipeline_by_instance.get(i.p);u&&(e.pipeline_camera_frame_submit(u,i.d,i.width,i.height,i.token,o),e.pipeline_frame_update(u),n.exploreState());var c={token:i.token,d:i.d,p:i.p,t:"cameraFrameRecycleS2C"};t.messageManager.postOutgoingMessage(c,[i.d])}}))}});case 1:case"end":return n.stop()}}),n)})))}},177:function(e,t,n){"use strict";n.r(t);var r=function(){var e="undefined"!==typeof document&&document.currentScript?document.currentScript.src:void 0;return function(t){var n;t=t||{},n||(n="undefined"!==typeof t?t:{});var r,a={};for(r in n)n.hasOwnProperty(r)&&(a[r]=n[r]);n.arguments=[],n.thisProgram="./this.program",n.quit=function(e,t){throw t},n.preRun=[],n.postRun=[];var i="";function o(e){return n.locateFile?n.locateFile(e,i):i+e}i=self.location.href,e&&(i=e),i=0!==i.indexOf("blob:")?i.substr(0,i.lastIndexOf("/")+1):"",n.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},n.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)},n.readAsync=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)},n.setWindowTitle=function(e){document.title=e};var u=n.print||("undefined"!==typeof console?console.log.bind(console):"undefined"!==typeof print?print:null),c=n.printErr||("undefined"!==typeof printErr?printErr:"undefined"!==typeof console&&console.warn.bind(console)||u);for(r in a)a.hasOwnProperty(r)&&(n[r]=a[r]);function f(e){var t=F;return F=F+e+15&-16,t}function s(e){var t=T[G>>2];return e=t+e+15&-16,T[G>>2]=e,e>=X&&!Z()?(T[G>>2]=t,0):t}function _(e){var t;return t||(t=16),Math.ceil(e/t)*t}a=void 0;var l,p={"f64-rem":function(e,t){return e%t},debugger:function(){}},d={};function m(e,t,r){return r&&r.length?n["dynCall_"+e].apply(null,[t].concat(r)):n["dynCall_"+e].call(null,t)}var h=!1;function y(e,t){e||wr("Assertion failed: "+t)}function b(e){var t=n["_"+e];return y(t,"Cannot call unknown function "+e+", make sure it is exported"),t}var v={stackSave:function(){vr()},stackRestore:function(){br()},arrayToC:function(e){var t=yr(e.length);return E.set(e,t),t},stringToC:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var n=1+(e.length<<2);t=yr(n),z(e,O,t,n)}return t}},g={string:v.stringToC,array:v.arrayToC};function w(e){var t;if(0===t||!e)return"";for(var n,r=0,a=0;(r|=n=O[e+a>>0],0!=n||t)&&(a++,!t||a!=t););if(t||(t=a),n="",128>r){for(;0<t;)r=String.fromCharCode.apply(String,O.subarray(e,e+Math.min(t,1024))),n=n?n+r:r,e+=1024,t-=1024;return n}return x(e)}var M="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function k(e,t){for(var n=t;e[n];)++n;if(16<n-t&&e.subarray&&M)return M.decode(e.subarray(t,n));for(n="";;){var r=e[t++];if(!r)return n;if(128&r){var a=63&e[t++];if(192==(224&r))n+=String.fromCharCode((31&r)<<6|a);else{var i=63&e[t++];if(224==(240&r))r=(15&r)<<12|a<<6|i;else{var o=63&e[t++];if(240==(248&r))r=(7&r)<<18|a<<12|i<<6|o;else{var u=63&e[t++];if(248==(252&r))r=(3&r)<<24|a<<18|i<<12|o<<6|u;else r=(1&r)<<30|a<<24|i<<18|o<<12|u<<6|63&e[t++]}}65536>r?n+=String.fromCharCode(r):(r-=65536,n+=String.fromCharCode(55296|r>>10,56320|1023&r))}}else n+=String.fromCharCode(r)}}function x(e){return k(O,e)}function z(e,t,n,r){if(!(0<r))return 0;var a=n;r=n+r-1;for(var i=0;i<e.length;++i){var o=e.charCodeAt(i);if(55296<=o&&57343>=o)o=65536+((1023&o)<<10)|1023&e.charCodeAt(++i);if(127>=o){if(n>=r)break;t[n++]=o}else{if(2047>=o){if(n+1>=r)break;t[n++]=192|o>>6}else{if(65535>=o){if(n+2>=r)break;t[n++]=224|o>>12}else{if(2097151>=o){if(n+3>=r)break;t[n++]=240|o>>18}else{if(67108863>=o){if(n+4>=r)break;t[n++]=248|o>>24}else{if(n+5>=r)break;t[n++]=252|o>>30,t[n++]=128|o>>24&63}t[n++]=128|o>>18&63}t[n++]=128|o>>12&63}t[n++]=128|o>>6&63}t[n++]=128|63&o}}return t[n]=0,n-a}function A(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);55296<=r&&57343>=r&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++n)),127>=r?++t:t=2047>=r?t+2:65535>=r?t+3:2097151>=r?t+4:67108863>=r?t+5:t+6}return t}"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");var L,E,O,S,C,T,P,I,B,F,j,D,R,V,q,G,N=65536,U=16777216;function W(e,t){return 0<e%t&&(e+=t-e%t),e}function H(){n.HEAP8=E=new Int8Array(L),n.HEAP16=S=new Int16Array(L),n.HEAP32=T=new Int32Array(L),n.HEAPU8=O=new Uint8Array(L),n.HEAPU16=C=new Uint16Array(L),n.HEAPU32=P=new Uint32Array(L),n.HEAPF32=I=new Float32Array(L),n.HEAPF64=B=new Float64Array(L)}function Z(){var e=n.usingWasm?N:U,t=2147483648-e;if(T[G>>2]>t)return!1;var r=X;for(X=Math.max(X,16777216);X<T[G>>2];)X=536870912>=X?W(2*X,e):Math.min(W((3*X+2147483648)/4,e),t);return(e=n.reallocBuffer(X))&&e.byteLength==X?(n.buffer=L=e,H(),!0):(X=r,!1)}F=G=0,j=!1,n.reallocBuffer||(n.reallocBuffer=function(e){try{var t=E,n=new ArrayBuffer(e);new Int8Array(n).set(t)}catch(r){return!1}return!!pr(n)&&n});try{Function.prototype.call.bind(Object.getOwnPropertyDescriptor(ArrayBuffer.prototype,"byteLength").get)(new ArrayBuffer(4))}catch(Mr){(function(e){return e.byteLength})}var Y=n.TOTAL_STACK||5242880,X=n.TOTAL_MEMORY||16777216;function K(e){for(;0<e.length;){var t=e.shift();if("function"==typeof t)t();else{var r=t.g;"number"===typeof r?void 0===t.P?n.dynCall_v(r):n.dynCall_vi(r,t.P):r(void 0===t.P?null:t.P)}}}X<Y&&c("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+X+"! (TOTAL_STACK="+Y+")"),n.buffer?L=n.buffer:("object"===typeof WebAssembly&&"function"===typeof WebAssembly.Memory?(n.wasmMemory=new WebAssembly.Memory({initial:X/N}),L=n.wasmMemory.buffer):L=new ArrayBuffer(X),n.buffer=L),H();var J=[],Q=[],$=[],ee=[],te=[],ne=!1;function re(){var e=n.preRun.shift();J.unshift(e)}var ae=Math.abs,ie=Math.ceil,oe=Math.floor,ue=Math.min,ce=0,fe=null,se=null;function _e(){ce++,n.monitorRunDependencies&&n.monitorRunDependencies(ce)}function le(){if(ce--,n.monitorRunDependencies&&n.monitorRunDependencies(ce),0==ce&&(null!==fe&&(clearInterval(fe),fe=null),se)){var e=se;se=null,e()}}function pe(e){return String.prototype.startsWith?e.startsWith("data:application/octet-stream;base64,"):0===e.indexOf("data:application/octet-stream;base64,")}n.preloadedImages={},n.preloadedAudios={},function(){function e(){try{if(n.wasmBinary)return new Uint8Array(n.wasmBinary);if(n.readBinary)return n.readBinary(i);throw"both async and sync fetching of the wasm failed"}catch(e){wr(e)}}function t(){return n.wasmBinary||"function"!==typeof fetch?new Promise((function(t){t(e())})):fetch(i,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at \'"+i+"\'";return e.arrayBuffer()})).catch((function(){return e()}))}function r(e){function r(e){if((s=e.exports).memory){e=s.memory;var t=n.buffer;e.byteLength<t.byteLength&&c("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here"),t=new Int8Array(t),new Int8Array(e).set(t),n.buffer=L=e,H()}n.asm=s,n.usingWasm=!0,le()}function a(e){r(e.instance)}function o(e){t().then((function(e){return WebAssembly.instantiate(e,f)})).then(e,(function(e){c("failed to asynchronously prepare wasm: "+e),wr(e)}))}if("object"!==typeof WebAssembly)return c("no native wasm support detected"),!1;if(!(n.wasmMemory instanceof WebAssembly.Memory))return c("no native wasm Memory in use"),!1;if(e.memory=n.wasmMemory,f.global={NaN:NaN,Infinity:1/0},f["global.Math"]=Math,f.env=e,_e(),n.instantiateWasm)try{return n.instantiateWasm(f,r)}catch(u){return c("Module.instantiateWasm callback failed with error: "+u),!1}return n.wasmBinary||"function"!==typeof WebAssembly.instantiateStreaming||pe(i)||"function"!==typeof fetch?o(a):WebAssembly.instantiateStreaming(fetch(i,{credentials:"same-origin"}),f).then(a,(function(e){c("wasm streaming compile failed: "+e),c("falling back to ArrayBuffer instantiation"),o(a)})),{}}var a="zcv.wast",i="zcv.wasm",u="zcv.temp.asm.js";pe(a)||(a=o(a)),pe(i)||(i=o(i)),pe(u)||(u=o(u));var f={global:null,env:null,asm2wasm:p,parent:n},s=null;n.asmPreload=n.asm;var _=n.reallocBuffer;n.reallocBuffer=function(e){if("asmjs"===l)var t=_(e);else e:{e=W(e,n.usingWasm?N:U);var r=n.buffer.byteLength;if(n.usingWasm)try{t=-1!==n.wasmMemory.grow((e-r)/65536)?n.buffer=n.wasmMemory.buffer:null;break e}catch(a){t=null;break e}t=void 0}return t};var l="";n.asm=function(e,t){if(!t.table){void 0===(e=n.wasmTableSize)&&(e=1024);var a=n.wasmMaxTableSize;t.table="object"===typeof WebAssembly&&"function"===typeof WebAssembly.Table?void 0!==a?new WebAssembly.Table({initial:e,maximum:a,element:"anyfunc"}):new WebAssembly.Table({initial:e,element:"anyfunc"}):Array(e),n.wasmTable=t.table}return t.__memory_base||(t.__memory_base=n.STATIC_BASE),t.__table_base||(t.__table_base=0),y(t=r(t),"no binaryen method succeeded."),t}}();var de=[function(){if(self.crypto&&self.crypto.getRandomValues){var e=new Uint32Array(1);return self.crypto.getRandomValues(e),e[0]}return 9007199254740991*Math.random()}];F=433680,Q.push({g:function(){Wn()}},{g:function(){er()}},{g:function(){cr()}},{g:function(){lr()}},{g:function(){sr()}},{g:function(){Jn()}},{g:function(){$n()}},{g:function(){Qn()}},{g:function(){Yn()}},{g:function(){Kn()}},{g:function(){Xn()}},{g:function(){fr()}},{g:function(){Hn()}},{g:function(){tr()}},{g:function(){Zn()}},{g:function(){ar()}},{g:function(){nr()}},{g:function(){rr()}},{g:function(){ir()}},{g:function(){or()}},{g:function(){ur()}}),n.STATIC_BASE=1024,n.STATIC_BUMP=432656;var me=F;F+=16;var he={};function ye(){wr()}function be(){return"undefined"!==typeof dateNow||self.performance&&self.performance.now}var ve={I:1,u:2,Fc:3,Bb:4,M:5,ja:6,Ua:7,Zb:8,B:9,ib:10,fa:11,Pc:11,ya:12,W:13,ub:14,lc:15,ga:16,ha:17,Qc:18,Y:19,Z:20,N:21,i:22,Ub:23,wa:24,D:25,Mc:26,vb:27,hc:28,O:29,Cc:30,Nb:31,vc:32,rb:33,zc:34,cc:42,yb:43,jb:44,Eb:45,Fb:46,Gb:47,Mb:48,Nc:49,Xb:50,Db:51,ob:35,$b:37,$a:52,cb:53,Rc:54,Vb:55,eb:56,fb:57,pb:35,gb:59,jc:60,Yb:61,Jc:62,ic:63,dc:64,ec:65,Bc:66,ac:67,Xa:68,Gc:69,kb:70,wc:71,Pb:72,sb:73,bb:74,qc:76,ab:77,Ac:78,Hb:79,Ib:80,Lb:81,Kb:82,Jb:83,kc:38,ia:39,Qb:36,X:40,rc:95,uc:96,nb:104,Wb:105,Ya:97,yc:91,oc:88,fc:92,Dc:108,mb:111,Va:98,lb:103,Tb:101,Rb:100,Kc:110,wb:112,xb:113,Ab:115,Za:114,qb:89,Ob:90,xc:93,Ec:94,Wa:99,Sb:102,Cb:106,mc:107,Lc:109,Oc:87,tb:122,Hc:116,pc:95,bc:123,zb:84,sc:75,hb:125,nc:131,tc:130,Ic:86};function ge(e){return n.___errno_location&&(T[n.___errno_location()>>2]=e),e}function we(e,t){if(0===e)e=Date.now();else{if(1!==e||!be())return ge(ve.i),-1;e=ye()}return T[t>>2]=e/1e3|0,T[t+4>>2]=e%1e3*1e6|0,0}var Me=0,ke=[],xe={};function ze(e){if(!e||xe[e])return e;for(var t in xe){var n=+t;if(xe[n].ka===e)return n}return e}function Ae(e){if(e){var t=xe[e];y(0<t.J),t.J--,0!==t.J||t.L||(t.oa&&n.dynCall_vi(t.oa,e),delete xe[e],Le(e))}}function Le(e){try{return dr(e)}catch(t){}}function Ee(){var e=ke.pop();throw e=ze(e),xe[e].L||(ke.push(e),xe[e].L=!0),Me=e,e+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}var Oe={0:"Success",1:"Not super-user",2:"No such file or directory",3:"No such process",4:"Interrupted system call",5:"I/O error",6:"No such device or address",7:"Arg list too long",8:"Exec format error",9:"Bad file number",10:"No children",11:"No more processes",12:"Not enough core",13:"Permission denied",14:"Bad address",15:"Block device required",16:"Mount device busy",17:"File exists",18:"Cross-device link",19:"No such device",20:"Not a directory",21:"Is a directory",22:"Invalid argument",23:"Too many open files in system",24:"Too many open files",25:"Not a typewriter",26:"Text file busy",27:"File too large",28:"No space left on device",29:"Illegal seek",30:"Read only file system",31:"Too many links",32:"Broken pipe",33:"Math arg out of domain of func",34:"Math result not representable",35:"File locking deadlock error",36:"File or path name too long",37:"No record locks available",38:"Function not implemented",39:"Directory not empty",40:"Too many symbolic links",42:"No message of desired type",43:"Identifier removed",44:"Channel number out of range",45:"Level 2 not synchronized",46:"Level 3 halted",47:"Level 3 reset",48:"Link number out of range",49:"Protocol driver not attached",50:"No CSI structure available",51:"Level 2 halted",52:"Invalid exchange",53:"Invalid request descriptor",54:"Exchange full",55:"No anode",56:"Invalid request code",57:"Invalid slot",59:"Bad font file fmt",60:"Device not a stream",61:"No data (for no delay io)",62:"Timer expired",63:"Out of streams resources",64:"Machine is not on the network",65:"Package not installed",66:"The object is remote",67:"The link has been severed",68:"Advertise error",69:"Srmount error",70:"Communication error on send",71:"Protocol error",72:"Multihop attempted",73:"Cross mount point (not really error)",74:"Trying to read unreadable message",75:"Value too large for defined data type",76:"Given log. name not unique",77:"f.d. invalid for this operation",78:"Remote address changed",79:"Can   access a needed shared lib",80:"Accessing a corrupted shared lib",81:".lib section in a.out corrupted",82:"Attempting to link in too many libs",83:"Attempting to exec a shared library",84:"Illegal byte sequence",86:"Streams pipe error",87:"Too many users",88:"Socket operation on non-socket",89:"Destination address required",90:"Message too long",91:"Protocol wrong type for socket",92:"Protocol not available",93:"Unknown protocol",94:"Socket type not supported",95:"Not supported",96:"Protocol family not supported",97:"Address family not supported by protocol family",98:"Address already in use",99:"Address not available",100:"Network interface is not configured",101:"Network is unreachable",102:"Connection reset by network",103:"Connection aborted",104:"Connection reset by peer",105:"No buffer space available",106:"Socket is already connected",107:"Socket is not connected",108:"Can\'t send after socket shutdown",109:"Too many references",110:"Connection timed out",111:"Connection refused",112:"Host is down",113:"Host is unreachable",114:"Socket already connected",115:"Connection already in progress",116:"Stale file handle",122:"Quota exceeded",123:"No medium (in tape drive)",125:"Operation canceled",130:"Previous owner died",131:"State not recoverable"};function Se(e,t){for(var n=0,r=e.length-1;0<=r;r--){var a=e[r];"."===a?e.splice(r,1):".."===a?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n;n--)e.unshift("..");return e}function Ce(e){var t="/"===e.charAt(0),n="/"===e.substr(-1);return(e=Se(e.split("/").filter((function(e){return!!e})),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e}function Te(e){var t=/^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/.exec(e).slice(1);return e=t[0],t=t[1],e||t?(t&&(t=t.substr(0,t.length-1)),e+t):"."}function Pe(e){if("/"===e)return"/";var t=e.lastIndexOf("/");return-1===t?e:e.substr(t+1)}function Ie(){for(var e="",t=!1,n=arguments.length-1;-1<=n&&!t;n--){if("string"!==typeof(t=0<=n?arguments[n]:"/"))throw new TypeError("Arguments to path.resolve must be strings");if(!t)return"";e=t+"/"+e,t="/"===t.charAt(0)}return(t?"/":"")+(e=Se(e.split("/").filter((function(e){return!!e})),!t).join("/"))||"."}var Be=[];function Fe(e,t){Be[e]={input:[],output:[],G:t},ct(e,je)}var je={open:function(e){var t=Be[e.node.rdev];if(!t)throw new Ye(ve.Y);e.tty=t,e.seekable=!1},close:function(e){e.tty.G.flush(e.tty)},flush:function(e){e.tty.G.flush(e.tty)},read:function(e,t,n,r){if(!e.tty||!e.tty.G.ra)throw new Ye(ve.ja);for(var a=0,i=0;i<r;i++){try{var o=e.tty.G.ra(e.tty)}catch(u){throw new Ye(ve.M)}if(void 0===o&&0===a)throw new Ye(ve.fa);if(null===o||void 0===o)break;a++,t[n+i]=o}return a&&(e.node.timestamp=Date.now()),a},write:function(e,t,n,r){if(!e.tty||!e.tty.G.da)throw new Ye(ve.ja);var a=0;try{if(0===n&&0===r)e.tty.G.flush(e.tty);else for(;a<r;)e.tty.G.da(e.tty,t[n+a]),a++}catch(i){throw new Ye(ve.M)}return r&&(e.node.timestamp=Date.now()),a}},De={ra:function(e){if(!e.input.length){var t=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\\n"):"function"==typeof readline&&(null!==(t=readline())&&(t+="\\n")),!t)return null;e.input=Nn(t,!0)}return e.input.shift()},da:function(e,t){null===t||10===t?(u(k(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&0<e.output.length&&(u(k(e.output,0)),e.output=[])}},Re={da:function(e,t){null===t||10===t?(c(k(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&0<e.output.length&&(c(k(e.output,0)),e.output=[])}},Ve={o:null,A:function(){return Ve.createNode(null,"/",16895,0)},createNode:function(e,t,n,r){if(24576===(61440&n)||4096===(61440&n))throw new Ye(ve.I);return Ve.o||(Ve.o={dir:{node:{m:Ve.c.m,s:Ve.c.s,lookup:Ve.c.lookup,R:Ve.c.R,rename:Ve.c.rename,unlink:Ve.c.unlink,rmdir:Ve.c.rmdir,readdir:Ve.c.readdir,symlink:Ve.c.symlink},stream:{F:Ve.f.F}},file:{node:{m:Ve.c.m,s:Ve.c.s},stream:{F:Ve.f.F,read:Ve.f.read,write:Ve.f.write,la:Ve.f.la,sa:Ve.f.sa,T:Ve.f.T}},link:{node:{m:Ve.c.m,s:Ve.c.s,readlink:Ve.c.readlink},stream:{}},na:{node:{m:Ve.c.m,s:Ve.c.s},stream:ut}}),16384===(61440&(n=et(e,t,n,r)).mode)?(n.c=Ve.o.dir.node,n.f=Ve.o.dir.stream,n.b={}):32768===(61440&n.mode)?(n.c=Ve.o.file.node,n.f=Ve.o.file.stream,n.h=0,n.b=null):40960===(61440&n.mode)?(n.c=Ve.o.link.node,n.f=Ve.o.link.stream):8192===(61440&n.mode)&&(n.c=Ve.o.na.node,n.f=Ve.o.na.stream),n.timestamp=Date.now(),e&&(e.b[t]=n),n},Ea:function(e){if(e.b&&e.b.subarray){for(var t=[],n=0;n<e.h;++n)t.push(e.b[n]);return t}return e.b},Wc:function(e){return e.b?e.b.subarray?e.b.subarray(0,e.h):new Uint8Array(e.b):new Uint8Array},pa:function(e,t){if(e.b&&e.b.subarray&&t>e.b.length&&(e.b=Ve.Ea(e),e.h=e.b.length),!e.b||e.b.subarray){var n=e.b?e.b.length:0;n>=t||(t=Math.max(t,n*(1048576>n?2:1.125)|0),0!=n&&(t=Math.max(t,256)),n=e.b,e.b=new Uint8Array(t),0<e.h&&e.b.set(n.subarray(0,e.h),0))}else for(!e.b&&0<t&&(e.b=[]);e.b.length<t;)e.b.push(0)},Ma:function(e,t){if(e.h!=t)if(0==t)e.b=null,e.h=0;else{if(!e.b||e.b.subarray){var n=e.b;e.b=new Uint8Array(new ArrayBuffer(t)),n&&e.b.set(n.subarray(0,Math.min(t,e.h)))}else if(e.b||(e.b=[]),e.b.length>t)e.b.length=t;else for(;e.b.length<t;)e.b.push(0);e.h=t}},c:{m:function(e){var t={};return t.dev=8192===(61440&e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,16384===(61440&e.mode)?t.size=4096:32768===(61440&e.mode)?t.size=e.h:40960===(61440&e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.Ca=4096,t.blocks=Math.ceil(t.size/t.Ca),t},s:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&Ve.Ma(e,t.size)},lookup:function(){throw Xe[ve.u]},R:function(e,t,n,r){return Ve.createNode(e,t,n,r)},rename:function(e,t,n){if(16384===(61440&e.mode)){try{var r=$e(t,n)}catch(i){}if(r)for(var a in r.b)throw new Ye(ve.ia)}delete e.parent.b[e.name],e.name=n,t.b[n]=e,e.parent=t},unlink:function(e,t){delete e.b[t]},rmdir:function(e,t){var n,r=$e(e,t);for(n in r.b)throw new Ye(ve.ia);delete e.b[t]},readdir:function(e){var t,n=[".",".."];for(t in e.b)e.b.hasOwnProperty(t)&&n.push(t);return n},symlink:function(e,t,n){return(e=Ve.createNode(e,t,41471,0)).link=n,e},readlink:function(e){if(40960!==(61440&e.mode))throw new Ye(ve.i);return e.link}},f:{read:function(e,t,n,r,a){var i=e.node.b;if(a>=e.node.h)return 0;if(y(0<=(e=Math.min(e.node.h-a,r))),8<e&&i.subarray)t.set(i.subarray(a,a+e),n);else for(r=0;r<e;r++)t[n+r]=i[a+r];return e},write:function(e,t,n,r,a,i){if(i=!1,!r)return 0;if((e=e.node).timestamp=Date.now(),t.subarray&&(!e.b||e.b.subarray)){if(i)return e.b=t.subarray(n,n+r),e.h=r;if(0===e.h&&0===a)return e.b=new Uint8Array(t.subarray(n,n+r)),e.h=r;if(a+r<=e.h)return e.b.set(t.subarray(n,n+r),a),r}if(Ve.pa(e,a+r),e.b.subarray&&t.subarray)e.b.set(t.subarray(n,n+r),a);else for(i=0;i<r;i++)e.b[a+i]=t[n+i];return e.h=Math.max(e.h,a+r),r},F:function(e,t,n){if(1===n?t+=e.position:2===n&&32768===(61440&e.node.mode)&&(t+=e.node.h),0>t)throw new Ye(ve.i);return t},la:function(e,t,n){Ve.pa(e.node,t+n),e.node.h=Math.max(e.node.h,t+n)},sa:function(e,t,n,r,a,i,o){if(32768!==(61440&e.node.mode))throw new Ye(ve.Y);if(n=e.node.b,2&o||n.buffer!==t&&n.buffer!==t.buffer){if((0<a||a+r<e.node.h)&&(n=n.subarray?n.subarray(a,a+r):Array.prototype.slice.call(n,a,a+r)),e=!0,!(r=mr(r)))throw new Ye(ve.ya);t.set(n,r)}else e=!1,r=n.byteOffset;return{Ka:r,za:e}},T:function(e,t,n,r,a){if(32768!==(61440&e.node.mode))throw new Ye(ve.Y);return 2&a||Ve.f.write(e,t,0,r,n,!1),0}}};F+=16,F+=16,F+=16;var qe=null,Ge={},Ne=[],Ue=1,We=null,He=!0,Ze={},Ye=null,Xe={};function Ke(e,t){if(t=t||{},!(e=Ie("/",e)))return{path:"",node:null};var n,r={qa:!0,ea:0};for(n in r)void 0===t[n]&&(t[n]=r[n]);if(8<t.ea)throw new Ye(ve.X);e=Se(e.split("/").filter((function(e){return!!e})),!1);var a=qe;for(r="/",n=0;n<e.length;n++){var i=n===e.length-1;if(i&&t.parent)break;if(a=$e(a,e[n]),r=Ce(r+"/"+e[n]),a.S&&(!i||i&&t.qa)&&(a=a.S.root),!i||t.aa)for(i=0;40960===(61440&a.mode);)if(a=dt(r),a=Ke(r=Ie(Te(r),a),{ea:t.ea}).node,40<i++)throw new Ye(ve.X)}return{path:r,node:a}}function Je(e){for(var t;;){if(e===e.parent)return e=e.A.ta,t?"/"!==e[e.length-1]?e+"/"+t:e+t:e;t=t?e.name+"/"+t:e.name,e=e.parent}}function Qe(e,t){for(var n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r)|0;return(e+n>>>0)%We.length}function $e(e,t){var n;if(n=(n=rt(e,"x"))?n:e.c.lookup?0:ve.W)throw new Ye(n,e);for(n=We[Qe(e.id,t)];n;n=n.Ja){var r=n.name;if(n.parent.id===e.id&&r===t)return n}return e.c.lookup(e,t)}function et(e,t,n,r){return wt||(wt=function(e,t,n,r){e||(e=this),this.parent=e,this.A=e.A,this.S=null,this.id=Ue++,this.name=t,this.mode=n,this.c={},this.f={},this.rdev=r},wt.prototype={},Object.defineProperties(wt.prototype,{read:{get:function(){return 365===(365&this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146===(146&this.mode)},set:function(e){e?this.mode|=146:this.mode&=-147}}})),function(e){var t=Qe(e.parent.id,e.name);e.Ja=We[t],We[t]=e}(e=new wt(e,t,n,r)),e}var tt={r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218};function nt(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t}function rt(e,t){return He||(-1===t.indexOf("r")||292&e.mode)&&(-1===t.indexOf("w")||146&e.mode)&&(-1===t.indexOf("x")||73&e.mode)?0:ve.W}function at(e,t){try{return $e(e,t),ve.ha}catch(n){}return rt(e,"wx")}function it(e,t){Mt||((Mt=function(){}).prototype={},Object.defineProperties(Mt.prototype,{object:{get:function(){return this.node},set:function(e){this.node=e}}}));var n,r=new Mt;for(n in e)r[n]=e[n];return e=r,t=function(e){for(e=e||0;e<=4096;e++)if(!Ne[e])return e;throw new Ye(ve.wa)}(t),e.fd=t,Ne[t]=e}var ot,ut={open:function(e){e.f=Ge[e.node.rdev].f,e.f.open&&e.f.open(e)},F:function(){throw new Ye(ve.O)}};function ct(e,t){Ge[e]={f:t}}function ft(e,t){var n="/"===t,r=!t;if(n&&qe)throw new Ye(ve.ga);if(!n&&!r){var a=Ke(t,{qa:!1});if(t=a.path,(a=a.node).S)throw new Ye(ve.ga);if(16384!==(61440&a.mode))throw new Ye(ve.Z)}t={type:e,$c:{},ta:t,Ia:[]},(e=e.A(t)).A=t,t.root=e,n?qe=e:a&&(a.S=t,a.A&&a.A.Ia.push(t))}function st(e,t,n){var r=Ke(e,{parent:!0}).node;if(!(e=Pe(e))||"."===e||".."===e)throw new Ye(ve.i);var a=at(r,e);if(a)throw new Ye(a);if(!r.c.R)throw new Ye(ve.I);return r.c.R(r,e,t,n)}function _t(e){st(e,16895,0)}function lt(e,t,n){"undefined"===typeof n&&(n=t,t=438),st(e,8192|t,n)}function pt(e,t){if(!Ie(e))throw new Ye(ve.u);var n=Ke(t,{parent:!0}).node;if(!n)throw new Ye(ve.u);var r=at(n,t=Pe(t));if(r)throw new Ye(r);if(!n.c.symlink)throw new Ye(ve.I);n.c.symlink(n,t,e)}function dt(e){if(!(e=Ke(e).node))throw new Ye(ve.u);if(!e.c.readlink)throw new Ye(ve.i);return Ie(Je(e.parent),e.c.readlink(e))}function mt(e,t,r,a){if(""===e)throw new Ye(ve.u);if("string"===typeof t){var i=tt[t];if("undefined"===typeof i)throw Error("Unknown file open mode: "+t);t=i}if(r=64&t?4095&("undefined"===typeof r?438:r)|32768:0,"object"===typeof e)var o=e;else{e=Ce(e);try{o=Ke(e,{aa:!(131072&t)}).node}catch(c){}}if(i=!1,64&t)if(o){if(128&t)throw new Ye(ve.ha)}else o=st(e,r,0),i=!0;if(!o)throw new Ye(ve.u);if(8192===(61440&o.mode)&&(t&=-513),65536&t&&16384!==(61440&o.mode))throw new Ye(ve.Z);if(!i&&(r=o?40960===(61440&o.mode)?ve.X:16384===(61440&o.mode)&&("r"!==nt(t)||512&t)?ve.N:rt(o,nt(t)):ve.u))throw new Ye(r);if(512&t){var u;if(!(u="string"===typeof(r=o)?Ke(r,{aa:!0}).node:r).c.s)throw new Ye(ve.I);if(16384===(61440&u.mode))throw new Ye(ve.N);if(32768!==(61440&u.mode))throw new Ye(ve.i);if(r=rt(u,"w"))throw new Ye(r);u.c.s(u,{size:0,timestamp:Date.now()})}t&=-641,(a=it({node:o,path:Je(o),flags:t,seekable:!0,position:0,f:o.f,Sa:[],error:!1},a)).f.open&&a.f.open(a),!n.logReadFiles||1&t||(kt||(kt={}),e in kt||(kt[e]=1,console.log("FS.trackingDelegate error on read file: "+e)));try{Ze.onOpenFile&&(o=0,1!==(2097155&t)&&(o|=1),0!==(2097155&t)&&(o|=2),Ze.onOpenFile(e,o))}catch(c){console.log("FS.trackingDelegate[\'onOpenFile\'](\'"+e+"\', flags) threw an exception: "+c.message)}return a}function ht(e){if(null===e.fd)throw new Ye(ve.B);e.ba&&(e.ba=null);try{e.f.close&&e.f.close(e)}catch(t){throw t}finally{Ne[e.fd]=null}e.fd=null}function yt(e,t,n){if(null===e.fd)throw new Ye(ve.B);if(!e.seekable||!e.f.F)throw new Ye(ve.O);e.position=e.f.F(e,t,n),e.Sa=[]}function bt(){Ye||((Ye=function(e,t){this.node=t,this.Na=function(e){for(var t in this.v=e,ve)if(ve[t]===e){this.code=t;break}},this.Na(e),this.message=Oe[e],this.stack&&Object.defineProperty(this,"stack",{value:Error().stack,writable:!0})}).prototype=Error(),Ye.prototype.constructor=Ye,[ve.u].forEach((function(e){Xe[e]=new Ye(e),Xe[e].stack="<generic error, no stack>"})))}function vt(e,t,n){e=Ce("/dev/"+e);var r=function(e,t){var n=0;return e&&(n|=365),t&&(n|=146),n}(!!t,!!n);gt||(gt=64);var a=gt++<<8|0;ct(a,{open:function(e){e.seekable=!1},close:function(){n&&n.buffer&&n.buffer.length&&n(10)},read:function(e,n,r,a){for(var i=0,o=0;o<a;o++){try{var u=t()}catch(c){throw new Ye(ve.M)}if(void 0===u&&0===i)throw new Ye(ve.fa);if(null===u||void 0===u)break;i++,n[r+o]=u}return i&&(e.node.timestamp=Date.now()),i},write:function(e,t,r,a){for(var i=0;i<a;i++)try{n(t[r+i])}catch(o){throw new Ye(ve.M)}return a&&(e.node.timestamp=Date.now()),i}}),lt(e,r,a)}var gt,wt,Mt,kt,xt={},zt={},At=0;function Lt(){return T[(At+=4)-4>>2]}function Et(){var e=Ne[Lt()];if(!e)throw new Ye(ve.B);return e}function Ot(e,t){if(Rt=e,Vt=t,!jt)return 1;if(0==e)It=function(){var e=0|Math.max(0,Ct+t-ye());setTimeout(Tt,e)},Bt="timeout";else if(1==e)It=function(){nn(Tt)},Bt="rAF";else if(2==e){if("undefined"===typeof setImmediate){var r=[];addEventListener("message",(function(e){"setimmediate"!==e.data&&"setimmediate"!==e.data.target||(e.stopPropagation(),r.shift()())}),!0),setImmediate=function(e){r.push(e),void 0===n.setImmediates&&(n.setImmediates=[]),n.setImmediates.push(e),postMessage({target:"setimmediate"})}}It=function(){setImmediate(Tt)},Bt="immediate"}return 0}function St(e,t,r,a,i){n.noExitRuntime=!0,y(!jt,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters."),jt=e,Dt=a;var o="undefined"!==typeof a?function(){n.dynCall_vi(e,a)}:function(){n.dynCall_v(e)},u=Ft;if(Tt=function(){if(!h)if(0<Gt.length){var e=Date.now(),t=Gt.shift();if(t.g(t.P),Pt){var r=Pt,a=0==r%1?r-1:Math.floor(r);Pt=t.Tc?a:(8*r+(a+.5))/9}console.log(\'main loop blocker "\'+t.name+\'" took \'+(Date.now()-e)+" ms"),n.setStatus&&(e=n.statusMessage||"Please wait...",t=Pt,r=Nt.Vc,t?t<r?n.setStatus(e+" ("+(r-t)+"/"+r+")"):n.setStatus(e):n.setStatus("")),u<Ft||setTimeout(Tt,0)}else if(!(u<Ft))if(qt=qt+1|0,1==Rt&&1<Vt&&0!=qt%Vt)It();else{if(0==Rt&&(Ct=ye()),"timeout"===Bt&&n.K&&(c("Looks like you are rendering without using requestAnimationFrame for the main loop. You should use 0 for the frame rate in emscripten_set_main_loop in order to use requestAnimationFrame, as that can greatly improve your frame rates!"),Bt=""),!(h||n.preMainLoop&&!1===n.preMainLoop())){try{o()}catch(i){throw i&&"object"===typeof i&&i.stack&&c("exception thrown: "+[i,i.stack]),i}n.postMainLoop&&n.postMainLoop()}u<Ft||("object"===typeof SDL&&SDL.audio&&SDL.audio.La&&SDL.audio.La(),It())}},i||(t&&0<t?Ot(0,1e3/t):Ot(1,1),It()),r)throw"SimulateInfiniteLoop"}var Ct,Tt,Pt,It=null,Bt="",Ft=0,jt=null,Dt=0,Rt=0,Vt=0,qt=0,Gt=[],Nt={},Ut=!1,Wt=!1,Ht=[];function Zt(){function e(){Wt=document.pointerLockElement===n.canvas||document.mozPointerLockElement===n.canvas||document.webkitPointerLockElement===n.canvas||document.msPointerLockElement===n.canvas}if(n.preloadPlugins||(n.preloadPlugins=[]),!fn){fn=!0;try{sn=!0}catch(r){sn=!1,console.log("warning: no blob constructor, cannot create blobs with mimetypes")}_n="undefined"!=typeof MozBlobBuilder?MozBlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:sn?null:console.log("warning: no BlobBuilder"),ln="undefined"!=typeof window?window.URL?window.URL:window.webkitURL:void 0,n.ua||"undefined"!==typeof ln||(console.log("warning: Browser does not support creating object URLs. Built-in browser image decoding will not be available."),n.ua=!0),n.preloadPlugins.push({canHandle:function(e){return!n.ua&&/\\.(jpg|jpeg|png|bmp)$/i.test(e)},handle:function(e,t,r,a){var i=null;if(sn)try{(i=new Blob([e],{type:an(t)})).size!==e.length&&(i=new Blob([new Uint8Array(e).buffer],{type:an(t)}))}catch(f){!function(e){l||(l={}),l[e]||(l[e]=1,c(e))}("Blob constructor present but fails: "+f+"; falling back to blob builder")}i||((i=new _n).append(new Uint8Array(e).buffer),i=i.getBlob());var o=ln.createObjectURL(i),u=new Image;u.onload=function(){y(u.complete,"Image "+t+" could not be decoded");var a=document.createElement("canvas");a.width=u.width,a.height=u.height,a.getContext("2d").drawImage(u,0,0),n.preloadedImages[t]=a,ln.revokeObjectURL(o),r&&r(e)},u.onerror=function(){console.log("Image "+o+" could not be decoded"),a&&a()},u.src=o}}),n.preloadPlugins.push({canHandle:function(e){return!n.Zc&&e.substr(-4)in{".ogg":1,".wav":1,".mp3":1}},handle:function(e,t,r,a){function i(a){u||(u=!0,n.preloadedAudios[t]=a,r&&r(e))}function o(){u||(u=!0,n.preloadedAudios[t]=new Audio,a&&a())}var u=!1;if(!sn)return o();try{var c=new Blob([e],{type:an(t)})}catch(s){return o()}c=ln.createObjectURL(c);var f=new Audio;f.addEventListener("canplaythrough",(function(){i(f)}),!1),f.onerror=function(){if(!u){console.log("warning: browser could not fully decode audio "+t+", trying slower base64 approach");for(var n="",r=0,a=0,o=0;o<e.length;o++)for(r=r<<8|e[o],a+=8;6<=a;){var c=r>>a-6&63;a-=6,n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[c]}2==a?(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&r)<<4],n+="=="):4==a&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&r)<<2],n+="="),f.src="data:audio/x-"+t.substr(-3)+";base64,"+n,i(f)}},f.src=c,rn((function(){i(f)}),1e4)}});var t=n.canvas;t&&(t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock||t.msRequestPointerLock||function(){},t.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||function(){},t.exitPointerLock=t.exitPointerLock.bind(document),document.addEventListener("pointerlockchange",e,!1),document.addEventListener("mozpointerlockchange",e,!1),document.addEventListener("webkitpointerlockchange",e,!1),document.addEventListener("mspointerlockchange",e,!1),n.elementPointerLock&&t.addEventListener("click",(function(e){!Wt&&n.canvas.requestPointerLock&&(n.canvas.requestPointerLock(),e.preventDefault())}),!1))}}function Yt(e,t,r,a){if(t&&n.K&&e==n.canvas)return n.K;if(t){var i={antialias:!1,alpha:!1};if(a)for(var o in a)i[o]=a[o];if(i=function(e,t){function n(){}"undefined"===typeof t.majorVersion&&"undefined"===typeof t.minorVersion&&(t.majorVersion=1,t.minorVersion=0);try{e.addEventListener("webglcontextcreationerror",n,!1);try{if(1==t.majorVersion&&0==t.minorVersion)var r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);else{if(2!=t.majorVersion||0!=t.minorVersion)throw"Unsupported WebGL context version "+majorVersion+"."+minorVersion+"!";r=e.getContext("webgl2",t)}}finally{e.removeEventListener("webglcontextcreationerror",n,!1)}if(!r)throw":("}catch(i){return 0}return r?function(e,t){var n=On(An),r={handle:n,attributes:t,version:t.majorVersion,GLctx:e};return e.canvas&&(e.canvas.Sc=r),An[n]=r,("undefined"===typeof t.enableExtensionsByDefault||t.enableExtensionsByDefault)&&function(e){if(e||(e=Ln),!e.Ga){e.Ga=!0;var t=e.GLctx;if(2>e.version){var n=t.getExtension("ANGLE_instanced_arrays");n&&(t.vertexAttribDivisor=function(e,t){n.vertexAttribDivisorANGLE(e,t)},t.drawArraysInstanced=function(e,t,r,a){n.drawArraysInstancedANGLE(e,t,r,a)},t.drawElementsInstanced=function(e,t,r,a,i){n.drawElementsInstancedANGLE(e,t,r,a,i)});var r=t.getExtension("OES_vertex_array_object");r&&(t.createVertexArray=function(){return r.createVertexArrayOES()},t.deleteVertexArray=function(e){r.deleteVertexArrayOES(e)},t.bindVertexArray=function(e){r.bindVertexArrayOES(e)},t.isVertexArray=function(e){return r.isVertexArrayOES(e)});var a=t.getExtension("WEBGL_draw_buffers");a&&(t.drawBuffers=function(e,t){a.drawBuffersWEBGL(e,t)})}t.Uc=t.getExtension("EXT_disjoint_timer_query");var i="OES_texture_float OES_texture_half_float OES_standard_derivatives OES_vertex_array_object WEBGL_compressed_texture_s3tc WEBGL_depth_texture OES_element_index_uint EXT_texture_filter_anisotropic EXT_frag_depth WEBGL_draw_buffers ANGLE_instanced_arrays OES_texture_float_linear OES_texture_half_float_linear EXT_blend_minmax EXT_shader_texture_lod WEBGL_compressed_texture_pvrtc EXT_color_buffer_half_float WEBGL_color_buffer_float EXT_sRGB WEBGL_compressed_texture_etc1 EXT_disjoint_timer_query WEBGL_compressed_texture_etc WEBGL_compressed_texture_astc EXT_color_buffer_float WEBGL_compressed_texture_s3tc_srgb EXT_disjoint_timer_query_webgl2".split(" ");(e=t.getSupportedExtensions())&&0<e.length&&t.getSupportedExtensions().forEach((function(e){-1!=i.indexOf(e)&&t.getExtension(e)}))}}(r),n}(r,t):0}(e,i))var u=An[i].GLctx}else u=e.getContext("2d");return u?(r&&(t||y("undefined"===typeof qn,"cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),n.K=u,t&&function(e){e?(e=An[e])&&(qn=n.K=e.GLctx,Ln=e):qn=n.K=Ln=null}(i),n.bd=t,Ht.forEach((function(e){e()})),Zt()),u):null}var Xt=!1,Kt=void 0,Jt=void 0;function Qt(e,t,r){function a(){Ut=!1;var e=i.parentNode;(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===e?(i.exitFullscreen=document.exitFullscreen||document.cancelFullScreen||document.mozCancelFullScreen||document.msExitFullscreen||document.webkitCancelFullScreen||function(){},i.exitFullscreen=i.exitFullscreen.bind(document),Kt&&i.requestPointerLock(),Ut=!0,Jt?("undefined"!=typeof SDL&&(T[SDL.screen>>2]=8388608|P[SDL.screen>>2]),cn(n.canvas),un()):cn(i)):(e.parentNode.insertBefore(i,e),e.parentNode.removeChild(e),Jt?("undefined"!=typeof SDL&&(T[SDL.screen>>2]=-8388609&P[SDL.screen>>2]),cn(n.canvas),un()):cn(i)),n.onFullScreen&&n.onFullScreen(Ut),n.onFullscreen&&n.onFullscreen(Ut)}"undefined"===typeof(Kt=e)&&(Kt=!0),"undefined"===typeof(Jt=t)&&(Jt=!1),"undefined"===typeof r&&null;var i=n.canvas;Xt||(Xt=!0,document.addEventListener("fullscreenchange",a,!1),document.addEventListener("mozfullscreenchange",a,!1),document.addEventListener("webkitfullscreenchange",a,!1),document.addEventListener("MSFullscreenChange",a,!1));var o=document.createElement("div");i.parentNode.insertBefore(o,i),o.appendChild(i),o.requestFullscreen=o.requestFullscreen||o.mozRequestFullScreen||o.msRequestFullscreen||(o.webkitRequestFullscreen?function(){o.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}:null)||(o.webkitRequestFullScreen?function(){o.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:null),r?o.requestFullscreen({cd:r}):o.requestFullscreen()}function $t(e,t,n){return c("Browser.requestFullScreen() is deprecated. Please call Browser.requestFullscreen instead."),$t=function(e,t,n){return Qt(e,t,n)},Qt(e,t,n)}var en=0;function tn(e){var t=Date.now();if(0===en)en=t+1e3/60;else for(;t+2>=en;)en+=1e3/60;setTimeout(e,Math.max(en-t,0))}function nn(e){"undefined"===typeof window?tn(e):(window.requestAnimationFrame||(window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||tn),window.requestAnimationFrame(e))}function rn(e,t){n.noExitRuntime=!0,setTimeout((function(){h||e()}),t)}function an(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.substr(e.lastIndexOf(".")+1)]}var on=[];function un(){var e=n.canvas;on.forEach((function(t){t(e.width,e.height)}))}function cn(e,t,r){t&&r?(e.Ta=t,e.Fa=r):(t=e.Ta,r=e.Fa);var a=t,i=r;if(n.forcedAspectRatio&&0<n.forcedAspectRatio&&(a/i<n.forcedAspectRatio?a=Math.round(i*n.forcedAspectRatio):i=Math.round(a/n.forcedAspectRatio)),(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===e.parentNode&&"undefined"!=typeof screen){var o=Math.min(screen.width/a,screen.height/i);a=Math.round(a*o),i=Math.round(i*o)}Jt?(e.width!=a&&(e.width=a),e.height!=i&&(e.height=i),"undefined"!=typeof e.style&&(e.style.removeProperty("width"),e.style.removeProperty("height"))):(e.width!=t&&(e.width=t),e.height!=r&&(e.height=r),"undefined"!=typeof e.style&&(a!=t||i!=r?(e.style.setProperty("width",a+"px","important"),e.style.setProperty("height",i+"px","important")):(e.style.removeProperty("width"),e.style.removeProperty("height"))))}var fn,sn,_n,ln,pn=[],dn=void 0;function mn(e,t){P[e>>2]=t,P[e+4>>2]=t/4294967296|0}function hn(e,t,n,r){var a=P[e+8>>2];if(a){var i=w(a),o=e+112,u=w(o);u||(u="GET");var c=P[o+48>>2],f=P[o+52>>2],s=!!P[o+56>>2],_=P[o+64>>2],l=P[o+68>>2];a=P[o+72>>2];var p=P[o+76>>2],d=P[o+80>>2];o=P[o+84>>2];var m=!!(1&c),h=!!(2&c);c=!!(64&c),_=_?w(_):void 0,l=l?w(l):void 0;var y=p?w(p):void 0,b=new XMLHttpRequest;if(b.withCredentials=s,b.open(u,i,!c,_,l),c||(b.timeout=f),b.l=i,b.responseType=h?"moz-chunked-arraybuffer":"arraybuffer",p&&b.overrideMimeType(y),a)for(;(u=P[a>>2])&&(i=P[a+4>>2]);)a+=8,u=w(u),i=w(i),b.setRequestHeader(u,i);pn.push(b),P[e+0>>2]=pn.length,a=d&&o?O.slice(d,d+o):null,b.onload=function(r){var a=b.response?b.response.byteLength:0,i=0,o=0;m&&!h&&(i=mr(o=a),O.set(new Uint8Array(b.response),i)),P[e+12>>2]=i,mn(e+16,o),mn(e+24,0),a&&mn(e+32,a),C[e+40>>1]=b.readyState,4===b.readyState&&0===b.status&&(b.status=0<a?200:404),C[e+42>>1]=b.status,b.statusText&&z(b.statusText,O,e+44,64),200==b.status?t&&t(e,b,r):n&&n(e,b,r)},b.onerror=function(t){var r=b.status;4==b.readyState&&0==r&&(r=404),P[e+12>>2]=0,mn(e+16,0),mn(e+24,0),mn(e+32,0),C[e+40>>1]=b.readyState,C[e+42>>1]=r,n&&n(e,b,t)},b.ontimeout=function(t){n&&n(e,b,t)},b.onprogress=function(t){var n=m&&h&&b.response?b.response.byteLength:0,a=0;m&&h&&(a=mr(n),O.set(new Uint8Array(b.response),a)),P[e+12>>2]=a,mn(e+16,n),mn(e+24,t.loaded-n),mn(e+32,t.total),C[e+40>>1]=b.readyState,3<=b.readyState&&0===b.status&&0<t.loaded&&(b.status=200),C[e+42>>1]=b.status,b.statusText&&z(b.statusText,O,e+44,64),r&&r(e,b,t)};try{b.send(a)}catch(v){n&&n(e,b,v)}}else n(e,0,"no url specified!")}function yn(e,t,n,r,a){if(e){var i=P[t+112+60>>2];i||(i=P[t+8>>2]);var o=w(i);try{var u=e.transaction(["FILES"],"readwrite").objectStore("FILES").put(n,o);u.onsuccess=function(){C[t+40>>1]=4,C[t+42>>1]=200,z("OK",O,t+44,64),r(t,0,o)},u.onerror=function(e){C[t+40>>1]=4,C[t+42>>1]=413,z("Payload Too Large",O,t+44,64),a(t,0,e)}}catch(c){a(t,0,c)}}else a(t,0,"IndexedDB not available!")}function bn(e,t,n,r){if(e){var a=P[t+112+60>>2];a||(a=P[t+8>>2]),a=w(a);try{var i=e.transaction(["FILES"],"readonly").objectStore("FILES").get(a);i.onsuccess=function(e){if(e.target.result){var a=(e=e.target.result).byteLength||e.length,i=mr(a);O.set(new Uint8Array(e),i),P[t+12>>2]=i,mn(t+16,a),mn(t+24,0),mn(t+32,a),C[t+40>>1]=4,C[t+42>>1]=200,z("OK",O,t+44,64),n(t,0,e)}else C[t+40>>1]=4,C[t+42>>1]=404,z("Not Found",O,t+44,64),r(t,0,"no data")},i.onerror=function(e){C[t+40>>1]=4,C[t+42>>1]=404,z("Not Found",O,t+44,64),r(t,0,e)}}catch(o){r(t,0,o)}}else r(t,0,"IndexedDB not available!")}function vn(e,t,n,r){if(e){var a=P[t+112+60>>2];a||(a=P[t+8>>2]),a=w(a);try{var i=e.transaction(["FILES"],"readwrite").objectStore("FILES").delete(a);i.onsuccess=function(e){e=e.target.result,P[t+12>>2]=0,mn(t+16,0),mn(t+24,0),mn(t+24,0),C[t+40>>1]=4,C[t+42>>1]=200,z("OK",O,t+44,64),n(t,0,e)},i.onerror=function(e){C[t+40>>1]=4,C[t+42>>1]=404,z("Not Found",O,t+44,64),r(t,0,e)}}catch(o){r(t,0,o)}}else r(t,0,"IndexedDB not available!")}var gn,wn,Mn=void 0;for(Mn=gn=f(Math.max(12,1)),y(0==(3&gn)),wn=gn+12;Mn<wn;Mn+=4)T[Mn>>2]=0;for(wn=gn+12;Mn<wn;)E[Mn++>>0]=0;var kn=1,xn=0,zn=[],An=[],Ln=null,En=[];function On(e){for(var t=kn++,n=e.length;n<t;n++)e[n]=null;return t}function Sn(e,t,n,r){return e*=n,r*=Math.floor((e+r-1)/r),0>=t?0:(t-1)*r+e}function Cn(e,t,n,r,a){switch(t){case 6406:case 6409:case 6402:t=1;break;case 6410:t=2;break;case 6407:case 35904:t=3;break;case 6408:case 35906:t=4;break;default:return xn||(xn=1280),null}switch(e){case 5121:t*=1;break;case 5123:case 36193:t*=2;break;case 5125:case 5126:t*=4;break;case 34042:t=4;break;case 33635:case 32819:case 32820:t=2;break;default:return xn||(xn=1280),null}switch(n=Sn(n,r,t,4),e){case 5121:return O.subarray(a,a+n);case 5126:return I.subarray(a>>2,a+n>>2);case 5125:case 34042:return P.subarray(a>>2,a+n>>2);case 5123:case 33635:case 32819:case 32820:case 36193:return C.subarray(a>>1,a+n>>1);default:return xn||(xn=1280),null}}function Tn(){return Tn.l||(Tn.l=[]),Tn.l.push(vr()),Tn.l.length-1}var Pn={},In=1;function Bn(e){return 0===e%4&&(0!==e%100||0===e%400)}function Fn(e,t){for(var n=0,r=0;r<=t;n+=e[r++]);return n}var jn=[31,29,31,30,31,30,31,31,30,31,30,31],Dn=[31,28,31,30,31,30,31,31,30,31,30,31];function Rn(e,t){for(e=new Date(e.getTime());0<t;){var n=e.getMonth(),r=(Bn(e.getFullYear())?jn:Dn)[n];if(!(t>r-e.getDate())){e.setDate(e.getDate()+t);break}t-=r-e.getDate()+1,e.setDate(1),11>n?e.setMonth(n+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return e}function Vn(e,t,n,r){function a(e,t,n){for(e="number"===typeof e?e.toString():e||"";e.length<t;)e=n[0]+e;return e}function i(e,t){return a(e,t,"0")}function o(e,t){function n(e){return 0>e?-1:0<e?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function u(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function c(e){e=Rn(new Date(e.j+1900,0,1),e.V);var t=u(new Date(e.getFullYear()+1,0,4));return 0>=o(u(new Date(e.getFullYear(),0,4)),e)?0>=o(t,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}var f=T[r+40>>2];for(var s in r={Qa:T[r>>2],Pa:T[r+4>>2],U:T[r+8>>2],H:T[r+12>>2],C:T[r+16>>2],j:T[r+20>>2],va:T[r+24>>2],V:T[r+28>>2],ad:T[r+32>>2],Oa:T[r+36>>2],Ra:f?w(f):""},n=w(n),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S"})n=n.replace(new RegExp(s,"g"),f[s]);var _="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),l="January February March April May June July August September October November December".split(" ");for(s in f={"%a":function(e){return _[e.va].substring(0,3)},"%A":function(e){return _[e.va]},"%b":function(e){return l[e.C].substring(0,3)},"%B":function(e){return l[e.C]},"%C":function(e){return i((e.j+1900)/100|0,2)},"%d":function(e){return i(e.H,2)},"%e":function(e){return a(e.H,2," ")},"%g":function(e){return c(e).toString().substring(2)},"%G":function(e){return c(e)},"%H":function(e){return i(e.U,2)},"%I":function(e){return 0==(e=e.U)?e=12:12<e&&(e-=12),i(e,2)},"%j":function(e){return i(e.H+Fn(Bn(e.j+1900)?jn:Dn,e.C-1),3)},"%m":function(e){return i(e.C+1,2)},"%M":function(e){return i(e.Pa,2)},"%n":function(){return"\\n"},"%p":function(e){return 0<=e.U&&12>e.U?"AM":"PM"},"%S":function(e){return i(e.Qa,2)},"%t":function(){return"\\t"},"%u":function(e){return new Date(e.j+1900,e.C+1,e.H,0,0,0,0).getDay()||7},"%U":function(e){var t=new Date(e.j+1900,0,1),n=0===t.getDay()?t:Rn(t,7-t.getDay());return 0>o(n,e=new Date(e.j+1900,e.C,e.H))?i(Math.ceil((31-n.getDate()+(Fn(Bn(e.getFullYear())?jn:Dn,e.getMonth()-1)-31)+e.getDate())/7),2):0===o(n,t)?"01":"00"},"%V":function(e){var t=u(new Date(e.j+1900,0,4)),n=u(new Date(e.j+1901,0,4)),r=Rn(new Date(e.j+1900,0,1),e.V);return 0>o(r,t)?"53":0>=o(n,r)?"01":i(Math.ceil((t.getFullYear()<e.j+1900?e.V+32-t.getDate():e.V+1-t.getDate())/7),2)},"%w":function(e){return new Date(e.j+1900,e.C+1,e.H,0,0,0,0).getDay()},"%W":function(e){var t=new Date(e.j,0,1),n=1===t.getDay()?t:Rn(t,0===t.getDay()?1:7-t.getDay()+1);return 0>o(n,e=new Date(e.j+1900,e.C,e.H))?i(Math.ceil((31-n.getDate()+(Fn(Bn(e.getFullYear())?jn:Dn,e.getMonth()-1)-31)+e.getDate())/7),2):0===o(n,t)?"01":"00"},"%y":function(e){return(e.j+1900).toString().substring(2)},"%Y":function(e){return e.j+1900},"%z":function(e){var t=0<=(e=e.Oa);return e=Math.abs(e)/60,(t?"+":"-")+String("0000"+(e/60*100+e%60)).slice(-4)},"%Z":function(e){return e.Ra},"%%":function(){return"%"}},f)0<=n.indexOf(s)&&(n=n.replace(new RegExp(s,"g"),f[s](r)));return(s=Nn(n,!1)).length>t?0:(E.set(s,e),s.length-1)}ye="undefined"!==typeof dateNow?dateNow:"object"===typeof self&&self.performance&&"function"===typeof self.performance.now?function(){return self.performance.now()}:"object"===typeof performance&&"function"===typeof performance.now?function(){return performance.now()}:Date.now,bt(),We=Array(4096),ft(Ve,"/"),_t("/tmp"),_t("/home"),_t("/home/web_user"),function(){if(_t("/dev"),ct(259,{read:function(){return 0},write:function(e,t,n,r){return r}}),lt("/dev/null",259),Fe(1280,De),Fe(1536,Re),lt("/dev/tty",1280),lt("/dev/tty1",1536),"undefined"!==typeof crypto)var e=new Uint8Array(1),t=function(){return crypto.getRandomValues(e),e[0]};else t=function(){wr("random_device")};vt("random",t),vt("urandom",t),_t("/dev/shm"),_t("/dev/shm/tmp")}(),_t("/proc"),_t("/proc/self"),_t("/proc/self/fd"),ft({A:function(){var e=et("/proc/self","fd",16895,73);return e.c={lookup:function(e,t){var n=Ne[+t];if(!n)throw new Ye(ve.B);return(e={parent:null,A:{ta:"fake"},c:{readlink:function(){return n.path}}}).parent=e}},e}},"/proc/self/fd"),Q.unshift((function(){if(!n.noFSInit&&!ot){y(!ot,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),ot=!0,bt(),n.stdin=n.stdin,n.stdout=n.stdout,n.stderr=n.stderr,n.stdin?vt("stdin",n.stdin):pt("/dev/tty","/dev/stdin"),n.stdout?vt("stdout",null,n.stdout):pt("/dev/tty","/dev/stdout"),n.stderr?vt("stderr",null,n.stderr):pt("/dev/tty1","/dev/stderr");var e=mt("/dev/stdin","r");y(0===e.fd,"invalid handle for stdin ("+e.fd+")"),y(1===(e=mt("/dev/stdout","w")).fd,"invalid handle for stdout ("+e.fd+")"),y(2===(e=mt("/dev/stderr","w")).fd,"invalid handle for stderr ("+e.fd+")")}})),$.push((function(){He=!1})),ee.push((function(){ot=!1;var e=n._fflush;for(e&&e(0),e=0;e<Ne.length;e++){var t=Ne[e];t&&ht(t)}})),Q.unshift((function(){})),ee.push((function(){})),n.requestFullScreen=function(e,t,r){c("Module.requestFullScreen is deprecated. Please call Module.requestFullscreen instead."),n.requestFullScreen=n.requestFullscreen,$t(e,t,r)},n.requestFullscreen=function(e,t,n){Qt(e,t,n)},n.requestAnimationFrame=function(e){nn(e)},n.setCanvasSize=function(e,t,r){cn(n.canvas,e,t),r||un()},n.pauseMainLoop=function(){It=null,Ft++},n.resumeMainLoop=function(){Ft++;var e=Rt,t=Vt,n=jt;jt=null,St(n,0,!1,Dt,!0),Ot(e,t),It()},n.getUserMedia=function(){window.getUserMedia||(window.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia),window.getUserMedia(void 0)},n.createContext=function(e,t,n,r){return Yt(e,t,n,r)},function(){var e="undefined"===typeof ENVIRONMENT_IS_FETCH_WORKER;!function(e,t){try{var n=indexedDB.open("emscripten_filesystem",1)}catch(r){return void t(r)}n.onupgradeneeded=function(e){(e=e.target.result).objectStoreNames.contains("FILES")&&e.deleteObjectStore("FILES"),e.createObjectStore("FILES")},n.onsuccess=function(t){e(t.target.result)},n.onerror=function(e){t(e)}}((function(t){dn=t,e&&le()}),(function(){dn=!1,e&&le()})),"undefined"!==typeof ENVIRONMENT_IS_FETCH_WORKER&&ENVIRONMENT_IS_FETCH_WORKER||_e()}();for(var qn,Gn=0;256>Gn;Gn++);for(Gn=0;32>Gn;Gn++)En.push(Array(Gn));function Nn(e,t){var n=Array(A(e)+1);return e=z(e,n,0,n.length),t&&(n.length=e),n}G=f(4),D=R=_(F),q=_(V=D+Y),T[G>>2]=q,j=!0,n.wasmTableSize=2468,n.wasmMaxTableSize=2468,n.Aa={},n.Ba={abort:wr,assert:y,enlargeMemory:Z,getTotalMemory:function(){return X},abortOnCannotGrowMemory:function(){wr("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+X+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")},invoke_i:function(e){var t=vr();try{return n.dynCall_i(e)}catch(r){if(br(t),"number"!==typeof r&&"longjmp"!==r)throw r;n.setThrew(1,0)}},invoke_ii:function(e,t){var r=vr();try{return n.dynCall_ii(e,t)}catch(a){if(br(r),"number"!==typeof a&&"longjmp"!==a)throw a;n.setThrew(1,0)}},invoke_iii:function(e,t,r){var a=vr();try{return n.dynCall_iii(e,t,r)}catch(i){if(br(a),"number"!==typeof i&&"longjmp"!==i)throw i;n.setThrew(1,0)}},invoke_iiii:function(e,t,r,a){var i=vr();try{return n.dynCall_iiii(e,t,r,a)}catch(o){if(br(i),"number"!==typeof o&&"longjmp"!==o)throw o;n.setThrew(1,0)}},invoke_iiiii:function(e,t,r,a,i){var o=vr();try{return n.dynCall_iiiii(e,t,r,a,i)}catch(u){if(br(o),"number"!==typeof u&&"longjmp"!==u)throw u;n.setThrew(1,0)}},invoke_iiiiid:function(e,t,r,a,i,o){var u=vr();try{return n.dynCall_iiiiid(e,t,r,a,i,o)}catch(c){if(br(u),"number"!==typeof c&&"longjmp"!==c)throw c;n.setThrew(1,0)}},invoke_iiiiii:function(e,t,r,a,i,o){var u=vr();try{return n.dynCall_iiiiii(e,t,r,a,i,o)}catch(c){if(br(u),"number"!==typeof c&&"longjmp"!==c)throw c;n.setThrew(1,0)}},invoke_iiiiiid:function(e,t,r,a,i,o,u){var c=vr();try{return n.dynCall_iiiiiid(e,t,r,a,i,o,u)}catch(f){if(br(c),"number"!==typeof f&&"longjmp"!==f)throw f;n.setThrew(1,0)}},invoke_iiiiiii:function(e,t,r,a,i,o,u){var c=vr();try{return n.dynCall_iiiiiii(e,t,r,a,i,o,u)}catch(f){if(br(c),"number"!==typeof f&&"longjmp"!==f)throw f;n.setThrew(1,0)}},invoke_iiiiiiii:function(e,t,r,a,i,o,u,c){var f=vr();try{return n.dynCall_iiiiiiii(e,t,r,a,i,o,u,c)}catch(s){if(br(f),"number"!==typeof s&&"longjmp"!==s)throw s;n.setThrew(1,0)}},invoke_iiiiiiiii:function(e,t,r,a,i,o,u,c,f){var s=vr();try{return n.dynCall_iiiiiiiii(e,t,r,a,i,o,u,c,f)}catch(_){if(br(s),"number"!==typeof _&&"longjmp"!==_)throw _;n.setThrew(1,0)}},invoke_iiiiij:function(e,t,r,a,i,o,u){var c=vr();try{return n.dynCall_iiiiij(e,t,r,a,i,o,u)}catch(f){if(br(c),"number"!==typeof f&&"longjmp"!==f)throw f;n.setThrew(1,0)}},invoke_iiji:function(e,t,r,a,i){var o=vr();try{return n.dynCall_iiji(e,t,r,a,i)}catch(u){if(br(o),"number"!==typeof u&&"longjmp"!==u)throw u;n.setThrew(1,0)}},invoke_v:function(e){var t=vr();try{n.dynCall_v(e)}catch(r){if(br(t),"number"!==typeof r&&"longjmp"!==r)throw r;n.setThrew(1,0)}},invoke_vi:function(e,t){var r=vr();try{n.dynCall_vi(e,t)}catch(a){if(br(r),"number"!==typeof a&&"longjmp"!==a)throw a;n.setThrew(1,0)}},invoke_vii:function(e,t,r){var a=vr();try{n.dynCall_vii(e,t,r)}catch(i){if(br(a),"number"!==typeof i&&"longjmp"!==i)throw i;n.setThrew(1,0)}},invoke_viiffii:function(e,t,r,a,i,o,u){var c=vr();try{n.dynCall_viiffii(e,t,r,a,i,o,u)}catch(f){if(br(c),"number"!==typeof f&&"longjmp"!==f)throw f;n.setThrew(1,0)}},invoke_viii:function(e,t,r,a){var i=vr();try{n.dynCall_viii(e,t,r,a)}catch(o){if(br(i),"number"!==typeof o&&"longjmp"!==o)throw o;n.setThrew(1,0)}},invoke_viiifffii:function(e,t,r,a,i,o,u,c,f){var s=vr();try{n.dynCall_viiifffii(e,t,r,a,i,o,u,c,f)}catch(_){if(br(s),"number"!==typeof _&&"longjmp"!==_)throw _;n.setThrew(1,0)}},invoke_viiiffii:function(e,t,r,a,i,o,u,c){var f=vr();try{n.dynCall_viiiffii(e,t,r,a,i,o,u,c)}catch(s){if(br(f),"number"!==typeof s&&"longjmp"!==s)throw s;n.setThrew(1,0)}},invoke_viiii:function(e,t,r,a,i){var o=vr();try{n.dynCall_viiii(e,t,r,a,i)}catch(u){if(br(o),"number"!==typeof u&&"longjmp"!==u)throw u;n.setThrew(1,0)}},invoke_viiiii:function(e,t,r,a,i,o){var u=vr();try{n.dynCall_viiiii(e,t,r,a,i,o)}catch(c){if(br(u),"number"!==typeof c&&"longjmp"!==c)throw c;n.setThrew(1,0)}},invoke_viiiiiffffffffffffffff:function(e,t,r,a,i,o,u,c,f,s,_,l,p,d,m,h,y,b,v,g,w,M){var k=vr();try{n.dynCall_viiiiiffffffffffffffff(e,t,r,a,i,o,u,c,f,s,_,l,p,d,m,h,y,b,v,g,w,M)}catch(x){if(br(k),"number"!==typeof x&&"longjmp"!==x)throw x;n.setThrew(1,0)}},invoke_viiiiii:function(e,t,r,a,i,o,u){var c=vr();try{n.dynCall_viiiiii(e,t,r,a,i,o,u)}catch(f){if(br(c),"number"!==typeof f&&"longjmp"!==f)throw f;n.setThrew(1,0)}},invoke_viijii:function(e,t,r,a,i,o,u){var c=vr();try{n.dynCall_viijii(e,t,r,a,i,o,u)}catch(f){if(br(c),"number"!==typeof f&&"longjmp"!==f)throw f;n.setThrew(1,0)}},invoke_vij:function(e,t,r,a){var i=vr();try{n.dynCall_vij(e,t,r,a)}catch(o){if(br(i),"number"!==typeof o&&"longjmp"!==o)throw o;n.setThrew(1,0)}},invoke_viji:function(e,t,r,a,i){var o=vr();try{n.dynCall_viji(e,t,r,a,i)}catch(u){if(br(o),"number"!==typeof u&&"longjmp"!==u)throw u;n.setThrew(1,0)}},invoke_vijii:function(e,t,r,a,i,o){var u=vr();try{n.dynCall_vijii(e,t,r,a,i,o)}catch(c){if(br(u),"number"!==typeof c&&"longjmp"!==c)throw c;n.setThrew(1,0)}},___buildEnvironment:function e(t){if(e.Da)var r=T[t>>2],a=T[r>>2];else e.Da=!0,he.USER=he.LOGNAME="web_user",he.PATH="/",he.PWD="/",he.HOME="/home/web_user",he.LANG="C.UTF-8",he._=n.thisProgram,a=j?ne?mr(1024):s(1024):f(1024),r=j?ne?mr(256):s(256):f(256),T[r>>2]=a,T[t>>2]=r;t=[];var i,o=0;for(i in he)if("string"===typeof he[i]){var u=i+"="+he[i];t.push(u),o+=u.length}if(1024<o)throw Error("Environment size exceeded TOTAL_ENV_SIZE!");for(i=0;i<t.length;i++){o=u=t[i];for(var c=a,_=0;_<o.length;++_)E[c++>>0]=o.charCodeAt(_);E[c>>0]=0,T[r+4*i>>2]=a,a+=u.length+1}T[r+4*t.length>>2]=0},___clock_gettime:function(){return we.apply(null,arguments)},___cxa_allocate_exception:function(e){return mr(e)},___cxa_begin_catch:function(e){var t=xe[e];return t&&!t.ma&&(t.ma=!0,_r.$--),t&&(t.L=!1),ke.push(e),(t=ze(e))&&xe[t].J++,e},___cxa_current_primary_exception:function(){var e=ke[ke.length-1]||0;if(e){var t=ze(e);t&&xe[t].J++}return e},___cxa_decrement_exception_refcount:function(e){Ae(ze(e))},___cxa_end_catch:function(){n.setThrew(0);var e=ke.pop();e&&(Ae(ze(e)),Me=0)},___cxa_find_matching_catch:function e(){var t=Me;if(!t)return 0|(hr(0),0);var r=xe[t],a=r.type;if(!a)return 0|(hr(0),t);var i=Array.prototype.slice.call(arguments);n.___cxa_is_pointer_type(a),e.buffer||(e.buffer=mr(4)),T[e.buffer>>2]=t,t=e.buffer;for(var o=0;o<i.length;o++)if(i[o]&&n.___cxa_can_catch(i[o],a,t))return t=T[t>>2],r.ka=t,0|(hr(i[o]),t);return t=T[t>>2],0|(hr(a),t)},___cxa_free_exception:Le,___cxa_increment_exception_refcount:function(e){(e=ze(e))&&xe[e].J++},___cxa_pure_virtual:function(){throw h=!0,"Pure virtual function called!"},___cxa_rethrow:Ee,___cxa_rethrow_primary_exception:function(e){e&&(ke.push(e),xe[e].L=!0,Ee())},___cxa_throw:function(e,t,n){throw xe[e]={Ka:e,ka:e,type:t,oa:n,J:0,ma:!1,L:!1},Me=e,"uncaught_exception"in _r?_r.$++:_r.$=1,e+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."},___cxa_uncaught_exception:function(){return!!_r.$},___gxx_personality_v0:function(){},___lock:function(){},___map_file:function(){return ge(ve.I),-1},___resumeException:function(e){throw Me||(Me=e),e+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."},___setErrNo:ge,___syscall140:function(e,t){At=t;try{var n=Et();Lt();var r=Lt(),a=Lt(),i=Lt();return yt(n,r,i),T[a>>2]=n.position,n.ba&&0===r&&0===i&&(n.ba=null),0}catch(o){return"undefined"!==typeof xt&&o instanceof Ye||wr(o),-o.v}},___syscall145:function(e,t){At=t;try{var n=Et(),r=Lt();e:{var a=Lt();for(t=e=0;t<a;t++){var i=T[r+(8*t+4)>>2],o=n,u=T[r+8*t>>2],c=i,f=void 0,s=E;if(0>c||0>f)throw new Ye(ve.i);if(null===o.fd)throw new Ye(ve.B);if(1===(2097155&o.flags))throw new Ye(ve.B);if(16384===(61440&o.node.mode))throw new Ye(ve.N);if(!o.f.read)throw new Ye(ve.i);var _="undefined"!==typeof f;if(_){if(!o.seekable)throw new Ye(ve.O)}else f=o.position;var l=o.f.read(o,s,u,c,f);_||(o.position+=l);var p=l;if(0>p){var d=-1;break e}if(e+=p,p<i)break}d=e}return d}catch(m){return"undefined"!==typeof xt&&m instanceof Ye||wr(m),-m.v}},___syscall146:function(e,t){At=t;try{var n=Et(),r=Lt();e:{var a=Lt();for(t=e=0;t<a;t++){var i=n,o=T[r+8*t>>2],u=T[r+(8*t+4)>>2],c=E,f=void 0;if(0>u||0>f)throw new Ye(ve.i);if(null===i.fd)throw new Ye(ve.B);if(0===(2097155&i.flags))throw new Ye(ve.B);if(16384===(61440&i.node.mode))throw new Ye(ve.N);if(!i.f.write)throw new Ye(ve.i);1024&i.flags&&yt(i,0,2);var s="undefined"!==typeof f;if(s){if(!i.seekable)throw new Ye(ve.O)}else f=i.position;var _=i.f.write(i,c,o,u,f,void 0);s||(i.position+=_);try{i.path&&Ze.onWriteToFile&&Ze.onWriteToFile(i.path)}catch(d){console.log("FS.trackingDelegate[\'onWriteToFile\'](\'"+path+"\') threw an exception: "+d.message)}var l=_;if(0>l){var p=-1;break e}e+=l}p=e}return p}catch(d){return"undefined"!==typeof xt&&d instanceof Ye||wr(d),-d.v}},___syscall196:function(e,t){At=t;try{var n=w(Lt());e:{var r=Lt();try{var a=Ke(n,{aa:!1}).node;if(!a)throw new Ye(ve.u);if(!a.c.m)throw new Ye(ve.I);var i=a.c.m(a)}catch(u){if(u&&u.node&&Ce(n)!==Ce(Je(u.node))){var o=-ve.Z;break e}throw u}T[r>>2]=i.dev,T[r+4>>2]=0,T[r+8>>2]=i.ino,T[r+12>>2]=i.mode,T[r+16>>2]=i.nlink,T[r+20>>2]=i.uid,T[r+24>>2]=i.gid,T[r+28>>2]=i.rdev,T[r+32>>2]=0,T[r+36>>2]=i.size,T[r+40>>2]=4096,T[r+44>>2]=i.blocks,T[r+48>>2]=i.atime.getTime()/1e3|0,T[r+52>>2]=0,T[r+56>>2]=i.mtime.getTime()/1e3|0,T[r+60>>2]=0,T[r+64>>2]=i.ctime.getTime()/1e3|0,T[r+68>>2]=0,T[r+72>>2]=i.ino,o=0}return o}catch(u){return"undefined"!==typeof xt&&u instanceof Ye||wr(u),-u.v}},___syscall221:function(e,t){At=t;try{var n=Et();switch(Lt()){case 0:var r=Lt();return 0>r?-ve.i:mt(n.path,n.flags,0,r).fd;case 1:case 2:case 13:case 14:case 13:case 14:return 0;case 3:return n.flags;case 4:return r=Lt(),n.flags|=r,0;case 12:case 12:return r=Lt(),S[r+0>>1]=2,0;case 16:case 8:default:return-ve.i;case 9:return ge(ve.i),-1}}catch(a){return"undefined"!==typeof xt&&a instanceof Ye||wr(a),-a.v}},___syscall5:function(e,t){At=t;try{return mt(w(Lt()),Lt(),Lt()).fd}catch(n){return"undefined"!==typeof xt&&n instanceof Ye||wr(n),-n.v}},___syscall54:function(e,t){At=t;try{var n=Et(),r=Lt();switch(r){case 21509:case 21505:case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:case 21523:case 21524:return n.tty?0:-ve.D;case 21519:if(!n.tty)return-ve.D;var a=Lt();return T[a>>2]=0;case 21520:return n.tty?-ve.i:-ve.D;case 21531:if(e=a=Lt(),!n.f.Ha)throw new Ye(ve.D);return n.f.Ha(n,r,e);default:wr("bad ioctl syscall "+r)}}catch(i){return"undefined"!==typeof xt&&i instanceof Ye||wr(i),-i.v}},___syscall6:function(e,t){At=t;try{return ht(Et()),0}catch(n){return"undefined"!==typeof xt&&n instanceof Ye||wr(n),-n.v}},___syscall91:function(e,t){At=t;try{var n=Lt(),r=Lt(),a=zt[n];if(!a)return 0;if(r===a.Xc){var i=Ne[a.fd],o=a.flags,u=new Uint8Array(O.subarray(n,n+r));i&&i.f.T&&i.f.T(i,u,0,r,o),zt[n]=null,a.za&&dr(a.Yc)}return 0}catch(c){return"undefined"!==typeof xt&&c instanceof Ye||wr(c),-c.v}},___unlock:function(){},__addDays:Rn,__arraySum:Fn,__emscripten_fetch_cache_data:yn,__emscripten_fetch_delete_cached_data:vn,__emscripten_fetch_load_cached_data:bn,__emscripten_fetch_xhr:hn,__emscripten_get_fetch_work_queue:function(){return gn},__isLeapYear:Bn,_abort:function(){n.abort()},_clock_gettime:we,_emidentity:function(){var e=new URL(location.origin).hostname;if(0===e.length&&(e=new URL(location.href.replace("blob:","")).hostname),/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e))0===e.indexOf("10.")&&(e="10.*"),0===e.indexOf("192.168.")&&(e="192.168.*"),0===e.indexOf("172.")&&(e="172.*"),0===e.indexOf("127.")&&(e="127.*");else{var t=new RegExp("("+String.fromCharCode(92)+".ngrok"+String.fromCharCode(92)+".io)$","i");t.test(e)&&(e="*.ngrok.io"),(t=new RegExp("("+String.fromCharCode(92)+".arweb"+String.fromCharCode(92)+".app)$","i")).test(e)&&(e="*.arweb.app")}t=A(e)+1;var n=mr(t);return z(e,O,n,t+1),n},_emlicerr:function(){self.postMessage({t:"licerr"})},_emscripten_asm_const_i:function(e){return de[e]()},_emscripten_async_call:function(e,t,r){function a(){!function(e){if(e){y("vi"),d.vi||(d.vi={});var t=d.vi;return t[e]||(t[e]=function(t){return m("vi",e,[t])}),t[e]}}(e)(t)}n.noExitRuntime=!0,0<=r?rn(a,r):function(e){nn((function(){h||e()}))}(a)},_emscripten_get_now:ye,_emscripten_get_now_is_monotonic:be,_emscripten_is_main_browser_thread:function(){return!1},_emscripten_is_main_runtime_thread:function(){return 1},_emscripten_memcpy_big:function(e,t,n){return O.set(O.subarray(t,t+n),e),e},_emscripten_set_main_loop:St,_emscripten_set_main_loop_timing:Ot,_emscripten_start_fetch:function(e,t,r,a){function i(e){l?n.dynCall_vi(l,e):r&&r(e)}function o(e){p?n.dynCall_vi(p,e):a&&a(e)}function u(e,r){yn(dn,e,r.response,(function(e){_?n.dynCall_vi(_,e):t&&t(e)}),(function(e){_?n.dynCall_vi(_,e):t&&t(e)}))}function c(e){_?n.dynCall_vi(_,e):t&&t(e)}"undefined"!==typeof n&&(n.noExitRuntime=!0);var f=e+112,s=w(f),_=P[f+36>>2],l=P[f+40>>2],p=P[f+44>>2],d=P[f+48>>2],m=!!(4&d),h=!!(32&d);if(16&d&&"EM_IDB_STORE"!==s&&"EM_IDB_DELETE"!==s){if(h)return 0;hn(e,m?u:c,i,o)}else{if(!dn)return i(e),0;"EM_IDB_STORE"===s?(s=P[f+80>>2],f=O.slice(s,s+P[f+84>>2]),yn(dn,e,f,c,i)):"EM_IDB_DELETE"===s?vn(dn,e,c,i):bn(dn,e,c,h?i:m?function(e){hn(e,u,i,o)}:function(e){hn(e,c,i,o)})}return e},_getenv:function e(t){if(0===t)return 0;if(t=w(t),!he.hasOwnProperty(t))return 0;e.l&&dr(e.l);var n=A(t=he[t])+1,r=mr(n);return r&&z(t,E,r,n),e.l=r},_gettimeofday:function(e){var t=Date.now();return T[e>>2]=t/1e3|0,T[e+4>>2]=t%1e3*1e3|0,0},_glBindTexture:function(e,t){qn.bindTexture(e,t?zn[t]:null)},_glGenTextures:function(e,t){for(var n=0;n<e;n++){var r=qn.createTexture();if(!r){for(xn||(xn=1282);n<e;)T[t+4*n++>>2]=0;break}var a=On(zn);r.name=a,zn[a]=r,T[t+4*n>>2]=a}},_glTexImage2D:function(e,t,n,r,a,i,o,u,c){var f=null;c&&(f=Cn(u,o,r,a,c)),qn.texImage2D(e,t,n,r,a,i,o,u,f)},_glTexParameteri:function(e,t,n){qn.texParameteri(e,t,n)},_llvm_exp2_f32:function(e){return Math.pow(2,e)},_llvm_stackrestore:function(e){var t=Tn.l[e];Tn.l.splice(e,1),br(t)},_llvm_stacksave:Tn,_llvm_trap:function(){wr("trap!")},_pthread_cond_destroy:function(){return 0},_pthread_cond_init:function(){return 0},_pthread_cond_signal:function(){return 0},_pthread_cond_wait:function(){return 0},_pthread_create:function(){return 11},_pthread_getspecific:function(e){return Pn[e]||0},_pthread_join:function(){},_pthread_key_create:function(e){return 0==e?ve.i:(T[e>>2]=In,Pn[In]=0,In++,0)},_pthread_mutex_destroy:function(){},_pthread_mutex_init:function(){},_pthread_once:function e(t,r){e.l||(e.l={}),t in e.l||(n.dynCall_v(r),e.l[t]=1)},_pthread_setspecific:function(e,t){return e in Pn?(Pn[e]=t,0):ve.i},_strftime:Vn,_strftime_l:function(e,t,n,r){return Vn(e,t,n,r)},_sysconf:function(e){switch(e){case 30:case 75:return 16384;case 85:return 131068;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 80:case 81:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 79:return 0;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return"object"===typeof navigator&&navigator.hardwareConcurrency||1}return ge(ve.i),-1},emscriptenWebGLComputeImageSize:Sn,emscriptenWebGLGetTexPixelData:Cn,DYNAMICTOP_PTR:G,tempDoublePtr:me,STACKTOP:R,STACK_MAX:V};var Un=n.asm(n.Aa,n.Ba,L);n.asm=Un;var Wn=n.__GLOBAL__I_000101=function(){return n.asm.__GLOBAL__I_000101.apply(null,arguments)},Hn=n.__GLOBAL__sub_I_AZHighLevelEncoder_cpp=function(){return n.asm.__GLOBAL__sub_I_AZHighLevelEncoder_cpp.apply(null,arguments)},Zn=n.__GLOBAL__sub_I_CameraSource_cpp=function(){return n.asm.__GLOBAL__sub_I_CameraSource_cpp.apply(null,arguments)},Yn=n.__GLOBAL__sub_I_CharacterSetECI_cpp=function(){return n.asm.__GLOBAL__sub_I_CharacterSetECI_cpp.apply(null,arguments)},Xn=n.__GLOBAL__sub_I_DMECEncoder_cpp=function(){return n.asm.__GLOBAL__sub_I_DMECEncoder_cpp.apply(null,arguments)},Kn=n.__GLOBAL__sub_I_DMHighLevelEncoder_cpp=function(){return n.asm.__GLOBAL__sub_I_DMHighLevelEncoder_cpp.apply(null,arguments)},Jn=n.__GLOBAL__sub_I_GridSampler_cpp=function(){return n.asm.__GLOBAL__sub_I_GridSampler_cpp.apply(null,arguments)},Qn=n.__GLOBAL__sub_I_ODCode128Patterns_cpp=function(){return n.asm.__GLOBAL__sub_I_ODCode128Patterns_cpp.apply(null,arguments)},$n=n.__GLOBAL__sub_I_ODRSSExpandedReader_cpp=function(){return n.asm.__GLOBAL__sub_I_ODRSSExpandedReader_cpp.apply(null,arguments)},er=n.__GLOBAL__sub_I_PDFDetector_cpp=function(){return n.asm.__GLOBAL__sub_I_PDFDetector_cpp.apply(null,arguments)},tr=n.__GLOBAL__sub_I_StandardStatsManager_cpp=function(){return n.asm.__GLOBAL__sub_I_StandardStatsManager_cpp.apply(null,arguments)},nr=n.__GLOBAL__sub_I_barcode_finder_cpp=function(){return n.asm.__GLOBAL__sub_I_barcode_finder_cpp.apply(null,arguments)},rr=n.__GLOBAL__sub_I_face_landmark_cpp=function(){return n.asm.__GLOBAL__sub_I_face_landmark_cpp.apply(null,arguments)},ar=n.__GLOBAL__sub_I_face_mesh_cpp=function(){return n.asm.__GLOBAL__sub_I_face_mesh_cpp.apply(null,arguments)},ir=n.__GLOBAL__sub_I_face_tracker_cpp=function(){return n.asm.__GLOBAL__sub_I_face_tracker_cpp.apply(null,arguments)},or=n.__GLOBAL__sub_I_image_tracker_cpp=function(){return n.asm.__GLOBAL__sub_I_image_tracker_cpp.apply(null,arguments)},ur=n.__GLOBAL__sub_I_instant_tracker_cpp=function(){return n.asm.__GLOBAL__sub_I_instant_tracker_cpp.apply(null,arguments)},cr=n.__GLOBAL__sub_I_iostream_cpp=function(){return n.asm.__GLOBAL__sub_I_iostream_cpp.apply(null,arguments)},fr=n.__GLOBAL__sub_I_pipeline_cpp=function(){return n.asm.__GLOBAL__sub_I_pipeline_cpp.apply(null,arguments)},sr=n.__GLOBAL__sub_I_zappar_face_tracker_cpp=function(){return n.asm.__GLOBAL__sub_I_zappar_face_tracker_cpp.apply(null,arguments)};n.__Z20zappar_face_mesh_uvsP19zappar_face_mesh_ti=function(){return n.asm.__Z20zappar_face_mesh_uvsP19zappar_face_mesh_ti.apply(null,arguments)},n.__Z23zappar_face_mesh_updateP19zappar_face_mesh_tiPKfS2_i=function(){return n.asm.__Z23zappar_face_mesh_updateP19zappar_face_mesh_tiPKfS2_i.apply(null,arguments)},n.__Z24zappar_face_mesh_indicesP19zappar_face_mesh_ti=function(){return n.asm.__Z24zappar_face_mesh_indicesP19zappar_face_mesh_ti.apply(null,arguments)},n.__Z24zappar_face_mesh_normalsP19zappar_face_mesh_ti=function(){return n.asm.__Z24zappar_face_mesh_normalsP19zappar_face_mesh_ti.apply(null,arguments)},n.__Z25zappar_face_mesh_uvs_sizeP19zappar_face_mesh_ti=function(){return n.asm.__Z25zappar_face_mesh_uvs_sizeP19zappar_face_mesh_ti.apply(null,arguments)},n.__Z25zappar_face_mesh_verticesP19zappar_face_mesh_ti=function(){return n.asm.__Z25zappar_face_mesh_verticesP19zappar_face_mesh_ti.apply(null,arguments)},n.__Z27zappar_face_landmark_updateP23zappar_face_landmark_tiPKfS2_i=function(){return n.asm.__Z27zappar_face_landmark_updateP23zappar_face_landmark_tiPKfS2_i.apply(null,arguments)},n.__Z29zappar_face_mesh_indices_sizeP19zappar_face_mesh_ti=function(){return n.asm.__Z29zappar_face_mesh_indices_sizeP19zappar_face_mesh_ti.apply(null,arguments)},n.__Z29zappar_face_mesh_normals_sizeP19zappar_face_mesh_ti=function(){return n.asm.__Z29zappar_face_mesh_normals_sizeP19zappar_face_mesh_ti.apply(null,arguments)},n.__Z30zappar_face_mesh_vertices_sizeP19zappar_face_mesh_ti=function(){return n.asm.__Z30zappar_face_mesh_vertices_sizeP19zappar_face_mesh_ti.apply(null,arguments)},n.__Z31zappar_face_mesh_loaded_versionP19zappar_face_mesh_ti=function(){return n.asm.__Z31zappar_face_mesh_loaded_versionP19zappar_face_mesh_ti.apply(null,arguments)},n.__Z33zappar_face_mesh_load_from_memoryP19zappar_face_mesh_tiPKciiiii=function(){return n.asm.__Z33zappar_face_mesh_load_from_memoryP19zappar_face_mesh_tiPKciiiii.apply(null,arguments)},n.__Z40zappar_image_tracker_target_preview_rgbaP23zappar_image_tracker_tii=function(){return n.asm.__Z40zappar_image_tracker_target_preview_rgbaP23zappar_image_tracker_tii.apply(null,arguments)},n.__Z42zappar_image_tracker_target_load_from_fileP23zappar_image_tracker_tiPKc=function(){return n.asm.__Z42zappar_image_tracker_target_load_from_fileP23zappar_image_tracker_tiPKc.apply(null,arguments)},n.__Z45zappar_image_tracker_target_preview_rgba_sizeP23zappar_image_tracker_tii=function(){return n.asm.__Z45zappar_image_tracker_target_preview_rgba_sizeP23zappar_image_tracker_tii.apply(null,arguments)},n.__Z46zappar_image_tracker_target_preview_compressedP23zappar_image_tracker_tii=function(){return n.asm.__Z46zappar_image_tracker_target_preview_compressedP23zappar_image_tracker_tii.apply(null,arguments)},n.__Z46zappar_image_tracker_target_preview_rgba_widthP23zappar_image_tracker_tii=function(){return n.asm.__Z46zappar_image_tracker_target_preview_rgba_widthP23zappar_image_tracker_tii.apply(null,arguments)},n.__Z47zappar_image_tracker_target_preview_rgba_heightP23zappar_image_tracker_tii=function(){return n.asm.__Z47zappar_image_tracker_target_preview_rgba_heightP23zappar_image_tracker_tii.apply(null,arguments)},n.__Z51zappar_image_tracker_target_preview_compressed_sizeP23zappar_image_tracker_tii=function(){return n.asm.__Z51zappar_image_tracker_target_preview_compressed_sizeP23zappar_image_tracker_tii.apply(null,arguments)},n.__Z55zappar_image_tracker_target_preview_compressed_mimetypeP23zappar_image_tracker_tii=function(){return n.asm.__Z55zappar_image_tracker_target_preview_compressed_mimetypeP23zappar_image_tracker_tii.apply(null,arguments)};var _r=n.__ZSt18uncaught_exceptionv=function(){return n.asm.__ZSt18uncaught_exceptionv.apply(null,arguments)};n.___cxa_can_catch=function(){return n.asm.___cxa_can_catch.apply(null,arguments)},n.___cxa_is_pointer_type=function(){return n.asm.___cxa_is_pointer_type.apply(null,arguments)},n.___em_js__emidentity=function(){return n.asm.___em_js__emidentity.apply(null,arguments)},n.___em_js__emlicerr=function(){return n.asm.___em_js__emlicerr.apply(null,arguments)};var lr=n.___emscripten_environ_constructor=function(){return n.asm.___emscripten_environ_constructor.apply(null,arguments)};n.___errno_location=function(){return n.asm.___errno_location.apply(null,arguments)},n.__get_environ=function(){return n.asm.__get_environ.apply(null,arguments)};var pr=n._emscripten_replace_memory=function(){return n.asm._emscripten_replace_memory.apply(null,arguments)},dr=n._free=function(){return n.asm._free.apply(null,arguments)};n._llvm_bswap_i32=function(){return n.asm._llvm_bswap_i32.apply(null,arguments)},n._llvm_round_f32=function(){return n.asm._llvm_round_f32.apply(null,arguments)},n._llvm_round_f64=function(){return n.asm._llvm_round_f64.apply(null,arguments)};var mr=n._malloc=function(){return n.asm._malloc.apply(null,arguments)};n._memcpy=function(){return n.asm._memcpy.apply(null,arguments)},n._memmove=function(){return n.asm._memmove.apply(null,arguments)},n._memset=function(){return n.asm._memset.apply(null,arguments)},n._pthread_cond_broadcast=function(){return n.asm._pthread_cond_broadcast.apply(null,arguments)},n._pthread_mutex_lock=function(){return n.asm._pthread_mutex_lock.apply(null,arguments)},n._pthread_mutex_unlock=function(){return n.asm._pthread_mutex_unlock.apply(null,arguments)},n._round=function(){return n.asm._round.apply(null,arguments)},n._sbrk=function(){return n.asm._sbrk.apply(null,arguments)},n._zappar_analytics_project_id_set=function(){return n.asm._zappar_analytics_project_id_set.apply(null,arguments)},n._zappar_barcode_finder_create=function(){return n.asm._zappar_barcode_finder_create.apply(null,arguments)},n._zappar_barcode_finder_destroy=function(){return n.asm._zappar_barcode_finder_destroy.apply(null,arguments)},n._zappar_barcode_finder_enabled=function(){return n.asm._zappar_barcode_finder_enabled.apply(null,arguments)},n._zappar_barcode_finder_enabled_set=function(){return n.asm._zappar_barcode_finder_enabled_set.apply(null,arguments)},n._zappar_barcode_finder_formats=function(){return n.asm._zappar_barcode_finder_formats.apply(null,arguments)},n._zappar_barcode_finder_formats_set=function(){return n.asm._zappar_barcode_finder_formats_set.apply(null,arguments)},n._zappar_barcode_finder_found_format=function(){return n.asm._zappar_barcode_finder_found_format.apply(null,arguments)},n._zappar_barcode_finder_found_number=function(){return n.asm._zappar_barcode_finder_found_number.apply(null,arguments)},n._zappar_barcode_finder_found_text=function(){return n.asm._zappar_barcode_finder_found_text.apply(null,arguments)},n._zappar_camera_default_device_id=function(){return n.asm._zappar_camera_default_device_id.apply(null,arguments)},n._zappar_camera_source_create=function(){return n.asm._zappar_camera_source_create.apply(null,arguments)},n._zappar_camera_source_destroy=function(){return n.asm._zappar_camera_source_destroy.apply(null,arguments)},n._zappar_camera_source_pause=function(){return n.asm._zappar_camera_source_pause.apply(null,arguments)},n._zappar_camera_source_start=function(){return n.asm._zappar_camera_source_start.apply(null,arguments)},n._zappar_face_landmark_anchor_pose=function(){return n.asm._zappar_face_landmark_anchor_pose.apply(null,arguments)},n._zappar_face_landmark_create=function(){return n.asm._zappar_face_landmark_create.apply(null,arguments)},n._zappar_face_landmark_destroy=function(){return n.asm._zappar_face_landmark_destroy.apply(null,arguments)},n._zappar_face_mesh_create=function(){return n.asm._zappar_face_mesh_create.apply(null,arguments)},n._zappar_face_mesh_destroy=function(){return n.asm._zappar_face_mesh_destroy.apply(null,arguments)},n._zappar_face_tracker_anchor_count=function(){return n.asm._zappar_face_tracker_anchor_count.apply(null,arguments)},n._zappar_face_tracker_anchor_expression_coefficients=function(){return n.asm._zappar_face_tracker_anchor_expression_coefficients.apply(null,arguments)},n._zappar_face_tracker_anchor_id=function(){return n.asm._zappar_face_tracker_anchor_id.apply(null,arguments)},n._zappar_face_tracker_anchor_identity_coefficients=function(){return n.asm._zappar_face_tracker_anchor_identity_coefficients.apply(null,arguments)},n._zappar_face_tracker_anchor_pose_raw=function(){return n.asm._zappar_face_tracker_anchor_pose_raw.apply(null,arguments)},n._zappar_face_tracker_create=function(){return n.asm._zappar_face_tracker_create.apply(null,arguments)},n._zappar_face_tracker_destroy=function(){return n.asm._zappar_face_tracker_destroy.apply(null,arguments)},n._zappar_face_tracker_enabled=function(){return n.asm._zappar_face_tracker_enabled.apply(null,arguments)},n._zappar_face_tracker_enabled_set=function(){return n.asm._zappar_face_tracker_enabled_set.apply(null,arguments)},n._zappar_face_tracker_max_faces=function(){return n.asm._zappar_face_tracker_max_faces.apply(null,arguments)},n._zappar_face_tracker_max_faces_set=function(){return n.asm._zappar_face_tracker_max_faces_set.apply(null,arguments)},n._zappar_face_tracker_model_load_from_memory=function(){return n.asm._zappar_face_tracker_model_load_from_memory.apply(null,arguments)},n._zappar_face_tracker_model_loaded_version=function(){return n.asm._zappar_face_tracker_model_loaded_version.apply(null,arguments)},n._zappar_has_initialized=function(){return n.asm._zappar_has_initialized.apply(null,arguments)},n._zappar_image_tracker_anchor_count=function(){return n.asm._zappar_image_tracker_anchor_count.apply(null,arguments)},n._zappar_image_tracker_anchor_id=function(){return n.asm._zappar_image_tracker_anchor_id.apply(null,arguments)},n._zappar_image_tracker_anchor_pose_raw=function(){return n.asm._zappar_image_tracker_anchor_pose_raw.apply(null,arguments)},n._zappar_image_tracker_create=function(){return n.asm._zappar_image_tracker_create.apply(null,arguments)},n._zappar_image_tracker_destroy=function(){return n.asm._zappar_image_tracker_destroy.apply(null,arguments)},n._zappar_image_tracker_enabled=function(){return n.asm._zappar_image_tracker_enabled.apply(null,arguments)},n._zappar_image_tracker_enabled_set=function(){return n.asm._zappar_image_tracker_enabled_set.apply(null,arguments)},n._zappar_image_tracker_target_count=function(){return n.asm._zappar_image_tracker_target_count.apply(null,arguments)},n._zappar_image_tracker_target_load_from_memory=function(){return n.asm._zappar_image_tracker_target_load_from_memory.apply(null,arguments)},n._zappar_image_tracker_target_loaded_version=function(){return n.asm._zappar_image_tracker_target_loaded_version.apply(null,arguments)},n._zappar_instant_world_tracker_anchor_pose_raw=function(){return n.asm._zappar_instant_world_tracker_anchor_pose_raw.apply(null,arguments)},n._zappar_instant_world_tracker_anchor_pose_set_from_camera_offset=function(){return n.asm._zappar_instant_world_tracker_anchor_pose_set_from_camera_offset.apply(null,arguments)},n._zappar_instant_world_tracker_create=function(){return n.asm._zappar_instant_world_tracker_create.apply(null,arguments)},n._zappar_instant_world_tracker_destroy=function(){return n.asm._zappar_instant_world_tracker_destroy.apply(null,arguments)},n._zappar_instant_world_tracker_enabled=function(){return n.asm._zappar_instant_world_tracker_enabled.apply(null,arguments)},n._zappar_instant_world_tracker_enabled_set=function(){return n.asm._zappar_instant_world_tracker_enabled_set.apply(null,arguments)},n._zappar_invert=function(){return n.asm._zappar_invert.apply(null,arguments)},n._zappar_loaded=function(){return n.asm._zappar_loaded.apply(null,arguments)},n._zappar_log_level=function(){return n.asm._zappar_log_level.apply(null,arguments)},n._zappar_log_level_set=function(){return n.asm._zappar_log_level_set.apply(null,arguments)},n._zappar_pipeline_camera_frame_camera_attitude=function(){return n.asm._zappar_pipeline_camera_frame_camera_attitude.apply(null,arguments)},n._zappar_pipeline_camera_frame_submit=function(){return n.asm._zappar_pipeline_camera_frame_submit.apply(null,arguments)},n._zappar_pipeline_camera_frame_texture_gl=function(){return n.asm._zappar_pipeline_camera_frame_texture_gl.apply(null,arguments)},n._zappar_pipeline_camera_frame_texture_matrix=function(){return n.asm._zappar_pipeline_camera_frame_texture_matrix.apply(null,arguments)},n._zappar_pipeline_camera_frame_upload_gl=function(){return n.asm._zappar_pipeline_camera_frame_upload_gl.apply(null,arguments)},n._zappar_pipeline_camera_frame_user_data=function(){return n.asm._zappar_pipeline_camera_frame_user_data.apply(null,arguments)},n._zappar_pipeline_camera_frame_user_facing=function(){return n.asm._zappar_pipeline_camera_frame_user_facing.apply(null,arguments)},n._zappar_pipeline_camera_model=function(){return n.asm._zappar_pipeline_camera_model.apply(null,arguments)},n._zappar_pipeline_camera_pose_default=function(){return n.asm._zappar_pipeline_camera_pose_default.apply(null,arguments)},n._zappar_pipeline_camera_pose_with_attitude=function(){return n.asm._zappar_pipeline_camera_pose_with_attitude.apply(null,arguments)},n._zappar_pipeline_camera_pose_with_origin=function(){return n.asm._zappar_pipeline_camera_pose_with_origin.apply(null,arguments)},n._zappar_pipeline_create=function(){return n.asm._zappar_pipeline_create.apply(null,arguments)},n._zappar_pipeline_destroy=function(){return n.asm._zappar_pipeline_destroy.apply(null,arguments)},n._zappar_pipeline_frame_number=function(){return n.asm._zappar_pipeline_frame_number.apply(null,arguments)},n._zappar_pipeline_frame_update=function(){return n.asm._zappar_pipeline_frame_update.apply(null,arguments)},n._zappar_pipeline_motion_accelerometer_submit=function(){return n.asm._zappar_pipeline_motion_accelerometer_submit.apply(null,arguments)},n._zappar_pipeline_motion_attitude_submit=function(){return n.asm._zappar_pipeline_motion_attitude_submit.apply(null,arguments)},n._zappar_pipeline_motion_rotation_rate_submit=function(){return n.asm._zappar_pipeline_motion_rotation_rate_submit.apply(null,arguments)},n._zappar_pipeline_process_gl=function(){return n.asm._zappar_pipeline_process_gl.apply(null,arguments)},n.establishStackSpace=function(){return n.asm.establishStackSpace.apply(null,arguments)},n.getTempRet0=function(){return n.asm.getTempRet0.apply(null,arguments)},n.runPostSets=function(){return n.asm.runPostSets.apply(null,arguments)};var hr=n.setTempRet0=function(){return n.asm.setTempRet0.apply(null,arguments)};n.setThrew=function(){return n.asm.setThrew.apply(null,arguments)};var yr=n.stackAlloc=function(){return n.asm.stackAlloc.apply(null,arguments)},br=n.stackRestore=function(){return n.asm.stackRestore.apply(null,arguments)},vr=n.stackSave=function(){return n.asm.stackSave.apply(null,arguments)};function gr(){function e(){if(!n.calledRun&&(n.calledRun=!0,!h)){if(ne||(ne=!0,K(Q)),K($),n.onRuntimeInitialized&&n.onRuntimeInitialized(),n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;){var e=n.postRun.shift();te.unshift(e)}K(te)}}if(!(0<ce)){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)re();K(J),0<ce||n.calledRun||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),e()}),1)):e())}}function wr(e){throw n.onAbort&&n.onAbort(e),void 0!==e?(u(e),c(e),e=JSON.stringify(e)):e="",h=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(n.dynCall_i=function(){return n.asm.dynCall_i.apply(null,arguments)},n.dynCall_ii=function(){return n.asm.dynCall_ii.apply(null,arguments)},n.dynCall_iii=function(){return n.asm.dynCall_iii.apply(null,arguments)},n.dynCall_iiii=function(){return n.asm.dynCall_iiii.apply(null,arguments)},n.dynCall_iiiii=function(){return n.asm.dynCall_iiiii.apply(null,arguments)},n.dynCall_iiiiid=function(){return n.asm.dynCall_iiiiid.apply(null,arguments)},n.dynCall_iiiiii=function(){return n.asm.dynCall_iiiiii.apply(null,arguments)},n.dynCall_iiiiiid=function(){return n.asm.dynCall_iiiiiid.apply(null,arguments)},n.dynCall_iiiiiii=function(){return n.asm.dynCall_iiiiiii.apply(null,arguments)},n.dynCall_iiiiiiii=function(){return n.asm.dynCall_iiiiiiii.apply(null,arguments)},n.dynCall_iiiiiiiii=function(){return n.asm.dynCall_iiiiiiiii.apply(null,arguments)},n.dynCall_iiiiij=function(){return n.asm.dynCall_iiiiij.apply(null,arguments)},n.dynCall_iiji=function(){return n.asm.dynCall_iiji.apply(null,arguments)},n.dynCall_v=function(){return n.asm.dynCall_v.apply(null,arguments)},n.dynCall_vi=function(){return n.asm.dynCall_vi.apply(null,arguments)},n.dynCall_vii=function(){return n.asm.dynCall_vii.apply(null,arguments)},n.dynCall_viiffii=function(){return n.asm.dynCall_viiffii.apply(null,arguments)},n.dynCall_viii=function(){return n.asm.dynCall_viii.apply(null,arguments)},n.dynCall_viiifffii=function(){return n.asm.dynCall_viiifffii.apply(null,arguments)},n.dynCall_viiiffii=function(){return n.asm.dynCall_viiiffii.apply(null,arguments)},n.dynCall_viiii=function(){return n.asm.dynCall_viiii.apply(null,arguments)},n.dynCall_viiiii=function(){return n.asm.dynCall_viiiii.apply(null,arguments)},n.dynCall_viiiiiffffffffffffffff=function(){return n.asm.dynCall_viiiiiffffffffffffffff.apply(null,arguments)},n.dynCall_viiiiii=function(){return n.asm.dynCall_viiiiii.apply(null,arguments)},n.dynCall_viijii=function(){return n.asm.dynCall_viijii.apply(null,arguments)},n.dynCall_vij=function(){return n.asm.dynCall_vij.apply(null,arguments)},n.dynCall_viji=function(){return n.asm.dynCall_viji.apply(null,arguments)},n.dynCall_vijii=function(){return n.asm.dynCall_vijii.apply(null,arguments)},n.asm=Un,n.cwrap=function(e,t,n,r){var a=(n=n||[]).every((function(e){return"number"===e}));return"string"!==t&&a&&!r?b(e):function(){var r=n,a=arguments,i=b(e),o=[],u=0;if(a)for(var c=0;c<a.length;c++){var f=g[r[c]];f?(0===u&&(u=vr()),o[c]=f(a[c])):o[c]=a[c]}return r=i.apply(null,o),r="string"===t?w(r):"boolean"===t?!!r:r,0!==u&&br(u),r}},n.setValue=function(e,t,n){switch("*"===(n=n||"i8").charAt(n.length-1)&&(n="i32"),n){case"i1":case"i8":E[e>>0]=t;break;case"i16":S[e>>1]=t;break;case"i32":T[e>>2]=t;break;case"i64":tempI64=[t>>>0,(tempDouble=t,1<=+ae(tempDouble)?0<tempDouble?(0|ue(+oe(tempDouble/4294967296),4294967295))>>>0:~~+ie((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],T[e>>2]=tempI64[0],T[e+4>>2]=tempI64[1];break;case"float":I[e>>2]=t;break;case"double":B[e>>3]=t;break;default:wr("invalid type for setValue: "+n)}},n.getValue=function(e,t){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return E[e>>0];case"i16":return S[e>>1];case"i32":case"i64":return T[e>>2];case"float":return I[e>>2];case"double":return B[e>>3];default:wr("invalid type for getValue: "+t)}return null},n.UTF8ToString=x,n.then=function(e){if(n.calledRun)e(n);else{var t=n.onRuntimeInitialized;n.onRuntimeInitialized=function(){t&&t(),e(n)}}return n},se=function e(){n.calledRun||gr(),n.calledRun||(se=e)},n.run=gr,n.abort=wr,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);0<n.preInit.length;)n.preInit.pop()();return n.noExitRuntime=!0,gr(),t}}();t.default=r},0:function(e,t,n){"use strict";n.r(t),n.d(t,{glMatrix:function(){return r},mat2:function(){return a},mat2d:function(){return i},mat3:function(){return o},mat4:function(){return u},quat:function(){return s},quat2:function(){return _},vec2:function(){return l},vec3:function(){return c},vec4:function(){return f}});var r={};n.r(r),n.d(r,{ARRAY_TYPE:function(){return d},EPSILON:function(){return p},RANDOM:function(){return m},equals:function(){return v},setMatrixArrayType:function(){return h},toRadian:function(){return b}});var a={};n.r(a),n.d(a,{LDU:function(){return j},add:function(){return D},adjoint:function(){return E},clone:function(){return w},copy:function(){return M},create:function(){return g},determinant:function(){return O},equals:function(){return q},exactEquals:function(){return V},frob:function(){return F},fromRotation:function(){return P},fromScaling:function(){return I},fromValues:function(){return x},identity:function(){return k},invert:function(){return L},mul:function(){return U},multiply:function(){return S},multiplyScalar:function(){return G},multiplyScalarAndAdd:function(){return N},rotate:function(){return C},scale:function(){return T},set:function(){return z},str:function(){return B},sub:function(){return W},subtract:function(){return R},transpose:function(){return A}});var i={};n.r(i),n.d(i,{add:function(){return fe},clone:function(){return Z},copy:function(){return Y},create:function(){return H},determinant:function(){return $},equals:function(){return de},exactEquals:function(){return pe},frob:function(){return ce},fromRotation:function(){return ae},fromScaling:function(){return ie},fromTranslation:function(){return oe},fromValues:function(){return K},identity:function(){return X},invert:function(){return Q},mul:function(){return me},multiply:function(){return ee},multiplyScalar:function(){return _e},multiplyScalarAndAdd:function(){return le},rotate:function(){return te},scale:function(){return ne},set:function(){return J},str:function(){return ue},sub:function(){return he},subtract:function(){return se},translate:function(){return re}});var o={};n.r(o),n.d(o,{add:function(){return qe},adjoint:function(){return Ae},clone:function(){return ve},copy:function(){return ge},create:function(){return ye},determinant:function(){return Le},equals:function(){return He},exactEquals:function(){return We},frob:function(){return Ve},fromMat2d:function(){return Be},fromMat4:function(){return be},fromQuat:function(){return Fe},fromRotation:function(){return Pe},fromScaling:function(){return Ie},fromTranslation:function(){return Te},fromValues:function(){return we},identity:function(){return ke},invert:function(){return ze},mul:function(){return Ze},multiply:function(){return Ee},multiplyScalar:function(){return Ne},multiplyScalarAndAdd:function(){return Ue},normalFromMat4:function(){return je},projection:function(){return De},rotate:function(){return Se},scale:function(){return Ce},set:function(){return Me},str:function(){return Re},sub:function(){return Ye},subtract:function(){return Ge},translate:function(){return Oe},transpose:function(){return xe}});var u={};n.r(u),n.d(u,{add:function(){return It},adjoint:function(){return rt},clone:function(){return Ke},copy:function(){return Je},create:function(){return Xe},determinant:function(){return at},equals:function(){return Rt},exactEquals:function(){return Dt},frob:function(){return Pt},fromQuat:function(){return zt},fromQuat2:function(){return vt},fromRotation:function(){return dt},fromRotationTranslation:function(){return bt},fromRotationTranslationScale:function(){return kt},fromRotationTranslationScaleOrigin:function(){return xt},fromScaling:function(){return pt},fromTranslation:function(){return lt},fromValues:function(){return Qe},fromXRotation:function(){return mt},fromYRotation:function(){return ht},fromZRotation:function(){return yt},frustum:function(){return At},getRotation:function(){return Mt},getScaling:function(){return wt},getTranslation:function(){return gt},identity:function(){return et},invert:function(){return nt},lookAt:function(){return St},mul:function(){return Vt},multiply:function(){return it},multiplyScalar:function(){return Ft},multiplyScalarAndAdd:function(){return jt},ortho:function(){return Ot},perspective:function(){return Lt},perspectiveFromFieldOfView:function(){return Et},rotate:function(){return ct},rotateX:function(){return ft},rotateY:function(){return st},rotateZ:function(){return _t},scale:function(){return ut},set:function(){return $e},str:function(){return Tt},sub:function(){return qt},subtract:function(){return Bt},targetTo:function(){return Ct},translate:function(){return ot},transpose:function(){return tt}});var c={};n.r(c),n.d(c,{add:function(){return Yt},angle:function(){return xn},bezier:function(){return hn},ceil:function(){return Qt},clone:function(){return Nt},copy:function(){return Ht},create:function(){return Gt},cross:function(){return pn},dist:function(){return Tn},distance:function(){return on},div:function(){return Cn},divide:function(){return Jt},dot:function(){return ln},equals:function(){return En},exactEquals:function(){return Ln},floor:function(){return $t},forEach:function(){return Fn},fromValues:function(){return Wt},hermite:function(){return mn},inverse:function(){return sn},len:function(){return In},length:function(){return Ut},lerp:function(){return dn},max:function(){return tn},min:function(){return en},mul:function(){return Sn},multiply:function(){return Kt},negate:function(){return fn},normalize:function(){return _n},random:function(){return yn},rotateX:function(){return wn},rotateY:function(){return Mn},rotateZ:function(){return kn},round:function(){return nn},scale:function(){return rn},scaleAndAdd:function(){return an},set:function(){return Zt},sqrDist:function(){return Pn},sqrLen:function(){return Bn},squaredDistance:function(){return un},squaredLength:function(){return cn},str:function(){return An},sub:function(){return On},subtract:function(){return Xt},transformMat3:function(){return vn},transformMat4:function(){return bn},transformQuat:function(){return gn},zero:function(){return zn}});var f={};n.r(f),n.d(f,{add:function(){return Gn},ceil:function(){return Hn},clone:function(){return Dn},copy:function(){return Vn},create:function(){return jn},cross:function(){return ur},dist:function(){return vr},distance:function(){return $n},div:function(){return br},divide:function(){return Wn},dot:function(){return or},equals:function(){return mr},exactEquals:function(){return dr},floor:function(){return Zn},forEach:function(){return kr},fromValues:function(){return Rn},inverse:function(){return ar},len:function(){return wr},length:function(){return tr},lerp:function(){return cr},max:function(){return Xn},min:function(){return Yn},mul:function(){return yr},multiply:function(){return Un},negate:function(){return rr},normalize:function(){return ir},random:function(){return fr},round:function(){return Kn},scale:function(){return Jn},scaleAndAdd:function(){return Qn},set:function(){return qn},sqrDist:function(){return gr},sqrLen:function(){return Mr},squaredDistance:function(){return er},squaredLength:function(){return nr},str:function(){return pr},sub:function(){return hr},subtract:function(){return Nn},transformMat4:function(){return sr},transformQuat:function(){return _r},zero:function(){return lr}});var s={};n.r(s),n.d(s,{add:function(){return Yr},calculateW:function(){return Pr},clone:function(){return Ur},conjugate:function(){return Vr},copy:function(){return Hr},create:function(){return xr},dot:function(){return Jr},equals:function(){return ia},exactEquals:function(){return aa},exp:function(){return Ir},fromEuler:function(){return Gr},fromMat3:function(){return qr},fromValues:function(){return Wr},getAngle:function(){return Er},getAxisAngle:function(){return Lr},identity:function(){return zr},invert:function(){return Rr},len:function(){return ea},length:function(){return $r},lerp:function(){return Qr},ln:function(){return Br},mul:function(){return Xr},multiply:function(){return Or},normalize:function(){return ra},pow:function(){return Fr},random:function(){return Dr},rotateX:function(){return Sr},rotateY:function(){return Cr},rotateZ:function(){return Tr},rotationTo:function(){return oa},scale:function(){return Kr},set:function(){return Zr},setAxes:function(){return ca},setAxisAngle:function(){return Ar},slerp:function(){return jr},sqlerp:function(){return ua},sqrLen:function(){return na},squaredLength:function(){return ta},str:function(){return Nr}});var _={};n.r(_),n.d(_,{add:function(){return Ta},clone:function(){return sa},conjugate:function(){return Ra},copy:function(){return ya},create:function(){return fa},dot:function(){return Fa},equals:function(){return Za},exactEquals:function(){return Ha},fromMat4:function(){return ha},fromRotation:function(){return ma},fromRotationTranslation:function(){return pa},fromRotationTranslationValues:function(){return la},fromTranslation:function(){return da},fromValues:function(){return _a},getDual:function(){return wa},getReal:function(){return ga},getTranslation:function(){return xa},identity:function(){return ba},invert:function(){return Da},len:function(){return qa},length:function(){return Va},lerp:function(){return ja},mul:function(){return Ia},multiply:function(){return Pa},normalize:function(){return Ua},rotateAroundAxis:function(){return Ca},rotateByQuatAppend:function(){return Oa},rotateByQuatPrepend:function(){return Sa},rotateX:function(){return Aa},rotateY:function(){return La},rotateZ:function(){return Ea},scale:function(){return Ba},set:function(){return va},setDual:function(){return ka},setReal:function(){return Ma},sqrLen:function(){return Na},squaredLength:function(){return Ga},str:function(){return Wa},translate:function(){return za}});var l={};n.r(l),n.d(l,{add:function(){return $a},angle:function(){return Ai},ceil:function(){return ri},clone:function(){return Xa},copy:function(){return Ja},create:function(){return Ya},cross:function(){return bi},dist:function(){return Bi},distance:function(){return si},div:function(){return Ii},divide:function(){return ni},dot:function(){return yi},equals:function(){return Si},exactEquals:function(){return Oi},floor:function(){return ai},forEach:function(){return Di},fromValues:function(){return Ka},inverse:function(){return mi},len:function(){return Ci},length:function(){return li},lerp:function(){return vi},max:function(){return oi},min:function(){return ii},mul:function(){return Pi},multiply:function(){return ti},negate:function(){return di},normalize:function(){return hi},random:function(){return gi},rotate:function(){return zi},round:function(){return ui},scale:function(){return ci},scaleAndAdd:function(){return fi},set:function(){return Qa},sqrDist:function(){return Fi},sqrLen:function(){return ji},squaredDistance:function(){return _i},squaredLength:function(){return pi},str:function(){return Ei},sub:function(){return Ti},subtract:function(){return ei},transformMat2:function(){return wi},transformMat2d:function(){return Mi},transformMat3:function(){return ki},transformMat4:function(){return xi},zero:function(){return Li}});var p=1e-6,d="undefined"!==typeof Float32Array?Float32Array:Array,m=Math.random;function h(e){d=e}var y=Math.PI/180;function b(e){return e*y}function v(e,t){return Math.abs(e-t)<=p*Math.max(1,Math.abs(e),Math.abs(t))}function g(){var e=new d(4);return d!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function w(e){var t=new d(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function M(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function k(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function x(e,t,n,r){var a=new d(4);return a[0]=e,a[1]=t,a[2]=n,a[3]=r,a}function z(e,t,n,r,a){return e[0]=t,e[1]=n,e[2]=r,e[3]=a,e}function A(e,t){if(e===t){var n=t[1];e[1]=t[2],e[2]=n}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e}function L(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=n*i-a*r;return o?(o=1/o,e[0]=i*o,e[1]=-r*o,e[2]=-a*o,e[3]=n*o,e):null}function E(e,t){var n=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=n,e}function O(e){return e[0]*e[3]-e[2]*e[1]}function S(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=n[0],c=n[1],f=n[2],s=n[3];return e[0]=r*u+i*c,e[1]=a*u+o*c,e[2]=r*f+i*s,e[3]=a*f+o*s,e}function C(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=Math.sin(n),c=Math.cos(n);return e[0]=r*c+i*u,e[1]=a*c+o*u,e[2]=r*-u+i*c,e[3]=a*-u+o*c,e}function T(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=n[0],c=n[1];return e[0]=r*u,e[1]=a*u,e[2]=i*c,e[3]=o*c,e}function P(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e}function I(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e}function B(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function F(e){return Math.hypot(e[0],e[1],e[2],e[3])}function j(e,t,n,r){return e[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-e[2]*n[1],[e,t,n]}function D(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function R(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function V(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function q(e,t){var n=e[0],r=e[1],a=e[2],i=e[3],o=t[0],u=t[1],c=t[2],f=t[3];return Math.abs(n-o)<=p*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-u)<=p*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(a-c)<=p*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(i-f)<=p*Math.max(1,Math.abs(i),Math.abs(f))}function G(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function N(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var U=S,W=R;function H(){var e=new d(6);return d!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function Z(e){var t=new d(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Y(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function X(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function K(e,t,n,r,a,i){var o=new d(6);return o[0]=e,o[1]=t,o[2]=n,o[3]=r,o[4]=a,o[5]=i,o}function J(e,t,n,r,a,i,o){return e[0]=t,e[1]=n,e[2]=r,e[3]=a,e[4]=i,e[5]=o,e}function Q(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=t[4],u=t[5],c=n*i-r*a;return c?(c=1/c,e[0]=i*c,e[1]=-r*c,e[2]=-a*c,e[3]=n*c,e[4]=(a*u-i*o)*c,e[5]=(r*o-n*u)*c,e):null}function $(e){return e[0]*e[3]-e[1]*e[2]}function ee(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=t[4],c=t[5],f=n[0],s=n[1],_=n[2],l=n[3],p=n[4],d=n[5];return e[0]=r*f+i*s,e[1]=a*f+o*s,e[2]=r*_+i*l,e[3]=a*_+o*l,e[4]=r*p+i*d+u,e[5]=a*p+o*d+c,e}function te(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=t[4],c=t[5],f=Math.sin(n),s=Math.cos(n);return e[0]=r*s+i*f,e[1]=a*s+o*f,e[2]=r*-f+i*s,e[3]=a*-f+o*s,e[4]=u,e[5]=c,e}function ne(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=t[4],c=t[5],f=n[0],s=n[1];return e[0]=r*f,e[1]=a*f,e[2]=i*s,e[3]=o*s,e[4]=u,e[5]=c,e}function re(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=t[4],c=t[5],f=n[0],s=n[1];return e[0]=r,e[1]=a,e[2]=i,e[3]=o,e[4]=r*f+i*s+u,e[5]=a*f+o*s+c,e}function ae(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e[4]=0,e[5]=0,e}function ie(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function oe(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function ue(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function ce(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)}function fe(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e}function se(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e}function _e(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e}function le(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e}function pe(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function de(e,t){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],c=t[0],f=t[1],s=t[2],_=t[3],l=t[4],d=t[5];return Math.abs(n-c)<=p*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-f)<=p*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(a-s)<=p*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(i-_)<=p*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-l)<=p*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(u-d)<=p*Math.max(1,Math.abs(u),Math.abs(d))}var me=ee,he=se;function ye(){var e=new d(9);return d!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function be(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function ve(e){var t=new d(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function ge(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function we(e,t,n,r,a,i,o,u,c){var f=new d(9);return f[0]=e,f[1]=t,f[2]=n,f[3]=r,f[4]=a,f[5]=i,f[6]=o,f[7]=u,f[8]=c,f}function Me(e,t,n,r,a,i,o,u,c,f){return e[0]=t,e[1]=n,e[2]=r,e[3]=a,e[4]=i,e[5]=o,e[6]=u,e[7]=c,e[8]=f,e}function ke(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function xe(e,t){if(e===t){var n=t[1],r=t[2],a=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=a}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function ze(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=t[4],u=t[5],c=t[6],f=t[7],s=t[8],_=s*o-u*f,l=-s*i+u*c,p=f*i-o*c,d=n*_+r*l+a*p;return d?(d=1/d,e[0]=_*d,e[1]=(-s*r+a*f)*d,e[2]=(u*r-a*o)*d,e[3]=l*d,e[4]=(s*n-a*c)*d,e[5]=(-u*n+a*i)*d,e[6]=p*d,e[7]=(-f*n+r*c)*d,e[8]=(o*n-r*i)*d,e):null}function Ae(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=t[4],u=t[5],c=t[6],f=t[7],s=t[8];return e[0]=o*s-u*f,e[1]=a*f-r*s,e[2]=r*u-a*o,e[3]=u*c-i*s,e[4]=n*s-a*c,e[5]=a*i-n*u,e[6]=i*f-o*c,e[7]=r*c-n*f,e[8]=n*o-r*i,e}function Le(e){var t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],u=e[6],c=e[7],f=e[8];return t*(f*i-o*c)+n*(-f*a+o*u)+r*(c*a-i*u)}function Ee(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=t[4],c=t[5],f=t[6],s=t[7],_=t[8],l=n[0],p=n[1],d=n[2],m=n[3],h=n[4],y=n[5],b=n[6],v=n[7],g=n[8];return e[0]=l*r+p*o+d*f,e[1]=l*a+p*u+d*s,e[2]=l*i+p*c+d*_,e[3]=m*r+h*o+y*f,e[4]=m*a+h*u+y*s,e[5]=m*i+h*c+y*_,e[6]=b*r+v*o+g*f,e[7]=b*a+v*u+g*s,e[8]=b*i+v*c+g*_,e}function Oe(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=t[4],c=t[5],f=t[6],s=t[7],_=t[8],l=n[0],p=n[1];return e[0]=r,e[1]=a,e[2]=i,e[3]=o,e[4]=u,e[5]=c,e[6]=l*r+p*o+f,e[7]=l*a+p*u+s,e[8]=l*i+p*c+_,e}function Se(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=t[4],c=t[5],f=t[6],s=t[7],_=t[8],l=Math.sin(n),p=Math.cos(n);return e[0]=p*r+l*o,e[1]=p*a+l*u,e[2]=p*i+l*c,e[3]=p*o-l*r,e[4]=p*u-l*a,e[5]=p*c-l*i,e[6]=f,e[7]=s,e[8]=_,e}function Ce(e,t,n){var r=n[0],a=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=a*t[3],e[4]=a*t[4],e[5]=a*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Te(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Pe(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ie(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Be(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function Fe(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=n+n,u=r+r,c=a+a,f=n*o,s=r*o,_=r*u,l=a*o,p=a*u,d=a*c,m=i*o,h=i*u,y=i*c;return e[0]=1-_-d,e[3]=s-y,e[6]=l+h,e[1]=s+y,e[4]=1-f-d,e[7]=p-m,e[2]=l-h,e[5]=p+m,e[8]=1-f-_,e}function je(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=t[4],u=t[5],c=t[6],f=t[7],s=t[8],_=t[9],l=t[10],p=t[11],d=t[12],m=t[13],h=t[14],y=t[15],b=n*u-r*o,v=n*c-a*o,g=n*f-i*o,w=r*c-a*u,M=r*f-i*u,k=a*f-i*c,x=s*m-_*d,z=s*h-l*d,A=s*y-p*d,L=_*h-l*m,E=_*y-p*m,O=l*y-p*h,S=b*O-v*E+g*L+w*A-M*z+k*x;return S?(S=1/S,e[0]=(u*O-c*E+f*L)*S,e[1]=(c*A-o*O-f*z)*S,e[2]=(o*E-u*A+f*x)*S,e[3]=(a*E-r*O-i*L)*S,e[4]=(n*O-a*A+i*z)*S,e[5]=(r*A-n*E-i*x)*S,e[6]=(m*k-h*M+y*w)*S,e[7]=(h*g-d*k-y*v)*S,e[8]=(d*M-m*g+y*b)*S,e):null}function De(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Re(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Ve(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function qe(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e}function Ge(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function Ne(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e}function Ue(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e}function We(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function He(e,t){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],c=e[6],f=e[7],s=e[8],_=t[0],l=t[1],d=t[2],m=t[3],h=t[4],y=t[5],b=t[6],v=t[7],g=t[8];return Math.abs(n-_)<=p*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(r-l)<=p*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(a-d)<=p*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(i-m)<=p*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(o-h)<=p*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(u-y)<=p*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(c-b)<=p*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(f-v)<=p*Math.max(1,Math.abs(f),Math.abs(v))&&Math.abs(s-g)<=p*Math.max(1,Math.abs(s),Math.abs(g))}var Ze=Ee,Ye=Ge;function Xe(){var e=new d(16);return d!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Ke(e){var t=new d(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Je(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Qe(e,t,n,r,a,i,o,u,c,f,s,_,l,p,m,h){var y=new d(16);return y[0]=e,y[1]=t,y[2]=n,y[3]=r,y[4]=a,y[5]=i,y[6]=o,y[7]=u,y[8]=c,y[9]=f,y[10]=s,y[11]=_,y[12]=l,y[13]=p,y[14]=m,y[15]=h,y}function $e(e,t,n,r,a,i,o,u,c,f,s,_,l,p,d,m,h){return e[0]=t,e[1]=n,e[2]=r,e[3]=a,e[4]=i,e[5]=o,e[6]=u,e[7]=c,e[8]=f,e[9]=s,e[10]=_,e[11]=l,e[12]=p,e[13]=d,e[14]=m,e[15]=h,e}function et(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function tt(e,t){if(e===t){var n=t[1],r=t[2],a=t[3],i=t[6],o=t[7],u=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=i,e[11]=t[14],e[12]=a,e[13]=o,e[14]=u}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function nt(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=t[4],u=t[5],c=t[6],f=t[7],s=t[8],_=t[9],l=t[10],p=t[11],d=t[12],m=t[13],h=t[14],y=t[15],b=n*u-r*o,v=n*c-a*o,g=n*f-i*o,w=r*c-a*u,M=r*f-i*u,k=a*f-i*c,x=s*m-_*d,z=s*h-l*d,A=s*y-p*d,L=_*h-l*m,E=_*y-p*m,O=l*y-p*h,S=b*O-v*E+g*L+w*A-M*z+k*x;return S?(S=1/S,e[0]=(u*O-c*E+f*L)*S,e[1]=(a*E-r*O-i*L)*S,e[2]=(m*k-h*M+y*w)*S,e[3]=(l*M-_*k-p*w)*S,e[4]=(c*A-o*O-f*z)*S,e[5]=(n*O-a*A+i*z)*S,e[6]=(h*g-d*k-y*v)*S,e[7]=(s*k-l*g+p*v)*S,e[8]=(o*E-u*A+f*x)*S,e[9]=(r*A-n*E-i*x)*S,e[10]=(d*M-m*g+y*b)*S,e[11]=(_*g-s*M-p*b)*S,e[12]=(u*z-o*L-c*x)*S,e[13]=(n*L-r*z+a*x)*S,e[14]=(m*v-d*w-h*b)*S,e[15]=(s*w-_*v+l*b)*S,e):null}function rt(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=t[4],u=t[5],c=t[6],f=t[7],s=t[8],_=t[9],l=t[10],p=t[11],d=t[12],m=t[13],h=t[14],y=t[15];return e[0]=u*(l*y-p*h)-_*(c*y-f*h)+m*(c*p-f*l),e[1]=-(r*(l*y-p*h)-_*(a*y-i*h)+m*(a*p-i*l)),e[2]=r*(c*y-f*h)-u*(a*y-i*h)+m*(a*f-i*c),e[3]=-(r*(c*p-f*l)-u*(a*p-i*l)+_*(a*f-i*c)),e[4]=-(o*(l*y-p*h)-s*(c*y-f*h)+d*(c*p-f*l)),e[5]=n*(l*y-p*h)-s*(a*y-i*h)+d*(a*p-i*l),e[6]=-(n*(c*y-f*h)-o*(a*y-i*h)+d*(a*f-i*c)),e[7]=n*(c*p-f*l)-o*(a*p-i*l)+s*(a*f-i*c),e[8]=o*(_*y-p*m)-s*(u*y-f*m)+d*(u*p-f*_),e[9]=-(n*(_*y-p*m)-s*(r*y-i*m)+d*(r*p-i*_)),e[10]=n*(u*y-f*m)-o*(r*y-i*m)+d*(r*f-i*u),e[11]=-(n*(u*p-f*_)-o*(r*p-i*_)+s*(r*f-i*u)),e[12]=-(o*(_*h-l*m)-s*(u*h-c*m)+d*(u*l-c*_)),e[13]=n*(_*h-l*m)-s*(r*h-a*m)+d*(r*l-a*_),e[14]=-(n*(u*h-c*m)-o*(r*h-a*m)+d*(r*c-a*u)),e[15]=n*(u*l-c*_)-o*(r*l-a*_)+s*(r*c-a*u),e}function at(e){var t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],u=e[6],c=e[7],f=e[8],s=e[9],_=e[10],l=e[11],p=e[12],d=e[13],m=e[14],h=e[15];return(t*o-n*i)*(_*h-l*m)-(t*u-r*i)*(s*h-l*d)+(t*c-a*i)*(s*m-_*d)+(n*u-r*o)*(f*h-l*p)-(n*c-a*o)*(f*m-_*p)+(r*c-a*u)*(f*d-s*p)}function it(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=t[4],c=t[5],f=t[6],s=t[7],_=t[8],l=t[9],p=t[10],d=t[11],m=t[12],h=t[13],y=t[14],b=t[15],v=n[0],g=n[1],w=n[2],M=n[3];return e[0]=v*r+g*u+w*_+M*m,e[1]=v*a+g*c+w*l+M*h,e[2]=v*i+g*f+w*p+M*y,e[3]=v*o+g*s+w*d+M*b,v=n[4],g=n[5],w=n[6],M=n[7],e[4]=v*r+g*u+w*_+M*m,e[5]=v*a+g*c+w*l+M*h,e[6]=v*i+g*f+w*p+M*y,e[7]=v*o+g*s+w*d+M*b,v=n[8],g=n[9],w=n[10],M=n[11],e[8]=v*r+g*u+w*_+M*m,e[9]=v*a+g*c+w*l+M*h,e[10]=v*i+g*f+w*p+M*y,e[11]=v*o+g*s+w*d+M*b,v=n[12],g=n[13],w=n[14],M=n[15],e[12]=v*r+g*u+w*_+M*m,e[13]=v*a+g*c+w*l+M*h,e[14]=v*i+g*f+w*p+M*y,e[15]=v*o+g*s+w*d+M*b,e}function ot(e,t,n){var r,a,i,o,u,c,f,s,_,l,p,d,m=n[0],h=n[1],y=n[2];return t===e?(e[12]=t[0]*m+t[4]*h+t[8]*y+t[12],e[13]=t[1]*m+t[5]*h+t[9]*y+t[13],e[14]=t[2]*m+t[6]*h+t[10]*y+t[14],e[15]=t[3]*m+t[7]*h+t[11]*y+t[15]):(r=t[0],a=t[1],i=t[2],o=t[3],u=t[4],c=t[5],f=t[6],s=t[7],_=t[8],l=t[9],p=t[10],d=t[11],e[0]=r,e[1]=a,e[2]=i,e[3]=o,e[4]=u,e[5]=c,e[6]=f,e[7]=s,e[8]=_,e[9]=l,e[10]=p,e[11]=d,e[12]=r*m+u*h+_*y+t[12],e[13]=a*m+c*h+l*y+t[13],e[14]=i*m+f*h+p*y+t[14],e[15]=o*m+s*h+d*y+t[15]),e}function ut(e,t,n){var r=n[0],a=n[1],i=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ct(e,t,n,r){var a,i,o,u,c,f,s,_,l,d,m,h,y,b,v,g,w,M,k,x,z,A,L,E,O=r[0],S=r[1],C=r[2],T=Math.hypot(O,S,C);return T<p?null:(O*=T=1/T,S*=T,C*=T,a=Math.sin(n),o=1-(i=Math.cos(n)),u=t[0],c=t[1],f=t[2],s=t[3],_=t[4],l=t[5],d=t[6],m=t[7],h=t[8],y=t[9],b=t[10],v=t[11],g=O*O*o+i,w=S*O*o+C*a,M=C*O*o-S*a,k=O*S*o-C*a,x=S*S*o+i,z=C*S*o+O*a,A=O*C*o+S*a,L=S*C*o-O*a,E=C*C*o+i,e[0]=u*g+_*w+h*M,e[1]=c*g+l*w+y*M,e[2]=f*g+d*w+b*M,e[3]=s*g+m*w+v*M,e[4]=u*k+_*x+h*z,e[5]=c*k+l*x+y*z,e[6]=f*k+d*x+b*z,e[7]=s*k+m*x+v*z,e[8]=u*A+_*L+h*E,e[9]=c*A+l*L+y*E,e[10]=f*A+d*L+b*E,e[11]=s*A+m*L+v*E,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function ft(e,t,n){var r=Math.sin(n),a=Math.cos(n),i=t[4],o=t[5],u=t[6],c=t[7],f=t[8],s=t[9],_=t[10],l=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*a+f*r,e[5]=o*a+s*r,e[6]=u*a+_*r,e[7]=c*a+l*r,e[8]=f*a-i*r,e[9]=s*a-o*r,e[10]=_*a-u*r,e[11]=l*a-c*r,e}function st(e,t,n){var r=Math.sin(n),a=Math.cos(n),i=t[0],o=t[1],u=t[2],c=t[3],f=t[8],s=t[9],_=t[10],l=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*a-f*r,e[1]=o*a-s*r,e[2]=u*a-_*r,e[3]=c*a-l*r,e[8]=i*r+f*a,e[9]=o*r+s*a,e[10]=u*r+_*a,e[11]=c*r+l*a,e}function _t(e,t,n){var r=Math.sin(n),a=Math.cos(n),i=t[0],o=t[1],u=t[2],c=t[3],f=t[4],s=t[5],_=t[6],l=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*a+f*r,e[1]=o*a+s*r,e[2]=u*a+_*r,e[3]=c*a+l*r,e[4]=f*a-i*r,e[5]=s*a-o*r,e[6]=_*a-u*r,e[7]=l*a-c*r,e}function lt(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function pt(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function dt(e,t,n){var r,a,i,o=n[0],u=n[1],c=n[2],f=Math.hypot(o,u,c);return f<p?null:(o*=f=1/f,u*=f,c*=f,r=Math.sin(t),i=1-(a=Math.cos(t)),e[0]=o*o*i+a,e[1]=u*o*i+c*r,e[2]=c*o*i-u*r,e[3]=0,e[4]=o*u*i-c*r,e[5]=u*u*i+a,e[6]=c*u*i+o*r,e[7]=0,e[8]=o*c*i+u*r,e[9]=u*c*i-o*r,e[10]=c*c*i+a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function mt(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ht(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function yt(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function bt(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=r+r,c=a+a,f=i+i,s=r*u,_=r*c,l=r*f,p=a*c,d=a*f,m=i*f,h=o*u,y=o*c,b=o*f;return e[0]=1-(p+m),e[1]=_+b,e[2]=l-y,e[3]=0,e[4]=_-b,e[5]=1-(s+m),e[6]=d+h,e[7]=0,e[8]=l+y,e[9]=d-h,e[10]=1-(s+p),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function vt(e,t){var n=new d(3),r=-t[0],a=-t[1],i=-t[2],o=t[3],u=t[4],c=t[5],f=t[6],s=t[7],_=r*r+a*a+i*i+o*o;return _>0?(n[0]=2*(u*o+s*r+c*i-f*a)/_,n[1]=2*(c*o+s*a+f*r-u*i)/_,n[2]=2*(f*o+s*i+u*a-c*r)/_):(n[0]=2*(u*o+s*r+c*i-f*a),n[1]=2*(c*o+s*a+f*r-u*i),n[2]=2*(f*o+s*i+u*a-c*r)),bt(e,t,n),e}function gt(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function wt(e,t){var n=t[0],r=t[1],a=t[2],i=t[4],o=t[5],u=t[6],c=t[8],f=t[9],s=t[10];return e[0]=Math.hypot(n,r,a),e[1]=Math.hypot(i,o,u),e[2]=Math.hypot(c,f,s),e}function Mt(e,t){var n=new d(3);wt(n,t);var r=1/n[0],a=1/n[1],i=1/n[2],o=t[0]*r,u=t[1]*a,c=t[2]*i,f=t[4]*r,s=t[5]*a,_=t[6]*i,l=t[8]*r,p=t[9]*a,m=t[10]*i,h=o+s+m,y=0;return h>0?(y=2*Math.sqrt(h+1),e[3]=.25*y,e[0]=(_-p)/y,e[1]=(l-c)/y,e[2]=(u-f)/y):o>s&&o>m?(y=2*Math.sqrt(1+o-s-m),e[3]=(_-p)/y,e[0]=.25*y,e[1]=(u+f)/y,e[2]=(l+c)/y):s>m?(y=2*Math.sqrt(1+s-o-m),e[3]=(l-c)/y,e[0]=(u+f)/y,e[1]=.25*y,e[2]=(_+p)/y):(y=2*Math.sqrt(1+m-o-s),e[3]=(u-f)/y,e[0]=(l+c)/y,e[1]=(_+p)/y,e[2]=.25*y),e}function kt(e,t,n,r){var a=t[0],i=t[1],o=t[2],u=t[3],c=a+a,f=i+i,s=o+o,_=a*c,l=a*f,p=a*s,d=i*f,m=i*s,h=o*s,y=u*c,b=u*f,v=u*s,g=r[0],w=r[1],M=r[2];return e[0]=(1-(d+h))*g,e[1]=(l+v)*g,e[2]=(p-b)*g,e[3]=0,e[4]=(l-v)*w,e[5]=(1-(_+h))*w,e[6]=(m+y)*w,e[7]=0,e[8]=(p+b)*M,e[9]=(m-y)*M,e[10]=(1-(_+d))*M,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function xt(e,t,n,r,a){var i=t[0],o=t[1],u=t[2],c=t[3],f=i+i,s=o+o,_=u+u,l=i*f,p=i*s,d=i*_,m=o*s,h=o*_,y=u*_,b=c*f,v=c*s,g=c*_,w=r[0],M=r[1],k=r[2],x=a[0],z=a[1],A=a[2],L=(1-(m+y))*w,E=(p+g)*w,O=(d-v)*w,S=(p-g)*M,C=(1-(l+y))*M,T=(h+b)*M,P=(d+v)*k,I=(h-b)*k,B=(1-(l+m))*k;return e[0]=L,e[1]=E,e[2]=O,e[3]=0,e[4]=S,e[5]=C,e[6]=T,e[7]=0,e[8]=P,e[9]=I,e[10]=B,e[11]=0,e[12]=n[0]+x-(L*x+S*z+P*A),e[13]=n[1]+z-(E*x+C*z+I*A),e[14]=n[2]+A-(O*x+T*z+B*A),e[15]=1,e}function zt(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=n+n,u=r+r,c=a+a,f=n*o,s=r*o,_=r*u,l=a*o,p=a*u,d=a*c,m=i*o,h=i*u,y=i*c;return e[0]=1-_-d,e[1]=s+y,e[2]=l-h,e[3]=0,e[4]=s-y,e[5]=1-f-d,e[6]=p+m,e[7]=0,e[8]=l+h,e[9]=p-m,e[10]=1-f-_,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function At(e,t,n,r,a,i,o){var u=1/(n-t),c=1/(a-r),f=1/(i-o);return e[0]=2*i*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*i*c,e[6]=0,e[7]=0,e[8]=(n+t)*u,e[9]=(a+r)*c,e[10]=(o+i)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*i*2*f,e[15]=0,e}function Lt(e,t,n,r,a){var i,o=1/Math.tan(t/2);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=a&&a!==1/0?(i=1/(r-a),e[10]=(a+r)*i,e[14]=2*a*r*i):(e[10]=-1,e[14]=-2*r),e}function Et(e,t,n,r){var a=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),u=Math.tan(t.rightDegrees*Math.PI/180),c=2/(o+u),f=2/(a+i);return e[0]=c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=-(o-u)*c*.5,e[9]=(a-i)*f*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function Ot(e,t,n,r,a,i,o){var u=1/(t-n),c=1/(r-a),f=1/(i-o);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(t+n)*u,e[13]=(a+r)*c,e[14]=(o+i)*f,e[15]=1,e}function St(e,t,n,r){var a,i,o,u,c,f,s,_,l,d,m=t[0],h=t[1],y=t[2],b=r[0],v=r[1],g=r[2],w=n[0],M=n[1],k=n[2];return Math.abs(m-w)<p&&Math.abs(h-M)<p&&Math.abs(y-k)<p?et(e):(s=m-w,_=h-M,l=y-k,a=v*(l*=d=1/Math.hypot(s,_,l))-g*(_*=d),i=g*(s*=d)-b*l,o=b*_-v*s,(d=Math.hypot(a,i,o))?(a*=d=1/d,i*=d,o*=d):(a=0,i=0,o=0),u=_*o-l*i,c=l*a-s*o,f=s*i-_*a,(d=Math.hypot(u,c,f))?(u*=d=1/d,c*=d,f*=d):(u=0,c=0,f=0),e[0]=a,e[1]=u,e[2]=s,e[3]=0,e[4]=i,e[5]=c,e[6]=_,e[7]=0,e[8]=o,e[9]=f,e[10]=l,e[11]=0,e[12]=-(a*m+i*h+o*y),e[13]=-(u*m+c*h+f*y),e[14]=-(s*m+_*h+l*y),e[15]=1,e)}function Ct(e,t,n,r){var a=t[0],i=t[1],o=t[2],u=r[0],c=r[1],f=r[2],s=a-n[0],_=i-n[1],l=o-n[2],p=s*s+_*_+l*l;p>0&&(s*=p=1/Math.sqrt(p),_*=p,l*=p);var d=c*l-f*_,m=f*s-u*l,h=u*_-c*s;return(p=d*d+m*m+h*h)>0&&(d*=p=1/Math.sqrt(p),m*=p,h*=p),e[0]=d,e[1]=m,e[2]=h,e[3]=0,e[4]=_*h-l*m,e[5]=l*d-s*h,e[6]=s*m-_*d,e[7]=0,e[8]=s,e[9]=_,e[10]=l,e[11]=0,e[12]=a,e[13]=i,e[14]=o,e[15]=1,e}function Tt(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Pt(e){return Math.hypot(e[0],e[1],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function It(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function Bt(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function Ft(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function jt(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function Dt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Rt(e,t){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],c=e[6],f=e[7],s=e[8],_=e[9],l=e[10],d=e[11],m=e[12],h=e[13],y=e[14],b=e[15],v=t[0],g=t[1],w=t[2],M=t[3],k=t[4],x=t[5],z=t[6],A=t[7],L=t[8],E=t[9],O=t[10],S=t[11],C=t[12],T=t[13],P=t[14],I=t[15];return Math.abs(n-v)<=p*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-g)<=p*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(a-w)<=p*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(i-M)<=p*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(o-k)<=p*Math.max(1,Math.abs(o),Math.abs(k))&&Math.abs(u-x)<=p*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(c-z)<=p*Math.max(1,Math.abs(c),Math.abs(z))&&Math.abs(f-A)<=p*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(s-L)<=p*Math.max(1,Math.abs(s),Math.abs(L))&&Math.abs(_-E)<=p*Math.max(1,Math.abs(_),Math.abs(E))&&Math.abs(l-O)<=p*Math.max(1,Math.abs(l),Math.abs(O))&&Math.abs(d-S)<=p*Math.max(1,Math.abs(d),Math.abs(S))&&Math.abs(m-C)<=p*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(h-T)<=p*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(y-P)<=p*Math.max(1,Math.abs(y),Math.abs(P))&&Math.abs(b-I)<=p*Math.max(1,Math.abs(b),Math.abs(I))}var Vt=it,qt=Bt;function Gt(){var e=new d(3);return d!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Nt(e){var t=new d(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Ut(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function Wt(e,t,n){var r=new d(3);return r[0]=e,r[1]=t,r[2]=n,r}function Ht(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Zt(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function Yt(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Xt(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function Kt(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function Jt(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function Qt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function $t(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function en(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function tn(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function nn(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function rn(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function an(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function on(e,t){var n=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2];return Math.hypot(n,r,a)}function un(e,t){var n=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2];return n*n+r*r+a*a}function cn(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function fn(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function sn(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function _n(e,t){var n=t[0],r=t[1],a=t[2],i=n*n+r*r+a*a;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function ln(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function pn(e,t,n){var r=t[0],a=t[1],i=t[2],o=n[0],u=n[1],c=n[2];return e[0]=a*c-i*u,e[1]=i*o-r*c,e[2]=r*u-a*o,e}function dn(e,t,n,r){var a=t[0],i=t[1],o=t[2];return e[0]=a+r*(n[0]-a),e[1]=i+r*(n[1]-i),e[2]=o+r*(n[2]-o),e}function mn(e,t,n,r,a,i){var o=i*i,u=o*(2*i-3)+1,c=o*(i-2)+i,f=o*(i-1),s=o*(3-2*i);return e[0]=t[0]*u+n[0]*c+r[0]*f+a[0]*s,e[1]=t[1]*u+n[1]*c+r[1]*f+a[1]*s,e[2]=t[2]*u+n[2]*c+r[2]*f+a[2]*s,e}function hn(e,t,n,r,a,i){var o=1-i,u=o*o,c=i*i,f=u*o,s=3*i*u,_=3*c*o,l=c*i;return e[0]=t[0]*f+n[0]*s+r[0]*_+a[0]*l,e[1]=t[1]*f+n[1]*s+r[1]*_+a[1]*l,e[2]=t[2]*f+n[2]*s+r[2]*_+a[2]*l,e}function yn(e,t){t=t||1;var n=2*m()*Math.PI,r=2*m()-1,a=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*a,e[1]=Math.sin(n)*a,e[2]=r*t,e}function bn(e,t,n){var r=t[0],a=t[1],i=t[2],o=n[3]*r+n[7]*a+n[11]*i+n[15];return o=o||1,e[0]=(n[0]*r+n[4]*a+n[8]*i+n[12])/o,e[1]=(n[1]*r+n[5]*a+n[9]*i+n[13])/o,e[2]=(n[2]*r+n[6]*a+n[10]*i+n[14])/o,e}function vn(e,t,n){var r=t[0],a=t[1],i=t[2];return e[0]=r*n[0]+a*n[3]+i*n[6],e[1]=r*n[1]+a*n[4]+i*n[7],e[2]=r*n[2]+a*n[5]+i*n[8],e}function gn(e,t,n){var r=n[0],a=n[1],i=n[2],o=n[3],u=t[0],c=t[1],f=t[2],s=a*f-i*c,_=i*u-r*f,l=r*c-a*u,p=a*l-i*_,d=i*s-r*l,m=r*_-a*s,h=2*o;return s*=h,_*=h,l*=h,p*=2,d*=2,m*=2,e[0]=u+s+p,e[1]=c+_+d,e[2]=f+l+m,e}function wn(e,t,n,r){var a=[],i=[];return a[0]=t[0]-n[0],a[1]=t[1]-n[1],a[2]=t[2]-n[2],i[0]=a[0],i[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),i[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function Mn(e,t,n,r){var a=[],i=[];return a[0]=t[0]-n[0],a[1]=t[1]-n[1],a[2]=t[2]-n[2],i[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),i[1]=a[1],i[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function kn(e,t,n,r){var a=[],i=[];return a[0]=t[0]-n[0],a[1]=t[1]-n[1],a[2]=t[2]-n[2],i[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),i[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),i[2]=a[2],e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function xn(e,t){var n=Wt(e[0],e[1],e[2]),r=Wt(t[0],t[1],t[2]);_n(n,n),_n(r,r);var a=ln(n,r);return a>1?0:a<-1?Math.PI:Math.acos(a)}function zn(e){return e[0]=0,e[1]=0,e[2]=0,e}function An(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Ln(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function En(e,t){var n=e[0],r=e[1],a=e[2],i=t[0],o=t[1],u=t[2];return Math.abs(n-i)<=p*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=p*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-u)<=p*Math.max(1,Math.abs(a),Math.abs(u))}var On=Xt,Sn=Kt,Cn=Jt,Tn=on,Pn=un,In=Ut,Bn=cn,Fn=function(){var e=Gt();return function(t,n,r,a,i,o){var u,c;for(n||(n=3),r||(r=0),c=a?Math.min(a*n+r,t.length):t.length,u=r;u<c;u+=n)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],i(e,e,o),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2];return t}}();function jn(){var e=new d(4);return d!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Dn(e){var t=new d(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Rn(e,t,n,r){var a=new d(4);return a[0]=e,a[1]=t,a[2]=n,a[3]=r,a}function Vn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function qn(e,t,n,r,a){return e[0]=t,e[1]=n,e[2]=r,e[3]=a,e}function Gn(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function Nn(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function Un(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function Wn(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function Hn(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Zn(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Yn(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e}function Xn(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e}function Kn(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function Jn(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function Qn(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}function $n(e,t){var n=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2],i=t[3]-e[3];return Math.hypot(n,r,a,i)}function er(e,t){var n=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2],i=t[3]-e[3];return n*n+r*r+a*a+i*i}function tr(e){var t=e[0],n=e[1],r=e[2],a=e[3];return Math.hypot(t,n,r,a)}function nr(e){var t=e[0],n=e[1],r=e[2],a=e[3];return t*t+n*n+r*r+a*a}function rr(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function ar(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function ir(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=n*n+r*r+a*a+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=n*o,e[1]=r*o,e[2]=a*o,e[3]=i*o,e}function or(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function ur(e,t,n,r){var a=n[0]*r[1]-n[1]*r[0],i=n[0]*r[2]-n[2]*r[0],o=n[0]*r[3]-n[3]*r[0],u=n[1]*r[2]-n[2]*r[1],c=n[1]*r[3]-n[3]*r[1],f=n[2]*r[3]-n[3]*r[2],s=t[0],_=t[1],l=t[2],p=t[3];return e[0]=_*f-l*c+p*u,e[1]=-s*f+l*o-p*i,e[2]=s*c-_*o+p*a,e[3]=-s*u+_*i-l*a,e}function cr(e,t,n,r){var a=t[0],i=t[1],o=t[2],u=t[3];return e[0]=a+r*(n[0]-a),e[1]=i+r*(n[1]-i),e[2]=o+r*(n[2]-o),e[3]=u+r*(n[3]-u),e}function fr(e,t){var n,r,a,i,o,u;t=t||1;do{o=(n=2*m()-1)*n+(r=2*m()-1)*r}while(o>=1);do{u=(a=2*m()-1)*a+(i=2*m()-1)*i}while(u>=1);var c=Math.sqrt((1-o)/u);return e[0]=t*n,e[1]=t*r,e[2]=t*a*c,e[3]=t*i*c,e}function sr(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3];return e[0]=n[0]*r+n[4]*a+n[8]*i+n[12]*o,e[1]=n[1]*r+n[5]*a+n[9]*i+n[13]*o,e[2]=n[2]*r+n[6]*a+n[10]*i+n[14]*o,e[3]=n[3]*r+n[7]*a+n[11]*i+n[15]*o,e}function _r(e,t,n){var r=t[0],a=t[1],i=t[2],o=n[0],u=n[1],c=n[2],f=n[3],s=f*r+u*i-c*a,_=f*a+c*r-o*i,l=f*i+o*a-u*r,p=-o*r-u*a-c*i;return e[0]=s*f+p*-o+_*-c-l*-u,e[1]=_*f+p*-u+l*-o-s*-c,e[2]=l*f+p*-c+s*-u-_*-o,e[3]=t[3],e}function lr(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function pr(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function dr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function mr(e,t){var n=e[0],r=e[1],a=e[2],i=e[3],o=t[0],u=t[1],c=t[2],f=t[3];return Math.abs(n-o)<=p*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-u)<=p*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(a-c)<=p*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(i-f)<=p*Math.max(1,Math.abs(i),Math.abs(f))}var hr=Nn,yr=Un,br=Wn,vr=$n,gr=er,wr=tr,Mr=nr,kr=function(){var e=jn();return function(t,n,r,a,i,o){var u,c;for(n||(n=4),r||(r=0),c=a?Math.min(a*n+r,t.length):t.length,u=r;u<c;u+=n)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],e[3]=t[u+3],i(e,e,o),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2],t[u+3]=e[3];return t}}();function xr(){var e=new d(4);return d!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function zr(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Ar(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function Lr(e,t){var n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>p?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function Er(e,t){var n=Jr(e,t);return Math.acos(2*n*n-1)}function Or(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=n[0],c=n[1],f=n[2],s=n[3];return e[0]=r*s+o*u+a*f-i*c,e[1]=a*s+o*c+i*u-r*f,e[2]=i*s+o*f+r*c-a*u,e[3]=o*s-r*u-a*c-i*f,e}function Sr(e,t,n){n*=.5;var r=t[0],a=t[1],i=t[2],o=t[3],u=Math.sin(n),c=Math.cos(n);return e[0]=r*c+o*u,e[1]=a*c+i*u,e[2]=i*c-a*u,e[3]=o*c-r*u,e}function Cr(e,t,n){n*=.5;var r=t[0],a=t[1],i=t[2],o=t[3],u=Math.sin(n),c=Math.cos(n);return e[0]=r*c-i*u,e[1]=a*c+o*u,e[2]=i*c+r*u,e[3]=o*c-a*u,e}function Tr(e,t,n){n*=.5;var r=t[0],a=t[1],i=t[2],o=t[3],u=Math.sin(n),c=Math.cos(n);return e[0]=r*c+a*u,e[1]=a*c-r*u,e[2]=i*c+o*u,e[3]=o*c-i*u,e}function Pr(e,t){var n=t[0],r=t[1],a=t[2];return e[0]=n,e[1]=r,e[2]=a,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-a*a)),e}function Ir(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=Math.sqrt(n*n+r*r+a*a),u=Math.exp(i),c=o>0?u*Math.sin(o)/o:0;return e[0]=n*c,e[1]=r*c,e[2]=a*c,e[3]=u*Math.cos(o),e}function Br(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=Math.sqrt(n*n+r*r+a*a),u=o>0?Math.atan2(o,i)/o:0;return e[0]=n*u,e[1]=r*u,e[2]=a*u,e[3]=.5*Math.log(n*n+r*r+a*a+i*i),e}function Fr(e,t,n){return Br(e,t),Kr(e,e,n),Ir(e,e),e}function jr(e,t,n,r){var a,i,o,u,c,f=t[0],s=t[1],_=t[2],l=t[3],d=n[0],m=n[1],h=n[2],y=n[3];return(i=f*d+s*m+_*h+l*y)<0&&(i=-i,d=-d,m=-m,h=-h,y=-y),1-i>p?(a=Math.acos(i),o=Math.sin(a),u=Math.sin((1-r)*a)/o,c=Math.sin(r*a)/o):(u=1-r,c=r),e[0]=u*f+c*d,e[1]=u*s+c*m,e[2]=u*_+c*h,e[3]=u*l+c*y,e}function Dr(e){var t=m(),n=m(),r=m(),a=Math.sqrt(1-t),i=Math.sqrt(t);return e[0]=a*Math.sin(2*Math.PI*n),e[1]=a*Math.cos(2*Math.PI*n),e[2]=i*Math.sin(2*Math.PI*r),e[3]=i*Math.cos(2*Math.PI*r),e}function Rr(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=n*n+r*r+a*a+i*i,u=o?1/o:0;return e[0]=-n*u,e[1]=-r*u,e[2]=-a*u,e[3]=i*u,e}function Vr(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function qr(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var a=0;t[4]>t[0]&&(a=1),t[8]>t[3*a+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;n=Math.sqrt(t[3*a+a]-t[3*i+i]-t[3*o+o]+1),e[a]=.5*n,n=.5/n,e[3]=(t[3*i+o]-t[3*o+i])*n,e[i]=(t[3*i+a]+t[3*a+i])*n,e[o]=(t[3*o+a]+t[3*a+o])*n}return e}function Gr(e,t,n,r){var a=.5*Math.PI/180;t*=a,n*=a,r*=a;var i=Math.sin(t),o=Math.cos(t),u=Math.sin(n),c=Math.cos(n),f=Math.sin(r),s=Math.cos(r);return e[0]=i*c*s-o*u*f,e[1]=o*u*s+i*c*f,e[2]=o*c*f-i*u*s,e[3]=o*c*s+i*u*f,e}function Nr(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Ur=Dn,Wr=Rn,Hr=Vn,Zr=qn,Yr=Gn,Xr=Or,Kr=Jn,Jr=or,Qr=cr,$r=tr,ea=$r,ta=nr,na=ta,ra=ir,aa=dr,ia=mr,oa=function(){var e=Gt(),t=Wt(1,0,0),n=Wt(0,1,0);return function(r,a,i){var o=ln(a,i);return o<-.999999?(pn(e,t,a),In(e)<1e-6&&pn(e,n,a),_n(e,e),Ar(r,e,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(pn(e,a,i),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+o,ra(r,r))}}(),ua=function(){var e=xr(),t=xr();return function(n,r,a,i,o,u){return jr(e,r,o,u),jr(t,a,i,u),jr(n,e,t,2*u*(1-u)),n}}(),ca=function(){var e=ye();return function(t,n,r,a){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],ra(t,qr(t,e))}}();function fa(){var e=new d(8);return d!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function sa(e){var t=new d(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function _a(e,t,n,r,a,i,o,u){var c=new d(8);return c[0]=e,c[1]=t,c[2]=n,c[3]=r,c[4]=a,c[5]=i,c[6]=o,c[7]=u,c}function la(e,t,n,r,a,i,o){var u=new d(8);u[0]=e,u[1]=t,u[2]=n,u[3]=r;var c=.5*a,f=.5*i,s=.5*o;return u[4]=c*r+f*n-s*t,u[5]=f*r+s*e-c*n,u[6]=s*r+c*t-f*e,u[7]=-c*e-f*t-s*n,u}function pa(e,t,n){var r=.5*n[0],a=.5*n[1],i=.5*n[2],o=t[0],u=t[1],c=t[2],f=t[3];return e[0]=o,e[1]=u,e[2]=c,e[3]=f,e[4]=r*f+a*c-i*u,e[5]=a*f+i*o-r*c,e[6]=i*f+r*u-a*o,e[7]=-r*o-a*u-i*c,e}function da(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e}function ma(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function ha(e,t){var n=xr();Mt(n,t);var r=new d(3);return gt(r,t),pa(e,n,r),e}function ya(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function ba(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function va(e,t,n,r,a,i,o,u,c){return e[0]=t,e[1]=n,e[2]=r,e[3]=a,e[4]=i,e[5]=o,e[6]=u,e[7]=c,e}var ga=Hr;function wa(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e}var Ma=Hr;function ka(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e}function xa(e,t){var n=t[4],r=t[5],a=t[6],i=t[7],o=-t[0],u=-t[1],c=-t[2],f=t[3];return e[0]=2*(n*f+i*o+r*c-a*u),e[1]=2*(r*f+i*u+a*o-n*c),e[2]=2*(a*f+i*c+n*u-r*o),e}function za(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=.5*n[0],c=.5*n[1],f=.5*n[2],s=t[4],_=t[5],l=t[6],p=t[7];return e[0]=r,e[1]=a,e[2]=i,e[3]=o,e[4]=o*u+a*f-i*c+s,e[5]=o*c+i*u-r*f+_,e[6]=o*f+r*c-a*u+l,e[7]=-r*u-a*c-i*f+p,e}function Aa(e,t,n){var r=-t[0],a=-t[1],i=-t[2],o=t[3],u=t[4],c=t[5],f=t[6],s=t[7],_=u*o+s*r+c*i-f*a,l=c*o+s*a+f*r-u*i,p=f*o+s*i+u*a-c*r,d=s*o-u*r-c*a-f*i;return Sr(e,t,n),r=e[0],a=e[1],i=e[2],o=e[3],e[4]=_*o+d*r+l*i-p*a,e[5]=l*o+d*a+p*r-_*i,e[6]=p*o+d*i+_*a-l*r,e[7]=d*o-_*r-l*a-p*i,e}function La(e,t,n){var r=-t[0],a=-t[1],i=-t[2],o=t[3],u=t[4],c=t[5],f=t[6],s=t[7],_=u*o+s*r+c*i-f*a,l=c*o+s*a+f*r-u*i,p=f*o+s*i+u*a-c*r,d=s*o-u*r-c*a-f*i;return Cr(e,t,n),r=e[0],a=e[1],i=e[2],o=e[3],e[4]=_*o+d*r+l*i-p*a,e[5]=l*o+d*a+p*r-_*i,e[6]=p*o+d*i+_*a-l*r,e[7]=d*o-_*r-l*a-p*i,e}function Ea(e,t,n){var r=-t[0],a=-t[1],i=-t[2],o=t[3],u=t[4],c=t[5],f=t[6],s=t[7],_=u*o+s*r+c*i-f*a,l=c*o+s*a+f*r-u*i,p=f*o+s*i+u*a-c*r,d=s*o-u*r-c*a-f*i;return Tr(e,t,n),r=e[0],a=e[1],i=e[2],o=e[3],e[4]=_*o+d*r+l*i-p*a,e[5]=l*o+d*a+p*r-_*i,e[6]=p*o+d*i+_*a-l*r,e[7]=d*o-_*r-l*a-p*i,e}function Oa(e,t,n){var r=n[0],a=n[1],i=n[2],o=n[3],u=t[0],c=t[1],f=t[2],s=t[3];return e[0]=u*o+s*r+c*i-f*a,e[1]=c*o+s*a+f*r-u*i,e[2]=f*o+s*i+u*a-c*r,e[3]=s*o-u*r-c*a-f*i,u=t[4],c=t[5],f=t[6],s=t[7],e[4]=u*o+s*r+c*i-f*a,e[5]=c*o+s*a+f*r-u*i,e[6]=f*o+s*i+u*a-c*r,e[7]=s*o-u*r-c*a-f*i,e}function Sa(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=n[0],c=n[1],f=n[2],s=n[3];return e[0]=r*s+o*u+a*f-i*c,e[1]=a*s+o*c+i*u-r*f,e[2]=i*s+o*f+r*c-a*u,e[3]=o*s-r*u-a*c-i*f,u=n[4],c=n[5],f=n[6],s=n[7],e[4]=r*s+o*u+a*f-i*c,e[5]=a*s+o*c+i*u-r*f,e[6]=i*s+o*f+r*c-a*u,e[7]=o*s-r*u-a*c-i*f,e}function Ca(e,t,n,r){if(Math.abs(r)<p)return ya(e,t);var a=Math.hypot(n[0],n[1],n[2]);r*=.5;var i=Math.sin(r),o=i*n[0]/a,u=i*n[1]/a,c=i*n[2]/a,f=Math.cos(r),s=t[0],_=t[1],l=t[2],d=t[3];e[0]=s*f+d*o+_*c-l*u,e[1]=_*f+d*u+l*o-s*c,e[2]=l*f+d*c+s*u-_*o,e[3]=d*f-s*o-_*u-l*c;var m=t[4],h=t[5],y=t[6],b=t[7];return e[4]=m*f+b*o+h*c-y*u,e[5]=h*f+b*u+y*o-m*c,e[6]=y*f+b*c+m*u-h*o,e[7]=b*f-m*o-h*u-y*c,e}function Ta(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e}function Pa(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],u=n[4],c=n[5],f=n[6],s=n[7],_=t[4],l=t[5],p=t[6],d=t[7],m=n[0],h=n[1],y=n[2],b=n[3];return e[0]=r*b+o*m+a*y-i*h,e[1]=a*b+o*h+i*m-r*y,e[2]=i*b+o*y+r*h-a*m,e[3]=o*b-r*m-a*h-i*y,e[4]=r*s+o*u+a*f-i*c+_*b+d*m+l*y-p*h,e[5]=a*s+o*c+i*u-r*f+l*b+d*h+p*m-_*y,e[6]=i*s+o*f+r*c-a*u+p*b+d*y+_*h-l*m,e[7]=o*s-r*u-a*c-i*f+d*b-_*m-l*h-p*y,e}var Ia=Pa;function Ba(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e}var Fa=Jr;function ja(e,t,n,r){var a=1-r;return Fa(t,n)<0&&(r=-r),e[0]=t[0]*a+n[0]*r,e[1]=t[1]*a+n[1]*r,e[2]=t[2]*a+n[2]*r,e[3]=t[3]*a+n[3]*r,e[4]=t[4]*a+n[4]*r,e[5]=t[5]*a+n[5]*r,e[6]=t[6]*a+n[6]*r,e[7]=t[7]*a+n[7]*r,e}function Da(e,t){var n=Ga(t);return e[0]=-t[0]/n,e[1]=-t[1]/n,e[2]=-t[2]/n,e[3]=t[3]/n,e[4]=-t[4]/n,e[5]=-t[5]/n,e[6]=-t[6]/n,e[7]=t[7]/n,e}function Ra(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e}var Va=$r,qa=Va,Ga=ta,Na=Ga;function Ua(e,t){var n=Ga(t);if(n>0){n=Math.sqrt(n);var r=t[0]/n,a=t[1]/n,i=t[2]/n,o=t[3]/n,u=t[4],c=t[5],f=t[6],s=t[7],_=r*u+a*c+i*f+o*s;e[0]=r,e[1]=a,e[2]=i,e[3]=o,e[4]=(u-r*_)/n,e[5]=(c-a*_)/n,e[6]=(f-i*_)/n,e[7]=(s-o*_)/n}return e}function Wa(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function Ha(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]}function Za(e,t){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],c=e[6],f=e[7],s=t[0],_=t[1],l=t[2],d=t[3],m=t[4],h=t[5],y=t[6],b=t[7];return Math.abs(n-s)<=p*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-_)<=p*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(a-l)<=p*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(i-d)<=p*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-m)<=p*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(u-h)<=p*Math.max(1,Math.abs(u),Math.abs(h))&&Math.abs(c-y)<=p*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(f-b)<=p*Math.max(1,Math.abs(f),Math.abs(b))}function Ya(){var e=new d(2);return d!=Float32Array&&(e[0]=0,e[1]=0),e}function Xa(e){var t=new d(2);return t[0]=e[0],t[1]=e[1],t}function Ka(e,t){var n=new d(2);return n[0]=e,n[1]=t,n}function Ja(e,t){return e[0]=t[0],e[1]=t[1],e}function Qa(e,t,n){return e[0]=t,e[1]=n,e}function $a(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function ei(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function ti(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function ni(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function ri(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function ai(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function ii(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function oi(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}function ui(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function ci(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function fi(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}function si(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.hypot(n,r)}function _i(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function li(e){var t=e[0],n=e[1];return Math.hypot(t,n)}function pi(e){var t=e[0],n=e[1];return t*t+n*n}function di(e,t){return e[0]=-t[0],e[1]=-t[1],e}function mi(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function hi(e,t){var n=t[0],r=t[1],a=n*n+r*r;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e}function yi(e,t){return e[0]*t[0]+e[1]*t[1]}function bi(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e}function vi(e,t,n,r){var a=t[0],i=t[1];return e[0]=a+r*(n[0]-a),e[1]=i+r*(n[1]-i),e}function gi(e,t){t=t||1;var n=2*m()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e}function wi(e,t,n){var r=t[0],a=t[1];return e[0]=n[0]*r+n[2]*a,e[1]=n[1]*r+n[3]*a,e}function Mi(e,t,n){var r=t[0],a=t[1];return e[0]=n[0]*r+n[2]*a+n[4],e[1]=n[1]*r+n[3]*a+n[5],e}function ki(e,t,n){var r=t[0],a=t[1];return e[0]=n[0]*r+n[3]*a+n[6],e[1]=n[1]*r+n[4]*a+n[7],e}function xi(e,t,n){var r=t[0],a=t[1];return e[0]=n[0]*r+n[4]*a+n[12],e[1]=n[1]*r+n[5]*a+n[13],e}function zi(e,t,n,r){var a=t[0]-n[0],i=t[1]-n[1],o=Math.sin(r),u=Math.cos(r);return e[0]=a*u-i*o+n[0],e[1]=a*o+i*u+n[1],e}function Ai(e,t){var n=e[0],r=e[1],a=t[0],i=t[1],o=n*n+r*r;o>0&&(o=1/Math.sqrt(o));var u=a*a+i*i;u>0&&(u=1/Math.sqrt(u));var c=(n*a+r*i)*o*u;return c>1?0:c<-1?Math.PI:Math.acos(c)}function Li(e){return e[0]=0,e[1]=0,e}function Ei(e){return"vec2("+e[0]+", "+e[1]+")"}function Oi(e,t){return e[0]===t[0]&&e[1]===t[1]}function Si(e,t){var n=e[0],r=e[1],a=t[0],i=t[1];return Math.abs(n-a)<=p*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-i)<=p*Math.max(1,Math.abs(r),Math.abs(i))}var Ci=li,Ti=ei,Pi=ti,Ii=ni,Bi=si,Fi=_i,ji=pi,Di=function(){var e=Ya();return function(t,n,r,a,i,o){var u,c;for(n||(n=2),r||(r=0),c=a?Math.min(a*n+r,t.length):t.length,u=r;u<c;u+=n)e[0]=t[u],e[1]=t[u+1],i(e,e,o),t[u]=e[0],t[u+1]=e[1];return t}}()},780:function(e){var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,a="function"===typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(C){c=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var a=t&&t.prototype instanceof h?t:h,i=Object.create(a.prototype),o=new E(r||[]);return i._invoke=function(e,t,n){var r=_;return function(a,i){if(r===p)throw new Error("Generator is already running");if(r===d){if("throw"===a)throw i;return S()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var u=z(o,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===_)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var c=s(e,t,n);if("normal"===c.type){if(r=n.done?d:l,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=d,n.method="throw",n.arg=c.arg)}}}(e,n,o),i}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(C){return{type:"throw",arg:C}}}e.wrap=f;var _="suspendedStart",l="suspendedYield",p="executing",d="completed",m={};function h(){}function y(){}function b(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,w=g&&g(g(O([])));w&&w!==n&&r.call(w,i)&&(v=w);var M=b.prototype=h.prototype=Object.create(v);function k(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function n(a,i,o,u){var c=s(e[a],e,i);if("throw"!==c.type){var f=c.arg,_=f.value;return _&&"object"===typeof _&&r.call(_,"__await")?t.resolve(_.__await).then((function(e){n("next",e,o,u)}),(function(e){n("throw",e,o,u)})):t.resolve(_).then((function(e){f.value=e,o(f)}),(function(e){return n("throw",e,o,u)}))}u(c.arg)}var a;this._invoke=function(e,r){function i(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(i,i):i()}}function z(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,z(e,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a \'throw\' method")}return m}var a=s(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function O(e){if(e){var n=e[i];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:S}}function S(){return{value:t,done:!0}}return y.prototype=b,c(M,"constructor",b),c(b,"constructor",y),y.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,u,"GeneratorFunction")),e.prototype=Object.create(M),e},e.awrap=function(e){return{__await:e}},k(x.prototype),c(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new x(f(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},k(M),c(M,u,"Generator"),c(M,i,(function(){return this})),c(M,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=O,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return u.type="throw",u.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],u=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),f=r.call(o,"finallyLoc");if(c&&f){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(n){"object"===typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},301:function(e,t,n){"use strict";n.r(t),t.default="./zcv.wasm"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};!function(){"use strict";var e=n(269).default;var t=n(407),r=self;t.messageManager.onOutgoingMessage.bind((function(){var n,a=t.messageManager.getOutgoingMessages(),i=e(a);try{for(i.s();!(n=i.n()).done;){var o=n.value;r.postMessage(o.msg,o.transferables)}}catch(u){i.e(u)}finally{i.f()}}));r.addEventListener("message",(function e(a){if(a&&a.data&&"wasm"===a.data.t){var i=location.href.startsWith("blob")?a.data.url:n(301);i.default&&(i=i.default),t.launchWorkerServer(i),r.removeEventListener("message",e)}})),r.addEventListener("message",(function(e){t.messageManager.postIncomingMessage(e.data)}))}()}();\n//# sourceMappingURL=worker.ab53b058.worker.js.map',"Worker",void 0,n.p+"static/js/worker.ab53b058.worker.js")}},477:function(e){"use strict";e.exports=function(e,t,n,r){try{try{var i;try{i=new window.Blob([e])}catch(u){(i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(e),i=i.getBlob()}var a=window.URL||window.webkitURL,o=a.createObjectURL(i),s=new window[t](o,n);return a.revokeObjectURL(o),s}catch(u){return new window[t]("data:application/javascript,".concat(encodeURIComponent(e)),n)}}catch(u){if(!r)throw Error("Inline worker is not supported");return new window[t](r,n)}}},907:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},3878:function(e,t,n){"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,{Z:function(){return r}})},7326:function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return r}})},5861:function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){r(o,i,a,s,u,"next",e)}function u(e){r(o,i,a,s,u,"throw",e)}s(void 0)}))}}n.d(t,{Z:function(){return i}})},5671:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return r}})},5647:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(9611),i=n(8814);function a(e,t,n){return a=(0,i.Z)()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return n&&(0,r.Z)(a,n.prototype),a},a.apply(null,arguments)}},3144:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}n.d(t,{Z:function(){return i}})},7762:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(181);function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,r.Z)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}},9388:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(1120),i=n(8814),a=n(6215);function o(e){var t=(0,i.Z)();return function(){var n,i=(0,r.Z)(e);if(t){var o=(0,r.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}},4942:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:function(){return r}})},7462:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}n.d(t,{Z:function(){return r}})},1752:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(1120);function i(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,r.Z)(e)););return e}function a(){return a="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=i(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},a.apply(this,arguments)}},1120:function(e,t,n){"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{Z:function(){return r}})},136:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9611);function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.Z)(e,t)}},8814:function(e,t,n){"use strict";function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}n.d(t,{Z:function(){return r}})},9199:function(e,t,n){"use strict";function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{Z:function(){return r}})},5267:function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{Z:function(){return r}})},1413:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(4942);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},4925:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}n.d(t,{Z:function(){return r}})},6215:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:function(){return a}});var i=n(7326);function a(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(e)}},9611:function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{Z:function(){return r}})},9439:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(3878);var i=n(181),a=n(5267);function o(e,t){return(0,r.Z)(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}}(e,t)||(0,i.Z)(e,t)||(0,a.Z)()}},3433:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(907);var i=n(9199),a=n(181);function o(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||(0,i.Z)(e)||(0,a.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},181:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(907);function i(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}},4580:function(e){"use strict";e.exports=JSON.parse('[["#69d2e7","#a7dbd8","#e0e4cc","#f38630","#fa6900"],["#fe4365","#fc9d9a","#f9cdad","#c8c8a9","#83af9b"],["#ecd078","#d95b43","#c02942","#542437","#53777a"],["#556270","#4ecdc4","#c7f464","#ff6b6b","#c44d58"],["#774f38","#e08e79","#f1d4af","#ece5ce","#c5e0dc"],["#e8ddcb","#cdb380","#036564","#033649","#031634"],["#490a3d","#bd1550","#e97f02","#f8ca00","#8a9b0f"],["#594f4f","#547980","#45ada8","#9de0ad","#e5fcc2"],["#00a0b0","#6a4a3c","#cc333f","#eb6841","#edc951"],["#e94e77","#d68189","#c6a49a","#c6e5d9","#f4ead5"],["#3fb8af","#7fc7af","#dad8a7","#ff9e9d","#ff3d7f"],["#d9ceb2","#948c75","#d5ded9","#7a6a53","#99b2b7"],["#ffffff","#cbe86b","#f2e9e1","#1c140d","#cbe86b"],["#efffcd","#dce9be","#555152","#2e2633","#99173c"],["#343838","#005f6b","#008c9e","#00b4cc","#00dffc"],["#413e4a","#73626e","#b38184","#f0b49e","#f7e4be"],["#ff4e50","#fc913a","#f9d423","#ede574","#e1f5c4"],["#99b898","#fecea8","#ff847c","#e84a5f","#2a363b"],["#655643","#80bca3","#f6f7bd","#e6ac27","#bf4d28"],["#00a8c6","#40c0cb","#f9f2e7","#aee239","#8fbe00"],["#351330","#424254","#64908a","#e8caa4","#cc2a41"],["#554236","#f77825","#d3ce3d","#f1efa5","#60b99a"],["#5d4157","#838689","#a8caba","#cad7b2","#ebe3aa"],["#8c2318","#5e8c6a","#88a65e","#bfb35a","#f2c45a"],["#fad089","#ff9c5b","#f5634a","#ed303c","#3b8183"],["#ff4242","#f4fad2","#d4ee5e","#e1edb9","#f0f2eb"],["#f8b195","#f67280","#c06c84","#6c5b7b","#355c7d"],["#d1e751","#ffffff","#000000","#4dbce9","#26ade4"],["#1b676b","#519548","#88c425","#bef202","#eafde6"],["#5e412f","#fcebb6","#78c0a8","#f07818","#f0a830"],["#bcbdac","#cfbe27","#f27435","#f02475","#3b2d38"],["#452632","#91204d","#e4844a","#e8bf56","#e2f7ce"],["#eee6ab","#c5bc8e","#696758","#45484b","#36393b"],["#f0d8a8","#3d1c00","#86b8b1","#f2d694","#fa2a00"],["#2a044a","#0b2e59","#0d6759","#7ab317","#a0c55f"],["#f04155","#ff823a","#f2f26f","#fff7bd","#95cfb7"],["#b9d7d9","#668284","#2a2829","#493736","#7b3b3b"],["#bbbb88","#ccc68d","#eedd99","#eec290","#eeaa88"],["#b3cc57","#ecf081","#ffbe40","#ef746f","#ab3e5b"],["#a3a948","#edb92e","#f85931","#ce1836","#009989"],["#300030","#480048","#601848","#c04848","#f07241"],["#67917a","#170409","#b8af03","#ccbf82","#e33258"],["#aab3ab","#c4cbb7","#ebefc9","#eee0b7","#e8caaf"],["#e8d5b7","#0e2430","#fc3a51","#f5b349","#e8d5b9"],["#ab526b","#bca297","#c5ceae","#f0e2a4","#f4ebc3"],["#607848","#789048","#c0d860","#f0f0d8","#604848"],["#b6d8c0","#c8d9bf","#dadabd","#ecdbbc","#fedcba"],["#a8e6ce","#dcedc2","#ffd3b5","#ffaaa6","#ff8c94"],["#3e4147","#fffedf","#dfba69","#5a2e2e","#2a2c31"],["#fc354c","#29221f","#13747d","#0abfbc","#fcf7c5"],["#cc0c39","#e6781e","#c8cf02","#f8fcc1","#1693a7"],["#1c2130","#028f76","#b3e099","#ffeaad","#d14334"],["#a7c5bd","#e5ddcb","#eb7b59","#cf4647","#524656"],["#dad6ca","#1bb0ce","#4f8699","#6a5e72","#563444"],["#5c323e","#a82743","#e15e32","#c0d23e","#e5f04c"],["#edebe6","#d6e1c7","#94c7b6","#403b33","#d3643b"],["#fdf1cc","#c6d6b8","#987f69","#e3ad40","#fcd036"],["#230f2b","#f21d41","#ebebbc","#bce3c5","#82b3ae"],["#b9d3b0","#81bda4","#b28774","#f88f79","#f6aa93"],["#3a111c","#574951","#83988e","#bcdea5","#e6f9bc"],["#5e3929","#cd8c52","#b7d1a3","#dee8be","#fcf7d3"],["#1c0113","#6b0103","#a30006","#c21a01","#f03c02"],["#000000","#9f111b","#b11623","#292c37","#cccccc"],["#382f32","#ffeaf2","#fcd9e5","#fbc5d8","#f1396d"],["#e3dfba","#c8d6bf","#93ccc6","#6cbdb5","#1a1f1e"],["#f6f6f6","#e8e8e8","#333333","#990100","#b90504"],["#1b325f","#9cc4e4","#e9f2f9","#3a89c9","#f26c4f"],["#a1dbb2","#fee5ad","#faca66","#f7a541","#f45d4c"],["#c1b398","#605951","#fbeec2","#61a6ab","#accec0"],["#5e9fa3","#dcd1b4","#fab87f","#f87e7b","#b05574"],["#951f2b","#f5f4d7","#e0dfb1","#a5a36c","#535233"],["#8dccad","#988864","#fea6a2","#f9d6ac","#ffe9af"],["#2d2d29","#215a6d","#3ca2a2","#92c7a3","#dfece6"],["#413d3d","#040004","#c8ff00","#fa023c","#4b000f"],["#eff3cd","#b2d5ba","#61ada0","#248f8d","#605063"],["#ffefd3","#fffee4","#d0ecea","#9fd6d2","#8b7a5e"],["#cfffdd","#b4dec1","#5c5863","#a85163","#ff1f4c"],["#9dc9ac","#fffec7","#f56218","#ff9d2e","#919167"],["#4e395d","#827085","#8ebe94","#ccfc8e","#dc5b3e"],["#a8a7a7","#cc527a","#e8175d","#474747","#363636"],["#f8edd1","#d88a8a","#474843","#9d9d93","#c5cfc6"],["#046d8b","#309292","#2fb8ac","#93a42a","#ecbe13"],["#f38a8a","#55443d","#a0cab5","#cde9ca","#f1edd0"],["#a70267","#f10c49","#fb6b41","#f6d86b","#339194"],["#ff003c","#ff8a00","#fabe28","#88c100","#00c176"],["#ffedbf","#f7803c","#f54828","#2e0d23","#f8e4c1"],["#4e4d4a","#353432","#94ba65","#2790b0","#2b4e72"],["#0ca5b0","#4e3f30","#fefeeb","#f8f4e4","#a5b3aa"],["#4d3b3b","#de6262","#ffb88c","#ffd0b3","#f5e0d3"],["#fffbb7","#a6f6af","#66b6ab","#5b7c8d","#4f2958"],["#edf6ee","#d1c089","#b3204d","#412e28","#151101"],["#9d7e79","#ccac95","#9a947c","#748b83","#5b756c"],["#fcfef5","#e9ffe1","#cdcfb7","#d6e6c3","#fafbe3"],["#9cddc8","#bfd8ad","#ddd9ab","#f7af63","#633d2e"],["#30261c","#403831","#36544f","#1f5f61","#0b8185"],["#aaff00","#ffaa00","#ff00aa","#aa00ff","#00aaff"],["#d1313d","#e5625c","#f9bf76","#8eb2c5","#615375"],["#ffe181","#eee9e5","#fad3b2","#ffba7f","#ff9c97"],["#73c8a9","#dee1b6","#e1b866","#bd5532","#373b44"],["#805841","#dcf7f3","#fffcdd","#ffd8d8","#f5a2a2"]]')}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=e,n.amdO={},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".f3f902c2.chunk.js"},n.miniCssF=function(e){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="cra:";n.l=function(r,i,a,o){if(e[r])e[r].push(i);else{var s,u;if(void 0!==a)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var g=l[c];if(g.getAttribute("src")==r||g.getAttribute("data-webpack")==t+a){s=g;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+a),s.src=r),e[r]=[i];var d=function(t,n){s.onerror=s.onload=null,clearTimeout(I);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(e){return e(n)})),t)return t(n)},I=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.p="./",function(){var e={179:0};n.f.j=function(t,r){var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var a=new Promise((function(n,r){i=e[t]=[n,r]}));r.push(i[2]=a);var o=n.p+n.u(t),s=new Error;n.l(o,(function(r){if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,i[1](s)}}),"chunk-"+t,t)}};var t=function(t,r){var i,a,o=r[0],s=r[1],u=r[2],l=0;if(o.some((function(t){return 0!==e[t]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(u)u(n)}for(t&&t(r);l<o.length;l++)a=o[l],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkcra=self.webpackChunkcra||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),function(){"use strict";var e=n(4519),t=n(4453),r=n(1413),i=n(9439),a=n(4911),o=n(5112),s=n(4925),u=n(3433),l=n(136),c=n(9388),g=n(5671),d=n(3144),I=["onCollide","onCollideBegin","onCollideEnd"],C=(0,e.createContext)({}),h=(0,e.createContext)(null);function f(e,t,n){var r=void 0===t?null:t,i=function(e,t){var n=atob(e);if(t){for(var r=new Uint8Array(n.length),i=0,a=n.length;i<a;++i)r[i]=n.charCodeAt(i);return String.fromCharCode.apply(null,new Uint16Array(r.buffer))}return n}(e,void 0!==n&&n),a=i.indexOf("\n",10)+1,o=i.substring(a)+(r?"//# sourceMappingURL="+r:""),s=new Blob([o],{type:"application/javascript"});return URL.createObjectURL(s)}var p=function(e,t,n){var r;return function(i){return r=r||f(e,t,n),new Worker(r,i)}}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyoqCiAgICogUmVjb3JkcyB3aGF0IG9iamVjdHMgYXJlIGNvbGxpZGluZyB3aXRoIGVhY2ggb3RoZXIKICAgKi8KICAvKioKICAgKiBBIDN4MyBtYXRyaXguCiAgICogQXV0aG9yZWQgYnkge0BsaW5rIGh0dHA6Ly9naXRodWIuY29tL3NjaHRlcHBlLyBzY2h0ZXBwZX0KICAgKi8KCgogIGNsYXNzIE1hdDMgewogICAgLyoqCiAgICAgKiBBIHZlY3RvciBvZiBsZW5ndGggOSwgY29udGFpbmluZyBhbGwgbWF0cml4IGVsZW1lbnRzLgogICAgICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gZWxlbWVudHMgQSB2ZWN0b3Igb2YgbGVuZ3RoIDksIGNvbnRhaW5pbmcgYWxsIG1hdHJpeCBlbGVtZW50cy4KICAgICAqLwogICAgY29uc3RydWN0b3IoZWxlbWVudHMgPSBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0pIHsKICAgICAgdGhpcy5lbGVtZW50cyA9IHZvaWQgMDsKICAgICAgdGhpcy5lbGVtZW50cyA9IGVsZW1lbnRzOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBtYXRyaXggdG8gaWRlbnRpdHkKICAgICAqIEB0b2RvIFNob3VsZCBwZXJoYXBzIGJlIHJlbmFtZWQgdG8gYHNldElkZW50aXR5KClgIHRvIGJlIG1vcmUgY2xlYXIuCiAgICAgKiBAdG9kbyBDcmVhdGUgYW5vdGhlciBmdW5jdGlvbiB0aGF0IGltbWVkaWF0ZWx5IGNyZWF0ZXMgYW4gaWRlbnRpdHkgbWF0cml4IGVnLiBgZXllKClgCiAgICAgKi8KCgogICAgaWRlbnRpdHkoKSB7CiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBlWzBdID0gMTsKICAgICAgZVsxXSA9IDA7CiAgICAgIGVbMl0gPSAwOwogICAgICBlWzNdID0gMDsKICAgICAgZVs0XSA9IDE7CiAgICAgIGVbNV0gPSAwOwogICAgICBlWzZdID0gMDsKICAgICAgZVs3XSA9IDA7CiAgICAgIGVbOF0gPSAxOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgYWxsIGVsZW1lbnRzIHRvIHplcm8KICAgICAqLwoKCiAgICBzZXRaZXJvKCkgewogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgZVswXSA9IDA7CiAgICAgIGVbMV0gPSAwOwogICAgICBlWzJdID0gMDsKICAgICAgZVszXSA9IDA7CiAgICAgIGVbNF0gPSAwOwogICAgICBlWzVdID0gMDsKICAgICAgZVs2XSA9IDA7CiAgICAgIGVbN10gPSAwOwogICAgICBlWzhdID0gMDsKICAgIH0KICAgIC8qKgogICAgICogU2V0cyB0aGUgbWF0cml4IGRpYWdvbmFsIGVsZW1lbnRzIGZyb20gYSBWZWMzCiAgICAgKi8KCgogICAgc2V0VHJhY2UodmVjdG9yKSB7CiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBlWzBdID0gdmVjdG9yLng7CiAgICAgIGVbNF0gPSB2ZWN0b3IueTsKICAgICAgZVs4XSA9IHZlY3Rvci56OwogICAgfQogICAgLyoqCiAgICAgKiBHZXRzIHRoZSBtYXRyaXggZGlhZ29uYWwgZWxlbWVudHMKICAgICAqLwoKCiAgICBnZXRUcmFjZSh0YXJnZXQgPSBuZXcgVmVjMygpKSB7CiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICB0YXJnZXQueCA9IGVbMF07CiAgICAgIHRhcmdldC55ID0gZVs0XTsKICAgICAgdGFyZ2V0LnogPSBlWzhdOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBNYXRyaXgtVmVjdG9yIG11bHRpcGxpY2F0aW9uCiAgICAgKiBAcGFyYW0gdiBUaGUgdmVjdG9yIHRvIG11bHRpcGx5IHdpdGgKICAgICAqIEBwYXJhbSB0YXJnZXQgT3B0aW9uYWwsIHRhcmdldCB0byBzYXZlIHRoZSByZXN1bHQgaW4uCiAgICAgKi8KCgogICAgdm11bHQodiwgdGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgY29uc3QgeCA9IHYueDsKICAgICAgY29uc3QgeSA9IHYueTsKICAgICAgY29uc3QgeiA9IHYuejsKICAgICAgdGFyZ2V0LnggPSBlWzBdICogeCArIGVbMV0gKiB5ICsgZVsyXSAqIHo7CiAgICAgIHRhcmdldC55ID0gZVszXSAqIHggKyBlWzRdICogeSArIGVbNV0gKiB6OwogICAgICB0YXJnZXQueiA9IGVbNl0gKiB4ICsgZVs3XSAqIHkgKyBlWzhdICogejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTWF0cml4LXNjYWxhciBtdWx0aXBsaWNhdGlvbgogICAgICovCgoKICAgIHNtdWx0KHMpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSAqPSBzOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIE1hdHJpeCBtdWx0aXBsaWNhdGlvbgogICAgICogQHBhcmFtIG1hdHJpeCBNYXRyaXggdG8gbXVsdGlwbHkgd2l0aCBmcm9tIGxlZnQgc2lkZS4KICAgICAqLwoKCiAgICBtbXVsdChtYXRyaXgsIHRhcmdldCA9IG5ldyBNYXQzKCkpIHsKICAgICAgY29uc3QgQSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGNvbnN0IEIgPSBtYXRyaXguZWxlbWVudHM7CiAgICAgIGNvbnN0IFQgPSB0YXJnZXQuZWxlbWVudHM7CiAgICAgIGNvbnN0IGExMSA9IEFbMF0sCiAgICAgICAgICAgIGExMiA9IEFbMV0sCiAgICAgICAgICAgIGExMyA9IEFbMl0sCiAgICAgICAgICAgIGEyMSA9IEFbM10sCiAgICAgICAgICAgIGEyMiA9IEFbNF0sCiAgICAgICAgICAgIGEyMyA9IEFbNV0sCiAgICAgICAgICAgIGEzMSA9IEFbNl0sCiAgICAgICAgICAgIGEzMiA9IEFbN10sCiAgICAgICAgICAgIGEzMyA9IEFbOF07CiAgICAgIGNvbnN0IGIxMSA9IEJbMF0sCiAgICAgICAgICAgIGIxMiA9IEJbMV0sCiAgICAgICAgICAgIGIxMyA9IEJbMl0sCiAgICAgICAgICAgIGIyMSA9IEJbM10sCiAgICAgICAgICAgIGIyMiA9IEJbNF0sCiAgICAgICAgICAgIGIyMyA9IEJbNV0sCiAgICAgICAgICAgIGIzMSA9IEJbNl0sCiAgICAgICAgICAgIGIzMiA9IEJbN10sCiAgICAgICAgICAgIGIzMyA9IEJbOF07CiAgICAgIFRbMF0gPSBhMTEgKiBiMTEgKyBhMTIgKiBiMjEgKyBhMTMgKiBiMzE7CiAgICAgIFRbMV0gPSBhMTEgKiBiMTIgKyBhMTIgKiBiMjIgKyBhMTMgKiBiMzI7CiAgICAgIFRbMl0gPSBhMTEgKiBiMTMgKyBhMTIgKiBiMjMgKyBhMTMgKiBiMzM7CiAgICAgIFRbM10gPSBhMjEgKiBiMTEgKyBhMjIgKiBiMjEgKyBhMjMgKiBiMzE7CiAgICAgIFRbNF0gPSBhMjEgKiBiMTIgKyBhMjIgKiBiMjIgKyBhMjMgKiBiMzI7CiAgICAgIFRbNV0gPSBhMjEgKiBiMTMgKyBhMjIgKiBiMjMgKyBhMjMgKiBiMzM7CiAgICAgIFRbNl0gPSBhMzEgKiBiMTEgKyBhMzIgKiBiMjEgKyBhMzMgKiBiMzE7CiAgICAgIFRbN10gPSBhMzEgKiBiMTIgKyBhMzIgKiBiMjIgKyBhMzMgKiBiMzI7CiAgICAgIFRbOF0gPSBhMzEgKiBiMTMgKyBhMzIgKiBiMjMgKyBhMzMgKiBiMzM7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIFNjYWxlIGVhY2ggY29sdW1uIG9mIHRoZSBtYXRyaXgKICAgICAqLwoKCiAgICBzY2FsZSh2ZWN0b3IsIHRhcmdldCA9IG5ldyBNYXQzKCkpIHsKICAgICAgY29uc3QgZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGNvbnN0IHQgPSB0YXJnZXQuZWxlbWVudHM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gMzsgaSsrKSB7CiAgICAgICAgdFszICogaSArIDBdID0gdmVjdG9yLnggKiBlWzMgKiBpICsgMF07CiAgICAgICAgdFszICogaSArIDFdID0gdmVjdG9yLnkgKiBlWzMgKiBpICsgMV07CiAgICAgICAgdFszICogaSArIDJdID0gdmVjdG9yLnogKiBlWzMgKiBpICsgMl07CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIFNvbHZlIEF4PWIKICAgICAqIEBwYXJhbSBiIFRoZSByaWdodCBoYW5kIHNpZGUKICAgICAqIEBwYXJhbSB0YXJnZXQgT3B0aW9uYWwuIFRhcmdldCB2ZWN0b3IgdG8gc2F2ZSBpbi4KICAgICAqIEByZXR1cm4gVGhlIHNvbHV0aW9uIHgKICAgICAqIEB0b2RvIHNob3VsZCByZXVzZSBhcnJheXMKICAgICAqLwoKCiAgICBzb2x2ZShiLCB0YXJnZXQgPSBuZXcgVmVjMygpKSB7CiAgICAgIC8vIENvbnN0cnVjdCBlcXVhdGlvbnMKICAgICAgY29uc3QgbnIgPSAzOyAvLyBudW0gcm93cwoKICAgICAgY29uc3QgbmMgPSA0OyAvLyBudW0gY29scwoKICAgICAgY29uc3QgZXFucyA9IFtdOwogICAgICBsZXQgaTsKICAgICAgbGV0IGo7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbnIgKiBuYzsgaSsrKSB7CiAgICAgICAgZXFucy5wdXNoKDApOwogICAgICB9CgogICAgICBmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7CiAgICAgICAgZm9yIChqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgZXFuc1tpICsgbmMgKiBqXSA9IHRoaXMuZWxlbWVudHNbaSArIDMgKiBqXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGVxbnNbMyArIDQgKiAwXSA9IGIueDsKICAgICAgZXFuc1szICsgNCAqIDFdID0gYi55OwogICAgICBlcW5zWzMgKyA0ICogMl0gPSBiLno7IC8vIENvbXB1dGUgcmlnaHQgdXBwZXIgdHJpYW5ndWxhciB2ZXJzaW9uIG9mIHRoZSBtYXRyaXggLSBHYXVzcyBlbGltaW5hdGlvbgoKICAgICAgbGV0IG4gPSAzOwogICAgICBjb25zdCBrID0gbjsKICAgICAgbGV0IG5wOwogICAgICBjb25zdCBrcCA9IDQ7IC8vIG51bSByb3dzCgogICAgICBsZXQgcDsKCiAgICAgIGRvIHsKICAgICAgICBpID0gayAtIG47CgogICAgICAgIGlmIChlcW5zW2kgKyBuYyAqIGldID09PSAwKSB7CiAgICAgICAgICAvLyB0aGUgcGl2b3QgaXMgbnVsbCwgc3dhcCBsaW5lcwogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgaWYgKGVxbnNbaSArIG5jICogal0gIT09IDApIHsKICAgICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAvLyBkbyBsaWduZSggaSApID0gbGlnbmUoIGkgKSArIGxpZ25lKCBrICkKICAgICAgICAgICAgICAgIHAgPSBrcCAtIG5wOwogICAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBpXSArPSBlcW5zW3AgKyBuYyAqIGpdOwogICAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gIT09IDApIHsKICAgICAgICAgIGZvciAoaiA9IGkgKyAxOyBqIDwgazsgaisrKSB7CiAgICAgICAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSBlcW5zW2kgKyBuYyAqIGpdIC8gZXFuc1tpICsgbmMgKiBpXTsKICAgICAgICAgICAgbnAgPSBrcDsKCiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAvLyBkbyBsaWduZSggayApID0gbGlnbmUoIGsgKSAtIG11bHRpcGxpZXIgKiBsaWduZSggaSApCiAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBqXSA9IHAgPD0gaSA/IDAgOiBlcW5zW3AgKyBuYyAqIGpdIC0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSB3aGlsZSAoLS1uKTsgLy8gR2V0IHRoZSBzb2x1dGlvbgoKCiAgICAgIHRhcmdldC56ID0gZXFuc1syICogbmMgKyAzXSAvIGVxbnNbMiAqIG5jICsgMl07CiAgICAgIHRhcmdldC55ID0gKGVxbnNbMSAqIG5jICsgM10gLSBlcW5zWzEgKiBuYyArIDJdICogdGFyZ2V0LnopIC8gZXFuc1sxICogbmMgKyAxXTsKICAgICAgdGFyZ2V0LnggPSAoZXFuc1swICogbmMgKyAzXSAtIGVxbnNbMCAqIG5jICsgMl0gKiB0YXJnZXQueiAtIGVxbnNbMCAqIG5jICsgMV0gKiB0YXJnZXQueSkgLyBlcW5zWzAgKiBuYyArIDBdOwoKICAgICAgaWYgKGlzTmFOKHRhcmdldC54KSB8fCBpc05hTih0YXJnZXQueSkgfHwgaXNOYU4odGFyZ2V0LnopIHx8IHRhcmdldC54ID09PSBJbmZpbml0eSB8fCB0YXJnZXQueSA9PT0gSW5maW5pdHkgfHwgdGFyZ2V0LnogPT09IEluZmluaXR5KSB7CiAgICAgICAgdGhyb3cgIkNvdWxkIG5vdCBzb2x2ZSBlcXVhdGlvbiEgR290IHg9WyIgKyB0YXJnZXQudG9TdHJpbmcoKSArICJdLCBiPVsiICsgYi50b1N0cmluZygpICsgIl0sIEE9WyIgKyB0aGlzLnRvU3RyaW5nKCkgKyAiXSI7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlbGVtZW50IGluIHRoZSBtYXRyaXggYnkgaW5kZXguIEluZGV4IHN0YXJ0cyBhdCAwLCBub3QgMSEhIQogICAgICogQHBhcmFtIHZhbHVlIElmIHByb3ZpZGVkLCB0aGUgbWF0cml4IGVsZW1lbnQgd2lsbCBiZSBzZXQgdG8gdGhpcyB2YWx1ZS4KICAgICAqLwoKCiAgICBlKHJvdywgY29sdW1uLCB2YWx1ZSkgewogICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzW2NvbHVtbiArIDMgKiByb3ddOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFNldCB2YWx1ZQogICAgICAgIHRoaXMuZWxlbWVudHNbY29sdW1uICsgMyAqIHJvd10gPSB2YWx1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb3B5IGFub3RoZXIgbWF0cml4IGludG8gdGhpcyBtYXRyaXggb2JqZWN0LgogICAgICovCgoKICAgIGNvcHkobWF0cml4KSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWF0cml4LmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSA9IG1hdHJpeC5lbGVtZW50c1tpXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIG1hdHJpeC4KICAgICAqLwoKCiAgICB0b1N0cmluZygpIHsKICAgICAgbGV0IHIgPSAnJzsKICAgICAgY29uc3Qgc2VwID0gJywnOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspIHsKICAgICAgICByICs9IHRoaXMuZWxlbWVudHNbaV0gKyBzZXA7CiAgICAgIH0KCiAgICAgIHJldHVybiByOwogICAgfQogICAgLyoqCiAgICAgKiByZXZlcnNlIHRoZSBtYXRyaXgKICAgICAqIEBwYXJhbSB0YXJnZXQgVGFyZ2V0IG1hdHJpeCB0byBzYXZlIGluLgogICAgICogQHJldHVybiBUaGUgc29sdXRpb24geAogICAgICovCgoKICAgIHJldmVyc2UodGFyZ2V0ID0gbmV3IE1hdDMoKSkgewogICAgICAvLyBDb25zdHJ1Y3QgZXF1YXRpb25zCiAgICAgIGNvbnN0IG5yID0gMzsgLy8gbnVtIHJvd3MKCiAgICAgIGNvbnN0IG5jID0gNjsgLy8gbnVtIGNvbHMKCiAgICAgIGNvbnN0IGVxbnMgPSByZXZlcnNlX2VxbnM7CiAgICAgIGxldCBpOwogICAgICBsZXQgajsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHsKICAgICAgICBmb3IgKGogPSAwOyBqIDwgMzsgaisrKSB7CiAgICAgICAgICBlcW5zW2kgKyBuYyAqIGpdID0gdGhpcy5lbGVtZW50c1tpICsgMyAqIGpdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZXFuc1szICsgNiAqIDBdID0gMTsKICAgICAgZXFuc1szICsgNiAqIDFdID0gMDsKICAgICAgZXFuc1szICsgNiAqIDJdID0gMDsKICAgICAgZXFuc1s0ICsgNiAqIDBdID0gMDsKICAgICAgZXFuc1s0ICsgNiAqIDFdID0gMTsKICAgICAgZXFuc1s0ICsgNiAqIDJdID0gMDsKICAgICAgZXFuc1s1ICsgNiAqIDBdID0gMDsKICAgICAgZXFuc1s1ICsgNiAqIDFdID0gMDsKICAgICAgZXFuc1s1ICsgNiAqIDJdID0gMTsgLy8gQ29tcHV0ZSByaWdodCB1cHBlciB0cmlhbmd1bGFyIHZlcnNpb24gb2YgdGhlIG1hdHJpeCAtIEdhdXNzIGVsaW1pbmF0aW9uCgogICAgICBsZXQgbiA9IDM7CiAgICAgIGNvbnN0IGsgPSBuOwogICAgICBsZXQgbnA7CiAgICAgIGNvbnN0IGtwID0gbmM7IC8vIG51bSByb3dzCgogICAgICBsZXQgcDsKCiAgICAgIGRvIHsKICAgICAgICBpID0gayAtIG47CgogICAgICAgIGlmIChlcW5zW2kgKyBuYyAqIGldID09PSAwKSB7CiAgICAgICAgICAvLyB0aGUgcGl2b3QgaXMgbnVsbCwgc3dhcCBsaW5lcwogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgaWYgKGVxbnNbaSArIG5jICogal0gIT09IDApIHsKICAgICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAvLyBkbyBsaW5lKCBpICkgPSBsaW5lKCBpICkgKyBsaW5lKCBrICkKICAgICAgICAgICAgICAgIHAgPSBrcCAtIG5wOwogICAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBpXSArPSBlcW5zW3AgKyBuYyAqIGpdOwogICAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gIT09IDApIHsKICAgICAgICAgIGZvciAoaiA9IGkgKyAxOyBqIDwgazsgaisrKSB7CiAgICAgICAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSBlcW5zW2kgKyBuYyAqIGpdIC8gZXFuc1tpICsgbmMgKiBpXTsKICAgICAgICAgICAgbnAgPSBrcDsKCiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAvLyBkbyBsaW5lKCBrICkgPSBsaW5lKCBrICkgLSBtdWx0aXBsaWVyICogbGluZSggaSApCiAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBqXSA9IHAgPD0gaSA/IDAgOiBlcW5zW3AgKyBuYyAqIGpdIC0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSB3aGlsZSAoLS1uKTsgLy8gZWxpbWluYXRlIHRoZSB1cHBlciBsZWZ0IHRyaWFuZ2xlIG9mIHRoZSBtYXRyaXgKCgogICAgICBpID0gMjsKCiAgICAgIGRvIHsKICAgICAgICBqID0gaSAtIDE7CgogICAgICAgIGRvIHsKICAgICAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSBlcW5zW2kgKyBuYyAqIGpdIC8gZXFuc1tpICsgbmMgKiBpXTsKICAgICAgICAgIG5wID0gbmM7CgogICAgICAgICAgZG8gewogICAgICAgICAgICBwID0gbmMgLSBucDsKICAgICAgICAgICAgZXFuc1twICsgbmMgKiBqXSA9IGVxbnNbcCArIG5jICogal0gLSBlcW5zW3AgKyBuYyAqIGldICogbXVsdGlwbGllcjsKICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwogICAgICAgIH0gd2hpbGUgKGotLSk7CiAgICAgIH0gd2hpbGUgKC0taSk7IC8vIG9wZXJhdGlvbnMgb24gdGhlIGRpYWdvbmFsCgoKICAgICAgaSA9IDI7CgogICAgICBkbyB7CiAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IDEgLyBlcW5zW2kgKyBuYyAqIGldOwogICAgICAgIG5wID0gbmM7CgogICAgICAgIGRvIHsKICAgICAgICAgIHAgPSBuYyAtIG5wOwogICAgICAgICAgZXFuc1twICsgbmMgKiBpXSA9IGVxbnNbcCArIG5jICogaV0gKiBtdWx0aXBsaWVyOwogICAgICAgIH0gd2hpbGUgKC0tbnApOwogICAgICB9IHdoaWxlIChpLS0pOwoKICAgICAgaSA9IDI7CgogICAgICBkbyB7CiAgICAgICAgaiA9IDI7CgogICAgICAgIGRvIHsKICAgICAgICAgIHAgPSBlcW5zW25yICsgaiArIG5jICogaV07CgogICAgICAgICAgaWYgKGlzTmFOKHApIHx8IHAgPT09IEluZmluaXR5KSB7CiAgICAgICAgICAgIHRocm93ICJDb3VsZCBub3QgcmV2ZXJzZSEgQT1bIiArIHRoaXMudG9TdHJpbmcoKSArICJdIjsKICAgICAgICAgIH0KCiAgICAgICAgICB0YXJnZXQuZShpLCBqLCBwKTsKICAgICAgICB9IHdoaWxlIChqLS0pOwogICAgICB9IHdoaWxlIChpLS0pOwoKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBtYXRyaXggZnJvbSBhIHF1YXRlcmlvbgogICAgICovCgoKICAgIHNldFJvdGF0aW9uRnJvbVF1YXRlcm5pb24ocSkgewogICAgICBjb25zdCB4ID0gcS54OwogICAgICBjb25zdCB5ID0gcS55OwogICAgICBjb25zdCB6ID0gcS56OwogICAgICBjb25zdCB3ID0gcS53OwogICAgICBjb25zdCB4MiA9IHggKyB4OwogICAgICBjb25zdCB5MiA9IHkgKyB5OwogICAgICBjb25zdCB6MiA9IHogKyB6OwogICAgICBjb25zdCB4eCA9IHggKiB4MjsKICAgICAgY29uc3QgeHkgPSB4ICogeTI7CiAgICAgIGNvbnN0IHh6ID0geCAqIHoyOwogICAgICBjb25zdCB5eSA9IHkgKiB5MjsKICAgICAgY29uc3QgeXogPSB5ICogejI7CiAgICAgIGNvbnN0IHp6ID0geiAqIHoyOwogICAgICBjb25zdCB3eCA9IHcgKiB4MjsKICAgICAgY29uc3Qgd3kgPSB3ICogeTI7CiAgICAgIGNvbnN0IHd6ID0gdyAqIHoyOwogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgZVszICogMCArIDBdID0gMSAtICh5eSArIHp6KTsKICAgICAgZVszICogMCArIDFdID0geHkgLSB3ejsKICAgICAgZVszICogMCArIDJdID0geHogKyB3eTsKICAgICAgZVszICogMSArIDBdID0geHkgKyB3ejsKICAgICAgZVszICogMSArIDFdID0gMSAtICh4eCArIHp6KTsKICAgICAgZVszICogMSArIDJdID0geXogLSB3eDsKICAgICAgZVszICogMiArIDBdID0geHogLSB3eTsKICAgICAgZVszICogMiArIDFdID0geXogKyB3eDsKICAgICAgZVszICogMiArIDJdID0gMSAtICh4eCArIHl5KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFRyYW5zcG9zZSB0aGUgbWF0cml4CiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLiBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0LgogICAgICogQHJldHVybiBUaGUgdGFyZ2V0IE1hdDMsIG9yIGEgbmV3IE1hdDMgaWYgdGFyZ2V0IHdhcyBvbWl0dGVkLgogICAgICovCgoKICAgIHRyYW5zcG9zZSh0YXJnZXQgPSBuZXcgTWF0MygpKSB7CiAgICAgIGNvbnN0IE0gPSB0aGlzLmVsZW1lbnRzOwogICAgICBjb25zdCBUID0gdGFyZ2V0LmVsZW1lbnRzOwogICAgICBsZXQgdG1wOyAvL1NldCBkaWFnb25hbHMKCiAgICAgIFRbMF0gPSBNWzBdOwogICAgICBUWzRdID0gTVs0XTsKICAgICAgVFs4XSA9IE1bOF07CiAgICAgIHRtcCA9IE1bMV07CiAgICAgIFRbMV0gPSBNWzNdOwogICAgICBUWzNdID0gdG1wOwogICAgICB0bXAgPSBNWzJdOwogICAgICBUWzJdID0gTVs2XTsKICAgICAgVFs2XSA9IHRtcDsKICAgICAgdG1wID0gTVs1XTsKICAgICAgVFs1XSA9IE1bN107CiAgICAgIFRbN10gPSB0bXA7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CgogIH0KCiAgY29uc3QgcmV2ZXJzZV9lcW5zID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdOwogIC8qKgogICAqIDMtZGltZW5zaW9uYWwgdmVjdG9yCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgdiA9IG5ldyBWZWMzKDEsIDIsIDMpCiAgICogICAgIGNvbnNvbGUubG9nKCd4PScgKyB2LngpIC8vIHg9MQogICAqLwoKICBjbGFzcyBWZWMzIHsKICAgIGNvbnN0cnVjdG9yKHggPSAwLjAsIHkgPSAwLjAsIHogPSAwLjApIHsKICAgICAgdGhpcy54ID0gdm9pZCAwOwogICAgICB0aGlzLnkgPSB2b2lkIDA7CiAgICAgIHRoaXMueiA9IHZvaWQgMDsKICAgICAgdGhpcy54ID0geDsKICAgICAgdGhpcy55ID0geTsKICAgICAgdGhpcy56ID0gejsKICAgIH0KICAgIC8qKgogICAgICogVmVjdG9yIGNyb3NzIHByb2R1Y3QKICAgICAqIEBwYXJhbSB0YXJnZXQgT3B0aW9uYWwgdGFyZ2V0IHRvIHNhdmUgaW4uCiAgICAgKi8KCgogICAgY3Jvc3ModmVjdG9yLCB0YXJnZXQgPSBuZXcgVmVjMygpKSB7CiAgICAgIGNvbnN0IHZ4ID0gdmVjdG9yLng7CiAgICAgIGNvbnN0IHZ5ID0gdmVjdG9yLnk7CiAgICAgIGNvbnN0IHZ6ID0gdmVjdG9yLno7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHRhcmdldC54ID0geSAqIHZ6IC0geiAqIHZ5OwogICAgICB0YXJnZXQueSA9IHogKiB2eCAtIHggKiB2ejsKICAgICAgdGFyZ2V0LnogPSB4ICogdnkgLSB5ICogdng7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgdmVjdG9ycycgMyBlbGVtZW50cwogICAgICovCgoKICAgIHNldCh4LCB5LCB6KSB7CiAgICAgIHRoaXMueCA9IHg7CiAgICAgIHRoaXMueSA9IHk7CiAgICAgIHRoaXMueiA9IHo7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgYWxsIGNvbXBvbmVudHMgb2YgdGhlIHZlY3RvciB0byB6ZXJvLgogICAgICovCgoKICAgIHNldFplcm8oKSB7CiAgICAgIHRoaXMueCA9IHRoaXMueSA9IHRoaXMueiA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIFZlY3RvciBhZGRpdGlvbgogICAgICovCgoKICAgIHZhZGQodmVjdG9yLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCkgewogICAgICAgIHRhcmdldC54ID0gdmVjdG9yLnggKyB0aGlzLng7CiAgICAgICAgdGFyZ2V0LnkgPSB2ZWN0b3IueSArIHRoaXMueTsKICAgICAgICB0YXJnZXQueiA9IHZlY3Rvci56ICsgdGhpcy56OwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBuZXcgVmVjMyh0aGlzLnggKyB2ZWN0b3IueCwgdGhpcy55ICsgdmVjdG9yLnksIHRoaXMueiArIHZlY3Rvci56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBWZWN0b3Igc3VidHJhY3Rpb24KICAgICAqIEBwYXJhbSB0YXJnZXQgT3B0aW9uYWwgdGFyZ2V0IHRvIHNhdmUgaW4uCiAgICAgKi8KCgogICAgdnN1Yih2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0KSB7CiAgICAgICAgdGFyZ2V0LnggPSB0aGlzLnggLSB2ZWN0b3IueDsKICAgICAgICB0YXJnZXQueSA9IHRoaXMueSAtIHZlY3Rvci55OwogICAgICAgIHRhcmdldC56ID0gdGhpcy56IC0gdmVjdG9yLno7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG5ldyBWZWMzKHRoaXMueCAtIHZlY3Rvci54LCB0aGlzLnkgLSB2ZWN0b3IueSwgdGhpcy56IC0gdmVjdG9yLnopOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgY3Jvc3MgcHJvZHVjdCBtYXRyaXggYV9jcm9zcyBmcm9tIGEgdmVjdG9yLCBzdWNoIHRoYXQgYSB4IGIgPSBhX2Nyb3NzICogYiA9IGMKICAgICAqCiAgICAgKiBTZWUge0BsaW5rIGh0dHBzOi8vd3d3OC5jcy51bXUuc2Uva3Vyc2VyL1REQkQyNC9WVDA2L2xlY3R1cmVzL0xlY3R1cmU2LnBkZiBVbWXDpSBVbml2ZXJzaXR5IExlY3R1cmV9CiAgICAgKi8KCgogICAgY3Jvc3NtYXQoKSB7CiAgICAgIHJldHVybiBuZXcgTWF0MyhbMCwgLXRoaXMueiwgdGhpcy55LCB0aGlzLnosIDAsIC10aGlzLngsIC10aGlzLnksIHRoaXMueCwgMF0pOwogICAgfQogICAgLyoqCiAgICAgKiBOb3JtYWxpemUgdGhlIHZlY3Rvci4gTm90ZSB0aGF0IHRoaXMgY2hhbmdlcyB0aGUgdmFsdWVzIGluIHRoZSB2ZWN0b3IuCiAgICAgICogQHJldHVybiBSZXR1cm5zIHRoZSBub3JtIG9mIHRoZSB2ZWN0b3IKICAgICAqLwoKCiAgICBub3JtYWxpemUoKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIGNvbnN0IG4gPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKCiAgICAgIGlmIChuID4gMC4wKSB7CiAgICAgICAgY29uc3QgaW52TiA9IDEgLyBuOwogICAgICAgIHRoaXMueCAqPSBpbnZOOwogICAgICAgIHRoaXMueSAqPSBpbnZOOwogICAgICAgIHRoaXMueiAqPSBpbnZOOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIE1ha2Ugc29tZXRoaW5nIHVwCiAgICAgICAgdGhpcy54ID0gMDsKICAgICAgICB0aGlzLnkgPSAwOwogICAgICAgIHRoaXMueiA9IDA7CiAgICAgIH0KCiAgICAgIHJldHVybiBuOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHZlcnNpb24gb2YgdGhpcyB2ZWN0b3IgdGhhdCBpcyBvZiBsZW5ndGggMS4KICAgICAqIEBwYXJhbSB0YXJnZXQgT3B0aW9uYWwgdGFyZ2V0IHRvIHNhdmUgaW4KICAgICAqIEByZXR1cm4gUmV0dXJucyB0aGUgdW5pdCB2ZWN0b3IKICAgICAqLwoKCiAgICB1bml0KHRhcmdldCA9IG5ldyBWZWMzKCkpIHsKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgbGV0IG5pbnYgPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKCiAgICAgIGlmIChuaW52ID4gMC4wKSB7CiAgICAgICAgbmludiA9IDEuMCAvIG5pbnY7CiAgICAgICAgdGFyZ2V0LnggPSB4ICogbmludjsKICAgICAgICB0YXJnZXQueSA9IHkgKiBuaW52OwogICAgICAgIHRhcmdldC56ID0geiAqIG5pbnY7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGFyZ2V0LnggPSAxOwogICAgICAgIHRhcmdldC55ID0gMDsKICAgICAgICB0YXJnZXQueiA9IDA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgbGVuZ3RoIG9mIHRoZSB2ZWN0b3IKICAgICAqLwoKCiAgICBsZW5ndGgoKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBzcXVhcmVkIGxlbmd0aCBvZiB0aGUgdmVjdG9yLgogICAgICovCgoKICAgIGxlbmd0aFNxdWFyZWQoKSB7CiAgICAgIHJldHVybiB0aGlzLmRvdCh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGRpc3RhbmNlIGZyb20gdGhpcyBwb2ludCB0byBhbm90aGVyIHBvaW50CiAgICAgKi8KCgogICAgZGlzdGFuY2VUbyhwKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIGNvbnN0IHB4ID0gcC54OwogICAgICBjb25zdCBweSA9IHAueTsKICAgICAgY29uc3QgcHogPSBwLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHNxdWFyZWQgZGlzdGFuY2UgZnJvbSB0aGlzIHBvaW50IHRvIGFub3RoZXIgcG9pbnQKICAgICAqLwoKCiAgICBkaXN0YW5jZVNxdWFyZWQocCkgewogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCBweCA9IHAueDsKICAgICAgY29uc3QgcHkgPSBwLnk7CiAgICAgIGNvbnN0IHB6ID0gcC56OwogICAgICByZXR1cm4gKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSBhbGwgdGhlIGNvbXBvbmVudHMgb2YgdGhlIHZlY3RvciB3aXRoIGEgc2NhbGFyLgogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdmVjdG9yIHRvIHNhdmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBzY2FsZShzY2FsYXIsIHRhcmdldCA9IG5ldyBWZWMzKCkpIHsKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgdGFyZ2V0LnggPSBzY2FsYXIgKiB4OwogICAgICB0YXJnZXQueSA9IHNjYWxhciAqIHk7CiAgICAgIHRhcmdldC56ID0gc2NhbGFyICogejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTXVsdGlwbHkgdGhlIHZlY3RvciB3aXRoIGFuIG90aGVyIHZlY3RvciwgY29tcG9uZW50LXdpc2UuCiAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB2ZWN0b3IgdG8gc2F2ZSB0aGUgcmVzdWx0IGluLgogICAgICovCgoKICAgIHZtdWwodmVjdG9yLCB0YXJnZXQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHRhcmdldC54ID0gdmVjdG9yLnggKiB0aGlzLng7CiAgICAgIHRhcmdldC55ID0gdmVjdG9yLnkgKiB0aGlzLnk7CiAgICAgIHRhcmdldC56ID0gdmVjdG9yLnogKiB0aGlzLno7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIFNjYWxlIGEgdmVjdG9yIGFuZCBhZGQgaXQgdG8gdGhpcyB2ZWN0b3IuIFNhdmUgdGhlIHJlc3VsdCBpbiAidGFyZ2V0Ii4gKHRhcmdldCA9IHRoaXMgKyB2ZWN0b3IgKiBzY2FsYXIpCiAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB2ZWN0b3IgdG8gc2F2ZSB0aGUgcmVzdWx0IGluLgogICAgICovCgoKICAgIGFkZFNjYWxlZFZlY3RvcihzY2FsYXIsIHZlY3RvciwgdGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICB0YXJnZXQueCA9IHRoaXMueCArIHNjYWxhciAqIHZlY3Rvci54OwogICAgICB0YXJnZXQueSA9IHRoaXMueSArIHNjYWxhciAqIHZlY3Rvci55OwogICAgICB0YXJnZXQueiA9IHRoaXMueiArIHNjYWxhciAqIHZlY3Rvci56OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBDYWxjdWxhdGUgZG90IHByb2R1Y3QKICAgICAqIEBwYXJhbSB2ZWN0b3IKICAgICAqLwoKCiAgICBkb3QodmVjdG9yKSB7CiAgICAgIHJldHVybiB0aGlzLnggKiB2ZWN0b3IueCArIHRoaXMueSAqIHZlY3Rvci55ICsgdGhpcy56ICogdmVjdG9yLno7CiAgICB9CgogICAgaXNaZXJvKCkgewogICAgICByZXR1cm4gdGhpcy54ID09PSAwICYmIHRoaXMueSA9PT0gMCAmJiB0aGlzLnogPT09IDA7CiAgICB9CiAgICAvKioKICAgICAqIE1ha2UgdGhlIHZlY3RvciBwb2ludCBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uLgogICAgICogQHBhcmFtIHRhcmdldCBPcHRpb25hbCB0YXJnZXQgdG8gc2F2ZSBpbgogICAgICovCgoKICAgIG5lZ2F0ZSh0YXJnZXQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHRhcmdldC54ID0gLXRoaXMueDsKICAgICAgdGFyZ2V0LnkgPSAtdGhpcy55OwogICAgICB0YXJnZXQueiA9IC10aGlzLno7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdHdvIGFydGlmaWNpYWwgdGFuZ2VudHMgdG8gdGhlIHZlY3RvcgogICAgICogQHBhcmFtIHQxIFZlY3RvciBvYmplY3QgdG8gc2F2ZSB0aGUgZmlyc3QgdGFuZ2VudCBpbgogICAgICogQHBhcmFtIHQyIFZlY3RvciBvYmplY3QgdG8gc2F2ZSB0aGUgc2Vjb25kIHRhbmdlbnQgaW4KICAgICAqLwoKCiAgICB0YW5nZW50cyh0MSwgdDIpIHsKICAgICAgY29uc3Qgbm9ybSA9IHRoaXMubGVuZ3RoKCk7CgogICAgICBpZiAobm9ybSA+IDAuMCkgewogICAgICAgIGNvbnN0IG4gPSBWZWMzX3RhbmdlbnRzX247CiAgICAgICAgY29uc3QgaW5vcm0gPSAxIC8gbm9ybTsKICAgICAgICBuLnNldCh0aGlzLnggKiBpbm9ybSwgdGhpcy55ICogaW5vcm0sIHRoaXMueiAqIGlub3JtKTsKICAgICAgICBjb25zdCByYW5kVmVjID0gVmVjM190YW5nZW50c19yYW5kVmVjOwoKICAgICAgICBpZiAoTWF0aC5hYnMobi54KSA8IDAuOSkgewogICAgICAgICAgcmFuZFZlYy5zZXQoMSwgMCwgMCk7CiAgICAgICAgICBuLmNyb3NzKHJhbmRWZWMsIHQxKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmFuZFZlYy5zZXQoMCwgMSwgMCk7CiAgICAgICAgICBuLmNyb3NzKHJhbmRWZWMsIHQxKTsKICAgICAgICB9CgogICAgICAgIG4uY3Jvc3ModDEsIHQyKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUaGUgbm9ybWFsIGxlbmd0aCBpcyB6ZXJvLCBtYWtlIHNvbWV0aGluZyB1cAogICAgICAgIHQxLnNldCgxLCAwLCAwKTsKICAgICAgICB0Mi5zZXQoMCwgMSwgMCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ29udmVydHMgdG8gYSBtb3JlIHJlYWRhYmxlIGZvcm1hdAogICAgICovCgoKICAgIHRvU3RyaW5nKCkgewogICAgICByZXR1cm4gdGhpcy54ICsgIiwiICsgdGhpcy55ICsgIiwiICsgdGhpcy56OwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0cyB0byBhbiBhcnJheQogICAgICovCgoKICAgIHRvQXJyYXkoKSB7CiAgICAgIHJldHVybiBbdGhpcy54LCB0aGlzLnksIHRoaXMuel07CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyB2ZWN0b3IuCiAgICAgKi8KCgogICAgY29weSh2ZWN0b3IpIHsKICAgICAgdGhpcy54ID0gdmVjdG9yLng7CiAgICAgIHRoaXMueSA9IHZlY3Rvci55OwogICAgICB0aGlzLnogPSB2ZWN0b3IuejsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIERvIGEgbGluZWFyIGludGVycG9sYXRpb24gYmV0d2VlbiB0d28gdmVjdG9ycwogICAgICogQHBhcmFtIHQgQSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxLiAwIHdpbGwgbWFrZSB0aGlzIGZ1bmN0aW9uIHJldHVybiB1LCBhbmQgMSB3aWxsIG1ha2UgaXQgcmV0dXJuIHYuIE51bWJlcnMgaW4gYmV0d2VlbiB3aWxsIGdlbmVyYXRlIGEgdmVjdG9yIGluIGJldHdlZW4gdGhlbS4KICAgICAqLwoKCiAgICBsZXJwKHZlY3RvciwgdCwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHRhcmdldC54ID0geCArICh2ZWN0b3IueCAtIHgpICogdDsKICAgICAgdGFyZ2V0LnkgPSB5ICsgKHZlY3Rvci55IC0geSkgKiB0OwogICAgICB0YXJnZXQueiA9IHogKyAodmVjdG9yLnogLSB6KSAqIHQ7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgdmVjdG9yIGVxdWFscyBpcyBhbG1vc3QgZXF1YWwgdG8gYW5vdGhlciBvbmUuCiAgICAgKi8KCgogICAgYWxtb3N0RXF1YWxzKHZlY3RvciwgcHJlY2lzaW9uID0gMWUtNikgewogICAgICBpZiAoTWF0aC5hYnModGhpcy54IC0gdmVjdG9yLngpID4gcHJlY2lzaW9uIHx8IE1hdGguYWJzKHRoaXMueSAtIHZlY3Rvci55KSA+IHByZWNpc2lvbiB8fCBNYXRoLmFicyh0aGlzLnogLSB2ZWN0b3IueikgPiBwcmVjaXNpb24pIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiBhIHZlY3RvciBpcyBhbG1vc3QgemVybwogICAgICovCgoKICAgIGFsbW9zdFplcm8ocHJlY2lzaW9uID0gMWUtNikgewogICAgICBpZiAoTWF0aC5hYnModGhpcy54KSA+IHByZWNpc2lvbiB8fCBNYXRoLmFicyh0aGlzLnkpID4gcHJlY2lzaW9uIHx8IE1hdGguYWJzKHRoaXMueikgPiBwcmVjaXNpb24pIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgdmVjdG9yIGlzIGFudGktcGFyYWxsZWwgdG8gYW5vdGhlciB2ZWN0b3IuCiAgICAgKiBAcGFyYW0gcHJlY2lzaW9uIFNldCB0byB6ZXJvIGZvciBleGFjdCBjb21wYXJpc29ucwogICAgICovCgoKICAgIGlzQW50aXBhcmFsbGVsVG8odmVjdG9yLCBwcmVjaXNpb24pIHsKICAgICAgdGhpcy5uZWdhdGUoYW50aXBfbmVnKTsKICAgICAgcmV0dXJuIGFudGlwX25lZy5hbG1vc3RFcXVhbHModmVjdG9yLCBwcmVjaXNpb24pOwogICAgfQogICAgLyoqCiAgICAgKiBDbG9uZSB0aGUgdmVjdG9yCiAgICAgKi8KCgogICAgY2xvbmUoKSB7CiAgICAgIHJldHVybiBuZXcgVmVjMyh0aGlzLngsIHRoaXMueSwgdGhpcy56KTsKICAgIH0KCiAgfQoKICBWZWMzLlpFUk8gPSB2b2lkIDA7CiAgVmVjMy5VTklUX1ggPSB2b2lkIDA7CiAgVmVjMy5VTklUX1kgPSB2b2lkIDA7CiAgVmVjMy5VTklUX1ogPSB2b2lkIDA7CiAgVmVjMy5aRVJPID0gbmV3IFZlYzMoMCwgMCwgMCk7CiAgVmVjMy5VTklUX1ggPSBuZXcgVmVjMygxLCAwLCAwKTsKICBWZWMzLlVOSVRfWSA9IG5ldyBWZWMzKDAsIDEsIDApOwogIFZlYzMuVU5JVF9aID0gbmV3IFZlYzMoMCwgMCwgMSk7CiAgY29uc3QgVmVjM190YW5nZW50c19uID0gbmV3IFZlYzMoKTsKICBjb25zdCBWZWMzX3RhbmdlbnRzX3JhbmRWZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFudGlwX25lZyA9IG5ldyBWZWMzKCk7CiAgLyoqCiAgICogQXhpcyBhbGlnbmVkIGJvdW5kaW5nIGJveCBjbGFzcy4KICAgKi8KCiAgY2xhc3MgQUFCQiB7CiAgICAvKioKICAgICAqIFRoZSBsb3dlciBib3VuZCBvZiB0aGUgYm91bmRpbmcgYm94CiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSB1cHBlciBib3VuZCBvZiB0aGUgYm91bmRpbmcgYm94CiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkgewogICAgICB0aGlzLmxvd2VyQm91bmQgPSB2b2lkIDA7CiAgICAgIHRoaXMudXBwZXJCb3VuZCA9IHZvaWQgMDsKICAgICAgdGhpcy5sb3dlckJvdW5kID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy51cHBlckJvdW5kID0gbmV3IFZlYzMoKTsKCiAgICAgIGlmIChvcHRpb25zLmxvd2VyQm91bmQpIHsKICAgICAgICB0aGlzLmxvd2VyQm91bmQuY29weShvcHRpb25zLmxvd2VyQm91bmQpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy51cHBlckJvdW5kKSB7CiAgICAgICAgdGhpcy51cHBlckJvdW5kLmNvcHkob3B0aW9ucy51cHBlckJvdW5kKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIEFBQkIgYm91bmRzIGZyb20gYSBzZXQgb2YgcG9pbnRzLgogICAgICogQHBhcmFtIHBvaW50cyBBbiBhcnJheSBvZiBWZWMzJ3MuCiAgICAgKiBAcmV0dXJuIFRoZSBzZWxmIG9iamVjdAogICAgICovCgoKICAgIHNldEZyb21Qb2ludHMocG9pbnRzLCBwb3NpdGlvbiwgcXVhdGVybmlvbiwgc2tpblNpemUpIHsKICAgICAgY29uc3QgbCA9IHRoaXMubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IHRoaXMudXBwZXJCb3VuZDsKICAgICAgY29uc3QgcSA9IHF1YXRlcm5pb247IC8vIFNldCB0byB0aGUgZmlyc3QgcG9pbnQKCiAgICAgIGwuY29weShwb2ludHNbMF0pOwoKICAgICAgaWYgKHEpIHsKICAgICAgICBxLnZtdWx0KGwsIGwpOwogICAgICB9CgogICAgICB1LmNvcHkobCk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHBvaW50cy5sZW5ndGg7IGkrKykgewogICAgICAgIGxldCBwID0gcG9pbnRzW2ldOwoKICAgICAgICBpZiAocSkgewogICAgICAgICAgcS52bXVsdChwLCB0bXAkMSk7CiAgICAgICAgICBwID0gdG1wJDE7CiAgICAgICAgfQoKICAgICAgICBpZiAocC54ID4gdS54KSB7CiAgICAgICAgICB1LnggPSBwLng7CiAgICAgICAgfQoKICAgICAgICBpZiAocC54IDwgbC54KSB7CiAgICAgICAgICBsLnggPSBwLng7CiAgICAgICAgfQoKICAgICAgICBpZiAocC55ID4gdS55KSB7CiAgICAgICAgICB1LnkgPSBwLnk7CiAgICAgICAgfQoKICAgICAgICBpZiAocC55IDwgbC55KSB7CiAgICAgICAgICBsLnkgPSBwLnk7CiAgICAgICAgfQoKICAgICAgICBpZiAocC56ID4gdS56KSB7CiAgICAgICAgICB1LnogPSBwLno7CiAgICAgICAgfQoKICAgICAgICBpZiAocC56IDwgbC56KSB7CiAgICAgICAgICBsLnogPSBwLno7CiAgICAgICAgfQogICAgICB9IC8vIEFkZCBvZmZzZXQKCgogICAgICBpZiAocG9zaXRpb24pIHsKICAgICAgICBwb3NpdGlvbi52YWRkKGwsIGwpOwogICAgICAgIHBvc2l0aW9uLnZhZGQodSwgdSk7CiAgICAgIH0KCiAgICAgIGlmIChza2luU2l6ZSkgewogICAgICAgIGwueCAtPSBza2luU2l6ZTsKICAgICAgICBsLnkgLT0gc2tpblNpemU7CiAgICAgICAgbC56IC09IHNraW5TaXplOwogICAgICAgIHUueCArPSBza2luU2l6ZTsKICAgICAgICB1LnkgKz0gc2tpblNpemU7CiAgICAgICAgdS56ICs9IHNraW5TaXplOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQ29weSBib3VuZHMgZnJvbSBhbiBBQUJCIHRvIHRoaXMgQUFCQgogICAgICogQHBhcmFtIGFhYmIgU291cmNlIHRvIGNvcHkgZnJvbQogICAgICogQHJldHVybiBUaGUgdGhpcyBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkKICAgICAqLwoKCiAgICBjb3B5KGFhYmIpIHsKICAgICAgdGhpcy5sb3dlckJvdW5kLmNvcHkoYWFiYi5sb3dlckJvdW5kKTsKICAgICAgdGhpcy51cHBlckJvdW5kLmNvcHkoYWFiYi51cHBlckJvdW5kKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENsb25lIGFuIEFBQkIKICAgICAqLwoKCiAgICBjbG9uZSgpIHsKICAgICAgcmV0dXJuIG5ldyBBQUJCKCkuY29weSh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogRXh0ZW5kIHRoaXMgQUFCQiBzbyB0aGF0IGl0IGNvdmVycyB0aGUgZ2l2ZW4gQUFCQiB0b28uCiAgICAgKi8KCgogICAgZXh0ZW5kKGFhYmIpIHsKICAgICAgdGhpcy5sb3dlckJvdW5kLnggPSBNYXRoLm1pbih0aGlzLmxvd2VyQm91bmQueCwgYWFiYi5sb3dlckJvdW5kLngpOwogICAgICB0aGlzLnVwcGVyQm91bmQueCA9IE1hdGgubWF4KHRoaXMudXBwZXJCb3VuZC54LCBhYWJiLnVwcGVyQm91bmQueCk7CiAgICAgIHRoaXMubG93ZXJCb3VuZC55ID0gTWF0aC5taW4odGhpcy5sb3dlckJvdW5kLnksIGFhYmIubG93ZXJCb3VuZC55KTsKICAgICAgdGhpcy51cHBlckJvdW5kLnkgPSBNYXRoLm1heCh0aGlzLnVwcGVyQm91bmQueSwgYWFiYi51cHBlckJvdW5kLnkpOwogICAgICB0aGlzLmxvd2VyQm91bmQueiA9IE1hdGgubWluKHRoaXMubG93ZXJCb3VuZC56LCBhYWJiLmxvd2VyQm91bmQueik7CiAgICAgIHRoaXMudXBwZXJCb3VuZC56ID0gTWF0aC5tYXgodGhpcy51cHBlckJvdW5kLnosIGFhYmIudXBwZXJCb3VuZC56KTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBBQUJCIG92ZXJsYXBzIHRoaXMgQUFCQi4KICAgICAqLwoKCiAgICBvdmVybGFwcyhhYWJiKSB7CiAgICAgIGNvbnN0IGwxID0gdGhpcy5sb3dlckJvdW5kOwogICAgICBjb25zdCB1MSA9IHRoaXMudXBwZXJCb3VuZDsKICAgICAgY29uc3QgbDIgPSBhYWJiLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUyID0gYWFiYi51cHBlckJvdW5kOyAvLyAgICAgIGwyICAgICAgICB1MgogICAgICAvLyAgICAgIHwtLS0tLS0tLS18CiAgICAgIC8vIHwtLS0tLS0tLXwKICAgICAgLy8gbDEgICAgICAgdTEKCiAgICAgIGNvbnN0IG92ZXJsYXBzWCA9IGwyLnggPD0gdTEueCAmJiB1MS54IDw9IHUyLnggfHwgbDEueCA8PSB1Mi54ICYmIHUyLnggPD0gdTEueDsKICAgICAgY29uc3Qgb3ZlcmxhcHNZID0gbDIueSA8PSB1MS55ICYmIHUxLnkgPD0gdTIueSB8fCBsMS55IDw9IHUyLnkgJiYgdTIueSA8PSB1MS55OwogICAgICBjb25zdCBvdmVybGFwc1ogPSBsMi56IDw9IHUxLnogJiYgdTEueiA8PSB1Mi56IHx8IGwxLnogPD0gdTIueiAmJiB1Mi56IDw9IHUxLno7CiAgICAgIHJldHVybiBvdmVybGFwc1ggJiYgb3ZlcmxhcHNZICYmIG92ZXJsYXBzWjsKICAgIH0gLy8gTW9zdGx5IGZvciBkZWJ1Z2dpbmcKCgogICAgdm9sdW1lKCkgewogICAgICBjb25zdCBsID0gdGhpcy5sb3dlckJvdW5kOwogICAgICBjb25zdCB1ID0gdGhpcy51cHBlckJvdW5kOwogICAgICByZXR1cm4gKHUueCAtIGwueCkgKiAodS55IC0gbC55KSAqICh1LnogLSBsLnopOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIEFBQkIgaXMgZnVsbHkgY29udGFpbmVkIGluIHRoaXMgQUFCQi4KICAgICAqLwoKCiAgICBjb250YWlucyhhYWJiKSB7CiAgICAgIGNvbnN0IGwxID0gdGhpcy5sb3dlckJvdW5kOwogICAgICBjb25zdCB1MSA9IHRoaXMudXBwZXJCb3VuZDsKICAgICAgY29uc3QgbDIgPSBhYWJiLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUyID0gYWFiYi51cHBlckJvdW5kOyAvLyAgICAgIGwyICAgICAgICB1MgogICAgICAvLyAgICAgIHwtLS0tLS0tLS18CiAgICAgIC8vIHwtLS0tLS0tLS0tLS0tLS18CiAgICAgIC8vIGwxICAgICAgICAgICAgICB1MQoKICAgICAgcmV0dXJuIGwxLnggPD0gbDIueCAmJiB1MS54ID49IHUyLnggJiYgbDEueSA8PSBsMi55ICYmIHUxLnkgPj0gdTIueSAmJiBsMS56IDw9IGwyLnogJiYgdTEueiA+PSB1Mi56OwogICAgfQoKICAgIGdldENvcm5lcnMoYSwgYiwgYywgZCwgZSwgZiwgZywgaCkgewogICAgICBjb25zdCBsID0gdGhpcy5sb3dlckJvdW5kOwogICAgICBjb25zdCB1ID0gdGhpcy51cHBlckJvdW5kOwogICAgICBhLmNvcHkobCk7CiAgICAgIGIuc2V0KHUueCwgbC55LCBsLnopOwogICAgICBjLnNldCh1LngsIHUueSwgbC56KTsKICAgICAgZC5zZXQobC54LCB1LnksIHUueik7CiAgICAgIGUuc2V0KHUueCwgbC55LCB1LnopOwogICAgICBmLnNldChsLngsIHUueSwgbC56KTsKICAgICAgZy5zZXQobC54LCBsLnksIHUueik7CiAgICAgIGguY29weSh1KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSByZXByZXNlbnRhdGlvbiBvZiBhbiBBQUJCIGluIGFub3RoZXIgZnJhbWUuCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiBBQUJCIG9iamVjdC4KICAgICAqLwoKCiAgICB0b0xvY2FsRnJhbWUoZnJhbWUsIHRhcmdldCkgewogICAgICBjb25zdCBjb3JuZXJzID0gdHJhbnNmb3JtSW50b0ZyYW1lX2Nvcm5lcnM7CiAgICAgIGNvbnN0IGEgPSBjb3JuZXJzWzBdOwogICAgICBjb25zdCBiID0gY29ybmVyc1sxXTsKICAgICAgY29uc3QgYyA9IGNvcm5lcnNbMl07CiAgICAgIGNvbnN0IGQgPSBjb3JuZXJzWzNdOwogICAgICBjb25zdCBlID0gY29ybmVyc1s0XTsKICAgICAgY29uc3QgZiA9IGNvcm5lcnNbNV07CiAgICAgIGNvbnN0IGcgPSBjb3JuZXJzWzZdOwogICAgICBjb25zdCBoID0gY29ybmVyc1s3XTsgLy8gR2V0IGNvcm5lcnMgaW4gY3VycmVudCBmcmFtZQoKICAgICAgdGhpcy5nZXRDb3JuZXJzKGEsIGIsIGMsIGQsIGUsIGYsIGcsIGgpOyAvLyBUcmFuc2Zvcm0gdGhlbSB0byBuZXcgbG9jYWwgZnJhbWUKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSA4OyBpKyspIHsKICAgICAgICBjb25zdCBjb3JuZXIgPSBjb3JuZXJzW2ldOwogICAgICAgIGZyYW1lLnBvaW50VG9Mb2NhbChjb3JuZXIsIGNvcm5lcik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQuc2V0RnJvbVBvaW50cyhjb3JuZXJzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSByZXByZXNlbnRhdGlvbiBvZiBhbiBBQUJCIGluIHRoZSBnbG9iYWwgZnJhbWUuCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiBBQUJCIG9iamVjdC4KICAgICAqLwoKCiAgICB0b1dvcmxkRnJhbWUoZnJhbWUsIHRhcmdldCkgewogICAgICBjb25zdCBjb3JuZXJzID0gdHJhbnNmb3JtSW50b0ZyYW1lX2Nvcm5lcnM7CiAgICAgIGNvbnN0IGEgPSBjb3JuZXJzWzBdOwogICAgICBjb25zdCBiID0gY29ybmVyc1sxXTsKICAgICAgY29uc3QgYyA9IGNvcm5lcnNbMl07CiAgICAgIGNvbnN0IGQgPSBjb3JuZXJzWzNdOwogICAgICBjb25zdCBlID0gY29ybmVyc1s0XTsKICAgICAgY29uc3QgZiA9IGNvcm5lcnNbNV07CiAgICAgIGNvbnN0IGcgPSBjb3JuZXJzWzZdOwogICAgICBjb25zdCBoID0gY29ybmVyc1s3XTsgLy8gR2V0IGNvcm5lcnMgaW4gY3VycmVudCBmcmFtZQoKICAgICAgdGhpcy5nZXRDb3JuZXJzKGEsIGIsIGMsIGQsIGUsIGYsIGcsIGgpOyAvLyBUcmFuc2Zvcm0gdGhlbSB0byBuZXcgbG9jYWwgZnJhbWUKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSA4OyBpKyspIHsKICAgICAgICBjb25zdCBjb3JuZXIgPSBjb3JuZXJzW2ldOwogICAgICAgIGZyYW1lLnBvaW50VG9Xb3JsZChjb3JuZXIsIGNvcm5lcik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQuc2V0RnJvbVBvaW50cyhjb3JuZXJzKTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIEFBQkIgaXMgaGl0IGJ5IGEgcmF5LgogICAgICovCgoKICAgIG92ZXJsYXBzUmF5KHJheSkgewogICAgICBjb25zdCB7CiAgICAgICAgZGlyZWN0aW9uLAogICAgICAgIGZyb20KICAgICAgfSA9IHJheTsgLy8gY29uc3QgdCA9IDAKICAgICAgLy8gcmF5LmRpcmVjdGlvbiBpcyB1bml0IGRpcmVjdGlvbiB2ZWN0b3Igb2YgcmF5CgogICAgICBjb25zdCBkaXJGcmFjWCA9IDEgLyBkaXJlY3Rpb24ueDsKICAgICAgY29uc3QgZGlyRnJhY1kgPSAxIC8gZGlyZWN0aW9uLnk7CiAgICAgIGNvbnN0IGRpckZyYWNaID0gMSAvIGRpcmVjdGlvbi56OyAvLyB0aGlzLmxvd2VyQm91bmQgaXMgdGhlIGNvcm5lciBvZiBBQUJCIHdpdGggbWluaW1hbCBjb29yZGluYXRlcyAtIGxlZnQgYm90dG9tLCBydCBpcyBtYXhpbWFsIGNvcm5lcgoKICAgICAgY29uc3QgdDEgPSAodGhpcy5sb3dlckJvdW5kLnggLSBmcm9tLngpICogZGlyRnJhY1g7CiAgICAgIGNvbnN0IHQyID0gKHRoaXMudXBwZXJCb3VuZC54IC0gZnJvbS54KSAqIGRpckZyYWNYOwogICAgICBjb25zdCB0MyA9ICh0aGlzLmxvd2VyQm91bmQueSAtIGZyb20ueSkgKiBkaXJGcmFjWTsKICAgICAgY29uc3QgdDQgPSAodGhpcy51cHBlckJvdW5kLnkgLSBmcm9tLnkpICogZGlyRnJhY1k7CiAgICAgIGNvbnN0IHQ1ID0gKHRoaXMubG93ZXJCb3VuZC56IC0gZnJvbS56KSAqIGRpckZyYWNaOwogICAgICBjb25zdCB0NiA9ICh0aGlzLnVwcGVyQm91bmQueiAtIGZyb20ueikgKiBkaXJGcmFjWjsgLy8gY29uc3QgdG1pbiA9IE1hdGgubWF4KE1hdGgubWF4KE1hdGgubWluKHQxLCB0MiksIE1hdGgubWluKHQzLCB0NCkpKTsKICAgICAgLy8gY29uc3QgdG1heCA9IE1hdGgubWluKE1hdGgubWluKE1hdGgubWF4KHQxLCB0MiksIE1hdGgubWF4KHQzLCB0NCkpKTsKCiAgICAgIGNvbnN0IHRtaW4gPSBNYXRoLm1heChNYXRoLm1heChNYXRoLm1pbih0MSwgdDIpLCBNYXRoLm1pbih0MywgdDQpKSwgTWF0aC5taW4odDUsIHQ2KSk7CiAgICAgIGNvbnN0IHRtYXggPSBNYXRoLm1pbihNYXRoLm1pbihNYXRoLm1heCh0MSwgdDIpLCBNYXRoLm1heCh0MywgdDQpKSwgTWF0aC5tYXgodDUsIHQ2KSk7IC8vIGlmIHRtYXggPCAwLCByYXkgKGxpbmUpIGlzIGludGVyc2VjdGluZyBBQUJCLCBidXQgd2hvbGUgQUFCQiBpcyBiZWhpbmcgdXMKCiAgICAgIGlmICh0bWF4IDwgMCkgewogICAgICAgIC8vdCA9IHRtYXg7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8vIGlmIHRtaW4gPiB0bWF4LCByYXkgZG9lc24ndCBpbnRlcnNlY3QgQUFCQgoKCiAgICAgIGlmICh0bWluID4gdG1heCkgewogICAgICAgIC8vdCA9IHRtYXg7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgfQoKICBjb25zdCB0bXAkMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdHJhbnNmb3JtSW50b0ZyYW1lX2Nvcm5lcnMgPSBbbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKV07CiAgLyoqCiAgICogQ29sbGlzaW9uICJtYXRyaXgiLgogICAqIEl0J3MgYWN0dWFsbHkgYSB0cmlhbmd1bGFyLXNoYXBlZCBhcnJheSBvZiB3aGV0aGVyIHR3byBib2RpZXMgYXJlIHRvdWNoaW5nIHRoaXMgc3RlcCwgZm9yIHJlZmVyZW5jZSBuZXh0IHN0ZXAKICAgKi8KCiAgY2xhc3MgQXJyYXlDb2xsaXNpb25NYXRyaXggewogICAgLyoqCiAgICAgKiBUaGUgbWF0cml4IHN0b3JhZ2UuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLm1hdHJpeCA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXRyaXggPSBbXTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFuIGVsZW1lbnQKICAgICAqLwoKCiAgICBnZXQoYmksIGJqKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5tYXRyaXhbKGkgKiAoaSArIDEpID4+IDEpICsgaiAtIDFdOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgYW4gZWxlbWVudAogICAgICovCgoKICAgIHNldChiaSwgYmosIHZhbHVlKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICB0aGlzLm1hdHJpeFsoaSAqIChpICsgMSkgPj4gMSkgKyBqIC0gMV0gPSB2YWx1ZSA/IDEgOiAwOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBlbGVtZW50cyB0byB6ZXJvCiAgICAgKi8KCgogICAgcmVzZXQoKSB7CiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5tYXRyaXgubGVuZ3RoOyBpICE9PSBsOyBpKyspIHsKICAgICAgICB0aGlzLm1hdHJpeFtpXSA9IDA7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogU2V0cyB0aGUgbWF4IG51bWJlciBvZiBvYmplY3RzCiAgICAgKi8KCgogICAgc2V0TnVtT2JqZWN0cyhuKSB7CiAgICAgIHRoaXMubWF0cml4Lmxlbmd0aCA9IG4gKiAobiAtIDEpID4+IDE7CiAgICB9CgogIH0KICAvKioKICAgKiBCYXNlIGNsYXNzIGZvciBvYmplY3RzIHRoYXQgZGlzcGF0Y2hlcyBldmVudHMuCiAgICovCgoKICBjbGFzcyBFdmVudFRhcmdldCB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5fbGlzdGVuZXJzID0gdm9pZCAwOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYW4gZXZlbnQgbGlzdGVuZXIKICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0LCBmb3IgY2hhaW5hYmlsaXR5LgogICAgICovCgoKICAgIGFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHsKICAgICAgaWYgKHRoaXMuX2xpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhpcy5fbGlzdGVuZXJzID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKCiAgICAgIGlmIChsaXN0ZW5lcnNbdHlwZV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgIGxpc3RlbmVyc1t0eXBlXSA9IFtdOwogICAgICB9CgogICAgICBpZiAoIWxpc3RlbmVyc1t0eXBlXS5pbmNsdWRlcyhsaXN0ZW5lcikpIHsKICAgICAgICBsaXN0ZW5lcnNbdHlwZV0ucHVzaChsaXN0ZW5lcik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiBhbiBldmVudCBsaXN0ZW5lciBpcyBhZGRlZAogICAgICovCgoKICAgIGhhc0V2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHsKICAgICAgaWYgKHRoaXMuX2xpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lcnM7CgogICAgICBpZiAobGlzdGVuZXJzW3R5cGVdICE9PSB1bmRlZmluZWQgJiYgbGlzdGVuZXJzW3R5cGVdLmluY2x1ZGVzKGxpc3RlbmVyKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGFueSBldmVudCBsaXN0ZW5lciBvZiB0aGUgZ2l2ZW4gdHlwZSBpcyBhZGRlZAogICAgICovCgoKICAgIGhhc0FueUV2ZW50TGlzdGVuZXIodHlwZSkgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKICAgICAgcmV0dXJuIGxpc3RlbmVyc1t0eXBlXSAhPT0gdW5kZWZpbmVkOwogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgYW4gZXZlbnQgbGlzdGVuZXIKICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0LCBmb3IgY2hhaW5hYmlsaXR5LgogICAgICovCgoKICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHsKICAgICAgaWYgKHRoaXMuX2xpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKCiAgICAgIGlmIChsaXN0ZW5lcnNbdHlwZV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CgogICAgICBjb25zdCBpbmRleCA9IGxpc3RlbmVyc1t0eXBlXS5pbmRleE9mKGxpc3RlbmVyKTsKCiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsKICAgICAgICBsaXN0ZW5lcnNbdHlwZV0uc3BsaWNlKGluZGV4LCAxKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIEVtaXQgYW4gZXZlbnQuCiAgICAgKiBAcmV0dXJuIFRoZSBzZWxmIG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eS4KICAgICAqLwoKCiAgICBkaXNwYXRjaEV2ZW50KGV2ZW50KSB7CiAgICAgIGlmICh0aGlzLl9saXN0ZW5lcnMgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CgogICAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lcnM7CiAgICAgIGNvbnN0IGxpc3RlbmVyQXJyYXkgPSBsaXN0ZW5lcnNbZXZlbnQudHlwZV07CgogICAgICBpZiAobGlzdGVuZXJBcnJheSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgZXZlbnQudGFyZ2V0ID0gdGhpczsKCiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBsaXN0ZW5lckFycmF5Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgbGlzdGVuZXJBcnJheVtpXS5jYWxsKHRoaXMsIGV2ZW50KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICB9CiAgLyoqCiAgICogQSBRdWF0ZXJuaW9uIGRlc2NyaWJlcyBhIHJvdGF0aW9uIGluIDNEIHNwYWNlLiBUaGUgUXVhdGVybmlvbiBpcyBtYXRoZW1hdGljYWxseSBkZWZpbmVkIGFzIFEgPSB4KmkgKyB5KmogKyB6KmsgKyB3LCB3aGVyZSAoaSxqLGspIGFyZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9ycy4gKHgseSx6KSBjYW4gYmUgc2VlbiBhcyBhIHZlY3RvciByZWxhdGVkIHRvIHRoZSBheGlzIG9mIHJvdGF0aW9uLCB3aGlsZSB0aGUgcmVhbCBtdWx0aXBsaWVyLCB3LCBpcyByZWxhdGVkIHRvIHRoZSBhbW91bnQgb2Ygcm90YXRpb24uCiAgICogQHBhcmFtIHggTXVsdGlwbGllciBvZiB0aGUgaW1hZ2luYXJ5IGJhc2lzIHZlY3RvciBpLgogICAqIEBwYXJhbSB5IE11bHRpcGxpZXIgb2YgdGhlIGltYWdpbmFyeSBiYXNpcyB2ZWN0b3Igai4KICAgKiBAcGFyYW0geiBNdWx0aXBsaWVyIG9mIHRoZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9yIGsuCiAgICogQHBhcmFtIHcgTXVsdGlwbGllciBvZiB0aGUgcmVhbCBwYXJ0LgogICAqIEBzZWUgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9RdWF0ZXJuaW9uCiAgICovCgoKICBjbGFzcyBRdWF0ZXJuaW9uIHsKICAgIGNvbnN0cnVjdG9yKHggPSAwLCB5ID0gMCwgeiA9IDAsIHcgPSAxKSB7CiAgICAgIHRoaXMueCA9IHZvaWQgMDsKICAgICAgdGhpcy55ID0gdm9pZCAwOwogICAgICB0aGlzLnogPSB2b2lkIDA7CiAgICAgIHRoaXMudyA9IHZvaWQgMDsKICAgICAgdGhpcy54ID0geDsKICAgICAgdGhpcy55ID0geTsKICAgICAgdGhpcy56ID0gejsKICAgICAgdGhpcy53ID0gdzsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSB2YWx1ZSBvZiB0aGUgcXVhdGVybmlvbi4KICAgICAqLwoKCiAgICBzZXQoeCwgeSwgeiwgdykgewogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgICB0aGlzLnogPSB6OwogICAgICB0aGlzLncgPSB3OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCB0byBhIHJlYWRhYmxlIGZvcm1hdAogICAgICogQHJldHVybiAieCx5LHosdyIKICAgICAqLwoKCiAgICB0b1N0cmluZygpIHsKICAgICAgcmV0dXJuIHRoaXMueCArICIsIiArIHRoaXMueSArICIsIiArIHRoaXMueiArICIsIiArIHRoaXMudzsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCB0byBhbiBBcnJheQogICAgICogQHJldHVybiBbeCwgeSwgeiwgd10KICAgICAqLwoKCiAgICB0b0FycmF5KCkgewogICAgICByZXR1cm4gW3RoaXMueCwgdGhpcy55LCB0aGlzLnosIHRoaXMud107CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiBjb21wb25lbnRzIGdpdmVuIGFuIGF4aXMgYW5kIGFuIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgc2V0RnJvbUF4aXNBbmdsZSh2ZWN0b3IsIGFuZ2xlKSB7CiAgICAgIGNvbnN0IHMgPSBNYXRoLnNpbihhbmdsZSAqIDAuNSk7CiAgICAgIHRoaXMueCA9IHZlY3Rvci54ICogczsKICAgICAgdGhpcy55ID0gdmVjdG9yLnkgKiBzOwogICAgICB0aGlzLnogPSB2ZWN0b3IueiAqIHM7CiAgICAgIHRoaXMudyA9IE1hdGguY29zKGFuZ2xlICogMC41KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnRzIHRoZSBxdWF0ZXJuaW9uIHRvIFsgYXhpcywgYW5nbGUgXSByZXByZXNlbnRhdGlvbi4KICAgICAqIEBwYXJhbSB0YXJnZXRBeGlzIEEgdmVjdG9yIG9iamVjdCB0byByZXVzZSBmb3Igc3RvcmluZyB0aGUgYXhpcy4KICAgICAqIEByZXR1cm4gQW4gYXJyYXksIGZpcnN0IGVsZW1lbnQgaXMgdGhlIGF4aXMgYW5kIHRoZSBzZWNvbmQgaXMgdGhlIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgdG9BeGlzQW5nbGUodGFyZ2V0QXhpcyA9IG5ldyBWZWMzKCkpIHsKICAgICAgdGhpcy5ub3JtYWxpemUoKTsgLy8gaWYgdz4xIGFjb3MgYW5kIHNxcnQgd2lsbCBwcm9kdWNlIGVycm9ycywgdGhpcyBjYW50IGhhcHBlbiBpZiBxdWF0ZXJuaW9uIGlzIG5vcm1hbGlzZWQKCiAgICAgIGNvbnN0IGFuZ2xlID0gMiAqIE1hdGguYWNvcyh0aGlzLncpOwogICAgICBjb25zdCBzID0gTWF0aC5zcXJ0KDEgLSB0aGlzLncgKiB0aGlzLncpOyAvLyBhc3N1bWluZyBxdWF0ZXJuaW9uIG5vcm1hbGlzZWQgdGhlbiB3IGlzIGxlc3MgdGhhbiAxLCBzbyB0ZXJtIGFsd2F5cyBwb3NpdGl2ZS4KCiAgICAgIGlmIChzIDwgMC4wMDEpIHsKICAgICAgICAvLyB0ZXN0IHRvIGF2b2lkIGRpdmlkZSBieSB6ZXJvLCBzIGlzIGFsd2F5cyBwb3NpdGl2ZSBkdWUgdG8gc3FydAogICAgICAgIC8vIGlmIHMgY2xvc2UgdG8gemVybyB0aGVuIGRpcmVjdGlvbiBvZiBheGlzIG5vdCBpbXBvcnRhbnQKICAgICAgICB0YXJnZXRBeGlzLnggPSB0aGlzLng7IC8vIGlmIGl0IGlzIGltcG9ydGFudCB0aGF0IGF4aXMgaXMgbm9ybWFsaXNlZCB0aGVuIHJlcGxhY2Ugd2l0aCB4PTE7IHk9ej0wOwoKICAgICAgICB0YXJnZXRBeGlzLnkgPSB0aGlzLnk7CiAgICAgICAgdGFyZ2V0QXhpcy56ID0gdGhpcy56OwogICAgICB9IGVsc2UgewogICAgICAgIHRhcmdldEF4aXMueCA9IHRoaXMueCAvIHM7IC8vIG5vcm1hbGlzZSBheGlzCgogICAgICAgIHRhcmdldEF4aXMueSA9IHRoaXMueSAvIHM7CiAgICAgICAgdGFyZ2V0QXhpcy56ID0gdGhpcy56IC8gczsKICAgICAgfQoKICAgICAgcmV0dXJuIFt0YXJnZXRBeGlzLCBhbmdsZV07CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiB2YWx1ZSBnaXZlbiB0d28gdmVjdG9ycy4gVGhlIHJlc3VsdGluZyByb3RhdGlvbiB3aWxsIGJlIHRoZSBuZWVkZWQgcm90YXRpb24gdG8gcm90YXRlIHUgdG8gdi4KICAgICAqLwoKCiAgICBzZXRGcm9tVmVjdG9ycyh1LCB2KSB7CiAgICAgIGlmICh1LmlzQW50aXBhcmFsbGVsVG8odikpIHsKICAgICAgICBjb25zdCB0MSA9IHNmdl90MTsKICAgICAgICBjb25zdCB0MiA9IHNmdl90MjsKICAgICAgICB1LnRhbmdlbnRzKHQxLCB0Mik7CiAgICAgICAgdGhpcy5zZXRGcm9tQXhpc0FuZ2xlKHQxLCBNYXRoLlBJKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBhID0gdS5jcm9zcyh2KTsKICAgICAgICB0aGlzLnggPSBhLng7CiAgICAgICAgdGhpcy55ID0gYS55OwogICAgICAgIHRoaXMueiA9IGEuejsKICAgICAgICB0aGlzLncgPSBNYXRoLnNxcnQodS5sZW5ndGgoKSAqKiAyICogdi5sZW5ndGgoKSAqKiAyKSArIHUuZG90KHYpOwogICAgICAgIHRoaXMubm9ybWFsaXplKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0aGUgcXVhdGVybmlvbiB3aXRoIGFuIG90aGVyIHF1YXRlcm5pb24uCiAgICAgKi8KCgogICAgbXVsdChxdWF0LCB0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpKSB7CiAgICAgIGNvbnN0IGF4ID0gdGhpcy54OwogICAgICBjb25zdCBheSA9IHRoaXMueTsKICAgICAgY29uc3QgYXogPSB0aGlzLno7CiAgICAgIGNvbnN0IGF3ID0gdGhpcy53OwogICAgICBjb25zdCBieCA9IHF1YXQueDsKICAgICAgY29uc3QgYnkgPSBxdWF0Lnk7CiAgICAgIGNvbnN0IGJ6ID0gcXVhdC56OwogICAgICBjb25zdCBidyA9IHF1YXQudzsKICAgICAgdGFyZ2V0LnggPSBheCAqIGJ3ICsgYXcgKiBieCArIGF5ICogYnogLSBheiAqIGJ5OwogICAgICB0YXJnZXQueSA9IGF5ICogYncgKyBhdyAqIGJ5ICsgYXogKiBieCAtIGF4ICogYno7CiAgICAgIHRhcmdldC56ID0gYXogKiBidyArIGF3ICogYnogKyBheCAqIGJ5IC0gYXkgKiBieDsKICAgICAgdGFyZ2V0LncgPSBhdyAqIGJ3IC0gYXggKiBieCAtIGF5ICogYnkgLSBheiAqIGJ6OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGludmVyc2UgcXVhdGVybmlvbiByb3RhdGlvbi4KICAgICAqLwoKCiAgICBpbnZlcnNlKHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCkpIHsKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgY29uc3QgdyA9IHRoaXMudzsKICAgICAgdGhpcy5jb25qdWdhdGUodGFyZ2V0KTsKICAgICAgY29uc3QgaW5vcm0yID0gMSAvICh4ICogeCArIHkgKiB5ICsgeiAqIHogKyB3ICogdyk7CiAgICAgIHRhcmdldC54ICo9IGlub3JtMjsKICAgICAgdGFyZ2V0LnkgKj0gaW5vcm0yOwogICAgICB0YXJnZXQueiAqPSBpbm9ybTI7CiAgICAgIHRhcmdldC53ICo9IGlub3JtMjsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBxdWF0ZXJuaW9uIGNvbmp1Z2F0ZQogICAgICovCgoKICAgIGNvbmp1Z2F0ZSh0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpKSB7CiAgICAgIHRhcmdldC54ID0gLXRoaXMueDsKICAgICAgdGFyZ2V0LnkgPSAtdGhpcy55OwogICAgICB0YXJnZXQueiA9IC10aGlzLno7CiAgICAgIHRhcmdldC53ID0gdGhpcy53OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBOb3JtYWxpemUgdGhlIHF1YXRlcm5pb24uIE5vdGUgdGhhdCB0aGlzIGNoYW5nZXMgdGhlIHZhbHVlcyBvZiB0aGUgcXVhdGVybmlvbi4KICAgICAqLwoKCiAgICBub3JtYWxpemUoKSB7CiAgICAgIGxldCBsID0gTWF0aC5zcXJ0KHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSArIHRoaXMueiAqIHRoaXMueiArIHRoaXMudyAqIHRoaXMudyk7CgogICAgICBpZiAobCA9PT0gMCkgewogICAgICAgIHRoaXMueCA9IDA7CiAgICAgICAgdGhpcy55ID0gMDsKICAgICAgICB0aGlzLnogPSAwOwogICAgICAgIHRoaXMudyA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbCA9IDEgLyBsOwogICAgICAgIHRoaXMueCAqPSBsOwogICAgICAgIHRoaXMueSAqPSBsOwogICAgICAgIHRoaXMueiAqPSBsOwogICAgICAgIHRoaXMudyAqPSBsOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQXBwcm94aW1hdGlvbiBvZiBxdWF0ZXJuaW9uIG5vcm1hbGl6YXRpb24uIFdvcmtzIGJlc3Qgd2hlbiBxdWF0IGlzIGFscmVhZHkgYWxtb3N0LW5vcm1hbGl6ZWQuCiAgICAgKiBAYXV0aG9yIHVucGhhc2VkLCBodHRwczovL2dpdGh1Yi5jb20vdW5waGFzZWQKICAgICAqLwoKCiAgICBub3JtYWxpemVGYXN0KCkgewogICAgICBjb25zdCBmID0gKDMuMCAtICh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkgKyB0aGlzLnogKiB0aGlzLnogKyB0aGlzLncgKiB0aGlzLncpKSAvIDIuMDsKCiAgICAgIGlmIChmID09PSAwKSB7CiAgICAgICAgdGhpcy54ID0gMDsKICAgICAgICB0aGlzLnkgPSAwOwogICAgICAgIHRoaXMueiA9IDA7CiAgICAgICAgdGhpcy53ID0gMDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnggKj0gZjsKICAgICAgICB0aGlzLnkgKj0gZjsKICAgICAgICB0aGlzLnogKj0gZjsKICAgICAgICB0aGlzLncgKj0gZjsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIE11bHRpcGx5IHRoZSBxdWF0ZXJuaW9uIGJ5IGEgdmVjdG9yCiAgICAgKi8KCgogICAgdm11bHQodiwgdGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICBjb25zdCB4ID0gdi54OwogICAgICBjb25zdCB5ID0gdi55OwogICAgICBjb25zdCB6ID0gdi56OwogICAgICBjb25zdCBxeCA9IHRoaXMueDsKICAgICAgY29uc3QgcXkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHF6ID0gdGhpcy56OwogICAgICBjb25zdCBxdyA9IHRoaXMudzsgLy8gcSp2CgogICAgICBjb25zdCBpeCA9IHF3ICogeCArIHF5ICogeiAtIHF6ICogeTsKICAgICAgY29uc3QgaXkgPSBxdyAqIHkgKyBxeiAqIHggLSBxeCAqIHo7CiAgICAgIGNvbnN0IGl6ID0gcXcgKiB6ICsgcXggKiB5IC0gcXkgKiB4OwogICAgICBjb25zdCBpdyA9IC1xeCAqIHggLSBxeSAqIHkgLSBxeiAqIHo7CiAgICAgIHRhcmdldC54ID0gaXggKiBxdyArIGl3ICogLXF4ICsgaXkgKiAtcXogLSBpeiAqIC1xeTsKICAgICAgdGFyZ2V0LnkgPSBpeSAqIHF3ICsgaXcgKiAtcXkgKyBpeiAqIC1xeCAtIGl4ICogLXF6OwogICAgICB0YXJnZXQueiA9IGl6ICogcXcgKyBpdyAqIC1xeiArIGl4ICogLXF5IC0gaXkgKiAtcXg7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyBxdWF0ZXJuaW9uLgogICAgICogQHJldHVybiB0aGlzCiAgICAgKi8KCgogICAgY29weShxdWF0KSB7CiAgICAgIHRoaXMueCA9IHF1YXQueDsKICAgICAgdGhpcy55ID0gcXVhdC55OwogICAgICB0aGlzLnogPSBxdWF0Lno7CiAgICAgIHRoaXMudyA9IHF1YXQudzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHF1YXRlcm5pb24gdG8gZXVsZXIgYW5nbGUgcmVwcmVzZW50YXRpb24uIE9yZGVyOiBZWlgsIGFzIHRoaXMgcGFnZSBkZXNjcmliZXM6IGh0dHBzOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9zdGFuZGFyZHMvaW5kZXguaHRtCiAgICAgKiBAcGFyYW0gb3JkZXIgVGhyZWUtY2hhcmFjdGVyIHN0cmluZywgZGVmYXVsdHMgdG8gIllaWCIKICAgICAqLwoKCiAgICB0b0V1bGVyKHRhcmdldCwgb3JkZXIgPSAnWVpYJykgewogICAgICBsZXQgaGVhZGluZzsKICAgICAgbGV0IGF0dGl0dWRlOwogICAgICBsZXQgYmFuazsKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgY29uc3QgdyA9IHRoaXMudzsKCiAgICAgIHN3aXRjaCAob3JkZXIpIHsKICAgICAgICBjYXNlICdZWlgnOgogICAgICAgICAgY29uc3QgdGVzdCA9IHggKiB5ICsgeiAqIHc7CgogICAgICAgICAgaWYgKHRlc3QgPiAwLjQ5OSkgewogICAgICAgICAgICAvLyBzaW5ndWxhcml0eSBhdCBub3J0aCBwb2xlCiAgICAgICAgICAgIGhlYWRpbmcgPSAyICogTWF0aC5hdGFuMih4LCB3KTsKICAgICAgICAgICAgYXR0aXR1ZGUgPSBNYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRlc3QgPCAtMC40OTkpIHsKICAgICAgICAgICAgLy8gc2luZ3VsYXJpdHkgYXQgc291dGggcG9sZQogICAgICAgICAgICBoZWFkaW5nID0gLTIgKiBNYXRoLmF0YW4yKHgsIHcpOwogICAgICAgICAgICBhdHRpdHVkZSA9IC1NYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGhlYWRpbmcgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb25zdCBzcXggPSB4ICogeDsKICAgICAgICAgICAgY29uc3Qgc3F5ID0geSAqIHk7CiAgICAgICAgICAgIGNvbnN0IHNxeiA9IHogKiB6OwogICAgICAgICAgICBoZWFkaW5nID0gTWF0aC5hdGFuMigyICogeSAqIHcgLSAyICogeCAqIHosIDEgLSAyICogc3F5IC0gMiAqIHNxeik7IC8vIEhlYWRpbmcKCiAgICAgICAgICAgIGF0dGl0dWRlID0gTWF0aC5hc2luKDIgKiB0ZXN0KTsgLy8gYXR0aXR1ZGUKCiAgICAgICAgICAgIGJhbmsgPSBNYXRoLmF0YW4yKDIgKiB4ICogdyAtIDIgKiB5ICogeiwgMSAtIDIgKiBzcXggLSAyICogc3F6KTsgLy8gYmFuawogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFdWxlciBvcmRlciAiICsgb3JkZXIgKyAiIG5vdCBzdXBwb3J0ZWQgeWV0LiIpOwogICAgICB9CgogICAgICB0YXJnZXQueSA9IGhlYWRpbmc7CiAgICAgIHRhcmdldC56ID0gYXR0aXR1ZGU7CiAgICAgIHRhcmdldC54ID0gYmFuazsKICAgIH0KICAgIC8qKgogICAgICogQHBhcmFtIG9yZGVyIFRoZSBvcmRlciB0byBhcHBseSBhbmdsZXM6ICdYWVonIG9yICdZWFonIG9yIGFueSBvdGhlciBjb21iaW5hdGlvbi4KICAgICAqCiAgICAgKiBTZWUge0BsaW5rIGh0dHBzOi8vd3d3Lm1hdGh3b3Jrcy5jb20vbWF0bGFiY2VudHJhbC9maWxlZXhjaGFuZ2UvMjA2OTYtZnVuY3Rpb24tdG8tY29udmVydC1iZXR3ZWVuLWRjbS1ldWxlci1hbmdsZXMtcXVhdGVybmlvbnMtYW5kLWV1bGVyLXZlY3RvcnMgTWF0aFdvcmtzfSByZWZlcmVuY2UKICAgICAqLwoKCiAgICBzZXRGcm9tRXVsZXIoeCwgeSwgeiwgb3JkZXIgPSAnWFlaJykgewogICAgICBjb25zdCBjMSA9IE1hdGguY29zKHggLyAyKTsKICAgICAgY29uc3QgYzIgPSBNYXRoLmNvcyh5IC8gMik7CiAgICAgIGNvbnN0IGMzID0gTWF0aC5jb3MoeiAvIDIpOwogICAgICBjb25zdCBzMSA9IE1hdGguc2luKHggLyAyKTsKICAgICAgY29uc3QgczIgPSBNYXRoLnNpbih5IC8gMik7CiAgICAgIGNvbnN0IHMzID0gTWF0aC5zaW4oeiAvIDIpOwoKICAgICAgaWYgKG9yZGVyID09PSAnWFlaJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyArIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgLSBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyAtIHMxICogczIgKiBzMzsKICAgICAgfSBlbHNlIGlmIChvcmRlciA9PT0gJ1lYWicpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzIC0gczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgKyBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdaWFknKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzIC0gYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyArIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgKyBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzIC0gczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWllYJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgKyBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzIC0gczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyArIHMxICogczIgKiBzMzsKICAgICAgfSBlbHNlIGlmIChvcmRlciA9PT0gJ1laWCcpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzICsgczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgLSBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdYWlknKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzIC0gYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyAtIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgKyBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzICsgczEgKiBzMiAqIHMzOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBjbG9uZSgpIHsKICAgICAgcmV0dXJuIG5ldyBRdWF0ZXJuaW9uKHRoaXMueCwgdGhpcy55LCB0aGlzLnosIHRoaXMudyk7CiAgICB9CiAgICAvKioKICAgICAqIFBlcmZvcm1zIGEgc3BoZXJpY2FsIGxpbmVhciBpbnRlcnBvbGF0aW9uIGJldHdlZW4gdHdvIHF1YXQKICAgICAqCiAgICAgKiBAcGFyYW0gdG9RdWF0IHNlY29uZCBvcGVyYW5kCiAgICAgKiBAcGFyYW0gdCBpbnRlcnBvbGF0aW9uIGFtb3VudCBiZXR3ZWVuIHRoZSBzZWxmIHF1YXRlcm5pb24gYW5kIHRvUXVhdAogICAgICogQHBhcmFtIHRhcmdldCBBIHF1YXRlcm5pb24gdG8gc3RvcmUgdGhlIHJlc3VsdCBpbi4gSWYgbm90IHByb3ZpZGVkLCBhIG5ldyBvbmUgd2lsbCBiZSBjcmVhdGVkLgogICAgICogQHJldHVybnMge1F1YXRlcm5pb259IFRoZSAidGFyZ2V0IiBvYmplY3QKICAgICAqLwoKCiAgICBzbGVycCh0b1F1YXQsIHQsIHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCkpIHsKICAgICAgY29uc3QgYXggPSB0aGlzLng7CiAgICAgIGNvbnN0IGF5ID0gdGhpcy55OwogICAgICBjb25zdCBheiA9IHRoaXMuejsKICAgICAgY29uc3QgYXcgPSB0aGlzLnc7CiAgICAgIGxldCBieCA9IHRvUXVhdC54OwogICAgICBsZXQgYnkgPSB0b1F1YXQueTsKICAgICAgbGV0IGJ6ID0gdG9RdWF0Lno7CiAgICAgIGxldCBidyA9IHRvUXVhdC53OwogICAgICBsZXQgb21lZ2E7CiAgICAgIGxldCBjb3NvbTsKICAgICAgbGV0IHNpbm9tOwogICAgICBsZXQgc2NhbGUwOwogICAgICBsZXQgc2NhbGUxOyAvLyBjYWxjIGNvc2luZQoKICAgICAgY29zb20gPSBheCAqIGJ4ICsgYXkgKiBieSArIGF6ICogYnogKyBhdyAqIGJ3OyAvLyBhZGp1c3Qgc2lnbnMgKGlmIG5lY2Vzc2FyeSkKCiAgICAgIGlmIChjb3NvbSA8IDAuMCkgewogICAgICAgIGNvc29tID0gLWNvc29tOwogICAgICAgIGJ4ID0gLWJ4OwogICAgICAgIGJ5ID0gLWJ5OwogICAgICAgIGJ6ID0gLWJ6OwogICAgICAgIGJ3ID0gLWJ3OwogICAgICB9IC8vIGNhbGN1bGF0ZSBjb2VmZmljaWVudHMKCgogICAgICBpZiAoMS4wIC0gY29zb20gPiAwLjAwMDAwMSkgewogICAgICAgIC8vIHN0YW5kYXJkIGNhc2UgKHNsZXJwKQogICAgICAgIG9tZWdhID0gTWF0aC5hY29zKGNvc29tKTsKICAgICAgICBzaW5vbSA9IE1hdGguc2luKG9tZWdhKTsKICAgICAgICBzY2FsZTAgPSBNYXRoLnNpbigoMS4wIC0gdCkgKiBvbWVnYSkgLyBzaW5vbTsKICAgICAgICBzY2FsZTEgPSBNYXRoLnNpbih0ICogb21lZ2EpIC8gc2lub207CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIHF1YXRlcm5pb25zIGFyZSB2ZXJ5IGNsb3NlCiAgICAgICAgLy8gIC4uLiBzbyB3ZSBjYW4gZG8gYSBsaW5lYXIgaW50ZXJwb2xhdGlvbgogICAgICAgIHNjYWxlMCA9IDEuMCAtIHQ7CiAgICAgICAgc2NhbGUxID0gdDsKICAgICAgfSAvLyBjYWxjdWxhdGUgZmluYWwgdmFsdWVzCgoKICAgICAgdGFyZ2V0LnggPSBzY2FsZTAgKiBheCArIHNjYWxlMSAqIGJ4OwogICAgICB0YXJnZXQueSA9IHNjYWxlMCAqIGF5ICsgc2NhbGUxICogYnk7CiAgICAgIHRhcmdldC56ID0gc2NhbGUwICogYXogKyBzY2FsZTEgKiBiejsKICAgICAgdGFyZ2V0LncgPSBzY2FsZTAgKiBhdyArIHNjYWxlMSAqIGJ3OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBSb3RhdGUgYW4gYWJzb2x1dGUgb3JpZW50YXRpb24gcXVhdGVybmlvbiBnaXZlbiBhbiBhbmd1bGFyIHZlbG9jaXR5IGFuZCBhIHRpbWUgc3RlcC4KICAgICAqLwoKCiAgICBpbnRlZ3JhdGUoYW5ndWxhclZlbG9jaXR5LCBkdCwgYW5ndWxhckZhY3RvciwgdGFyZ2V0ID0gbmV3IFF1YXRlcm5pb24oKSkgewogICAgICBjb25zdCBheCA9IGFuZ3VsYXJWZWxvY2l0eS54ICogYW5ndWxhckZhY3Rvci54LAogICAgICAgICAgICBheSA9IGFuZ3VsYXJWZWxvY2l0eS55ICogYW5ndWxhckZhY3Rvci55LAogICAgICAgICAgICBheiA9IGFuZ3VsYXJWZWxvY2l0eS56ICogYW5ndWxhckZhY3Rvci56LAogICAgICAgICAgICBieCA9IHRoaXMueCwKICAgICAgICAgICAgYnkgPSB0aGlzLnksCiAgICAgICAgICAgIGJ6ID0gdGhpcy56LAogICAgICAgICAgICBidyA9IHRoaXMudzsKICAgICAgY29uc3QgaGFsZl9kdCA9IGR0ICogMC41OwogICAgICB0YXJnZXQueCArPSBoYWxmX2R0ICogKGF4ICogYncgKyBheSAqIGJ6IC0gYXogKiBieSk7CiAgICAgIHRhcmdldC55ICs9IGhhbGZfZHQgKiAoYXkgKiBidyArIGF6ICogYnggLSBheCAqIGJ6KTsKICAgICAgdGFyZ2V0LnogKz0gaGFsZl9kdCAqIChheiAqIGJ3ICsgYXggKiBieSAtIGF5ICogYngpOwogICAgICB0YXJnZXQudyArPSBoYWxmX2R0ICogKC1heCAqIGJ4IC0gYXkgKiBieSAtIGF6ICogYnopOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICB9CgogIGNvbnN0IHNmdl90MSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc2Z2X3QyID0gbmV3IFZlYzMoKTsKICAvKioKICAgKiBUaGUgYXZhaWxhYmxlIHNoYXBlIHR5cGVzLgogICAqLwoKICBjb25zdCBTSEFQRV9UWVBFUyA9IHsKICAgIC8qKiBTUEhFUkUgKi8KICAgIFNQSEVSRTogMSwKCiAgICAvKiogUExBTkUgKi8KICAgIFBMQU5FOiAyLAoKICAgIC8qKiBCT1ggKi8KICAgIEJPWDogNCwKCiAgICAvKiogQ09NUE9VTkQgKi8KICAgIENPTVBPVU5EOiA4LAoKICAgIC8qKiBDT05WRVhQT0xZSEVEUk9OICovCiAgICBDT05WRVhQT0xZSEVEUk9OOiAxNiwKCiAgICAvKiogSEVJR0hURklFTEQgKi8KICAgIEhFSUdIVEZJRUxEOiAzMiwKCiAgICAvKiogUEFSVElDTEUgKi8KICAgIFBBUlRJQ0xFOiA2NCwKCiAgICAvKiogQ1lMSU5ERVIgKi8KICAgIENZTElOREVSOiAxMjgsCgogICAgLyoqIFRSSU1FU0ggKi8KICAgIFRSSU1FU0g6IDI1NgogIH07CiAgLyoqCiAgICogU2hhcGVUeXBlCiAgICovCgogIC8qKgogICAqIEJhc2UgY2xhc3MgZm9yIHNoYXBlcwogICAqLwoKICBjbGFzcyBTaGFwZSB7CiAgICAvKioKICAgICAqIElkZW50aWZpZXIgb2YgdGhlIFNoYXBlLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgdHlwZSBvZiB0aGlzIHNoYXBlLiBNdXN0IGJlIHNldCB0byBhbiBpbnQgPiAwIGJ5IHN1YmNsYXNzZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBsb2NhbCBib3VuZGluZyBzcGhlcmUgcmFkaXVzIG9mIHRoaXMgc2hhcGUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gcHJvZHVjZSBjb250YWN0IGZvcmNlcyB3aGVuIGluIGNvbnRhY3Qgd2l0aCBvdGhlciBib2RpZXMuIE5vdGUgdGhhdCBjb250YWN0cyB3aWxsIGJlIGdlbmVyYXRlZCwgYnV0IHRoZXkgd2lsbCBiZSBkaXNhYmxlZC4KICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBPcHRpb25hbCBtYXRlcmlhbCBvZiB0aGUgc2hhcGUgdGhhdCByZWd1bGF0ZXMgY29udGFjdCBwcm9wZXJ0aWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgYm9keSB0byB3aGljaCB0aGUgc2hhcGUgaXMgYWRkZWQgdG8uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFsbCB0aGUgU2hhcGUgdHlwZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkgewogICAgICB0aGlzLmlkID0gdm9pZCAwOwogICAgICB0aGlzLnR5cGUgPSB2b2lkIDA7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29sbGlzaW9uUmVzcG9uc2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyTWFzayA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXRlcmlhbCA9IHZvaWQgMDsKICAgICAgdGhpcy5ib2R5ID0gdm9pZCAwOwogICAgICB0aGlzLmlkID0gU2hhcGUuaWRDb3VudGVyKys7CiAgICAgIHRoaXMudHlwZSA9IG9wdGlvbnMudHlwZSB8fCAwOwogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gMDsKICAgICAgdGhpcy5jb2xsaXNpb25SZXNwb25zZSA9IG9wdGlvbnMuY29sbGlzaW9uUmVzcG9uc2UgPyBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IG9wdGlvbnMuY29sbGlzaW9uRmlsdGVyR3JvdXAgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuY29sbGlzaW9uRmlsdGVyR3JvdXAgOiAxOwogICAgICB0aGlzLmNvbGxpc2lvbkZpbHRlck1hc2sgPSBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuY29sbGlzaW9uRmlsdGVyTWFzayA6IC0xOwogICAgICB0aGlzLm1hdGVyaWFsID0gb3B0aW9ucy5tYXRlcmlhbCA/IG9wdGlvbnMubWF0ZXJpYWwgOiBudWxsOwogICAgICB0aGlzLmJvZHkgPSBudWxsOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB0aGUgYm91bmRpbmcgc3BoZXJlIHJhZGl1cy4KICAgICAqIFRoZSByZXN1bHQgaXMgc3RvcmVkIGluIHRoZSBwcm9wZXJ0eSBgLmJvdW5kaW5nU3BoZXJlUmFkaXVzYAogICAgICovCgoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aHJvdyAiY29tcHV0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICIgKyB0aGlzLnR5cGU7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgdm9sdW1lIG9mIHRoaXMgc2hhcGUKICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHRocm93ICJ2b2x1bWUoKSBub3QgaW1wbGVtZW50ZWQgZm9yIHNoYXBlIHR5cGUgIiArIHRoaXMudHlwZTsKICAgIH0KICAgIC8qKgogICAgICogQ2FsY3VsYXRlcyB0aGUgaW5lcnRpYSBpbiB0aGUgbG9jYWwgZnJhbWUgZm9yIHRoaXMgc2hhcGUuCiAgICAgKiBAc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTGlzdF9vZl9tb21lbnRzX29mX2luZXJ0aWEKICAgICAqLwoKCiAgICBjYWxjdWxhdGVMb2NhbEluZXJ0aWEobWFzcywgdGFyZ2V0KSB7CiAgICAgIHRocm93ICJjYWxjdWxhdGVMb2NhbEluZXJ0aWEoKSBub3QgaW1wbGVtZW50ZWQgZm9yIHNoYXBlIHR5cGUgIiArIHRoaXMudHlwZTsKICAgIH0KICAgIC8qKgogICAgICogQHRvZG8gdXNlIGFic3RyYWN0IGZvciB0aGVzZSBraW5kIG9mIG1ldGhvZHMKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICB0aHJvdyAiY2FsY3VsYXRlV29ybGRBQUJCKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICIgKyB0aGlzLnR5cGU7CiAgICB9CgogIH0KCiAgU2hhcGUuaWRDb3VudGVyID0gMDsKICBTaGFwZS50eXBlcyA9IFNIQVBFX1RZUEVTOwogIC8qKgogICAqIFRyYW5zZm9ybWF0aW9uIHV0aWxpdGllcy4KICAgKi8KCiAgY2xhc3MgVHJhbnNmb3JtIHsKICAgIC8qKgogICAgICogcG9zaXRpb24KICAgICAqLwoKICAgIC8qKgogICAgICogcXVhdGVybmlvbgogICAgICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHsKICAgICAgdGhpcy5wb3NpdGlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5xdWF0ZXJuaW9uID0gdm9pZCAwOwogICAgICB0aGlzLnBvc2l0aW9uID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgICAgIGlmIChvcHRpb25zLnBvc2l0aW9uKSB7CiAgICAgICAgdGhpcy5wb3NpdGlvbi5jb3B5KG9wdGlvbnMucG9zaXRpb24pOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy5xdWF0ZXJuaW9uKSB7CiAgICAgICAgdGhpcy5xdWF0ZXJuaW9uLmNvcHkob3B0aW9ucy5xdWF0ZXJuaW9uKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSBnbG9iYWwgcG9pbnQgaW4gbG9jYWwgdHJhbnNmb3JtIGNvb3JkaW5hdGVzLgogICAgICovCgoKICAgIHBvaW50VG9Mb2NhbCh3b3JsZFBvaW50LCByZXN1bHQpIHsKICAgICAgcmV0dXJuIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZSh0aGlzLnBvc2l0aW9uLCB0aGlzLnF1YXRlcm5pb24sIHdvcmxkUG9pbnQsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIGxvY2FsIHBvaW50IGluIGdsb2JhbCB0cmFuc2Zvcm0gY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgcG9pbnRUb1dvcmxkKGxvY2FsUG9pbnQsIHJlc3VsdCkgewogICAgICByZXR1cm4gVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRoaXMucG9zaXRpb24sIHRoaXMucXVhdGVybmlvbiwgbG9jYWxQb2ludCwgcmVzdWx0KTsKICAgIH0KICAgIC8qKgogICAgICogdmVjdG9yVG9Xb3JsZEZyYW1lCiAgICAgKi8KCgogICAgdmVjdG9yVG9Xb3JsZEZyYW1lKGxvY2FsVmVjdG9yLCByZXN1bHQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHRoaXMucXVhdGVybmlvbi52bXVsdChsb2NhbFZlY3RvciwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogcG9pbnRUb0xvY2FsRnJhbWUKICAgICAqLwoKCiAgICBzdGF0aWMgcG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXRlcm5pb24sIHdvcmxkUG9pbnQsIHJlc3VsdCA9IG5ldyBWZWMzKCkpIHsKICAgICAgd29ybGRQb2ludC52c3ViKHBvc2l0aW9uLCByZXN1bHQpOwogICAgICBxdWF0ZXJuaW9uLmNvbmp1Z2F0ZSh0bXBRdWF0JDEpOwogICAgICB0bXBRdWF0JDEudm11bHQocmVzdWx0LCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBwb2ludFRvV29ybGRGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyBwb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdGVybmlvbiwgbG9jYWxQb2ludCwgcmVzdWx0ID0gbmV3IFZlYzMoKSkgewogICAgICBxdWF0ZXJuaW9uLnZtdWx0KGxvY2FsUG9pbnQsIHJlc3VsdCk7CiAgICAgIHJlc3VsdC52YWRkKHBvc2l0aW9uLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiB2ZWN0b3JUb1dvcmxkRnJhbWUKICAgICAqLwoKCiAgICBzdGF0aWMgdmVjdG9yVG9Xb3JsZEZyYW1lKHF1YXRlcm5pb24sIGxvY2FsVmVjdG9yLCByZXN1bHQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHF1YXRlcm5pb24udm11bHQobG9jYWxWZWN0b3IsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHZlY3RvclRvTG9jYWxGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyB2ZWN0b3JUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXRlcm5pb24sIHdvcmxkVmVjdG9yLCByZXN1bHQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHF1YXRlcm5pb24udyAqPSAtMTsKICAgICAgcXVhdGVybmlvbi52bXVsdCh3b3JsZFZlY3RvciwgcmVzdWx0KTsKICAgICAgcXVhdGVybmlvbi53ICo9IC0xOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICB9CgogIGNvbnN0IHRtcFF1YXQkMSA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgLyoqCiAgICogQSBzZXQgb2YgcG9seWdvbnMgZGVzY3JpYmluZyBhIGNvbnZleCBzaGFwZS4KICAgKgogICAqIFRoZSBzaGFwZSBNVVNUIGJlIGNvbnZleCBmb3IgdGhlIGNvZGUgdG8gd29yayBwcm9wZXJseS4gTm8gcG9seWdvbnMgbWF5IGJlIGNvcGxhbmFyIChjb250YWluZWQKICAgKiBpbiB0aGUgc2FtZSAzRCBwbGFuZSksIGluc3RlYWQgdGhlc2Ugc2hvdWxkIGJlIG1lcmdlZCBpbnRvIG9uZSBwb2x5Z29uLgogICAqCiAgICogQGF1dGhvciBxaWFvIC8gaHR0cHM6Ly9naXRodWIuY29tL3FpYW8gKG9yaWdpbmFsIGF1dGhvciwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9xaWFvL3RocmVlLmpzL2NvbW1pdC84NTAyNmYwYzc2OWU0MDAwMTQ4YTY3ZDQ1YTllOWI5YzUxMDg4MzZmKQogICAqIEBhdXRob3Igc2NodGVwcGUgLyBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUKICAgKiBAc2VlIGh0dHBzOi8vd3d3LmFsdGRldmJsb2dhZGF5LmNvbS8yMDExLzA1LzEzL2NvbnRhY3QtZ2VuZXJhdGlvbi1iZXR3ZWVuLTNkLWNvbnZleC1tZXNoZXMvCiAgICoKICAgKiBAdG9kbyBNb3ZlIHRoZSBjbGlwcGluZyBmdW5jdGlvbnMgdG8gQ29udGFjdEdlbmVyYXRvcj8KICAgKiBAdG9kbyBBdXRvbWF0aWNhbGx5IG1lcmdlIGNvcGxhbmFyIHBvbHlnb25zIGluIGNvbnN0cnVjdG9yLgogICAqIEBleGFtcGxlCiAgICogICAgIGNvbnN0IGNvbnZleFNoYXBlID0gbmV3IENBTk5PTi5Db252ZXhQb2x5aGVkcm9uKHsgdmVydGljZXMsIGZhY2VzIH0pCiAgICogICAgIGNvbnN0IGNvbnZleEJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoeyBtYXNzOiAxLCBzaGFwZTogY29udmV4U2hhcGUgfSkKICAgKiAgICAgd29ybGQuYWRkQm9keShjb252ZXhCb2R5KQogICAqLwoKICBjbGFzcyBDb252ZXhQb2x5aGVkcm9uIGV4dGVuZHMgU2hhcGUgewogICAgLyoqIHZlcnRpY2VzICovCgogICAgLyoqCiAgICAgKiBBcnJheSBvZiBpbnRlZ2VyIGFycmF5cywgaW5kaWNhdGluZyB3aGljaCB2ZXJ0aWNlcyBlYWNoIGZhY2UgY29uc2lzdHMgb2YKICAgICAqLwoKICAgIC8qKiBmYWNlTm9ybWFscyAqLwoKICAgIC8qKiB3b3JsZFZlcnRpY2VzICovCgogICAgLyoqIHdvcmxkVmVydGljZXNOZWVkc1VwZGF0ZSAqLwoKICAgIC8qKiB3b3JsZEZhY2VOb3JtYWxzICovCgogICAgLyoqIHdvcmxkRmFjZU5vcm1hbHNOZWVkc1VwZGF0ZSAqLwoKICAgIC8qKgogICAgICogSWYgZ2l2ZW4sIHRoZXNlIGxvY2FsbHkgZGVmaW5lZCwgbm9ybWFsaXplZCBheGVzIGFyZSB0aGUgb25seSBvbmVzIGJlaW5nIGNoZWNrZWQgd2hlbiBkb2luZyBzZXBhcmF0aW5nIGF4aXMgY2hlY2suCiAgICAgKi8KCiAgICAvKiogdW5pcXVlRWRnZXMgKi8KCiAgICAvKioKICAgICAqIEBwYXJhbSB2ZXJ0aWNlcyBBbiBhcnJheSBvZiBWZWMzJ3MKICAgICAqIEBwYXJhbSBmYWNlcyBBcnJheSBvZiBpbnRlZ2VyIGFycmF5cywgZGVzY3JpYmluZyB3aGljaCB2ZXJ0aWNlcyB0aGF0IGlzIGluY2x1ZGVkIGluIGVhY2ggZmFjZS4KICAgICAqLwogICAgY29uc3RydWN0b3IocHJvcHMgPSB7fSkgewogICAgICBjb25zdCB7CiAgICAgICAgdmVydGljZXMgPSBbXSwKICAgICAgICBmYWNlcyA9IFtdLAogICAgICAgIG5vcm1hbHMgPSBbXSwKICAgICAgICBheGVzLAogICAgICAgIGJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgIH0gPSBwcm9wczsKICAgICAgc3VwZXIoewogICAgICAgIHR5cGU6IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04KICAgICAgfSk7CiAgICAgIHRoaXMudmVydGljZXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuZmFjZXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuZmFjZU5vcm1hbHMgPSB2b2lkIDA7CiAgICAgIHRoaXMud29ybGRWZXJ0aWNlcyA9IHZvaWQgMDsKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUgPSB2b2lkIDA7CiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFscyA9IHZvaWQgMDsKICAgICAgdGhpcy53b3JsZEZhY2VOb3JtYWxzTmVlZHNVcGRhdGUgPSB2b2lkIDA7CiAgICAgIHRoaXMudW5pcXVlQXhlcyA9IHZvaWQgMDsKICAgICAgdGhpcy51bmlxdWVFZGdlcyA9IHZvaWQgMDsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IHZlcnRpY2VzOwogICAgICB0aGlzLmZhY2VzID0gZmFjZXM7CiAgICAgIHRoaXMuZmFjZU5vcm1hbHMgPSBub3JtYWxzOwoKICAgICAgaWYgKHRoaXMuZmFjZU5vcm1hbHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhpcy5jb21wdXRlTm9ybWFscygpOwogICAgICB9CgogICAgICBpZiAoIWJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSBib3VuZGluZ1NwaGVyZVJhZGl1czsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzID0gW107IC8vIFdvcmxkIHRyYW5zZm9ybWVkIHZlcnNpb24gb2YgLnZlcnRpY2VzCgogICAgICB0aGlzLndvcmxkVmVydGljZXNOZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFscyA9IFtdOyAvLyBXb3JsZCB0cmFuc2Zvcm1lZCB2ZXJzaW9uIG9mIC5mYWNlTm9ybWFscwoKICAgICAgdGhpcy53b3JsZEZhY2VOb3JtYWxzTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICB0aGlzLnVuaXF1ZUF4ZXMgPSBheGVzID8gYXhlcy5zbGljZSgpIDogbnVsbDsKICAgICAgdGhpcy51bmlxdWVFZGdlcyA9IFtdOwogICAgICB0aGlzLmNvbXB1dGVFZGdlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB1bmlxdWVFZGdlcwogICAgICovCgoKICAgIGNvbXB1dGVFZGdlcygpIHsKICAgICAgY29uc3QgZmFjZXMgPSB0aGlzLmZhY2VzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IGVkZ2VzID0gdGhpcy51bmlxdWVFZGdlczsKICAgICAgZWRnZXMubGVuZ3RoID0gMDsKICAgICAgY29uc3QgZWRnZSA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbaV07CiAgICAgICAgY29uc3QgbnVtVmVydGljZXMgPSBmYWNlLmxlbmd0aDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IG51bVZlcnRpY2VzOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGsgPSAoaiArIDEpICUgbnVtVmVydGljZXM7CiAgICAgICAgICB2ZXJ0aWNlc1tmYWNlW2pdXS52c3ViKHZlcnRpY2VzW2ZhY2Vba11dLCBlZGdlKTsKICAgICAgICAgIGVkZ2Uubm9ybWFsaXplKCk7CiAgICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKCiAgICAgICAgICBmb3IgKGxldCBwID0gMDsgcCAhPT0gZWRnZXMubGVuZ3RoOyBwKyspIHsKICAgICAgICAgICAgaWYgKGVkZ2VzW3BdLmFsbW9zdEVxdWFscyhlZGdlKSB8fCBlZGdlc1twXS5hbG1vc3RFcXVhbHMoZWRnZSkpIHsKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWZvdW5kKSB7CiAgICAgICAgICAgIGVkZ2VzLnB1c2goZWRnZS5jbG9uZSgpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFscyBvZiB0aGUgZmFjZXMuCiAgICAgKiBXaWxsIHJldXNlIGV4aXN0aW5nIFZlYzMgb2JqZWN0cyBpbiB0aGUgYGZhY2VOb3JtYWxzYCBhcnJheSBpZiB0aGV5IGV4aXN0LgogICAgICovCgoKICAgIGNvbXB1dGVOb3JtYWxzKCkgewogICAgICB0aGlzLmZhY2VOb3JtYWxzLmxlbmd0aCA9IHRoaXMuZmFjZXMubGVuZ3RoOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBDaGVjayBzbyBhbGwgdmVydGljZXMgZXhpc3RzIGZvciB0aGlzIGZhY2UKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuZmFjZXNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGlmICghdGhpcy52ZXJ0aWNlc1t0aGlzLmZhY2VzW2ldW2pdXSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlZlcnRleCAiICsgdGhpcy5mYWNlc1tpXVtqXSArICIgbm90IGZvdW5kISIpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29uc3QgbiA9IHRoaXMuZmFjZU5vcm1hbHNbaV0gfHwgbmV3IFZlYzMoKTsKICAgICAgICB0aGlzLmdldEZhY2VOb3JtYWwoaSwgbik7CiAgICAgICAgbi5uZWdhdGUobik7CiAgICAgICAgdGhpcy5mYWNlTm9ybWFsc1tpXSA9IG47CiAgICAgICAgY29uc3QgdmVydGV4ID0gdGhpcy52ZXJ0aWNlc1t0aGlzLmZhY2VzW2ldWzBdXTsKCiAgICAgICAgaWYgKG4uZG90KHZlcnRleCkgPCAwKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCIuZmFjZU5vcm1hbHNbIiArIGkgKyAiXSA9IFZlYzMoIiArIG4udG9TdHJpbmcoKSArICIpIGxvb2tzIGxpa2UgaXQgcG9pbnRzIGludG8gdGhlIHNoYXBlPyBUaGUgdmVydGljZXMgZm9sbG93LiBNYWtlIHN1cmUgdGhleSBhcmUgb3JkZXJlZCBDQ1cgYXJvdW5kIHRoZSBub3JtYWwsIHVzaW5nIHRoZSByaWdodCBoYW5kIHJ1bGUuIik7CgogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmZhY2VzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGNvbnNvbGUud2FybigiLnZlcnRpY2VzWyIgKyB0aGlzLmZhY2VzW2ldW2pdICsgIl0gPSBWZWMzKCIgKyB0aGlzLnZlcnRpY2VzW3RoaXMuZmFjZXNbaV1bal1dLnRvU3RyaW5nKCkgKyAiKSIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlIHRoZSBub3JtYWwgb2YgYSBmYWNlIGZyb20gaXRzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgZ2V0RmFjZU5vcm1hbChpLCB0YXJnZXQpIHsKICAgICAgY29uc3QgZiA9IHRoaXMuZmFjZXNbaV07CiAgICAgIGNvbnN0IHZhID0gdGhpcy52ZXJ0aWNlc1tmWzBdXTsKICAgICAgY29uc3QgdmIgPSB0aGlzLnZlcnRpY2VzW2ZbMV1dOwogICAgICBjb25zdCB2YyA9IHRoaXMudmVydGljZXNbZlsyXV07CiAgICAgIENvbnZleFBvbHloZWRyb24uY29tcHV0ZU5vcm1hbCh2YSwgdmIsIHZjLCB0YXJnZXQpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgZmFjZSBub3JtYWwgZ2l2ZW4gMyB2ZXJ0aWNlcwogICAgICovCgoKICAgIHN0YXRpYyBjb21wdXRlTm9ybWFsKHZhLCB2YiwgdmMsIHRhcmdldCkgewogICAgICBjb25zdCBjYiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGFiID0gbmV3IFZlYzMoKTsKICAgICAgdmIudnN1Yih2YSwgYWIpOwogICAgICB2Yy52c3ViKHZiLCBjYik7CiAgICAgIGNiLmNyb3NzKGFiLCB0YXJnZXQpOwoKICAgICAgaWYgKCF0YXJnZXQuaXNaZXJvKCkpIHsKICAgICAgICB0YXJnZXQubm9ybWFsaXplKCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQHBhcmFtIG1pbkRpc3QgQ2xhbXAgZGlzdGFuY2UKICAgICAqIEBwYXJhbSByZXN1bHQgVGhlIGFuIGFycmF5IG9mIGNvbnRhY3QgcG9pbnQgb2JqZWN0cywgc2VlIGNsaXBGYWNlQWdhaW5zdEh1bGwKICAgICAqLwoKCiAgICBjbGlwQWdhaW5zdEh1bGwocG9zQSwgcXVhdEEsIGh1bGxCLCBwb3NCLCBxdWF0Qiwgc2VwYXJhdGluZ05vcm1hbCwgbWluRGlzdCwgbWF4RGlzdCwgcmVzdWx0KSB7CiAgICAgIGNvbnN0IFdvcmxkTm9ybWFsID0gbmV3IFZlYzMoKTsKICAgICAgbGV0IGNsb3Nlc3RGYWNlQiA9IC0xOwogICAgICBsZXQgZG1heCA9IC1OdW1iZXIuTUFYX1ZBTFVFOwoKICAgICAgZm9yIChsZXQgZmFjZSA9IDA7IGZhY2UgPCBodWxsQi5mYWNlcy5sZW5ndGg7IGZhY2UrKykgewogICAgICAgIFdvcmxkTm9ybWFsLmNvcHkoaHVsbEIuZmFjZU5vcm1hbHNbZmFjZV0pOwogICAgICAgIHF1YXRCLnZtdWx0KFdvcmxkTm9ybWFsLCBXb3JsZE5vcm1hbCk7CiAgICAgICAgY29uc3QgZCA9IFdvcmxkTm9ybWFsLmRvdChzZXBhcmF0aW5nTm9ybWFsKTsKCiAgICAgICAgaWYgKGQgPiBkbWF4KSB7CiAgICAgICAgICBkbWF4ID0gZDsKICAgICAgICAgIGNsb3Nlc3RGYWNlQiA9IGZhY2U7CiAgICAgICAgfQogICAgICB9CgogICAgICBjb25zdCB3b3JsZFZlcnRzQjEgPSBbXTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaHVsbEIuZmFjZXNbY2xvc2VzdEZhY2VCXS5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGIgPSBodWxsQi52ZXJ0aWNlc1todWxsQi5mYWNlc1tjbG9zZXN0RmFjZUJdW2ldXTsKICAgICAgICBjb25zdCB3b3JsZGIgPSBuZXcgVmVjMygpOwogICAgICAgIHdvcmxkYi5jb3B5KGIpOwogICAgICAgIHF1YXRCLnZtdWx0KHdvcmxkYiwgd29ybGRiKTsKICAgICAgICBwb3NCLnZhZGQod29ybGRiLCB3b3JsZGIpOwogICAgICAgIHdvcmxkVmVydHNCMS5wdXNoKHdvcmxkYik7CiAgICAgIH0KCiAgICAgIGlmIChjbG9zZXN0RmFjZUIgPj0gMCkgewogICAgICAgIHRoaXMuY2xpcEZhY2VBZ2FpbnN0SHVsbChzZXBhcmF0aW5nTm9ybWFsLCBwb3NBLCBxdWF0QSwgd29ybGRWZXJ0c0IxLCBtaW5EaXN0LCBtYXhEaXN0LCByZXN1bHQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEZpbmQgdGhlIHNlcGFyYXRpbmcgYXhpcyBiZXR3ZWVuIHRoaXMgaHVsbCBhbmQgYW5vdGhlcgogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdGFyZ2V0IHZlY3RvciB0byBzYXZlIHRoZSBheGlzIGluCiAgICAgKiBAcmV0dXJuIFJldHVybnMgZmFsc2UgaWYgYSBzZXBhcmF0aW9uIGlzIGZvdW5kLCBlbHNlIHRydWUKICAgICAqLwoKCiAgICBmaW5kU2VwYXJhdGluZ0F4aXMoaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0QiwgdGFyZ2V0LCBmYWNlTGlzdEEsIGZhY2VMaXN0QikgewogICAgICBjb25zdCBmYWNlQU5vcm1hbFdTMyA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IFdvcmxkbm9ybWFsMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGRlbHRhQyA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkRWRnZTAgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCB3b3JsZEVkZ2UxID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgQ3Jvc3MgPSBuZXcgVmVjMygpOwogICAgICBsZXQgZG1pbiA9IE51bWJlci5NQVhfVkFMVUU7CiAgICAgIGNvbnN0IGh1bGxBID0gdGhpczsKCiAgICAgIGlmICghaHVsbEEudW5pcXVlQXhlcykgewogICAgICAgIGNvbnN0IG51bUZhY2VzQSA9IGZhY2VMaXN0QSA/IGZhY2VMaXN0QS5sZW5ndGggOiBodWxsQS5mYWNlcy5sZW5ndGg7IC8vIFRlc3QgZmFjZSBub3JtYWxzIGZyb20gaHVsbEEKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1GYWNlc0E7IGkrKykgewogICAgICAgICAgY29uc3QgZmkgPSBmYWNlTGlzdEEgPyBmYWNlTGlzdEFbaV0gOiBpOyAvLyBHZXQgd29ybGQgZmFjZSBub3JtYWwKCiAgICAgICAgICBmYWNlQU5vcm1hbFdTMy5jb3B5KGh1bGxBLmZhY2VOb3JtYWxzW2ZpXSk7CiAgICAgICAgICBxdWF0QS52bXVsdChmYWNlQU5vcm1hbFdTMywgZmFjZUFOb3JtYWxXUzMpOwogICAgICAgICAgY29uc3QgZCA9IGh1bGxBLnRlc3RTZXBBeGlzKGZhY2VBTm9ybWFsV1MzLCBodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCKTsKCiAgICAgICAgICBpZiAoZCA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChkIDwgZG1pbikgewogICAgICAgICAgICBkbWluID0gZDsKICAgICAgICAgICAgdGFyZ2V0LmNvcHkoZmFjZUFOb3JtYWxXUzMpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUZXN0IHVuaXF1ZSBheGVzCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IGh1bGxBLnVuaXF1ZUF4ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIC8vIEdldCB3b3JsZCBheGlzCiAgICAgICAgICBxdWF0QS52bXVsdChodWxsQS51bmlxdWVBeGVzW2ldLCBmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICBjb25zdCBkID0gaHVsbEEudGVzdFNlcEF4aXMoZmFjZUFOb3JtYWxXUzMsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgIGlmIChkID09PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICAgIGRtaW4gPSBkOwogICAgICAgICAgICB0YXJnZXQuY29weShmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIWh1bGxCLnVuaXF1ZUF4ZXMpIHsKICAgICAgICAvLyBUZXN0IGZhY2Ugbm9ybWFscyBmcm9tIGh1bGxCCiAgICAgICAgY29uc3QgbnVtRmFjZXNCID0gZmFjZUxpc3RCID8gZmFjZUxpc3RCLmxlbmd0aCA6IGh1bGxCLmZhY2VzLmxlbmd0aDsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1GYWNlc0I7IGkrKykgewogICAgICAgICAgY29uc3QgZmkgPSBmYWNlTGlzdEIgPyBmYWNlTGlzdEJbaV0gOiBpOwogICAgICAgICAgV29ybGRub3JtYWwxLmNvcHkoaHVsbEIuZmFjZU5vcm1hbHNbZmldKTsKICAgICAgICAgIHF1YXRCLnZtdWx0KFdvcmxkbm9ybWFsMSwgV29ybGRub3JtYWwxKTsKICAgICAgICAgIGNvbnN0IGQgPSBodWxsQS50ZXN0U2VwQXhpcyhXb3JsZG5vcm1hbDEsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgIGlmIChkID09PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICAgIGRtaW4gPSBkOwogICAgICAgICAgICB0YXJnZXQuY29weShXb3JsZG5vcm1hbDEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUZXN0IHVuaXF1ZSBheGVzIGluIEIKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gaHVsbEIudW5pcXVlQXhlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgcXVhdEIudm11bHQoaHVsbEIudW5pcXVlQXhlc1tpXSwgV29ybGRub3JtYWwxKTsKICAgICAgICAgIGNvbnN0IGQgPSBodWxsQS50ZXN0U2VwQXhpcyhXb3JsZG5vcm1hbDEsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgIGlmIChkID09PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICAgIGRtaW4gPSBkOwogICAgICAgICAgICB0YXJnZXQuY29weShXb3JsZG5vcm1hbDEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvLyBUZXN0IGVkZ2VzCgoKICAgICAgZm9yIChsZXQgZTAgPSAwOyBlMCAhPT0gaHVsbEEudW5pcXVlRWRnZXMubGVuZ3RoOyBlMCsrKSB7CiAgICAgICAgLy8gR2V0IHdvcmxkIGVkZ2UKICAgICAgICBxdWF0QS52bXVsdChodWxsQS51bmlxdWVFZGdlc1tlMF0sIHdvcmxkRWRnZTApOwoKICAgICAgICBmb3IgKGxldCBlMSA9IDA7IGUxICE9PSBodWxsQi51bmlxdWVFZGdlcy5sZW5ndGg7IGUxKyspIHsKICAgICAgICAgIC8vIEdldCB3b3JsZCBlZGdlIDIKICAgICAgICAgIHF1YXRCLnZtdWx0KGh1bGxCLnVuaXF1ZUVkZ2VzW2UxXSwgd29ybGRFZGdlMSk7CiAgICAgICAgICB3b3JsZEVkZ2UwLmNyb3NzKHdvcmxkRWRnZTEsIENyb3NzKTsKCiAgICAgICAgICBpZiAoIUNyb3NzLmFsbW9zdFplcm8oKSkgewogICAgICAgICAgICBDcm9zcy5ub3JtYWxpemUoKTsKICAgICAgICAgICAgY29uc3QgZGlzdCA9IGh1bGxBLnRlc3RTZXBBeGlzKENyb3NzLCBodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCKTsKCiAgICAgICAgICAgIGlmIChkaXN0ID09PSBmYWxzZSkgewogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGRpc3QgPCBkbWluKSB7CiAgICAgICAgICAgICAgZG1pbiA9IGRpc3Q7CiAgICAgICAgICAgICAgdGFyZ2V0LmNvcHkoQ3Jvc3MpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBwb3NCLnZzdWIocG9zQSwgZGVsdGFDKTsKCiAgICAgIGlmIChkZWx0YUMuZG90KHRhcmdldCkgPiAwLjApIHsKICAgICAgICB0YXJnZXQubmVnYXRlKHRhcmdldCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBUZXN0IHNlcGFyYXRpbmcgYXhpcyBhZ2FpbnN0IHR3byBodWxscy4gQm90aCBodWxscyBhcmUgcHJvamVjdGVkIG9udG8gdGhlIGF4aXMgYW5kIHRoZSBvdmVybGFwIHNpemUgaXMgcmV0dXJuZWQgaWYgdGhlcmUgaXMgb25lLgogICAgICogQHJldHVybiBUaGUgb3ZlcmxhcCBkZXB0aCwgb3IgRkFMU0UgaWYgbm8gcGVuZXRyYXRpb24uCiAgICAgKi8KCgogICAgdGVzdFNlcEF4aXMoYXhpcywgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0QikgewogICAgICBjb25zdCBodWxsQSA9IHRoaXM7CiAgICAgIENvbnZleFBvbHloZWRyb24ucHJvamVjdChodWxsQSwgYXhpcywgcG9zQSwgcXVhdEEsIG1heG1pbkEpOwogICAgICBDb252ZXhQb2x5aGVkcm9uLnByb2plY3QoaHVsbEIsIGF4aXMsIHBvc0IsIHF1YXRCLCBtYXhtaW5CKTsKICAgICAgY29uc3QgbWF4QSA9IG1heG1pbkFbMF07CiAgICAgIGNvbnN0IG1pbkEgPSBtYXhtaW5BWzFdOwogICAgICBjb25zdCBtYXhCID0gbWF4bWluQlswXTsKICAgICAgY29uc3QgbWluQiA9IG1heG1pbkJbMV07CgogICAgICBpZiAobWF4QSA8IG1pbkIgfHwgbWF4QiA8IG1pbkEpIHsKICAgICAgICByZXR1cm4gZmFsc2U7IC8vIFNlcGFyYXRlZAogICAgICB9CgogICAgICBjb25zdCBkMCA9IG1heEEgLSBtaW5COwogICAgICBjb25zdCBkMSA9IG1heEIgLSBtaW5BOwogICAgICBjb25zdCBkZXB0aCA9IGQwIDwgZDEgPyBkMCA6IGQxOwogICAgICByZXR1cm4gZGVwdGg7CiAgICB9CiAgICAvKioKICAgICAqIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYQogICAgICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQpIHsKICAgICAgLy8gQXBwcm94aW1hdGUgd2l0aCBib3ggaW5lcnRpYQogICAgICAvLyBFeGFjdCBpbmVydGlhIGNhbGN1bGF0aW9uIGlzIG92ZXJraWxsLCBidXQgc2VlIGh0dHA6Ly9nZW9tZXRyaWN0b29scy5jb20vRG9jdW1lbnRhdGlvbi9Qb2x5aGVkcmFsTWFzc1Byb3BlcnRpZXMucGRmIGZvciB0aGUgY29ycmVjdCB3YXkgdG8gZG8gaXQKICAgICAgY29uc3QgYWFiYm1heCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGFhYmJtaW4gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIoYWFiYm1pbiwgYWFiYm1heCk7CiAgICAgIGNvbnN0IHggPSBhYWJibWF4LnggLSBhYWJibWluLng7CiAgICAgIGNvbnN0IHkgPSBhYWJibWF4LnkgLSBhYWJibWluLnk7CiAgICAgIGNvbnN0IHogPSBhYWJibWF4LnogLSBhYWJibWluLno7CiAgICAgIHRhcmdldC54ID0gMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHkgKiAyICogeSArIDIgKiB6ICogMiAqIHopOwogICAgICB0YXJnZXQueSA9IDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB4ICogMiAqIHggKyAyICogeiAqIDIgKiB6KTsKICAgICAgdGFyZ2V0LnogPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHggKiAyICogeCk7CiAgICB9CiAgICAvKioKICAgICAqIEBwYXJhbSBmYWNlX2kgSW5kZXggb2YgdGhlIGZhY2UKICAgICAqLwoKCiAgICBnZXRQbGFuZUNvbnN0YW50T2ZGYWNlKGZhY2VfaSkgewogICAgICBjb25zdCBmID0gdGhpcy5mYWNlc1tmYWNlX2ldOwogICAgICBjb25zdCBuID0gdGhpcy5mYWNlTm9ybWFsc1tmYWNlX2ldOwogICAgICBjb25zdCB2ID0gdGhpcy52ZXJ0aWNlc1tmWzBdXTsKICAgICAgY29uc3QgYyA9IC1uLmRvdCh2KTsKICAgICAgcmV0dXJuIGM7CiAgICB9CiAgICAvKioKICAgICAqIENsaXAgYSBmYWNlIGFnYWluc3QgYSBodWxsLgogICAgICogQHBhcmFtIHdvcmxkVmVydHNCMSBBbiBhcnJheSBvZiBWZWMzIHdpdGggdmVydGljZXMgaW4gdGhlIHdvcmxkIGZyYW1lLgogICAgICogQHBhcmFtIG1pbkRpc3QgRGlzdGFuY2UgY2xhbXBpbmcKICAgICAqIEBwYXJhbSBBcnJheSByZXN1bHQgQXJyYXkgdG8gc3RvcmUgcmVzdWx0aW5nIGNvbnRhY3QgcG9pbnRzIGluLiBXaWxsIGJlIG9iamVjdHMgd2l0aCBwcm9wZXJ0aWVzOiBwb2ludCwgZGVwdGgsIG5vcm1hbC4gVGhlc2UgYXJlIHJlcHJlc2VudGVkIGluIHdvcmxkIGNvb3JkaW5hdGVzLgogICAgICovCgoKICAgIGNsaXBGYWNlQWdhaW5zdEh1bGwoc2VwYXJhdGluZ05vcm1hbCwgcG9zQSwgcXVhdEEsIHdvcmxkVmVydHNCMSwgbWluRGlzdCwgbWF4RGlzdCwgcmVzdWx0KSB7CiAgICAgIGNvbnN0IGZhY2VBTm9ybWFsV1MgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBlZGdlMCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IFdvcmxkRWRnZTAgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCB3b3JsZFBsYW5lQW5vcm1hbDEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBwbGFuZU5vcm1hbFdTMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkQTEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBsb2NhbFBsYW5lTm9ybWFsID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGxhbmVOb3JtYWxXUyA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGh1bGxBID0gdGhpczsKICAgICAgY29uc3Qgd29ybGRWZXJ0c0IyID0gW107CiAgICAgIGNvbnN0IHBWdHhJbiA9IHdvcmxkVmVydHNCMTsKICAgICAgY29uc3QgcFZ0eE91dCA9IHdvcmxkVmVydHNCMjsKICAgICAgbGV0IGNsb3Nlc3RGYWNlQSA9IC0xOwogICAgICBsZXQgZG1pbiA9IE51bWJlci5NQVhfVkFMVUU7IC8vIEZpbmQgdGhlIGZhY2Ugd2l0aCBub3JtYWwgY2xvc2VzdCB0byB0aGUgc2VwYXJhdGluZyBheGlzCgogICAgICBmb3IgKGxldCBmYWNlID0gMDsgZmFjZSA8IGh1bGxBLmZhY2VzLmxlbmd0aDsgZmFjZSsrKSB7CiAgICAgICAgZmFjZUFOb3JtYWxXUy5jb3B5KGh1bGxBLmZhY2VOb3JtYWxzW2ZhY2VdKTsKICAgICAgICBxdWF0QS52bXVsdChmYWNlQU5vcm1hbFdTLCBmYWNlQU5vcm1hbFdTKTsKICAgICAgICBjb25zdCBkID0gZmFjZUFOb3JtYWxXUy5kb3Qoc2VwYXJhdGluZ05vcm1hbCk7CgogICAgICAgIGlmIChkIDwgZG1pbikgewogICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICBjbG9zZXN0RmFjZUEgPSBmYWNlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGNsb3Nlc3RGYWNlQSA8IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gR2V0IHRoZSBmYWNlIGFuZCBjb25zdHJ1Y3QgY29ubmVjdGVkIGZhY2VzCgoKICAgICAgY29uc3QgcG9seUEgPSBodWxsQS5mYWNlc1tjbG9zZXN0RmFjZUFdOwogICAgICBwb2x5QS5jb25uZWN0ZWRGYWNlcyA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBodWxsQS5mYWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgaHVsbEEuZmFjZXNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGlmICgKICAgICAgICAgIC8qIFNoYXJpbmcgYSB2ZXJ0ZXgqLwogICAgICAgICAgcG9seUEuaW5kZXhPZihodWxsQS5mYWNlc1tpXVtqXSkgIT09IC0xICYmCiAgICAgICAgICAvKiBOb3QgdGhlIG9uZSB3ZSBhcmUgbG9va2luZyBmb3IgY29ubmVjdGlvbnMgZnJvbSAqLwogICAgICAgICAgaSAhPT0gY2xvc2VzdEZhY2VBICYmCiAgICAgICAgICAvKiBOb3QgYWxyZWFkeSBhZGRlZCAqLwogICAgICAgICAgcG9seUEuY29ubmVjdGVkRmFjZXMuaW5kZXhPZihpKSA9PT0gLTEpIHsKICAgICAgICAgICAgcG9seUEuY29ubmVjdGVkRmFjZXMucHVzaChpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gLy8gQ2xpcCB0aGUgcG9seWdvbiB0byB0aGUgYmFjayBvZiB0aGUgcGxhbmVzIG9mIGFsbCBmYWNlcyBvZiBodWxsIEEsCiAgICAgIC8vIHRoYXQgYXJlIGFkamFjZW50IHRvIHRoZSB3aXRuZXNzIGZhY2UKCgogICAgICBjb25zdCBudW1WZXJ0aWNlc0EgPSBwb2x5QS5sZW5ndGg7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVZlcnRpY2VzQTsgaSsrKSB7CiAgICAgICAgY29uc3QgYSA9IGh1bGxBLnZlcnRpY2VzW3BvbHlBW2ldXTsKICAgICAgICBjb25zdCBiID0gaHVsbEEudmVydGljZXNbcG9seUFbKGkgKyAxKSAlIG51bVZlcnRpY2VzQV1dOwogICAgICAgIGEudnN1YihiLCBlZGdlMCk7CiAgICAgICAgV29ybGRFZGdlMC5jb3B5KGVkZ2UwKTsKICAgICAgICBxdWF0QS52bXVsdChXb3JsZEVkZ2UwLCBXb3JsZEVkZ2UwKTsKICAgICAgICBwb3NBLnZhZGQoV29ybGRFZGdlMCwgV29ybGRFZGdlMCk7CiAgICAgICAgd29ybGRQbGFuZUFub3JtYWwxLmNvcHkodGhpcy5mYWNlTm9ybWFsc1tjbG9zZXN0RmFjZUFdKTsKICAgICAgICBxdWF0QS52bXVsdCh3b3JsZFBsYW5lQW5vcm1hbDEsIHdvcmxkUGxhbmVBbm9ybWFsMSk7CiAgICAgICAgcG9zQS52YWRkKHdvcmxkUGxhbmVBbm9ybWFsMSwgd29ybGRQbGFuZUFub3JtYWwxKTsKICAgICAgICBXb3JsZEVkZ2UwLmNyb3NzKHdvcmxkUGxhbmVBbm9ybWFsMSwgcGxhbmVOb3JtYWxXUzEpOwogICAgICAgIHBsYW5lTm9ybWFsV1MxLm5lZ2F0ZShwbGFuZU5vcm1hbFdTMSk7CiAgICAgICAgd29ybGRBMS5jb3B5KGEpOwogICAgICAgIHF1YXRBLnZtdWx0KHdvcmxkQTEsIHdvcmxkQTEpOwogICAgICAgIHBvc0EudmFkZCh3b3JsZEExLCB3b3JsZEExKTsKICAgICAgICBjb25zdCBvdGhlckZhY2UgPSBwb2x5QS5jb25uZWN0ZWRGYWNlc1tpXTsKICAgICAgICBsb2NhbFBsYW5lTm9ybWFsLmNvcHkodGhpcy5mYWNlTm9ybWFsc1tvdGhlckZhY2VdKTsKICAgICAgICBjb25zdCBsb2NhbFBsYW5lRXEgPSB0aGlzLmdldFBsYW5lQ29uc3RhbnRPZkZhY2Uob3RoZXJGYWNlKTsKICAgICAgICBwbGFuZU5vcm1hbFdTLmNvcHkobG9jYWxQbGFuZU5vcm1hbCk7CiAgICAgICAgcXVhdEEudm11bHQocGxhbmVOb3JtYWxXUywgcGxhbmVOb3JtYWxXUyk7CiAgICAgICAgY29uc3QgcGxhbmVFcVdTID0gbG9jYWxQbGFuZUVxIC0gcGxhbmVOb3JtYWxXUy5kb3QocG9zQSk7IC8vIENsaXAgZmFjZSBhZ2FpbnN0IG91ciBjb25zdHJ1Y3RlZCBwbGFuZQoKICAgICAgICB0aGlzLmNsaXBGYWNlQWdhaW5zdFBsYW5lKHBWdHhJbiwgcFZ0eE91dCwgcGxhbmVOb3JtYWxXUywgcGxhbmVFcVdTKTsgLy8gVGhyb3cgYXdheSBhbGwgY2xpcHBlZCBwb2ludHMsIGJ1dCBzYXZlIHRoZSByZW1haW5pbmcgdW50aWwgbmV4dCBjbGlwCgogICAgICAgIHdoaWxlIChwVnR4SW4ubGVuZ3RoKSB7CiAgICAgICAgICBwVnR4SW4uc2hpZnQoKTsKICAgICAgICB9CgogICAgICAgIHdoaWxlIChwVnR4T3V0Lmxlbmd0aCkgewogICAgICAgICAgcFZ0eEluLnB1c2gocFZ0eE91dC5zaGlmdCgpKTsKICAgICAgICB9CiAgICAgIH0gLy8gb25seSBrZWVwIGNvbnRhY3QgcG9pbnRzIHRoYXQgYXJlIGJlaGluZCB0aGUgd2l0bmVzcyBmYWNlCgoKICAgICAgbG9jYWxQbGFuZU5vcm1hbC5jb3B5KHRoaXMuZmFjZU5vcm1hbHNbY2xvc2VzdEZhY2VBXSk7CiAgICAgIGNvbnN0IGxvY2FsUGxhbmVFcSA9IHRoaXMuZ2V0UGxhbmVDb25zdGFudE9mRmFjZShjbG9zZXN0RmFjZUEpOwogICAgICBwbGFuZU5vcm1hbFdTLmNvcHkobG9jYWxQbGFuZU5vcm1hbCk7CiAgICAgIHF1YXRBLnZtdWx0KHBsYW5lTm9ybWFsV1MsIHBsYW5lTm9ybWFsV1MpOwogICAgICBjb25zdCBwbGFuZUVxV1MgPSBsb2NhbFBsYW5lRXEgLSBwbGFuZU5vcm1hbFdTLmRvdChwb3NBKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcFZ0eEluLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgbGV0IGRlcHRoID0gcGxhbmVOb3JtYWxXUy5kb3QocFZ0eEluW2ldKSArIHBsYW5lRXFXUzsgLy8gPz8/CgogICAgICAgIGlmIChkZXB0aCA8PSBtaW5EaXN0KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiY2xhbXBlZDogZGVwdGg9IiArIGRlcHRoICsgIiB0byBtaW5EaXN0PSIgKyBtaW5EaXN0KTsKICAgICAgICAgIGRlcHRoID0gbWluRGlzdDsKICAgICAgICB9CgogICAgICAgIGlmIChkZXB0aCA8PSBtYXhEaXN0KSB7CiAgICAgICAgICBjb25zdCBwb2ludCA9IHBWdHhJbltpXTsKCiAgICAgICAgICBpZiAoZGVwdGggPD0gMWUtNikgewogICAgICAgICAgICBjb25zdCBwID0gewogICAgICAgICAgICAgIHBvaW50LAogICAgICAgICAgICAgIG5vcm1hbDogcGxhbmVOb3JtYWxXUywKICAgICAgICAgICAgICBkZXB0aAogICAgICAgICAgICB9OwogICAgICAgICAgICByZXN1bHQucHVzaChwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2xpcCBhIGZhY2UgaW4gYSBodWxsIGFnYWluc3QgdGhlIGJhY2sgb2YgYSBwbGFuZS4KICAgICAqIEBwYXJhbSBwbGFuZUNvbnN0YW50IFRoZSBjb25zdGFudCBpbiB0aGUgbWF0aGVtYXRpY2FsIHBsYW5lIGVxdWF0aW9uCiAgICAgKi8KCgogICAgY2xpcEZhY2VBZ2FpbnN0UGxhbmUoaW5WZXJ0aWNlcywgb3V0VmVydGljZXMsIHBsYW5lTm9ybWFsLCBwbGFuZUNvbnN0YW50KSB7CiAgICAgIGxldCBuX2RvdF9maXJzdDsKICAgICAgbGV0IG5fZG90X2xhc3Q7CiAgICAgIGNvbnN0IG51bVZlcnRzID0gaW5WZXJ0aWNlcy5sZW5ndGg7CgogICAgICBpZiAobnVtVmVydHMgPCAyKSB7CiAgICAgICAgcmV0dXJuIG91dFZlcnRpY2VzOwogICAgICB9CgogICAgICBsZXQgZmlyc3RWZXJ0ZXggPSBpblZlcnRpY2VzW2luVmVydGljZXMubGVuZ3RoIC0gMV07CiAgICAgIGxldCBsYXN0VmVydGV4ID0gaW5WZXJ0aWNlc1swXTsKICAgICAgbl9kb3RfZmlyc3QgPSBwbGFuZU5vcm1hbC5kb3QoZmlyc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgIGZvciAobGV0IHZpID0gMDsgdmkgPCBudW1WZXJ0czsgdmkrKykgewogICAgICAgIGxhc3RWZXJ0ZXggPSBpblZlcnRpY2VzW3ZpXTsKICAgICAgICBuX2RvdF9sYXN0ID0gcGxhbmVOb3JtYWwuZG90KGxhc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgICAgaWYgKG5fZG90X2ZpcnN0IDwgMCkgewogICAgICAgICAgaWYgKG5fZG90X2xhc3QgPCAwKSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kIDwgMCwgc28gb3V0cHV0IGxhc3RWZXJ0ZXgKICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIG5ld3YuY29weShsYXN0VmVydGV4KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kID49IDAsIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24KICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIGZpcnN0VmVydGV4LmxlcnAobGFzdFZlcnRleCwgbl9kb3RfZmlyc3QgLyAobl9kb3RfZmlyc3QgLSBuX2RvdF9sYXN0KSwgbmV3dik7CiAgICAgICAgICAgIG91dFZlcnRpY2VzLnB1c2gobmV3dik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChuX2RvdF9sYXN0IDwgMCkgewogICAgICAgICAgICAvLyBTdGFydCA+PSAwLCBlbmQgPCAwIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24gYW5kIGVuZAogICAgICAgICAgICBjb25zdCBuZXd2ID0gbmV3IFZlYzMoKTsKICAgICAgICAgICAgZmlyc3RWZXJ0ZXgubGVycChsYXN0VmVydGV4LCBuX2RvdF9maXJzdCAvIChuX2RvdF9maXJzdCAtIG5fZG90X2xhc3QpLCBuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChsYXN0VmVydGV4KTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZpcnN0VmVydGV4ID0gbGFzdFZlcnRleDsKICAgICAgICBuX2RvdF9maXJzdCA9IG5fZG90X2xhc3Q7CiAgICAgIH0KCiAgICAgIHJldHVybiBvdXRWZXJ0aWNlczsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgLndvcmxkVmVydGljZXNgIGFuZCBzZXRzIGAud29ybGRWZXJ0aWNlc05lZWRzVXBkYXRlYCB0byBmYWxzZS4KICAgICAqLwoKCiAgICBjb21wdXRlV29ybGRWZXJ0aWNlcyhwb3NpdGlvbiwgcXVhdCkgewogICAgICB3aGlsZSAodGhpcy53b3JsZFZlcnRpY2VzLmxlbmd0aCA8IHRoaXMudmVydGljZXMubGVuZ3RoKSB7CiAgICAgICAgdGhpcy53b3JsZFZlcnRpY2VzLnB1c2gobmV3IFZlYzMoKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKICAgICAgY29uc3Qgd29ybGRWZXJ0cyA9IHRoaXMud29ybGRWZXJ0aWNlczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSB0aGlzLnZlcnRpY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgcXVhdC52bXVsdCh2ZXJ0c1tpXSwgd29ybGRWZXJ0c1tpXSk7CiAgICAgICAgcG9zaXRpb24udmFkZCh3b3JsZFZlcnRzW2ldLCB3b3JsZFZlcnRzW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIH0KCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmJtaW4sIGFhYmJtYXgpIHsKICAgICAgY29uc3QgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBhYWJibWluLnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgYWFiYm1heC5zZXQoLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFLCAtTnVtYmVyLk1BWF9WQUxVRSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudmVydGljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gdmVydGljZXNbaV07CgogICAgICAgIGlmICh2LnggPCBhYWJibWluLngpIHsKICAgICAgICAgIGFhYmJtaW4ueCA9IHYueDsKICAgICAgICB9IGVsc2UgaWYgKHYueCA+IGFhYmJtYXgueCkgewogICAgICAgICAgYWFiYm1heC54ID0gdi54OwogICAgICAgIH0KCiAgICAgICAgaWYgKHYueSA8IGFhYmJtaW4ueSkgewogICAgICAgICAgYWFiYm1pbi55ID0gdi55OwogICAgICAgIH0gZWxzZSBpZiAodi55ID4gYWFiYm1heC55KSB7CiAgICAgICAgICBhYWJibWF4LnkgPSB2Lnk7CiAgICAgICAgfQoKICAgICAgICBpZiAodi56IDwgYWFiYm1pbi56KSB7CiAgICAgICAgICBhYWJibWluLnogPSB2Lno7CiAgICAgICAgfSBlbHNlIGlmICh2LnogPiBhYWJibWF4LnopIHsKICAgICAgICAgIGFhYmJtYXgueiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgd29ybGRWZXJ0aWNlc2AgYW5kIHNldHMgYHdvcmxkVmVydGljZXNOZWVkc1VwZGF0ZWAgdG8gZmFsc2UuCiAgICAgKi8KCgogICAgY29tcHV0ZVdvcmxkRmFjZU5vcm1hbHMocXVhdCkgewogICAgICBjb25zdCBOID0gdGhpcy5mYWNlTm9ybWFscy5sZW5ndGg7CgogICAgICB3aGlsZSAodGhpcy53b3JsZEZhY2VOb3JtYWxzLmxlbmd0aCA8IE4pIHsKICAgICAgICB0aGlzLndvcmxkRmFjZU5vcm1hbHMucHVzaChuZXcgVmVjMygpKTsKICAgICAgfQoKICAgICAgY29uc3Qgbm9ybWFscyA9IHRoaXMuZmFjZU5vcm1hbHM7CiAgICAgIGNvbnN0IHdvcmxkTm9ybWFscyA9IHRoaXMud29ybGRGYWNlTm9ybWFsczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBxdWF0LnZtdWx0KG5vcm1hbHNbaV0sIHdvcmxkTm9ybWFsc1tpXSk7CiAgICAgIH0KCiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBub3JtMiA9IHZlcnRzW2ldLmxlbmd0aFNxdWFyZWQoKTsKCiAgICAgICAgaWYgKG5vcm0yID4gbWF4MikgewogICAgICAgICAgbWF4MiA9IG5vcm0yOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IE1hdGguc3FydChtYXgyKTsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlV29ybGRBQUJCCiAgICAgKi8KCgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgY29uc3QgdmVydHMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBsZXQgbWlueDsKICAgICAgbGV0IG1pbnk7CiAgICAgIGxldCBtaW56OwogICAgICBsZXQgbWF4eDsKICAgICAgbGV0IG1heHk7CiAgICAgIGxldCBtYXh6OwogICAgICBsZXQgdGVtcFdvcmxkVmVydGV4ID0gbmV3IFZlYzMoKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0ZW1wV29ybGRWZXJ0ZXguY29weSh2ZXJ0c1tpXSk7CiAgICAgICAgcXVhdC52bXVsdCh0ZW1wV29ybGRWZXJ0ZXgsIHRlbXBXb3JsZFZlcnRleCk7CiAgICAgICAgcG9zLnZhZGQodGVtcFdvcmxkVmVydGV4LCB0ZW1wV29ybGRWZXJ0ZXgpOwogICAgICAgIGNvbnN0IHYgPSB0ZW1wV29ybGRWZXJ0ZXg7CgogICAgICAgIGlmIChtaW54ID09PSB1bmRlZmluZWQgfHwgdi54IDwgbWlueCkgewogICAgICAgICAgbWlueCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh4ID09PSB1bmRlZmluZWQgfHwgdi54ID4gbWF4eCkgewogICAgICAgICAgbWF4eCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtaW55ID09PSB1bmRlZmluZWQgfHwgdi55IDwgbWlueSkgewogICAgICAgICAgbWlueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh5ID09PSB1bmRlZmluZWQgfHwgdi55ID4gbWF4eSkgewogICAgICAgICAgbWF4eSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtaW56ID09PSB1bmRlZmluZWQgfHwgdi56IDwgbWlueikgewogICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh6ID09PSB1bmRlZmluZWQgfHwgdi56ID4gbWF4eikgewogICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG1pbi5zZXQobWlueCwgbWlueSwgbWlueik7CiAgICAgIG1heC5zZXQobWF4eCwgbWF4eSwgbWF4eik7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSBjb252ZXggdm9sdW1lCiAgICAgKi8KCgogICAgdm9sdW1lKCkgewogICAgICByZXR1cm4gNC4wICogTWF0aC5QSSAqIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgLyAzLjA7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBhdmVyYWdlIG9mIGFsbCB0aGUgdmVydGljZXMgcG9zaXRpb25zCiAgICAgKi8KCgogICAgZ2V0QXZlcmFnZVBvaW50TG9jYWwodGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICBjb25zdCB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZlcnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGFyZ2V0LnZhZGQodmVydHNbaV0sIHRhcmdldCk7CiAgICAgIH0KCiAgICAgIHRhcmdldC5zY2FsZSgxIC8gdmVydHMubGVuZ3RoLCB0YXJnZXQpOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBUcmFuc2Zvcm0gYWxsIGxvY2FsIHBvaW50cy4gV2lsbCBjaGFuZ2UgdGhlIC52ZXJ0aWNlcwogICAgICovCgoKICAgIHRyYW5zZm9ybUFsbFBvaW50cyhvZmZzZXQsIHF1YXQpIHsKICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoOwogICAgICBjb25zdCB2ZXJ0cyA9IHRoaXMudmVydGljZXM7IC8vIEFwcGx5IHJvdGF0aW9uCgogICAgICBpZiAocXVhdCkgewogICAgICAgIC8vIFJvdGF0ZSB2ZXJ0aWNlcwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICBjb25zdCB2ID0gdmVydHNbaV07CiAgICAgICAgICBxdWF0LnZtdWx0KHYsIHYpOwogICAgICAgIH0gLy8gUm90YXRlIGZhY2Ugbm9ybWFscwoKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZhY2VOb3JtYWxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBjb25zdCB2ID0gdGhpcy5mYWNlTm9ybWFsc1tpXTsKICAgICAgICAgIHF1YXQudm11bHQodiwgdik7CiAgICAgICAgfQogICAgICAgIC8qCiAgICAgICAgICAgICAgLy8gUm90YXRlIGVkZ2VzCiAgICAgICAgICAgICAgZm9yKGxldCBpPTA7IGk8dGhpcy51bmlxdWVFZGdlcy5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHYgPSB0aGlzLnVuaXF1ZUVkZ2VzW2ldOwogICAgICAgICAgICAgICAgICBxdWF0LnZtdWx0KHYsdik7CiAgICAgICAgICAgICAgfSovCgogICAgICB9IC8vIEFwcGx5IG9mZnNldAoKCiAgICAgIGlmIChvZmZzZXQpIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykgewogICAgICAgICAgY29uc3QgdiA9IHZlcnRzW2ldOwogICAgICAgICAgdi52YWRkKG9mZnNldCwgdik7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrcyB3aGV0aGVyIHAgaXMgaW5zaWRlIHRoZSBwb2x5aGVkcmEuIE11c3QgYmUgaW4gbG9jYWwgY29vcmRzLgogICAgICogVGhlIHBvaW50IGxpZXMgb3V0c2lkZSBvZiB0aGUgY29udmV4IGh1bGwgb2YgdGhlIG90aGVyIHBvaW50cyBpZiBhbmQgb25seSBpZiB0aGUgZGlyZWN0aW9uCiAgICAgKiBvZiBhbGwgdGhlIHZlY3RvcnMgZnJvbSBpdCB0byB0aG9zZSBvdGhlciBwb2ludHMgYXJlIG9uIGxlc3MgdGhhbiBvbmUgaGFsZiBvZiBhIHNwaGVyZSBhcm91bmQgaXQuCiAgICAgKiBAcGFyYW0gcCBBIHBvaW50IGdpdmVuIGluIGxvY2FsIGNvb3JkaW5hdGVzCiAgICAgKi8KCgogICAgcG9pbnRJc0luc2lkZShwKSB7CiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKICAgICAgY29uc3QgZmFjZXMgPSB0aGlzLmZhY2VzOwogICAgICBjb25zdCBub3JtYWxzID0gdGhpcy5mYWNlTm9ybWFsczsKICAgICAgY29uc3QgcG9pbnRJbnNpZGUgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmdldEF2ZXJhZ2VQb2ludExvY2FsKHBvaW50SW5zaWRlKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5mYWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIGxldCBuID0gbm9ybWFsc1tpXTsKICAgICAgICBjb25zdCB2ID0gdmVydHNbZmFjZXNbaV1bMF1dOyAvLyBXZSBvbmx5IG5lZWQgb25lIHBvaW50IGluIHRoZSBmYWNlCiAgICAgICAgLy8gVGhpcyBkb3QgcHJvZHVjdCBkZXRlcm1pbmVzIHdoaWNoIHNpZGUgb2YgdGhlIGVkZ2UgdGhlIHBvaW50IGlzCgogICAgICAgIGNvbnN0IHZUb1AgPSBuZXcgVmVjMygpOwogICAgICAgIHAudnN1Yih2LCB2VG9QKTsKICAgICAgICBjb25zdCByMSA9IG4uZG90KHZUb1ApOwogICAgICAgIGNvbnN0IHZUb1BvaW50SW5zaWRlID0gbmV3IFZlYzMoKTsKICAgICAgICBwb2ludEluc2lkZS52c3ViKHYsIHZUb1BvaW50SW5zaWRlKTsKICAgICAgICBjb25zdCByMiA9IG4uZG90KHZUb1BvaW50SW5zaWRlKTsKCiAgICAgICAgaWYgKHIxIDwgMCAmJiByMiA+IDAgfHwgcjEgPiAwICYmIHIyIDwgMCkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBFbmNvdW50ZXJlZCBzb21lIG90aGVyIHNpZ24uIEV4aXQuCiAgICAgICAgfQogICAgICB9IC8vIElmIHdlIGdvdCBoZXJlLCBhbGwgZG90IHByb2R1Y3RzIHdlcmUgb2YgdGhlIHNhbWUgc2lnbi4KCgogICAgICByZXR1cm4gLTE7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBtYXggYW5kIG1pbiBkb3QgcHJvZHVjdCBvZiBhIGNvbnZleCBodWxsIGF0IHBvc2l0aW9uIChwb3MscXVhdCkgcHJvamVjdGVkIG9udG8gYW4gYXhpcy4KICAgICAqIFJlc3VsdHMgYXJlIHNhdmVkIGluIHRoZSBhcnJheSBtYXhtaW4uCiAgICAgKiBAcGFyYW0gcmVzdWx0IHJlc3VsdFswXSBhbmQgcmVzdWx0WzFdIHdpbGwgYmUgc2V0IHRvIG1heGltdW0gYW5kIG1pbmltdW0sIHJlc3BlY3RpdmVseS4KICAgICAqLwoKCiAgICBzdGF0aWMgcHJvamVjdChzaGFwZSwgYXhpcywgcG9zLCBxdWF0LCByZXN1bHQpIHsKICAgICAgY29uc3QgbiA9IHNoYXBlLnZlcnRpY2VzLmxlbmd0aDsKICAgICAgY29uc3QgbG9jYWxBeGlzID0gcHJvamVjdF9sb2NhbEF4aXM7CiAgICAgIGxldCBtYXggPSAwOwogICAgICBsZXQgbWluID0gMDsKICAgICAgY29uc3QgbG9jYWxPcmlnaW4gPSBwcm9qZWN0X2xvY2FsT3JpZ2luOwogICAgICBjb25zdCB2cyA9IHNoYXBlLnZlcnRpY2VzOwogICAgICBsb2NhbE9yaWdpbi5zZXRaZXJvKCk7IC8vIFRyYW5zZm9ybSB0aGUgYXhpcyB0byBsb2NhbAoKICAgICAgVHJhbnNmb3JtLnZlY3RvclRvTG9jYWxGcmFtZShwb3MsIHF1YXQsIGF4aXMsIGxvY2FsQXhpcyk7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShwb3MsIHF1YXQsIGxvY2FsT3JpZ2luLCBsb2NhbE9yaWdpbik7CiAgICAgIGNvbnN0IGFkZCA9IGxvY2FsT3JpZ2luLmRvdChsb2NhbEF4aXMpOwogICAgICBtaW4gPSBtYXggPSB2c1swXS5kb3QobG9jYWxBeGlzKTsKCiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgY29uc3QgdmFsID0gdnNbaV0uZG90KGxvY2FsQXhpcyk7CgogICAgICAgIGlmICh2YWwgPiBtYXgpIHsKICAgICAgICAgIG1heCA9IHZhbDsKICAgICAgICB9CgogICAgICAgIGlmICh2YWwgPCBtaW4pIHsKICAgICAgICAgIG1pbiA9IHZhbDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG1pbiAtPSBhZGQ7CiAgICAgIG1heCAtPSBhZGQ7CgogICAgICBpZiAobWluID4gbWF4KSB7CiAgICAgICAgLy8gSW5jb25zaXN0ZW50IC0gc3dhcAogICAgICAgIGNvbnN0IHRlbXAgPSBtaW47CiAgICAgICAgbWluID0gbWF4OwogICAgICAgIG1heCA9IHRlbXA7CiAgICAgIH0gLy8gT3V0cHV0CgoKICAgICAgcmVzdWx0WzBdID0gbWF4OwogICAgICByZXN1bHRbMV0gPSBtaW47CiAgICB9CgogIH0KCiAgY29uc3QgbWF4bWluQSA9IFtdOwogIGNvbnN0IG1heG1pbkIgPSBbXTsKICBjb25zdCBwcm9qZWN0X2xvY2FsQXhpcyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcHJvamVjdF9sb2NhbE9yaWdpbiA9IG5ldyBWZWMzKCk7CiAgLyoqCiAgICogQSAzZCBib3ggc2hhcGUuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc2l6ZSA9IDEKICAgKiAgICAgY29uc3QgaGFsZkV4dGVudHMgPSBuZXcgQ0FOTk9OLlZlYzMoc2l6ZSwgc2l6ZSwgc2l6ZSkKICAgKiAgICAgY29uc3QgYm94U2hhcGUgPSBuZXcgQ0FOTk9OLkJveChoYWxmRXh0ZW50cykKICAgKiAgICAgY29uc3QgYm94Qm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBib3hTaGFwZSB9KQogICAqICAgICB3b3JsZC5hZGRCb2R5KGJveEJvZHkpCiAgICovCgogIGNsYXNzIEJveCBleHRlbmRzIFNoYXBlIHsKICAgIC8qKgogICAgICogVGhlIGhhbGYgZXh0ZW50cyBvZiB0aGUgYm94LgogICAgICovCgogICAgLyoqCiAgICAgKiBVc2VkIGJ5IHRoZSBjb250YWN0IGdlbmVyYXRvciB0byBtYWtlIGNvbnRhY3RzIHdpdGggb3RoZXIgY29udmV4IHBvbHloZWRyYSBmb3IgZXhhbXBsZS4KICAgICAqLwogICAgY29uc3RydWN0b3IoaGFsZkV4dGVudHMpIHsKICAgICAgc3VwZXIoewogICAgICAgIHR5cGU6IFNoYXBlLnR5cGVzLkJPWAogICAgICB9KTsKICAgICAgdGhpcy5oYWxmRXh0ZW50cyA9IHZvaWQgMDsKICAgICAgdGhpcy5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuaGFsZkV4dGVudHMgPSBoYWxmRXh0ZW50czsKICAgICAgdGhpcy5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24gPSBudWxsOwogICAgICB0aGlzLnVwZGF0ZUNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbigpOwogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZXMgdGhlIGxvY2FsIGNvbnZleCBwb2x5aGVkcm9uIHJlcHJlc2VudGF0aW9uIHVzZWQgZm9yIHNvbWUgY29sbGlzaW9ucy4KICAgICAqLwoKCiAgICB1cGRhdGVDb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24oKSB7CiAgICAgIGNvbnN0IHN4ID0gdGhpcy5oYWxmRXh0ZW50cy54OwogICAgICBjb25zdCBzeSA9IHRoaXMuaGFsZkV4dGVudHMueTsKICAgICAgY29uc3Qgc3ogPSB0aGlzLmhhbGZFeHRlbnRzLno7CiAgICAgIGNvbnN0IFYgPSBWZWMzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IFtuZXcgVigtc3gsIC1zeSwgLXN6KSwgbmV3IFYoc3gsIC1zeSwgLXN6KSwgbmV3IFYoc3gsIHN5LCAtc3opLCBuZXcgVigtc3gsIHN5LCAtc3opLCBuZXcgVigtc3gsIC1zeSwgc3opLCBuZXcgVihzeCwgLXN5LCBzeiksIG5ldyBWKHN4LCBzeSwgc3opLCBuZXcgVigtc3gsIHN5LCBzeildOwogICAgICBjb25zdCBmYWNlcyA9IFtbMywgMiwgMSwgMF0sIC8vIC16CiAgICAgIFs0LCA1LCA2LCA3XSwgLy8gK3oKICAgICAgWzUsIDQsIDAsIDFdLCAvLyAteQogICAgICBbMiwgMywgNywgNl0sIC8vICt5CiAgICAgIFswLCA0LCA3LCAzXSwgLy8gLXgKICAgICAgWzEsIDIsIDYsIDVdIC8vICt4CiAgICAgIF07CiAgICAgIGNvbnN0IGF4ZXMgPSBbbmV3IFYoMCwgMCwgMSksIG5ldyBWKDAsIDEsIDApLCBuZXcgVigxLCAwLCAwKV07CiAgICAgIGNvbnN0IGggPSBuZXcgQ29udmV4UG9seWhlZHJvbih7CiAgICAgICAgdmVydGljZXMsCiAgICAgICAgZmFjZXMsCiAgICAgICAgYXhlcwogICAgICB9KTsKICAgICAgdGhpcy5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24gPSBoOwogICAgICBoLm1hdGVyaWFsID0gdGhpcy5tYXRlcmlhbDsKICAgIH0KICAgIC8qKgogICAgICogQ2FsY3VsYXRlIHRoZSBpbmVydGlhIG9mIHRoZSBib3guCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCA9IG5ldyBWZWMzKCkpIHsKICAgICAgQm94LmNhbGN1bGF0ZUluZXJ0aWEodGhpcy5oYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KTsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KCiAgICBzdGF0aWMgY2FsY3VsYXRlSW5lcnRpYShoYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGUgPSBoYWxmRXh0ZW50czsKICAgICAgdGFyZ2V0LnggPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnkgPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS54ICogMiAqIGUueCArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnogPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnggKiAyICogZS54KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBib3ggNiBzaWRlIG5vcm1hbHMKICAgICAqIEBwYXJhbSBzaXhUYXJnZXRWZWN0b3JzIEFuIGFycmF5IG9mIDYgdmVjdG9ycywgdG8gc3RvcmUgdGhlIHJlc3VsdGluZyBzaWRlIG5vcm1hbHMgaW4uCiAgICAgKiBAcGFyYW0gcXVhdCBPcmllbnRhdGlvbiB0byBhcHBseSB0byB0aGUgbm9ybWFsIHZlY3RvcnMuIElmIG5vdCBwcm92aWRlZCwgdGhlIHZlY3RvcnMgd2lsbCBiZSBpbiByZXNwZWN0IHRvIHRoZSBsb2NhbCBmcmFtZS4KICAgICAqLwoKCiAgICBnZXRTaWRlTm9ybWFscyhzaXhUYXJnZXRWZWN0b3JzLCBxdWF0KSB7CiAgICAgIGNvbnN0IHNpZGVzID0gc2l4VGFyZ2V0VmVjdG9yczsKICAgICAgY29uc3QgZXggPSB0aGlzLmhhbGZFeHRlbnRzOwogICAgICBzaWRlc1swXS5zZXQoZXgueCwgMCwgMCk7CiAgICAgIHNpZGVzWzFdLnNldCgwLCBleC55LCAwKTsKICAgICAgc2lkZXNbMl0uc2V0KDAsIDAsIGV4LnopOwogICAgICBzaWRlc1szXS5zZXQoLWV4LngsIDAsIDApOwogICAgICBzaWRlc1s0XS5zZXQoMCwgLWV4LnksIDApOwogICAgICBzaWRlc1s1XS5zZXQoMCwgMCwgLWV4LnopOwoKICAgICAgaWYgKHF1YXQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBzaWRlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgcXVhdC52bXVsdChzaWRlc1tpXSwgc2lkZXNbaV0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHNpZGVzOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSB2b2x1bWUgb2YgdGhlIGJveC4KICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA4LjAgKiB0aGlzLmhhbGZFeHRlbnRzLnggKiB0aGlzLmhhbGZFeHRlbnRzLnkgKiB0aGlzLmhhbGZFeHRlbnRzLno7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSB0aGlzLmhhbGZFeHRlbnRzLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBmb3JFYWNoV29ybGRDb3JuZXIKICAgICAqLwoKCiAgICBmb3JFYWNoV29ybGRDb3JuZXIocG9zLCBxdWF0LCBjYWxsYmFjaykgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgY29uc3QgY29ybmVycyA9IFtbZS54LCBlLnksIGUuel0sIFstZS54LCBlLnksIGUuel0sIFstZS54LCAtZS55LCBlLnpdLCBbLWUueCwgLWUueSwgLWUuel0sIFtlLngsIC1lLnksIC1lLnpdLCBbZS54LCBlLnksIC1lLnpdLCBbLWUueCwgZS55LCAtZS56XSwgW2UueCwgLWUueSwgZS56XV07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvcm5lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICB3b3JsZENvcm5lclRlbXBQb3Muc2V0KGNvcm5lcnNbaV1bMF0sIGNvcm5lcnNbaV1bMV0sIGNvcm5lcnNbaV1bMl0pOwogICAgICAgIHF1YXQudm11bHQod29ybGRDb3JuZXJUZW1wUG9zLCB3b3JsZENvcm5lclRlbXBQb3MpOwogICAgICAgIHBvcy52YWRkKHdvcmxkQ29ybmVyVGVtcFBvcywgd29ybGRDb3JuZXJUZW1wUG9zKTsKICAgICAgICBjYWxsYmFjayh3b3JsZENvcm5lclRlbXBQb3MueCwgd29ybGRDb3JuZXJUZW1wUG9zLnksIHdvcmxkQ29ybmVyVGVtcFBvcy56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgd29ybGRDb3JuZXJzVGVtcFswXS5zZXQoZS54LCBlLnksIGUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbMV0uc2V0KC1lLngsIGUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFsyXS5zZXQoLWUueCwgLWUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFszXS5zZXQoLWUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNF0uc2V0KGUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNV0uc2V0KGUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs2XS5zZXQoLWUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs3XS5zZXQoZS54LCAtZS55LCBlLnopOwogICAgICBjb25zdCB3YyA9IHdvcmxkQ29ybmVyc1RlbXBbMF07CiAgICAgIHF1YXQudm11bHQod2MsIHdjKTsKICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgbWF4LmNvcHkod2MpOwogICAgICBtaW4uY29weSh3Yyk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IDg7IGkrKykgewogICAgICAgIGNvbnN0IHdjID0gd29ybGRDb3JuZXJzVGVtcFtpXTsKICAgICAgICBxdWF0LnZtdWx0KHdjLCB3Yyk7CiAgICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgICBjb25zdCB4ID0gd2MueDsKICAgICAgICBjb25zdCB5ID0gd2MueTsKICAgICAgICBjb25zdCB6ID0gd2MuejsKCiAgICAgICAgaWYgKHggPiBtYXgueCkgewogICAgICAgICAgbWF4LnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPiBtYXgueSkgewogICAgICAgICAgbWF4LnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPiBtYXgueikgewogICAgICAgICAgbWF4LnogPSB6OwogICAgICAgIH0KCiAgICAgICAgaWYgKHggPCBtaW4ueCkgewogICAgICAgICAgbWluLnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCBtaW4ueSkgewogICAgICAgICAgbWluLnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPCBtaW4ueikgewogICAgICAgICAgbWluLnogPSB6OwogICAgICAgIH0KICAgICAgfSAvLyBHZXQgZWFjaCBheGlzIG1heAogICAgICAvLyBtaW4uc2V0KEluZmluaXR5LEluZmluaXR5LEluZmluaXR5KTsKICAgICAgLy8gbWF4LnNldCgtSW5maW5pdHksLUluZmluaXR5LC1JbmZpbml0eSk7CiAgICAgIC8vIHRoaXMuZm9yRWFjaFdvcmxkQ29ybmVyKHBvcyxxdWF0LGZ1bmN0aW9uKHgseSx6KXsKICAgICAgLy8gICAgIGlmKHggPiBtYXgueCl7CiAgICAgIC8vICAgICAgICAgbWF4LnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA+IG1heC55KXsKICAgICAgLy8gICAgICAgICBtYXgueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6ID4gbWF4LnopewogICAgICAvLyAgICAgICAgIG1heC56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gICAgIGlmKHggPCBtaW4ueCl7CiAgICAgIC8vICAgICAgICAgbWluLnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA8IG1pbi55KXsKICAgICAgLy8gICAgICAgICBtaW4ueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6IDwgbWluLnopewogICAgICAvLyAgICAgICAgIG1pbi56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gfSk7CgogICAgfQoKICB9CgogIGNvbnN0IHdvcmxkQ29ybmVyVGVtcFBvcyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgd29ybGRDb3JuZXJzVGVtcCA9IFtuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpXTsKICAvKioKICAgKiBCT0RZX1RZUEVTCiAgICovCgogIGNvbnN0IEJPRFlfVFlQRVMgPSB7CiAgICAvKiogRFlOQU1JQyAqLwogICAgRFlOQU1JQzogMSwKCiAgICAvKiogU1RBVElDICovCiAgICBTVEFUSUM6IDIsCgogICAgLyoqIEtJTkVNQVRJQyAqLwogICAgS0lORU1BVElDOiA0CiAgfTsKICAvKioKICAgKiBCb2R5VHlwZQogICAqLwoKICAvKioKICAgKiBCT0RZX1NMRUVQX1NUQVRFUwogICAqLwoKICBjb25zdCBCT0RZX1NMRUVQX1NUQVRFUyA9IHsKICAgIC8qKiBBV0FLRSAqLwogICAgQVdBS0U6IDAsCgogICAgLyoqIFNMRUVQWSAqLwogICAgU0xFRVBZOiAxLAoKICAgIC8qKiBTTEVFUElORyAqLwogICAgU0xFRVBJTkc6IDIKICB9OwogIC8qKgogICAqIEJvZHlTbGVlcFN0YXRlCiAgICovCgogIC8qKgogICAqIEJhc2UgY2xhc3MgZm9yIGFsbCBib2R5IHR5cGVzLgogICAqIEBleGFtcGxlCiAgICogICAgIGNvbnN0IHNoYXBlID0gbmV3IENBTk5PTi5TcGhlcmUoMSkKICAgKiAgICAgY29uc3QgYm9keSA9IG5ldyBDQU5OT04uQm9keSh7CiAgICogICAgICAgbWFzczogMSwKICAgKiAgICAgICBzaGFwZSwKICAgKiAgICAgfSkKICAgKiAgICAgd29ybGQuYWRkQm9keShib2R5KQogICAqLwoKICBjbGFzcyBCb2R5IGV4dGVuZHMgRXZlbnRUYXJnZXQgewogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIHR3byBib2RpZXMgY29sbGlkZS4gVGhpcyBldmVudCBpcyBkaXNwYXRjaGVkIG9uIGVhY2gKICAgICAqIG9mIHRoZSB0d28gYm9kaWVzIGludm9sdmVkIGluIHRoZSBjb2xsaXNpb24uCiAgICAgKiBAZXZlbnQgY29sbGlkZQogICAgICogQHBhcmFtIGJvZHkgVGhlIGJvZHkgdGhhdCB3YXMgaW52b2x2ZWQgaW4gdGhlIGNvbGxpc2lvbi4KICAgICAqIEBwYXJhbSBjb250YWN0IFRoZSBkZXRhaWxzIG9mIHRoZSBjb2xsaXNpb24uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEEgZHluYW1pYyBib2R5IGlzIGZ1bGx5IHNpbXVsYXRlZC4gQ2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHRoZSB1c2VyLCBidXQgbm9ybWFsbHkgdGhleSBtb3ZlIGFjY29yZGluZyB0byBmb3JjZXMuIEEgZHluYW1pYyBib2R5IGNhbiBjb2xsaWRlIHdpdGggYWxsIGJvZHkgdHlwZXMuIEEgZHluYW1pYyBib2R5IGFsd2F5cyBoYXMgZmluaXRlLCBub24temVybyBtYXNzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIHN0YXRpYyBib2R5IGRvZXMgbm90IG1vdmUgZHVyaW5nIHNpbXVsYXRpb24gYW5kIGJlaGF2ZXMgYXMgaWYgaXQgaGFzIGluZmluaXRlIG1hc3MuIFN0YXRpYyBib2RpZXMgY2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHNldHRpbmcgdGhlIHBvc2l0aW9uIG9mIHRoZSBib2R5LiBUaGUgdmVsb2NpdHkgb2YgYSBzdGF0aWMgYm9keSBpcyBhbHdheXMgemVyby4gU3RhdGljIGJvZGllcyBkbyBub3QgY29sbGlkZSB3aXRoIG90aGVyIHN0YXRpYyBvciBraW5lbWF0aWMgYm9kaWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIGtpbmVtYXRpYyBib2R5IG1vdmVzIHVuZGVyIHNpbXVsYXRpb24gYWNjb3JkaW5nIHRvIGl0cyB2ZWxvY2l0eS4gVGhleSBkbyBub3QgcmVzcG9uZCB0byBmb3JjZXMuIFRoZXkgY2FuIGJlIG1vdmVkIG1hbnVhbGx5LCBidXQgbm9ybWFsbHkgYSBraW5lbWF0aWMgYm9keSBpcyBtb3ZlZCBieSBzZXR0aW5nIGl0cyB2ZWxvY2l0eS4gQSBraW5lbWF0aWMgYm9keSBiZWhhdmVzIGFzIGlmIGl0IGhhcyBpbmZpbml0ZSBtYXNzLiBLaW5lbWF0aWMgYm9kaWVzIGRvIG5vdCBjb2xsaWRlIHdpdGggb3RoZXIgc3RhdGljIG9yIGtpbmVtYXRpYyBib2RpZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFXQUtFCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNMRUVQWQogICAgICovCgogICAgLyoqCiAgICAgKiBTTEVFUElORwogICAgICovCgogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIGEgc2xlZXBpbmcgYm9keSBoYXMgd29rZW4gdXAuCiAgICAgKiBAZXZlbnQgd2FrZXVwCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBnb25lIGluIHRvIHRoZSBzbGVlcHkgc3RhdGUuCiAgICAgKiBAZXZlbnQgc2xlZXB5CiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBmYWxsZW4gYXNsZWVwLgogICAgICogQGV2ZW50IHNsZWVwCiAgICAgKi8KCiAgICAvKioKICAgICAqIElkZW50aWZpZXIgb2YgdGhlIGJvZHkuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFBvc2l0aW9uIG9mIGJvZHkgaW4gV29ybGQuYm9kaWVzLiBVcGRhdGVkIGJ5IFdvcmxkIGFuZCB1c2VkIGluIEFycmF5Q29sbGlzaW9uTWF0cml4LgogICAgICovCgogICAgLyoqCiAgICAgKiBSZWZlcmVuY2UgdG8gdGhlIHdvcmxkIHRoZSBib2R5IGlzIGxpdmluZyBpbi4KICAgICAqLwoKICAgIC8qKgogICAgICogQ2FsbGJhY2sgZnVuY3Rpb24gdGhhdCBpcyB1c2VkIEJFRk9SRSBzdGVwcGluZyB0aGUgc3lzdGVtLiBVc2UgaXQgdG8gYXBwbHkgZm9yY2VzLCBmb3IgZXhhbXBsZS4gSW5zaWRlIHRoZSBmdW5jdGlvbiwgInRoaXMiIHdpbGwgcmVmZXIgdG8gdGhpcyBCb2R5IG9iamVjdC4gRGVwcmVjYXRlZCAtIHVzZSBXb3JsZCBldmVudHMgaW5zdGVhZC4KICAgICAqIEBkZXByZWNhdGVkIFVzZSBXb3JsZCBldmVudHMgaW5zdGVhZAogICAgICovCgogICAgLyoqCiAgICAgKiBDYWxsYmFjayBmdW5jdGlvbiB0aGF0IGlzIHVzZWQgQUZURVIgc3RlcHBpbmcgdGhlIHN5c3RlbS4gSW5zaWRlIHRoZSBmdW5jdGlvbiwgInRoaXMiIHdpbGwgcmVmZXIgdG8gdGhpcyBCb2R5IG9iamVjdC4gRGVwcmVjYXRlZCAtIHVzZSBXb3JsZCBldmVudHMgaW5zdGVhZC4KICAgICAqIEBkZXByZWNhdGVkIFVzZSBXb3JsZCBldmVudHMgaW5zdGVhZAogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgY29sbGlzaW9uIGdyb3VwIHRoZSBib2R5IGJlbG9uZ3MgdG8uCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBjb2xsaXNpb24gZ3JvdXAgdGhlIGJvZHkgY2FuIGNvbGxpZGUgd2l0aC4KICAgICAqIEBkZWZhdWx0IC0xCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gcHJvZHVjZSBjb250YWN0IGZvcmNlcyB3aGVuIGluIGNvbnRhY3Qgd2l0aCBvdGhlciBib2RpZXMuIE5vdGUgdGhhdCBjb250YWN0cyB3aWxsIGJlIGdlbmVyYXRlZCwgYnV0IHRoZXkgd2lsbCBiZSBkaXNhYmxlZCAtIGkuZS4gImNvbGxpZGUiIGV2ZW50cyB3aWxsIGJlIHJhaXNlZCwgYnV0IGZvcmNlcyB3aWxsIG5vdCBiZSBhbHRlcmVkLgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBzcGFjZSBwb3NpdGlvbiBvZiB0aGUgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogSW50ZXJwb2xhdGVkIHBvc2l0aW9uIG9mIHRoZSBib2R5LgogICAgICovCgogICAgLyoqCiAgICAgKiBJbml0aWFsIHBvc2l0aW9uIG9mIHRoZSBib2R5LgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBzcGFjZSB2ZWxvY2l0eSBvZiB0aGUgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogSW5pdGlhbCB2ZWxvY2l0eSBvZiB0aGUgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogTGluZWFyIGZvcmNlIG9uIHRoZSBib2R5IGluIHdvcmxkIHNwYWNlLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgbWFzcyBvZiB0aGUgYm9keS4KICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHBoeXNpY3MgbWF0ZXJpYWwgb2YgdGhlIGJvZHkuIEl0IGRlZmluZXMgdGhlIGJvZHkgaW50ZXJhY3Rpb24gd2l0aCBvdGhlciBib2RpZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEhvdyBtdWNoIHRvIGRhbXAgdGhlIGJvZHkgdmVsb2NpdHkgZWFjaCBzdGVwLiBJdCBjYW4gZ28gZnJvbSAwIHRvIDEuCiAgICAgKiBAZGVmYXVsdCAwLjAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIE9uZSBvZjogYEJvZHkuRFlOQU1JQ2AsIGBCb2R5LlNUQVRJQ2AgYW5kIGBCb2R5LktJTkVNQVRJQ2AuCiAgICAgKi8KCiAgICAvKioKICAgICAqIElmIHRydWUsIHRoZSBib2R5IHdpbGwgYXV0b21hdGljYWxseSBmYWxsIHRvIHNsZWVwLgogICAgICogQGRlZmF1bHQgdHJ1ZQogICAgICovCgogICAgLyoqCiAgICAgKiBDdXJyZW50IHNsZWVwIHN0YXRlLgogICAgICovCgogICAgLyoqCiAgICAgKiBJZiB0aGUgc3BlZWQgKHRoZSBub3JtIG9mIHRoZSB2ZWxvY2l0eSkgaXMgc21hbGxlciB0aGFuIHRoaXMgdmFsdWUsIHRoZSBib2R5IGlzIGNvbnNpZGVyZWQgc2xlZXB5LgogICAgICogQGRlZmF1bHQgMC4xCiAgICAgKi8KCiAgICAvKioKICAgICAqIElmIHRoZSBib2R5IGhhcyBiZWVuIHNsZWVweSBmb3IgdGhpcyBzbGVlcFRpbWVMaW1pdCBzZWNvbmRzLCBpdCBpcyBjb25zaWRlcmVkIHNsZWVwaW5nLgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBzcGFjZSByb3RhdGlvbmFsIGZvcmNlIG9uIHRoZSBib2R5LCBhcm91bmQgY2VudGVyIG9mIG1hc3MuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdvcmxkIHNwYWNlIG9yaWVudGF0aW9uIG9mIHRoZSBib2R5LgogICAgICovCgogICAgLyoqCiAgICAgKiBJbml0aWFsIHF1YXRlcm5pb24gb2YgdGhlIGJvZHkuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEludGVycG9sYXRlZCBvcmllbnRhdGlvbiBvZiB0aGUgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogQW5ndWxhciB2ZWxvY2l0eSBvZiB0aGUgYm9keSwgaW4gd29ybGQgc3BhY2UuIFRoaW5rIG9mIHRoZSBhbmd1bGFyIHZlbG9jaXR5IGFzIGEgdmVjdG9yLCB3aGljaCB0aGUgYm9keSByb3RhdGVzIGFyb3VuZC4gVGhlIGxlbmd0aCBvZiB0aGlzIHZlY3RvciBkZXRlcm1pbmVzIGhvdyBmYXN0IChpbiByYWRpYW5zIHBlciBzZWNvbmQpIHRoZSBib2R5IHJvdGF0ZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEluaXRpYWwgYW5ndWxhciB2ZWxvY2l0eSBvZiB0aGUgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogTGlzdCBvZiBTaGFwZXMgdGhhdCBoYXZlIGJlZW4gYWRkZWQgdG8gdGhlIGJvZHkuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFBvc2l0aW9uIG9mIGVhY2ggU2hhcGUgaW4gdGhlIGJvZHksIGdpdmVuIGluIGxvY2FsIEJvZHkgc3BhY2UuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE9yaWVudGF0aW9uIG9mIGVhY2ggU2hhcGUsIGdpdmVuIGluIGxvY2FsIEJvZHkgc3BhY2UuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBpbmVydGlhIG9mIHRoZSBib2R5LgogICAgICovCgogICAgLyoqCiAgICAgKiBTZXQgdG8gdHJ1ZSBpZiB5b3UgZG9uJ3Qgd2FudCB0aGUgYm9keSB0byByb3RhdGUuIE1ha2Ugc3VyZSB0byBydW4gLnVwZGF0ZU1hc3NQcm9wZXJ0aWVzKCkgaWYgeW91IGNoYW5nZSB0aGlzIGFmdGVyIHRoZSBib2R5IGNyZWF0aW9uLgogICAgICogQGRlZmF1bHQgZmFsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogSG93IG11Y2ggdG8gZGFtcCB0aGUgYm9keSBhbmd1bGFyIHZlbG9jaXR5IGVhY2ggc3RlcC4gSXQgY2FuIGdvIGZyb20gMCB0byAxLgogICAgICogQGRlZmF1bHQgMC4wMQogICAgICovCgogICAgLyoqCiAgICAgKiBVc2UgdGhpcyBwcm9wZXJ0eSB0byBsaW1pdCB0aGUgbW90aW9uIGFsb25nIGFueSB3b3JsZCBheGlzLiAoMSwxLDEpIHdpbGwgYWxsb3cgbW90aW9uIGFsb25nIGFsbCBheGVzIHdoaWxlICgwLDAsMCkgYWxsb3dzIG5vbmUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZSB0aGlzIHByb3BlcnR5IHRvIGxpbWl0IHRoZSByb3RhdGlvbmFsIG1vdGlvbiBhbG9uZyBhbnkgd29ybGQgYXhpcy4gKDEsMSwxKSB3aWxsIGFsbG93IHJvdGF0aW9uIGFsb25nIGFsbCBheGVzIHdoaWxlICgwLDAsMCkgYWxsb3dzIG5vbmUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdvcmxkIHNwYWNlIGJvdW5kaW5nIGJveCBvZiB0aGUgYm9keSBhbmQgaXRzIHNoYXBlcy4KICAgICAqLwoKICAgIC8qKgogICAgICogSW5kaWNhdGVzIGlmIHRoZSBBQUJCIG5lZWRzIHRvIGJlIHVwZGF0ZWQgYmVmb3JlIHVzZS4KICAgICAqLwoKICAgIC8qKgogICAgICogVG90YWwgYm91bmRpbmcgcmFkaXVzIG9mIHRoZSBCb2R5IGluY2x1ZGluZyBpdHMgc2hhcGVzLCByZWxhdGl2ZSB0byBib2R5LnBvc2l0aW9uLgogICAgICovCgogICAgLyoqCiAgICAgKiBXaGVuIHRydWUgdGhlIGJvZHkgYmVoYXZlcyBsaWtlIGEgdHJpZ2dlci4gSXQgZG9lcyBub3QgY29sbGlkZQogICAgICogd2l0aCBvdGhlciBib2RpZXMgYnV0IGNvbGxpc2lvbiBldmVudHMgYXJlIHN0aWxsIHRyaWdnZXJlZC4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkgewogICAgICBzdXBlcigpOwogICAgICB0aGlzLmlkID0gdm9pZCAwOwogICAgICB0aGlzLmluZGV4ID0gdm9pZCAwOwogICAgICB0aGlzLndvcmxkID0gdm9pZCAwOwogICAgICB0aGlzLnByZVN0ZXAgPSB2b2lkIDA7CiAgICAgIHRoaXMucG9zdFN0ZXAgPSB2b2lkIDA7CiAgICAgIHRoaXMudmxhbWJkYSA9IHZvaWQgMDsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IHZvaWQgMDsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gdm9pZCAwOwogICAgICB0aGlzLmNvbGxpc2lvblJlc3BvbnNlID0gdm9pZCAwOwogICAgICB0aGlzLnBvc2l0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLnByZXZpb3VzUG9zaXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuaW50ZXJwb2xhdGVkUG9zaXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuaW5pdFBvc2l0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLnZlbG9jaXR5ID0gdm9pZCAwOwogICAgICB0aGlzLmluaXRWZWxvY2l0eSA9IHZvaWQgMDsKICAgICAgdGhpcy5mb3JjZSA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXNzID0gdm9pZCAwOwogICAgICB0aGlzLmludk1hc3MgPSB2b2lkIDA7CiAgICAgIHRoaXMubWF0ZXJpYWwgPSB2b2lkIDA7CiAgICAgIHRoaXMubGluZWFyRGFtcGluZyA9IHZvaWQgMDsKICAgICAgdGhpcy50eXBlID0gdm9pZCAwOwogICAgICB0aGlzLmFsbG93U2xlZXAgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2xlZXBTdGF0ZSA9IHZvaWQgMDsKICAgICAgdGhpcy5zbGVlcFNwZWVkTGltaXQgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2xlZXBUaW1lTGltaXQgPSB2b2lkIDA7CiAgICAgIHRoaXMudGltZUxhc3RTbGVlcHkgPSB2b2lkIDA7CiAgICAgIHRoaXMud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHZvaWQgMDsKICAgICAgdGhpcy50b3JxdWUgPSB2b2lkIDA7CiAgICAgIHRoaXMucXVhdGVybmlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5pbml0UXVhdGVybmlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5wcmV2aW91c1F1YXRlcm5pb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuaW50ZXJwb2xhdGVkUXVhdGVybmlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkgPSB2b2lkIDA7CiAgICAgIHRoaXMuaW5pdEFuZ3VsYXJWZWxvY2l0eSA9IHZvaWQgMDsKICAgICAgdGhpcy5zaGFwZXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2hhcGVPZmZzZXRzID0gdm9pZCAwOwogICAgICB0aGlzLnNoYXBlT3JpZW50YXRpb25zID0gdm9pZCAwOwogICAgICB0aGlzLmluZXJ0aWEgPSB2b2lkIDA7CiAgICAgIHRoaXMuaW52SW5lcnRpYSA9IHZvaWQgMDsKICAgICAgdGhpcy5pbnZJbmVydGlhV29ybGQgPSB2b2lkIDA7CiAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gdm9pZCAwOwogICAgICB0aGlzLmludkluZXJ0aWFTb2x2ZSA9IHZvaWQgMDsKICAgICAgdGhpcy5pbnZJbmVydGlhV29ybGRTb2x2ZSA9IHZvaWQgMDsKICAgICAgdGhpcy5maXhlZFJvdGF0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLmFuZ3VsYXJEYW1waW5nID0gdm9pZCAwOwogICAgICB0aGlzLmxpbmVhckZhY3RvciA9IHZvaWQgMDsKICAgICAgdGhpcy5hbmd1bGFyRmFjdG9yID0gdm9pZCAwOwogICAgICB0aGlzLmFhYmIgPSB2b2lkIDA7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdm9pZCAwOwogICAgICB0aGlzLmJvdW5kaW5nUmFkaXVzID0gdm9pZCAwOwogICAgICB0aGlzLndsYW1iZGEgPSB2b2lkIDA7CiAgICAgIHRoaXMuaXNUcmlnZ2VyID0gdm9pZCAwOwogICAgICB0aGlzLmlkID0gQm9keS5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5pbmRleCA9IC0xOwogICAgICB0aGlzLndvcmxkID0gbnVsbDsKICAgICAgdGhpcy5wcmVTdGVwID0gbnVsbDsKICAgICAgdGhpcy5wb3N0U3RlcCA9IG51bGw7CiAgICAgIHRoaXMudmxhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gdHlwZW9mIG9wdGlvbnMuY29sbGlzaW9uRmlsdGVyTWFzayA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgOiAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlID09PSAnYm9vbGVhbicgPyBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKICAgICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucHJldmlvdXNQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaW50ZXJwb2xhdGVkUG9zaXRpb24gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmluaXRQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5wb3NpdGlvbikgewogICAgICAgIHRoaXMucG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLnByZXZpb3VzUG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFBvc2l0aW9uLmNvcHkob3B0aW9ucy5wb3NpdGlvbik7CiAgICAgICAgdGhpcy5pbml0UG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgfQoKICAgICAgdGhpcy52ZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy52ZWxvY2l0eSkgewogICAgICAgIHRoaXMudmVsb2NpdHkuY29weShvcHRpb25zLnZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0VmVsb2NpdHkgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmZvcmNlID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgbWFzcyA9IHR5cGVvZiBvcHRpb25zLm1hc3MgPT09ICdudW1iZXInID8gb3B0aW9ucy5tYXNzIDogMDsKICAgICAgdGhpcy5tYXNzID0gbWFzczsKICAgICAgdGhpcy5pbnZNYXNzID0gbWFzcyA+IDAgPyAxLjAgLyBtYXNzIDogMDsKICAgICAgdGhpcy5tYXRlcmlhbCA9IG9wdGlvbnMubWF0ZXJpYWwgfHwgbnVsbDsKICAgICAgdGhpcy5saW5lYXJEYW1waW5nID0gdHlwZW9mIG9wdGlvbnMubGluZWFyRGFtcGluZyA9PT0gJ251bWJlcicgPyBvcHRpb25zLmxpbmVhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLnR5cGUgPSBtYXNzIDw9IDAuMCA/IEJvZHkuU1RBVElDIDogQm9keS5EWU5BTUlDOwoKICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnR5cGUgPT09IHR5cGVvZiBCb2R5LlNUQVRJQykgewogICAgICAgIHRoaXMudHlwZSA9IG9wdGlvbnMudHlwZTsKICAgICAgfQoKICAgICAgdGhpcy5hbGxvd1NsZWVwID0gdHlwZW9mIG9wdGlvbnMuYWxsb3dTbGVlcCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFsbG93U2xlZXAgOiB0cnVlOwogICAgICB0aGlzLnNsZWVwU3RhdGUgPSBCb2R5LkFXQUtFOwogICAgICB0aGlzLnNsZWVwU3BlZWRMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCA6IDAuMTsKICAgICAgdGhpcy5zbGVlcFRpbWVMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwVGltZUxpbWl0ICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuc2xlZXBUaW1lTGltaXQgOiAxOwogICAgICB0aGlzLnRpbWVMYXN0U2xlZXB5ID0gMDsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICAgIHRoaXMudG9ycXVlID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbml0UXVhdGVybmlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbnRlcnBvbGF0ZWRRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgICAgIGlmIChvcHRpb25zLnF1YXRlcm5pb24pIHsKICAgICAgICB0aGlzLnF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMuaW5pdFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uLmNvcHkob3B0aW9ucy5xdWF0ZXJuaW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICB9CgogICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5hbmd1bGFyVmVsb2NpdHkpIHsKICAgICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5jb3B5KG9wdGlvbnMuYW5ndWxhclZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0QW5ndWxhclZlbG9jaXR5ID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5zaGFwZXMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9mZnNldHMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9yaWVudGF0aW9ucyA9IFtdOwogICAgICB0aGlzLmluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZCA9IG5ldyBNYXQzKCk7CiAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gMDsKICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlID0gbmV3IE1hdDMoKTsKICAgICAgdGhpcy5maXhlZFJvdGF0aW9uID0gdHlwZW9mIG9wdGlvbnMuZml4ZWRSb3RhdGlvbiAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmZpeGVkUm90YXRpb24gOiBmYWxzZTsKICAgICAgdGhpcy5hbmd1bGFyRGFtcGluZyA9IHR5cGVvZiBvcHRpb25zLmFuZ3VsYXJEYW1waW5nICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuYW5ndWxhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLmxpbmVhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMubGluZWFyRmFjdG9yKSB7CiAgICAgICAgdGhpcy5saW5lYXJGYWN0b3IuY29weShvcHRpb25zLmxpbmVhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYW5ndWxhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMuYW5ndWxhckZhY3RvcikgewogICAgICAgIHRoaXMuYW5ndWxhckZhY3Rvci5jb3B5KG9wdGlvbnMuYW5ndWxhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgdGhpcy5ib3VuZGluZ1JhZGl1cyA9IDA7CiAgICAgIHRoaXMud2xhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaXNUcmlnZ2VyID0gQm9vbGVhbihvcHRpb25zLmlzVHJpZ2dlcik7CgogICAgICBpZiAob3B0aW9ucy5zaGFwZSkgewogICAgICAgIHRoaXMuYWRkU2hhcGUob3B0aW9ucy5zaGFwZSk7CiAgICAgIH0KCiAgICAgIHRoaXMudXBkYXRlTWFzc1Byb3BlcnRpZXMoKTsKICAgIH0KICAgIC8qKgogICAgICogV2FrZSB0aGUgYm9keSB1cC4KICAgICAqLwoKCiAgICB3YWtlVXAoKSB7CiAgICAgIGNvbnN0IHByZXZTdGF0ZSA9IHRoaXMuc2xlZXBTdGF0ZTsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5BV0FLRTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CgogICAgICBpZiAocHJldlN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkud2FrZXVwRXZlbnQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEZvcmNlIGJvZHkgc2xlZXAKICAgICAqLwoKCiAgICBzbGVlcCgpIHsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUElORzsKICAgICAgdGhpcy52ZWxvY2l0eS5zZXQoMCwgMCwgMCk7CiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnNldCgwLCAwLCAwKTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIENhbGxlZCBldmVyeSB0aW1lc3RlcCB0byB1cGRhdGUgaW50ZXJuYWwgc2xlZXAgdGltZXIgYW5kIGNoYW5nZSBzbGVlcCBzdGF0ZSBpZiBuZWVkZWQuCiAgICAgKiBAcGFyYW0gdGltZSBUaGUgd29ybGQgdGltZSBpbiBzZWNvbmRzCiAgICAgKi8KCgogICAgc2xlZXBUaWNrKHRpbWUpIHsKICAgICAgaWYgKHRoaXMuYWxsb3dTbGVlcCkgewogICAgICAgIGNvbnN0IHNsZWVwU3RhdGUgPSB0aGlzLnNsZWVwU3RhdGU7CiAgICAgICAgY29uc3Qgc3BlZWRTcXVhcmVkID0gdGhpcy52ZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCkgKyB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCk7CiAgICAgICAgY29uc3Qgc3BlZWRMaW1pdFNxdWFyZWQgPSB0aGlzLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5BV0FLRSAmJiBzcGVlZFNxdWFyZWQgPCBzcGVlZExpbWl0U3F1YXJlZCkgewogICAgICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUFk7IC8vIFNsZWVweQoKICAgICAgICAgIHRoaXMudGltZUxhc3RTbGVlcHkgPSB0aW1lOwogICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkuc2xlZXB5RXZlbnQpOwogICAgICAgIH0gZWxzZSBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUFkgJiYgc3BlZWRTcXVhcmVkID4gc3BlZWRMaW1pdFNxdWFyZWQpIHsKICAgICAgICAgIHRoaXMud2FrZVVwKCk7IC8vIFdha2UgdXAKICAgICAgICB9IGVsc2UgaWYgKHNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBZICYmIHRpbWUgLSB0aGlzLnRpbWVMYXN0U2xlZXB5ID4gdGhpcy5zbGVlcFRpbWVMaW1pdCkgewogICAgICAgICAgdGhpcy5zbGVlcCgpOyAvLyBTbGVlcGluZwoKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChCb2R5LnNsZWVwRXZlbnQpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBJZiB0aGUgYm9keSBpcyBzbGVlcGluZywgaXQgc2hvdWxkIGJlIGltbW92YWJsZSAvIGhhdmUgaW5maW5pdGUgbWFzcyBkdXJpbmcgc29sdmUuIFdlIHNvbHZlIGl0IGJ5IGhhdmluZyBhIHNlcGFyYXRlICJzb2x2ZSBtYXNzIi4KICAgICAqLwoKCiAgICB1cGRhdGVTb2x2ZU1hc3NQcm9wZXJ0aWVzKCkgewogICAgICBpZiAodGhpcy5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HIHx8IHRoaXMudHlwZSA9PT0gQm9keS5LSU5FTUFUSUMpIHsKICAgICAgICB0aGlzLmludk1hc3NTb2x2ZSA9IDA7CiAgICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUuc2V0WmVybygpOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVdvcmxkU29sdmUuc2V0WmVybygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gdGhpcy5pbnZNYXNzOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhKTsKICAgICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhV29ybGQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgYSB3b3JsZCBwb2ludCB0byBsb2NhbCBib2R5IGZyYW1lLgogICAgICovCgoKICAgIHBvaW50VG9Mb2NhbEZyYW1lKHdvcmxkUG9pbnQsIHJlc3VsdCA9IG5ldyBWZWMzKCkpIHsKICAgICAgd29ybGRQb2ludC52c3ViKHRoaXMucG9zaXRpb24sIHJlc3VsdCk7CiAgICAgIHRoaXMucXVhdGVybmlvbi5jb25qdWdhdGUoKS52bXVsdChyZXN1bHQsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgYSB3b3JsZCB2ZWN0b3IgdG8gbG9jYWwgYm9keSBmcmFtZS4KICAgICAqLwoKCiAgICB2ZWN0b3JUb0xvY2FsRnJhbWUod29ybGRWZWN0b3IsIHJlc3VsdCA9IG5ldyBWZWMzKCkpIHsKICAgICAgdGhpcy5xdWF0ZXJuaW9uLmNvbmp1Z2F0ZSgpLnZtdWx0KHdvcmxkVmVjdG9yLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0IGEgbG9jYWwgYm9keSBwb2ludCB0byB3b3JsZCBmcmFtZS4KICAgICAqLwoKCiAgICBwb2ludFRvV29ybGRGcmFtZShsb2NhbFBvaW50LCByZXN1bHQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHRoaXMucXVhdGVybmlvbi52bXVsdChsb2NhbFBvaW50LCByZXN1bHQpOwogICAgICByZXN1bHQudmFkZCh0aGlzLnBvc2l0aW9uLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0IGEgbG9jYWwgYm9keSBwb2ludCB0byB3b3JsZCBmcmFtZS4KICAgICAqLwoKCiAgICB2ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxWZWN0b3IsIHJlc3VsdCA9IG5ldyBWZWMzKCkpIHsKICAgICAgdGhpcy5xdWF0ZXJuaW9uLnZtdWx0KGxvY2FsVmVjdG9yLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSBzaGFwZSB0byB0aGUgYm9keSB3aXRoIGEgbG9jYWwgb2Zmc2V0IGFuZCBvcmllbnRhdGlvbi4KICAgICAqIEByZXR1cm4gVGhlIGJvZHkgb2JqZWN0LCBmb3IgY2hhaW5hYmlsaXR5LgogICAgICovCgoKICAgIGFkZFNoYXBlKHNoYXBlLCBfb2Zmc2V0LCBfb3JpZW50YXRpb24pIHsKICAgICAgY29uc3Qgb2Zmc2V0ID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3Qgb3JpZW50YXRpb24gPSBuZXcgUXVhdGVybmlvbigpOwoKICAgICAgaWYgKF9vZmZzZXQpIHsKICAgICAgICBvZmZzZXQuY29weShfb2Zmc2V0KTsKICAgICAgfQoKICAgICAgaWYgKF9vcmllbnRhdGlvbikgewogICAgICAgIG9yaWVudGF0aW9uLmNvcHkoX29yaWVudGF0aW9uKTsKICAgICAgfQoKICAgICAgdGhpcy5zaGFwZXMucHVzaChzaGFwZSk7CiAgICAgIHRoaXMuc2hhcGVPZmZzZXRzLnB1c2gob2Zmc2V0KTsKICAgICAgdGhpcy5zaGFwZU9yaWVudGF0aW9ucy5wdXNoKG9yaWVudGF0aW9uKTsKICAgICAgdGhpcy51cGRhdGVNYXNzUHJvcGVydGllcygpOwogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nUmFkaXVzKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgc2hhcGUuYm9keSA9IHRoaXM7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgYSBzaGFwZSBmcm9tIHRoZSBib2R5LgogICAgICogQHJldHVybiBUaGUgYm9keSBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkuCiAgICAgKi8KCgogICAgcmVtb3ZlU2hhcGUoc2hhcGUpIHsKICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnNoYXBlcy5pbmRleE9mKHNoYXBlKTsKCiAgICAgIGlmIChpbmRleCA9PT0gLTEpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1NoYXBlIGRvZXMgbm90IGJlbG9uZyB0byB0aGUgYm9keScpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CgogICAgICB0aGlzLnNoYXBlcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB0aGlzLnNoYXBlT2Zmc2V0cy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB0aGlzLnNoYXBlT3JpZW50YXRpb25zLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMudXBkYXRlTWFzc1Byb3BlcnRpZXMoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1JhZGl1cygpOwogICAgICB0aGlzLmFhYmJOZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIHNoYXBlLmJvZHkgPSBudWxsOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBib3VuZGluZyByYWRpdXMgb2YgdGhlIGJvZHkuIFNob3VsZCBiZSBkb25lIGlmIGFueSBvZiB0aGUgc2hhcGVzIGFyZSBjaGFuZ2VkLgogICAgICovCgoKICAgIHVwZGF0ZUJvdW5kaW5nUmFkaXVzKCkgewogICAgICBjb25zdCBzaGFwZXMgPSB0aGlzLnNoYXBlczsKICAgICAgY29uc3Qgc2hhcGVPZmZzZXRzID0gdGhpcy5zaGFwZU9mZnNldHM7CiAgICAgIGNvbnN0IE4gPSBzaGFwZXMubGVuZ3RoOwogICAgICBsZXQgcmFkaXVzID0gMDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBzaGFwZSA9IHNoYXBlc1tpXTsKICAgICAgICBzaGFwZS51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgICAgIGNvbnN0IG9mZnNldCA9IHNoYXBlT2Zmc2V0c1tpXS5sZW5ndGgoKTsKICAgICAgICBjb25zdCByID0gc2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXM7CgogICAgICAgIGlmIChvZmZzZXQgKyByID4gcmFkaXVzKSB7CiAgICAgICAgICByYWRpdXMgPSBvZmZzZXQgKyByOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5ib3VuZGluZ1JhZGl1cyA9IHJhZGl1czsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyB0aGUgLmFhYmIKICAgICAqLwoKCiAgICB1cGRhdGVBQUJCKCkgewogICAgICBjb25zdCBzaGFwZXMgPSB0aGlzLnNoYXBlczsKICAgICAgY29uc3Qgc2hhcGVPZmZzZXRzID0gdGhpcy5zaGFwZU9mZnNldHM7CiAgICAgIGNvbnN0IHNoYXBlT3JpZW50YXRpb25zID0gdGhpcy5zaGFwZU9yaWVudGF0aW9uczsKICAgICAgY29uc3QgTiA9IHNoYXBlcy5sZW5ndGg7CiAgICAgIGNvbnN0IG9mZnNldCA9IHRtcFZlYzsKICAgICAgY29uc3Qgb3JpZW50YXRpb24gPSB0bXBRdWF0OwogICAgICBjb25zdCBib2R5UXVhdCA9IHRoaXMucXVhdGVybmlvbjsKICAgICAgY29uc3QgYWFiYiA9IHRoaXMuYWFiYjsKICAgICAgY29uc3Qgc2hhcGVBQUJCID0gdXBkYXRlQUFCQl9zaGFwZUFBQkI7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2hhcGUgPSBzaGFwZXNbaV07IC8vIEdldCBzaGFwZSB3b3JsZCBwb3NpdGlvbgoKICAgICAgICBib2R5UXVhdC52bXVsdChzaGFwZU9mZnNldHNbaV0sIG9mZnNldCk7CiAgICAgICAgb2Zmc2V0LnZhZGQodGhpcy5wb3NpdGlvbiwgb2Zmc2V0KTsgLy8gR2V0IHNoYXBlIHdvcmxkIHF1YXRlcm5pb24KCiAgICAgICAgYm9keVF1YXQubXVsdChzaGFwZU9yaWVudGF0aW9uc1tpXSwgb3JpZW50YXRpb24pOyAvLyBHZXQgc2hhcGUgQUFCQgoKICAgICAgICBzaGFwZS5jYWxjdWxhdGVXb3JsZEFBQkIob2Zmc2V0LCBvcmllbnRhdGlvbiwgc2hhcGVBQUJCLmxvd2VyQm91bmQsIHNoYXBlQUFCQi51cHBlckJvdW5kKTsKCiAgICAgICAgaWYgKGkgPT09IDApIHsKICAgICAgICAgIGFhYmIuY29weShzaGFwZUFBQkIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhYWJiLmV4dGVuZChzaGFwZUFBQkIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5hYWJiTmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIGAuaW5lcnRpYVdvcmxkYCBhbmQgYC5pbnZJbmVydGlhV29ybGRgCiAgICAgKi8KCgogICAgdXBkYXRlSW5lcnRpYVdvcmxkKGZvcmNlKSB7CiAgICAgIGNvbnN0IEkgPSB0aGlzLmludkluZXJ0aWE7CiAgICAgIGlmIChJLnggPT09IEkueSAmJiBJLnkgPT09IEkueiAmJiAhZm9yY2UpIDtlbHNlIHsKICAgICAgICBjb25zdCBtMSA9IHVpd19tMTsKICAgICAgICBjb25zdCBtMiA9IHVpd19tMjsKICAgICAgICBtMS5zZXRSb3RhdGlvbkZyb21RdWF0ZXJuaW9uKHRoaXMucXVhdGVybmlvbik7CiAgICAgICAgbTEudHJhbnNwb3NlKG0yKTsKICAgICAgICBtMS5zY2FsZShJLCBtMSk7CiAgICAgICAgbTEubW11bHQobTIsIHRoaXMuaW52SW5lcnRpYVdvcmxkKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBBcHBseSBmb3JjZSB0byBhIHBvaW50IG9mIHRoZSBib2R5LiBUaGlzIGNvdWxkIGZvciBleGFtcGxlIGJlIGEgcG9pbnQgb24gdGhlIEJvZHkgc3VyZmFjZS4KICAgICAqIEFwcGx5aW5nIGZvcmNlIHRoaXMgd2F5IHdpbGwgYWRkIHRvIEJvZHkuZm9yY2UgYW5kIEJvZHkudG9ycXVlLgogICAgICogQHBhcmFtIGZvcmNlIFRoZSBhbW91bnQgb2YgZm9yY2UgdG8gYWRkLgogICAgICogQHBhcmFtIHJlbGF0aXZlUG9pbnQgQSBwb2ludCByZWxhdGl2ZSB0byB0aGUgY2VudGVyIG9mIG1hc3MgdG8gYXBwbHkgdGhlIGZvcmNlIG9uLgogICAgICovCgoKICAgIGFwcGx5Rm9yY2UoZm9yY2UsIHJlbGF0aXZlUG9pbnQgPSBuZXcgVmVjMygpKSB7CiAgICAgIC8vIE5lZWRlZD8KICAgICAgaWYgKHRoaXMudHlwZSAhPT0gQm9keS5EWU5BTUlDKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgdGhpcy53YWtlVXAoKTsKICAgICAgfSAvLyBDb21wdXRlIHByb2R1Y2VkIHJvdGF0aW9uYWwgZm9yY2UKCgogICAgICBjb25zdCByb3RGb3JjZSA9IEJvZHlfYXBwbHlGb3JjZV9yb3RGb3JjZTsKICAgICAgcmVsYXRpdmVQb2ludC5jcm9zcyhmb3JjZSwgcm90Rm9yY2UpOyAvLyBBZGQgbGluZWFyIGZvcmNlCgogICAgICB0aGlzLmZvcmNlLnZhZGQoZm9yY2UsIHRoaXMuZm9yY2UpOyAvLyBBZGQgcm90YXRpb25hbCBmb3JjZQoKICAgICAgdGhpcy50b3JxdWUudmFkZChyb3RGb3JjZSwgdGhpcy50b3JxdWUpOwogICAgfQogICAgLyoqCiAgICAgKiBBcHBseSBmb3JjZSB0byBhIGxvY2FsIHBvaW50IGluIHRoZSBib2R5LgogICAgICogQHBhcmFtIGZvcmNlIFRoZSBmb3JjZSB2ZWN0b3IgdG8gYXBwbHksIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgYm9keSBmcmFtZS4KICAgICAqIEBwYXJhbSBsb2NhbFBvaW50IEEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkgdG8gYXBwbHkgdGhlIGZvcmNlIG9uLgogICAgICovCgoKICAgIGFwcGx5TG9jYWxGb3JjZShsb2NhbEZvcmNlLCBsb2NhbFBvaW50ID0gbmV3IFZlYzMoKSkgewogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkRm9yY2UgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV93b3JsZEZvcmNlOwogICAgICBjb25zdCByZWxhdGl2ZVBvaW50V29ybGQgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV9yZWxhdGl2ZVBvaW50V29ybGQ7IC8vIFRyYW5zZm9ybSB0aGUgZm9yY2UgdmVjdG9yIHRvIHdvcmxkIHNwYWNlCgogICAgICB0aGlzLnZlY3RvclRvV29ybGRGcmFtZShsb2NhbEZvcmNlLCB3b3JsZEZvcmNlKTsKICAgICAgdGhpcy52ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgICAgdGhpcy5hcHBseUZvcmNlKHdvcmxkRm9yY2UsIHJlbGF0aXZlUG9pbnRXb3JsZCk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IHRvcnF1ZSB0byB0aGUgYm9keS4KICAgICAqIEBwYXJhbSB0b3JxdWUgVGhlIGFtb3VudCBvZiB0b3JxdWUgdG8gYWRkLgogICAgICovCgoKICAgIGFwcGx5VG9ycXVlKHRvcnF1ZSkgewogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIEFkZCByb3RhdGlvbmFsIGZvcmNlCgoKICAgICAgdGhpcy50b3JxdWUudmFkZCh0b3JxdWUsIHRoaXMudG9ycXVlKTsKICAgIH0KICAgIC8qKgogICAgICogQXBwbHkgaW1wdWxzZSB0byBhIHBvaW50IG9mIHRoZSBib2R5LiBUaGlzIGNvdWxkIGZvciBleGFtcGxlIGJlIGEgcG9pbnQgb24gdGhlIEJvZHkgc3VyZmFjZS4KICAgICAqIEFuIGltcHVsc2UgaXMgYSBmb3JjZSBhZGRlZCB0byBhIGJvZHkgZHVyaW5nIGEgc2hvcnQgcGVyaW9kIG9mIHRpbWUgKGltcHVsc2UgPSBmb3JjZSAqIHRpbWUpLgogICAgICogSW1wdWxzZXMgd2lsbCBiZSBhZGRlZCB0byBCb2R5LnZlbG9jaXR5IGFuZCBCb2R5LmFuZ3VsYXJWZWxvY2l0eS4KICAgICAqIEBwYXJhbSBpbXB1bHNlIFRoZSBhbW91bnQgb2YgaW1wdWxzZSB0byBhZGQuCiAgICAgKiBAcGFyYW0gcmVsYXRpdmVQb2ludCBBIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlJbXB1bHNlKGltcHVsc2UsIHJlbGF0aXZlUG9pbnQgPSBuZXcgVmVjMygpKSB7CiAgICAgIGlmICh0aGlzLnR5cGUgIT09IEJvZHkuRFlOQU1JQykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORykgewogICAgICAgIHRoaXMud2FrZVVwKCk7CiAgICAgIH0gLy8gQ29tcHV0ZSBwb2ludCBwb3NpdGlvbiByZWxhdGl2ZSB0byB0aGUgYm9keSBjZW50ZXIKCgogICAgICBjb25zdCByID0gcmVsYXRpdmVQb2ludDsgLy8gQ29tcHV0ZSBwcm9kdWNlZCBjZW50cmFsIGltcHVsc2UgdmVsb2NpdHkKCiAgICAgIGNvbnN0IHZlbG8gPSBCb2R5X2FwcGx5SW1wdWxzZV92ZWxvOwogICAgICB2ZWxvLmNvcHkoaW1wdWxzZSk7CiAgICAgIHZlbG8uc2NhbGUodGhpcy5pbnZNYXNzLCB2ZWxvKTsgLy8gQWRkIGxpbmVhciBpbXB1bHNlCgogICAgICB0aGlzLnZlbG9jaXR5LnZhZGQodmVsbywgdGhpcy52ZWxvY2l0eSk7IC8vIENvbXB1dGUgcHJvZHVjZWQgcm90YXRpb25hbCBpbXB1bHNlIHZlbG9jaXR5CgogICAgICBjb25zdCByb3RWZWxvID0gQm9keV9hcHBseUltcHVsc2Vfcm90VmVsbzsKICAgICAgci5jcm9zcyhpbXB1bHNlLCByb3RWZWxvKTsKICAgICAgLyoKICAgICAgIHJvdFZlbG8ueCAqPSB0aGlzLmludkluZXJ0aWEueDsKICAgICAgIHJvdFZlbG8ueSAqPSB0aGlzLmludkluZXJ0aWEueTsKICAgICAgIHJvdFZlbG8ueiAqPSB0aGlzLmludkluZXJ0aWEuejsKICAgICAgICovCgogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZC52bXVsdChyb3RWZWxvLCByb3RWZWxvKTsgLy8gQWRkIHJvdGF0aW9uYWwgSW1wdWxzZQoKICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkudmFkZChyb3RWZWxvLCB0aGlzLmFuZ3VsYXJWZWxvY2l0eSk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IGxvY2FsbHktZGVmaW5lZCBpbXB1bHNlIHRvIGEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkuCiAgICAgKiBAcGFyYW0gZm9yY2UgVGhlIGZvcmNlIHZlY3RvciB0byBhcHBseSwgZGVmaW5lZCBsb2NhbGx5IGluIHRoZSBib2R5IGZyYW1lLgogICAgICogQHBhcmFtIGxvY2FsUG9pbnQgQSBsb2NhbCBwb2ludCBpbiB0aGUgYm9keSB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlMb2NhbEltcHVsc2UobG9jYWxJbXB1bHNlLCBsb2NhbFBvaW50ID0gbmV3IFZlYzMoKSkgewogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkSW1wdWxzZSA9IEJvZHlfYXBwbHlMb2NhbEltcHVsc2Vfd29ybGRJbXB1bHNlOwogICAgICBjb25zdCByZWxhdGl2ZVBvaW50V29ybGQgPSBCb2R5X2FwcGx5TG9jYWxJbXB1bHNlX3JlbGF0aXZlUG9pbnQ7IC8vIFRyYW5zZm9ybSB0aGUgZm9yY2UgdmVjdG9yIHRvIHdvcmxkIHNwYWNlCgogICAgICB0aGlzLnZlY3RvclRvV29ybGRGcmFtZShsb2NhbEltcHVsc2UsIHdvcmxkSW1wdWxzZSk7CiAgICAgIHRoaXMudmVjdG9yVG9Xb3JsZEZyYW1lKGxvY2FsUG9pbnQsIHJlbGF0aXZlUG9pbnRXb3JsZCk7CiAgICAgIHRoaXMuYXBwbHlJbXB1bHNlKHdvcmxkSW1wdWxzZSwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgIH0KICAgIC8qKgogICAgICogU2hvdWxkIGJlIGNhbGxlZCB3aGVuZXZlciB5b3UgY2hhbmdlIHRoZSBib2R5IHNoYXBlIG9yIG1hc3MuCiAgICAgKi8KCgogICAgdXBkYXRlTWFzc1Byb3BlcnRpZXMoKSB7CiAgICAgIGNvbnN0IGhhbGZFeHRlbnRzID0gQm9keV91cGRhdGVNYXNzUHJvcGVydGllc19oYWxmRXh0ZW50czsKICAgICAgdGhpcy5pbnZNYXNzID0gdGhpcy5tYXNzID4gMCA/IDEuMCAvIHRoaXMubWFzcyA6IDA7CiAgICAgIGNvbnN0IEkgPSB0aGlzLmluZXJ0aWE7CiAgICAgIGNvbnN0IGZpeGVkID0gdGhpcy5maXhlZFJvdGF0aW9uOyAvLyBBcHByb3hpbWF0ZSB3aXRoIEFBQkIgYm94CgogICAgICB0aGlzLnVwZGF0ZUFBQkIoKTsKICAgICAgaGFsZkV4dGVudHMuc2V0KCh0aGlzLmFhYmIudXBwZXJCb3VuZC54IC0gdGhpcy5hYWJiLmxvd2VyQm91bmQueCkgLyAyLCAodGhpcy5hYWJiLnVwcGVyQm91bmQueSAtIHRoaXMuYWFiYi5sb3dlckJvdW5kLnkpIC8gMiwgKHRoaXMuYWFiYi51cHBlckJvdW5kLnogLSB0aGlzLmFhYmIubG93ZXJCb3VuZC56KSAvIDIpOwogICAgICBCb3guY2FsY3VsYXRlSW5lcnRpYShoYWxmRXh0ZW50cywgdGhpcy5tYXNzLCBJKTsKICAgICAgdGhpcy5pbnZJbmVydGlhLnNldChJLnggPiAwICYmICFmaXhlZCA/IDEuMCAvIEkueCA6IDAsIEkueSA+IDAgJiYgIWZpeGVkID8gMS4wIC8gSS55IDogMCwgSS56ID4gMCAmJiAhZml4ZWQgPyAxLjAgLyBJLnogOiAwKTsKICAgICAgdGhpcy51cGRhdGVJbmVydGlhV29ybGQodHJ1ZSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB3b3JsZCB2ZWxvY2l0eSBvZiBhIHBvaW50IGluIHRoZSBib2R5LgogICAgICogQHBhcmFtIHdvcmxkUG9pbnQKICAgICAqIEBwYXJhbSByZXN1bHQKICAgICAqIEByZXR1cm4gVGhlIHJlc3VsdCB2ZWN0b3IuCiAgICAgKi8KCgogICAgZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod29ybGRQb2ludCwgcmVzdWx0KSB7CiAgICAgIGNvbnN0IHIgPSBuZXcgVmVjMygpOwogICAgICB3b3JsZFBvaW50LnZzdWIodGhpcy5wb3NpdGlvbiwgcik7CiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LmNyb3NzKHIsIHJlc3VsdCk7CiAgICAgIHRoaXMudmVsb2NpdHkudmFkZChyZXN1bHQsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIE1vdmUgdGhlIGJvZHkgZm9yd2FyZCBpbiB0aW1lLgogICAgICogQHBhcmFtIGR0IFRpbWUgc3RlcAogICAgICogQHBhcmFtIHF1YXROb3JtYWxpemUgU2V0IHRvIHRydWUgdG8gbm9ybWFsaXplIHRoZSBib2R5IHF1YXRlcm5pb24KICAgICAqIEBwYXJhbSBxdWF0Tm9ybWFsaXplRmFzdCBJZiB0aGUgcXVhdGVybmlvbiBzaG91bGQgYmUgbm9ybWFsaXplZCB1c2luZyAiZmFzdCIgcXVhdGVybmlvbiBub3JtYWxpemF0aW9uCiAgICAgKi8KCgogICAgaW50ZWdyYXRlKGR0LCBxdWF0Tm9ybWFsaXplLCBxdWF0Tm9ybWFsaXplRmFzdCkgewogICAgICAvLyBTYXZlIHByZXZpb3VzIHBvc2l0aW9uCiAgICAgIHRoaXMucHJldmlvdXNQb3NpdGlvbi5jb3B5KHRoaXMucG9zaXRpb24pOwogICAgICB0aGlzLnByZXZpb3VzUXVhdGVybmlvbi5jb3B5KHRoaXMucXVhdGVybmlvbik7CgogICAgICBpZiAoISh0aGlzLnR5cGUgPT09IEJvZHkuRFlOQU1JQyB8fCB0aGlzLnR5cGUgPT09IEJvZHkuS0lORU1BVElDKSB8fCB0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICAvLyBPbmx5IGZvciBkeW5hbWljCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCB2ZWxvID0gdGhpcy52ZWxvY2l0eTsKICAgICAgY29uc3QgYW5ndWxhclZlbG8gPSB0aGlzLmFuZ3VsYXJWZWxvY2l0eTsKICAgICAgY29uc3QgcG9zID0gdGhpcy5wb3NpdGlvbjsKICAgICAgY29uc3QgZm9yY2UgPSB0aGlzLmZvcmNlOwogICAgICBjb25zdCB0b3JxdWUgPSB0aGlzLnRvcnF1ZTsKICAgICAgY29uc3QgcXVhdCA9IHRoaXMucXVhdGVybmlvbjsKICAgICAgY29uc3QgaW52TWFzcyA9IHRoaXMuaW52TWFzczsKICAgICAgY29uc3QgaW52SW5lcnRpYSA9IHRoaXMuaW52SW5lcnRpYVdvcmxkOwogICAgICBjb25zdCBsaW5lYXJGYWN0b3IgPSB0aGlzLmxpbmVhckZhY3RvcjsKICAgICAgY29uc3QgaU1kdCA9IGludk1hc3MgKiBkdDsKICAgICAgdmVsby54ICs9IGZvcmNlLnggKiBpTWR0ICogbGluZWFyRmFjdG9yLng7CiAgICAgIHZlbG8ueSArPSBmb3JjZS55ICogaU1kdCAqIGxpbmVhckZhY3Rvci55OwogICAgICB2ZWxvLnogKz0gZm9yY2UueiAqIGlNZHQgKiBsaW5lYXJGYWN0b3IuejsKICAgICAgY29uc3QgZSA9IGludkluZXJ0aWEuZWxlbWVudHM7CiAgICAgIGNvbnN0IGFuZ3VsYXJGYWN0b3IgPSB0aGlzLmFuZ3VsYXJGYWN0b3I7CiAgICAgIGNvbnN0IHR4ID0gdG9ycXVlLnggKiBhbmd1bGFyRmFjdG9yLng7CiAgICAgIGNvbnN0IHR5ID0gdG9ycXVlLnkgKiBhbmd1bGFyRmFjdG9yLnk7CiAgICAgIGNvbnN0IHR6ID0gdG9ycXVlLnogKiBhbmd1bGFyRmFjdG9yLno7CiAgICAgIGFuZ3VsYXJWZWxvLnggKz0gZHQgKiAoZVswXSAqIHR4ICsgZVsxXSAqIHR5ICsgZVsyXSAqIHR6KTsKICAgICAgYW5ndWxhclZlbG8ueSArPSBkdCAqIChlWzNdICogdHggKyBlWzRdICogdHkgKyBlWzVdICogdHopOwogICAgICBhbmd1bGFyVmVsby56ICs9IGR0ICogKGVbNl0gKiB0eCArIGVbN10gKiB0eSArIGVbOF0gKiB0eik7IC8vIFVzZSBuZXcgdmVsb2NpdHkgIC0gbGVhcCBmcm9nCgogICAgICBwb3MueCArPSB2ZWxvLnggKiBkdDsKICAgICAgcG9zLnkgKz0gdmVsby55ICogZHQ7CiAgICAgIHBvcy56ICs9IHZlbG8ueiAqIGR0OwogICAgICBxdWF0LmludGVncmF0ZSh0aGlzLmFuZ3VsYXJWZWxvY2l0eSwgZHQsIHRoaXMuYW5ndWxhckZhY3RvciwgcXVhdCk7CgogICAgICBpZiAocXVhdE5vcm1hbGl6ZSkgewogICAgICAgIGlmIChxdWF0Tm9ybWFsaXplRmFzdCkgewogICAgICAgICAgcXVhdC5ub3JtYWxpemVGYXN0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHF1YXQubm9ybWFsaXplKCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmFhYmJOZWVkc1VwZGF0ZSA9IHRydWU7IC8vIFVwZGF0ZSB3b3JsZCBpbmVydGlhCgogICAgICB0aGlzLnVwZGF0ZUluZXJ0aWFXb3JsZCgpOwogICAgfQoKICB9CgogIEJvZHkuaWRDb3VudGVyID0gMDsKICBCb2R5LkNPTExJREVfRVZFTlRfTkFNRSA9ICdjb2xsaWRlJzsKICBCb2R5LkRZTkFNSUMgPSBCT0RZX1RZUEVTLkRZTkFNSUM7CiAgQm9keS5TVEFUSUMgPSBCT0RZX1RZUEVTLlNUQVRJQzsKICBCb2R5LktJTkVNQVRJQyA9IEJPRFlfVFlQRVMuS0lORU1BVElDOwogIEJvZHkuQVdBS0UgPSBCT0RZX1NMRUVQX1NUQVRFUy5BV0FLRTsKICBCb2R5LlNMRUVQWSA9IEJPRFlfU0xFRVBfU1RBVEVTLlNMRUVQWTsKICBCb2R5LlNMRUVQSU5HID0gQk9EWV9TTEVFUF9TVEFURVMuU0xFRVBJTkc7CiAgQm9keS53YWtldXBFdmVudCA9IHsKICAgIHR5cGU6ICd3YWtldXAnCiAgfTsKICBCb2R5LnNsZWVweUV2ZW50ID0gewogICAgdHlwZTogJ3NsZWVweScKICB9OwogIEJvZHkuc2xlZXBFdmVudCA9IHsKICAgIHR5cGU6ICdzbGVlcCcKICB9OwogIGNvbnN0IHRtcFZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wUXVhdCA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgY29uc3QgdXBkYXRlQUFCQl9zaGFwZUFBQkIgPSBuZXcgQUFCQigpOwogIGNvbnN0IHVpd19tMSA9IG5ldyBNYXQzKCk7CiAgY29uc3QgdWl3X20yID0gbmV3IE1hdDMoKTsKICBjb25zdCBCb2R5X2FwcGx5Rm9yY2Vfcm90Rm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3dvcmxkRm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3JlbGF0aXZlUG9pbnRXb3JsZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2VfdmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2Vfcm90VmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUxvY2FsSW1wdWxzZV93b3JsZEltcHVsc2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEltcHVsc2VfcmVsYXRpdmVQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV91cGRhdGVNYXNzUHJvcGVydGllc19oYWxmRXh0ZW50cyA9IG5ldyBWZWMzKCk7CiAgLyoqCiAgICogQmFzZSBjbGFzcyBmb3IgYnJvYWRwaGFzZSBpbXBsZW1lbnRhdGlvbnMKICAgKiBAYXV0aG9yIHNjaHRlcHBlCiAgICovCgogIGNsYXNzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBUaGUgd29ybGQgdG8gc2VhcmNoIGZvciBjb2xsaXNpb25zIGluLgogICAgICovCgogICAgLyoqCiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgdGhlIGJyb2FkcGhhc2UgdXNlcyBib3VuZGluZyBib3hlcyBmb3IgaW50ZXJzZWN0aW9uIHRlc3RzLCBlbHNlIGl0IHVzZXMgYm91bmRpbmcgc3BoZXJlcy4KICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIHRydWUgaWYgdGhlIG9iamVjdHMgaW4gdGhlIHdvcmxkIG1vdmVkLgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy53b3JsZCA9IHZvaWQgMDsKICAgICAgdGhpcy51c2VCb3VuZGluZ0JveGVzID0gdm9pZCAwOwogICAgICB0aGlzLmRpcnR5ID0gdm9pZCAwOwogICAgICB0aGlzLndvcmxkID0gbnVsbDsKICAgICAgdGhpcy51c2VCb3VuZGluZ0JveGVzID0gZmFsc2U7CiAgICAgIHRoaXMuZGlydHkgPSB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGNvbGxpc2lvbiBwYWlycyBmcm9tIHRoZSB3b3JsZAogICAgICogQHBhcmFtIHdvcmxkIFRoZSB3b3JsZCB0byBzZWFyY2ggaW4KICAgICAqIEBwYXJhbSBwMSBFbXB0eSBhcnJheSB0byBiZSBmaWxsZWQgd2l0aCBib2R5IG9iamVjdHMKICAgICAqIEBwYXJhbSBwMiBFbXB0eSBhcnJheSB0byBiZSBmaWxsZWQgd2l0aCBib2R5IG9iamVjdHMKICAgICAqLwoKCiAgICBjb2xsaXNpb25QYWlycyh3b3JsZCwgcDEsIHAyKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignY29sbGlzaW9uUGFpcnMgbm90IGltcGxlbWVudGVkIGZvciB0aGlzIEJyb2FkUGhhc2UgY2xhc3MhJyk7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgYm9keSBwYWlyIG5lZWRzIHRvIGJlIGludGVyc2VjdGlvbiB0ZXN0ZWQgYXQgYWxsLgogICAgICovCgoKICAgIG5lZWRCcm9hZHBoYXNlQ29sbGlzaW9uKGJvZHlBLCBib2R5QikgewogICAgICAvLyBDaGVjayBjb2xsaXNpb24gZmlsdGVyIG1hc2tzCiAgICAgIGlmICgoYm9keUEuY29sbGlzaW9uRmlsdGVyR3JvdXAgJiBib2R5Qi5jb2xsaXNpb25GaWx0ZXJNYXNrKSA9PT0gMCB8fCAoYm9keUIuY29sbGlzaW9uRmlsdGVyR3JvdXAgJiBib2R5QS5jb2xsaXNpb25GaWx0ZXJNYXNrKSA9PT0gMCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSAvLyBDaGVjayB0eXBlcwoKCiAgICAgIGlmICgoKGJvZHlBLnR5cGUgJiBCb2R5LlNUQVRJQykgIT09IDAgfHwgYm9keUEuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORykgJiYgKChib2R5Qi50eXBlICYgQm9keS5TVEFUSUMpICE9PSAwIHx8IGJvZHlCLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpKSB7CiAgICAgICAgLy8gQm90aCBib2RpZXMgYXJlIHN0YXRpYyBvciBzbGVlcGluZy4gU2tpcC4KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRpbmcgdm9sdW1lcyBvZiB0d28gYm9kaWVzIGludGVyc2VjdC4KICAgICAqLwoKCiAgICBpbnRlcnNlY3Rpb25UZXN0KGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpIHsKICAgICAgaWYgKHRoaXMudXNlQm91bmRpbmdCb3hlcykgewogICAgICAgIHRoaXMuZG9Cb3VuZGluZ0JveEJyb2FkcGhhc2UoYm9keUEsIGJvZHlCLCBwYWlyczEsIHBhaXJzMik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5kb0JvdW5kaW5nU3BoZXJlQnJvYWRwaGFzZShib2R5QSwgYm9keUIsIHBhaXJzMSwgcGFpcnMyKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRpbmcgc3BoZXJlcyBvZiB0d28gYm9kaWVzIGFyZSBpbnRlcnNlY3RpbmcuCiAgICAgKiBAcGFyYW0gcGFpcnMxIGJvZHlBIGlzIGFwcGVuZGVkIHRvIHRoaXMgYXJyYXkgaWYgaW50ZXJzZWN0aW9uCiAgICAgKiBAcGFyYW0gcGFpcnMyIGJvZHlCIGlzIGFwcGVuZGVkIHRvIHRoaXMgYXJyYXkgaWYgaW50ZXJzZWN0aW9uCiAgICAgKi8KCgogICAgZG9Cb3VuZGluZ1NwaGVyZUJyb2FkcGhhc2UoYm9keUEsIGJvZHlCLCBwYWlyczEsIHBhaXJzMikgewogICAgICBjb25zdCByID0gQnJvYWRwaGFzZV9jb2xsaXNpb25QYWlyc19yOwogICAgICBib2R5Qi5wb3NpdGlvbi52c3ViKGJvZHlBLnBvc2l0aW9uLCByKTsKICAgICAgY29uc3QgYm91bmRpbmdSYWRpdXNTdW0yID0gKGJvZHlBLmJvdW5kaW5nUmFkaXVzICsgYm9keUIuYm91bmRpbmdSYWRpdXMpICoqIDI7CiAgICAgIGNvbnN0IG5vcm0yID0gci5sZW5ndGhTcXVhcmVkKCk7CgogICAgICBpZiAobm9ybTIgPCBib3VuZGluZ1JhZGl1c1N1bTIpIHsKICAgICAgICBwYWlyczEucHVzaChib2R5QSk7CiAgICAgICAgcGFpcnMyLnB1c2goYm9keUIpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIHRoZSBib3VuZGluZyBib3hlcyBvZiB0d28gYm9kaWVzIGFyZSBpbnRlcnNlY3RpbmcuCiAgICAgKi8KCgogICAgZG9Cb3VuZGluZ0JveEJyb2FkcGhhc2UoYm9keUEsIGJvZHlCLCBwYWlyczEsIHBhaXJzMikgewogICAgICBpZiAoYm9keUEuYWFiYk5lZWRzVXBkYXRlKSB7CiAgICAgICAgYm9keUEudXBkYXRlQUFCQigpOwogICAgICB9CgogICAgICBpZiAoYm9keUIuYWFiYk5lZWRzVXBkYXRlKSB7CiAgICAgICAgYm9keUIudXBkYXRlQUFCQigpOwogICAgICB9IC8vIENoZWNrIEFBQkIgLyBBQUJCCgoKICAgICAgaWYgKGJvZHlBLmFhYmIub3ZlcmxhcHMoYm9keUIuYWFiYikpIHsKICAgICAgICBwYWlyczEucHVzaChib2R5QSk7CiAgICAgICAgcGFpcnMyLnB1c2goYm9keUIpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZXMgZHVwbGljYXRlIHBhaXJzIGZyb20gdGhlIHBhaXIgYXJyYXlzLgogICAgICovCgoKICAgIG1ha2VQYWlyc1VuaXF1ZShwYWlyczEsIHBhaXJzMikgewogICAgICBjb25zdCB0ID0gQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfdGVtcDsKICAgICAgY29uc3QgcDEgPSBCcm9hZHBoYXNlX21ha2VQYWlyc1VuaXF1ZV9wMTsKICAgICAgY29uc3QgcDIgPSBCcm9hZHBoYXNlX21ha2VQYWlyc1VuaXF1ZV9wMjsKICAgICAgY29uc3QgTiA9IHBhaXJzMS5sZW5ndGg7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgcDFbaV0gPSBwYWlyczFbaV07CiAgICAgICAgcDJbaV0gPSBwYWlyczJbaV07CiAgICAgIH0KCiAgICAgIHBhaXJzMS5sZW5ndGggPSAwOwogICAgICBwYWlyczIubGVuZ3RoID0gMDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBpZDEgPSBwMVtpXS5pZDsKICAgICAgICBjb25zdCBpZDIgPSBwMltpXS5pZDsKICAgICAgICBjb25zdCBrZXkgPSBpZDEgPCBpZDIgPyBpZDEgKyAiLCIgKyBpZDIgOiBpZDIgKyAiLCIgKyBpZDE7CiAgICAgICAgdFtrZXldID0gaTsKICAgICAgICB0LmtleXMucHVzaChrZXkpOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdC5rZXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qga2V5ID0gdC5rZXlzLnBvcCgpOwogICAgICAgIGNvbnN0IHBhaXJJbmRleCA9IHRba2V5XTsKICAgICAgICBwYWlyczEucHVzaChwMVtwYWlySW5kZXhdKTsKICAgICAgICBwYWlyczIucHVzaChwMltwYWlySW5kZXhdKTsKICAgICAgICBkZWxldGUgdFtrZXldOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFRvIGJlIGltcGxlbWVudGVkIGJ5IHN1YmNhc3NlcwogICAgICovCgoKICAgIHNldFdvcmxkKHdvcmxkKSB7fQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRpbmcgc3BoZXJlcyBvZiB0d28gYm9kaWVzIG92ZXJsYXAuCiAgICAgKi8KCgogICAgc3RhdGljIGJvdW5kaW5nU3BoZXJlQ2hlY2soYm9keUEsIGJvZHlCKSB7CiAgICAgIGNvbnN0IGRpc3QgPSBuZXcgVmVjMygpOyAvLyBic2NfZGlzdDsKCiAgICAgIGJvZHlBLnBvc2l0aW9uLnZzdWIoYm9keUIucG9zaXRpb24sIGRpc3QpOwogICAgICBjb25zdCBzYSA9IGJvZHlBLnNoYXBlc1swXTsKICAgICAgY29uc3Qgc2IgPSBib2R5Qi5zaGFwZXNbMF07CiAgICAgIHJldHVybiBNYXRoLnBvdyhzYS5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNiLmJvdW5kaW5nU3BoZXJlUmFkaXVzLCAyKSA+IGRpc3QubGVuZ3RoU3F1YXJlZCgpOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiB0aGUgQUFCQi4KICAgICAqLwoKCiAgICBhYWJiUXVlcnkod29ybGQsIGFhYmIsIHJlc3VsdCkgewogICAgICBjb25zb2xlLndhcm4oJy5hYWJiUXVlcnkgaXMgbm90IGltcGxlbWVudGVkIGluIHRoaXMgQnJvYWRwaGFzZSBzdWJjbGFzcy4nKTsKICAgICAgcmV0dXJuIFtdOwogICAgfQoKICB9IC8vIFRlbXAgb2JqZWN0cwoKCiAgY29uc3QgQnJvYWRwaGFzZV9jb2xsaXNpb25QYWlyc19yID0gbmV3IFZlYzMoKTsKICBjb25zdCBCcm9hZHBoYXNlX21ha2VQYWlyc1VuaXF1ZV90ZW1wID0gewogICAga2V5czogW10KICB9OwogIGNvbnN0IEJyb2FkcGhhc2VfbWFrZVBhaXJzVW5pcXVlX3AxID0gW107CiAgY29uc3QgQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDIgPSBbXTsKCiAgbmV3IFZlYzMoKTsKICAvKioKICAgKiBOYWl2ZSBicm9hZHBoYXNlIGltcGxlbWVudGF0aW9uLCB1c2VkIGluIGxhY2sgb2YgYmV0dGVyIG9uZXMuCiAgICoKICAgKiBUaGUgbmFpdmUgYnJvYWRwaGFzZSBsb29rcyBhdCBhbGwgcG9zc2libGUgcGFpcnMgd2l0aG91dCByZXN0cmljdGlvbiwgdGhlcmVmb3JlIGl0IGhhcyBjb21wbGV4aXR5IE5eMiBfKHdoaWNoIGlzIGJhZClfCiAgICovCgogIGNsYXNzIE5haXZlQnJvYWRwaGFzZSBleHRlbmRzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBAdG9kbyBSZW1vdmUgdXNlbGVzcyBjb25zdHJ1Y3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCB0aGUgY29sbGlzaW9uIHBhaXJzIGluIHRoZSBwaHlzaWNzIHdvcmxkCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHBhaXJzMSwgcGFpcnMyKSB7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgbiA9IGJvZGllcy5sZW5ndGg7CiAgICAgIGxldCBiaTsKICAgICAgbGV0IGJqOyAvLyBOYWl2ZSBOXjIgZnR3IQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IG47IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBpOyBqKyspIHsKICAgICAgICAgIGJpID0gYm9kaWVzW2ldOwogICAgICAgICAgYmogPSBib2RpZXNbal07CgogICAgICAgICAgaWYgKCF0aGlzLm5lZWRCcm9hZHBoYXNlQ29sbGlzaW9uKGJpLCBiaikpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcGFpcnMxLCBwYWlyczIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0ID0gW10pIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3b3JsZC5ib2RpZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBiID0gd29ybGQuYm9kaWVzW2ldOwoKICAgICAgICBpZiAoYi5hYWJiTmVlZHNVcGRhdGUpIHsKICAgICAgICAgIGIudXBkYXRlQUFCQigpOwogICAgICAgIH0gLy8gVWdseSBoYWNrIHVudGlsIEJvZHkgZ2V0cyBhYWJiCgoKICAgICAgICBpZiAoYi5hYWJiLm92ZXJsYXBzKGFhYmIpKSB7CiAgICAgICAgICByZXN1bHQucHVzaChiKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogIH0KICAvKioKICAgKiBTdG9yYWdlIGZvciBSYXkgY2FzdGluZyBkYXRhCiAgICovCgoKICBjbGFzcyBSYXljYXN0UmVzdWx0IHsKICAgIC8qKgogICAgICogcmF5RnJvbVdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIHJheVRvV29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogaGl0Tm9ybWFsV29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogaGl0UG9pbnRXb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBoYXNIaXQKICAgICAqLwoKICAgIC8qKgogICAgICogc2hhcGUKICAgICAqLwoKICAgIC8qKgogICAgICogYm9keQogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgaW5kZXggb2YgdGhlIGhpdCB0cmlhbmdsZSwgaWYgdGhlIGhpdCBzaGFwZSB3YXMgYSB0cmltZXNoCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3RhbmNlIHRvIHRoZSBoaXQuIFdpbGwgYmUgc2V0IHRvIC0xIGlmIHRoZXJlIHdhcyBubyBoaXQKICAgICAqLwoKICAgIC8qKgogICAgICogSWYgdGhlIHJheSBzaG91bGQgc3RvcCB0cmF2ZXJzaW5nIHRoZSBib2RpZXMKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMucmF5RnJvbVdvcmxkID0gdm9pZCAwOwogICAgICB0aGlzLnJheVRvV29ybGQgPSB2b2lkIDA7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQgPSB2b2lkIDA7CiAgICAgIHRoaXMuaGl0UG9pbnRXb3JsZCA9IHZvaWQgMDsKICAgICAgdGhpcy5oYXNIaXQgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2hhcGUgPSB2b2lkIDA7CiAgICAgIHRoaXMuYm9keSA9IHZvaWQgMDsKICAgICAgdGhpcy5oaXRGYWNlSW5kZXggPSB2b2lkIDA7CiAgICAgIHRoaXMuZGlzdGFuY2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2hvdWxkU3RvcCA9IHZvaWQgMDsKICAgICAgdGhpcy5yYXlGcm9tV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnJheVRvV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmhpdE5vcm1hbFdvcmxkID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5oaXRQb2ludFdvcmxkID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5oYXNIaXQgPSBmYWxzZTsKICAgICAgdGhpcy5zaGFwZSA9IG51bGw7CiAgICAgIHRoaXMuYm9keSA9IG51bGw7CiAgICAgIHRoaXMuaGl0RmFjZUluZGV4ID0gLTE7CiAgICAgIHRoaXMuZGlzdGFuY2UgPSAtMTsKICAgICAgdGhpcy5zaG91bGRTdG9wID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIFJlc2V0IGFsbCByZXN1bHQgZGF0YS4KICAgICAqLwoKCiAgICByZXNldCgpIHsKICAgICAgdGhpcy5yYXlGcm9tV29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLnJheVRvV29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLmhpdE5vcm1hbFdvcmxkLnNldFplcm8oKTsKICAgICAgdGhpcy5oaXRQb2ludFdvcmxkLnNldFplcm8oKTsKICAgICAgdGhpcy5oYXNIaXQgPSBmYWxzZTsKICAgICAgdGhpcy5zaGFwZSA9IG51bGw7CiAgICAgIHRoaXMuYm9keSA9IG51bGw7CiAgICAgIHRoaXMuaGl0RmFjZUluZGV4ID0gLTE7CiAgICAgIHRoaXMuZGlzdGFuY2UgPSAtMTsKICAgICAgdGhpcy5zaG91bGRTdG9wID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIGFib3J0CiAgICAgKi8KCgogICAgYWJvcnQoKSB7CiAgICAgIHRoaXMuc2hvdWxkU3RvcCA9IHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIFNldCByZXN1bHQgZGF0YS4KICAgICAqLwoKCiAgICBzZXQocmF5RnJvbVdvcmxkLCByYXlUb1dvcmxkLCBoaXROb3JtYWxXb3JsZCwgaGl0UG9pbnRXb3JsZCwgc2hhcGUsIGJvZHksIGRpc3RhbmNlKSB7CiAgICAgIHRoaXMucmF5RnJvbVdvcmxkLmNvcHkocmF5RnJvbVdvcmxkKTsKICAgICAgdGhpcy5yYXlUb1dvcmxkLmNvcHkocmF5VG9Xb3JsZCk7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQuY29weShoaXROb3JtYWxXb3JsZCk7CiAgICAgIHRoaXMuaGl0UG9pbnRXb3JsZC5jb3B5KGhpdFBvaW50V29ybGQpOwogICAgICB0aGlzLnNoYXBlID0gc2hhcGU7CiAgICAgIHRoaXMuYm9keSA9IGJvZHk7CiAgICAgIHRoaXMuZGlzdGFuY2UgPSBkaXN0YW5jZTsKICAgIH0KCiAgfQoKICBsZXQgX1NoYXBlJHR5cGVzJFNQSEVSRSwgX1NoYXBlJHR5cGVzJFBMQU5FLCBfU2hhcGUkdHlwZXMkQk9YLCBfU2hhcGUkdHlwZXMkQ1lMSU5ERVIsIF9TaGFwZSR0eXBlcyRDT05WRVhQTywgX1NoYXBlJHR5cGVzJEhFSUdIVEZJLCBfU2hhcGUkdHlwZXMkVFJJTUVTSDsKICAvKioKICAgKiBSQVlfTU9ERVMKICAgKi8KCgogIGNvbnN0IFJBWV9NT0RFUyA9IHsKICAgIC8qKiBDTE9TRVNUICovCiAgICBDTE9TRVNUOiAxLAoKICAgIC8qKiBBTlkgKi8KICAgIEFOWTogMiwKCiAgICAvKiogQUxMICovCiAgICBBTEw6IDQKICB9OwogIC8qKgogICAqIFJheU1vZGUKICAgKi8KCiAgX1NoYXBlJHR5cGVzJFNQSEVSRSA9IFNoYXBlLnR5cGVzLlNQSEVSRTsKICBfU2hhcGUkdHlwZXMkUExBTkUgPSBTaGFwZS50eXBlcy5QTEFORTsKICBfU2hhcGUkdHlwZXMkQk9YID0gU2hhcGUudHlwZXMuQk9YOwogIF9TaGFwZSR0eXBlcyRDWUxJTkRFUiA9IFNoYXBlLnR5cGVzLkNZTElOREVSOwogIF9TaGFwZSR0eXBlcyRDT05WRVhQTyA9IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST047CiAgX1NoYXBlJHR5cGVzJEhFSUdIVEZJID0gU2hhcGUudHlwZXMuSEVJR0hURklFTEQ7CiAgX1NoYXBlJHR5cGVzJFRSSU1FU0ggPSBTaGFwZS50eXBlcy5UUklNRVNIOwogIC8qKgogICAqIEEgbGluZSBpbiAzRCBzcGFjZSB0aGF0IGludGVyc2VjdHMgYm9kaWVzIGFuZCByZXR1cm4gcG9pbnRzLgogICAqLwoKICBjbGFzcyBSYXkgewogICAgLyoqCiAgICAgKiBmcm9tCiAgICAgKi8KCiAgICAvKioKICAgICAqIHRvCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRpcmVjdGlvbgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgcHJlY2lzaW9uIG9mIHRoZSByYXkuIFVzZWQgd2hlbiBjaGVja2luZyBwYXJhbGxlbGl0eSBldGMuCiAgICAgKiBAZGVmYXVsdCAwLjAwMDEKICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIGBmYWxzZWAgaWYgeW91IGRvbid0IHdhbnQgdGhlIFJheSB0byB0YWtlIGBjb2xsaXNpb25SZXNwb25zZWAgZmxhZ3MgaW50byBhY2NvdW50IG9uIGJvZGllcyBhbmQgc2hhcGVzLgogICAgICogQGRlZmF1bHQgdHJ1ZQogICAgICovCgogICAgLyoqCiAgICAgKiBJZiBzZXQgdG8gYHRydWVgLCB0aGUgcmF5IHNraXBzIGFueSBoaXRzIHdpdGggbm9ybWFsLmRvdChyYXlEaXJlY3Rpb24pIDwgMC4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNvbGxpc2lvbkZpbHRlck1hc2sKICAgICAqIEBkZWZhdWx0IC0xCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNvbGxpc2lvbkZpbHRlckdyb3VwCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgaW50ZXJzZWN0aW9uIG1vZGUuIFNob3VsZCBiZSBSYXkuQU5ZLCBSYXkuQUxMIG9yIFJheS5DTE9TRVNULgogICAgICogQGRlZmF1bHQgUkFZLkFOWQogICAgICovCgogICAgLyoqCiAgICAgKiBDdXJyZW50IHJlc3VsdCBvYmplY3QuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdpbGwgYmUgc2V0IHRvIGB0cnVlYCBkdXJpbmcgaW50ZXJzZWN0V29ybGQoKSBpZiB0aGUgcmF5IGhpdCBhbnl0aGluZy4KICAgICAqLwoKICAgIC8qKgogICAgICogVXNlci1wcm92aWRlZCByZXN1bHQgY2FsbGJhY2suIFdpbGwgYmUgdXNlZCBpZiBtb2RlIGlzIFJheS5BTEwuCiAgICAgKi8KCiAgICAvKioKICAgICAqIENMT1NFU1QKICAgICAqLwoKICAgIC8qKgogICAgICogQU5ZCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFMTAogICAgICovCiAgICBnZXQgW19TaGFwZSR0eXBlcyRTUEhFUkVdKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0U3BoZXJlOwogICAgfQoKICAgIGdldCBbX1NoYXBlJHR5cGVzJFBMQU5FXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdFBsYW5lOwogICAgfQoKICAgIGdldCBbX1NoYXBlJHR5cGVzJEJPWF0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RCb3g7CiAgICB9CgogICAgZ2V0IFtfU2hhcGUkdHlwZXMkQ1lMSU5ERVJdKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0Q29udmV4OwogICAgfQoKICAgIGdldCBbX1NoYXBlJHR5cGVzJENPTlZFWFBPXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleDsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRIRUlHSFRGSV0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RIZWlnaHRmaWVsZDsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRUUklNRVNIXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdFRyaW1lc2g7CiAgICB9CgogICAgY29uc3RydWN0b3IoZnJvbSA9IG5ldyBWZWMzKCksIHRvID0gbmV3IFZlYzMoKSkgewogICAgICB0aGlzLmZyb20gPSB2b2lkIDA7CiAgICAgIHRoaXMudG8gPSB2b2lkIDA7CiAgICAgIHRoaXMuZGlyZWN0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLnByZWNpc2lvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5jaGVja0NvbGxpc2lvblJlc3BvbnNlID0gdm9pZCAwOwogICAgICB0aGlzLnNraXBCYWNrZmFjZXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyTWFzayA9IHZvaWQgMDsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IHZvaWQgMDsKICAgICAgdGhpcy5tb2RlID0gdm9pZCAwOwogICAgICB0aGlzLnJlc3VsdCA9IHZvaWQgMDsKICAgICAgdGhpcy5oYXNIaXQgPSB2b2lkIDA7CiAgICAgIHRoaXMuY2FsbGJhY2sgPSB2b2lkIDA7CiAgICAgIHRoaXMuZnJvbSA9IGZyb20uY2xvbmUoKTsKICAgICAgdGhpcy50byA9IHRvLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5wcmVjaXNpb24gPSAwLjAwMDE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRydWU7CiAgICAgIHRoaXMuc2tpcEJhY2tmYWNlcyA9IGZhbHNlOwogICAgICB0aGlzLmNvbGxpc2lvbkZpbHRlck1hc2sgPSAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IC0xOwogICAgICB0aGlzLm1vZGUgPSBSYXkuQU5ZOwogICAgICB0aGlzLnJlc3VsdCA9IG5ldyBSYXljYXN0UmVzdWx0KCk7CiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CgogICAgICB0aGlzLmNhbGxiYWNrID0gcmVzdWx0ID0+IHt9OwogICAgfQogICAgLyoqCiAgICAgKiBEbyBpdGVyc2VjdGlvbiBhZ2FpbnN0IGFsbCBib2RpZXMgaW4gdGhlIGdpdmVuIFdvcmxkLgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSByYXkgaGl0IGFueXRoaW5nLCBvdGhlcndpc2UgZmFsc2UuCiAgICAgKi8KCgogICAgaW50ZXJzZWN0V29ybGQod29ybGQsIG9wdGlvbnMpIHsKICAgICAgdGhpcy5tb2RlID0gb3B0aW9ucy5tb2RlIHx8IFJheS5BTlk7CiAgICAgIHRoaXMucmVzdWx0ID0gb3B0aW9ucy5yZXN1bHQgfHwgbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy5za2lwQmFja2ZhY2VzID0gISFvcHRpb25zLnNraXBCYWNrZmFjZXM7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyTWFzayA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJNYXNrIDogLTE7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogLTE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNoZWNrQ29sbGlzaW9uUmVzcG9uc2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jaGVja0NvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKCiAgICAgIGlmIChvcHRpb25zLmZyb20pIHsKICAgICAgICB0aGlzLmZyb20uY29weShvcHRpb25zLmZyb20pOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy50bykgewogICAgICAgIHRoaXMudG8uY29weShvcHRpb25zLnRvKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWxsYmFjayA9IG9wdGlvbnMuY2FsbGJhY2sgfHwgKCgpID0+IHt9KTsKCiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CiAgICAgIHRoaXMucmVzdWx0LnJlc2V0KCk7CiAgICAgIHRoaXMudXBkYXRlRGlyZWN0aW9uKCk7CiAgICAgIHRoaXMuZ2V0QUFCQih0bXBBQUJCJDEpOwogICAgICB0bXBBcnJheS5sZW5ndGggPSAwOwogICAgICB3b3JsZC5icm9hZHBoYXNlLmFhYmJRdWVyeSh3b3JsZCwgdG1wQUFCQiQxLCB0bXBBcnJheSk7CiAgICAgIHRoaXMuaW50ZXJzZWN0Qm9kaWVzKHRtcEFycmF5KTsKICAgICAgcmV0dXJuIHRoaXMuaGFzSGl0OwogICAgfQogICAgLyoqCiAgICAgKiBTaG9vdCBhIHJheSBhdCBhIGJvZHksIGdldCBiYWNrIGluZm9ybWF0aW9uIGFib3V0IHRoZSBoaXQuCiAgICAgKiBAZGVwcmVjYXRlZCBAcGFyYW0gcmVzdWx0IHNldCB0aGUgcmVzdWx0IHByb3BlcnR5IG9mIHRoZSBSYXkgaW5zdGVhZC4KICAgICAqLwoKCiAgICBpbnRlcnNlY3RCb2R5KGJvZHksIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgY29uc3QgY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZTsKCiAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFib2R5LmNvbGxpc2lvblJlc3BvbnNlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoKHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgJiBib2R5LmNvbGxpc2lvbkZpbHRlck1hc2spID09PSAwIHx8IChib2R5LmNvbGxpc2lvbkZpbHRlckdyb3VwICYgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrKSA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgeGkgPSBpbnRlcnNlY3RCb2R5X3hpOwogICAgICBjb25zdCBxaSA9IGludGVyc2VjdEJvZHlfcWk7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IGJvZHkuc2hhcGVzLmxlbmd0aDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlID0gYm9keS5zaGFwZXNbaV07CgogICAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFzaGFwZS5jb2xsaXNpb25SZXNwb25zZSkgewogICAgICAgICAgY29udGludWU7IC8vIFNraXAKICAgICAgICB9CgogICAgICAgIGJvZHkucXVhdGVybmlvbi5tdWx0KGJvZHkuc2hhcGVPcmllbnRhdGlvbnNbaV0sIHFpKTsKICAgICAgICBib2R5LnF1YXRlcm5pb24udm11bHQoYm9keS5zaGFwZU9mZnNldHNbaV0sIHhpKTsKICAgICAgICB4aS52YWRkKGJvZHkucG9zaXRpb24sIHhpKTsKICAgICAgICB0aGlzLmludGVyc2VjdFNoYXBlKHNoYXBlLCBxaSwgeGksIGJvZHkpOwoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFNob290IGEgcmF5IGF0IGFuIGFycmF5IGJvZGllcywgZ2V0IGJhY2sgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGhpdC4KICAgICAqIEBwYXJhbSBib2RpZXMgQW4gYXJyYXkgb2YgQm9keSBvYmplY3RzLgogICAgICogQGRlcHJlY2F0ZWQgQHBhcmFtIHJlc3VsdCBzZXQgdGhlIHJlc3VsdCBwcm9wZXJ0eSBvZiB0aGUgUmF5IGluc3RlYWQuCiAgICAgKgogICAgICovCgoKICAgIGludGVyc2VjdEJvZGllcyhib2RpZXMsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBib2RpZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpIDwgbDsgaSsrKSB7CiAgICAgICAgdGhpcy5pbnRlcnNlY3RCb2R5KGJvZGllc1tpXSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyB0aGUgZGlyZWN0aW9uIHZlY3Rvci4KICAgICAqLwoKCiAgICB1cGRhdGVEaXJlY3Rpb24oKSB7CiAgICAgIHRoaXMudG8udnN1Yih0aGlzLmZyb20sIHRoaXMuZGlyZWN0aW9uKTsKICAgICAgdGhpcy5kaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICB9CgogICAgaW50ZXJzZWN0U2hhcGUoc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5KSB7CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207IC8vIENoZWNraW5nIGJvdW5kaW5nU3BoZXJlCgogICAgICBjb25zdCBkaXN0YW5jZSA9IGRpc3RhbmNlRnJvbUludGVyc2VjdGlvbihmcm9tLCB0aGlzLmRpcmVjdGlvbiwgcG9zaXRpb24pOwoKICAgICAgaWYgKGRpc3RhbmNlID4gc2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGludGVyc2VjdE1ldGhvZCA9IHRoaXNbc2hhcGUudHlwZV07CgogICAgICBpZiAoaW50ZXJzZWN0TWV0aG9kKSB7CiAgICAgICAgaW50ZXJzZWN0TWV0aG9kLmNhbGwodGhpcywgc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCBzaGFwZSk7CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Qm94KGJveCwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleChib3guY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSk7CiAgICB9CgogICAgX2ludGVyc2VjdFBsYW5lKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBjb25zdCBmcm9tID0gdGhpcy5mcm9tOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uOyAvLyBHZXQgcGxhbmUgbm9ybWFsCgogICAgICBjb25zdCB3b3JsZE5vcm1hbCA9IG5ldyBWZWMzKDAsIDAsIDEpOwogICAgICBxdWF0LnZtdWx0KHdvcmxkTm9ybWFsLCB3b3JsZE5vcm1hbCk7CiAgICAgIGNvbnN0IGxlbiA9IG5ldyBWZWMzKCk7CiAgICAgIGZyb20udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb0Zyb20gPSBsZW4uZG90KHdvcmxkTm9ybWFsKTsKICAgICAgdG8udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb1RvID0gbGVuLmRvdCh3b3JsZE5vcm1hbCk7CgogICAgICBpZiAocGxhbmVUb0Zyb20gKiBwbGFuZVRvVG8gPiAwKSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIGFyZSBvbiB0aGUgc2FtZSBzaWRlIG9mIHRoZSBwbGFuZS4uLiBiYWlsIG91dAogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGZyb20uZGlzdGFuY2VUbyh0bykgPCBwbGFuZVRvRnJvbSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgbl9kb3RfZGlyID0gd29ybGROb3JtYWwuZG90KGRpcmVjdGlvbik7CgogICAgICBpZiAoTWF0aC5hYnMobl9kb3RfZGlyKSA8IHRoaXMucHJlY2lzaW9uKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBwbGFuZVBvaW50VG9Gcm9tID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgZGlyX3NjYWxlZF93aXRoX3QgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBoaXRQb2ludFdvcmxkID0gbmV3IFZlYzMoKTsKICAgICAgZnJvbS52c3ViKHBvc2l0aW9uLCBwbGFuZVBvaW50VG9Gcm9tKTsKICAgICAgY29uc3QgdCA9IC13b3JsZE5vcm1hbC5kb3QocGxhbmVQb2ludFRvRnJvbSkgLyBuX2RvdF9kaXI7CiAgICAgIGRpcmVjdGlvbi5zY2FsZSh0LCBkaXJfc2NhbGVkX3dpdGhfdCk7CiAgICAgIGZyb20udmFkZChkaXJfc2NhbGVkX3dpdGhfdCwgaGl0UG9pbnRXb3JsZCk7CiAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKHdvcmxkTm9ybWFsLCBoaXRQb2ludFdvcmxkLCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgd29ybGQgQUFCQiBvZiB0aGUgcmF5LgogICAgICovCgoKICAgIGdldEFBQkIoYWFiYikgewogICAgICBjb25zdCB7CiAgICAgICAgbG93ZXJCb3VuZCwKICAgICAgICB1cHBlckJvdW5kCiAgICAgIH0gPSBhYWJiOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGxvd2VyQm91bmQueCA9IE1hdGgubWluKHRvLngsIGZyb20ueCk7CiAgICAgIGxvd2VyQm91bmQueSA9IE1hdGgubWluKHRvLnksIGZyb20ueSk7CiAgICAgIGxvd2VyQm91bmQueiA9IE1hdGgubWluKHRvLnosIGZyb20ueik7CiAgICAgIHVwcGVyQm91bmQueCA9IE1hdGgubWF4KHRvLngsIGZyb20ueCk7CiAgICAgIHVwcGVyQm91bmQueSA9IE1hdGgubWF4KHRvLnksIGZyb20ueSk7CiAgICAgIHVwcGVyQm91bmQueiA9IE1hdGgubWF4KHRvLnosIGZyb20ueik7CiAgICB9CgogICAgX2ludGVyc2VjdEhlaWdodGZpZWxkKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBzaGFwZS5kYXRhOwogICAgICBzaGFwZS5lbGVtZW50U2l6ZTsgLy8gQ29udmVydCB0aGUgcmF5IHRvIGxvY2FsIGhlaWdodGZpZWxkIGNvb3JkaW5hdGVzCgogICAgICBjb25zdCBsb2NhbFJheSA9IGludGVyc2VjdEhlaWdodGZpZWxkX2xvY2FsUmF5OyAvL25ldyBSYXkodGhpcy5mcm9tLCB0aGlzLnRvKTsKCiAgICAgIGxvY2FsUmF5LmZyb20uY29weSh0aGlzLmZyb20pOwogICAgICBsb2NhbFJheS50by5jb3B5KHRoaXMudG8pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LmZyb20sIGxvY2FsUmF5LmZyb20pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LnRvLCBsb2NhbFJheS50byk7CiAgICAgIGxvY2FsUmF5LnVwZGF0ZURpcmVjdGlvbigpOyAvLyBHZXQgdGhlIGluZGV4IG9mIHRoZSBkYXRhIHBvaW50cyB0byB0ZXN0IGFnYWluc3QKCiAgICAgIGNvbnN0IGluZGV4ID0gaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXg7CiAgICAgIGxldCBpTWluWDsKICAgICAgbGV0IGlNaW5ZOwogICAgICBsZXQgaU1heFg7CiAgICAgIGxldCBpTWF4WTsgLy8gU2V0IHRvIG1heAoKICAgICAgaU1pblggPSBpTWluWSA9IDA7CiAgICAgIGlNYXhYID0gaU1heFkgPSBzaGFwZS5kYXRhLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGFhYmIgPSBuZXcgQUFCQigpOwogICAgICBsb2NhbFJheS5nZXRBQUJCKGFhYmIpOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi5sb3dlckJvdW5kLngsIGFhYmIubG93ZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNaW5YID0gTWF0aC5tYXgoaU1pblgsIGluZGV4WzBdKTsKICAgICAgaU1pblkgPSBNYXRoLm1heChpTWluWSwgaW5kZXhbMV0pOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNYXhYID0gTWF0aC5taW4oaU1heFgsIGluZGV4WzBdICsgMSk7CiAgICAgIGlNYXhZID0gTWF0aC5taW4oaU1heFksIGluZGV4WzFdICsgMSk7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPCBpTWF4WDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IGlNaW5ZOyBqIDwgaU1heFk7IGorKykgewogICAgICAgICAgaWYgKHRoaXMucmVzdWx0LnNob3VsZFN0b3ApIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHNoYXBlLmdldEFhYmJBdEluZGV4KGksIGosIGFhYmIpOwoKICAgICAgICAgIGlmICghYWFiYi5vdmVybGFwc1JheShsb2NhbFJheSkpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9IC8vIExvd2VyIHRyaWFuZ2xlCgoKICAgICAgICAgIHNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdCwgc2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgdGhpcy5faW50ZXJzZWN0Q29udmV4KHNoYXBlLnBpbGxhckNvbnZleCwgcXVhdCwgd29ybGRQaWxsYXJPZmZzZXQsIGJvZHksIHJlcG9ydGVkU2hhcGUsIGludGVyc2VjdENvbnZleE9wdGlvbnMpOwoKICAgICAgICAgIGlmICh0aGlzLnJlc3VsdC5zaG91bGRTdG9wKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgc2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgdHJ1ZSk7CiAgICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIHNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIHRoaXMuX2ludGVyc2VjdENvbnZleChzaGFwZS5waWxsYXJDb252ZXgsIHF1YXQsIHdvcmxkUGlsbGFyT2Zmc2V0LCBib2R5LCByZXBvcnRlZFNoYXBlLCBpbnRlcnNlY3RDb252ZXhPcHRpb25zKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0U3BoZXJlKHNwaGVyZSwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCByID0gc3BoZXJlLnJhZGl1czsKICAgICAgY29uc3QgYSA9ICh0by54IC0gZnJvbS54KSAqKiAyICsgKHRvLnkgLSBmcm9tLnkpICoqIDIgKyAodG8ueiAtIGZyb20ueikgKiogMjsKICAgICAgY29uc3QgYiA9IDIgKiAoKHRvLnggLSBmcm9tLngpICogKGZyb20ueCAtIHBvc2l0aW9uLngpICsgKHRvLnkgLSBmcm9tLnkpICogKGZyb20ueSAtIHBvc2l0aW9uLnkpICsgKHRvLnogLSBmcm9tLnopICogKGZyb20ueiAtIHBvc2l0aW9uLnopKTsKICAgICAgY29uc3QgYyA9IChmcm9tLnggLSBwb3NpdGlvbi54KSAqKiAyICsgKGZyb20ueSAtIHBvc2l0aW9uLnkpICoqIDIgKyAoZnJvbS56IC0gcG9zaXRpb24ueikgKiogMiAtIHIgKiogMjsKICAgICAgY29uc3QgZGVsdGEgPSBiICoqIDIgLSA0ICogYSAqIGM7CiAgICAgIGNvbnN0IGludGVyc2VjdGlvblBvaW50ID0gUmF5X2ludGVyc2VjdFNwaGVyZV9pbnRlcnNlY3Rpb25Qb2ludDsKICAgICAgY29uc3Qgbm9ybWFsID0gUmF5X2ludGVyc2VjdFNwaGVyZV9ub3JtYWw7CgogICAgICBpZiAoZGVsdGEgPCAwKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKGRlbHRhID09PSAwKSB7CiAgICAgICAgLy8gc2luZ2xlIGludGVyc2VjdGlvbiBwb2ludAogICAgICAgIGZyb20ubGVycCh0bywgZGVsdGEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICBpbnRlcnNlY3Rpb25Qb2ludC52c3ViKHBvc2l0aW9uLCBub3JtYWwpOwogICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgZDEgPSAoLWIgLSBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CiAgICAgICAgY29uc3QgZDIgPSAoLWIgKyBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CgogICAgICAgIGlmIChkMSA+PSAwICYmIGQxIDw9IDEpIHsKICAgICAgICAgIGZyb20ubGVycCh0bywgZDEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICAgIGludGVyc2VjdGlvblBvaW50LnZzdWIocG9zaXRpb24sIG5vcm1hbCk7CiAgICAgICAgICBub3JtYWwubm9ybWFsaXplKCk7CiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKGQyID49IDAgJiYgZDIgPD0gMSkgewogICAgICAgICAgZnJvbS5sZXJwKHRvLCBkMiwgaW50ZXJzZWN0aW9uUG9pbnQpOwogICAgICAgICAgaW50ZXJzZWN0aW9uUG9pbnQudnN1Yihwb3NpdGlvbiwgbm9ybWFsKTsKICAgICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKG5vcm1hbCwgaW50ZXJzZWN0aW9uUG9pbnQsIHJlcG9ydGVkU2hhcGUsIGJvZHksIC0xKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Q29udmV4KHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSwgb3B0aW9ucykgewogICAgICBjb25zdCBub3JtYWwgPSBpbnRlcnNlY3RDb252ZXhfbm9ybWFsOwogICAgICBjb25zdCB2ZWN0b3IgPSBpbnRlcnNlY3RDb252ZXhfdmVjdG9yOwogICAgICBjb25zdCBmYWNlTGlzdCA9IG9wdGlvbnMgJiYgb3B0aW9ucy5mYWNlTGlzdCB8fCBudWxsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgZmFjZXMgPSBzaGFwZS5mYWNlczsKICAgICAgY29uc3QgdmVydGljZXMgPSBzaGFwZS52ZXJ0aWNlczsKICAgICAgY29uc3Qgbm9ybWFscyA9IHNoYXBlLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBkaXJlY3Rpb24gPSB0aGlzLmRpcmVjdGlvbjsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBmcm9tVG9EaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyh0byk7CiAgICAgIGNvbnN0IE5mYWNlcyA9IGZhY2VMaXN0ID8gZmFjZUxpc3QubGVuZ3RoIDogZmFjZXMubGVuZ3RoOwogICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJlc3VsdDsKCiAgICAgIGZvciAobGV0IGogPSAwOyAhcmVzdWx0LnNob3VsZFN0b3AgJiYgaiA8IE5mYWNlczsgaisrKSB7CiAgICAgICAgY29uc3QgZmkgPSBmYWNlTGlzdCA/IGZhY2VMaXN0W2pdIDogajsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbZmldOwogICAgICAgIGNvbnN0IGZhY2VOb3JtYWwgPSBub3JtYWxzW2ZpXTsKICAgICAgICBjb25zdCBxID0gcXVhdDsKICAgICAgICBjb25zdCB4ID0gcG9zaXRpb247IC8vIGRldGVybWluZSBpZiByYXkgaW50ZXJzZWN0cyB0aGUgcGxhbmUgb2YgdGhlIGZhY2UKICAgICAgICAvLyBub3RlOiB0aGlzIHdvcmtzIHJlZ2FyZGxlc3Mgb2YgdGhlIGRpcmVjdGlvbiBvZiB0aGUgZmFjZSBub3JtYWwKICAgICAgICAvLyBHZXQgcGxhbmUgcG9pbnQgaW4gd29ybGQgY29vcmRpbmF0ZXMuLi4KCiAgICAgICAgdmVjdG9yLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQodmVjdG9yLCB2ZWN0b3IpOwogICAgICAgIHZlY3Rvci52YWRkKHgsIHZlY3Rvcik7IC8vIC4uLmJ1dCBtYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSByYXkgZnJvbS4gV2UnbGwgZml4IHRoaXMgbGF0ZXIuCgogICAgICAgIHZlY3Rvci52c3ViKGZyb20sIHZlY3Rvcik7IC8vIEdldCBwbGFuZSBub3JtYWwKCiAgICAgICAgcS52bXVsdChmYWNlTm9ybWFsLCBub3JtYWwpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBkaXJlY3Rpb24uZG90KG5vcm1hbCk7IC8vIEJhaWwgb3V0IGlmIHJheSBhbmQgcGxhbmUgYXJlIHBhcmFsbGVsCgogICAgICAgIGlmIChNYXRoLmFicyhkb3QpIDwgdGhpcy5wcmVjaXNpb24pIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKCiAgICAgICAgY29uc3Qgc2NhbGFyID0gbm9ybWFsLmRvdCh2ZWN0b3IpIC8gZG90OyAvLyBpZiBuZWdhdGl2ZSBkaXN0YW5jZSwgdGhlbiBwbGFuZSBpcyBiZWhpbmQgcmF5CgogICAgICAgIGlmIChzY2FsYXIgPCAwKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IC8vIGlmIChkb3QgPCAwKSB7CiAgICAgICAgLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGRpcmVjdGlvbi5zY2FsZShzY2FsYXIsIGludGVyc2VjdFBvaW50KTsKICAgICAgICBpbnRlcnNlY3RQb2ludC52YWRkKGZyb20sIGludGVyc2VjdFBvaW50KTsgLy8gYSBpcyB0aGUgcG9pbnQgd2UgY29tcGFyZSBwb2ludHMgYiBhbmQgYyB3aXRoLgoKICAgICAgICBhLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQoYSwgYSk7CiAgICAgICAgeC52YWRkKGEsIGEpOwoKICAgICAgICBmb3IgKGxldCBpID0gMTsgIXJlc3VsdC5zaG91bGRTdG9wICYmIGkgPCBmYWNlLmxlbmd0aCAtIDE7IGkrKykgewogICAgICAgICAgLy8gVHJhbnNmb3JtIDMgdmVydGljZXMgdG8gd29ybGQgY29vcmRzCiAgICAgICAgICBiLmNvcHkodmVydGljZXNbZmFjZVtpXV0pOwogICAgICAgICAgYy5jb3B5KHZlcnRpY2VzW2ZhY2VbaSArIDFdXSk7CiAgICAgICAgICBxLnZtdWx0KGIsIGIpOwogICAgICAgICAgcS52bXVsdChjLCBjKTsKICAgICAgICAgIHgudmFkZChiLCBiKTsKICAgICAgICAgIHgudmFkZChjLCBjKTsKICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gaW50ZXJzZWN0UG9pbnQuZGlzdGFuY2VUbyhmcm9tKTsKCiAgICAgICAgICBpZiAoIShSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBhLCBiLCBjKSB8fCBSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBiLCBhLCBjKSkgfHwgZGlzdGFuY2UgPiBmcm9tVG9EaXN0YW5jZSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdFBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCBmaSk7CiAgICAgICAgfSAvLyB9CgogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIE9wdGltaXplIGJ5IHRyYW5zZm9ybWluZyB0aGUgd29ybGQgdG8gbG9jYWwgc3BhY2UgZmlyc3QuCiAgICAgKiBAdG9kbyBVc2UgT2N0cmVlIGxvb2t1cAogICAgICovCgoKICAgIF9pbnRlcnNlY3RUcmltZXNoKG1lc2gsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCByZXBvcnRlZFNoYXBlLCBvcHRpb25zKSB7CiAgICAgIGNvbnN0IG5vcm1hbCA9IGludGVyc2VjdFRyaW1lc2hfbm9ybWFsOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBpbnRlcnNlY3RUcmltZXNoX3RyaWFuZ2xlczsKICAgICAgY29uc3QgdHJlZVRyYW5zZm9ybSA9IGludGVyc2VjdFRyaW1lc2hfdHJlZVRyYW5zZm9ybTsKICAgICAgY29uc3QgdmVjdG9yID0gaW50ZXJzZWN0Q29udmV4X3ZlY3RvcjsKICAgICAgY29uc3QgbG9jYWxEaXJlY3Rpb24gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRGlyZWN0aW9uOwogICAgICBjb25zdCBsb2NhbEZyb20gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRnJvbTsKICAgICAgY29uc3QgbG9jYWxUbyA9IGludGVyc2VjdFRyaW1lc2hfbG9jYWxUbzsKICAgICAgY29uc3Qgd29ybGRJbnRlcnNlY3RQb2ludCA9IGludGVyc2VjdFRyaW1lc2hfd29ybGRJbnRlcnNlY3RQb2ludDsKICAgICAgY29uc3Qgd29ybGROb3JtYWwgPSBpbnRlcnNlY3RUcmltZXNoX3dvcmxkTm9ybWFsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgaW5kaWNlcyA9IG1lc2guaW5kaWNlczsKICAgICAgbWVzaC52ZXJ0aWNlczsgLy8gY29uc3Qgbm9ybWFscyA9IG1lc2guZmFjZU5vcm1hbHMKCiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGNvbnN0IHRvID0gdGhpcy50bzsKICAgICAgY29uc3QgZGlyZWN0aW9uID0gdGhpcy5kaXJlY3Rpb247CiAgICAgIHRyZWVUcmFuc2Zvcm0ucG9zaXRpb24uY29weShwb3NpdGlvbik7CiAgICAgIHRyZWVUcmFuc2Zvcm0ucXVhdGVybmlvbi5jb3B5KHF1YXQpOyAvLyBUcmFuc2Zvcm0gcmF5IHRvIGxvY2FsIHNwYWNlIQoKICAgICAgVHJhbnNmb3JtLnZlY3RvclRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZGlyZWN0aW9uLCBsb2NhbERpcmVjdGlvbik7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZnJvbSwgbG9jYWxGcm9tKTsKICAgICAgVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0LCB0bywgbG9jYWxUbyk7CiAgICAgIGxvY2FsVG8ueCAqPSBtZXNoLnNjYWxlLng7CiAgICAgIGxvY2FsVG8ueSAqPSBtZXNoLnNjYWxlLnk7CiAgICAgIGxvY2FsVG8ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsRnJvbS54ICo9IG1lc2guc2NhbGUueDsKICAgICAgbG9jYWxGcm9tLnkgKj0gbWVzaC5zY2FsZS55OwogICAgICBsb2NhbEZyb20ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsVG8udnN1Yihsb2NhbEZyb20sIGxvY2FsRGlyZWN0aW9uKTsKICAgICAgbG9jYWxEaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICAgIGNvbnN0IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCA9IGxvY2FsRnJvbS5kaXN0YW5jZVNxdWFyZWQobG9jYWxUbyk7CiAgICAgIG1lc2gudHJlZS5yYXlRdWVyeSh0aGlzLCB0cmVlVHJhbnNmb3JtLCB0cmlhbmdsZXMpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB0cmlhbmdsZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCB0cmlhbmdsZXNJbmRleCA9IHRyaWFuZ2xlc1tpXTsKICAgICAgICBtZXNoLmdldE5vcm1hbCh0cmlhbmdsZXNJbmRleCwgbm9ybWFsKTsgLy8gZGV0ZXJtaW5lIGlmIHJheSBpbnRlcnNlY3RzIHRoZSBwbGFuZSBvZiB0aGUgZmFjZQogICAgICAgIC8vIG5vdGU6IHRoaXMgd29ya3MgcmVnYXJkbGVzcyBvZiB0aGUgZGlyZWN0aW9uIG9mIHRoZSBmYWNlIG5vcm1hbAogICAgICAgIC8vIEdldCBwbGFuZSBwb2ludCBpbiB3b3JsZCBjb29yZGluYXRlcy4uLgoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogM10sIGEpOyAvLyAuLi5idXQgbWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgcmF5IGZyb20uIFdlJ2xsIGZpeCB0aGlzIGxhdGVyLgoKICAgICAgICBhLnZzdWIobG9jYWxGcm9tLCB2ZWN0b3IpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBsb2NhbERpcmVjdGlvbi5kb3Qobm9ybWFsKTsgLy8gQmFpbCBvdXQgaWYgcmF5IGFuZCBwbGFuZSBhcmUgcGFyYWxsZWwKICAgICAgICAvLyBpZiAoTWF0aC5hYnMoIGRvdCApIDwgdGhpcy5wcmVjaXNpb24pewogICAgICAgIC8vICAgICBjb250aW51ZTsKICAgICAgICAvLyB9CiAgICAgICAgLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKICAgICAgICBjb25zdCBzY2FsYXIgPSBub3JtYWwuZG90KHZlY3RvcikgLyBkb3Q7IC8vIGlmIG5lZ2F0aXZlIGRpc3RhbmNlLCB0aGVuIHBsYW5lIGlzIGJlaGluZCByYXkKCiAgICAgICAgaWYgKHNjYWxhciA8IDApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGxvY2FsRGlyZWN0aW9uLnNjYWxlKHNjYWxhciwgaW50ZXJzZWN0UG9pbnQpOwogICAgICAgIGludGVyc2VjdFBvaW50LnZhZGQobG9jYWxGcm9tLCBpbnRlcnNlY3RQb2ludCk7IC8vIEdldCB0cmlhbmdsZSB2ZXJ0aWNlcwoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDFdLCBiKTsKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDJdLCBjKTsKICAgICAgICBjb25zdCBzcXVhcmVkRGlzdGFuY2UgPSBpbnRlcnNlY3RQb2ludC5kaXN0YW5jZVNxdWFyZWQobG9jYWxGcm9tKTsKCiAgICAgICAgaWYgKCEoUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYiwgYSwgYykgfHwgUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYSwgYiwgYykpIHx8IHNxdWFyZWREaXN0YW5jZSA+IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfSAvLyB0cmFuc2Zvcm0gaW50ZXJzZWN0cG9pbnQgYW5kIG5vcm1hbCB0byB3b3JsZAoKCiAgICAgICAgVHJhbnNmb3JtLnZlY3RvclRvV29ybGRGcmFtZShxdWF0LCBub3JtYWwsIHdvcmxkTm9ybWFsKTsKICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIGludGVyc2VjdFBvaW50LCB3b3JsZEludGVyc2VjdFBvaW50KTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbih3b3JsZE5vcm1hbCwgd29ybGRJbnRlcnNlY3RQb2ludCwgcmVwb3J0ZWRTaGFwZSwgYm9keSwgdHJpYW5nbGVzSW5kZXgpOwogICAgICB9CgogICAgICB0cmlhbmdsZXMubGVuZ3RoID0gMDsKICAgIH0KICAgIC8qKgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBpbnRlcnNlY3Rpb25zIHNob3VsZCBjb250aW51ZQogICAgICovCgoKICAgIHJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBoaXRGYWNlSW5kZXgpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBkaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyhoaXRQb2ludFdvcmxkKTsKICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5yZXN1bHQ7IC8vIFNraXAgYmFjayBmYWNlcz8KCiAgICAgIGlmICh0aGlzLnNraXBCYWNrZmFjZXMgJiYgbm9ybWFsLmRvdCh0aGlzLmRpcmVjdGlvbikgPiAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICByZXN1bHQuaGl0RmFjZUluZGV4ID0gdHlwZW9mIGhpdEZhY2VJbmRleCAhPT0gJ3VuZGVmaW5lZCcgPyBoaXRGYWNlSW5kZXggOiAtMTsKCiAgICAgIHN3aXRjaCAodGhpcy5tb2RlKSB7CiAgICAgICAgY2FzZSBSYXkuQUxMOgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0LnNldChmcm9tLCB0bywgbm9ybWFsLCBoaXRQb2ludFdvcmxkLCBzaGFwZSwgYm9keSwgZGlzdGFuY2UpOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICB0aGlzLmNhbGxiYWNrKHJlc3VsdCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQ0xPU0VTVDoKICAgICAgICAgIC8vIFN0b3JlIGlmIGNsb3NlciB0aGFuIGN1cnJlbnQgY2xvc2VzdAogICAgICAgICAgaWYgKGRpc3RhbmNlIDwgcmVzdWx0LmRpc3RhbmNlIHx8ICFyZXN1bHQuaGFzSGl0KSB7CiAgICAgICAgICAgIHRoaXMuaGFzSGl0ID0gdHJ1ZTsKICAgICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICAgIHJlc3VsdC5zZXQoZnJvbSwgdG8sIG5vcm1hbCwgaGl0UG9pbnRXb3JsZCwgc2hhcGUsIGJvZHksIGRpc3RhbmNlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQU5ZOgogICAgICAgICAgLy8gUmVwb3J0IGFuZCBzdG9wLgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICByZXN1bHQuc2V0KGZyb20sIHRvLCBub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBkaXN0YW5jZSk7CiAgICAgICAgICByZXN1bHQuc2hvdWxkU3RvcCA9IHRydWU7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBBcyBwZXIgIkJhcnljZW50cmljIFRlY2huaXF1ZSIgYXMgbmFtZWQKICAgICAqIHtAbGluayBodHRwczovL3d3dy5ibGFja3Bhd24uY29tL3RleHRzL3BvaW50aW5wb2x5L2RlZmF1bHQuaHRtbCBoZXJlfSBidXQgd2l0aG91dCB0aGUgZGl2aXNpb24KICAgICAqLwoKCiAgICBzdGF0aWMgcG9pbnRJblRyaWFuZ2xlKHAsIGEsIGIsIGMpIHsKICAgICAgYy52c3ViKGEsIHYwKTsKICAgICAgYi52c3ViKGEsIHYxKTsKICAgICAgcC52c3ViKGEsIHYyKTsKICAgICAgY29uc3QgZG90MDAgPSB2MC5kb3QodjApOwogICAgICBjb25zdCBkb3QwMSA9IHYwLmRvdCh2MSk7CiAgICAgIGNvbnN0IGRvdDAyID0gdjAuZG90KHYyKTsKICAgICAgY29uc3QgZG90MTEgPSB2MS5kb3QodjEpOwogICAgICBjb25zdCBkb3QxMiA9IHYxLmRvdCh2Mik7CiAgICAgIGxldCB1OwogICAgICBsZXQgdjsKICAgICAgcmV0dXJuICh1ID0gZG90MTEgKiBkb3QwMiAtIGRvdDAxICogZG90MTIpID49IDAgJiYgKHYgPSBkb3QwMCAqIGRvdDEyIC0gZG90MDEgKiBkb3QwMikgPj0gMCAmJiB1ICsgdiA8IGRvdDAwICogZG90MTEgLSBkb3QwMSAqIGRvdDAxOwogICAgfQoKICB9CgogIFJheS5DTE9TRVNUID0gUkFZX01PREVTLkNMT1NFU1Q7CiAgUmF5LkFOWSA9IFJBWV9NT0RFUy5BTlk7CiAgUmF5LkFMTCA9IFJBWV9NT0RFUy5BTEw7CiAgY29uc3QgdG1wQUFCQiQxID0gbmV3IEFBQkIoKTsKICBjb25zdCB0bXBBcnJheSA9IFtdOwogIGNvbnN0IHYxID0gbmV3IFZlYzMoKTsKICBjb25zdCB2MiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0Qm9keV94aSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0Qm9keV9xaSA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgY29uc3QgaW50ZXJzZWN0UG9pbnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGEgPSBuZXcgVmVjMygpOwogIGNvbnN0IGIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGMgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdENvbnZleE9wdGlvbnMgPSB7CiAgICBmYWNlTGlzdDogWzBdCiAgfTsKICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfbG9jYWxSYXkgPSBuZXcgUmF5KCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXggPSBbXTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX2ludGVyc2VjdGlvblBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0Q29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0Q29udmV4X3ZlY3RvciA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0VHJpbWVzaF9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfbG9jYWxEaXJlY3Rpb24gPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfbG9jYWxGcm9tID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX2xvY2FsVG8gPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfd29ybGROb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfd29ybGRJbnRlcnNlY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgbmV3IEFBQkIoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3RyaWFuZ2xlcyA9IFtdOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfdHJlZVRyYW5zZm9ybSA9IG5ldyBUcmFuc2Zvcm0oKTsKICBjb25zdCB2MCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0ID0gbmV3IFZlYzMoKTsKCiAgZnVuY3Rpb24gZGlzdGFuY2VGcm9tSW50ZXJzZWN0aW9uKGZyb20sIGRpcmVjdGlvbiwgcG9zaXRpb24pIHsKICAgIC8vIHYwIGlzIHZlY3RvciBmcm9tIGZyb20gdG8gcG9zaXRpb24KICAgIHBvc2l0aW9uLnZzdWIoZnJvbSwgdjApOwogICAgY29uc3QgZG90ID0gdjAuZG90KGRpcmVjdGlvbik7IC8vIGludGVyc2VjdCA9IGRpcmVjdGlvbipkb3QgKyBmcm9tCgogICAgZGlyZWN0aW9uLnNjYWxlKGRvdCwgaW50ZXJzZWN0KTsKICAgIGludGVyc2VjdC52YWRkKGZyb20sIGludGVyc2VjdCk7CiAgICBjb25zdCBkaXN0YW5jZSA9IHBvc2l0aW9uLmRpc3RhbmNlVG8oaW50ZXJzZWN0KTsKICAgIHJldHVybiBkaXN0YW5jZTsKICB9CiAgLyoqCiAgICogU3dlZXAgYW5kIHBydW5lIGJyb2FkcGhhc2UgYWxvbmcgb25lIGF4aXMuCiAgICovCgoKICBjbGFzcyBTQVBCcm9hZHBoYXNlIGV4dGVuZHMgQnJvYWRwaGFzZSB7CiAgICAvKioKICAgICAqIExpc3Qgb2YgYm9kaWVzIGN1cnJlbnRseSBpbiB0aGUgYnJvYWRwaGFzZS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHdvcmxkIHRvIHNlYXJjaCBpbi4KICAgICAqLwoKICAgIC8qKgogICAgICogQXhpcyB0byBzb3J0IHRoZSBib2RpZXMgYWxvbmcuCiAgICAgKiBTZXQgdG8gMCBmb3IgeCBheGlzLCBhbmQgMSBmb3IgeSBheGlzLgogICAgICogRm9yIGJlc3QgcGVyZm9ybWFuY2UsIHBpY2sgdGhlIGF4aXMgd2hlcmUgYm9kaWVzIGFyZSBtb3N0IGRpc3RyaWJ1dGVkLgogICAgICovCgogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRzIG9mIHR3byBib2RpZXMgb3ZlcmxhcCwgYWxvbmcgdGhlIGdpdmVuIFNBUCBheGlzLgogICAgICovCiAgICBzdGF0aWMgY2hlY2tCb3VuZHMoYmksIGJqLCBheGlzSW5kZXgpIHsKICAgICAgbGV0IGJpUG9zOwogICAgICBsZXQgYmpQb3M7CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAwKSB7CiAgICAgICAgYmlQb3MgPSBiaS5wb3NpdGlvbi54OwogICAgICAgIGJqUG9zID0gYmoucG9zaXRpb24ueDsKICAgICAgfSBlbHNlIGlmIChheGlzSW5kZXggPT09IDEpIHsKICAgICAgICBiaVBvcyA9IGJpLnBvc2l0aW9uLnk7CiAgICAgICAgYmpQb3MgPSBiai5wb3NpdGlvbi55OwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIGJpUG9zID0gYmkucG9zaXRpb24uejsKICAgICAgICBialBvcyA9IGJqLnBvc2l0aW9uLno7CiAgICAgIH0KCiAgICAgIGNvbnN0IHJpID0gYmkuYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIHJqID0gYmouYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIGJvdW5kQTIgPSBiaVBvcyArIHJpLAogICAgICAgICAgICBib3VuZEIxID0gYmpQb3MgLSByajsKICAgICAgcmV0dXJuIGJvdW5kQjEgPCBib3VuZEEyOwogICAgfSAvLyBOb3RlOiB0aGVzZSBhcmUgaWRlbnRpY2FsLCBzYXZlIGZvciB4L3kveiBsb3dlcmJvdW5kCgogICAgLyoqCiAgICAgKiBpbnNlcnRpb25Tb3J0WAogICAgICovCgoKICAgIHN0YXRpYyBpbnNlcnRpb25Tb3J0WChhKSB7CiAgICAgIGZvciAobGV0IGkgPSAxLCBsID0gYS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gYVtpXTsKICAgICAgICBsZXQgajsKCiAgICAgICAgZm9yIChqID0gaSAtIDE7IGogPj0gMDsgai0tKSB7CiAgICAgICAgICBpZiAoYVtqXS5hYWJiLmxvd2VyQm91bmQueCA8PSB2LmFhYmIubG93ZXJCb3VuZC54KSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGFbaiArIDFdID0gYVtqXTsKICAgICAgICB9CgogICAgICAgIGFbaiArIDFdID0gdjsKICAgICAgfQoKICAgICAgcmV0dXJuIGE7CiAgICB9CiAgICAvKioKICAgICAqIGluc2VydGlvblNvcnRZCiAgICAgKi8KCgogICAgc3RhdGljIGluc2VydGlvblNvcnRZKGEpIHsKICAgICAgZm9yIChsZXQgaSA9IDEsIGwgPSBhLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGNvbnN0IHYgPSBhW2ldOwogICAgICAgIGxldCBqOwoKICAgICAgICBmb3IgKGogPSBpIC0gMTsgaiA+PSAwOyBqLS0pIHsKICAgICAgICAgIGlmIChhW2pdLmFhYmIubG93ZXJCb3VuZC55IDw9IHYuYWFiYi5sb3dlckJvdW5kLnkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgYVtqICsgMV0gPSBhW2pdOwogICAgICAgIH0KCiAgICAgICAgYVtqICsgMV0gPSB2OwogICAgICB9CgogICAgICByZXR1cm4gYTsKICAgIH0KICAgIC8qKgogICAgICogaW5zZXJ0aW9uU29ydFoKICAgICAqLwoKCiAgICBzdGF0aWMgaW5zZXJ0aW9uU29ydFooYSkgewogICAgICBmb3IgKGxldCBpID0gMSwgbCA9IGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3QgdiA9IGFbaV07CiAgICAgICAgbGV0IGo7CgogICAgICAgIGZvciAoaiA9IGkgLSAxOyBqID49IDA7IGotLSkgewogICAgICAgICAgaWYgKGFbal0uYWFiYi5sb3dlckJvdW5kLnogPD0gdi5hYWJiLmxvd2VyQm91bmQueikgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBhW2ogKyAxXSA9IGFbal07CiAgICAgICAgfQoKICAgICAgICBhW2ogKyAxXSA9IHY7CiAgICAgIH0KCiAgICAgIHJldHVybiBhOwogICAgfQoKICAgIGNvbnN0cnVjdG9yKHdvcmxkKSB7CiAgICAgIHN1cGVyKCk7CiAgICAgIHRoaXMuYXhpc0xpc3QgPSB2b2lkIDA7CiAgICAgIHRoaXMud29ybGQgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0luZGV4ID0gdm9pZCAwOwogICAgICB0aGlzLl9hZGRCb2R5SGFuZGxlciA9IHZvaWQgMDsKICAgICAgdGhpcy5fcmVtb3ZlQm9keUhhbmRsZXIgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0xpc3QgPSBbXTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMuYXhpc0luZGV4ID0gMDsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwoKICAgICAgdGhpcy5fYWRkQm9keUhhbmRsZXIgPSBldmVudCA9PiB7CiAgICAgICAgYXhpc0xpc3QucHVzaChldmVudC5ib2R5KTsKICAgICAgfTsKCiAgICAgIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyID0gZXZlbnQgPT4gewogICAgICAgIGNvbnN0IGlkeCA9IGF4aXNMaXN0LmluZGV4T2YoZXZlbnQuYm9keSk7CgogICAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgICBheGlzTGlzdC5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAod29ybGQpIHsKICAgICAgICB0aGlzLnNldFdvcmxkKHdvcmxkKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGFuZ2UgdGhlIHdvcmxkCiAgICAgKi8KCgogICAgc2V0V29ybGQod29ybGQpIHsKICAgICAgLy8gQ2xlYXIgdGhlIG9sZCBheGlzIGFycmF5CiAgICAgIHRoaXMuYXhpc0xpc3QubGVuZ3RoID0gMDsgLy8gQWRkIGFsbCBib2RpZXMgZnJvbSB0aGUgbmV3IHdvcmxkCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmxkLmJvZGllcy5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuYXhpc0xpc3QucHVzaCh3b3JsZC5ib2RpZXNbaV0pOwogICAgICB9IC8vIFJlbW92ZSBvbGQgaGFuZGxlcnMsIGlmIGFueQoKCiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZEJvZHknLCB0aGlzLl9hZGRCb2R5SGFuZGxlcik7CiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3JlbW92ZUJvZHknLCB0aGlzLl9yZW1vdmVCb2R5SGFuZGxlcik7IC8vIEFkZCBoYW5kbGVycyB0byB1cGRhdGUgdGhlIGxpc3Qgb2YgYm9kaWVzLgoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcignYWRkQm9keScsIHRoaXMuX2FkZEJvZHlIYW5kbGVyKTsKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncmVtb3ZlQm9keScsIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ29sbGVjdCBhbGwgY29sbGlzaW9uIHBhaXJzCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHAxLCBwMikgewogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBOID0gYm9kaWVzLmxlbmd0aDsKICAgICAgY29uc3QgYXhpc0luZGV4ID0gdGhpcy5heGlzSW5kZXg7CiAgICAgIGxldCBpOwogICAgICBsZXQgajsKCiAgICAgIGlmICh0aGlzLmRpcnR5KSB7CiAgICAgICAgdGhpcy5zb3J0TGlzdCgpOwogICAgICAgIHRoaXMuZGlydHkgPSBmYWxzZTsKICAgICAgfSAvLyBMb29rIHRocm91Z2ggdGhlIGxpc3QKCgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBOOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGJqID0gYm9kaWVzW2pdOwoKICAgICAgICAgIGlmICghdGhpcy5uZWVkQnJvYWRwaGFzZUNvbGxpc2lvbihiaSwgYmopKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghU0FQQnJvYWRwaGFzZS5jaGVja0JvdW5kcyhiaSwgYmosIGF4aXNJbmRleCkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcDEsIHAyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzb3J0TGlzdCgpIHsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBheGlzSW5kZXggPSB0aGlzLmF4aXNJbmRleDsKICAgICAgY29uc3QgTiA9IGF4aXNMaXN0Lmxlbmd0aDsgLy8gVXBkYXRlIEFBQkJzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBheGlzTGlzdFtpXTsKCiAgICAgICAgaWYgKGJpLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYmkudXBkYXRlQUFCQigpOwogICAgICAgIH0KICAgICAgfSAvLyBTb3J0IHRoZSBsaXN0CgoKICAgICAgaWYgKGF4aXNJbmRleCA9PT0gMCkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFgoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMSkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFkoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFooYXhpc0xpc3QpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIHRoZSB2YXJpYW5jZSBvZiB0aGUgYm9keSBwb3NpdGlvbnMgYW5kIGVzdGltYXRlcyB0aGUgYmVzdCBheGlzIHRvIHVzZS4KICAgICAqIFdpbGwgYXV0b21hdGljYWxseSBzZXQgcHJvcGVydHkgYGF4aXNJbmRleGAuCiAgICAgKi8KCgogICAgYXV0b0RldGVjdEF4aXMoKSB7CiAgICAgIGxldCBzdW1YID0gMDsKICAgICAgbGV0IHN1bVgyID0gMDsKICAgICAgbGV0IHN1bVkgPSAwOwogICAgICBsZXQgc3VtWTIgPSAwOwogICAgICBsZXQgc3VtWiA9IDA7CiAgICAgIGxldCBzdW1aMiA9IDA7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYXhpc0xpc3Q7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBpbnZOID0gMSAvIE47CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGJvZGllc1tpXTsKICAgICAgICBjb25zdCBjZW50ZXJYID0gYi5wb3NpdGlvbi54OwogICAgICAgIHN1bVggKz0gY2VudGVyWDsKICAgICAgICBzdW1YMiArPSBjZW50ZXJYICogY2VudGVyWDsKICAgICAgICBjb25zdCBjZW50ZXJZID0gYi5wb3NpdGlvbi55OwogICAgICAgIHN1bVkgKz0gY2VudGVyWTsKICAgICAgICBzdW1ZMiArPSBjZW50ZXJZICogY2VudGVyWTsKICAgICAgICBjb25zdCBjZW50ZXJaID0gYi5wb3NpdGlvbi56OwogICAgICAgIHN1bVogKz0gY2VudGVyWjsKICAgICAgICBzdW1aMiArPSBjZW50ZXJaICogY2VudGVyWjsKICAgICAgfQoKICAgICAgY29uc3QgdmFyaWFuY2VYID0gc3VtWDIgLSBzdW1YICogc3VtWCAqIGludk47CiAgICAgIGNvbnN0IHZhcmlhbmNlWSA9IHN1bVkyIC0gc3VtWSAqIHN1bVkgKiBpbnZOOwogICAgICBjb25zdCB2YXJpYW5jZVogPSBzdW1aMiAtIHN1bVogKiBzdW1aICogaW52TjsKCiAgICAgIGlmICh2YXJpYW5jZVggPiB2YXJpYW5jZVkpIHsKICAgICAgICBpZiAodmFyaWFuY2VYID4gdmFyaWFuY2VaKSB7CiAgICAgICAgICB0aGlzLmF4aXNJbmRleCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodmFyaWFuY2VZID4gdmFyaWFuY2VaKSB7CiAgICAgICAgdGhpcy5heGlzSW5kZXggPSAxOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0ID0gW10pIHsKICAgICAgaWYgKHRoaXMuZGlydHkpIHsKICAgICAgICB0aGlzLnNvcnRMaXN0KCk7CiAgICAgICAgdGhpcy5kaXJ0eSA9IGZhbHNlOwogICAgICB9CgogICAgICBjb25zdCBheGlzSW5kZXggPSB0aGlzLmF4aXNJbmRleDsKICAgICAgbGV0IGF4aXMgPSAneCc7CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAxKSB7CiAgICAgICAgYXhpcyA9ICd5JzsKICAgICAgfQoKICAgICAgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIGF4aXMgPSAneic7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4aXNMaXN0ID0gdGhpcy5heGlzTGlzdDsKICAgICAgYWFiYi5sb3dlckJvdW5kW2F4aXNdOwogICAgICBhYWJiLnVwcGVyQm91bmRbYXhpc107CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGF4aXNMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGF4aXNMaXN0W2ldOwoKICAgICAgICBpZiAoYi5hYWJiTmVlZHNVcGRhdGUpIHsKICAgICAgICAgIGIudXBkYXRlQUFCQigpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGIuYWFiYi5vdmVybGFwcyhhYWJiKSkgewogICAgICAgICAgcmVzdWx0LnB1c2goYik7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICB9CgogIGNsYXNzIFV0aWxzIHsKICAgIC8qKgogICAgICogRXh0ZW5kIGFuIG9wdGlvbnMgb2JqZWN0IHdpdGggZGVmYXVsdCB2YWx1ZXMuCiAgICAgKiBAcGFyYW0gb3B0aW9ucyBUaGUgb3B0aW9ucyBvYmplY3QuIE1heSBiZSBmYWxzeTogaW4gdGhpcyBjYXNlLCBhIG5ldyBvYmplY3QgaXMgY3JlYXRlZCBhbmQgcmV0dXJuZWQuCiAgICAgKiBAcGFyYW0gZGVmYXVsdHMgQW4gb2JqZWN0IGNvbnRhaW5pbmcgZGVmYXVsdCB2YWx1ZXMuCiAgICAgKiBAcmV0dXJuIFRoZSBtb2RpZmllZCBvcHRpb25zIG9iamVjdC4KICAgICAqLwogICAgc3RhdGljIGRlZmF1bHRzKG9wdGlvbnMgPSB7fSwgZGVmYXVsdHMpIHsKICAgICAgZm9yIChsZXQga2V5IGluIGRlZmF1bHRzKSB7CiAgICAgICAgaWYgKCEoa2V5IGluIG9wdGlvbnMpKSB7CiAgICAgICAgICBvcHRpb25zW2tleV0gPSBkZWZhdWx0c1trZXldOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG9wdGlvbnM7CiAgICB9CgogIH0KICAvKioKICAgKiBDb25zdHJhaW50IGJhc2UgY2xhc3MKICAgKi8KCgogIGNsYXNzIENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBFcXVhdGlvbnMgdG8gYmUgc29sdmVkIGluIHRoaXMgY29uc3RyYWludC4KICAgICAqLwoKICAgIC8qKgogICAgICogQm9keSBBLgogICAgICovCgogICAgLyoqCiAgICAgKiBCb2R5IEIuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byBmYWxzZSBpZiB5b3UgZG9uJ3Qgd2FudCB0aGUgYm9kaWVzIHRvIGNvbGxpZGUgd2hlbiB0aGV5IGFyZSBjb25uZWN0ZWQuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyA9IHt9KSB7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gdm9pZCAwOwogICAgICB0aGlzLmJvZHlBID0gdm9pZCAwOwogICAgICB0aGlzLmJvZHlCID0gdm9pZCAwOwogICAgICB0aGlzLmlkID0gdm9pZCAwOwogICAgICB0aGlzLmNvbGxpZGVDb25uZWN0ZWQgPSB2b2lkIDA7CiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdHJ1ZSwKICAgICAgICB3YWtlVXBCb2RpZXM6IHRydWUKICAgICAgfSk7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gW107CiAgICAgIHRoaXMuYm9keUEgPSBib2R5QTsKICAgICAgdGhpcy5ib2R5QiA9IGJvZHlCOwogICAgICB0aGlzLmlkID0gQ29uc3RyYWludC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gb3B0aW9ucy5jb2xsaWRlQ29ubmVjdGVkOwoKICAgICAgaWYgKG9wdGlvbnMud2FrZVVwQm9kaWVzKSB7CiAgICAgICAgaWYgKGJvZHlBKSB7CiAgICAgICAgICBib2R5QS53YWtlVXAoKTsKICAgICAgICB9CgogICAgICAgIGlmIChib2R5QikgewogICAgICAgICAgYm9keUIud2FrZVVwKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSBhbGwgdGhlIGVxdWF0aW9ucyB3aXRoIGRhdGEuCiAgICAgKi8KCgogICAgdXBkYXRlKCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ21ldGhvZCB1cGRhdGUoKSBub3QgaW1wbG1lbWVudGVkIGluIHRoaXMgQ29uc3RyYWludCBzdWJjbGFzcyEnKTsKICAgIH0KICAgIC8qKgogICAgICogRW5hYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGVuYWJsZSgpIHsKICAgICAgY29uc3QgZXFzID0gdGhpcy5lcXVhdGlvbnM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVxcy5sZW5ndGg7IGkrKykgewogICAgICAgIGVxc1tpXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBEaXNhYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGRpc2FibGUoKSB7CiAgICAgIGNvbnN0IGVxcyA9IHRoaXMuZXF1YXRpb25zOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlcXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBlcXNbaV0uZW5hYmxlZCA9IGZhbHNlOwogICAgICB9CiAgICB9CgogIH0KCiAgQ29uc3RyYWludC5pZENvdW50ZXIgPSAwOwogIC8qKgogICAqIEFuIGVsZW1lbnQgY29udGFpbmluZyA2IGVudHJpZXMsIDMgc3BhdGlhbCBhbmQgMyByb3RhdGlvbmFsIGRlZ3JlZXMgb2YgZnJlZWRvbS4KICAgKi8KCiAgY2xhc3MgSmFjb2JpYW5FbGVtZW50IHsKICAgIC8qKgogICAgICogc3BhdGlhbAogICAgICovCgogICAgLyoqCiAgICAgKiByb3RhdGlvbmFsCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLnNwYXRpYWwgPSB2b2lkIDA7CiAgICAgIHRoaXMucm90YXRpb25hbCA9IHZvaWQgMDsKICAgICAgdGhpcy5zcGF0aWFsID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5yb3RhdGlvbmFsID0gbmV3IFZlYzMoKTsKICAgIH0KICAgIC8qKgogICAgICogTXVsdGlwbHkgd2l0aCBvdGhlciBKYWNvYmlhbkVsZW1lbnQKICAgICAqLwoKCiAgICBtdWx0aXBseUVsZW1lbnQoZWxlbWVudCkgewogICAgICByZXR1cm4gZWxlbWVudC5zcGF0aWFsLmRvdCh0aGlzLnNwYXRpYWwpICsgZWxlbWVudC5yb3RhdGlvbmFsLmRvdCh0aGlzLnJvdGF0aW9uYWwpOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB3aXRoIHR3byB2ZWN0b3JzCiAgICAgKi8KCgogICAgbXVsdGlwbHlWZWN0b3JzKHNwYXRpYWwsIHJvdGF0aW9uYWwpIHsKICAgICAgcmV0dXJuIHNwYXRpYWwuZG90KHRoaXMuc3BhdGlhbCkgKyByb3RhdGlvbmFsLmRvdCh0aGlzLnJvdGF0aW9uYWwpOwogICAgfQoKICB9CiAgLyoqCiAgICogRXF1YXRpb24gYmFzZSBjbGFzcy4KICAgKgogICAqIGBhYCwgYGJgIGFuZCBgZXBzYCBhcmUge0BsaW5rIGh0dHBzOi8vd3d3OC5jcy51bXUuc2Uva3Vyc2VyLzVEVjA1OC9WVDE1L2xlY3R1cmVzL1NQT09LbGFibm90ZXMucGRmIFNQT09LfSBwYXJhbWV0ZXJzIHRoYXQgZGVmYXVsdCB0byBgMC4wYC4gU2VlIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUvY2Fubm9uLmpzL2lzc3Vlcy8yMzgjaXNzdWVjb21tZW50LTE0NzE3MjMyNyB0aGlzIGV4Y2hhbmdlfSBmb3IgbW9yZSBkZXRhaWxzIG9uIENhbm5vbidzIHBoeXNpY3MgaW1wbGVtZW50YXRpb24uCiAgICovCgoKICBjbGFzcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqIE1pbmltdW0gKHJlYWQ6IG5lZ2F0aXZlIG1heCkgZm9yY2UgdG8gYmUgYXBwbGllZCBieSB0aGUgY29uc3RyYWludC4KICAgICAqLwoKICAgIC8qKgogICAgICogTWF4aW11bSAocmVhZDogcG9zaXRpdmUgbWF4KSBmb3JjZSB0byBiZSBhcHBsaWVkIGJ5IHRoZSBjb25zdHJhaW50LgogICAgICovCgogICAgLyoqCiAgICAgKiBTUE9PSyBwYXJhbWV0ZXIKICAgICAqLwoKICAgIC8qKgogICAgICogU1BPT0sgcGFyYW1ldGVyCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNQT09LIHBhcmFtZXRlcgogICAgICovCgogICAgLyoqCiAgICAgKiBBIG51bWJlciwgcHJvcG9ydGlvbmFsIHRvIHRoZSBmb3JjZSBhZGRlZCB0byB0aGUgYm9kaWVzLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihiaSwgYmosIG1pbkZvcmNlID0gLTFlNiwgbWF4Rm9yY2UgPSAxZTYpIHsKICAgICAgdGhpcy5pZCA9IHZvaWQgMDsKICAgICAgdGhpcy5taW5Gb3JjZSA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXhGb3JjZSA9IHZvaWQgMDsKICAgICAgdGhpcy5iaSA9IHZvaWQgMDsKICAgICAgdGhpcy5iaiA9IHZvaWQgMDsKICAgICAgdGhpcy5zaSA9IHZvaWQgMDsKICAgICAgdGhpcy5zaiA9IHZvaWQgMDsKICAgICAgdGhpcy5hID0gdm9pZCAwOwogICAgICB0aGlzLmIgPSB2b2lkIDA7CiAgICAgIHRoaXMuZXBzID0gdm9pZCAwOwogICAgICB0aGlzLmphY29iaWFuRWxlbWVudEEgPSB2b2lkIDA7CiAgICAgIHRoaXMuamFjb2JpYW5FbGVtZW50QiA9IHZvaWQgMDsKICAgICAgdGhpcy5lbmFibGVkID0gdm9pZCAwOwogICAgICB0aGlzLm11bHRpcGxpZXIgPSB2b2lkIDA7CiAgICAgIHRoaXMuaWQgPSBFcXVhdGlvbi5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5taW5Gb3JjZSA9IG1pbkZvcmNlOwogICAgICB0aGlzLm1heEZvcmNlID0gbWF4Rm9yY2U7CiAgICAgIHRoaXMuYmkgPSBiaTsKICAgICAgdGhpcy5iaiA9IGJqOwogICAgICB0aGlzLmEgPSAwLjA7IC8vIFNQT09LIHBhcmFtZXRlcgoKICAgICAgdGhpcy5iID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuZXBzID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuamFjb2JpYW5FbGVtZW50QSA9IG5ldyBKYWNvYmlhbkVsZW1lbnQoKTsKICAgICAgdGhpcy5qYWNvYmlhbkVsZW1lbnRCID0gbmV3IEphY29iaWFuRWxlbWVudCgpOwogICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlOwogICAgICB0aGlzLm11bHRpcGxpZXIgPSAwOwogICAgICB0aGlzLnNldFNwb29rUGFyYW1zKDFlNywgNCwgMSAvIDYwKTsgLy8gU2V0IHR5cGljYWwgc3Bvb2sgcGFyYW1zCiAgICB9CiAgICAvKioKICAgICAqIFJlY2FsY3VsYXRlcyBhLCBiLCBhbmQgZXBzLgogICAgICoKICAgICAqIFRoZSBFcXVhdGlvbiBjb25zdHJ1Y3RvciBzZXRzIHR5cGljYWwgU1BPT0sgcGFyYW1ldGVycyBhcyBzdWNoOgogICAgICogKiBgc3RpZmZuZXNzYCA9IDFlNwogICAgICogKiBgcmVsYXhhdGlvbmAgPSA0CiAgICAgKiAqIGB0aW1lU3RlcGA9IDEgLyA2MCwgX25vdGUgdGhlIGhhcmRjb2RlZCByZWZyZXNoIHJhdGUuXwogICAgICovCgoKICAgIHNldFNwb29rUGFyYW1zKHN0aWZmbmVzcywgcmVsYXhhdGlvbiwgdGltZVN0ZXApIHsKICAgICAgY29uc3QgZCA9IHJlbGF4YXRpb247CiAgICAgIGNvbnN0IGsgPSBzdGlmZm5lc3M7CiAgICAgIGNvbnN0IGggPSB0aW1lU3RlcDsKICAgICAgdGhpcy5hID0gNC4wIC8gKGggKiAoMSArIDQgKiBkKSk7CiAgICAgIHRoaXMuYiA9IDQuMCAqIGQgLyAoMSArIDQgKiBkKTsKICAgICAgdGhpcy5lcHMgPSA0LjAgLyAoaCAqIGggKiBrICogKDEgKyA0ICogZCkpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB0aGUgcmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBTUE9PSyBlcXVhdGlvbgogICAgICovCgoKICAgIGNvbXB1dGVCKGEsIGIsIGgpIHsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHcSA9IHRoaXMuY29tcHV0ZUdxKCk7CiAgICAgIGNvbnN0IEdpTWYgPSB0aGlzLmNvbXB1dGVHaU1mKCk7CiAgICAgIHJldHVybiAtR3EgKiBhIC0gR1cgKiBiIC0gR2lNZiAqIGg7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqcSwgd2hlcmUgcSBhcmUgdGhlIGdlbmVyYWxpemVkIGJvZHkgY29vcmRpbmF0ZXMKICAgICAqLwoKCiAgICBjb21wdXRlR3EoKSB7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgY29uc3QgYmkgPSB0aGlzLmJpOwogICAgICBjb25zdCBiaiA9IHRoaXMuYmo7CiAgICAgIGNvbnN0IHhpID0gYmkucG9zaXRpb247CiAgICAgIGNvbnN0IHhqID0gYmoucG9zaXRpb247CiAgICAgIHJldHVybiBHQS5zcGF0aWFsLmRvdCh4aSkgKyBHQi5zcGF0aWFsLmRvdCh4aik7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqVywgd2hlcmUgVyBhcmUgdGhlIGJvZHkgdmVsb2NpdGllcwogICAgICovCgoKICAgIGNvbXB1dGVHVygpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgdmkgPSBiaS52ZWxvY2l0eTsKICAgICAgY29uc3QgdmogPSBiai52ZWxvY2l0eTsKICAgICAgY29uc3Qgd2kgPSBiaS5hbmd1bGFyVmVsb2NpdHk7CiAgICAgIGNvbnN0IHdqID0gYmouYW5ndWxhclZlbG9jaXR5OwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKHZpLCB3aSkgKyBHQi5tdWx0aXBseVZlY3RvcnModmosIHdqKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZXMgRypXbGFtYmRhLCB3aGVyZSBXIGFyZSB0aGUgYm9keSB2ZWxvY2l0aWVzCiAgICAgKi8KCgogICAgY29tcHV0ZUdXbGFtYmRhKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB2aSA9IGJpLnZsYW1iZGE7CiAgICAgIGNvbnN0IHZqID0gYmoudmxhbWJkYTsKICAgICAgY29uc3Qgd2kgPSBiaS53bGFtYmRhOwogICAgICBjb25zdCB3aiA9IGJqLndsYW1iZGE7CiAgICAgIHJldHVybiBHQS5tdWx0aXBseVZlY3RvcnModmksIHdpKSArIEdCLm11bHRpcGx5VmVjdG9ycyh2aiwgd2opOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpmLCB3aGVyZSBNIGlzIHRoZSBtYXNzIG1hdHJpeCB3aXRoIGRpYWdvbmFsIGJsb2NrcyBmb3IgZWFjaCBib2R5LCBhbmQgZiBhcmUgdGhlIGZvcmNlcyBvbiB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGNvbXB1dGVHaU1mKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCBmaSA9IGJpLmZvcmNlOwogICAgICBjb25zdCB0aSA9IGJpLnRvcnF1ZTsKICAgICAgY29uc3QgZmogPSBiai5mb3JjZTsKICAgICAgY29uc3QgdGogPSBiai50b3JxdWU7CiAgICAgIGNvbnN0IGludk1hc3NpID0gYmkuaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZNYXNzaiA9IGJqLmludk1hc3NTb2x2ZTsKICAgICAgZmkuc2NhbGUoaW52TWFzc2ksIGlNZmkpOwogICAgICBmai5zY2FsZShpbnZNYXNzaiwgaU1maik7CiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KHRpLCBpbnZJaV92bXVsdF90YXVpKTsKICAgICAgYmouaW52SW5lcnRpYVdvcmxkU29sdmUudm11bHQodGosIGludklqX3ZtdWx0X3RhdWopOwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKGlNZmksIGludklpX3ZtdWx0X3RhdWkpICsgR0IubXVsdGlwbHlWZWN0b3JzKGlNZmosIGludklqX3ZtdWx0X3RhdWopOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpHJwogICAgICovCgoKICAgIGNvbXB1dGVHaU1HdCgpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgaW52TWFzc2kgPSBiaS5pbnZNYXNzU29sdmU7CiAgICAgIGNvbnN0IGludk1hc3NqID0gYmouaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZJaSA9IGJpLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBjb25zdCBpbnZJaiA9IGJqLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBsZXQgcmVzdWx0ID0gaW52TWFzc2kgKyBpbnZNYXNzajsKICAgICAgaW52SWkudm11bHQoR0Eucm90YXRpb25hbCwgdG1wKTsKICAgICAgcmVzdWx0ICs9IHRtcC5kb3QoR0Eucm90YXRpb25hbCk7CiAgICAgIGludklqLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRtcCk7CiAgICAgIHJlc3VsdCArPSB0bXAuZG90KEdCLnJvdGF0aW9uYWwpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgY29uc3RyYWludCB2ZWxvY2l0eSB0byB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGFkZFRvV2xhbWJkYShkZWx0YWxhbWJkYSkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB0ZW1wID0gYWRkVG9XbGFtYmRhX3RlbXA7IC8vIEFkZCB0byBsaW5lYXIgdmVsb2NpdHkKICAgICAgLy8gdl9sYW1iZGEgKz0gaW52KE0pICogZGVsdGFfbGFtYmEgKiBHCgogICAgICBiaS52bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihiaS5pbnZNYXNzU29sdmUgKiBkZWx0YWxhbWJkYSwgR0Euc3BhdGlhbCwgYmkudmxhbWJkYSk7CiAgICAgIGJqLnZsYW1iZGEuYWRkU2NhbGVkVmVjdG9yKGJqLmludk1hc3NTb2x2ZSAqIGRlbHRhbGFtYmRhLCBHQi5zcGF0aWFsLCBiai52bGFtYmRhKTsgLy8gQWRkIHRvIGFuZ3VsYXIgdmVsb2NpdHkKCiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdBLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiaS53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmkud2xhbWJkYSk7CiAgICAgIGJqLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiai53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmoud2xhbWJkYSk7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdGhlIGRlbm9taW5hdG9yIHBhcnQgb2YgdGhlIFNQT09LIGVxdWF0aW9uOiBDID0gRyppbnYoTSkqRycgKyBlcHMKICAgICAqLwoKCiAgICBjb21wdXRlQygpIHsKICAgICAgcmV0dXJuIHRoaXMuY29tcHV0ZUdpTUd0KCkgKyB0aGlzLmVwczsKICAgIH0KCiAgfQoKICBFcXVhdGlvbi5pZENvdW50ZXIgPSAwOwogIGNvbnN0IGlNZmkgPSBuZXcgVmVjMygpOwogIGNvbnN0IGlNZmogPSBuZXcgVmVjMygpOwogIGNvbnN0IGludklpX3ZtdWx0X3RhdWkgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludklqX3ZtdWx0X3RhdWogPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYWRkVG9XbGFtYmRhX3RlbXAgPSBuZXcgVmVjMygpOwogIC8qKgogICAqIENvbnRhY3Qvbm9uLXBlbmV0cmF0aW9uIGNvbnN0cmFpbnQgZXF1YXRpb24KICAgKi8KCiAgY2xhc3MgQ29udGFjdEVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiAiYm91bmNpbmVzcyI6IHUxID0gLWUqdTAKICAgICAqLwoKICAgIC8qKgogICAgICogV29ybGQtb3JpZW50ZWQgdmVjdG9yIHRoYXQgZ29lcyBmcm9tIHRoZSBjZW50ZXIgb2YgYmkgdG8gdGhlIGNvbnRhY3QgcG9pbnQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdvcmxkLW9yaWVudGVkIHZlY3RvciB0aGF0IHN0YXJ0cyBpbiBib2R5IGogcG9zaXRpb24gYW5kIGdvZXMgdG8gdGhlIGNvbnRhY3QgcG9pbnQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIENvbnRhY3Qgbm9ybWFsLCBwb2ludGluZyBvdXQgb2YgYm9keSBpLgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIG1heEZvcmNlID0gMWU2KSB7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgMCwgbWF4Rm9yY2UpOwogICAgICB0aGlzLnJlc3RpdHV0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLnJpID0gdm9pZCAwOwogICAgICB0aGlzLnJqID0gdm9pZCAwOwogICAgICB0aGlzLm5pID0gdm9pZCAwOwogICAgICB0aGlzLnJlc3RpdHV0aW9uID0gMC4wOwogICAgICB0aGlzLnJpID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5yaiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMubmkgPSBuZXcgVmVjMygpOwogICAgfQoKICAgIGNvbXB1dGVCKGgpIHsKICAgICAgY29uc3QgYSA9IHRoaXMuYTsKICAgICAgY29uc3QgYiA9IHRoaXMuYjsKICAgICAgY29uc3QgYmkgPSB0aGlzLmJpOwogICAgICBjb25zdCBiaiA9IHRoaXMuYmo7CiAgICAgIGNvbnN0IHJpID0gdGhpcy5yaTsKICAgICAgY29uc3QgcmogPSB0aGlzLnJqOwogICAgICBjb25zdCByaXhuID0gQ29udGFjdEVxdWF0aW9uX2NvbXB1dGVCX3RlbXAxOwogICAgICBjb25zdCByanhuID0gQ29udGFjdEVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyOwogICAgICBjb25zdCB2aSA9IGJpLnZlbG9jaXR5OwogICAgICBjb25zdCB3aSA9IGJpLmFuZ3VsYXJWZWxvY2l0eTsKICAgICAgYmkuZm9yY2U7CiAgICAgIGJpLnRvcnF1ZTsKICAgICAgY29uc3QgdmogPSBiai52ZWxvY2l0eTsKICAgICAgY29uc3Qgd2ogPSBiai5hbmd1bGFyVmVsb2NpdHk7CiAgICAgIGJqLmZvcmNlOwogICAgICBiai50b3JxdWU7CiAgICAgIGNvbnN0IHBlbmV0cmF0aW9uVmVjID0gQ29udGFjdEVxdWF0aW9uX2NvbXB1dGVCX3RlbXAzOwogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IG4gPSB0aGlzLm5pOyAvLyBDYWx1Y2xhdGUgY3Jvc3MgcHJvZHVjdHMKCiAgICAgIHJpLmNyb3NzKG4sIHJpeG4pOwogICAgICByai5jcm9zcyhuLCByanhuKTsgLy8gZyA9IHhqK3JqIC0oeGkrcmkpCiAgICAgIC8vIEcgPSBbIC1uaSAgLXJpeG4gIG5pICByanhuIF0KCiAgICAgIG4ubmVnYXRlKEdBLnNwYXRpYWwpOwogICAgICByaXhuLm5lZ2F0ZShHQS5yb3RhdGlvbmFsKTsKICAgICAgR0Iuc3BhdGlhbC5jb3B5KG4pOwogICAgICBHQi5yb3RhdGlvbmFsLmNvcHkocmp4bik7IC8vIENhbGN1bGF0ZSB0aGUgcGVuZXRyYXRpb24gdmVjdG9yCgogICAgICBwZW5ldHJhdGlvblZlYy5jb3B5KGJqLnBvc2l0aW9uKTsKICAgICAgcGVuZXRyYXRpb25WZWMudmFkZChyaiwgcGVuZXRyYXRpb25WZWMpOwogICAgICBwZW5ldHJhdGlvblZlYy52c3ViKGJpLnBvc2l0aW9uLCBwZW5ldHJhdGlvblZlYyk7CiAgICAgIHBlbmV0cmF0aW9uVmVjLnZzdWIocmksIHBlbmV0cmF0aW9uVmVjKTsKICAgICAgY29uc3QgZyA9IG4uZG90KHBlbmV0cmF0aW9uVmVjKTsgLy8gQ29tcHV0ZSBpdGVyYXRpb24KCiAgICAgIGNvbnN0IGVQbHVzT25lID0gdGhpcy5yZXN0aXR1dGlvbiArIDE7CiAgICAgIGNvbnN0IEdXID0gZVBsdXNPbmUgKiB2ai5kb3QobikgLSBlUGx1c09uZSAqIHZpLmRvdChuKSArIHdqLmRvdChyanhuKSAtIHdpLmRvdChyaXhuKTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1nICogYSAtIEdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBjdXJyZW50IHJlbGF0aXZlIHZlbG9jaXR5IGluIHRoZSBjb250YWN0IHBvaW50LgogICAgICovCgoKICAgIGdldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWwoKSB7CiAgICAgIGNvbnN0IHZpID0gQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfdmk7CiAgICAgIGNvbnN0IHZqID0gQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfdmo7CiAgICAgIGNvbnN0IHhpID0gQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfeGk7CiAgICAgIGNvbnN0IHhqID0gQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfeGo7CiAgICAgIGNvbnN0IHJlbFZlbCA9IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3JlbFZlbDsKICAgICAgdGhpcy5iaS5wb3NpdGlvbi52YWRkKHRoaXMucmksIHhpKTsKICAgICAgdGhpcy5iai5wb3NpdGlvbi52YWRkKHRoaXMucmosIHhqKTsKICAgICAgdGhpcy5iaS5nZXRWZWxvY2l0eUF0V29ybGRQb2ludCh4aSwgdmkpOwogICAgICB0aGlzLmJqLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KHhqLCB2aik7CiAgICAgIHZpLnZzdWIodmosIHJlbFZlbCk7CiAgICAgIHJldHVybiB0aGlzLm5pLmRvdChyZWxWZWwpOwogICAgfQoKICB9CgogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9jb21wdXRlQl90ZW1wMSA9IG5ldyBWZWMzKCk7IC8vIFRlbXAgdmVjdG9ycwoKICBjb25zdCBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDIgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9jb21wdXRlQl90ZW1wMyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfdmkgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3ZqID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF94aSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfeGogPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3JlbFZlbCA9IG5ldyBWZWMzKCk7CiAgLyoqCiAgICogQ29ubmVjdHMgdHdvIGJvZGllcyBhdCBnaXZlbiBvZmZzZXQgcG9pbnRzLgogICAqIEBleGFtcGxlCiAgICogICAgIGNvbnN0IGJvZHlBID0gbmV3IEJvZHkoeyBtYXNzOiAxIH0pCiAgICogICAgIGNvbnN0IGJvZHlCID0gbmV3IEJvZHkoeyBtYXNzOiAxIH0pCiAgICogICAgIGJvZHlBLnBvc2l0aW9uLnNldCgtMSwgMCwgMCkKICAgKiAgICAgYm9keUIucG9zaXRpb24uc2V0KDEsIDAsIDApCiAgICogICAgIGJvZHlBLmFkZFNoYXBlKHNoYXBlQSkKICAgKiAgICAgYm9keUIuYWRkU2hhcGUoc2hhcGVCKQogICAqICAgICB3b3JsZC5hZGRCb2R5KGJvZHlBKQogICAqICAgICB3b3JsZC5hZGRCb2R5KGJvZHlCKQogICAqICAgICBjb25zdCBsb2NhbFBpdm90QSA9IG5ldyBWZWMzKDEsIDAsIDApCiAgICogICAgIGNvbnN0IGxvY2FsUGl2b3RCID0gbmV3IFZlYzMoLTEsIDAsIDApCiAgICogICAgIGNvbnN0IGNvbnN0cmFpbnQgPSBuZXcgUG9pbnRUb1BvaW50Q29uc3RyYWludChib2R5QSwgbG9jYWxQaXZvdEEsIGJvZHlCLCBsb2NhbFBpdm90QikKICAgKiAgICAgd29ybGQuYWRkQ29uc3RyYWludChjb25zdHJhaW50KQogICAqLwoKICBjbGFzcyBQb2ludFRvUG9pbnRDb25zdHJhaW50IGV4dGVuZHMgQ29uc3RyYWludCB7CiAgICAvKioKICAgICAqIFBpdm90LCBkZWZpbmVkIGxvY2FsbHkgaW4gYm9keUEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFBpdm90LCBkZWZpbmVkIGxvY2FsbHkgaW4gYm9keUIuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBwYXJhbSBwaXZvdEEgVGhlIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyBvZiBib2R5QSB3aGljaCBib2R5QSBpcyBjb25zdHJhaW5lZCB0by4KICAgICAqIEBwYXJhbSBib2R5QiBCb2R5IHRoYXQgd2lsbCBiZSBjb25zdHJhaW5lZCBpbiBhIHNpbWlsYXIgd2F5IHRvIHRoZSBzYW1lIHBvaW50IGFzIGJvZHlBLiBXZSB3aWxsIHRoZXJlZm9yZSBnZXQgYSBsaW5rIGJldHdlZW4gYm9keUEgYW5kIGJvZHlCLiBJZiBub3Qgc3BlY2lmaWVkLCBib2R5QSB3aWxsIGJlIGNvbnN0cmFpbmVkIHRvIGEgc3RhdGljIHBvaW50LgogICAgICogQHBhcmFtIHBpdm90QiBUaGUgcG9pbnQgcmVsYXRpdmUgdG8gdGhlIGNlbnRlciBvZiBtYXNzIG9mIGJvZHlCIHdoaWNoIGJvZHlCIGlzIGNvbnN0cmFpbmVkIHRvLgogICAgICogQHBhcmFtIG1heEZvcmNlIFRoZSBtYXhpbXVtIGZvcmNlIHRoYXQgc2hvdWxkIGJlIGFwcGxpZWQgdG8gY29uc3RyYWluIHRoZSBib2RpZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBwaXZvdEEgPSBuZXcgVmVjMygpLCBib2R5QiwgcGl2b3RCID0gbmV3IFZlYzMoKSwgbWF4Rm9yY2UgPSAxZTYpIHsKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCKTsKICAgICAgdGhpcy5waXZvdEEgPSB2b2lkIDA7CiAgICAgIHRoaXMucGl2b3RCID0gdm9pZCAwOwogICAgICB0aGlzLmVxdWF0aW9uWCA9IHZvaWQgMDsKICAgICAgdGhpcy5lcXVhdGlvblkgPSB2b2lkIDA7CiAgICAgIHRoaXMuZXF1YXRpb25aID0gdm9pZCAwOwogICAgICB0aGlzLnBpdm90QSA9IHBpdm90QS5jbG9uZSgpOwogICAgICB0aGlzLnBpdm90QiA9IHBpdm90Qi5jbG9uZSgpOwogICAgICBjb25zdCB4ID0gdGhpcy5lcXVhdGlvblggPSBuZXcgQ29udGFjdEVxdWF0aW9uKGJvZHlBLCBib2R5Qik7CiAgICAgIGNvbnN0IHkgPSB0aGlzLmVxdWF0aW9uWSA9IG5ldyBDb250YWN0RXF1YXRpb24oYm9keUEsIGJvZHlCKTsKICAgICAgY29uc3QgeiA9IHRoaXMuZXF1YXRpb25aID0gbmV3IENvbnRhY3RFcXVhdGlvbihib2R5QSwgYm9keUIpOyAvLyBFcXVhdGlvbnMgdG8gYmUgZmVkIHRvIHRoZSBzb2x2ZXIKCiAgICAgIHRoaXMuZXF1YXRpb25zLnB1c2goeCwgeSwgeik7IC8vIE1ha2UgdGhlIGVxdWF0aW9ucyBiaWRpcmVjdGlvbmFsCgogICAgICB4Lm1pbkZvcmNlID0geS5taW5Gb3JjZSA9IHoubWluRm9yY2UgPSAtbWF4Rm9yY2U7CiAgICAgIHgubWF4Rm9yY2UgPSB5Lm1heEZvcmNlID0gei5tYXhGb3JjZSA9IG1heEZvcmNlOwogICAgICB4Lm5pLnNldCgxLCAwLCAwKTsKICAgICAgeS5uaS5zZXQoMCwgMSwgMCk7CiAgICAgIHoubmkuc2V0KDAsIDAsIDEpOwogICAgfQoKICAgIHVwZGF0ZSgpIHsKICAgICAgY29uc3QgYm9keUEgPSB0aGlzLmJvZHlBOwogICAgICBjb25zdCBib2R5QiA9IHRoaXMuYm9keUI7CiAgICAgIGNvbnN0IHggPSB0aGlzLmVxdWF0aW9uWDsKICAgICAgY29uc3QgeSA9IHRoaXMuZXF1YXRpb25ZOwogICAgICBjb25zdCB6ID0gdGhpcy5lcXVhdGlvblo7IC8vIFJvdGF0ZSB0aGUgcGl2b3RzIHRvIHdvcmxkIHNwYWNlCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KHRoaXMucGl2b3RBLCB4LnJpKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdCh0aGlzLnBpdm90QiwgeC5yaik7CiAgICAgIHkucmkuY29weSh4LnJpKTsKICAgICAgeS5yai5jb3B5KHgucmopOwogICAgICB6LnJpLmNvcHkoeC5yaSk7CiAgICAgIHoucmouY29weSh4LnJqKTsKICAgIH0KCiAgfQogIC8qKgogICAqIENvbmUgZXF1YXRpb24uIFdvcmtzIHRvIGtlZXAgdGhlIGdpdmVuIGJvZHkgd29ybGQgdmVjdG9ycyBhbGlnbmVkLCBvciB0aWx0ZWQgd2l0aGluIGEgZ2l2ZW4gYW5nbGUgZnJvbSBlYWNoIG90aGVyLgogICAqLwoKCiAgY2xhc3MgQ29uZUVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBMb2NhbCBheGlzIGluIEEKICAgICAqLwoKICAgIC8qKgogICAgICogTG9jYWwgYXhpcyBpbiBCCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSAiY29uZSBhbmdsZSIgdG8ga2VlcAogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIG9wdGlvbnMgPSB7fSkgewogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0IgPSB2b2lkIDA7CiAgICAgIHRoaXMuYW5nbGUgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMuYW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy5hbmdsZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFuZ2xlIDogMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMjsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDI7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBUaGUgYW5nbGUgYmV0d2VlbiB0d28gdmVjdG9yIGlzOgogICAgICAvLyBjb3ModGhldGEpID0gYSAqIGIgLyAobGVuZ3RoKGEpICogbGVuZ3RoKGIpID0geyBsZW4oYSkgPSBsZW4oYikgPSAxIH0gPSBhICogYgogICAgICAvLyBnID0gYSAqIGIKICAgICAgLy8gZ2RvdCA9IChiIHggYSkgKiB3aSArIChhIHggYikgKiB3agogICAgICAvLyBHID0gWzAgYnhhIDAgYXhiXQogICAgICAvLyBXID0gW3ZpIHdpIHZqIHdqXQoKICAgICAgR0Eucm90YXRpb25hbC5jb3B5KG5qeG5pKTsKICAgICAgR0Iucm90YXRpb25hbC5jb3B5KG5peG5qKTsKICAgICAgY29uc3QgZyA9IE1hdGguY29zKHRoaXMuYW5nbGUpIC0gbmkuZG90KG5qKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLWcgKiBhIC0gR1cgKiBiIC0gaCAqIEdpTWY7CiAgICAgIHJldHVybiBCOwogICAgfQoKICB9CgogIGNvbnN0IHRtcFZlYzEkMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMiQyID0gbmV3IFZlYzMoKTsKICAvKioKICAgKiBSb3RhdGlvbmFsIGNvbnN0cmFpbnQuIFdvcmtzIHRvIGtlZXAgdGhlIGxvY2FsIHZlY3RvcnMgb3J0aG9nb25hbCB0byBlYWNoIG90aGVyIGluIHdvcmxkIHNwYWNlLgogICAqLwoKICBjbGFzcyBSb3RhdGlvbmFsRXF1YXRpb24gZXh0ZW5kcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqIFdvcmxkIG9yaWVudGVkIHJvdGF0aW9uYWwgYXhpcy4KICAgICAqLwoKICAgIC8qKgogICAgICogV29ybGQgb3JpZW50ZWQgcm90YXRpb25hbCBheGlzLgogICAgICovCgogICAgLyoqCiAgICAgKiBtYXhBbmdsZQogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIG9wdGlvbnMgPSB7fSkgewogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0IgPSB2b2lkIDA7CiAgICAgIHRoaXMubWF4QW5nbGUgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMubWF4QW5nbGUgPSBNYXRoLlBJIC8gMjsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMTsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDE7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBnID0gbmkgKiBuagogICAgICAvLyBnZG90ID0gKG5qIHggbmkpICogd2kgKyAobmkgeCBuaikgKiB3agogICAgICAvLyBHID0gWzAgbmp4bmkgMCBuaXhual0KICAgICAgLy8gVyA9IFt2aSB3aSB2aiB3al0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShuanhuaSk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShuaXhuaik7CiAgICAgIGNvbnN0IGcgPSBNYXRoLmNvcyh0aGlzLm1heEFuZ2xlKSAtIG5pLmRvdChuaik7CiAgICAgIGNvbnN0IEdXID0gdGhpcy5jb21wdXRlR1coKTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1nICogYSAtIEdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQoKICBjb25zdCB0bXBWZWMxJDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzIkMSA9IG5ldyBWZWMzKCk7CiAgLyoqCiAgICogQSBDb25lIFR3aXN0IGNvbnN0cmFpbnQsIHVzZWZ1bCBmb3IgcmFnZG9sbHMuCiAgICovCgogIGNsYXNzIENvbmVUd2lzdENvbnN0cmFpbnQgZXh0ZW5kcyBQb2ludFRvUG9pbnRDb25zdHJhaW50IHsKICAgIC8qKgogICAgICogVGhlIGF4aXMgZGlyZWN0aW9uIGZvciB0aGUgY29uc3RyYWludCBvZiB0aGUgYm9keSBBLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgYXhpcyBkaXJlY3Rpb24gZm9yIHRoZSBjb25zdHJhaW50IG9mIHRoZSBib2R5IEIuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBhcGVydHVyZSBhbmdsZSBvZiB0aGUgY29uZS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHR3aXN0IGFuZ2xlIG9mIHRoZSBqb2ludC4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zID0ge30pIHsKICAgICAgY29uc3QgbWF4Rm9yY2UgPSB0eXBlb2Ygb3B0aW9ucy5tYXhGb3JjZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLm1heEZvcmNlIDogMWU2OyAvLyBTZXQgcGl2b3QgcG9pbnQgaW4gYmV0d2VlbgoKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICB0aGlzLmF4aXNBID0gdm9pZCAwOwogICAgICB0aGlzLmF4aXNCID0gdm9pZCAwOwogICAgICB0aGlzLmFuZ2xlID0gdm9pZCAwOwogICAgICB0aGlzLnR3aXN0QW5nbGUgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29uZUVxdWF0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLnR3aXN0RXF1YXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgdGhpcy5heGlzQiA9IG9wdGlvbnMuYXhpc0IgPyBvcHRpb25zLmF4aXNCLmNsb25lKCkgOiBuZXcgVmVjMygpOwogICAgICB0aGlzLmNvbGxpZGVDb25uZWN0ZWQgPSAhIW9wdGlvbnMuY29sbGlkZUNvbm5lY3RlZDsKICAgICAgdGhpcy5hbmdsZSA9IHR5cGVvZiBvcHRpb25zLmFuZ2xlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuYW5nbGUgOiAwOwogICAgICBjb25zdCBjID0gdGhpcy5jb25lRXF1YXRpb24gPSBuZXcgQ29uZUVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHQgPSB0aGlzLnR3aXN0RXF1YXRpb24gPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIHRoaXMudHdpc3RBbmdsZSA9IHR5cGVvZiBvcHRpb25zLnR3aXN0QW5nbGUgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy50d2lzdEFuZ2xlIDogMDsgLy8gTWFrZSB0aGUgY29uZSBlcXVhdGlvbiBwdXNoIHRoZSBib2RpZXMgdG93YXJkIHRoZSBjb25lIGF4aXMsIG5vdCBvdXR3YXJkCgogICAgICBjLm1heEZvcmNlID0gMDsKICAgICAgYy5taW5Gb3JjZSA9IC1tYXhGb3JjZTsgLy8gTWFrZSB0aGUgdHdpc3QgZXF1YXRpb24gYWRkIHRvcnF1ZSB0b3dhcmQgdGhlIGluaXRpYWwgcG9zaXRpb24KCiAgICAgIHQubWF4Rm9yY2UgPSAwOwogICAgICB0Lm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKGMsIHQpOwogICAgfQoKICAgIHVwZGF0ZSgpIHsKICAgICAgY29uc3QgYm9keUEgPSB0aGlzLmJvZHlBOwogICAgICBjb25zdCBib2R5QiA9IHRoaXMuYm9keUI7CiAgICAgIGNvbnN0IGNvbmUgPSB0aGlzLmNvbmVFcXVhdGlvbjsKICAgICAgY29uc3QgdHdpc3QgPSB0aGlzLnR3aXN0RXF1YXRpb247CiAgICAgIHN1cGVyLnVwZGF0ZSgpOyAvLyBVcGRhdGUgdGhlIGF4ZXMgdG8gdGhlIGNvbmUgY29uc3RyYWludAoKICAgICAgYm9keUEudmVjdG9yVG9Xb3JsZEZyYW1lKHRoaXMuYXhpc0EsIGNvbmUuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy5heGlzQiwgY29uZS5heGlzQik7IC8vIFVwZGF0ZSB0aGUgd29ybGQgYXhlcyBpbiB0aGUgdHdpc3QgY29uc3RyYWludAoKICAgICAgdGhpcy5heGlzQS50YW5nZW50cyh0d2lzdC5heGlzQSwgdHdpc3QuYXhpc0EpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodHdpc3QuYXhpc0EsIHR3aXN0LmF4aXNBKTsKICAgICAgdGhpcy5heGlzQi50YW5nZW50cyh0d2lzdC5heGlzQiwgdHdpc3QuYXhpc0IpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodHdpc3QuYXhpc0IsIHR3aXN0LmF4aXNCKTsKICAgICAgY29uZS5hbmdsZSA9IHRoaXMuYW5nbGU7CiAgICAgIHR3aXN0Lm1heEFuZ2xlID0gdGhpcy50d2lzdEFuZ2xlOwogICAgfQoKICB9CiAgLyoqCiAgICogQ29uc3RyYWlucyB0d28gYm9kaWVzIHRvIGJlIGF0IGEgY29uc3RhbnQgZGlzdGFuY2UgZnJvbSBlYWNoIG90aGVycyBjZW50ZXIgb2YgbWFzcy4KICAgKi8KCgogIGNsYXNzIERpc3RhbmNlQ29uc3RyYWludCBleHRlbmRzIENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBUaGUgZGlzdGFuY2UgdG8ga2VlcC4gSWYgdW5kZWZpbmVkLCBpdCB3aWxsIGJlIHNldCB0byB0aGUgY3VycmVudCBkaXN0YW5jZSBiZXR3ZWVuIGJvZHlBIGFuZCBib2R5QgogICAgICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gZGlzdGFuY2UgVGhlIGRpc3RhbmNlIHRvIGtlZXAuIElmIHVuZGVmaW5lZCwgaXQgd2lsbCBiZSBzZXQgdG8gdGhlIGN1cnJlbnQgZGlzdGFuY2UgYmV0d2VlbiBib2R5QSBhbmQgYm9keUIuCiAgICAgKiBAcGFyYW0gbWF4Rm9yY2UgVGhlIG1heGltdW0gZm9yY2UgdGhhdCBzaG91bGQgYmUgYXBwbGllZCB0byBjb25zdHJhaW4gdGhlIGJvZGllcy4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBkaXN0YW5jZSwgbWF4Rm9yY2UgPSAxZTYpIHsKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCKTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IHZvaWQgMDsKICAgICAgdGhpcy5kaXN0YW5jZUVxdWF0aW9uID0gdm9pZCAwOwoKICAgICAgaWYgKHR5cGVvZiBkaXN0YW5jZSA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICBkaXN0YW5jZSA9IGJvZHlBLnBvc2l0aW9uLmRpc3RhbmNlVG8oYm9keUIucG9zaXRpb24pOwogICAgICB9CgogICAgICB0aGlzLmRpc3RhbmNlID0gZGlzdGFuY2U7CiAgICAgIGNvbnN0IGVxID0gdGhpcy5kaXN0YW5jZUVxdWF0aW9uID0gbmV3IENvbnRhY3RFcXVhdGlvbihib2R5QSwgYm9keUIpOwogICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKGVxKTsgLy8gTWFrZSBpdCBiaWRpcmVjdGlvbmFsCgogICAgICBlcS5taW5Gb3JjZSA9IC1tYXhGb3JjZTsKICAgICAgZXEubWF4Rm9yY2UgPSBtYXhGb3JjZTsKICAgIH0KICAgIC8qKgogICAgICogdXBkYXRlCiAgICAgKi8KCgogICAgdXBkYXRlKCkgewogICAgICBjb25zdCBib2R5QSA9IHRoaXMuYm9keUE7CiAgICAgIGNvbnN0IGJvZHlCID0gdGhpcy5ib2R5QjsKICAgICAgY29uc3QgZXEgPSB0aGlzLmRpc3RhbmNlRXF1YXRpb247CiAgICAgIGNvbnN0IGhhbGZEaXN0ID0gdGhpcy5kaXN0YW5jZSAqIDAuNTsKICAgICAgY29uc3Qgbm9ybWFsID0gZXEubmk7CiAgICAgIGJvZHlCLnBvc2l0aW9uLnZzdWIoYm9keUEucG9zaXRpb24sIG5vcm1hbCk7CiAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgbm9ybWFsLnNjYWxlKGhhbGZEaXN0LCBlcS5yaSk7CiAgICAgIG5vcm1hbC5zY2FsZSgtaGFsZkRpc3QsIGVxLnJqKTsKICAgIH0KCiAgfQogIC8qKgogICAqIExvY2sgY29uc3RyYWludC4gV2lsbCByZW1vdmUgYWxsIGRlZ3JlZXMgb2YgZnJlZWRvbSBiZXR3ZWVuIHRoZSBib2RpZXMuCiAgICovCgoKICBjbGFzcyBMb2NrQ29uc3RyYWludCBleHRlbmRzIFBvaW50VG9Qb2ludENvbnN0cmFpbnQgewogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zID0ge30pIHsKICAgICAgY29uc3QgbWF4Rm9yY2UgPSB0eXBlb2Ygb3B0aW9ucy5tYXhGb3JjZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLm1heEZvcmNlIDogMWU2OyAvLyBTZXQgcGl2b3QgcG9pbnQgaW4gYmV0d2VlbgoKICAgICAgY29uc3QgcGl2b3RBID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgaGFsZldheSA9IG5ldyBWZWMzKCk7CiAgICAgIGJvZHlBLnBvc2l0aW9uLnZhZGQoYm9keUIucG9zaXRpb24sIGhhbGZXYXkpOwogICAgICBoYWxmV2F5LnNjYWxlKDAuNSwgaGFsZldheSk7CiAgICAgIGJvZHlCLnBvaW50VG9Mb2NhbEZyYW1lKGhhbGZXYXksIHBpdm90Qik7CiAgICAgIGJvZHlBLnBvaW50VG9Mb2NhbEZyYW1lKGhhbGZXYXksIHBpdm90QSk7IC8vIFRoZSBwb2ludC10by1wb2ludCBjb25zdHJhaW50IHdpbGwga2VlcCBhIHBvaW50IHNoYXJlZCBiZXR3ZWVuIHRoZSBib2RpZXMKCiAgICAgIHN1cGVyKGJvZHlBLCBwaXZvdEEsIGJvZHlCLCBwaXZvdEIsIG1heEZvcmNlKTsgLy8gU3RvcmUgaW5pdGlhbCByb3RhdGlvbiBvZiB0aGUgYm9kaWVzIGFzIHVuaXQgdmVjdG9ycyBpbiB0aGUgbG9jYWwgYm9keSBzcGFjZXMKCiAgICAgIHRoaXMueEEgPSB2b2lkIDA7CiAgICAgIHRoaXMueEIgPSB2b2lkIDA7CiAgICAgIHRoaXMueUEgPSB2b2lkIDA7CiAgICAgIHRoaXMueUIgPSB2b2lkIDA7CiAgICAgIHRoaXMuekEgPSB2b2lkIDA7CiAgICAgIHRoaXMuekIgPSB2b2lkIDA7CiAgICAgIHRoaXMucm90YXRpb25hbEVxdWF0aW9uMSA9IHZvaWQgMDsKICAgICAgdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yID0gdm9pZCAwOwogICAgICB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjMgPSB2b2lkIDA7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy54QSA9IGJvZHlBLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWCk7CiAgICAgIHRoaXMueEIgPSBib2R5Qi52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1gpOwogICAgICB0aGlzLnlBID0gYm9keUEudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9ZKTsKICAgICAgdGhpcy55QiA9IGJvZHlCLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWSk7CiAgICAgIHRoaXMuekEgPSBib2R5QS52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1opOwogICAgICB0aGlzLnpCID0gYm9keUIudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9aKTsgLy8gLi4uYW5kIHRoZSBmb2xsb3dpbmcgcm90YXRpb25hbCBlcXVhdGlvbnMgd2lsbCBrZWVwIGFsbCByb3RhdGlvbmFsIERPRidzIGluIHBsYWNlCgogICAgICBjb25zdCByMSA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMSA9IG5ldyBSb3RhdGlvbmFsRXF1YXRpb24oYm9keUEsIGJvZHlCLCBvcHRpb25zKTsKICAgICAgY29uc3QgcjIgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjIgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHIzID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24zID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKHIxLCByMiwgcjMpOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICB0aGlzLm1vdG9yRXF1YXRpb247CiAgICAgIGNvbnN0IHIxID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24xOwogICAgICBjb25zdCByMiA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMjsKICAgICAgY29uc3QgcjMgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjM7CiAgICAgIHN1cGVyLnVwZGF0ZSgpOyAvLyBUaGVzZSB2ZWN0b3IgcGFpcnMgbXVzdCBiZSBvcnRob2dvbmFsCgogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QSwgcjEuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QiwgcjEuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QSwgcjIuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QiwgcjIuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QSwgcjMuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QiwgcjMuYXhpc0IpOwogICAgfQoKICB9CiAgLyoqCiAgICogUm90YXRpb25hbCBtb3RvciBjb25zdHJhaW50LiBUcmllcyB0byBrZWVwIHRoZSByZWxhdGl2ZSBhbmd1bGFyIHZlbG9jaXR5IG9mIHRoZSBib2RpZXMgdG8gYSBnaXZlbiB2YWx1ZS4KICAgKi8KCgogIGNsYXNzIFJvdGF0aW9uYWxNb3RvckVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBXb3JsZCBvcmllbnRlZCByb3RhdGlvbmFsIGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdvcmxkIG9yaWVudGVkIHJvdGF0aW9uYWwgYXhpcy4KICAgICAqLwoKICAgIC8qKgogICAgICogTW90b3IgdmVsb2NpdHkuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgbWF4Rm9yY2UgPSAxZTYpIHsKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCLCAtbWF4Rm9yY2UsIG1heEZvcmNlKTsKICAgICAgdGhpcy5heGlzQSA9IHZvaWQgMDsKICAgICAgdGhpcy5heGlzQiA9IHZvaWQgMDsKICAgICAgdGhpcy50YXJnZXRWZWxvY2l0eSA9IHZvaWQgMDsKICAgICAgdGhpcy5heGlzQSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuYXhpc0IgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnRhcmdldFZlbG9jaXR5ID0gMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIHRoaXMuYTsKICAgICAgY29uc3QgYiA9IHRoaXMuYjsKICAgICAgdGhpcy5iaTsKICAgICAgdGhpcy5iajsKICAgICAgY29uc3QgYXhpc0EgPSB0aGlzLmF4aXNBOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0I7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gZyA9IDAKICAgICAgLy8gZ2RvdCA9IGF4aXNBICogd2kgLSBheGlzQiAqIHdqCiAgICAgIC8vIGdkb3QgPSBHICogVyA9IEcgKiBbdmkgd2kgdmogd2pdCiAgICAgIC8vID0+CiAgICAgIC8vIEcgPSBbMCBheGlzQSAwIC1heGlzQl0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShheGlzQSk7CiAgICAgIGF4aXNCLm5lZ2F0ZShHQi5yb3RhdGlvbmFsKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpIC0gdGhpcy50YXJnZXRWZWxvY2l0eTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1HVyAqIGIgLSBoICogR2lNZjsKICAgICAgcmV0dXJuIEI7CiAgICB9CgogIH0KICAvKioKICAgKiBIaW5nZSBjb25zdHJhaW50LiBUaGluayBvZiBpdCBhcyBhIGRvb3IgaGluZ2UuIEl0IHRyaWVzIHRvIGtlZXAgdGhlIGRvb3IgaW4gdGhlIGNvcnJlY3QgcGxhY2UgYW5kIHdpdGggdGhlIGNvcnJlY3Qgb3JpZW50YXRpb24uCiAgICovCgoKICBjbGFzcyBIaW5nZUNvbnN0cmFpbnQgZXh0ZW5kcyBQb2ludFRvUG9pbnRDb25zdHJhaW50IHsKICAgIC8qKgogICAgICogUm90YXRpb24gYXhpcywgZGVmaW5lZCBsb2NhbGx5IGluIGJvZHlBLgogICAgICovCgogICAgLyoqCiAgICAgKiBSb3RhdGlvbiBheGlzLCBkZWZpbmVkIGxvY2FsbHkgaW4gYm9keUIuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyA9IHt9KSB7CiAgICAgIGNvbnN0IG1heEZvcmNlID0gdHlwZW9mIG9wdGlvbnMubWF4Rm9yY2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhGb3JjZSA6IDFlNjsKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICB0aGlzLmF4aXNBID0gdm9pZCAwOwogICAgICB0aGlzLmF4aXNCID0gdm9pZCAwOwogICAgICB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjEgPSB2b2lkIDA7CiAgICAgIHRoaXMucm90YXRpb25hbEVxdWF0aW9uMiA9IHZvaWQgMDsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uID0gdm9pZCAwOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNBLm5vcm1hbGl6ZSgpOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNCLm5vcm1hbGl6ZSgpOwogICAgICB0aGlzLmNvbGxpZGVDb25uZWN0ZWQgPSAhIW9wdGlvbnMuY29sbGlkZUNvbm5lY3RlZDsKICAgICAgY29uc3Qgcm90YXRpb25hbDEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjEgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHJvdGF0aW9uYWwyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbiA9IG5ldyBSb3RhdGlvbmFsTW90b3JFcXVhdGlvbihib2R5QSwgYm9keUIsIG1heEZvcmNlKTsKICAgICAgbW90b3IuZW5hYmxlZCA9IGZhbHNlOyAvLyBOb3QgZW5hYmxlZCBieSBkZWZhdWx0CiAgICAgIC8vIEVxdWF0aW9ucyB0byBiZSBmZWQgdG8gdGhlIHNvbHZlcgoKICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChyb3RhdGlvbmFsMSwgcm90YXRpb25hbDIsIG1vdG9yKTsKICAgIH0KICAgIC8qKgogICAgICogZW5hYmxlTW90b3IKICAgICAqLwoKCiAgICBlbmFibGVNb3RvcigpIHsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLmVuYWJsZWQgPSB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBkaXNhYmxlTW90b3IKICAgICAqLwoKCiAgICBkaXNhYmxlTW90b3IoKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi5lbmFibGVkID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHNldE1vdG9yU3BlZWQKICAgICAqLwoKCiAgICBzZXRNb3RvclNwZWVkKHNwZWVkKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi50YXJnZXRWZWxvY2l0eSA9IHNwZWVkOwogICAgfQogICAgLyoqCiAgICAgKiBzZXRNb3Rvck1heEZvcmNlCiAgICAgKi8KCgogICAgc2V0TW90b3JNYXhGb3JjZShtYXhGb3JjZSkgewogICAgICB0aGlzLm1vdG9yRXF1YXRpb24ubWF4Rm9yY2UgPSBtYXhGb3JjZTsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbjsKICAgICAgY29uc3QgcjEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjE7CiAgICAgIGNvbnN0IHIyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yOwogICAgICBjb25zdCB3b3JsZEF4aXNBID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMxOwogICAgICBjb25zdCB3b3JsZEF4aXNCID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMyOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0E7CiAgICAgIGNvbnN0IGF4aXNCID0gdGhpcy5heGlzQjsKICAgICAgc3VwZXIudXBkYXRlKCk7IC8vIEdldCB3b3JsZCBheGVzCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KGF4aXNBLCB3b3JsZEF4aXNBKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdChheGlzQiwgd29ybGRBeGlzQik7CiAgICAgIHdvcmxkQXhpc0EudGFuZ2VudHMocjEuYXhpc0EsIHIyLmF4aXNBKTsKICAgICAgcjEuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKICAgICAgcjIuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKCiAgICAgIGlmICh0aGlzLm1vdG9yRXF1YXRpb24uZW5hYmxlZCkgewogICAgICAgIGJvZHlBLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQSwgbW90b3IuYXhpc0EpOwogICAgICAgIGJvZHlCLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQiwgbW90b3IuYXhpc0IpOwogICAgICB9CiAgICB9CgogIH0KCiAgY29uc3QgSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMxID0gbmV3IFZlYzMoKTsKICBjb25zdCBIaW5nZUNvbnN0cmFpbnRfdXBkYXRlX3RtcFZlYzIgPSBuZXcgVmVjMygpOwogIC8qKgogICAqIENvbnN0cmFpbnMgdGhlIHNsaXBwaW5nIGluIGEgY29udGFjdCBhbG9uZyBhIHRhbmdlbnQKICAgKi8KCiAgY2xhc3MgRnJpY3Rpb25FcXVhdGlvbiBleHRlbmRzIEVxdWF0aW9uIHsKICAgIC8vIFRhbmdlbnQKCiAgICAvKioKICAgICAqIEBwYXJhbSBzbGlwRm9yY2Ugc2hvdWxkIGJlICstRl9mcmljdGlvbiA9ICstbXUgKiBGX25vcm1hbCA9ICstbXUgKiBtICogZwogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIHNsaXBGb3JjZSkgewogICAgICBzdXBlcihib2R5QSwgYm9keUIsIC1zbGlwRm9yY2UsIHNsaXBGb3JjZSk7CiAgICAgIHRoaXMucmkgPSB2b2lkIDA7CiAgICAgIHRoaXMucmogPSB2b2lkIDA7CiAgICAgIHRoaXMudCA9IHZvaWQgMDsKICAgICAgdGhpcy5yaSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucmogPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnQgPSBuZXcgVmVjMygpOwogICAgfQoKICAgIGNvbXB1dGVCKGgpIHsKICAgICAgdGhpcy5hOwogICAgICBjb25zdCBiID0gdGhpcy5iOwogICAgICB0aGlzLmJpOwogICAgICB0aGlzLmJqOwogICAgICBjb25zdCByaSA9IHRoaXMucmk7CiAgICAgIGNvbnN0IHJqID0gdGhpcy5yajsKICAgICAgY29uc3Qgcml4dCA9IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDE7CiAgICAgIGNvbnN0IHJqeHQgPSBGcmljdGlvbkVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyOwogICAgICBjb25zdCB0ID0gdGhpcy50OyAvLyBDYWx1Y2xhdGUgY3Jvc3MgcHJvZHVjdHMKCiAgICAgIHJpLmNyb3NzKHQsIHJpeHQpOwogICAgICByai5jcm9zcyh0LCByanh0KTsgLy8gRyA9IFstdCAtcml4dCB0IHJqeHRdCiAgICAgIC8vIEFuZCByZW1lbWJlciwgdGhpcyBpcyBhIHB1cmUgdmVsb2NpdHkgY29uc3RyYWludCwgZyBpcyBhbHdheXMgemVybyEKCiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgdC5uZWdhdGUoR0Euc3BhdGlhbCk7CiAgICAgIHJpeHQubmVnYXRlKEdBLnJvdGF0aW9uYWwpOwogICAgICBHQi5zcGF0aWFsLmNvcHkodCk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShyanh0KTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLUdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQoKICBjb25zdCBGcmljdGlvbkVxdWF0aW9uX2NvbXB1dGVCX3RlbXAxID0gbmV3IFZlYzMoKTsKICBjb25zdCBGcmljdGlvbkVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyID0gbmV3IFZlYzMoKTsKICAvKioKICAgKiBEZWZpbmVzIHdoYXQgaGFwcGVucyB3aGVuIHR3byBtYXRlcmlhbHMgbWVldC4KICAgKiBAdG9kbyBSZWZhY3RvciBtYXRlcmlhbHMgdG8gbWF0ZXJpYWxBIGFuZCBtYXRlcmlhbEIKICAgKi8KCiAgY2xhc3MgQ29udGFjdE1hdGVyaWFsIHsKICAgIC8qKgogICAgICogSWRlbnRpZmllciBvZiB0aGlzIG1hdGVyaWFsLgogICAgICovCgogICAgLyoqCiAgICAgKiBQYXJ0aWNpcGF0aW5nIG1hdGVyaWFscy4KICAgICAqLwoKICAgIC8qKgogICAgICogRnJpY3Rpb24gY29lZmZpY2llbnQuCiAgICAgKiBAZGVmYXVsdCAwLjMKICAgICAqLwoKICAgIC8qKgogICAgICogUmVzdGl0dXRpb24gY29lZmZpY2llbnQuCiAgICAgKiBAZGVmYXVsdCAwLjMKICAgICAqLwoKICAgIC8qKgogICAgICogU3RpZmZuZXNzIG9mIHRoZSBwcm9kdWNlZCBjb250YWN0IGVxdWF0aW9ucy4KICAgICAqIEBkZWZhdWx0IDFlNwogICAgICovCgogICAgLyoqCiAgICAgKiBSZWxheGF0aW9uIHRpbWUgb2YgdGhlIHByb2R1Y2VkIGNvbnRhY3QgZXF1YXRpb25zLgogICAgICogQGRlZmF1bHQgMwogICAgICovCgogICAgLyoqCiAgICAgKiBTdGlmZm5lc3Mgb2YgdGhlIHByb2R1Y2VkIGZyaWN0aW9uIGVxdWF0aW9ucy4KICAgICAqIEBkZWZhdWx0IDFlNwogICAgICovCgogICAgLyoqCiAgICAgKiBSZWxheGF0aW9uIHRpbWUgb2YgdGhlIHByb2R1Y2VkIGZyaWN0aW9uIGVxdWF0aW9ucwogICAgICogQGRlZmF1bHQgMwogICAgICovCiAgICBjb25zdHJ1Y3RvcihtMSwgbTIsIG9wdGlvbnMpIHsKICAgICAgdGhpcy5pZCA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXRlcmlhbHMgPSB2b2lkIDA7CiAgICAgIHRoaXMuZnJpY3Rpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMucmVzdGl0dXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuY29udGFjdEVxdWF0aW9uU3RpZmZuZXNzID0gdm9pZCAwOwogICAgICB0aGlzLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcyA9IHZvaWQgMDsKICAgICAgdGhpcy5mcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbiA9IHZvaWQgMDsKICAgICAgb3B0aW9ucyA9IFV0aWxzLmRlZmF1bHRzKG9wdGlvbnMsIHsKICAgICAgICBmcmljdGlvbjogMC4zLAogICAgICAgIHJlc3RpdHV0aW9uOiAwLjMsCiAgICAgICAgY29udGFjdEVxdWF0aW9uU3RpZmZuZXNzOiAxZTcsCiAgICAgICAgY29udGFjdEVxdWF0aW9uUmVsYXhhdGlvbjogMywKICAgICAgICBmcmljdGlvbkVxdWF0aW9uU3RpZmZuZXNzOiAxZTcsCiAgICAgICAgZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb246IDMKICAgICAgfSk7CiAgICAgIHRoaXMuaWQgPSBDb250YWN0TWF0ZXJpYWwuaWRDb3VudGVyKys7CiAgICAgIHRoaXMubWF0ZXJpYWxzID0gW20xLCBtMl07CiAgICAgIHRoaXMuZnJpY3Rpb24gPSBvcHRpb25zLmZyaWN0aW9uOwogICAgICB0aGlzLnJlc3RpdHV0aW9uID0gb3B0aW9ucy5yZXN0aXR1dGlvbjsKICAgICAgdGhpcy5jb250YWN0RXF1YXRpb25TdGlmZm5lc3MgPSBvcHRpb25zLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzczsKICAgICAgdGhpcy5jb250YWN0RXF1YXRpb25SZWxheGF0aW9uID0gb3B0aW9ucy5jb250YWN0RXF1YXRpb25SZWxheGF0aW9uOwogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3MgPSBvcHRpb25zLmZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3M7CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24gPSBvcHRpb25zLmZyaWN0aW9uRXF1YXRpb25SZWxheGF0aW9uOwogICAgfQoKICB9CgogIENvbnRhY3RNYXRlcmlhbC5pZENvdW50ZXIgPSAwOwogIC8qKgogICAqIERlZmluZXMgYSBwaHlzaWNzIG1hdGVyaWFsLgogICAqLwoKICBjbGFzcyBNYXRlcmlhbCB7CiAgICAvKioKICAgICAqIE1hdGVyaWFsIG5hbWUuCiAgICAgKiBJZiBvcHRpb25zIGlzIGEgc3RyaW5nLCBuYW1lIHdpbGwgYmUgc2V0IHRvIHRoYXQgc3RyaW5nLgogICAgICogQHRvZG8gRGVwcmVjYXRlIHRoaXMKICAgICAqLwoKICAgIC8qKiBNYXRlcmlhbCBpZC4gKi8KCiAgICAvKioKICAgICAqIEZyaWN0aW9uIGZvciB0aGlzIG1hdGVyaWFsLgogICAgICogSWYgbm9uLW5lZ2F0aXZlLCBpdCB3aWxsIGJlIHVzZWQgaW5zdGVhZCBvZiB0aGUgZnJpY3Rpb24gZ2l2ZW4gYnkgQ29udGFjdE1hdGVyaWFscy4gSWYgdGhlcmUncyBubyBtYXRjaGluZyBDb250YWN0TWF0ZXJpYWwsIHRoZSB2YWx1ZSBmcm9tIGBkZWZhdWx0Q29udGFjdE1hdGVyaWFsYCBpbiB0aGUgV29ybGQgd2lsbCBiZSB1c2VkLgogICAgICovCgogICAgLyoqCiAgICAgKiBSZXN0aXR1dGlvbiBmb3IgdGhpcyBtYXRlcmlhbC4KICAgICAqIElmIG5vbi1uZWdhdGl2ZSwgaXQgd2lsbCBiZSB1c2VkIGluc3RlYWQgb2YgdGhlIHJlc3RpdHV0aW9uIGdpdmVuIGJ5IENvbnRhY3RNYXRlcmlhbHMuIElmIHRoZXJlJ3Mgbm8gbWF0Y2hpbmcgQ29udGFjdE1hdGVyaWFsLCB0aGUgdmFsdWUgZnJvbSBgZGVmYXVsdENvbnRhY3RNYXRlcmlhbGAgaW4gdGhlIFdvcmxkIHdpbGwgYmUgdXNlZC4KICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucyA9IHt9KSB7CiAgICAgIHRoaXMubmFtZSA9IHZvaWQgMDsKICAgICAgdGhpcy5pZCA9IHZvaWQgMDsKICAgICAgdGhpcy5mcmljdGlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5yZXN0aXR1dGlvbiA9IHZvaWQgMDsKICAgICAgbGV0IG5hbWUgPSAnJzsgLy8gQmFja3dhcmRzIGNvbXBhdGliaWxpdHkgZml4CgogICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgLy9jb25zb2xlLndhcm4oYFBhc3NpbmcgYSBzdHJpbmcgdG8gTWF0ZXJpYWxPcHRpb25zIGlzIGRlcHJlY2F0ZWQsIGFuZCBoYXMgbm8gZWZmZWN0YCkKICAgICAgICBuYW1lID0gb3B0aW9uczsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICAgIHRoaXMuaWQgPSBNYXRlcmlhbC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5mcmljdGlvbiA9IHR5cGVvZiBvcHRpb25zLmZyaWN0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuZnJpY3Rpb24gOiAtMTsKICAgICAgdGhpcy5yZXN0aXR1dGlvbiA9IHR5cGVvZiBvcHRpb25zLnJlc3RpdHV0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMucmVzdGl0dXRpb24gOiAtMTsKICAgIH0KCiAgfQoKICBNYXRlcmlhbC5pZENvdW50ZXIgPSAwOwogIC8qKgogICAqIEEgc3ByaW5nLCBjb25uZWN0aW5nIHR3byBib2RpZXMuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc3ByaW5nID0gbmV3IFNwcmluZyhib3hCb2R5LCBzcGhlcmVCb2R5LCB7CiAgICogICAgICAgcmVzdExlbmd0aDogMCwKICAgKiAgICAgICBzdGlmZm5lc3M6IDUwLAogICAqICAgICAgIGRhbXBpbmc6IDEsCiAgICogICAgIH0pCiAgICoKICAgKiAgICAgLy8gQ29tcHV0ZSB0aGUgZm9yY2UgYWZ0ZXIgZWFjaCBzdGVwCiAgICogICAgIHdvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgKGV2ZW50KSA9PiB7CiAgICogICAgICAgc3ByaW5nLmFwcGx5Rm9yY2UoKQogICAqICAgICB9KQogICAqLwoKICBjbGFzcyBTcHJpbmcgewogICAgLyoqCiAgICAgKiBSZXN0IGxlbmd0aCBvZiB0aGUgc3ByaW5nLiBBIG51bWJlciA+IDAuCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFN0aWZmbmVzcyBvZiB0aGUgc3ByaW5nLiBBIG51bWJlciA+PSAwLgogICAgICogQGRlZmF1bHQgMTAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIERhbXBpbmcgb2YgdGhlIHNwcmluZy4gQSBudW1iZXIgPj0gMC4KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogRmlyc3QgY29ubmVjdGVkIGJvZHkuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNlY29uZCBjb25uZWN0ZWQgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogQW5jaG9yIGZvciBib2R5QSBpbiBsb2NhbCBib2R5QSBjb29yZGluYXRlcy4KICAgICAqIFdoZXJlIHRvIGhvb2sgdGhlIHNwcmluZyB0byBib2R5IEEsIGluIGxvY2FsIGJvZHkgY29vcmRpbmF0ZXMuCiAgICAgKiBAZGVmYXVsdCBuZXcgVmVjMygpCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFuY2hvciBmb3IgYm9keUIgaW4gbG9jYWwgYm9keUIgY29vcmRpbmF0ZXMuCiAgICAgKiBXaGVyZSB0byBob29rIHRoZSBzcHJpbmcgdG8gYm9keSBCLCBpbiBsb2NhbCBib2R5IGNvb3JkaW5hdGVzLgogICAgICogQGRlZmF1bHQgbmV3IFZlYzMoKQogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIG9wdGlvbnMgPSB7fSkgewogICAgICB0aGlzLnJlc3RMZW5ndGggPSB2b2lkIDA7CiAgICAgIHRoaXMuc3RpZmZuZXNzID0gdm9pZCAwOwogICAgICB0aGlzLmRhbXBpbmcgPSB2b2lkIDA7CiAgICAgIHRoaXMuYm9keUEgPSB2b2lkIDA7CiAgICAgIHRoaXMuYm9keUIgPSB2b2lkIDA7CiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gdm9pZCAwOwogICAgICB0aGlzLmxvY2FsQW5jaG9yQiA9IHZvaWQgMDsKICAgICAgdGhpcy5yZXN0TGVuZ3RoID0gdHlwZW9mIG9wdGlvbnMucmVzdExlbmd0aCA9PT0gJ251bWJlcicgPyBvcHRpb25zLnJlc3RMZW5ndGggOiAxOwogICAgICB0aGlzLnN0aWZmbmVzcyA9IG9wdGlvbnMuc3RpZmZuZXNzIHx8IDEwMDsKICAgICAgdGhpcy5kYW1waW5nID0gb3B0aW9ucy5kYW1waW5nIHx8IDE7CiAgICAgIHRoaXMuYm9keUEgPSBib2R5QTsKICAgICAgdGhpcy5ib2R5QiA9IGJvZHlCOwogICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gbmV3IFZlYzMoKTsKCiAgICAgIGlmIChvcHRpb25zLmxvY2FsQW5jaG9yQSkgewogICAgICAgIHRoaXMubG9jYWxBbmNob3JBLmNvcHkob3B0aW9ucy5sb2NhbEFuY2hvckEpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy5sb2NhbEFuY2hvckIpIHsKICAgICAgICB0aGlzLmxvY2FsQW5jaG9yQi5jb3B5KG9wdGlvbnMubG9jYWxBbmNob3JCKTsKICAgICAgfQoKICAgICAgaWYgKG9wdGlvbnMud29ybGRBbmNob3JBKSB7CiAgICAgICAgdGhpcy5zZXRXb3JsZEFuY2hvckEob3B0aW9ucy53b3JsZEFuY2hvckEpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy53b3JsZEFuY2hvckIpIHsKICAgICAgICB0aGlzLnNldFdvcmxkQW5jaG9yQihvcHRpb25zLndvcmxkQW5jaG9yQik7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBhbmNob3IgcG9pbnQgb24gYm9keSBBLCB1c2luZyB3b3JsZCBjb29yZGluYXRlcy4KICAgICAqLwoKCiAgICBzZXRXb3JsZEFuY2hvckEod29ybGRBbmNob3JBKSB7CiAgICAgIHRoaXMuYm9keUEucG9pbnRUb0xvY2FsRnJhbWUod29ybGRBbmNob3JBLCB0aGlzLmxvY2FsQW5jaG9yQSk7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgYW5jaG9yIHBvaW50IG9uIGJvZHkgQiwgdXNpbmcgd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgc2V0V29ybGRBbmNob3JCKHdvcmxkQW5jaG9yQikgewogICAgICB0aGlzLmJvZHlCLnBvaW50VG9Mb2NhbEZyYW1lKHdvcmxkQW5jaG9yQiwgdGhpcy5sb2NhbEFuY2hvckIpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGFuY2hvciBwb2ludCBvbiBib2R5IEEsIGluIHdvcmxkIGNvb3JkaW5hdGVzLgogICAgICogQHBhcmFtIHJlc3VsdCBUaGUgdmVjdG9yIHRvIHN0b3JlIHRoZSByZXN1bHQgaW4uCiAgICAgKi8KCgogICAgZ2V0V29ybGRBbmNob3JBKHJlc3VsdCkgewogICAgICB0aGlzLmJvZHlBLnBvaW50VG9Xb3JsZEZyYW1lKHRoaXMubG9jYWxBbmNob3JBLCByZXN1bHQpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGFuY2hvciBwb2ludCBvbiBib2R5IEIsIGluIHdvcmxkIGNvb3JkaW5hdGVzLgogICAgICogQHBhcmFtIHJlc3VsdCBUaGUgdmVjdG9yIHRvIHN0b3JlIHRoZSByZXN1bHQgaW4uCiAgICAgKi8KCgogICAgZ2V0V29ybGRBbmNob3JCKHJlc3VsdCkgewogICAgICB0aGlzLmJvZHlCLnBvaW50VG9Xb3JsZEZyYW1lKHRoaXMubG9jYWxBbmNob3JCLCByZXN1bHQpOwogICAgfQogICAgLyoqCiAgICAgKiBBcHBseSB0aGUgc3ByaW5nIGZvcmNlIHRvIHRoZSBjb25uZWN0ZWQgYm9kaWVzLgogICAgICovCgoKICAgIGFwcGx5Rm9yY2UoKSB7CiAgICAgIGNvbnN0IGsgPSB0aGlzLnN0aWZmbmVzczsKICAgICAgY29uc3QgZCA9IHRoaXMuZGFtcGluZzsKICAgICAgY29uc3QgbCA9IHRoaXMucmVzdExlbmd0aDsKICAgICAgY29uc3QgYm9keUEgPSB0aGlzLmJvZHlBOwogICAgICBjb25zdCBib2R5QiA9IHRoaXMuYm9keUI7CiAgICAgIGNvbnN0IHIgPSBhcHBseUZvcmNlX3I7CiAgICAgIGNvbnN0IHJfdW5pdCA9IGFwcGx5Rm9yY2Vfcl91bml0OwogICAgICBjb25zdCB1ID0gYXBwbHlGb3JjZV91OwogICAgICBjb25zdCBmID0gYXBwbHlGb3JjZV9mOwogICAgICBjb25zdCB0bXAgPSBhcHBseUZvcmNlX3RtcDsKICAgICAgY29uc3Qgd29ybGRBbmNob3JBID0gYXBwbHlGb3JjZV93b3JsZEFuY2hvckE7CiAgICAgIGNvbnN0IHdvcmxkQW5jaG9yQiA9IGFwcGx5Rm9yY2Vfd29ybGRBbmNob3JCOwogICAgICBjb25zdCByaSA9IGFwcGx5Rm9yY2Vfcmk7CiAgICAgIGNvbnN0IHJqID0gYXBwbHlGb3JjZV9yajsKICAgICAgY29uc3QgcmlfeF9mID0gYXBwbHlGb3JjZV9yaV94X2Y7CiAgICAgIGNvbnN0IHJqX3hfZiA9IGFwcGx5Rm9yY2VfcmpfeF9mOyAvLyBHZXQgd29ybGQgYW5jaG9ycwoKICAgICAgdGhpcy5nZXRXb3JsZEFuY2hvckEod29ybGRBbmNob3JBKTsKICAgICAgdGhpcy5nZXRXb3JsZEFuY2hvckIod29ybGRBbmNob3JCKTsgLy8gR2V0IG9mZnNldCBwb2ludHMKCiAgICAgIHdvcmxkQW5jaG9yQS52c3ViKGJvZHlBLnBvc2l0aW9uLCByaSk7CiAgICAgIHdvcmxkQW5jaG9yQi52c3ViKGJvZHlCLnBvc2l0aW9uLCByaik7IC8vIENvbXB1dGUgZGlzdGFuY2UgdmVjdG9yIGJldHdlZW4gd29ybGQgYW5jaG9yIHBvaW50cwoKICAgICAgd29ybGRBbmNob3JCLnZzdWIod29ybGRBbmNob3JBLCByKTsKICAgICAgY29uc3QgcmxlbiA9IHIubGVuZ3RoKCk7CiAgICAgIHJfdW5pdC5jb3B5KHIpOwogICAgICByX3VuaXQubm9ybWFsaXplKCk7IC8vIENvbXB1dGUgcmVsYXRpdmUgdmVsb2NpdHkgb2YgdGhlIGFuY2hvciBwb2ludHMsIHUKCiAgICAgIGJvZHlCLnZlbG9jaXR5LnZzdWIoYm9keUEudmVsb2NpdHksIHUpOyAvLyBBZGQgcm90YXRpb25hbCB2ZWxvY2l0eQoKICAgICAgYm9keUIuYW5ndWxhclZlbG9jaXR5LmNyb3NzKHJqLCB0bXApOwogICAgICB1LnZhZGQodG1wLCB1KTsKICAgICAgYm9keUEuYW5ndWxhclZlbG9jaXR5LmNyb3NzKHJpLCB0bXApOwogICAgICB1LnZzdWIodG1wLCB1KTsgLy8gRiA9IC0gayAqICggeCAtIEwgKSAtIEQgKiAoIHUgKQoKICAgICAgcl91bml0LnNjYWxlKC1rICogKHJsZW4gLSBsKSAtIGQgKiB1LmRvdChyX3VuaXQpLCBmKTsgLy8gQWRkIGZvcmNlcyB0byBib2RpZXMKCiAgICAgIGJvZHlBLmZvcmNlLnZzdWIoZiwgYm9keUEuZm9yY2UpOwogICAgICBib2R5Qi5mb3JjZS52YWRkKGYsIGJvZHlCLmZvcmNlKTsgLy8gQW5ndWxhciBmb3JjZQoKICAgICAgcmkuY3Jvc3MoZiwgcmlfeF9mKTsKICAgICAgcmouY3Jvc3MoZiwgcmpfeF9mKTsKICAgICAgYm9keUEudG9ycXVlLnZzdWIocmlfeF9mLCBib2R5QS50b3JxdWUpOwogICAgICBib2R5Qi50b3JxdWUudmFkZChyal94X2YsIGJvZHlCLnRvcnF1ZSk7CiAgICB9CgogIH0KCiAgY29uc3QgYXBwbHlGb3JjZV9yID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3JfdW5pdCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV91ID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX2YgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2Vfd29ybGRBbmNob3JBID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3dvcmxkQW5jaG9yQiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9yaSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9yaiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9yaV94X2YgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmpfeF9mID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3RtcCA9IG5ldyBWZWMzKCk7CiAgLyoqCiAgICogV2hlZWxJbmZvCiAgICovCgogIGNsYXNzIFdoZWVsSW5mbyB7CiAgICAvKioKICAgICAqIE1heCB0cmF2ZWwgZGlzdGFuY2Ugb2YgdGhlIHN1c3BlbnNpb24sIGluIG1ldGVycy4KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogU3BlZWQgdG8gYXBwbHkgdG8gdGhlIHdoZWVsIHJvdGF0aW9uIHdoZW4gdGhlIHdoZWVsIGlzIHNsaWRpbmcuCiAgICAgKiBAZGVmYXVsdCAtMC4xCiAgICAgKi8KCiAgICAvKioKICAgICAqIElmIHRoZSBjdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkIHNob3VsZCBiZSB1c2VkLgogICAgICogQGRlZmF1bHQgZmFsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogc2xpZGluZwogICAgICovCgogICAgLyoqCiAgICAgKiBDb25uZWN0aW9uIHBvaW50LCBkZWZpbmVkIGxvY2FsbHkgaW4gdGhlIGNoYXNzaXMgYm9keSBmcmFtZS4KICAgICAqLwoKICAgIC8qKgogICAgICogY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRpcmVjdGlvbkxvY2FsCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRpcmVjdGlvbldvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGF4bGVMb2NhbAogICAgICovCgogICAgLyoqCiAgICAgKiBheGxlV29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvblJlc3RMZW5ndGgKICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvbk1heExlbmd0aAogICAgICogQGRlZmF1bHQgMgogICAgICovCgogICAgLyoqCiAgICAgKiByYWRpdXMKICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvblN0aWZmbmVzcwogICAgICogQGRlZmF1bHQgMTAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRhbXBpbmdDb21wcmVzc2lvbgogICAgICogQGRlZmF1bHQgMTAKICAgICAqLwoKICAgIC8qKgogICAgICogZGFtcGluZ1JlbGF4YXRpb24KICAgICAqIEBkZWZhdWx0IDEwCiAgICAgKi8KCiAgICAvKioKICAgICAqIGZyaWN0aW9uU2xpcAogICAgICogQGRlZmF1bHQgMTAuNQogICAgICovCgogICAgLyoqIGZvcndhcmRBY2NlbGVyYXRpb24gKi8KCiAgICAvKiogc2lkZUFjY2VsZXJhdGlvbiAqLwoKICAgIC8qKgogICAgICogc3RlZXJpbmcKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogUm90YXRpb24gdmFsdWUsIGluIHJhZGlhbnMuCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRlbHRhUm90YXRpb24KICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogcm9sbEluZmx1ZW5jZQogICAgICogQGRlZmF1bHQgMC4wMQogICAgICovCgogICAgLyoqCiAgICAgKiBtYXhTdXNwZW5zaW9uRm9yY2UKICAgICAqLwoKICAgIC8qKgogICAgICogZW5naW5lRm9yY2UKICAgICAqLwoKICAgIC8qKgogICAgICogYnJha2UKICAgICAqLwoKICAgIC8qKgogICAgICogaXNGcm9udFdoZWVsCiAgICAgKiBAZGVmYXVsdCB0cnVlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNsaXBwZWRJbnZDb250YWN0RG90U3VzcGVuc2lvbgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBzdXNwZW5zaW9uUmVsYXRpdmVWZWxvY2l0eQogICAgICogQGRlZmF1bHQgMAogICAgICovCgogICAgLyoqCiAgICAgKiBzdXNwZW5zaW9uRm9yY2UKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc2xpcEluZm8KICAgICAqLwoKICAgIC8qKgogICAgICogc2tpZEluZm8KICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvbkxlbmd0aAogICAgICogQGRlZmF1bHQgMAogICAgICovCgogICAgLyoqCiAgICAgKiBzaWRlSW1wdWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBmb3J3YXJkSW1wdWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgcmVzdWx0IGZyb20gcmF5Y2FzdGluZy4KICAgICAqLwoKICAgIC8qKgogICAgICogV2hlZWwgd29ybGQgdHJhbnNmb3JtLgogICAgICovCgogICAgLyoqCiAgICAgKiBpc0luQ29udGFjdAogICAgICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHsKICAgICAgdGhpcy5tYXhTdXNwZW5zaW9uVHJhdmVsID0gdm9pZCAwOwogICAgICB0aGlzLmN1c3RvbVNsaWRpbmdSb3RhdGlvbmFsU3BlZWQgPSB2b2lkIDA7CiAgICAgIHRoaXMudXNlQ3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCA9IHZvaWQgMDsKICAgICAgdGhpcy5zbGlkaW5nID0gdm9pZCAwOwogICAgICB0aGlzLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbCA9IHZvaWQgMDsKICAgICAgdGhpcy5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQgPSB2b2lkIDA7CiAgICAgIHRoaXMuZGlyZWN0aW9uTG9jYWwgPSB2b2lkIDA7CiAgICAgIHRoaXMuZGlyZWN0aW9uV29ybGQgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhsZUxvY2FsID0gdm9pZCAwOwogICAgICB0aGlzLmF4bGVXb3JsZCA9IHZvaWQgMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uUmVzdExlbmd0aCA9IHZvaWQgMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uTWF4TGVuZ3RoID0gdm9pZCAwOwogICAgICB0aGlzLnJhZGl1cyA9IHZvaWQgMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uU3RpZmZuZXNzID0gdm9pZCAwOwogICAgICB0aGlzLmRhbXBpbmdDb21wcmVzc2lvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5kYW1waW5nUmVsYXhhdGlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5mcmljdGlvblNsaXAgPSB2b2lkIDA7CiAgICAgIHRoaXMuZm9yd2FyZEFjY2VsZXJhdGlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5zaWRlQWNjZWxlcmF0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLnN0ZWVyaW5nID0gdm9pZCAwOwogICAgICB0aGlzLnJvdGF0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLmRlbHRhUm90YXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMucm9sbEluZmx1ZW5jZSA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXhTdXNwZW5zaW9uRm9yY2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuZW5naW5lRm9yY2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuYnJha2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuaXNGcm9udFdoZWVsID0gdm9pZCAwOwogICAgICB0aGlzLmNsaXBwZWRJbnZDb250YWN0RG90U3VzcGVuc2lvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uUmVsYXRpdmVWZWxvY2l0eSA9IHZvaWQgMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uRm9yY2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2xpcEluZm8gPSB2b2lkIDA7CiAgICAgIHRoaXMuc2tpZEluZm8gPSB2b2lkIDA7CiAgICAgIHRoaXMuc3VzcGVuc2lvbkxlbmd0aCA9IHZvaWQgMDsKICAgICAgdGhpcy5zaWRlSW1wdWxzZSA9IHZvaWQgMDsKICAgICAgdGhpcy5mb3J3YXJkSW1wdWxzZSA9IHZvaWQgMDsKICAgICAgdGhpcy5yYXljYXN0UmVzdWx0ID0gdm9pZCAwOwogICAgICB0aGlzLndvcmxkVHJhbnNmb3JtID0gdm9pZCAwOwogICAgICB0aGlzLmlzSW5Db250YWN0ID0gdm9pZCAwOwogICAgICBvcHRpb25zID0gVXRpbHMuZGVmYXVsdHMob3B0aW9ucywgewogICAgICAgIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbDogbmV3IFZlYzMoKSwKICAgICAgICBjaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uTG9jYWw6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uV29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgYXhsZUxvY2FsOiBuZXcgVmVjMygpLAogICAgICAgIGF4bGVXb3JsZDogbmV3IFZlYzMoKSwKICAgICAgICBzdXNwZW5zaW9uUmVzdExlbmd0aDogMSwKICAgICAgICBzdXNwZW5zaW9uTWF4TGVuZ3RoOiAyLAogICAgICAgIHJhZGl1czogMSwKICAgICAgICBzdXNwZW5zaW9uU3RpZmZuZXNzOiAxMDAsCiAgICAgICAgZGFtcGluZ0NvbXByZXNzaW9uOiAxMCwKICAgICAgICBkYW1waW5nUmVsYXhhdGlvbjogMTAsCiAgICAgICAgZnJpY3Rpb25TbGlwOiAxMC41LAogICAgICAgIGZvcndhcmRBY2NlbGVyYXRpb246IDEsCiAgICAgICAgc2lkZUFjY2VsZXJhdGlvbjogMSwKICAgICAgICBzdGVlcmluZzogMCwKICAgICAgICByb3RhdGlvbjogMCwKICAgICAgICBkZWx0YVJvdGF0aW9uOiAwLAogICAgICAgIHJvbGxJbmZsdWVuY2U6IDAuMDEsCiAgICAgICAgbWF4U3VzcGVuc2lvbkZvcmNlOiBOdW1iZXIuTUFYX1ZBTFVFLAogICAgICAgIGlzRnJvbnRXaGVlbDogdHJ1ZSwKICAgICAgICBjbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb246IDEsCiAgICAgICAgc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHk6IDAsCiAgICAgICAgc3VzcGVuc2lvbkZvcmNlOiAwLAogICAgICAgIHNsaXBJbmZvOiAwLAogICAgICAgIHNraWRJbmZvOiAwLAogICAgICAgIHN1c3BlbnNpb25MZW5ndGg6IDAsCiAgICAgICAgbWF4U3VzcGVuc2lvblRyYXZlbDogMSwKICAgICAgICB1c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiBmYWxzZSwKICAgICAgICBjdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiAtMC4xCiAgICAgIH0pOwogICAgICB0aGlzLm1heFN1c3BlbnNpb25UcmF2ZWwgPSBvcHRpb25zLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgIHRoaXMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCA9IG9wdGlvbnMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZDsKICAgICAgdGhpcy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkID0gb3B0aW9ucy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOwogICAgICB0aGlzLnNsaWRpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5jaGFzc2lzQ29ubmVjdGlvblBvaW50TG9jYWwgPSBvcHRpb25zLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbC5jbG9uZSgpOwogICAgICB0aGlzLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZCA9IG9wdGlvbnMuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uTG9jYWwgPSBvcHRpb25zLmRpcmVjdGlvbkxvY2FsLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uV29ybGQgPSBvcHRpb25zLmRpcmVjdGlvbldvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuYXhsZUxvY2FsID0gb3B0aW9ucy5heGxlTG9jYWwuY2xvbmUoKTsKICAgICAgdGhpcy5heGxlV29ybGQgPSBvcHRpb25zLmF4bGVXb3JsZC5jbG9uZSgpOwogICAgICB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgdGhpcy5zdXNwZW5zaW9uTWF4TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uTWF4TGVuZ3RoOwogICAgICB0aGlzLnJhZGl1cyA9IG9wdGlvbnMucmFkaXVzOwogICAgICB0aGlzLnN1c3BlbnNpb25TdGlmZm5lc3MgPSBvcHRpb25zLnN1c3BlbnNpb25TdGlmZm5lc3M7CiAgICAgIHRoaXMuZGFtcGluZ0NvbXByZXNzaW9uID0gb3B0aW9ucy5kYW1waW5nQ29tcHJlc3Npb247CiAgICAgIHRoaXMuZGFtcGluZ1JlbGF4YXRpb24gPSBvcHRpb25zLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICB0aGlzLmZyaWN0aW9uU2xpcCA9IG9wdGlvbnMuZnJpY3Rpb25TbGlwOwogICAgICB0aGlzLmZvcndhcmRBY2NlbGVyYXRpb24gPSBvcHRpb25zLmZvcndhcmRBY2NlbGVyYXRpb247CiAgICAgIHRoaXMuc2lkZUFjY2VsZXJhdGlvbiA9IG9wdGlvbnMuc2lkZUFjY2VsZXJhdGlvbjsKICAgICAgdGhpcy5zdGVlcmluZyA9IDA7CiAgICAgIHRoaXMucm90YXRpb24gPSAwOwogICAgICB0aGlzLmRlbHRhUm90YXRpb24gPSAwOwogICAgICB0aGlzLnJvbGxJbmZsdWVuY2UgPSBvcHRpb25zLnJvbGxJbmZsdWVuY2U7CiAgICAgIHRoaXMubWF4U3VzcGVuc2lvbkZvcmNlID0gb3B0aW9ucy5tYXhTdXNwZW5zaW9uRm9yY2U7CiAgICAgIHRoaXMuZW5naW5lRm9yY2UgPSAwOwogICAgICB0aGlzLmJyYWtlID0gMDsKICAgICAgdGhpcy5pc0Zyb250V2hlZWwgPSBvcHRpb25zLmlzRnJvbnRXaGVlbDsKICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxOwogICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICB0aGlzLnNsaXBJbmZvID0gMDsKICAgICAgdGhpcy5za2lkSW5mbyA9IDA7CiAgICAgIHRoaXMuc3VzcGVuc2lvbkxlbmd0aCA9IDA7CiAgICAgIHRoaXMuc2lkZUltcHVsc2UgPSAwOwogICAgICB0aGlzLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgdGhpcy5yYXljYXN0UmVzdWx0ID0gbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy53b3JsZFRyYW5zZm9ybSA9IG5ldyBUcmFuc2Zvcm0oKTsKICAgICAgdGhpcy5pc0luQ29udGFjdCA9IGZhbHNlOwogICAgfQoKICAgIHVwZGF0ZVdoZWVsKGNoYXNzaXMpIHsKICAgICAgY29uc3QgcmF5Y2FzdFJlc3VsdCA9IHRoaXMucmF5Y2FzdFJlc3VsdDsKCiAgICAgIGlmICh0aGlzLmlzSW5Db250YWN0KSB7CiAgICAgICAgY29uc3QgcHJvamVjdCA9IHJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHJheWNhc3RSZXN1bHQuZGlyZWN0aW9uV29ybGQpOwogICAgICAgIHJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXMucG9zaXRpb24sIHJlbHBvcyk7CiAgICAgICAgY2hhc3Npcy5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChyZWxwb3MsIGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKICAgICAgICBjb25zdCBwcm9qVmVsID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZC5kb3QoY2hhc3Npc192ZWxvY2l0eV9hdF9jb250YWN0UG9pbnQpOwoKICAgICAgICBpZiAocHJvamVjdCA+PSAtMC4xKSB7CiAgICAgICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjAgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gcHJvamVjdDsKICAgICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSBwcm9qVmVsICogaW52OwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIE5vdCBpbiBjb250YWN0IDogcG9zaXRpb24gd2hlZWwgaW4gYSBuaWNlIChyZXN0IGxlbmd0aCkgcG9zaXRpb24KICAgICAgICByYXljYXN0UmVzdWx0LnN1c3BlbnNpb25MZW5ndGggPSB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoOwogICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSAwLjA7CiAgICAgICAgcmF5Y2FzdFJlc3VsdC5kaXJlY3Rpb25Xb3JsZC5zY2FsZSgtMSwgcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZCk7CiAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KICAgIH0KCiAgfQoKICBjb25zdCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcmVscG9zID0gbmV3IFZlYzMoKTsKICAvKioKICAgKiBWZWhpY2xlIGhlbHBlciBjbGFzcyB0aGF0IGNhc3RzIHJheXMgZnJvbSB0aGUgd2hlZWwgcG9zaXRpb25zIHRvd2FyZHMgdGhlIGdyb3VuZCBhbmQgYXBwbGllcyBmb3JjZXMuCiAgICovCgogIGNsYXNzIFJheWNhc3RWZWhpY2xlIHsKICAgIC8qKiBUaGUgY2FyIGNoYXNzaXMgYm9keS4gKi8KCiAgICAvKiogVGhlIHdoZWVscy4gKi8KCiAgICAvKiogV2lsbCBiZSBzZXQgdG8gdHJ1ZSBpZiB0aGUgY2FyIGlzIHNsaWRpbmcuICovCgogICAgLyoqIEluZGV4IG9mIHRoZSByaWdodCBheGlzLiB4PTAsIHk9MSwgej0yICovCgogICAgLyoqIEluZGV4IG9mIHRoZSBmb3J3YXJkIGF4aXMuIHg9MCwgeT0xLCB6PTIgKi8KCiAgICAvKiogSW5kZXggb2YgdGhlIHVwIGF4aXMuIHg9MCwgeT0xLCB6PTIgKi8KCiAgICAvKiogVGhlIGNvbnN0cmFpbnRzLiAqLwoKICAgIC8qKiBPcHRpb25hbCBwcmUtc3RlcCBjYWxsYmFjay4gKi8KCiAgICAvKiogTnVtYmVyIG9mIHdoZWVscyBvbiB0aGUgZ3JvdW5kLiAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICB0aGlzLmNoYXNzaXNCb2R5ID0gdm9pZCAwOwogICAgICB0aGlzLndoZWVsSW5mb3MgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2xpZGluZyA9IHZvaWQgMDsKICAgICAgdGhpcy53b3JsZCA9IHZvaWQgMDsKICAgICAgdGhpcy5pbmRleFJpZ2h0QXhpcyA9IHZvaWQgMDsKICAgICAgdGhpcy5pbmRleEZvcndhcmRBeGlzID0gdm9pZCAwOwogICAgICB0aGlzLmluZGV4VXBBeGlzID0gdm9pZCAwOwogICAgICB0aGlzLmNvbnN0cmFpbnRzID0gdm9pZCAwOwogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9IHZvaWQgMDsKICAgICAgdGhpcy5jdXJyZW50VmVoaWNsZVNwZWVkS21Ib3VyID0gdm9pZCAwOwogICAgICB0aGlzLm51bVdoZWVsc09uR3JvdW5kID0gdm9pZCAwOwogICAgICB0aGlzLmNoYXNzaXNCb2R5ID0gb3B0aW9ucy5jaGFzc2lzQm9keTsKICAgICAgdGhpcy53aGVlbEluZm9zID0gW107CiAgICAgIHRoaXMuc2xpZGluZyA9IGZhbHNlOwogICAgICB0aGlzLndvcmxkID0gbnVsbDsKICAgICAgdGhpcy5pbmRleFJpZ2h0QXhpcyA9IHR5cGVvZiBvcHRpb25zLmluZGV4UmlnaHRBeGlzICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuaW5kZXhSaWdodEF4aXMgOiAyOwogICAgICB0aGlzLmluZGV4Rm9yd2FyZEF4aXMgPSB0eXBlb2Ygb3B0aW9ucy5pbmRleEZvcndhcmRBeGlzICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuaW5kZXhGb3J3YXJkQXhpcyA6IDA7CiAgICAgIHRoaXMuaW5kZXhVcEF4aXMgPSB0eXBlb2Ygb3B0aW9ucy5pbmRleFVwQXhpcyAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmluZGV4VXBBeGlzIDogMTsKICAgICAgdGhpcy5jb25zdHJhaW50cyA9IFtdOwoKICAgICAgdGhpcy5wcmVTdGVwQ2FsbGJhY2sgPSAoKSA9PiB7fTsKCiAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciA9IDA7CiAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQgPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSB3aGVlbC4gRm9yIGluZm9ybWF0aW9uIGFib3V0IHRoZSBvcHRpb25zLCBzZWUgYFdoZWVsSW5mb2AuCiAgICAgKi8KCgogICAgYWRkV2hlZWwob3B0aW9ucyA9IHt9KSB7CiAgICAgIGNvbnN0IGluZm8gPSBuZXcgV2hlZWxJbmZvKG9wdGlvbnMpOwogICAgICBjb25zdCBpbmRleCA9IHRoaXMud2hlZWxJbmZvcy5sZW5ndGg7CiAgICAgIHRoaXMud2hlZWxJbmZvcy5wdXNoKGluZm8pOwogICAgICByZXR1cm4gaW5kZXg7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgc3RlZXJpbmcgdmFsdWUgb2YgYSB3aGVlbC4KICAgICAqLwoKCiAgICBzZXRTdGVlcmluZ1ZhbHVlKHZhbHVlLCB3aGVlbEluZGV4KSB7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB3aGVlbC5zdGVlcmluZyA9IHZhbHVlOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHdoZWVsIGZvcmNlIHRvIGFwcGx5IG9uIG9uZSBvZiB0aGUgd2hlZWxzIGVhY2ggdGltZSBzdGVwCiAgICAgKi8KCgogICAgYXBwbHlFbmdpbmVGb3JjZSh2YWx1ZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uZW5naW5lRm9yY2UgPSB2YWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBicmFraW5nIGZvcmNlIG9mIGEgd2hlZWwKICAgICAqLwoKCiAgICBzZXRCcmFrZShicmFrZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uYnJha2UgPSBicmFrZTsKICAgIH0KICAgIC8qKgogICAgICogQWRkIHRoZSB2ZWhpY2xlIGluY2x1ZGluZyBpdHMgY29uc3RyYWludHMgdG8gdGhlIHdvcmxkLgogICAgICovCgoKICAgIGFkZFRvV29ybGQod29ybGQpIHsKICAgICAgd29ybGQuYWRkQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgY29uc3QgdGhhdCA9IHRoaXM7CgogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9ICgpID0+IHsKICAgICAgICB0aGF0LnVwZGF0ZVZlaGljbGUod29ybGQuZHQpOwogICAgICB9OwoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgb25lIG9mIHRoZSB3aGVlbCBheGxlcywgd29ybGQtb3JpZW50ZWQuCiAgICAgKi8KCgogICAgZ2V0VmVoaWNsZUF4aXNXb3JsZChheGlzSW5kZXgsIHJlc3VsdCkgewogICAgICByZXN1bHQuc2V0KGF4aXNJbmRleCA9PT0gMCA/IDEgOiAwLCBheGlzSW5kZXggPT09IDEgPyAxIDogMCwgYXhpc0luZGV4ID09PSAyID8gMSA6IDApOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnZlY3RvclRvV29ybGRGcmFtZShyZXN1bHQsIHJlc3VsdCk7CiAgICB9CgogICAgdXBkYXRlVmVoaWNsZSh0aW1lU3RlcCkgewogICAgICBjb25zdCB3aGVlbEluZm9zID0gdGhpcy53aGVlbEluZm9zOwogICAgICBjb25zdCBudW1XaGVlbHMgPSB3aGVlbEluZm9zLmxlbmd0aDsKICAgICAgY29uc3QgY2hhc3Npc0JvZHkgPSB0aGlzLmNoYXNzaXNCb2R5OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm0oaSk7CiAgICAgIH0KCiAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciA9IDMuNiAqIGNoYXNzaXNCb2R5LnZlbG9jaXR5Lmxlbmd0aCgpOwogICAgICBjb25zdCBmb3J3YXJkV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmdldFZlaGljbGVBeGlzV29ybGQodGhpcy5pbmRleEZvcndhcmRBeGlzLCBmb3J3YXJkV29ybGQpOwoKICAgICAgaWYgKGZvcndhcmRXb3JsZC5kb3QoY2hhc3Npc0JvZHkudmVsb2NpdHkpIDwgMCkgewogICAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciAqPSAtMTsKICAgICAgfSAvLyBzaW11bGF0ZSBzdXNwZW5zaW9uCgoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMuY2FzdFJheSh3aGVlbEluZm9zW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVTdXNwZW5zaW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaW1wdWxzZSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgLy9hcHBseSBzdXNwZW5zaW9uIGZvcmNlCiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOwogICAgICAgIGxldCBzdXNwZW5zaW9uRm9yY2UgPSB3aGVlbC5zdXNwZW5zaW9uRm9yY2U7CgogICAgICAgIGlmIChzdXNwZW5zaW9uRm9yY2UgPiB3aGVlbC5tYXhTdXNwZW5zaW9uRm9yY2UpIHsKICAgICAgICAgIHN1c3BlbnNpb25Gb3JjZSA9IHdoZWVsLm1heFN1c3BlbnNpb25Gb3JjZTsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUoc3VzcGVuc2lvbkZvcmNlICogdGltZVN0ZXAsIGltcHVsc2UpOwogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXNCb2R5LnBvc2l0aW9uLCByZWxwb3MpOwogICAgICAgIGNoYXNzaXNCb2R5LmFwcGx5SW1wdWxzZShpbXB1bHNlLCByZWxwb3MpOwogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZUZyaWN0aW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGZ3ZCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHZlbCA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOyAvL2NvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgLy93aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQudnN1YihjaGFzc2lzQm9keS5wb3NpdGlvbiwgcmVscG9zKTsKCiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCB2ZWwpOyAvLyBIYWNrIHRvIGdldCB0aGUgcm90YXRpb24gaW4gdGhlIGNvcnJlY3QgZGlyZWN0aW9uCgogICAgICAgIGxldCBtID0gMTsKCiAgICAgICAgc3dpdGNoICh0aGlzLmluZGV4VXBBeGlzKSB7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIG0gPSAtMTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIHRoaXMuZ2V0VmVoaWNsZUF4aXNXb3JsZCh0aGlzLmluZGV4Rm9yd2FyZEF4aXMsIGZ3ZCk7CiAgICAgICAgICBjb25zdCBwcm9qID0gZndkLmRvdCh3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUocHJvaiwgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaik7CiAgICAgICAgICBmd2QudnN1YihoaXROb3JtYWxXb3JsZFNjYWxlZFdpdGhQcm9qLCBmd2QpOwogICAgICAgICAgY29uc3QgcHJvajIgPSBmd2QuZG90KHZlbCk7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gbSAqIHByb2oyICogdGltZVN0ZXAgLyB3aGVlbC5yYWRpdXM7CiAgICAgICAgfQoKICAgICAgICBpZiAoKHdoZWVsLnNsaWRpbmcgfHwgIXdoZWVsLmlzSW5Db250YWN0KSAmJiB3aGVlbC5lbmdpbmVGb3JjZSAhPT0gMCAmJiB3aGVlbC51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkKSB7CiAgICAgICAgICAvLyBBcHBseSBjdXN0b20gcm90YXRpb24gd2hlbiBhY2NlbGVyYXRpbmcgYW5kIHNsaWRpbmcKICAgICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gPSAod2hlZWwuZW5naW5lRm9yY2UgPiAwID8gMSA6IC0xKSAqIHdoZWVsLmN1c3RvbVNsaWRpbmdSb3RhdGlvbmFsU3BlZWQgKiB0aW1lU3RlcDsKICAgICAgICB9IC8vIExvY2sgd2hlZWxzCgoKICAgICAgICBpZiAoTWF0aC5hYnMod2hlZWwuYnJha2UpID4gTWF0aC5hYnMod2hlZWwuZW5naW5lRm9yY2UpKSB7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gMDsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJvdGF0aW9uICs9IHdoZWVsLmRlbHRhUm90YXRpb247IC8vIFVzZSB0aGUgb2xkIHZhbHVlCgogICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gKj0gMC45OTsgLy8gZGFtcGluZyBvZiByb3RhdGlvbiB3aGVuIG5vdCBpbiBjb250YWN0CiAgICAgIH0KICAgIH0KCiAgICB1cGRhdGVTdXNwZW5zaW9uKGRlbHRhVGltZSkgewogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGNoYXNzaXNNYXNzID0gY2hhc3Npc0JvZHkubWFzczsKICAgICAgY29uc3Qgd2hlZWxJbmZvcyA9IHRoaXMud2hlZWxJbmZvczsKICAgICAgY29uc3QgbnVtV2hlZWxzID0gd2hlZWxJbmZvcy5sZW5ndGg7CgogICAgICBmb3IgKGxldCB3X2l0ID0gMDsgd19pdCA8IG51bVdoZWVsczsgd19pdCsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW3dfaXRdOwoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIGxldCBmb3JjZTsgLy8gU3ByaW5nCgogICAgICAgICAgY29uc3Qgc3VzcF9sZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgICAgIGNvbnN0IGN1cnJlbnRfbGVuZ3RoID0gd2hlZWwuc3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICAgIGNvbnN0IGxlbmd0aF9kaWZmID0gc3VzcF9sZW5ndGggLSBjdXJyZW50X2xlbmd0aDsKICAgICAgICAgIGZvcmNlID0gd2hlZWwuc3VzcGVuc2lvblN0aWZmbmVzcyAqIGxlbmd0aF9kaWZmICogd2hlZWwuY2xpcHBlZEludkNvbnRhY3REb3RTdXNwZW5zaW9uOyAvLyBEYW1wZXIKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWRfcmVsX3ZlbCA9IHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5OwogICAgICAgICAgbGV0IHN1c3BfZGFtcGluZzsKCiAgICAgICAgICBpZiAocHJvamVjdGVkX3JlbF92ZWwgPCAwKSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdDb21wcmVzc2lvbjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIGZvcmNlIC09IHN1c3BfZGFtcGluZyAqIHByb2plY3RlZF9yZWxfdmVsOwogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkZvcmNlID0gZm9yY2UgKiBjaGFzc2lzTWFzczsKCiAgICAgICAgICBpZiAod2hlZWwuc3VzcGVuc2lvbkZvcmNlIDwgMCkgewogICAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhlIHZlaGljbGUgaW5jbHVkaW5nIGl0cyBjb25zdHJhaW50cyBmcm9tIHRoZSB3b3JsZC4KICAgICAqLwoKCiAgICByZW1vdmVGcm9tV29ybGQod29ybGQpIHsKICAgICAgdGhpcy5jb25zdHJhaW50czsKICAgICAgd29ybGQucmVtb3ZlQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgd29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICB9CgogICAgY2FzdFJheSh3aGVlbCkgewogICAgICBjb25zdCByYXl2ZWN0b3IgPSBjYXN0UmF5X3JheXZlY3RvcjsKICAgICAgY29uc3QgdGFyZ2V0ID0gY2FzdFJheV90YXJnZXQ7CiAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm1Xb3JsZCh3aGVlbCk7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgbGV0IGRlcHRoID0gLTE7CiAgICAgIGNvbnN0IHJheWxlbiA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwucmFkaXVzOwogICAgICB3aGVlbC5kaXJlY3Rpb25Xb3JsZC5zY2FsZShyYXlsZW4sIHJheXZlY3Rvcik7CiAgICAgIGNvbnN0IHNvdXJjZSA9IHdoZWVsLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZDsKICAgICAgc291cmNlLnZhZGQocmF5dmVjdG9yLCB0YXJnZXQpOwogICAgICBjb25zdCByYXljYXN0UmVzdWx0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdDsKICAgICAgcmF5Y2FzdFJlc3VsdC5yZXNldCgpOyAvLyBUdXJuIG9mZiByYXkgY29sbGlzaW9uIHdpdGggdGhlIGNoYXNzaXMgdGVtcG9yYXJpbHkKCiAgICAgIGNvbnN0IG9sZFN0YXRlID0gY2hhc3Npc0JvZHkuY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gZmFsc2U7IC8vIENhc3QgcmF5IGFnYWluc3Qgd29ybGQKCiAgICAgIHRoaXMud29ybGQucmF5VGVzdChzb3VyY2UsIHRhcmdldCwgcmF5Y2FzdFJlc3VsdCk7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gb2xkU3RhdGU7CiAgICAgIGNvbnN0IG9iamVjdCA9IHJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5ncm91bmRPYmplY3QgPSAwOwoKICAgICAgaWYgKG9iamVjdCkgewogICAgICAgIGRlcHRoID0gcmF5Y2FzdFJlc3VsdC5kaXN0YW5jZTsKICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZDsKICAgICAgICB3aGVlbC5pc0luQ29udGFjdCA9IHRydWU7CiAgICAgICAgY29uc3QgaGl0RGlzdGFuY2UgPSByYXljYXN0UmVzdWx0LmRpc3RhbmNlOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSBoaXREaXN0YW5jZSAtIHdoZWVsLnJhZGl1czsgLy8gY2xhbXAgb24gbWF4IHN1c3BlbnNpb24gdHJhdmVsCgogICAgICAgIGNvbnN0IG1pblN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCAtIHdoZWVsLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgICAgY29uc3QgbWF4U3VzcGVuc2lvbkxlbmd0aCA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwubWF4U3VzcGVuc2lvblRyYXZlbDsKCiAgICAgICAgaWYgKHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPCBtaW5TdXNwZW5zaW9uTGVuZ3RoKSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID0gbWluU3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICB9CgogICAgICAgIGlmICh3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID4gbWF4U3VzcGVuc2lvbkxlbmd0aCkgewogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkxlbmd0aCA9IG1heFN1c3BlbnNpb25MZW5ndGg7CiAgICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LnJlc2V0KCk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBkZW5vbWluYXRvciA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgICBjb25zdCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCk7CiAgICAgICAgY29uc3QgcHJvalZlbCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKCiAgICAgICAgaWYgKGRlbm9taW5hdG9yID49IC0wLjEpIHsKICAgICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgICAgIHdoZWVsLmNsaXBwZWRJbnZDb250YWN0RG90U3VzcGVuc2lvbiA9IDEgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gZGVub21pbmF0b3I7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uUmVsYXRpdmVWZWxvY2l0eSA9IHByb2pWZWwgKiBpbnY7CiAgICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vcHV0IHdoZWVsIGluZm8gYXMgaW4gcmVzdCBwb3NpdGlvbgogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCArIDAgKiB3aGVlbC5tYXhTdXNwZW5zaW9uVHJhdmVsOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgIHdoZWVsLmRpcmVjdGlvbldvcmxkLnNjYWxlKC0xLCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KCiAgICAgIHJldHVybiBkZXB0aDsKICAgIH0KCiAgICB1cGRhdGVXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsKSB7CiAgICAgIHdoZWVsLmlzSW5Db250YWN0ID0gZmFsc2U7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgY2hhc3Npc0JvZHkucG9pbnRUb1dvcmxkRnJhbWUod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludExvY2FsLCB3aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQpOwogICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUod2hlZWwuZGlyZWN0aW9uTG9jYWwsIHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgY2hhc3Npc0JvZHkudmVjdG9yVG9Xb3JsZEZyYW1lKHdoZWVsLmF4bGVMb2NhbCwgd2hlZWwuYXhsZVdvcmxkKTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIG9uZSBvZiB0aGUgd2hlZWwgdHJhbnNmb3JtLgogICAgICogTm90ZSB3aGVuIHJlbmRlcmluZyB3aGVlbHM6IGR1cmluZyBlYWNoIHN0ZXAsIHdoZWVsIHRyYW5zZm9ybXMgYXJlIHVwZGF0ZWQgQkVGT1JFIHRoZSBjaGFzc2lzOyBpZS4gdGhlaXIgcG9zaXRpb24gYmVjb21lcyBpbnZhbGlkIGFmdGVyIHRoZSBzdGVwLiBUaHVzIHdoZW4geW91IHJlbmRlciB3aGVlbHMsIHlvdSBtdXN0IHVwZGF0ZSB3aGVlbCB0cmFuc2Zvcm1zIGJlZm9yZSByZW5kZXJpbmcgdGhlbS4gU2VlIHJheWNhc3RWZWhpY2xlIGRlbW8gZm9yIGFuIGV4YW1wbGUuCiAgICAgKiBAcGFyYW0gd2hlZWxJbmRleCBUaGUgd2hlZWwgaW5kZXggdG8gdXBkYXRlLgogICAgICovCgoKICAgIHVwZGF0ZVdoZWVsVHJhbnNmb3JtKHdoZWVsSW5kZXgpIHsKICAgICAgY29uc3QgdXAgPSB0bXBWZWM0OwogICAgICBjb25zdCByaWdodCA9IHRtcFZlYzU7CiAgICAgIGNvbnN0IGZ3ZCA9IHRtcFZlYzY7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB0aGlzLnVwZGF0ZVdoZWVsVHJhbnNmb3JtV29ybGQod2hlZWwpOwogICAgICB3aGVlbC5kaXJlY3Rpb25Mb2NhbC5zY2FsZSgtMSwgdXApOwogICAgICByaWdodC5jb3B5KHdoZWVsLmF4bGVMb2NhbCk7CiAgICAgIHVwLmNyb3NzKHJpZ2h0LCBmd2QpOwogICAgICBmd2Qubm9ybWFsaXplKCk7CiAgICAgIHJpZ2h0Lm5vcm1hbGl6ZSgpOyAvLyBSb3RhdGUgYXJvdW5kIHN0ZWVyaW5nIG92ZXIgdGhlIHdoZWVsQXhsZQoKICAgICAgY29uc3Qgc3RlZXJpbmcgPSB3aGVlbC5zdGVlcmluZzsKICAgICAgY29uc3Qgc3RlZXJpbmdPcm4gPSBuZXcgUXVhdGVybmlvbigpOwogICAgICBzdGVlcmluZ09ybi5zZXRGcm9tQXhpc0FuZ2xlKHVwLCBzdGVlcmluZyk7CiAgICAgIGNvbnN0IHJvdGF0aW5nT3JuID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgcm90YXRpbmdPcm4uc2V0RnJvbUF4aXNBbmdsZShyaWdodCwgd2hlZWwucm90YXRpb24pOyAvLyBXb3JsZCByb3RhdGlvbiBvZiB0aGUgd2hlZWwKCiAgICAgIGNvbnN0IHEgPSB3aGVlbC53b3JsZFRyYW5zZm9ybS5xdWF0ZXJuaW9uOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnF1YXRlcm5pb24ubXVsdChzdGVlcmluZ09ybiwgcSk7CiAgICAgIHEubXVsdChyb3RhdGluZ09ybiwgcSk7CiAgICAgIHEubm9ybWFsaXplKCk7IC8vIHdvcmxkIHBvc2l0aW9uIG9mIHRoZSB3aGVlbAoKICAgICAgY29uc3QgcCA9IHdoZWVsLndvcmxkVHJhbnNmb3JtLnBvc2l0aW9uOwogICAgICBwLmNvcHkod2hlZWwuZGlyZWN0aW9uV29ybGQpOwogICAgICBwLnNjYWxlKHdoZWVsLnN1c3BlbnNpb25MZW5ndGgsIHApOwogICAgICBwLnZhZGQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCBwKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSB3b3JsZCB0cmFuc2Zvcm0gb2Ygb25lIG9mIHRoZSB3aGVlbHMKICAgICAqLwoKCiAgICBnZXRXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsSW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMud2hlZWxJbmZvc1t3aGVlbEluZGV4XS53b3JsZFRyYW5zZm9ybTsKICAgIH0KCiAgICB1cGRhdGVGcmljdGlvbih0aW1lU3RlcCkgewogICAgICBjb25zdCBzdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2ogPSB1cGRhdGVGcmljdGlvbl9zdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2o7IC8vY2FsY3VsYXRlIHRoZSBpbXB1bHNlLCBzbyB0aGF0IHRoZSB3aGVlbHMgZG9uJ3QgbW92ZSBzaWRld2FyZHMKCiAgICAgIGNvbnN0IHdoZWVsSW5mb3MgPSB0aGlzLndoZWVsSW5mb3M7CiAgICAgIGNvbnN0IG51bVdoZWVscyA9IHdoZWVsSW5mb3MubGVuZ3RoOwogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGZvcndhcmRXUyA9IHVwZGF0ZUZyaWN0aW9uX2ZvcndhcmRXUzsKICAgICAgY29uc3QgYXhsZSA9IHVwZGF0ZUZyaWN0aW9uX2F4bGU7CiAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQgPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQrKzsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5mb3J3YXJkSW1wdWxzZSA9IDA7CgogICAgICAgIGlmICghZm9yd2FyZFdTW2ldKSB7CiAgICAgICAgICBmb3J3YXJkV1NbaV0gPSBuZXcgVmVjMygpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFheGxlW2ldKSB7CiAgICAgICAgICBheGxlW2ldID0gbmV3IFZlYzMoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgZ3JvdW5kT2JqZWN0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdC5ib2R5OwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBheGxlaSA9IGF4bGVbaV07CiAgICAgICAgICBjb25zdCB3aGVlbFRyYW5zID0gdGhpcy5nZXRXaGVlbFRyYW5zZm9ybVdvcmxkKGkpOyAvLyBHZXQgd29ybGQgYXhsZQoKICAgICAgICAgIHdoZWVsVHJhbnMudmVjdG9yVG9Xb3JsZEZyYW1lKGRpcmVjdGlvbnNbdGhpcy5pbmRleFJpZ2h0QXhpc10sIGF4bGVpKTsKICAgICAgICAgIGNvbnN0IHN1cmZOb3JtYWxXUyA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQ7CiAgICAgICAgICBjb25zdCBwcm9qID0gYXhsZWkuZG90KHN1cmZOb3JtYWxXUyk7CiAgICAgICAgICBzdXJmTm9ybWFsV1Muc2NhbGUocHJvaiwgc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qKTsKICAgICAgICAgIGF4bGVpLnZzdWIoc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qLCBheGxlaSk7CiAgICAgICAgICBheGxlaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHN1cmZOb3JtYWxXUy5jcm9zcyhheGxlaSwgZm9yd2FyZFdTW2ldKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5ub3JtYWxpemUoKTsKICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbChjaGFzc2lzQm9keSwgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBncm91bmRPYmplY3QsIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZCwgYXhsZWkpOwogICAgICAgICAgd2hlZWwuc2lkZUltcHVsc2UgKj0gc2lkZUZyaWN0aW9uU3RpZmZuZXNzMjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHNpZGVGYWN0b3IgPSAxOwogICAgICBjb25zdCBmd2RGYWN0b3IgPSAwLjU7CiAgICAgIHRoaXMuc2xpZGluZyA9IGZhbHNlOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CiAgICAgICAgbGV0IHJvbGxpbmdGcmljdGlvbiA9IDA7CiAgICAgICAgd2hlZWwuc2xpcEluZm8gPSAxOwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBkZWZhdWx0Um9sbGluZ0ZyaWN0aW9uSW1wdWxzZSA9IDA7CiAgICAgICAgICBjb25zdCBtYXhJbXB1bHNlID0gd2hlZWwuYnJha2UgPyB3aGVlbC5icmFrZSA6IGRlZmF1bHRSb2xsaW5nRnJpY3Rpb25JbXB1bHNlOyAvLyBidFdoZWVsQ29udGFjdFBvaW50IGNvbnRhY3RQdChjaGFzc2lzQm9keSxncm91bmRPYmplY3Qsd2hlZWxJbmZyYXljYXN0SW5mby5oaXRQb2ludFdvcmxkLGZvcndhcmRXU1t3aGVlbF0sbWF4SW1wdWxzZSk7CiAgICAgICAgICAvLyByb2xsaW5nRnJpY3Rpb24gPSBjYWxjUm9sbGluZ0ZyaWN0aW9uKGNvbnRhY3RQdCk7CgogICAgICAgICAgcm9sbGluZ0ZyaWN0aW9uID0gY2FsY1JvbGxpbmdGcmljdGlvbihjaGFzc2lzQm9keSwgZ3JvdW5kT2JqZWN0LCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdFBvaW50V29ybGQsIGZvcndhcmRXU1tpXSwgbWF4SW1wdWxzZSk7CiAgICAgICAgICByb2xsaW5nRnJpY3Rpb24gKz0gd2hlZWwuZW5naW5lRm9yY2UgKiB0aW1lU3RlcDsgLy8gcm9sbGluZ0ZyaWN0aW9uID0gMDsKCiAgICAgICAgICBjb25zdCBmYWN0b3IgPSBtYXhJbXB1bHNlIC8gcm9sbGluZ0ZyaWN0aW9uOwogICAgICAgICAgd2hlZWwuc2xpcEluZm8gKj0gZmFjdG9yOwogICAgICAgIH0gLy9zd2l0Y2ggYmV0d2VlbiBhY3RpdmUgcm9sbGluZyAodGhyb3R0bGUpLCBicmFraW5nIGFuZCBub24tYWN0aXZlIHJvbGxpbmcgZnJpY3Rpb24gKG50aHJvdHRsZS9icmVhaykKCgogICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5za2lkSW5mbyA9IDE7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHdoZWVsLnNraWRJbmZvID0gMTsKICAgICAgICAgIGNvbnN0IG1heGltcCA9IHdoZWVsLnN1c3BlbnNpb25Gb3JjZSAqIHRpbWVTdGVwICogd2hlZWwuZnJpY3Rpb25TbGlwOwogICAgICAgICAgY29uc3QgbWF4aW1wU2lkZSA9IG1heGltcDsKICAgICAgICAgIGNvbnN0IG1heGltcFNxdWFyZWQgPSBtYXhpbXAgKiBtYXhpbXBTaWRlOwogICAgICAgICAgd2hlZWwuZm9yd2FyZEltcHVsc2UgPSByb2xsaW5nRnJpY3Rpb247IC8vd2hlZWxJbmZvLmVuZ2luZUZvcmNlKiB0aW1lU3RlcDsKCiAgICAgICAgICBjb25zdCB4ID0gd2hlZWwuZm9yd2FyZEltcHVsc2UgKiBmd2RGYWN0b3IgLyB3aGVlbC5mb3J3YXJkQWNjZWxlcmF0aW9uOwogICAgICAgICAgY29uc3QgeSA9IHdoZWVsLnNpZGVJbXB1bHNlICogc2lkZUZhY3RvciAvIHdoZWVsLnNpZGVBY2NlbGVyYXRpb247CiAgICAgICAgICBjb25zdCBpbXB1bHNlU3F1YXJlZCA9IHggKiB4ICsgeSAqIHk7CiAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gZmFsc2U7CgogICAgICAgICAgaWYgKGltcHVsc2VTcXVhcmVkID4gbWF4aW1wU3F1YXJlZCkgewogICAgICAgICAgICB0aGlzLnNsaWRpbmcgPSB0cnVlOwogICAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgY29uc3QgZmFjdG9yID0gbWF4aW1wIC8gTWF0aC5zcXJ0KGltcHVsc2VTcXVhcmVkKTsKICAgICAgICAgICAgd2hlZWwuc2tpZEluZm8gKj0gZmFjdG9yOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuc2xpZGluZykgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKCiAgICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgICAgaWYgKHdoZWVsLnNraWRJbmZvIDwgMSkgewogICAgICAgICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIGFwcGx5IHRoZSBpbXB1bHNlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgcmVsX3BvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLnZzdWIoY2hhc3Npc0JvZHkucG9zaXRpb24sIHJlbF9wb3MpOyAvLyBjYW5ub25zIGFwcGx5aW1wdWxzZSBpcyB1c2luZyB3b3JsZCBjb29yZCBmb3IgdGhlIHBvc2l0aW9uCiAgICAgICAgLy9yZWxfcG9zLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgaWYgKHdoZWVsLmZvcndhcmRJbXB1bHNlICE9PSAwKSB7CiAgICAgICAgICBjb25zdCBpbXB1bHNlID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5zY2FsZSh3aGVlbC5mb3J3YXJkSW1wdWxzZSwgaW1wdWxzZSk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2UoaW1wdWxzZSwgcmVsX3Bvcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgIGNvbnN0IGdyb3VuZE9iamVjdCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgICAgIGNvbnN0IHJlbF9wb3MyID0gbmV3IFZlYzMoKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGdyb3VuZE9iamVjdC5wb3NpdGlvbiwgcmVsX3BvczIpOyAvL3JlbF9wb3MyLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgICBjb25zdCBzaWRlSW1wID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGF4bGVbaV0uc2NhbGUod2hlZWwuc2lkZUltcHVsc2UsIHNpZGVJbXApOyAvLyBTY2FsZSB0aGUgcmVsYXRpdmUgcG9zaXRpb24gaW4gdGhlIHVwIGRpcmVjdGlvbiB3aXRoIHJvbGxJbmZsdWVuY2UuCiAgICAgICAgICAvLyBJZiByb2xsSW5mbHVlbmNlIGlzIDEsIHRoZSBpbXB1bHNlIHdpbGwgYmUgYXBwbGllZCBvbiB0aGUgaGl0UG9pbnQgKGVhc3kgdG8gcm9sbCBvdmVyKSwgaWYgaXQgaXMgemVybyBpdCB3aWxsIGJlIGFwcGxpZWQgaW4gdGhlIHNhbWUgcGxhbmUgYXMgdGhlIGNlbnRlciBvZiBtYXNzIChub3QgZWFzeSB0byByb2xsIG92ZXIpLgoKICAgICAgICAgIGNoYXNzaXNCb2R5LnZlY3RvclRvTG9jYWxGcmFtZShyZWxfcG9zLCByZWxfcG9zKTsKICAgICAgICAgIHJlbF9wb3NbJ3h5eidbdGhpcy5pbmRleFVwQXhpc11dICo9IHdoZWVsLnJvbGxJbmZsdWVuY2U7CiAgICAgICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUocmVsX3BvcywgcmVsX3Bvcyk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2Uoc2lkZUltcCwgcmVsX3Bvcyk7IC8vYXBwbHkgZnJpY3Rpb24gaW1wdWxzZSBvbiB0aGUgZ3JvdW5kCgogICAgICAgICAgc2lkZUltcC5zY2FsZSgtMSwgc2lkZUltcCk7CiAgICAgICAgICBncm91bmRPYmplY3QuYXBwbHlJbXB1bHNlKHNpZGVJbXAsIHJlbF9wb3MyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfQoKICBjb25zdCB0bXBWZWM0ID0gbmV3IFZlYzMoKTsKICBjb25zdCB0bXBWZWM1ID0gbmV3IFZlYzMoKTsKICBjb25zdCB0bXBWZWM2ID0gbmV3IFZlYzMoKTsKICBuZXcgUmF5KCk7CiAgY29uc3QgY2FzdFJheV9yYXl2ZWN0b3IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhc3RSYXlfdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICBjb25zdCBkaXJlY3Rpb25zID0gW25ldyBWZWMzKDEsIDAsIDApLCBuZXcgVmVjMygwLCAxLCAwKSwgbmV3IFZlYzMoMCwgMCwgMSldOwogIGNvbnN0IHVwZGF0ZUZyaWN0aW9uX3N1cmZOb3JtYWxXU19zY2FsZWRfcHJvaiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdXBkYXRlRnJpY3Rpb25fYXhsZSA9IFtdOwogIGNvbnN0IHVwZGF0ZUZyaWN0aW9uX2ZvcndhcmRXUyA9IFtdOwogIGNvbnN0IHNpZGVGcmljdGlvblN0aWZmbmVzczIgPSAxOwogIGNvbnN0IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwyID0gbmV3IFZlYzMoKTsKICBjb25zdCBjYWxjUm9sbGluZ0ZyaWN0aW9uX3ZlbCA9IG5ldyBWZWMzKCk7CgogIGZ1bmN0aW9uIGNhbGNSb2xsaW5nRnJpY3Rpb24oYm9keTAsIGJvZHkxLCBmcmljdGlvblBvc1dvcmxkLCBmcmljdGlvbkRpcmVjdGlvbldvcmxkLCBtYXhJbXB1bHNlKSB7CiAgICBsZXQgajEgPSAwOwogICAgY29uc3QgY29udGFjdFBvc1dvcmxkID0gZnJpY3Rpb25Qb3NXb3JsZDsgLy8gY29uc3QgcmVsX3BvczEgPSBuZXcgVmVjMygpOwogICAgLy8gY29uc3QgcmVsX3BvczIgPSBuZXcgVmVjMygpOwoKICAgIGNvbnN0IHZlbDEgPSBjYWxjUm9sbGluZ0ZyaWN0aW9uX3ZlbDE7CiAgICBjb25zdCB2ZWwyID0gY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwyOwogICAgY29uc3QgdmVsID0gY2FsY1JvbGxpbmdGcmljdGlvbl92ZWw7IC8vIGNvbnRhY3RQb3NXb3JsZC52c3ViKGJvZHkwLnBvc2l0aW9uLCByZWxfcG9zMSk7CiAgICAvLyBjb250YWN0UG9zV29ybGQudnN1Yihib2R5MS5wb3NpdGlvbiwgcmVsX3BvczIpOwoKICAgIGJvZHkwLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KGNvbnRhY3RQb3NXb3JsZCwgdmVsMSk7CiAgICBib2R5MS5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChjb250YWN0UG9zV29ybGQsIHZlbDIpOwogICAgdmVsMS52c3ViKHZlbDIsIHZlbCk7CiAgICBjb25zdCB2cmVsID0gZnJpY3Rpb25EaXJlY3Rpb25Xb3JsZC5kb3QodmVsKTsKICAgIGNvbnN0IGRlbm9tMCA9IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3IoYm9keTAsIGZyaWN0aW9uUG9zV29ybGQsIGZyaWN0aW9uRGlyZWN0aW9uV29ybGQpOwogICAgY29uc3QgZGVub20xID0gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcihib2R5MSwgZnJpY3Rpb25Qb3NXb3JsZCwgZnJpY3Rpb25EaXJlY3Rpb25Xb3JsZCk7CiAgICBjb25zdCByZWxheGF0aW9uID0gMTsKICAgIGNvbnN0IGphY0RpYWdBQkludiA9IHJlbGF4YXRpb24gLyAoZGVub20wICsgZGVub20xKTsgLy8gY2FsY3VsYXRlIGogdGhhdCBtb3ZlcyB1cyB0byB6ZXJvIHJlbGF0aXZlIHZlbG9jaXR5CgogICAgajEgPSAtdnJlbCAqIGphY0RpYWdBQkludjsKCiAgICBpZiAobWF4SW1wdWxzZSA8IGoxKSB7CiAgICAgIGoxID0gbWF4SW1wdWxzZTsKICAgIH0KCiAgICBpZiAoajEgPCAtbWF4SW1wdWxzZSkgewogICAgICBqMSA9IC1tYXhJbXB1bHNlOwogICAgfQoKICAgIHJldHVybiBqMTsKICB9CgogIGNvbnN0IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3JfcjAgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3JfYzAgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3JfdmVjID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX20gPSBuZXcgVmVjMygpOwoKICBmdW5jdGlvbiBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yKGJvZHksIHBvcywgbm9ybWFsKSB7CiAgICBjb25zdCByMCA9IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3JfcjA7CiAgICBjb25zdCBjMCA9IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3JfYzA7CiAgICBjb25zdCB2ZWMgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3ZlYzsKICAgIGNvbnN0IG0gPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX207CiAgICBwb3MudnN1Yihib2R5LnBvc2l0aW9uLCByMCk7CiAgICByMC5jcm9zcyhub3JtYWwsIGMwKTsKICAgIGJvZHkuaW52SW5lcnRpYVdvcmxkLnZtdWx0KGMwLCBtKTsKICAgIG0uY3Jvc3MocjAsIHZlYyk7CiAgICByZXR1cm4gYm9keS5pbnZNYXNzICsgbm9ybWFsLmRvdCh2ZWMpOwogIH0KCiAgY29uc3QgcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbF92ZWwxID0gbmV3IFZlYzMoKTsKICBjb25zdCByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbDIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsID0gbmV3IFZlYzMoKTsgLy8gYmlsYXRlcmFsIGNvbnN0cmFpbnQgYmV0d2VlbiB0d28gZHluYW1pYyBvYmplY3RzCgogIGZ1bmN0aW9uIHJlc29sdmVTaW5nbGVCaWxhdGVyYWwoYm9keTEsIHBvczEsIGJvZHkyLCBwb3MyLCBub3JtYWwpIHsKICAgIGNvbnN0IG5vcm1hbExlblNxciA9IG5vcm1hbC5sZW5ndGhTcXVhcmVkKCk7CgogICAgaWYgKG5vcm1hbExlblNxciA+IDEuMSkgewogICAgICByZXR1cm4gMDsgLy8gbm8gaW1wdWxzZQogICAgfSAvLyBjb25zdCByZWxfcG9zMSA9IG5ldyBWZWMzKCk7CiAgICAvLyBjb25zdCByZWxfcG9zMiA9IG5ldyBWZWMzKCk7CiAgICAvLyBwb3MxLnZzdWIoYm9keTEucG9zaXRpb24sIHJlbF9wb3MxKTsKICAgIC8vIHBvczIudnN1Yihib2R5Mi5wb3NpdGlvbiwgcmVsX3BvczIpOwoKCiAgICBjb25zdCB2ZWwxID0gcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbF92ZWwxOwogICAgY29uc3QgdmVsMiA9IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsMjsKICAgIGNvbnN0IHZlbCA9IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsOwogICAgYm9keTEuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQocG9zMSwgdmVsMSk7CiAgICBib2R5Mi5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChwb3MyLCB2ZWwyKTsKICAgIHZlbDEudnN1Yih2ZWwyLCB2ZWwpOwogICAgY29uc3QgcmVsX3ZlbCA9IG5vcm1hbC5kb3QodmVsKTsKICAgIGNvbnN0IGNvbnRhY3REYW1waW5nID0gMC4yOwogICAgY29uc3QgbWFzc1Rlcm0gPSAxIC8gKGJvZHkxLmludk1hc3MgKyBib2R5Mi5pbnZNYXNzKTsKICAgIGNvbnN0IGltcHVsc2UgPSAtY29udGFjdERhbXBpbmcgKiByZWxfdmVsICogbWFzc1Rlcm07CiAgICByZXR1cm4gaW1wdWxzZTsKICB9CiAgLyoqCiAgICogU3BoZXJpY2FsIHNoYXBlCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgcmFkaXVzID0gMQogICAqICAgICBjb25zdCBzcGhlcmVTaGFwZSA9IG5ldyBDQU5OT04uU3BoZXJlKHJhZGl1cykKICAgKiAgICAgY29uc3Qgc3BoZXJlQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBzcGhlcmVTaGFwZSB9KQogICAqICAgICB3b3JsZC5hZGRCb2R5KHNwaGVyZUJvZHkpCiAgICovCgoKICBjbGFzcyBTcGhlcmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKioKICAgICAqIFRoZSByYWRpdXMgb2YgdGhlIHNwaGVyZS4KICAgICAqLwoKICAgIC8qKgogICAgICoKICAgICAqIEBwYXJhbSByYWRpdXMgVGhlIHJhZGl1cyBvZiB0aGUgc3BoZXJlLCBhIG5vbi1uZWdhdGl2ZSBudW1iZXIuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKHJhZGl1cykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuU1BIRVJFCiAgICAgIH0pOwogICAgICB0aGlzLnJhZGl1cyA9IHZvaWQgMDsKICAgICAgdGhpcy5yYWRpdXMgPSByYWRpdXMgIT09IHVuZGVmaW5lZCA/IHJhZGl1cyA6IDEuMDsKCiAgICAgIGlmICh0aGlzLnJhZGl1cyA8IDApIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzcGhlcmUgcmFkaXVzIGNhbm5vdCBiZSBuZWdhdGl2ZS4nKTsKICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYSAqLwoKCiAgICBjYWxjdWxhdGVMb2NhbEluZXJ0aWEobWFzcywgdGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICBjb25zdCBJID0gMi4wICogbWFzcyAqIHRoaXMucmFkaXVzICogdGhpcy5yYWRpdXMgLyA1LjA7CiAgICAgIHRhcmdldC54ID0gSTsKICAgICAgdGFyZ2V0LnkgPSBJOwogICAgICB0YXJnZXQueiA9IEk7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKiogdm9sdW1lICovCgoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuIDQuMCAqIE1hdGguUEkgKiBNYXRoLnBvdyh0aGlzLnJhZGl1cywgMykgLyAzLjA7CiAgICB9CgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSB0aGlzLnJhZGl1czsKICAgIH0KCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICBjb25zdCByID0gdGhpcy5yYWRpdXM7CiAgICAgIGNvbnN0IGF4ZXMgPSBbJ3gnLCAneScsICd6J107CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGF4ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBheCA9IGF4ZXNbaV07CiAgICAgICAgbWluW2F4XSA9IHBvc1theF0gLSByOwogICAgICAgIG1heFtheF0gPSBwb3NbYXhdICsgcjsKICAgICAgfQogICAgfQoKICB9CgogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgbmV3IFZlYzMoKTsgLy8gVGVtcCB2ZWN0b3JzIGZvciBjYWxjdWxhdGlvbgoKICBuZXcgVmVjMygpOyAvLyBSZWxhdGl2ZSB2ZWxvY2l0eQoKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgLyoqCiAgICogQ3lsaW5kZXIgY2xhc3MuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgcmFkaXVzVG9wID0gMC41CiAgICogICAgIGNvbnN0IHJhZGl1c0JvdHRvbSA9IDAuNQogICAqICAgICBjb25zdCBoZWlnaHQgPSAyCiAgICogICAgIGNvbnN0IG51bVNlZ21lbnRzID0gMTIKICAgKiAgICAgY29uc3QgY3lsaW5kZXJTaGFwZSA9IG5ldyBDQU5OT04uQ3lsaW5kZXIocmFkaXVzVG9wLCByYWRpdXNCb3R0b20sIGhlaWdodCwgbnVtU2VnbWVudHMpCiAgICogICAgIGNvbnN0IGN5bGluZGVyQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBjeWxpbmRlclNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoY3lsaW5kZXJCb2R5KQogICAqLwoKICBjbGFzcyBDeWxpbmRlciBleHRlbmRzIENvbnZleFBvbHloZWRyb24gewogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLiAqLwoKICAgIC8qKiBUaGUgbnVtYmVyIG9mIHNlZ21lbnRzIHRvIGJ1aWxkIHRoZSBjeWxpbmRlciBvdXQgb2YuICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gcmFkaXVzVG9wIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gcmFkaXVzQm90dG9tIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLgogICAgICogQHBhcmFtIG51bVNlZ21lbnRzIFRoZSBudW1iZXIgb2Ygc2VnbWVudHMgdG8gYnVpbGQgdGhlIGN5bGluZGVyIG91dCBvZi4KICAgICAqLwogICAgY29uc3RydWN0b3IocmFkaXVzVG9wID0gMSwgcmFkaXVzQm90dG9tID0gMSwgaGVpZ2h0ID0gMSwgbnVtU2VnbWVudHMgPSA4KSB7CiAgICAgIGlmIChyYWRpdXNUb3AgPCAwKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgY3lsaW5kZXIgcmFkaXVzVG9wIGNhbm5vdCBiZSBuZWdhdGl2ZS4nKTsKICAgICAgfQoKICAgICAgaWYgKHJhZGl1c0JvdHRvbSA8IDApIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjeWxpbmRlciByYWRpdXNCb3R0b20gY2Fubm90IGJlIG5lZ2F0aXZlLicpOwogICAgICB9CgogICAgICBjb25zdCBOID0gbnVtU2VnbWVudHM7CiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGNvbnN0IGF4ZXMgPSBbXTsKICAgICAgY29uc3QgZmFjZXMgPSBbXTsKICAgICAgY29uc3QgYm90dG9tZmFjZSA9IFtdOwogICAgICBjb25zdCB0b3BmYWNlID0gW107CiAgICAgIGNvbnN0IGNvcyA9IE1hdGguY29zOwogICAgICBjb25zdCBzaW4gPSBNYXRoLnNpbjsgLy8gRmlyc3QgYm90dG9tIHBvaW50CgogICAgICB2ZXJ0aWNlcy5wdXNoKG5ldyBWZWMzKC1yYWRpdXNCb3R0b20gKiBzaW4oMCksIC1oZWlnaHQgKiAwLjUsIHJhZGl1c0JvdHRvbSAqIGNvcygwKSkpOwogICAgICBib3R0b21mYWNlLnB1c2goMCk7IC8vIEZpcnN0IHRvcCBwb2ludAoKICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzVG9wICogc2luKDApLCBoZWlnaHQgKiAwLjUsIHJhZGl1c1RvcCAqIGNvcygwKSkpOwogICAgICB0b3BmYWNlLnB1c2goMSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHRoZXRhID0gMiAqIE1hdGguUEkgLyBOICogKGkgKyAxKTsKICAgICAgICBjb25zdCB0aGV0YU4gPSAyICogTWF0aC5QSSAvIE4gKiAoaSArIDAuNSk7CgogICAgICAgIGlmIChpIDwgTiAtIDEpIHsKICAgICAgICAgIC8vIEJvdHRvbQogICAgICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzQm90dG9tICogc2luKHRoZXRhKSwgLWhlaWdodCAqIDAuNSwgcmFkaXVzQm90dG9tICogY29zKHRoZXRhKSkpOwogICAgICAgICAgYm90dG9tZmFjZS5wdXNoKDIgKiBpICsgMik7IC8vIFRvcAoKICAgICAgICAgIHZlcnRpY2VzLnB1c2gobmV3IFZlYzMoLXJhZGl1c1RvcCAqIHNpbih0aGV0YSksIGhlaWdodCAqIDAuNSwgcmFkaXVzVG9wICogY29zKHRoZXRhKSkpOwogICAgICAgICAgdG9wZmFjZS5wdXNoKDIgKiBpICsgMyk7IC8vIEZhY2UKCiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAyICogaSArIDMsIDIgKiBpICsgMl0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAxLCAwXSk7IC8vIENvbm5lY3QKICAgICAgICB9IC8vIEF4aXM6IHdlIGNhbiBjdXQgb2ZmIGhhbGYgb2YgdGhlbSBpZiB3ZSBoYXZlIGV2ZW4gbnVtYmVyIG9mIHNlZ21lbnRzCgoKICAgICAgICBpZiAoTiAlIDIgPT09IDEgfHwgaSA8IE4gLyAyKSB7CiAgICAgICAgICBheGVzLnB1c2gobmV3IFZlYzMoLXNpbih0aGV0YU4pLCAwLCBjb3ModGhldGFOKSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZmFjZXMucHVzaChib3R0b21mYWNlKTsKICAgICAgYXhlcy5wdXNoKG5ldyBWZWMzKDAsIDEsIDApKTsgLy8gUmVvcmRlciB0b3AgZmFjZQoKICAgICAgY29uc3QgdGVtcCA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3BmYWNlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGVtcC5wdXNoKHRvcGZhY2VbdG9wZmFjZS5sZW5ndGggLSBpIC0gMV0pOwogICAgICB9CgogICAgICBmYWNlcy5wdXNoKHRlbXApOwogICAgICBzdXBlcih7CiAgICAgICAgdmVydGljZXMsCiAgICAgICAgZmFjZXMsCiAgICAgICAgYXhlcwogICAgICB9KTsKICAgICAgdGhpcy5yYWRpdXNUb3AgPSB2b2lkIDA7CiAgICAgIHRoaXMucmFkaXVzQm90dG9tID0gdm9pZCAwOwogICAgICB0aGlzLmhlaWdodCA9IHZvaWQgMDsKICAgICAgdGhpcy5udW1TZWdtZW50cyA9IHZvaWQgMDsKICAgICAgdGhpcy50eXBlID0gU2hhcGUudHlwZXMuQ1lMSU5ERVI7CiAgICAgIHRoaXMucmFkaXVzVG9wID0gcmFkaXVzVG9wOwogICAgICB0aGlzLnJhZGl1c0JvdHRvbSA9IHJhZGl1c0JvdHRvbTsKICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIHRoaXMubnVtU2VnbWVudHMgPSBudW1TZWdtZW50czsKICAgIH0KCiAgfQogIC8qKgogICAqIFBhcnRpY2xlIHNoYXBlLgogICAqIEBleGFtcGxlCiAgICogICAgIGNvbnN0IHBhcnRpY2xlU2hhcGUgPSBuZXcgQ0FOTk9OLlBhcnRpY2xlKCkKICAgKiAgICAgY29uc3QgcGFydGljbGVCb2R5ID0gbmV3IENBTk5PTi5Cb2R5KHsgbWFzczogMSwgc2hhcGU6IHBhcnRpY2xlU2hhcGUgfSkKICAgKiAgICAgd29ybGQuYWRkQm9keShwYXJ0aWNsZUJvZHkpCiAgICovCgoKICBjbGFzcyBQYXJ0aWNsZSBleHRlbmRzIFNoYXBlIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuUEFSVElDTEUKICAgICAgfSk7CiAgICB9CiAgICAvKioKICAgICAqIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYQogICAgICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHRhcmdldC5zZXQoMCwgMCwgMCk7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CgogICAgdm9sdW1lKCkgewogICAgICByZXR1cm4gMDsKICAgIH0KCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IDA7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgLy8gR2V0IGVhY2ggYXhpcyBtYXgKICAgICAgbWluLmNvcHkocG9zKTsKICAgICAgbWF4LmNvcHkocG9zKTsKICAgIH0KCiAgfQogIC8qKgogICAqIEEgcGxhbmUsIGZhY2luZyBpbiB0aGUgWiBkaXJlY3Rpb24uIFRoZSBwbGFuZSBoYXMgaXRzIHN1cmZhY2UgYXQgej0wIGFuZCBldmVyeXRoaW5nIGJlbG93IHo9MCBpcyBhc3N1bWVkIHRvIGJlIHNvbGlkIHBsYW5lLiBUbyBtYWtlIHRoZSBwbGFuZSBmYWNlIGluIHNvbWUgb3RoZXIgZGlyZWN0aW9uIHRoYW4geiwgeW91IG11c3QgcHV0IGl0IGluc2lkZSBhIEJvZHkgYW5kIHJvdGF0ZSB0aGF0IGJvZHkuIFNlZSB0aGUgZGVtb3MuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgcGxhbmVTaGFwZSA9IG5ldyBDQU5OT04uUGxhbmUoKQogICAqICAgICBjb25zdCBwbGFuZUJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoeyBtYXNzOiAwLCBzaGFwZTogIHBsYW5lU2hhcGUgfSkKICAgKiAgICAgcGxhbmVCb2R5LnF1YXRlcm5pb24uc2V0RnJvbUV1bGVyKC1NYXRoLlBJIC8gMiwgMCwgMCkgLy8gbWFrZSBpdCBmYWNlIHVwCiAgICogICAgIHdvcmxkLmFkZEJvZHkocGxhbmVCb2R5KQogICAqLwoKCiAgY2xhc3MgUGxhbmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKiogd29ybGROb3JtYWwgKi8KCiAgICAvKiogd29ybGROb3JtYWxOZWVkc1VwZGF0ZSAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5QTEFORQogICAgICB9KTsgLy8gV29ybGQgb3JpZW50ZWQgbm9ybWFsCgogICAgICB0aGlzLndvcmxkTm9ybWFsID0gdm9pZCAwOwogICAgICB0aGlzLndvcmxkTm9ybWFsTmVlZHNVcGRhdGUgPSB2b2lkIDA7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSB2b2lkIDA7CiAgICAgIHRoaXMud29ybGROb3JtYWwgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLndvcmxkTm9ybWFsTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIH0KICAgIC8qKiBjb21wdXRlV29ybGROb3JtYWwgKi8KCgogICAgY29tcHV0ZVdvcmxkTm9ybWFsKHF1YXQpIHsKICAgICAgY29uc3QgbiA9IHRoaXMud29ybGROb3JtYWw7CiAgICAgIG4uc2V0KDAsIDAsIDEpOwogICAgICBxdWF0LnZtdWx0KG4sIG4pOwogICAgICB0aGlzLndvcmxkTm9ybWFsTmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIH0KCiAgICBjYWxjdWxhdGVMb2NhbEluZXJ0aWEobWFzcywgdGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgcGxhbmUgaXMgaW5maW5pdGUuLi4KICAgICAgICBOdW1iZXIuTUFYX1ZBTFVFCiAgICAgICk7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgLy8gVGhlIHBsYW5lIEFBQkIgaXMgaW5maW5pdGUsIGV4Y2VwdCBpZiB0aGUgbm9ybWFsIGlzIHBvaW50aW5nIGFsb25nIGFueSBheGlzCiAgICAgIHRlbXBOb3JtYWwuc2V0KDAsIDAsIDEpOyAvLyBEZWZhdWx0IHBsYW5lIG5vcm1hbCBpcyB6CgogICAgICBxdWF0LnZtdWx0KHRlbXBOb3JtYWwsIHRlbXBOb3JtYWwpOwogICAgICBjb25zdCBtYXhWYWwgPSBOdW1iZXIuTUFYX1ZBTFVFOwogICAgICBtaW4uc2V0KC1tYXhWYWwsIC1tYXhWYWwsIC1tYXhWYWwpOwogICAgICBtYXguc2V0KG1heFZhbCwgbWF4VmFsLCBtYXhWYWwpOwoKICAgICAgaWYgKHRlbXBOb3JtYWwueCA9PT0gMSkgewogICAgICAgIG1heC54ID0gcG9zLng7CiAgICAgIH0gZWxzZSBpZiAodGVtcE5vcm1hbC54ID09PSAtMSkgewogICAgICAgIG1pbi54ID0gcG9zLng7CiAgICAgIH0KCiAgICAgIGlmICh0ZW1wTm9ybWFsLnkgPT09IDEpIHsKICAgICAgICBtYXgueSA9IHBvcy55OwogICAgICB9IGVsc2UgaWYgKHRlbXBOb3JtYWwueSA9PT0gLTEpIHsKICAgICAgICBtaW4ueSA9IHBvcy55OwogICAgICB9CgogICAgICBpZiAodGVtcE5vcm1hbC56ID09PSAxKSB7CiAgICAgICAgbWF4LnogPSBwb3MuejsKICAgICAgfSBlbHNlIGlmICh0ZW1wTm9ybWFsLnogPT09IC0xKSB7CiAgICAgICAgbWluLnogPSBwb3MuejsKICAgICAgfQogICAgfQoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIH0KCiAgfQoKICBjb25zdCB0ZW1wTm9ybWFsID0gbmV3IFZlYzMoKTsKICAvKioKICAgKiBIZWlnaHRmaWVsZCBzaGFwZSBjbGFzcy4gSGVpZ2h0IGRhdGEgaXMgZ2l2ZW4gYXMgYW4gYXJyYXkuIFRoZXNlIGRhdGEgcG9pbnRzIGFyZSBzcHJlYWQgb3V0IGV2ZW5seSB3aXRoIGEgZ2l2ZW4gZGlzdGFuY2UuCiAgICogQHRvZG8gU2hvdWxkIGJlIHBvc3NpYmxlIHRvIHVzZSBhbG9uZyBhbGwgYXhlcywgbm90IGp1c3QgeQogICAqIEB0b2RvIHNob3VsZCBiZSBwb3NzaWJsZSB0byBzY2FsZSBhbG9uZyBhbGwgYXhlcwogICAqIEB0b2RvIFJlZmFjdG9yIGVsZW1lbnRTaXplIHRvIGVsZW1lbnRTaXplWCBhbmQgZWxlbWVudFNpemVZCiAgICoKICAgKiBAZXhhbXBsZQogICAqICAgICAvLyBHZW5lcmF0ZSBzb21lIGhlaWdodCBkYXRhICh5LXZhbHVlcykuCiAgICogICAgIGNvbnN0IGRhdGEgPSBbXQogICAqICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDA7IGkrKykgewogICAqICAgICAgICAgY29uc3QgeSA9IDAuNSAqIE1hdGguY29zKDAuMiAqIGkpCiAgICogICAgICAgICBkYXRhLnB1c2goeSkKICAgKiAgICAgfQogICAqCiAgICogICAgIC8vIENyZWF0ZSB0aGUgaGVpZ2h0ZmllbGQgc2hhcGUKICAgKiAgICAgY29uc3QgaGVpZ2h0ZmllbGRTaGFwZSA9IG5ldyBDQU5OT04uSGVpZ2h0ZmllbGQoZGF0YSwgewogICAqICAgICAgICAgZWxlbWVudFNpemU6IDEgLy8gRGlzdGFuY2UgYmV0d2VlbiB0aGUgZGF0YSBwb2ludHMgaW4gWCBhbmQgWSBkaXJlY3Rpb25zCiAgICogICAgIH0pCiAgICogICAgIGNvbnN0IGhlaWdodGZpZWxkQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IHNoYXBlOiBoZWlnaHRmaWVsZFNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoaGVpZ2h0ZmllbGRCb2R5KQogICAqLwoKICBjbGFzcyBIZWlnaHRmaWVsZCBleHRlbmRzIFNoYXBlIHsKICAgIC8qKgogICAgICogQW4gYXJyYXkgb2YgbnVtYmVycywgb3IgaGVpZ2h0IHZhbHVlcywgdGhhdCBhcmUgc3ByZWFkIG91dCBhbG9uZyB0aGUgeCBheGlzLgogICAgICovCgogICAgLyoqCiAgICAgKiBNYXggdmFsdWUgb2YgdGhlIGRhdGEgcG9pbnRzIGluIHRoZSBkYXRhIGFycmF5LgogICAgICovCgogICAgLyoqCiAgICAgKiBNaW5pbXVtIHZhbHVlIG9mIHRoZSBkYXRhIHBvaW50cyBpbiB0aGUgZGF0YSBhcnJheS4KICAgICAqLwoKICAgIC8qKgogICAgICogV29ybGQgc3BhY2luZyBiZXR3ZWVuIHRoZSBkYXRhIHBvaW50cyBpbiBYIGFuZCBZIGRpcmVjdGlvbi4KICAgICAqIEB0b2RvIGVsZW1lbnRTaXplWCBhbmQgWQogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBAZGVmYXVsdCB0cnVlCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBwYXJhbSBkYXRhIEFuIGFycmF5IG9mIG51bWJlcnMsIG9yIGhlaWdodCB2YWx1ZXMsIHRoYXQgYXJlIHNwcmVhZCBvdXQgYWxvbmcgdGhlIHggYXhpcy4KICAgICAqLwogICAgY29uc3RydWN0b3IoZGF0YSwgb3B0aW9ucyA9IHt9KSB7CiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgbWF4VmFsdWU6IG51bGwsCiAgICAgICAgbWluVmFsdWU6IG51bGwsCiAgICAgICAgZWxlbWVudFNpemU6IDEKICAgICAgfSk7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5IRUlHSFRGSUVMRAogICAgICB9KTsKICAgICAgdGhpcy5kYXRhID0gdm9pZCAwOwogICAgICB0aGlzLm1heFZhbHVlID0gdm9pZCAwOwogICAgICB0aGlzLm1pblZhbHVlID0gdm9pZCAwOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gdm9pZCAwOwogICAgICB0aGlzLmNhY2hlRW5hYmxlZCA9IHZvaWQgMDsKICAgICAgdGhpcy5waWxsYXJDb252ZXggPSB2b2lkIDA7CiAgICAgIHRoaXMucGlsbGFyT2Zmc2V0ID0gdm9pZCAwOwogICAgICB0aGlzLl9jYWNoZWRQaWxsYXJzID0gdm9pZCAwOwogICAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgICB0aGlzLm1heFZhbHVlID0gb3B0aW9ucy5tYXhWYWx1ZTsKICAgICAgdGhpcy5taW5WYWx1ZSA9IG9wdGlvbnMubWluVmFsdWU7CiAgICAgIHRoaXMuZWxlbWVudFNpemUgPSBvcHRpb25zLmVsZW1lbnRTaXplOwoKICAgICAgaWYgKG9wdGlvbnMubWluVmFsdWUgPT09IG51bGwpIHsKICAgICAgICB0aGlzLnVwZGF0ZU1pblZhbHVlKCk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLm1heFZhbHVlID09PSBudWxsKSB7CiAgICAgICAgdGhpcy51cGRhdGVNYXhWYWx1ZSgpOwogICAgICB9CgogICAgICB0aGlzLmNhY2hlRW5hYmxlZCA9IHRydWU7CiAgICAgIHRoaXMucGlsbGFyQ29udmV4ID0gbmV3IENvbnZleFBvbHloZWRyb24oKTsKICAgICAgdGhpcy5waWxsYXJPZmZzZXQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7IC8vICJpX2pfaXNVcHBlciIgPT4geyBjb252ZXg6IC4uLiwgb2Zmc2V0OiAuLi4gfQogICAgICAvLyBmb3IgZXhhbXBsZToKICAgICAgLy8gX2NhY2hlZFBpbGxhcnNbIjBfMl8xIl0KCiAgICAgIHRoaXMuX2NhY2hlZFBpbGxhcnMgPSB7fTsKICAgIH0KICAgIC8qKgogICAgICogQ2FsbCB3aGVuZXZlciB5b3UgY2hhbmdlIHRoZSBkYXRhIGFycmF5LgogICAgICovCgoKICAgIHVwZGF0ZSgpIHsKICAgICAgdGhpcy5fY2FjaGVkUGlsbGFycyA9IHt9OwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGBtaW5WYWx1ZWAgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVNaW5WYWx1ZSgpIHsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgbGV0IG1pblZhbHVlID0gZGF0YVswXVswXTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBkYXRhLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IGRhdGFbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSBkYXRhW2ldW2pdOwoKICAgICAgICAgIGlmICh2IDwgbWluVmFsdWUpIHsKICAgICAgICAgICAgbWluVmFsdWUgPSB2OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5taW5WYWx1ZSA9IG1pblZhbHVlOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGBtYXhWYWx1ZWAgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVNYXhWYWx1ZSgpIHsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgbGV0IG1heFZhbHVlID0gZGF0YVswXVswXTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBkYXRhLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IGRhdGFbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSBkYXRhW2ldW2pdOwoKICAgICAgICAgIGlmICh2ID4gbWF4VmFsdWUpIHsKICAgICAgICAgICAgbWF4VmFsdWUgPSB2OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5tYXhWYWx1ZSA9IG1heFZhbHVlOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIGhlaWdodCB2YWx1ZSBhdCBhbiBpbmRleC4gRG9uJ3QgZm9yZ2V0IHRvIHVwZGF0ZSBtYXhWYWx1ZSBhbmQgbWluVmFsdWUgYWZ0ZXIgeW91J3JlIGRvbmUuCiAgICAgKi8KCgogICAgc2V0SGVpZ2h0VmFsdWVBdEluZGV4KHhpLCB5aSwgdmFsdWUpIHsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgZGF0YVt4aV1beWldID0gdmFsdWU7IC8vIEludmFsaWRhdGUgY2FjaGUKCiAgICAgIHRoaXMuY2xlYXJDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSwgeWksIGZhbHNlKTsKCiAgICAgIGlmICh4aSA+IDApIHsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGkgLSAxLCB5aSwgdHJ1ZSk7CiAgICAgICAgdGhpcy5jbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpIC0gMSwgeWksIGZhbHNlKTsKICAgICAgfQoKICAgICAgaWYgKHlpID4gMCkgewogICAgICAgIHRoaXMuY2xlYXJDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSwgeWkgLSAxLCB0cnVlKTsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpIC0gMSwgZmFsc2UpOwogICAgICB9CgogICAgICBpZiAoeWkgPiAwICYmIHhpID4gMCkgewogICAgICAgIHRoaXMuY2xlYXJDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSAtIDEsIHlpIC0gMSwgdHJ1ZSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogR2V0IG1heC9taW4gaW4gYSByZWN0YW5nbGUgaW4gdGhlIG1hdHJpeCBkYXRhCiAgICAgKiBAcGFyYW0gcmVzdWx0IEFuIGFycmF5IHRvIHN0b3JlIHRoZSByZXN1bHRzIGluLgogICAgICogQHJldHVybiBUaGUgcmVzdWx0IGFycmF5LCBpZiBpdCB3YXMgcGFzc2VkIGluLiBNaW5pbXVtIHdpbGwgYmUgYXQgcG9zaXRpb24gMCBhbmQgbWF4IGF0IDEuCiAgICAgKi8KCgogICAgZ2V0UmVjdE1pbk1heChpTWluWCwgaU1pblksIGlNYXhYLCBpTWF4WSwgcmVzdWx0ID0gW10pIHsKICAgICAgLy8gR2V0IG1heCBhbmQgbWluIG9mIHRoZSBkYXRhCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7IC8vIFNldCBmaXJzdCB2YWx1ZQoKICAgICAgbGV0IG1heCA9IHRoaXMubWluVmFsdWU7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPD0gaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8PSBpTWF4WTsgaisrKSB7CiAgICAgICAgICBjb25zdCBoZWlnaHQgPSBkYXRhW2ldW2pdOwoKICAgICAgICAgIGlmIChoZWlnaHQgPiBtYXgpIHsKICAgICAgICAgICAgbWF4ID0gaGVpZ2h0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmVzdWx0WzBdID0gdGhpcy5taW5WYWx1ZTsKICAgICAgcmVzdWx0WzFdID0gbWF4OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGluZGV4IG9mIGEgbG9jYWwgcG9zaXRpb24gb24gdGhlIGhlaWdodGZpZWxkLiBUaGUgaW5kZXhlcyBpbmRpY2F0ZSB0aGUgcmVjdGFuZ2xlcywgc28gaWYgeW91ciB0ZXJyYWluIGlzIG1hZGUgb2YgTiB4IE4gaGVpZ2h0IGRhdGEgcG9pbnRzLCB5b3Ugd2lsbCBoYXZlIHJlY3RhbmdsZSBpbmRleGVzIHJhbmdpbmcgZnJvbSAwIHRvIE4tMS4KICAgICAqIEBwYXJhbSByZXN1bHQgVHdvLWVsZW1lbnQgYXJyYXkKICAgICAqIEBwYXJhbSBjbGFtcCBJZiB0aGUgcG9zaXRpb24gc2hvdWxkIGJlIGNsYW1wZWQgdG8gdGhlIGhlaWdodGZpZWxkIGVkZ2UuCiAgICAgKi8KCgogICAgZ2V0SW5kZXhPZlBvc2l0aW9uKHgsIHksIHJlc3VsdCwgY2xhbXApIHsKICAgICAgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CiAgICAgIGNvbnN0IHcgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBsZXQgeGkgPSBNYXRoLmZsb29yKHggLyB3KTsKICAgICAgbGV0IHlpID0gTWF0aC5mbG9vcih5IC8gdyk7CiAgICAgIHJlc3VsdFswXSA9IHhpOwogICAgICByZXN1bHRbMV0gPSB5aTsKCiAgICAgIGlmIChjbGFtcCkgewogICAgICAgIC8vIENsYW1wIGluZGV4IHRvIGVkZ2VzCiAgICAgICAgaWYgKHhpIDwgMCkgewogICAgICAgICAgeGkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHlpIDwgMCkgewogICAgICAgICAgeWkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHhpID49IGRhdGEubGVuZ3RoIC0gMSkgewogICAgICAgICAgeGkgPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoeWkgPj0gZGF0YVswXS5sZW5ndGggLSAxKSB7CiAgICAgICAgICB5aSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgICB9CiAgICAgIH0gLy8gQmFpbCBvdXQgaWYgd2UgYXJlIG91dCBvZiB0aGUgdGVycmFpbgoKCiAgICAgIGlmICh4aSA8IDAgfHwgeWkgPCAwIHx8IHhpID49IGRhdGEubGVuZ3RoIC0gMSB8fCB5aSA+PSBkYXRhWzBdLmxlbmd0aCAtIDEpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGdldFRyaWFuZ2xlQXQoeCwgeSwgZWRnZUNsYW1wLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGlkeCA9IGdldEhlaWdodEF0X2lkeDsKICAgICAgdGhpcy5nZXRJbmRleE9mUG9zaXRpb24oeCwgeSwgaWR4LCBlZGdlQ2xhbXApOwogICAgICBsZXQgeGkgPSBpZHhbMF07CiAgICAgIGxldCB5aSA9IGlkeFsxXTsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKCiAgICAgIGlmIChlZGdlQ2xhbXApIHsKICAgICAgICB4aSA9IE1hdGgubWluKGRhdGEubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeGkpKTsKICAgICAgICB5aSA9IE1hdGgubWluKGRhdGFbMF0ubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeWkpKTsKICAgICAgfQoKICAgICAgY29uc3QgZWxlbWVudFNpemUgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBsb3dlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtIHhpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtIHlpKSAqKiAyOwogICAgICBjb25zdCB1cHBlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtICh4aSArIDEpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtICh5aSArIDEpKSAqKiAyOwogICAgICBjb25zdCB1cHBlciA9IGxvd2VyRGlzdDIgPiB1cHBlckRpc3QyOwogICAgICB0aGlzLmdldFRyaWFuZ2xlKHhpLCB5aSwgdXBwZXIsIGEsIGIsIGMpOwogICAgICByZXR1cm4gdXBwZXI7CiAgICB9CgogICAgZ2V0Tm9ybWFsQXQoeCwgeSwgZWRnZUNsYW1wLCByZXN1bHQpIHsKICAgICAgY29uc3QgYSA9IGdldE5vcm1hbEF0X2E7CiAgICAgIGNvbnN0IGIgPSBnZXROb3JtYWxBdF9iOwogICAgICBjb25zdCBjID0gZ2V0Tm9ybWFsQXRfYzsKICAgICAgY29uc3QgZTAgPSBnZXROb3JtYWxBdF9lMDsKICAgICAgY29uc3QgZTEgPSBnZXROb3JtYWxBdF9lMTsKICAgICAgdGhpcy5nZXRUcmlhbmdsZUF0KHgsIHksIGVkZ2VDbGFtcCwgYSwgYiwgYyk7CiAgICAgIGIudnN1YihhLCBlMCk7CiAgICAgIGMudnN1YihhLCBlMSk7CiAgICAgIGUwLmNyb3NzKGUxLCByZXN1bHQpOwogICAgICByZXN1bHQubm9ybWFsaXplKCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBBQUJCIG9mIGEgc3F1YXJlIGluIHRoZSBoZWlnaHRmaWVsZAogICAgICogQHBhcmFtIHhpCiAgICAgKiBAcGFyYW0geWkKICAgICAqIEBwYXJhbSByZXN1bHQKICAgICAqLwoKCiAgICBnZXRBYWJiQXRJbmRleCh4aSwgeWksIHsKICAgICAgbG93ZXJCb3VuZCwKICAgICAgdXBwZXJCb3VuZAogICAgfSkgewogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBlbGVtZW50U2l6ZSA9IHRoaXMuZWxlbWVudFNpemU7CiAgICAgIGxvd2VyQm91bmQuc2V0KHhpICogZWxlbWVudFNpemUsIHlpICogZWxlbWVudFNpemUsIGRhdGFbeGldW3lpXSk7CiAgICAgIHVwcGVyQm91bmQuc2V0KCh4aSArIDEpICogZWxlbWVudFNpemUsICh5aSArIDEpICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aSArIDFdKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBoZWlnaHQgaW4gdGhlIGhlaWdodGZpZWxkIGF0IGEgZ2l2ZW4gcG9zaXRpb24KICAgICAqLwoKCiAgICBnZXRIZWlnaHRBdCh4LCB5LCBlZGdlQ2xhbXApIHsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgY29uc3QgYSA9IGdldEhlaWdodEF0X2E7CiAgICAgIGNvbnN0IGIgPSBnZXRIZWlnaHRBdF9iOwogICAgICBjb25zdCBjID0gZ2V0SGVpZ2h0QXRfYzsKICAgICAgY29uc3QgaWR4ID0gZ2V0SGVpZ2h0QXRfaWR4OwogICAgICB0aGlzLmdldEluZGV4T2ZQb3NpdGlvbih4LCB5LCBpZHgsIGVkZ2VDbGFtcCk7CiAgICAgIGxldCB4aSA9IGlkeFswXTsKICAgICAgbGV0IHlpID0gaWR4WzFdOwoKICAgICAgaWYgKGVkZ2VDbGFtcCkgewogICAgICAgIHhpID0gTWF0aC5taW4oZGF0YS5sZW5ndGggLSAyLCBNYXRoLm1heCgwLCB4aSkpOwogICAgICAgIHlpID0gTWF0aC5taW4oZGF0YVswXS5sZW5ndGggLSAyLCBNYXRoLm1heCgwLCB5aSkpOwogICAgICB9CgogICAgICBjb25zdCB1cHBlciA9IHRoaXMuZ2V0VHJpYW5nbGVBdCh4LCB5LCBlZGdlQ2xhbXAsIGEsIGIsIGMpOwogICAgICBiYXJ5Y2VudHJpY1dlaWdodHMoeCwgeSwgYS54LCBhLnksIGIueCwgYi55LCBjLngsIGMueSwgZ2V0SGVpZ2h0QXRfd2VpZ2h0cyk7CiAgICAgIGNvbnN0IHcgPSBnZXRIZWlnaHRBdF93ZWlnaHRzOwoKICAgICAgaWYgKHVwcGVyKSB7CiAgICAgICAgLy8gVG9wIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgcmV0dXJuIGRhdGFbeGkgKyAxXVt5aSArIDFdICogdy54ICsgZGF0YVt4aV1beWkgKyAxXSAqIHcueSArIGRhdGFbeGkgKyAxXVt5aV0gKiB3Lno7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVG9wIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgcmV0dXJuIGRhdGFbeGldW3lpXSAqIHcueCArIGRhdGFbeGkgKyAxXVt5aV0gKiB3LnkgKyBkYXRhW3hpXVt5aSArIDFdICogdy56OwogICAgICB9CiAgICB9CgogICAgZ2V0Q2FjaGVDb252ZXhUcmlhbmdsZVBpbGxhcktleSh4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUpIHsKICAgICAgcmV0dXJuIHhpICsgIl8iICsgeWkgKyAiXyIgKyAoZ2V0VXBwZXJUcmlhbmdsZSA/IDEgOiAwKTsKICAgIH0KCiAgICBnZXRDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlZFBpbGxhcnNbdGhpcy5nZXRDYWNoZUNvbnZleFRyaWFuZ2xlUGlsbGFyS2V5KHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSldOwogICAgfQoKICAgIHNldENhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSwgY29udmV4LCBvZmZzZXQpIHsKICAgICAgdGhpcy5fY2FjaGVkUGlsbGFyc1t0aGlzLmdldENhY2hlQ29udmV4VHJpYW5nbGVQaWxsYXJLZXkoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKV0gPSB7CiAgICAgICAgY29udmV4LAogICAgICAgIG9mZnNldAogICAgICB9OwogICAgfQoKICAgIGNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgIGRlbGV0ZSB0aGlzLl9jYWNoZWRQaWxsYXJzW3RoaXMuZ2V0Q2FjaGVDb252ZXhUcmlhbmdsZVBpbGxhcktleSh4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUpXTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGEgdHJpYW5nbGUgZnJvbSB0aGUgaGVpZ2h0ZmllbGQKICAgICAqLwoKCiAgICBnZXRUcmlhbmdsZSh4aSwgeWksIHVwcGVyLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IGVsZW1lbnRTaXplID0gdGhpcy5lbGVtZW50U2l6ZTsKCiAgICAgIGlmICh1cHBlcikgewogICAgICAgIC8vIFRvcCB0cmlhbmdsZSB2ZXJ0cwogICAgICAgIGEuc2V0KCh4aSArIDEpICogZWxlbWVudFNpemUsICh5aSArIDEpICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aSArIDFdKTsKICAgICAgICBiLnNldCh4aSAqIGVsZW1lbnRTaXplLCAoeWkgKyAxKSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdKTsKICAgICAgICBjLnNldCgoeGkgKyAxKSAqIGVsZW1lbnRTaXplLCB5aSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpICsgMV1beWldKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICBhLnNldCh4aSAqIGVsZW1lbnRTaXplLCB5aSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aV0pOwogICAgICAgIGIuc2V0KCh4aSArIDEpICogZWxlbWVudFNpemUsIHlpICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aV0pOwogICAgICAgIGMuc2V0KHhpICogZWxlbWVudFNpemUsICh5aSArIDEpICogZWxlbWVudFNpemUsIGRhdGFbeGldW3lpICsgMV0pOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHRyaWFuZ2xlIGluIHRoZSB0ZXJyYWluIGluIHRoZSBmb3JtIG9mIGEgdHJpYW5ndWxhciBjb252ZXggc2hhcGUuCiAgICAgKi8KCgogICAgZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgIGxldCByZXN1bHQgPSB0aGlzLnBpbGxhckNvbnZleDsKICAgICAgbGV0IG9mZnNldFJlc3VsdCA9IHRoaXMucGlsbGFyT2Zmc2V0OwoKICAgICAgaWYgKHRoaXMuY2FjaGVFbmFibGVkKSB7CiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZ2V0Q2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKTsKCiAgICAgICAgaWYgKGRhdGEpIHsKICAgICAgICAgIHRoaXMucGlsbGFyQ29udmV4ID0gZGF0YS5jb252ZXg7CiAgICAgICAgICB0aGlzLnBpbGxhck9mZnNldCA9IGRhdGEub2Zmc2V0OwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgcmVzdWx0ID0gbmV3IENvbnZleFBvbHloZWRyb24oKTsKICAgICAgICBvZmZzZXRSZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICAgIHRoaXMucGlsbGFyQ29udmV4ID0gcmVzdWx0OwogICAgICAgIHRoaXMucGlsbGFyT2Zmc2V0ID0gb2Zmc2V0UmVzdWx0OwogICAgICB9CgogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBlbGVtZW50U2l6ZSA9IHRoaXMuZWxlbWVudFNpemU7CiAgICAgIGNvbnN0IGZhY2VzID0gcmVzdWx0LmZhY2VzOyAvLyBSZXVzZSB2ZXJ0cyBpZiBwb3NzaWJsZQoKICAgICAgcmVzdWx0LnZlcnRpY2VzLmxlbmd0aCA9IDY7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkrKykgewogICAgICAgIGlmICghcmVzdWx0LnZlcnRpY2VzW2ldKSB7CiAgICAgICAgICByZXN1bHQudmVydGljZXNbaV0gPSBuZXcgVmVjMygpOwogICAgICAgIH0KICAgICAgfSAvLyBSZXVzZSBmYWNlcyBpZiBwb3NzaWJsZQoKCiAgICAgIGZhY2VzLmxlbmd0aCA9IDU7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDU7IGkrKykgewogICAgICAgIGlmICghZmFjZXNbaV0pIHsKICAgICAgICAgIGZhY2VzW2ldID0gW107CiAgICAgICAgfQogICAgICB9CgogICAgICBjb25zdCB2ZXJ0cyA9IHJlc3VsdC52ZXJ0aWNlczsKICAgICAgY29uc3QgaCA9IChNYXRoLm1pbihkYXRhW3hpXVt5aV0sIGRhdGFbeGkgKyAxXVt5aV0sIGRhdGFbeGldW3lpICsgMV0sIGRhdGFbeGkgKyAxXVt5aSArIDFdKSAtIHRoaXMubWluVmFsdWUpIC8gMiArIHRoaXMubWluVmFsdWU7CgogICAgICBpZiAoIWdldFVwcGVyVHJpYW5nbGUpIHsKICAgICAgICAvLyBDZW50ZXIgb2YgdGhlIHRyaWFuZ2xlIHBpbGxhciAtIGFsbCBwb2x5Z29ucyBhcmUgZ2l2ZW4gcmVsYXRpdmUgdG8gdGhpcyBvbmUKICAgICAgICBvZmZzZXRSZXN1bHQuc2V0KCh4aSArIDAuMjUpICogZWxlbWVudFNpemUsIC8vIHNvcnQgb2YgY2VudGVyIG9mIGEgdHJpYW5nbGUKICAgICAgICAoeWkgKyAwLjI1KSAqIGVsZW1lbnRTaXplLCBoIC8vIHZlcnRpY2FsIGNlbnRlcgogICAgICAgICk7IC8vIFRvcCB0cmlhbmdsZSB2ZXJ0cwoKICAgICAgICB2ZXJ0c1swXS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWldIC0gaCk7CiAgICAgICAgdmVydHNbMV0uc2V0KDAuNzUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpXSAtIGgpOwogICAgICAgIHZlcnRzWzJdLnNldCgtMC4yNSAqIGVsZW1lbnRTaXplLCAwLjc1ICogZWxlbWVudFNpemUsIGRhdGFbeGldW3lpICsgMV0gLSBoKTsgLy8gYm90dG9tIHRyaWFuZ2xlIHZlcnRzCgogICAgICAgIHZlcnRzWzNdLnNldCgtMC4yNSAqIGVsZW1lbnRTaXplLCAtMC4yNSAqIGVsZW1lbnRTaXplLCAtTWF0aC5hYnMoaCkgLSAxKTsKICAgICAgICB2ZXJ0c1s0XS5zZXQoMC43NSAqIGVsZW1lbnRTaXplLCAtMC4yNSAqIGVsZW1lbnRTaXplLCAtTWF0aC5hYnMoaCkgLSAxKTsKICAgICAgICB2ZXJ0c1s1XS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgMC43NSAqIGVsZW1lbnRTaXplLCAtTWF0aC5hYnMoaCkgLSAxKTsgLy8gdG9wIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzBdWzBdID0gMDsKICAgICAgICBmYWNlc1swXVsxXSA9IDE7CiAgICAgICAgZmFjZXNbMF1bMl0gPSAyOyAvLyBib3R0b20gdHJpYW5nbGUKCiAgICAgICAgZmFjZXNbMV1bMF0gPSA1OwogICAgICAgIGZhY2VzWzFdWzFdID0gNDsKICAgICAgICBmYWNlc1sxXVsyXSA9IDM7IC8vIC14IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzJdWzBdID0gMDsKICAgICAgICBmYWNlc1syXVsxXSA9IDI7CiAgICAgICAgZmFjZXNbMl1bMl0gPSA1OwogICAgICAgIGZhY2VzWzJdWzNdID0gMzsgLy8gLXkgZmFjaW5nIHF1YWQKCiAgICAgICAgZmFjZXNbM11bMF0gPSAxOwogICAgICAgIGZhY2VzWzNdWzFdID0gMDsKICAgICAgICBmYWNlc1szXVsyXSA9IDM7CiAgICAgICAgZmFjZXNbM11bM10gPSA0OyAvLyAreHkgZmFjaW5nIHF1YWQKCiAgICAgICAgZmFjZXNbNF1bMF0gPSA0OwogICAgICAgIGZhY2VzWzRdWzFdID0gNTsKICAgICAgICBmYWNlc1s0XVsyXSA9IDI7CiAgICAgICAgZmFjZXNbNF1bM10gPSAxOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIENlbnRlciBvZiB0aGUgdHJpYW5nbGUgcGlsbGFyIC0gYWxsIHBvbHlnb25zIGFyZSBnaXZlbiByZWxhdGl2ZSB0byB0aGlzIG9uZQogICAgICAgIG9mZnNldFJlc3VsdC5zZXQoKHhpICsgMC43NSkgKiBlbGVtZW50U2l6ZSwgLy8gc29ydCBvZiBjZW50ZXIgb2YgYSB0cmlhbmdsZQogICAgICAgICh5aSArIDAuNzUpICogZWxlbWVudFNpemUsIGggLy8gdmVydGljYWwgY2VudGVyCiAgICAgICAgKTsgLy8gVG9wIHRyaWFuZ2xlIHZlcnRzCgogICAgICAgIHZlcnRzWzBdLnNldCgwLjI1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpICsgMV0gLSBoKTsKICAgICAgICB2ZXJ0c1sxXS5zZXQoLTAuNzUgKiBlbGVtZW50U2l6ZSwgMC4yNSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdIC0gaCk7CiAgICAgICAgdmVydHNbMl0uc2V0KDAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuNzUgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpXSAtIGgpOyAvLyBib3R0b20gdHJpYW5nbGUgdmVydHMKCiAgICAgICAgdmVydHNbM10uc2V0KDAuMjUgKiBlbGVtZW50U2l6ZSwgMC4yNSAqIGVsZW1lbnRTaXplLCAtTWF0aC5hYnMoaCkgLSAxKTsKICAgICAgICB2ZXJ0c1s0XS5zZXQoLTAuNzUgKiBlbGVtZW50U2l6ZSwgMC4yNSAqIGVsZW1lbnRTaXplLCAtTWF0aC5hYnMoaCkgLSAxKTsKICAgICAgICB2ZXJ0c1s1XS5zZXQoMC4yNSAqIGVsZW1lbnRTaXplLCAtMC43NSAqIGVsZW1lbnRTaXplLCAtTWF0aC5hYnMoaCkgLSAxKTsgLy8gVG9wIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzBdWzBdID0gMDsKICAgICAgICBmYWNlc1swXVsxXSA9IDE7CiAgICAgICAgZmFjZXNbMF1bMl0gPSAyOyAvLyBib3R0b20gdHJpYW5nbGUKCiAgICAgICAgZmFjZXNbMV1bMF0gPSA1OwogICAgICAgIGZhY2VzWzFdWzFdID0gNDsKICAgICAgICBmYWNlc1sxXVsyXSA9IDM7IC8vICt4IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzJdWzBdID0gMjsKICAgICAgICBmYWNlc1syXVsxXSA9IDU7CiAgICAgICAgZmFjZXNbMl1bMl0gPSAzOwogICAgICAgIGZhY2VzWzJdWzNdID0gMDsgLy8gK3kgZmFjaW5nIHF1YWQKCiAgICAgICAgZmFjZXNbM11bMF0gPSAzOwogICAgICAgIGZhY2VzWzNdWzFdID0gNDsKICAgICAgICBmYWNlc1szXVsyXSA9IDE7CiAgICAgICAgZmFjZXNbM11bM10gPSAwOyAvLyAteHkgZmFjaW5nIHF1YWQKCiAgICAgICAgZmFjZXNbNF1bMF0gPSAxOwogICAgICAgIGZhY2VzWzRdWzFdID0gNDsKICAgICAgICBmYWNlc1s0XVsyXSA9IDU7CiAgICAgICAgZmFjZXNbNF1bM10gPSAyOwogICAgICB9CgogICAgICByZXN1bHQuY29tcHV0ZU5vcm1hbHMoKTsKICAgICAgcmVzdWx0LmNvbXB1dGVFZGdlcygpOwogICAgICByZXN1bHQudXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKTsKICAgICAgdGhpcy5zZXRDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUsIHJlc3VsdCwgb2Zmc2V0UmVzdWx0KTsKICAgIH0KCiAgICBjYWxjdWxhdGVMb2NhbEluZXJ0aWEobWFzcywgdGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICB0YXJnZXQuc2V0KDAsIDAsIDApOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgdGVycmFpbiBpcyBpbmZpbml0ZQogICAgICAgIE51bWJlci5NQVhfVkFMVUUKICAgICAgKTsKICAgIH0KCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKiogQFRPRE8gZG8gaXQgcHJvcGVybHkgKi8KICAgICAgbWluLnNldCgtTnVtYmVyLk1BWF9WQUxVRSwgLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgbWF4LnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgIH0KCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgLy8gVXNlIHRoZSBib3VuZGluZyBib3ggb2YgdGhlIG1pbi9tYXggdmFsdWVzCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IHMgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gbmV3IFZlYzMoZGF0YS5sZW5ndGggKiBzLCBkYXRhWzBdLmxlbmd0aCAqIHMsIE1hdGgubWF4KE1hdGguYWJzKHRoaXMubWF4VmFsdWUpLCBNYXRoLmFicyh0aGlzLm1pblZhbHVlKSkpLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBoZWlnaHQgdmFsdWVzIGZyb20gYW4gaW1hZ2UuIEN1cnJlbnRseSBvbmx5IHN1cHBvcnRlZCBpbiBicm93c2VyLgogICAgICovCgoKICAgIHNldEhlaWdodHNGcm9tSW1hZ2UoaW1hZ2UsIHNjYWxlKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICB4LAogICAgICAgIHosCiAgICAgICAgeQogICAgICB9ID0gc2NhbGU7CiAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICBjYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDsKICAgICAgY2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDsKICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7CiAgICAgIGNvbnN0IGltYWdlRGF0YSA9IGNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQpOwogICAgICBjb25zdCBtYXRyaXggPSB0aGlzLmRhdGE7CiAgICAgIG1hdHJpeC5sZW5ndGggPSAwOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gTWF0aC5hYnMoeCkgLyBpbWFnZURhdGEud2lkdGg7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGltYWdlRGF0YS5oZWlnaHQ7IGkrKykgewogICAgICAgIGNvbnN0IHJvdyA9IFtdOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGltYWdlRGF0YS53aWR0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCBhID0gaW1hZ2VEYXRhLmRhdGFbKGkgKiBpbWFnZURhdGEuaGVpZ2h0ICsgaikgKiA0XTsKICAgICAgICAgIGNvbnN0IGIgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAxXTsKICAgICAgICAgIGNvbnN0IGMgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAyXTsKICAgICAgICAgIGNvbnN0IGhlaWdodCA9IChhICsgYiArIGMpIC8gNCAvIDI1NSAqIHo7CgogICAgICAgICAgaWYgKHggPCAwKSB7CiAgICAgICAgICAgIHJvdy5wdXNoKGhlaWdodCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByb3cudW5zaGlmdChoZWlnaHQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCAwKSB7CiAgICAgICAgICBtYXRyaXgudW5zaGlmdChyb3cpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBtYXRyaXgucHVzaChyb3cpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVNYXhWYWx1ZSgpOwogICAgICB0aGlzLnVwZGF0ZU1pblZhbHVlKCk7CiAgICAgIHRoaXMudXBkYXRlKCk7CiAgICB9CgogIH0KCiAgY29uc3QgZ2V0SGVpZ2h0QXRfaWR4ID0gW107CiAgY29uc3QgZ2V0SGVpZ2h0QXRfd2VpZ2h0cyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0SGVpZ2h0QXRfYSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0SGVpZ2h0QXRfYiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0SGVpZ2h0QXRfYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0Tm9ybWFsQXRfYSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0Tm9ybWFsQXRfYiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0Tm9ybWFsQXRfYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0Tm9ybWFsQXRfZTAgPSBuZXcgVmVjMygpOwogIGNvbnN0IGdldE5vcm1hbEF0X2UxID0gbmV3IFZlYzMoKTsgLy8gZnJvbSBodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9CYXJ5Y2VudHJpY19jb29yZGluYXRlX3N5c3RlbQoKICBmdW5jdGlvbiBiYXJ5Y2VudHJpY1dlaWdodHMoeCwgeSwgYXgsIGF5LCBieCwgYnksIGN4LCBjeSwgcmVzdWx0KSB7CiAgICByZXN1bHQueCA9ICgoYnkgLSBjeSkgKiAoeCAtIGN4KSArIChjeCAtIGJ4KSAqICh5IC0gY3kpKSAvICgoYnkgLSBjeSkgKiAoYXggLSBjeCkgKyAoY3ggLSBieCkgKiAoYXkgLSBjeSkpOwogICAgcmVzdWx0LnkgPSAoKGN5IC0gYXkpICogKHggLSBjeCkgKyAoYXggLSBjeCkgKiAoeSAtIGN5KSkgLyAoKGJ5IC0gY3kpICogKGF4IC0gY3gpICsgKGN4IC0gYngpICogKGF5IC0gY3kpKTsKICAgIHJlc3VsdC56ID0gMSAtIHJlc3VsdC54IC0gcmVzdWx0Lnk7CiAgfQogIC8qKgogICAqIE9jdHJlZU5vZGUKICAgKi8KCgogIGNsYXNzIE9jdHJlZU5vZGUgewogICAgLyoqIFRoZSByb290IG5vZGUgKi8KCiAgICAvKiogQm91bmRhcnkgb2YgdGhpcyBub2RlICovCgogICAgLyoqIENvbnRhaW5lZCBkYXRhIGF0IHRoZSBjdXJyZW50IG5vZGUgbGV2ZWwgKi8KCiAgICAvKiogQ2hpbGRyZW4gdG8gdGhpcyBub2RlICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHsKICAgICAgdGhpcy5yb290ID0gdm9pZCAwOwogICAgICB0aGlzLmFhYmIgPSB2b2lkIDA7CiAgICAgIHRoaXMuZGF0YSA9IHZvaWQgMDsKICAgICAgdGhpcy5jaGlsZHJlbiA9IHZvaWQgMDsKICAgICAgdGhpcy5yb290ID0gb3B0aW9ucy5yb290IHx8IG51bGw7CiAgICAgIHRoaXMuYWFiYiA9IG9wdGlvbnMuYWFiYiA/IG9wdGlvbnMuYWFiYi5jbG9uZSgpIDogbmV3IEFBQkIoKTsKICAgICAgdGhpcy5kYXRhID0gW107CiAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTsKICAgIH0KICAgIC8qKgogICAgICogcmVzZXQKICAgICAqLwoKCiAgICByZXNldCgpIHsKICAgICAgdGhpcy5jaGlsZHJlbi5sZW5ndGggPSB0aGlzLmRhdGEubGVuZ3RoID0gMDsKICAgIH0KICAgIC8qKgogICAgICogSW5zZXJ0IGRhdGEgaW50byB0aGlzIG5vZGUKICAgICAqIEByZXR1cm4gVHJ1ZSBpZiBzdWNjZXNzZnVsLCBvdGhlcndpc2UgZmFsc2UKICAgICAqLwoKCiAgICBpbnNlcnQoYWFiYiwgZWxlbWVudERhdGEsIGxldmVsID0gMCkgewogICAgICBjb25zdCBub2RlRGF0YSA9IHRoaXMuZGF0YTsgLy8gSWdub3JlIG9iamVjdHMgdGhhdCBkbyBub3QgYmVsb25nIGluIHRoaXMgbm9kZQoKICAgICAgaWYgKCF0aGlzLmFhYmIuY29udGFpbnMoYWFiYikpIHsKICAgICAgICByZXR1cm4gZmFsc2U7IC8vIG9iamVjdCBjYW5ub3QgYmUgYWRkZWQKICAgICAgfQoKICAgICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuOwogICAgICBjb25zdCBtYXhEZXB0aCA9IHRoaXMubWF4RGVwdGggfHwgdGhpcy5yb290Lm1heERlcHRoOwoKICAgICAgaWYgKGxldmVsIDwgbWF4RGVwdGgpIHsKICAgICAgICAvLyBTdWJkaXZpZGUgaWYgdGhlcmUgYXJlIG5vIGNoaWxkcmVuIHlldAogICAgICAgIGxldCBzdWJkaXZpZGVkID0gZmFsc2U7CgogICAgICAgIGlmICghY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLnN1YmRpdmlkZSgpOwogICAgICAgICAgc3ViZGl2aWRlZCA9IHRydWU7CiAgICAgICAgfSAvLyBhZGQgdG8gd2hpY2hldmVyIG5vZGUgd2lsbCBhY2NlcHQgaXQKCgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSA4OyBpKyspIHsKICAgICAgICAgIGlmIChjaGlsZHJlbltpXS5pbnNlcnQoYWFiYiwgZWxlbWVudERhdGEsIGxldmVsICsgMSkpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoc3ViZGl2aWRlZCkgewogICAgICAgICAgLy8gTm8gY2hpbGRyZW4gYWNjZXB0ZWQhIE1pZ2h0IGFzIHdlbGwganVzdCByZW1vdmUgZW0gc2luY2UgdGhleSBjb250YWluIG5vbmUKICAgICAgICAgIGNoaWxkcmVuLmxlbmd0aCA9IDA7CiAgICAgICAgfQogICAgICB9IC8vIFRvbyBkZWVwLCBvciBjaGlsZHJlbiBkaWRudCB3YW50IGl0LiBhZGQgaXQgaW4gY3VycmVudCBub2RlCgoKICAgICAgbm9kZURhdGEucHVzaChlbGVtZW50RGF0YSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBDcmVhdGUgOCBlcXVhbGx5IHNpemVkIGNoaWxkcmVuIG5vZGVzIGFuZCBwdXQgdGhlbSBpbiB0aGUgYGNoaWxkcmVuYCBhcnJheS4KICAgICAqLwoKCiAgICBzdWJkaXZpZGUoKSB7CiAgICAgIGNvbnN0IGFhYmIgPSB0aGlzLmFhYmI7CiAgICAgIGNvbnN0IGwgPSBhYWJiLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUgPSBhYWJiLnVwcGVyQm91bmQ7CiAgICAgIGNvbnN0IGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjsKICAgICAgY2hpbGRyZW4ucHVzaChuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMCwgMCwgMCkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDEsIDAsIDApCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygxLCAxLCAwKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMSwgMSwgMSkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDAsIDEsIDEpCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygwLCAwLCAxKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMSwgMCwgMSkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDAsIDEsIDApCiAgICAgICAgfSkKICAgICAgfSkpOwogICAgICB1LnZzdWIobCwgaGFsZkRpYWdvbmFsKTsKICAgICAgaGFsZkRpYWdvbmFsLnNjYWxlKDAuNSwgaGFsZkRpYWdvbmFsKTsKICAgICAgY29uc3Qgcm9vdCA9IHRoaXMucm9vdCB8fCB0aGlzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baV07IC8vIFNldCBjdXJyZW50IG5vZGUgYXMgcm9vdAoKICAgICAgICBjaGlsZC5yb290ID0gcm9vdDsgLy8gQ29tcHV0ZSBib3VuZHMKCiAgICAgICAgY29uc3QgbG93ZXJCb3VuZCA9IGNoaWxkLmFhYmIubG93ZXJCb3VuZDsKICAgICAgICBsb3dlckJvdW5kLnggKj0gaGFsZkRpYWdvbmFsLng7CiAgICAgICAgbG93ZXJCb3VuZC55ICo9IGhhbGZEaWFnb25hbC55OwogICAgICAgIGxvd2VyQm91bmQueiAqPSBoYWxmRGlhZ29uYWwuejsKICAgICAgICBsb3dlckJvdW5kLnZhZGQobCwgbG93ZXJCb3VuZCk7IC8vIFVwcGVyIGJvdW5kIGlzIGFsd2F5cyBsb3dlciBib3VuZCArIGhhbGZEaWFnb25hbAoKICAgICAgICBsb3dlckJvdW5kLnZhZGQoaGFsZkRpYWdvbmFsLCBjaGlsZC5hYWJiLnVwcGVyQm91bmQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbGwgZGF0YSwgcG90ZW50aWFsbHkgd2l0aGluIGFuIEFBQkIKICAgICAqIEByZXR1cm4gVGhlICJyZXN1bHQiIG9iamVjdAogICAgICovCgoKICAgIGFhYmJRdWVyeShhYWJiLCByZXN1bHQpIHsKICAgICAgdGhpcy5kYXRhOyAvLyBhYm9ydCBpZiB0aGUgcmFuZ2UgZG9lcyBub3QgaW50ZXJzZWN0IHRoaXMgbm9kZQogICAgICAvLyBpZiAoIXRoaXMuYWFiYi5vdmVybGFwcyhhYWJiKSl7CiAgICAgIC8vICAgICByZXR1cm4gcmVzdWx0OwogICAgICAvLyB9CiAgICAgIC8vIEFkZCBvYmplY3RzIGF0IHRoaXMgbGV2ZWwKICAgICAgLy8gQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkocmVzdWx0LCBub2RlRGF0YSk7CiAgICAgIC8vIEFkZCBjaGlsZCBkYXRhCiAgICAgIC8vIEB0b2RvIHVud3JhcCByZWN1cnNpb24gaW50byBhIHF1ZXVlIC8gbG9vcCwgdGhhdCdzIGZhc3RlciBpbiBKUwoKICAgICAgdGhpcy5jaGlsZHJlbjsgLy8gZm9yIChsZXQgaSA9IDAsIE4gPSB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgIC8vICAgICBjaGlsZHJlbltpXS5hYWJiUXVlcnkoYWFiYiwgcmVzdWx0KTsKICAgICAgLy8gfQoKICAgICAgY29uc3QgcXVldWUgPSBbdGhpc107CgogICAgICB3aGlsZSAocXVldWUubGVuZ3RoKSB7CiAgICAgICAgY29uc3Qgbm9kZSA9IHF1ZXVlLnBvcCgpOwoKICAgICAgICBpZiAobm9kZS5hYWJiLm92ZXJsYXBzKGFhYmIpKSB7CiAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShyZXN1bHQsIG5vZGUuZGF0YSk7CiAgICAgICAgfQoKICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShxdWV1ZSwgbm9kZS5jaGlsZHJlbik7CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbGwgZGF0YSwgcG90ZW50aWFsbHkgaW50ZXJzZWN0ZWQgYnkgYSByYXkuCiAgICAgKiBAcmV0dXJuIFRoZSAicmVzdWx0IiBvYmplY3QKICAgICAqLwoKCiAgICByYXlRdWVyeShyYXksIHRyZWVUcmFuc2Zvcm0sIHJlc3VsdCkgewogICAgICAvLyBVc2UgYWFiYiBxdWVyeSBmb3Igbm93LgoKICAgICAgLyoqIEB0b2RvIGltcGxlbWVudCByZWFsIHJheSBxdWVyeSB3aGljaCBuZWVkcyBsZXNzIGxvb2t1cHMgKi8KICAgICAgcmF5LmdldEFBQkIodG1wQUFCQik7CiAgICAgIHRtcEFBQkIudG9Mb2NhbEZyYW1lKHRyZWVUcmFuc2Zvcm0sIHRtcEFBQkIpOwogICAgICB0aGlzLmFhYmJRdWVyeSh0bXBBQUJCLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiByZW1vdmVFbXB0eU5vZGVzCiAgICAgKi8KCgogICAgcmVtb3ZlRW1wdHlOb2RlcygpIHsKICAgICAgZm9yIChsZXQgaSA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICB0aGlzLmNoaWxkcmVuW2ldLnJlbW92ZUVtcHR5Tm9kZXMoKTsKCiAgICAgICAgaWYgKCF0aGlzLmNoaWxkcmVuW2ldLmNoaWxkcmVuLmxlbmd0aCAmJiAhdGhpcy5jaGlsZHJlbltpXS5kYXRhLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaSwgMSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogIH0KICAvKioKICAgKiBPY3RyZWUKICAgKi8KCgogIGNsYXNzIE9jdHJlZSBleHRlbmRzIE9jdHJlZU5vZGUgewogICAgLyoqCiAgICAgKiBNYXhpbXVtIHN1YmRpdmlzaW9uIGRlcHRoCiAgICAgKiBAZGVmYXVsdCA4CiAgICAgKi8KCiAgICAvKioKICAgICAqIEBwYXJhbSBhYWJiIFRoZSB0b3RhbCBBQUJCIG9mIHRoZSB0cmVlCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGFhYmIsIG9wdGlvbnMgPSB7fSkgewogICAgICBzdXBlcih7CiAgICAgICAgcm9vdDogbnVsbCwKICAgICAgICBhYWJiCiAgICAgIH0pOwogICAgICB0aGlzLm1heERlcHRoID0gdm9pZCAwOwogICAgICB0aGlzLm1heERlcHRoID0gdHlwZW9mIG9wdGlvbnMubWF4RGVwdGggIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhEZXB0aCA6IDg7CiAgICB9CgogIH0KCiAgY29uc3QgaGFsZkRpYWdvbmFsID0gbmV3IFZlYzMoKTsKICBjb25zdCB0bXBBQUJCID0gbmV3IEFBQkIoKTsKICAvKioKICAgKiBUcmltZXNoLgogICAqIEBleGFtcGxlCiAgICogICAgIC8vIEhvdyB0byBtYWtlIGEgbWVzaCB3aXRoIGEgc2luZ2xlIHRyaWFuZ2xlCiAgICogICAgIGNvbnN0IHZlcnRpY2VzID0gWwogICAqICAgICAgICAgMCwgMCwgMCwgLy8gdmVydGV4IDAKICAgKiAgICAgICAgIDEsIDAsIDAsIC8vIHZlcnRleCAxCiAgICogICAgICAgICAwLCAxLCAwICAvLyB2ZXJ0ZXggMgogICAqICAgICBdCiAgICogICAgIGNvbnN0IGluZGljZXMgPSBbCiAgICogICAgICAgICAwLCAxLCAyICAvLyB0cmlhbmdsZSAwCiAgICogICAgIF0KICAgKiAgICAgY29uc3QgdHJpbWVzaFNoYXBlID0gbmV3IENBTk5PTi5UcmltZXNoKHZlcnRpY2VzLCBpbmRpY2VzKQogICAqLwoKICBjbGFzcyBUcmltZXNoIGV4dGVuZHMgU2hhcGUgewogICAgLyoqCiAgICAgKiB2ZXJ0aWNlcwogICAgICovCgogICAgLyoqCiAgICAgKiBBcnJheSBvZiBpbnRlZ2VycywgaW5kaWNhdGluZyB3aGljaCB2ZXJ0aWNlcyBlYWNoIHRyaWFuZ2xlIGNvbnNpc3RzIG9mLiBUaGUgbGVuZ3RoIG9mIHRoaXMgYXJyYXkgaXMgdGh1cyAzIHRpbWVzIHRoZSBudW1iZXIgb2YgdHJpYW5nbGVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgbm9ybWFscyBkYXRhLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgbG9jYWwgQUFCQiBvZiB0aGUgbWVzaC4KICAgICAqLwoKICAgIC8qKgogICAgICogUmVmZXJlbmNlcyB0byB2ZXJ0ZXggcGFpcnMsIG1ha2luZyB1cCBhbGwgdW5pcXVlIGVkZ2VzIGluIHRoZSB0cmltZXNoLgogICAgICovCgogICAgLyoqCiAgICAgKiBMb2NhbCBzY2FsaW5nIG9mIHRoZSBtZXNoLiBVc2UgLnNldFNjYWxlKCkgdG8gc2V0IGl0LgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgaW5kZXhlZCB0cmlhbmdsZXMuIFVzZSAudXBkYXRlVHJlZSgpIHRvIHVwZGF0ZSBpdC4KICAgICAqLwogICAgY29uc3RydWN0b3IodmVydGljZXMsIGluZGljZXMpIHsKICAgICAgc3VwZXIoewogICAgICAgIHR5cGU6IFNoYXBlLnR5cGVzLlRSSU1FU0gKICAgICAgfSk7CiAgICAgIHRoaXMudmVydGljZXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuaW5kaWNlcyA9IHZvaWQgMDsKICAgICAgdGhpcy5ub3JtYWxzID0gdm9pZCAwOwogICAgICB0aGlzLmFhYmIgPSB2b2lkIDA7CiAgICAgIHRoaXMuZWRnZXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2NhbGUgPSB2b2lkIDA7CiAgICAgIHRoaXMudHJlZSA9IHZvaWQgMDsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkodmVydGljZXMpOwogICAgICB0aGlzLmluZGljZXMgPSBuZXcgSW50MTZBcnJheShpbmRpY2VzKTsKICAgICAgdGhpcy5ub3JtYWxzID0gbmV3IEZsb2F0MzJBcnJheShpbmRpY2VzLmxlbmd0aCk7CiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuZWRnZXMgPSBudWxsOwogICAgICB0aGlzLnNjYWxlID0gbmV3IFZlYzMoMSwgMSwgMSk7CiAgICAgIHRoaXMudHJlZSA9IG5ldyBPY3RyZWUoKTsKICAgICAgdGhpcy51cGRhdGVFZGdlcygpOwogICAgICB0aGlzLnVwZGF0ZU5vcm1hbHMoKTsKICAgICAgdGhpcy51cGRhdGVBQUJCKCk7CiAgICAgIHRoaXMudXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKTsKICAgICAgdGhpcy51cGRhdGVUcmVlKCk7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZVRyZWUKICAgICAqLwoKCiAgICB1cGRhdGVUcmVlKCkgewogICAgICBjb25zdCB0cmVlID0gdGhpcy50cmVlOwogICAgICB0cmVlLnJlc2V0KCk7CiAgICAgIHRyZWUuYWFiYi5jb3B5KHRoaXMuYWFiYik7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsgLy8gVGhlIGxvY2FsIG1lc2ggQUFCQiBpcyBzY2FsZWQsIGJ1dCB0aGUgb2N0cmVlIEFBQkIgc2hvdWxkIGJlIHVuc2NhbGVkCgogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OyAvLyBJbnNlcnQgYWxsIHRyaWFuZ2xlcwoKICAgICAgY29uc3QgdHJpYW5nbGVBQUJCID0gbmV3IEFBQkIoKTsKICAgICAgY29uc3QgYSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGIgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBjID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcG9pbnRzID0gW2EsIGIsIGNdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy90aGlzLmdldFRyaWFuZ2xlVmVydGljZXMoaSwgYSwgYiwgYyk7CiAgICAgICAgLy8gR2V0IHVuc2NhbGVkIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzXSwgYSk7CgogICAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDFdLCBiKTsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzICsgMl0sIGMpOwoKICAgICAgICB0cmlhbmdsZUFBQkIuc2V0RnJvbVBvaW50cyhwb2ludHMpOwogICAgICAgIHRyZWUuaW5zZXJ0KHRyaWFuZ2xlQUFCQiwgaSk7CiAgICAgIH0KCiAgICAgIHRyZWUucmVtb3ZlRW1wdHlOb2RlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdHJpYW5nbGVzIGluIGEgbG9jYWwgQUFCQiBmcm9tIHRoZSB0cmltZXNoLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSBvZiBpbnRlZ2VycywgcmVmZXJlbmNpbmcgdGhlIHF1ZXJpZWQgdHJpYW5nbGVzLgogICAgICovCgoKICAgIGdldFRyaWFuZ2xlc0luQUFCQihhYWJiLCByZXN1bHQpIHsKICAgICAgdW5zY2FsZWRBQUJCLmNvcHkoYWFiYik7IC8vIFNjYWxlIGl0IHRvIGxvY2FsCgogICAgICBjb25zdCBzY2FsZSA9IHRoaXMuc2NhbGU7CiAgICAgIGNvbnN0IGlzeCA9IHNjYWxlLng7CiAgICAgIGNvbnN0IGlzeSA9IHNjYWxlLnk7CiAgICAgIGNvbnN0IGlzeiA9IHNjYWxlLno7CiAgICAgIGNvbnN0IGwgPSB1bnNjYWxlZEFBQkIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IHVuc2NhbGVkQUFCQi51cHBlckJvdW5kOwogICAgICBsLnggLz0gaXN4OwogICAgICBsLnkgLz0gaXN5OwogICAgICBsLnogLz0gaXN6OwogICAgICB1LnggLz0gaXN4OwogICAgICB1LnkgLz0gaXN5OwogICAgICB1LnogLz0gaXN6OwogICAgICByZXR1cm4gdGhpcy50cmVlLmFhYmJRdWVyeSh1bnNjYWxlZEFBQkIsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIHNldFNjYWxlCiAgICAgKi8KCgogICAgc2V0U2NhbGUoc2NhbGUpIHsKICAgICAgY29uc3Qgd2FzVW5pZm9ybSA9IHRoaXMuc2NhbGUueCA9PT0gdGhpcy5zY2FsZS55ICYmIHRoaXMuc2NhbGUueSA9PT0gdGhpcy5zY2FsZS56OwogICAgICBjb25zdCBpc1VuaWZvcm0gPSBzY2FsZS54ID09PSBzY2FsZS55ICYmIHNjYWxlLnkgPT09IHNjYWxlLno7CgogICAgICBpZiAoISh3YXNVbmlmb3JtICYmIGlzVW5pZm9ybSkpIHsKICAgICAgICAvLyBOb24tdW5pZm9ybSBzY2FsaW5nLiBOZWVkIHRvIHVwZGF0ZSBub3JtYWxzLgogICAgICAgIHRoaXMudXBkYXRlTm9ybWFscygpOwogICAgICB9CgogICAgICB0aGlzLnNjYWxlLmNvcHkoc2NhbGUpOwogICAgICB0aGlzLnVwZGF0ZUFBQkIoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlIHRoZSBub3JtYWxzIG9mIHRoZSBmYWNlcy4gV2lsbCBzYXZlIGluIHRoZSBgLm5vcm1hbHNgIGFycmF5LgogICAgICovCgoKICAgIHVwZGF0ZU5vcm1hbHMoKSB7CiAgICAgIGNvbnN0IG4gPSBjb21wdXRlTm9ybWFsc19uOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBjb25zdCBub3JtYWxzID0gdGhpcy5ub3JtYWxzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIHRoaXMuZ2V0VmVydGV4KGEsIHZhKTsKICAgICAgICB0aGlzLmdldFZlcnRleChiLCB2Yik7CiAgICAgICAgdGhpcy5nZXRWZXJ0ZXgoYywgdmMpOwogICAgICAgIFRyaW1lc2guY29tcHV0ZU5vcm1hbCh2YiwgdmEsIHZjLCBuKTsKICAgICAgICBub3JtYWxzW2kzXSA9IG4ueDsKICAgICAgICBub3JtYWxzW2kzICsgMV0gPSBuLnk7CiAgICAgICAgbm9ybWFsc1tpMyArIDJdID0gbi56OwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgYC5lZGdlc2AgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVFZGdlcygpIHsKICAgICAgY29uc3QgZWRnZXMgPSB7fTsKCiAgICAgIGNvbnN0IGFkZCA9IChhLCBiKSA9PiB7CiAgICAgICAgY29uc3Qga2V5ID0gYSA8IGIgPyBhICsgIl8iICsgYiA6IGIgKyAiXyIgKyBhOwogICAgICAgIGVkZ2VzW2tleV0gPSB0cnVlOwogICAgICB9OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIGFkZChhLCBiKTsKICAgICAgICBhZGQoYiwgYyk7CiAgICAgICAgYWRkKGMsIGEpOwogICAgICB9CgogICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoZWRnZXMpOwogICAgICB0aGlzLmVkZ2VzID0gbmV3IEludDE2QXJyYXkoa2V5cy5sZW5ndGggKiAyKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGluZGljZXMgPSBrZXlzW2ldLnNwbGl0KCdfJyk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaV0gPSBwYXJzZUludChpbmRpY2VzWzBdLCAxMCk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaSArIDFdID0gcGFyc2VJbnQoaW5kaWNlc1sxXSwgMTApOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlZGdlIHZlcnRleAogICAgICogQHBhcmFtIGZpcnN0T3JTZWNvbmQgMCBvciAxLCBkZXBlbmRpbmcgb24gd2hpY2ggb25lIG9mIHRoZSB2ZXJ0aWNlcyB5b3UgbmVlZC4KICAgICAqIEBwYXJhbSB2ZXJ0ZXhTdG9yZSBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0CiAgICAgKi8KCgogICAgZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIGZpcnN0T3JTZWNvbmQsIHZlcnRleFN0b3JlKSB7CiAgICAgIGNvbnN0IHZlcnRleEluZGV4ID0gdGhpcy5lZGdlc1tlZGdlSW5kZXggKiAyICsgKGZpcnN0T3JTZWNvbmQgPyAxIDogMCldOwogICAgICB0aGlzLmdldFZlcnRleCh2ZXJ0ZXhJbmRleCwgdmVydGV4U3RvcmUpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSB2ZWN0b3IgYWxvbmcgYW4gZWRnZS4KICAgICAqLwoKCiAgICBnZXRFZGdlVmVjdG9yKGVkZ2VJbmRleCwgdmVjdG9yU3RvcmUpIHsKICAgICAgY29uc3QgdmEgPSBnZXRFZGdlVmVjdG9yX3ZhOwogICAgICBjb25zdCB2YiA9IGdldEVkZ2VWZWN0b3JfdmI7CiAgICAgIHRoaXMuZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIDAsIHZhKTsKICAgICAgdGhpcy5nZXRFZGdlVmVydGV4KGVkZ2VJbmRleCwgMSwgdmIpOwogICAgICB2Yi52c3ViKHZhLCB2ZWN0b3JTdG9yZSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBmYWNlIG5vcm1hbCBnaXZlbiAzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgc3RhdGljIGNvbXB1dGVOb3JtYWwodmEsIHZiLCB2YywgdGFyZ2V0KSB7CiAgICAgIHZiLnZzdWIodmEsIGFiKTsKICAgICAgdmMudnN1Yih2YiwgY2IpOwogICAgICBjYi5jcm9zcyhhYiwgdGFyZ2V0KTsKCiAgICAgIGlmICghdGFyZ2V0LmlzWmVybygpKSB7CiAgICAgICAgdGFyZ2V0Lm5vcm1hbGl6ZSgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCB2ZXJ0ZXggaS4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRWZXJ0ZXgoaSwgb3V0KSB7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsKCiAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCk7CgogICAgICBvdXQueCAqPSBzY2FsZS54OwogICAgICBvdXQueSAqPSBzY2FsZS55OwogICAgICBvdXQueiAqPSBzY2FsZS56OwogICAgICByZXR1cm4gb3V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgcmF3IHZlcnRleCBpCiAgICAgKiBAcmV0dXJuIFRoZSAib3V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIHJldHVybiBvdXQuc2V0KHZlcnRpY2VzW2kzXSwgdmVydGljZXNbaTMgKyAxXSwgdmVydGljZXNbaTMgKyAyXSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHZlcnRleCBmcm9tIHRoZSB0cmltZXNoLHRyYW5zZm9ybWVkIGJ5IHRoZSBnaXZlbiBwb3NpdGlvbiBhbmQgcXVhdGVybmlvbi4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRXb3JsZFZlcnRleChpLCBwb3MsIHF1YXQsIG91dCkgewogICAgICB0aGlzLmdldFZlcnRleChpLCBvdXQpOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zLCBxdWF0LCBvdXQsIG91dCk7CiAgICAgIHJldHVybiBvdXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgdGhyZWUgdmVydGljZXMgZm9yIHRyaWFuZ2xlIGkuCiAgICAgKi8KCgogICAgZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGkzID0gaSAqIDM7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpM10sIGEpOwogICAgICB0aGlzLmdldFZlcnRleCh0aGlzLmluZGljZXNbaTMgKyAxXSwgYik7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDJdLCBjKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFsIG9mIHRyaWFuZ2xlIGkuCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgZ2V0Tm9ybWFsKGksIHRhcmdldCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICByZXR1cm4gdGFyZ2V0LnNldCh0aGlzLm5vcm1hbHNbaTNdLCB0aGlzLm5vcm1hbHNbaTMgKyAxXSwgdGhpcy5ub3JtYWxzW2kzICsgMl0pOwogICAgfQogICAgLyoqCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICAvLyBBcHByb3hpbWF0ZSB3aXRoIGJveCBpbmVydGlhCiAgICAgIC8vIEV4YWN0IGluZXJ0aWEgY2FsY3VsYXRpb24gaXMgb3ZlcmtpbGwsIGJ1dCBzZWUgaHR0cDovL2dlb21ldHJpY3Rvb2xzLmNvbS9Eb2N1bWVudGF0aW9uL1BvbHloZWRyYWxNYXNzUHJvcGVydGllcy5wZGYgZm9yIHRoZSBjb3JyZWN0IHdheSB0byBkbyBpdAogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIoY2xpX2FhYmIpOwogICAgICBjb25zdCB4ID0gY2xpX2FhYmIudXBwZXJCb3VuZC54IC0gY2xpX2FhYmIubG93ZXJCb3VuZC54OwogICAgICBjb25zdCB5ID0gY2xpX2FhYmIudXBwZXJCb3VuZC55IC0gY2xpX2FhYmIubG93ZXJCb3VuZC55OwogICAgICBjb25zdCB6ID0gY2xpX2FhYmIudXBwZXJCb3VuZC56IC0gY2xpX2FhYmIubG93ZXJCb3VuZC56OwogICAgICByZXR1cm4gdGFyZ2V0LnNldCgxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHogKiAyICogeiksIDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB4ICogMiAqIHggKyAyICogeiAqIDIgKiB6KSwgMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHkgKiAyICogeSArIDIgKiB4ICogMiAqIHgpKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbG9jYWwgQUFCQiBmb3IgdGhlIHRyaW1lc2gKICAgICAqLwoKCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmIpIHsKICAgICAgY29uc3QgbCA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IGFhYmIudXBwZXJCb3VuZDsKICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoOwogICAgICB0aGlzLnZlcnRpY2VzOwogICAgICBjb25zdCB2ID0gY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQ7CiAgICAgIHRoaXMuZ2V0VmVydGV4KDAsIHYpOwogICAgICBsLmNvcHkodik7CiAgICAgIHUuY29weSh2KTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBuOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKCiAgICAgICAgaWYgKHYueCA8IGwueCkgewogICAgICAgICAgbC54ID0gdi54OwogICAgICAgIH0gZWxzZSBpZiAodi54ID4gdS54KSB7CiAgICAgICAgICB1LnggPSB2Lng7CiAgICAgICAgfQoKICAgICAgICBpZiAodi55IDwgbC55KSB7CiAgICAgICAgICBsLnkgPSB2Lnk7CiAgICAgICAgfSBlbHNlIGlmICh2LnkgPiB1LnkpIHsKICAgICAgICAgIHUueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmICh2LnogPCBsLnopIHsKICAgICAgICAgIGwueiA9IHYuejsKICAgICAgICB9IGVsc2UgaWYgKHYueiA+IHUueikgewogICAgICAgICAgdS56ID0gdi56OwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGAuYWFiYmAgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVBQUJCKCkgewogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIodGhpcy5hYWJiKTsKICAgIH0KICAgIC8qKgogICAgICogV2lsbCB1cGRhdGUgdGhlIGAuYm91bmRpbmdTcGhlcmVSYWRpdXNgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IHYgPSBuZXcgVmVjMygpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB2ZXJ0aWNlcy5sZW5ndGggLyAzOyBpICE9PSBOOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICBjb25zdCBub3JtMiA9IHYubGVuZ3RoU3F1YXJlZCgpOwoKICAgICAgICBpZiAobm9ybTIgPiBtYXgyKSB7CiAgICAgICAgICBtYXgyID0gbm9ybTI7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTWF0aC5zcXJ0KG1heDIpOwogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKgogICAgICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoIC8gMywKICAgICAgICAgICAgICB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CiAgICAgICAgICBjb25zdCBtaW54LG1pbnksbWlueixtYXh4LG1heHksbWF4ejsKICAgICAgICAgICBjb25zdCB2ID0gdGVtcFdvcmxkVmVydGV4OwogICAgICAgICAgZm9yKGxldCBpPTA7IGk8bjsgaSsrKXsKICAgICAgICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICAgICAgICBxdWF0LnZtdWx0KHYsIHYpOwogICAgICAgICAgICAgIHBvcy52YWRkKHYsIHYpOwogICAgICAgICAgICAgIGlmICh2LnggPCBtaW54IHx8IG1pbng9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtaW54ID0gdi54OwogICAgICAgICAgICAgIH0gZWxzZSBpZih2LnggPiBtYXh4IHx8IG1heHg9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtYXh4ID0gdi54OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgaWYgKHYueSA8IG1pbnkgfHwgbWlueT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1pbnkgPSB2Lnk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmKHYueSA+IG1heHkgfHwgbWF4eT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1heHkgPSB2Lnk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBpZiAodi56IDwgbWlueiB8fCBtaW56PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICAgICAgICB9IGVsc2UgaWYodi56ID4gbWF4eiB8fCBtYXh6PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBtaW4uc2V0KG1pbngsbWlueSxtaW56KTsKICAgICAgICAgIG1heC5zZXQobWF4eCxtYXh5LG1heHopOwogICAgICAgICAgKi8KICAgICAgLy8gRmFzdGVyIGFwcHJveGltYXRpb24gdXNpbmcgbG9jYWwgQUFCQgogICAgICBjb25zdCBmcmFtZSA9IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZTsKICAgICAgY29uc3QgcmVzdWx0ID0gY2FsY3VsYXRlV29ybGRBQUJCX2FhYmI7CiAgICAgIGZyYW1lLnBvc2l0aW9uID0gcG9zOwogICAgICBmcmFtZS5xdWF0ZXJuaW9uID0gcXVhdDsKICAgICAgdGhpcy5hYWJiLnRvV29ybGRGcmFtZShmcmFtZSwgcmVzdWx0KTsKICAgICAgbWluLmNvcHkocmVzdWx0Lmxvd2VyQm91bmQpOwogICAgICBtYXguY29weShyZXN1bHQudXBwZXJCb3VuZCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSB2b2x1bWUKICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA0LjAgKiBNYXRoLlBJICogdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyAvIDMuMDsKICAgIH0KICAgIC8qKgogICAgICogQ3JlYXRlIGEgVHJpbWVzaCBpbnN0YW5jZSwgc2hhcGVkIGFzIGEgdG9ydXMuCiAgICAgKi8KCgogICAgc3RhdGljIGNyZWF0ZVRvcnVzKHJhZGl1cyA9IDEsIHR1YmUgPSAwLjUsIHJhZGlhbFNlZ21lbnRzID0gOCwgdHVidWxhclNlZ21lbnRzID0gNiwgYXJjID0gTWF0aC5QSSAqIDIpIHsKICAgICAgY29uc3QgdmVydGljZXMgPSBbXTsKICAgICAgY29uc3QgaW5kaWNlcyA9IFtdOwoKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPD0gcmFkaWFsU2VnbWVudHM7IGorKykgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IHR1YnVsYXJTZWdtZW50czsgaSsrKSB7CiAgICAgICAgICBjb25zdCB1ID0gaSAvIHR1YnVsYXJTZWdtZW50cyAqIGFyYzsKICAgICAgICAgIGNvbnN0IHYgPSBqIC8gcmFkaWFsU2VnbWVudHMgKiBNYXRoLlBJICogMjsKICAgICAgICAgIGNvbnN0IHggPSAocmFkaXVzICsgdHViZSAqIE1hdGguY29zKHYpKSAqIE1hdGguY29zKHUpOwogICAgICAgICAgY29uc3QgeSA9IChyYWRpdXMgKyB0dWJlICogTWF0aC5jb3ModikpICogTWF0aC5zaW4odSk7CiAgICAgICAgICBjb25zdCB6ID0gdHViZSAqIE1hdGguc2luKHYpOwogICAgICAgICAgdmVydGljZXMucHVzaCh4LCB5LCB6KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGogPSAxOyBqIDw9IHJhZGlhbFNlZ21lbnRzOyBqKyspIHsKICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSB0dWJ1bGFyU2VnbWVudHM7IGkrKykgewogICAgICAgICAgY29uc3QgYSA9ICh0dWJ1bGFyU2VnbWVudHMgKyAxKSAqIGogKyBpIC0gMTsKICAgICAgICAgIGNvbnN0IGIgPSAodHVidWxhclNlZ21lbnRzICsgMSkgKiAoaiAtIDEpICsgaSAtIDE7CiAgICAgICAgICBjb25zdCBjID0gKHR1YnVsYXJTZWdtZW50cyArIDEpICogKGogLSAxKSArIGk7CiAgICAgICAgICBjb25zdCBkID0gKHR1YnVsYXJTZWdtZW50cyArIDEpICogaiArIGk7CiAgICAgICAgICBpbmRpY2VzLnB1c2goYSwgYiwgZCk7CiAgICAgICAgICBpbmRpY2VzLnB1c2goYiwgYywgZCk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbmV3IFRyaW1lc2godmVydGljZXMsIGluZGljZXMpOwogICAgfQoKICB9CgogIGNvbnN0IGNvbXB1dGVOb3JtYWxzX24gPSBuZXcgVmVjMygpOwogIGNvbnN0IHVuc2NhbGVkQUFCQiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFiID0gbmV3IFZlYzMoKTsKICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdmIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHZjID0gbmV3IFZlYzMoKTsKICBjb25zdCBjbGlfYWFiYiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZSA9IG5ldyBUcmFuc2Zvcm0oKTsKICBjb25zdCBjYWxjdWxhdGVXb3JsZEFBQkJfYWFiYiA9IG5ldyBBQUJCKCk7CiAgLyoqCiAgICogQ29uc3RyYWludCBlcXVhdGlvbiBzb2x2ZXIgYmFzZSBjbGFzcy4KICAgKi8KCiAgY2xhc3MgU29sdmVyIHsKICAgIC8qKgogICAgICogQWxsIGVxdWF0aW9ucyB0byBiZSBzb2x2ZWQKICAgICAqLwoKICAgIC8qKgogICAgICogQHRvZG8gcmVtb3ZlIHVzZWxlc3MgY29uc3RydWN0b3IKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gdm9pZCAwOwogICAgICB0aGlzLmVxdWF0aW9ucyA9IFtdOwogICAgfQogICAgLyoqCiAgICAgKiBTaG91bGQgYmUgaW1wbGVtZW50ZWQgaW4gc3ViY2xhc3NlcyEKICAgICAqIEB0b2RvIHVzZSBhYnN0cmFjdAogICAgICogQHJldHVybiBudW1iZXIgb2YgaXRlcmF0aW9ucyBwZXJmb3JtZWQKICAgICAqLwoKCiAgICBzb2x2ZShkdCwgd29ybGQpIHsKICAgICAgcmV0dXJuICgvLyBTaG91bGQgcmV0dXJuIHRoZSBudW1iZXIgb2YgaXRlcmF0aW9ucyBkb25lIQogICAgICAgIDAKICAgICAgKTsKICAgIH0KICAgIC8qKgogICAgICogQWRkIGFuIGVxdWF0aW9uCiAgICAgKi8KCgogICAgYWRkRXF1YXRpb24oZXEpIHsKICAgICAgaWYgKGVxLmVuYWJsZWQgJiYgIWVxLmJpLmlzVHJpZ2dlciAmJiAhZXEuYmouaXNUcmlnZ2VyKSB7CiAgICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChlcSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlIGFuIGVxdWF0aW9uCiAgICAgKi8KCgogICAgcmVtb3ZlRXF1YXRpb24oZXEpIHsKICAgICAgY29uc3QgZXFzID0gdGhpcy5lcXVhdGlvbnM7CiAgICAgIGNvbnN0IGkgPSBlcXMuaW5kZXhPZihlcSk7CgogICAgICBpZiAoaSAhPT0gLTEpIHsKICAgICAgICBlcXMuc3BsaWNlKGksIDEpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhbGwgZXF1YXRpb25zCiAgICAgKi8KCgogICAgcmVtb3ZlQWxsRXF1YXRpb25zKCkgewogICAgICB0aGlzLmVxdWF0aW9ucy5sZW5ndGggPSAwOwogICAgfQoKICB9CiAgLyoqCiAgICogQ29uc3RyYWludCBlcXVhdGlvbiBHYXVzcy1TZWlkZWwgc29sdmVyLgogICAqIEB0b2RvIFRoZSBzcG9vayBwYXJhbWV0ZXJzIHNob3VsZCBiZSBzcGVjaWZpZWQgZm9yIGVhY2ggY29uc3RyYWludCwgbm90IGdsb2JhbGx5LgogICAqIEBzZWUgaHR0cHM6Ly93d3c4LmNzLnVtdS5zZS9rdXJzZXIvNURWMDU4L1ZUMDkvbGVjdHVyZXMvc3Bvb2tub3Rlcy5wZGYKICAgKi8KCgogIGNsYXNzIEdTU29sdmVyIGV4dGVuZHMgU29sdmVyIHsKICAgIC8qKgogICAgICogVGhlIG51bWJlciBvZiBzb2x2ZXIgaXRlcmF0aW9ucyBkZXRlcm1pbmVzIHF1YWxpdHkgb2YgdGhlIGNvbnN0cmFpbnRzIGluIHRoZSB3b3JsZC4KICAgICAqIFRoZSBtb3JlIGl0ZXJhdGlvbnMsIHRoZSBtb3JlIGNvcnJlY3Qgc2ltdWxhdGlvbi4gTW9yZSBpdGVyYXRpb25zIG5lZWQgbW9yZSBjb21wdXRhdGlvbnMgdGhvdWdoLiBJZiB5b3UgaGF2ZSBhIGxhcmdlIGdyYXZpdHkgZm9yY2UgaW4geW91ciB3b3JsZCwgeW91IHdpbGwgbmVlZCBtb3JlIGl0ZXJhdGlvbnMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZW4gdG9sZXJhbmNlIGlzIHJlYWNoZWQsIHRoZSBzeXN0ZW0gaXMgYXNzdW1lZCB0byBiZSBjb252ZXJnZWQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEB0b2RvIHJlbW92ZSB1c2VsZXNzIGNvbnN0cnVjdG9yCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcigpOwogICAgICB0aGlzLml0ZXJhdGlvbnMgPSB2b2lkIDA7CiAgICAgIHRoaXMudG9sZXJhbmNlID0gdm9pZCAwOwogICAgICB0aGlzLml0ZXJhdGlvbnMgPSAxMDsKICAgICAgdGhpcy50b2xlcmFuY2UgPSAxZS03OwogICAgfQogICAgLyoqCiAgICAgKiBTb2x2ZQogICAgICogQHJldHVybiBudW1iZXIgb2YgaXRlcmF0aW9ucyBwZXJmb3JtZWQKICAgICAqLwoKCiAgICBzb2x2ZShkdCwgd29ybGQpIHsKICAgICAgbGV0IGl0ZXIgPSAwOwogICAgICBjb25zdCBtYXhJdGVyID0gdGhpcy5pdGVyYXRpb25zOwogICAgICBjb25zdCB0b2xTcXVhcmVkID0gdGhpcy50b2xlcmFuY2UgKiB0aGlzLnRvbGVyYW5jZTsKICAgICAgY29uc3QgZXF1YXRpb25zID0gdGhpcy5lcXVhdGlvbnM7CiAgICAgIGNvbnN0IE5lcSA9IGVxdWF0aW9ucy5sZW5ndGg7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgTmJvZGllcyA9IGJvZGllcy5sZW5ndGg7CiAgICAgIGNvbnN0IGggPSBkdDsKICAgICAgbGV0IEI7CiAgICAgIGxldCBpbnZDOwogICAgICBsZXQgZGVsdGFsYW1iZGE7CiAgICAgIGxldCBkZWx0YWxhbWJkYVRvdDsKICAgICAgbGV0IEdXbGFtYmRhOwogICAgICBsZXQgbGFtYmRhajsgLy8gVXBkYXRlIHNvbHZlIG1hc3MKCiAgICAgIGlmIChOZXEgIT09IDApIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgICBib2RpZXNbaV0udXBkYXRlU29sdmVNYXNzUHJvcGVydGllcygpOwogICAgICAgIH0KICAgICAgfSAvLyBUaGluZ3MgdGhhdCBkbyBub3QgY2hhbmdlIGR1cmluZyBpdGVyYXRpb24gY2FuIGJlIGNvbXB1dGVkIG9uY2UKCgogICAgICBjb25zdCBpbnZDcyA9IEdTU29sdmVyX3NvbHZlX2ludkNzOwogICAgICBjb25zdCBCcyA9IEdTU29sdmVyX3NvbHZlX0JzOwogICAgICBjb25zdCBsYW1iZGEgPSBHU1NvbHZlcl9zb2x2ZV9sYW1iZGE7CiAgICAgIGludkNzLmxlbmd0aCA9IE5lcTsKICAgICAgQnMubGVuZ3RoID0gTmVxOwogICAgICBsYW1iZGEubGVuZ3RoID0gTmVxOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5lcTsgaSsrKSB7CiAgICAgICAgY29uc3QgYyA9IGVxdWF0aW9uc1tpXTsKICAgICAgICBsYW1iZGFbaV0gPSAwLjA7CiAgICAgICAgQnNbaV0gPSBjLmNvbXB1dGVCKGgpOwogICAgICAgIGludkNzW2ldID0gMS4wIC8gYy5jb21wdXRlQygpOwogICAgICB9CgogICAgICBpZiAoTmVxICE9PSAwKSB7CiAgICAgICAgLy8gUmVzZXQgdmxhbWJkYQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOYm9kaWVzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGIgPSBib2RpZXNbaV07CiAgICAgICAgICBjb25zdCB2bGFtYmRhID0gYi52bGFtYmRhOwogICAgICAgICAgY29uc3Qgd2xhbWJkYSA9IGIud2xhbWJkYTsKICAgICAgICAgIHZsYW1iZGEuc2V0KDAsIDAsIDApOwogICAgICAgICAgd2xhbWJkYS5zZXQoMCwgMCwgMCk7CiAgICAgICAgfSAvLyBJdGVyYXRlIG92ZXIgZXF1YXRpb25zCgoKICAgICAgICBmb3IgKGl0ZXIgPSAwOyBpdGVyICE9PSBtYXhJdGVyOyBpdGVyKyspIHsKICAgICAgICAgIC8vIEFjY3VtdWxhdGUgdGhlIHRvdGFsIGVycm9yIGZvciBlYWNoIGl0ZXJhdGlvbi4KICAgICAgICAgIGRlbHRhbGFtYmRhVG90ID0gMC4wOwoKICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBOZXE7IGorKykgewogICAgICAgICAgICBjb25zdCBjID0gZXF1YXRpb25zW2pdOyAvLyBDb21wdXRlIGl0ZXJhdGlvbgoKICAgICAgICAgICAgQiA9IEJzW2pdOwogICAgICAgICAgICBpbnZDID0gaW52Q3Nbal07CiAgICAgICAgICAgIGxhbWJkYWogPSBsYW1iZGFbal07CiAgICAgICAgICAgIEdXbGFtYmRhID0gYy5jb21wdXRlR1dsYW1iZGEoKTsKICAgICAgICAgICAgZGVsdGFsYW1iZGEgPSBpbnZDICogKEIgLSBHV2xhbWJkYSAtIGMuZXBzICogbGFtYmRhaik7IC8vIENsYW1wIGlmIHdlIGFyZSBub3Qgd2l0aGluIHRoZSBtaW4vbWF4IGludGVydmFsCgogICAgICAgICAgICBpZiAobGFtYmRhaiArIGRlbHRhbGFtYmRhIDwgYy5taW5Gb3JjZSkgewogICAgICAgICAgICAgIGRlbHRhbGFtYmRhID0gYy5taW5Gb3JjZSAtIGxhbWJkYWo7CiAgICAgICAgICAgIH0gZWxzZSBpZiAobGFtYmRhaiArIGRlbHRhbGFtYmRhID4gYy5tYXhGb3JjZSkgewogICAgICAgICAgICAgIGRlbHRhbGFtYmRhID0gYy5tYXhGb3JjZSAtIGxhbWJkYWo7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxhbWJkYVtqXSArPSBkZWx0YWxhbWJkYTsKICAgICAgICAgICAgZGVsdGFsYW1iZGFUb3QgKz0gZGVsdGFsYW1iZGEgPiAwLjAgPyBkZWx0YWxhbWJkYSA6IC1kZWx0YWxhbWJkYTsgLy8gYWJzKGRlbHRhbGFtYmRhKQoKICAgICAgICAgICAgYy5hZGRUb1dsYW1iZGEoZGVsdGFsYW1iZGEpOwogICAgICAgICAgfSAvLyBJZiB0aGUgdG90YWwgZXJyb3IgaXMgc21hbGwgZW5vdWdoIC0gc3RvcCBpdGVyYXRlCgoKICAgICAgICAgIGlmIChkZWx0YWxhbWJkYVRvdCAqIGRlbHRhbGFtYmRhVG90IDwgdG9sU3F1YXJlZCkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9IC8vIEFkZCByZXN1bHQgdG8gdmVsb2NpdHkKCgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOYm9kaWVzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGIgPSBib2RpZXNbaV07CiAgICAgICAgICBjb25zdCB2ID0gYi52ZWxvY2l0eTsKICAgICAgICAgIGNvbnN0IHcgPSBiLmFuZ3VsYXJWZWxvY2l0eTsKICAgICAgICAgIGIudmxhbWJkYS52bXVsKGIubGluZWFyRmFjdG9yLCBiLnZsYW1iZGEpOwogICAgICAgICAgdi52YWRkKGIudmxhbWJkYSwgdik7CiAgICAgICAgICBiLndsYW1iZGEudm11bChiLmFuZ3VsYXJGYWN0b3IsIGIud2xhbWJkYSk7CiAgICAgICAgICB3LnZhZGQoYi53bGFtYmRhLCB3KTsKICAgICAgICB9IC8vIFNldCB0aGUgYC5tdWx0aXBsaWVyYCBwcm9wZXJ0eSBvZiBlYWNoIGVxdWF0aW9uCgoKICAgICAgICBsZXQgbCA9IGVxdWF0aW9ucy5sZW5ndGg7CiAgICAgICAgY29uc3QgaW52RHQgPSAxIC8gaDsKCiAgICAgICAgd2hpbGUgKGwtLSkgewogICAgICAgICAgZXF1YXRpb25zW2xdLm11bHRpcGxpZXIgPSBsYW1iZGFbbF0gKiBpbnZEdDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBpdGVyOwogICAgfQoKICB9IC8vIEp1c3QgdGVtcG9yYXJ5IG51bWJlciBob2xkZXJzIHRoYXQgd2Ugd2FudCB0byByZXVzZSBlYWNoIGl0ZXJhdGlvbi4KCgogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2xhbWJkYSA9IFtdOwogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2ludkNzID0gW107CiAgY29uc3QgR1NTb2x2ZXJfc29sdmVfQnMgPSBbXTsKICAvKioKICAgKiBTcGxpdHMgdGhlIGVxdWF0aW9ucyBpbnRvIGlzbGFuZHMgYW5kIHNvbHZlcyB0aGVtIGluZGVwZW5kZW50bHkuIENhbiBpbXByb3ZlIHBlcmZvcm1hbmNlLgogICAqLwoKICBjbGFzcyBTcGxpdFNvbHZlciBleHRlbmRzIFNvbHZlciB7CiAgICAvKioKICAgICAqIFRoZSBudW1iZXIgb2Ygc29sdmVyIGl0ZXJhdGlvbnMgZGV0ZXJtaW5lcyBxdWFsaXR5IG9mIHRoZSBjb25zdHJhaW50cyBpbiB0aGUgd29ybGQuIFRoZSBtb3JlIGl0ZXJhdGlvbnMsIHRoZSBtb3JlIGNvcnJlY3Qgc2ltdWxhdGlvbi4gTW9yZSBpdGVyYXRpb25zIG5lZWQgbW9yZSBjb21wdXRhdGlvbnMgdGhvdWdoLiBJZiB5b3UgaGF2ZSBhIGxhcmdlIGdyYXZpdHkgZm9yY2UgaW4geW91ciB3b3JsZCwgeW91IHdpbGwgbmVlZCBtb3JlIGl0ZXJhdGlvbnMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZW4gdG9sZXJhbmNlIGlzIHJlYWNoZWQsIHRoZSBzeXN0ZW0gaXMgYXNzdW1lZCB0byBiZSBjb252ZXJnZWQuCiAgICAgKi8KCiAgICAvKiogc3Vic29sdmVyICovCiAgICBjb25zdHJ1Y3RvcihzdWJzb2x2ZXIpIHsKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5pdGVyYXRpb25zID0gdm9pZCAwOwogICAgICB0aGlzLnRvbGVyYW5jZSA9IHZvaWQgMDsKICAgICAgdGhpcy5zdWJzb2x2ZXIgPSB2b2lkIDA7CiAgICAgIHRoaXMubm9kZXMgPSB2b2lkIDA7CiAgICAgIHRoaXMubm9kZVBvb2wgPSB2b2lkIDA7CiAgICAgIHRoaXMuaXRlcmF0aW9ucyA9IDEwOwogICAgICB0aGlzLnRvbGVyYW5jZSA9IDFlLTc7CiAgICAgIHRoaXMuc3Vic29sdmVyID0gc3Vic29sdmVyOwogICAgICB0aGlzLm5vZGVzID0gW107CiAgICAgIHRoaXMubm9kZVBvb2wgPSBbXTsgLy8gQ3JlYXRlIG5lZWRlZCBub2RlcywgcmV1c2UgaWYgcG9zc2libGUKCiAgICAgIHdoaWxlICh0aGlzLm5vZGVQb29sLmxlbmd0aCA8IDEyOCkgewogICAgICAgIHRoaXMubm9kZVBvb2wucHVzaCh0aGlzLmNyZWF0ZU5vZGUoKSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogY3JlYXRlTm9kZQogICAgICovCgoKICAgIGNyZWF0ZU5vZGUoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgYm9keTogbnVsbCwKICAgICAgICBjaGlsZHJlbjogW10sCiAgICAgICAgZXFzOiBbXSwKICAgICAgICB2aXNpdGVkOiBmYWxzZQogICAgICB9OwogICAgfQogICAgLyoqCiAgICAgKiBTb2x2ZSB0aGUgc3Vic3lzdGVtcwogICAgICogQHJldHVybiBudW1iZXIgb2YgaXRlcmF0aW9ucyBwZXJmb3JtZWQKICAgICAqLwoKCiAgICBzb2x2ZShkdCwgd29ybGQpIHsKICAgICAgY29uc3Qgbm9kZXMgPSBTcGxpdFNvbHZlcl9zb2x2ZV9ub2RlczsKICAgICAgY29uc3Qgbm9kZVBvb2wgPSB0aGlzLm5vZGVQb29sOwogICAgICBjb25zdCBib2RpZXMgPSB3b3JsZC5ib2RpZXM7CiAgICAgIGNvbnN0IGVxdWF0aW9ucyA9IHRoaXMuZXF1YXRpb25zOwogICAgICBjb25zdCBOZXEgPSBlcXVhdGlvbnMubGVuZ3RoOwogICAgICBjb25zdCBOYm9kaWVzID0gYm9kaWVzLmxlbmd0aDsKICAgICAgY29uc3Qgc3Vic29sdmVyID0gdGhpcy5zdWJzb2x2ZXI7IC8vIENyZWF0ZSBuZWVkZWQgbm9kZXMsIHJldXNlIGlmIHBvc3NpYmxlCgogICAgICB3aGlsZSAobm9kZVBvb2wubGVuZ3RoIDwgTmJvZGllcykgewogICAgICAgIG5vZGVQb29sLnB1c2godGhpcy5jcmVhdGVOb2RlKCkpOwogICAgICB9CgogICAgICBub2Rlcy5sZW5ndGggPSBOYm9kaWVzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBOYm9kaWVzOyBpKyspIHsKICAgICAgICBub2Rlc1tpXSA9IG5vZGVQb29sW2ldOwogICAgICB9IC8vIFJlc2V0IG5vZGUgdmFsdWVzCgoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5ib2RpZXM7IGkrKykgewogICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tpXTsKICAgICAgICBub2RlLmJvZHkgPSBib2RpZXNbaV07CiAgICAgICAgbm9kZS5jaGlsZHJlbi5sZW5ndGggPSAwOwogICAgICAgIG5vZGUuZXFzLmxlbmd0aCA9IDA7CiAgICAgICAgbm9kZS52aXNpdGVkID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGsgPSAwOyBrICE9PSBOZXE7IGsrKykgewogICAgICAgIGNvbnN0IGVxID0gZXF1YXRpb25zW2tdOwogICAgICAgIGNvbnN0IGkgPSBib2RpZXMuaW5kZXhPZihlcS5iaSk7CiAgICAgICAgY29uc3QgaiA9IGJvZGllcy5pbmRleE9mKGVxLmJqKTsKICAgICAgICBjb25zdCBuaSA9IG5vZGVzW2ldOwogICAgICAgIGNvbnN0IG5qID0gbm9kZXNbal07CiAgICAgICAgbmkuY2hpbGRyZW4ucHVzaChuaik7CiAgICAgICAgbmkuZXFzLnB1c2goZXEpOwogICAgICAgIG5qLmNoaWxkcmVuLnB1c2gobmkpOwogICAgICAgIG5qLmVxcy5wdXNoKGVxKTsKICAgICAgfQoKICAgICAgbGV0IGNoaWxkOwogICAgICBsZXQgbiA9IDA7CiAgICAgIGxldCBlcXMgPSBTcGxpdFNvbHZlcl9zb2x2ZV9lcXM7CiAgICAgIHN1YnNvbHZlci50b2xlcmFuY2UgPSB0aGlzLnRvbGVyYW5jZTsKICAgICAgc3Vic29sdmVyLml0ZXJhdGlvbnMgPSB0aGlzLml0ZXJhdGlvbnM7CiAgICAgIGNvbnN0IGR1bW15V29ybGQgPSBTcGxpdFNvbHZlcl9zb2x2ZV9kdW1teVdvcmxkOwoKICAgICAgd2hpbGUgKGNoaWxkID0gZ2V0VW52aXNpdGVkTm9kZShub2RlcykpIHsKICAgICAgICBlcXMubGVuZ3RoID0gMDsKICAgICAgICBkdW1teVdvcmxkLmJvZGllcy5sZW5ndGggPSAwOwogICAgICAgIGJmcyhjaGlsZCwgdmlzaXRGdW5jLCBkdW1teVdvcmxkLmJvZGllcywgZXFzKTsKICAgICAgICBjb25zdCBOZXFzID0gZXFzLmxlbmd0aDsKICAgICAgICBlcXMgPSBlcXMuc29ydChzb3J0QnlJZCk7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOZXFzOyBpKyspIHsKICAgICAgICAgIHN1YnNvbHZlci5hZGRFcXVhdGlvbihlcXNbaV0pOwogICAgICAgIH0KCiAgICAgICAgc3Vic29sdmVyLnNvbHZlKGR0LCBkdW1teVdvcmxkKTsKICAgICAgICBzdWJzb2x2ZXIucmVtb3ZlQWxsRXF1YXRpb25zKCk7CiAgICAgICAgbisrOwogICAgICB9CgogICAgICByZXR1cm4gbjsKICAgIH0KCiAgfSAvLyBSZXR1cm5zIHRoZSBudW1iZXIgb2Ygc3Vic3lzdGVtcwoKCiAgY29uc3QgU3BsaXRTb2x2ZXJfc29sdmVfbm9kZXMgPSBbXTsgLy8gQWxsIGFsbG9jYXRlZCBub2RlIG9iamVjdHMKCiAgY29uc3QgU3BsaXRTb2x2ZXJfc29sdmVfZXFzID0gW107IC8vIFRlbXAgYXJyYXkKCiAgY29uc3QgU3BsaXRTb2x2ZXJfc29sdmVfZHVtbXlXb3JsZCA9IHsKICAgIGJvZGllczogW10KICB9OyAvLyBUZW1wIG9iamVjdAoKICBjb25zdCBTVEFUSUMgPSBCb2R5LlNUQVRJQzsKCiAgZnVuY3Rpb24gZ2V0VW52aXNpdGVkTm9kZShub2RlcykgewogICAgY29uc3QgTm5vZGVzID0gbm9kZXMubGVuZ3RoOwoKICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBObm9kZXM7IGkrKykgewogICAgICBjb25zdCBub2RlID0gbm9kZXNbaV07CgogICAgICBpZiAoIW5vZGUudmlzaXRlZCAmJiAhKG5vZGUuYm9keS50eXBlICYgU1RBVElDKSkgewogICAgICAgIHJldHVybiBub2RlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgY29uc3QgcXVldWUgPSBbXTsKCiAgZnVuY3Rpb24gYmZzKHJvb3QsIHZpc2l0RnVuYywgYmRzLCBlcXMpIHsKICAgIHF1ZXVlLnB1c2gocm9vdCk7CiAgICByb290LnZpc2l0ZWQgPSB0cnVlOwogICAgdmlzaXRGdW5jKHJvb3QsIGJkcywgZXFzKTsKCiAgICB3aGlsZSAocXVldWUubGVuZ3RoKSB7CiAgICAgIGNvbnN0IG5vZGUgPSBxdWV1ZS5wb3AoKTsgLy8gTG9vcCBvdmVyIHVudmlzaXRlZCBjaGlsZCBub2RlcwoKICAgICAgbGV0IGNoaWxkOwoKICAgICAgd2hpbGUgKGNoaWxkID0gZ2V0VW52aXNpdGVkTm9kZShub2RlLmNoaWxkcmVuKSkgewogICAgICAgIGNoaWxkLnZpc2l0ZWQgPSB0cnVlOwogICAgICAgIHZpc2l0RnVuYyhjaGlsZCwgYmRzLCBlcXMpOwogICAgICAgIHF1ZXVlLnB1c2goY2hpbGQpOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiB2aXNpdEZ1bmMobm9kZSwgYmRzLCBlcXMpIHsKICAgIGJkcy5wdXNoKG5vZGUuYm9keSk7CiAgICBjb25zdCBOZXFzID0gbm9kZS5lcXMubGVuZ3RoOwoKICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOZXFzOyBpKyspIHsKICAgICAgY29uc3QgZXEgPSBub2RlLmVxc1tpXTsKCiAgICAgIGlmICghZXFzLmluY2x1ZGVzKGVxKSkgewogICAgICAgIGVxcy5wdXNoKGVxKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gc29ydEJ5SWQoYSwgYikgewogICAgcmV0dXJuIGIuaWQgLSBhLmlkOwogIH0KICAvKioKICAgKiBGb3IgcG9vbGluZyBvYmplY3RzIHRoYXQgY2FuIGJlIHJldXNlZC4KICAgKi8KCgogIGNsYXNzIFBvb2wgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMub2JqZWN0cyA9IFtdOwogICAgICB0aGlzLnR5cGUgPSBPYmplY3Q7CiAgICB9CiAgICAvKioKICAgICAqIFJlbGVhc2UgYW4gb2JqZWN0IGFmdGVyIHVzZQogICAgICovCgoKICAgIHJlbGVhc2UoLi4uYXJncykgewogICAgICBjb25zdCBOYXJncyA9IGFyZ3MubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5hcmdzOyBpKyspIHsKICAgICAgICB0aGlzLm9iamVjdHMucHVzaChhcmdzW2ldKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBvYmplY3QKICAgICAqLwoKCiAgICBnZXQoKSB7CiAgICAgIGlmICh0aGlzLm9iamVjdHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0T2JqZWN0KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMub2JqZWN0cy5wb3AoKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3QgYW4gb2JqZWN0LiBTaG91bGQgYmUgaW1wbGVtZW50ZWQgaW4gZWFjaCBzdWJjbGFzcy4KICAgICAqLwoKCiAgICBjb25zdHJ1Y3RPYmplY3QoKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignY29uc3RydWN0T2JqZWN0KCkgbm90IGltcGxlbWVudGVkIGluIHRoaXMgUG9vbCBzdWJjbGFzcyB5ZXQhJyk7CiAgICB9CiAgICAvKioKICAgICAqIEByZXR1cm4gU2VsZiwgZm9yIGNoYWluaW5nCiAgICAgKi8KCgogICAgcmVzaXplKHNpemUpIHsKICAgICAgY29uc3Qgb2JqZWN0cyA9IHRoaXMub2JqZWN0czsKCiAgICAgIHdoaWxlIChvYmplY3RzLmxlbmd0aCA+IHNpemUpIHsKICAgICAgICBvYmplY3RzLnBvcCgpOwogICAgICB9CgogICAgICB3aGlsZSAob2JqZWN0cy5sZW5ndGggPCBzaXplKSB7CiAgICAgICAgb2JqZWN0cy5wdXNoKHRoaXMuY29uc3RydWN0T2JqZWN0KCkpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgfQogIC8qKgogICAqIFZlYzNQb29sCiAgICovCgoKICBjbGFzcyBWZWMzUG9vbCBleHRlbmRzIFBvb2wgewogICAgY29uc3RydWN0b3IoLi4uYXJncykgewogICAgICBzdXBlciguLi5hcmdzKTsKICAgICAgdGhpcy50eXBlID0gVmVjMzsKICAgIH0KICAgIC8qKgogICAgICogQ29uc3RydWN0IGEgdmVjdG9yCiAgICAgKi8KCgogICAgY29uc3RydWN0T2JqZWN0KCkgewogICAgICByZXR1cm4gbmV3IFZlYzMoKTsKICAgIH0KCiAgfQoKICBsZXQgX0NPTExJU0lPTl9UWVBFUyRzcGhlLCBfQ09MTElTSU9OX1RZUEVTJHNwaGUyLCBfQ09MTElTSU9OX1RZUEVTJGJveEIsIF9DT0xMSVNJT05fVFlQRVMkc3BoZTMsIF9DT0xMSVNJT05fVFlQRVMkcGxhbiwgX0NPTExJU0lPTl9UWVBFUyRjb252LCBfQ09MTElTSU9OX1RZUEVTJHNwaGU0LCBfQ09MTElTSU9OX1RZUEVTJHBsYW4yLCBfQ09MTElTSU9OX1RZUEVTJGJveEMsIF9DT0xMSVNJT05fVFlQRVMkc3BoZTUsIF9DT0xMSVNJT05fVFlQRVMkYm94SCwgX0NPTExJU0lPTl9UWVBFUyRjb252MiwgX0NPTExJU0lPTl9UWVBFUyRzcGhlNiwgX0NPTExJU0lPTl9UWVBFUyRwbGFuMywgX0NPTExJU0lPTl9UWVBFUyRib3hQLCBfQ09MTElTSU9OX1RZUEVTJGNvbnYzLCBfQ09MTElTSU9OX1RZUEVTJGN5bGksIF9DT0xMSVNJT05fVFlQRVMkc3BoZTcsIF9DT0xMSVNJT05fVFlQRVMkcGxhbjQsIF9DT0xMSVNJT05fVFlQRVMkYm94QzIsIF9DT0xMSVNJT05fVFlQRVMkY29udjQsIF9DT0xMSVNJT05fVFlQRVMkaGVpZywgX0NPTExJU0lPTl9UWVBFUyRwYXJ0LCBfQ09MTElTSU9OX1RZUEVTJHNwaGU4LCBfQ09MTElTSU9OX1RZUEVTJHBsYW41OyAvLyBOYW1pbmcgcnVsZTogYmFzZWQgb2YgdGhlIG9yZGVyIGluIFNIQVBFX1RZUEVTLAogIC8vIHRoZSBmaXJzdCBwYXJ0IG9mIHRoZSBtZXRob2QgaXMgZm9ybWVkIGJ5IHRoZQogIC8vIHNoYXBlIHR5cGUgdGhhdCBjb21lcyBiZWZvcmUsIGluIHRoZSBzZWNvbmQgcGFydAogIC8vIHRoZXJlIGlzIHRoZSBzaGFwZSB0eXBlIHRoYXQgY29tZXMgYWZ0ZXIgaW4gdGhlIFNIQVBFX1RZUEVTIGxpc3QKCgogIGNvbnN0IENPTExJU0lPTl9UWVBFUyA9IHsKICAgIHNwaGVyZVNwaGVyZTogU2hhcGUudHlwZXMuU1BIRVJFLAogICAgc3BoZXJlUGxhbmU6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLlBMQU5FLAogICAgYm94Qm94OiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5CT1gsCiAgICBzcGhlcmVCb3g6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIHBsYW5lQm94OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIGNvbnZleENvbnZleDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHNwaGVyZUNvbnZleDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHBsYW5lQ29udmV4OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBib3hDb252ZXg6IFNoYXBlLnR5cGVzLkJPWCB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBzcGhlcmVIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBib3hIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBjb252ZXhIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkhFSUdIVEZJRUxELAogICAgc3BoZXJlUGFydGljbGU6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuU1BIRVJFLAogICAgcGxhbmVQYXJ0aWNsZTogU2hhcGUudHlwZXMuUExBTkUgfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGJveFBhcnRpY2xlOiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGNvbnZleFBhcnRpY2xlOiBTaGFwZS50eXBlcy5QQVJUSUNMRSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBjeWxpbmRlckN5bGluZGVyOiBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHNwaGVyZUN5bGluZGVyOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBsYW5lQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBMQU5FIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBib3hDeWxpbmRlcjogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBjb252ZXhDeWxpbmRlcjogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkNZTElOREVSLAogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcjogU2hhcGUudHlwZXMuSEVJR0hURklFTEQgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBhcnRpY2xlQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBzcGhlcmVUcmltZXNoOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5UUklNRVNILAogICAgcGxhbmVUcmltZXNoOiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLlRSSU1FU0gKICB9OwogIF9DT0xMSVNJT05fVFlQRVMkc3BoZSA9IENPTExJU0lPTl9UWVBFUy5zcGhlcmVTcGhlcmU7CiAgX0NPTExJU0lPTl9UWVBFUyRzcGhlMiA9IENPTExJU0lPTl9UWVBFUy5zcGhlcmVQbGFuZTsKICBfQ09MTElTSU9OX1RZUEVTJGJveEIgPSBDT0xMSVNJT05fVFlQRVMuYm94Qm94OwogIF9DT0xMSVNJT05fVFlQRVMkc3BoZTMgPSBDT0xMSVNJT05fVFlQRVMuc3BoZXJlQm94OwogIF9DT0xMSVNJT05fVFlQRVMkcGxhbiA9IENPTExJU0lPTl9UWVBFUy5wbGFuZUJveDsKICBfQ09MTElTSU9OX1RZUEVTJGNvbnYgPSBDT0xMSVNJT05fVFlQRVMuY29udmV4Q29udmV4OwogIF9DT0xMSVNJT05fVFlQRVMkc3BoZTQgPSBDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ29udmV4OwogIF9DT0xMSVNJT05fVFlQRVMkcGxhbjIgPSBDT0xMSVNJT05fVFlQRVMucGxhbmVDb252ZXg7CiAgX0NPTExJU0lPTl9UWVBFUyRib3hDID0gQ09MTElTSU9OX1RZUEVTLmJveENvbnZleDsKICBfQ09MTElTSU9OX1RZUEVTJHNwaGU1ID0gQ09MTElTSU9OX1RZUEVTLnNwaGVyZUhlaWdodGZpZWxkOwogIF9DT0xMSVNJT05fVFlQRVMkYm94SCA9IENPTExJU0lPTl9UWVBFUy5ib3hIZWlnaHRmaWVsZDsKICBfQ09MTElTSU9OX1RZUEVTJGNvbnYyID0gQ09MTElTSU9OX1RZUEVTLmNvbnZleEhlaWdodGZpZWxkOwogIF9DT0xMSVNJT05fVFlQRVMkc3BoZTYgPSBDT0xMSVNJT05fVFlQRVMuc3BoZXJlUGFydGljbGU7CiAgX0NPTExJU0lPTl9UWVBFUyRwbGFuMyA9IENPTExJU0lPTl9UWVBFUy5wbGFuZVBhcnRpY2xlOwogIF9DT0xMSVNJT05fVFlQRVMkYm94UCA9IENPTExJU0lPTl9UWVBFUy5ib3hQYXJ0aWNsZTsKICBfQ09MTElTSU9OX1RZUEVTJGNvbnYzID0gQ09MTElTSU9OX1RZUEVTLmNvbnZleFBhcnRpY2xlOwogIF9DT0xMSVNJT05fVFlQRVMkY3lsaSA9IENPTExJU0lPTl9UWVBFUy5jeWxpbmRlckN5bGluZGVyOwogIF9DT0xMSVNJT05fVFlQRVMkc3BoZTcgPSBDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ3lsaW5kZXI7CiAgX0NPTExJU0lPTl9UWVBFUyRwbGFuNCA9IENPTExJU0lPTl9UWVBFUy5wbGFuZUN5bGluZGVyOwogIF9DT0xMSVNJT05fVFlQRVMkYm94QzIgPSBDT0xMSVNJT05fVFlQRVMuYm94Q3lsaW5kZXI7CiAgX0NPTExJU0lPTl9UWVBFUyRjb252NCA9IENPTExJU0lPTl9UWVBFUy5jb252ZXhDeWxpbmRlcjsKICBfQ09MTElTSU9OX1RZUEVTJGhlaWcgPSBDT0xMSVNJT05fVFlQRVMuaGVpZ2h0ZmllbGRDeWxpbmRlcjsKICBfQ09MTElTSU9OX1RZUEVTJHBhcnQgPSBDT0xMSVNJT05fVFlQRVMucGFydGljbGVDeWxpbmRlcjsKICBfQ09MTElTSU9OX1RZUEVTJHNwaGU4ID0gQ09MTElTSU9OX1RZUEVTLnNwaGVyZVRyaW1lc2g7CiAgX0NPTExJU0lPTl9UWVBFUyRwbGFuNSA9IENPTExJU0lPTl9UWVBFUy5wbGFuZVRyaW1lc2g7CiAgLyoqCiAgICogSGVscGVyIGNsYXNzIGZvciB0aGUgV29ybGQuIEdlbmVyYXRlcyBDb250YWN0RXF1YXRpb25zLgogICAqIEB0b2RvIFNwaGVyZS1Db252ZXhQb2x5aGVkcm9uIGNvbnRhY3RzCiAgICogQHRvZG8gQ29udGFjdCByZWR1Y3Rpb24KICAgKiBAdG9kbyBzaG91bGQgbW92ZSBtZXRob2RzIHRvIHByb3RvdHlwZQogICAqLwoKICBjbGFzcyBOYXJyb3dwaGFzZSB7CiAgICAvKioKICAgICAqIEludGVybmFsIHN0b3JhZ2Ugb2YgcG9vbGVkIGNvbnRhY3QgcG9pbnRzLgogICAgICovCgogICAgLyoqCiAgICAgKiBQb29sZWQgdmVjdG9ycy4KICAgICAqLwogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHNwaGVdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVTcGhlcmU7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHNwaGUyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlUGxhbmU7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJGJveEJdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hCb3g7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHNwaGUzXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlQm94OwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRwbGFuXSgpIHsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVCb3g7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJGNvbnZdKCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXg7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHNwaGU0XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlQ29udmV4OwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRwbGFuMl0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lQ29udmV4OwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRib3hDXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94Q29udmV4OwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRzcGhlNV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZUhlaWdodGZpZWxkOwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRib3hIXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94SGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJGNvbnYyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4SGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHNwaGU2XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlUGFydGljbGU7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHBsYW4zXSgpIHsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVQYXJ0aWNsZTsKICAgIH0KCiAgICBnZXQgW19DT0xMSVNJT05fVFlQRVMkYm94UF0oKSB7CiAgICAgIHJldHVybiB0aGlzLmJveFBhcnRpY2xlOwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRjb252M10oKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleFBhcnRpY2xlOwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRjeWxpXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4Q29udmV4OwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRzcGhlN10oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZUNvbnZleDsKICAgIH0KCiAgICBnZXQgW19DT0xMSVNJT05fVFlQRVMkcGxhbjRdKCkgewogICAgICByZXR1cm4gdGhpcy5wbGFuZUNvbnZleDsKICAgIH0KCiAgICBnZXQgW19DT0xMSVNJT05fVFlQRVMkYm94QzJdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hDb252ZXg7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJGNvbnY0XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4Q29udmV4OwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRoZWlnXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuaGVpZ2h0ZmllbGRDeWxpbmRlcjsKICAgIH0KCiAgICBnZXQgW19DT0xMSVNJT05fVFlQRVMkcGFydF0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBhcnRpY2xlQ3lsaW5kZXI7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHNwaGU4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlVHJpbWVzaDsKICAgIH0KCiAgICBnZXQgW19DT0xMSVNJT05fVFlQRVMkcGxhbjVdKCkgewogICAgICByZXR1cm4gdGhpcy5wbGFuZVRyaW1lc2g7CiAgICB9IC8vIGdldCBbQ09MTElTSU9OX1RZUEVTLmNvbnZleFRyaW1lc2hdKCkgewogICAgLy8gICByZXR1cm4gdGhpcy5jb252ZXhUcmltZXNoCiAgICAvLyB9CgoKICAgIGNvbnN0cnVjdG9yKHdvcmxkKSB7CiAgICAgIHRoaXMuY29udGFjdFBvaW50UG9vbCA9IHZvaWQgMDsKICAgICAgdGhpcy5mcmljdGlvbkVxdWF0aW9uUG9vbCA9IHZvaWQgMDsKICAgICAgdGhpcy5yZXN1bHQgPSB2b2lkIDA7CiAgICAgIHRoaXMuZnJpY3Rpb25SZXN1bHQgPSB2b2lkIDA7CiAgICAgIHRoaXMudjNwb29sID0gdm9pZCAwOwogICAgICB0aGlzLndvcmxkID0gdm9pZCAwOwogICAgICB0aGlzLmN1cnJlbnRDb250YWN0TWF0ZXJpYWwgPSB2b2lkIDA7CiAgICAgIHRoaXMuZW5hYmxlRnJpY3Rpb25SZWR1Y3Rpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuY29udGFjdFBvaW50UG9vbCA9IFtdOwogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25Qb29sID0gW107CiAgICAgIHRoaXMucmVzdWx0ID0gW107CiAgICAgIHRoaXMuZnJpY3Rpb25SZXN1bHQgPSBbXTsKICAgICAgdGhpcy52M3Bvb2wgPSBuZXcgVmVjM1Bvb2woKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgICB0aGlzLmN1cnJlbnRDb250YWN0TWF0ZXJpYWwgPSB3b3JsZC5kZWZhdWx0Q29udGFjdE1hdGVyaWFsOwogICAgICB0aGlzLmVuYWJsZUZyaWN0aW9uUmVkdWN0aW9uID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIE1ha2UgYSBjb250YWN0IG9iamVjdCwgYnkgdXNpbmcgdGhlIGludGVybmFsIHBvb2wgb3IgY3JlYXRpbmcgYSBuZXcgb25lLgogICAgICovCgoKICAgIGNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgb3ZlcnJpZGVTaGFwZUEsIG92ZXJyaWRlU2hhcGVCKSB7CiAgICAgIGxldCBjOwoKICAgICAgaWYgKHRoaXMuY29udGFjdFBvaW50UG9vbC5sZW5ndGgpIHsKICAgICAgICBjID0gdGhpcy5jb250YWN0UG9pbnRQb29sLnBvcCgpOwogICAgICAgIGMuYmkgPSBiaTsKICAgICAgICBjLmJqID0gYmo7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYyA9IG5ldyBDb250YWN0RXF1YXRpb24oYmksIGJqKTsKICAgICAgfQoKICAgICAgYy5lbmFibGVkID0gYmkuY29sbGlzaW9uUmVzcG9uc2UgJiYgYmouY29sbGlzaW9uUmVzcG9uc2UgJiYgc2kuY29sbGlzaW9uUmVzcG9uc2UgJiYgc2ouY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIGNvbnN0IGNtID0gdGhpcy5jdXJyZW50Q29udGFjdE1hdGVyaWFsOwogICAgICBjLnJlc3RpdHV0aW9uID0gY20ucmVzdGl0dXRpb247CiAgICAgIGMuc2V0U3Bvb2tQYXJhbXMoY20uY29udGFjdEVxdWF0aW9uU3RpZmZuZXNzLCBjbS5jb250YWN0RXF1YXRpb25SZWxheGF0aW9uLCB0aGlzLndvcmxkLmR0KTsKICAgICAgY29uc3QgbWF0QSA9IHNpLm1hdGVyaWFsIHx8IGJpLm1hdGVyaWFsOwogICAgICBjb25zdCBtYXRCID0gc2oubWF0ZXJpYWwgfHwgYmoubWF0ZXJpYWw7CgogICAgICBpZiAobWF0QSAmJiBtYXRCICYmIG1hdEEucmVzdGl0dXRpb24gPj0gMCAmJiBtYXRCLnJlc3RpdHV0aW9uID49IDApIHsKICAgICAgICBjLnJlc3RpdHV0aW9uID0gbWF0QS5yZXN0aXR1dGlvbiAqIG1hdEIucmVzdGl0dXRpb247CiAgICAgIH0KCiAgICAgIGMuc2kgPSBvdmVycmlkZVNoYXBlQSB8fCBzaTsKICAgICAgYy5zaiA9IG92ZXJyaWRlU2hhcGVCIHx8IHNqOwogICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBjcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KGNvbnRhY3RFcXVhdGlvbiwgb3V0QXJyYXkpIHsKICAgICAgY29uc3QgYm9keUEgPSBjb250YWN0RXF1YXRpb24uYmk7CiAgICAgIGNvbnN0IGJvZHlCID0gY29udGFjdEVxdWF0aW9uLmJqOwogICAgICBjb25zdCBzaGFwZUEgPSBjb250YWN0RXF1YXRpb24uc2k7CiAgICAgIGNvbnN0IHNoYXBlQiA9IGNvbnRhY3RFcXVhdGlvbi5zajsKICAgICAgY29uc3Qgd29ybGQgPSB0aGlzLndvcmxkOwogICAgICBjb25zdCBjbSA9IHRoaXMuY3VycmVudENvbnRhY3RNYXRlcmlhbDsgLy8gSWYgZnJpY3Rpb24gb3IgcmVzdGl0dXRpb24gd2VyZSBzcGVjaWZpZWQgaW4gdGhlIG1hdGVyaWFsLCB1c2UgdGhlbQoKICAgICAgbGV0IGZyaWN0aW9uID0gY20uZnJpY3Rpb247CiAgICAgIGNvbnN0IG1hdEEgPSBzaGFwZUEubWF0ZXJpYWwgfHwgYm9keUEubWF0ZXJpYWw7CiAgICAgIGNvbnN0IG1hdEIgPSBzaGFwZUIubWF0ZXJpYWwgfHwgYm9keUIubWF0ZXJpYWw7CgogICAgICBpZiAobWF0QSAmJiBtYXRCICYmIG1hdEEuZnJpY3Rpb24gPj0gMCAmJiBtYXRCLmZyaWN0aW9uID49IDApIHsKICAgICAgICBmcmljdGlvbiA9IG1hdEEuZnJpY3Rpb24gKiBtYXRCLmZyaWN0aW9uOwogICAgICB9CgogICAgICBpZiAoZnJpY3Rpb24gPiAwKSB7CiAgICAgICAgLy8gQ3JlYXRlIDIgdGFuZ2VudCBlcXVhdGlvbnMKICAgICAgICBjb25zdCBtdWcgPSBmcmljdGlvbiAqIHdvcmxkLmdyYXZpdHkubGVuZ3RoKCk7CiAgICAgICAgbGV0IHJlZHVjZWRNYXNzID0gYm9keUEuaW52TWFzcyArIGJvZHlCLmludk1hc3M7CgogICAgICAgIGlmIChyZWR1Y2VkTWFzcyA+IDApIHsKICAgICAgICAgIHJlZHVjZWRNYXNzID0gMSAvIHJlZHVjZWRNYXNzOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgcG9vbCA9IHRoaXMuZnJpY3Rpb25FcXVhdGlvblBvb2w7CiAgICAgICAgY29uc3QgYzEgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihib2R5QSwgYm9keUIsIG11ZyAqIHJlZHVjZWRNYXNzKTsKICAgICAgICBjb25zdCBjMiA9IHBvb2wubGVuZ3RoID8gcG9vbC5wb3AoKSA6IG5ldyBGcmljdGlvbkVxdWF0aW9uKGJvZHlBLCBib2R5QiwgbXVnICogcmVkdWNlZE1hc3MpOwogICAgICAgIGMxLmJpID0gYzIuYmkgPSBib2R5QTsKICAgICAgICBjMS5iaiA9IGMyLmJqID0gYm9keUI7CiAgICAgICAgYzEubWluRm9yY2UgPSBjMi5taW5Gb3JjZSA9IC1tdWcgKiByZWR1Y2VkTWFzczsKICAgICAgICBjMS5tYXhGb3JjZSA9IGMyLm1heEZvcmNlID0gbXVnICogcmVkdWNlZE1hc3M7IC8vIENvcHkgb3ZlciB0aGUgcmVsYXRpdmUgdmVjdG9ycwoKICAgICAgICBjMS5yaS5jb3B5KGNvbnRhY3RFcXVhdGlvbi5yaSk7CiAgICAgICAgYzEucmouY29weShjb250YWN0RXF1YXRpb24ucmopOwogICAgICAgIGMyLnJpLmNvcHkoY29udGFjdEVxdWF0aW9uLnJpKTsKICAgICAgICBjMi5yai5jb3B5KGNvbnRhY3RFcXVhdGlvbi5yaik7IC8vIENvbnN0cnVjdCB0YW5nZW50cwoKICAgICAgICBjb250YWN0RXF1YXRpb24ubmkudGFuZ2VudHMoYzEudCwgYzIudCk7IC8vIFNldCBzcG9vayBwYXJhbXMKCiAgICAgICAgYzEuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIHdvcmxkLmR0KTsKICAgICAgICBjMi5zZXRTcG9va1BhcmFtcyhjbS5mcmljdGlvbkVxdWF0aW9uU3RpZmZuZXNzLCBjbS5mcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbiwgd29ybGQuZHQpOwogICAgICAgIGMxLmVuYWJsZWQgPSBjMi5lbmFibGVkID0gY29udGFjdEVxdWF0aW9uLmVuYWJsZWQ7CiAgICAgICAgb3V0QXJyYXkucHVzaChjMSwgYzIpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIFRha2UgdGhlIGF2ZXJhZ2UgTiBsYXRlc3QgY29udGFjdCBwb2ludCBvbiB0aGUgcGxhbmUuCiAgICAgKi8KCgogICAgY3JlYXRlRnJpY3Rpb25Gcm9tQXZlcmFnZShudW1Db250YWN0cykgewogICAgICAvLyBUaGUgbGFzdCBjb250YWN0RXF1YXRpb24KICAgICAgbGV0IGMgPSB0aGlzLnJlc3VsdFt0aGlzLnJlc3VsdC5sZW5ndGggLSAxXTsgLy8gQ3JlYXRlIHRoZSByZXN1bHQ6IHR3byAiYXZlcmFnZSIgZnJpY3Rpb24gZXF1YXRpb25zCgogICAgICBpZiAoIXRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChjLCB0aGlzLmZyaWN0aW9uUmVzdWx0KSB8fCBudW1Db250YWN0cyA9PT0gMSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgZjEgPSB0aGlzLmZyaWN0aW9uUmVzdWx0W3RoaXMuZnJpY3Rpb25SZXN1bHQubGVuZ3RoIC0gMl07CiAgICAgIGNvbnN0IGYyID0gdGhpcy5mcmljdGlvblJlc3VsdFt0aGlzLmZyaWN0aW9uUmVzdWx0Lmxlbmd0aCAtIDFdOwogICAgICBhdmVyYWdlTm9ybWFsLnNldFplcm8oKTsKICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEEuc2V0WmVybygpOwogICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi5zZXRaZXJvKCk7CiAgICAgIGNvbnN0IGJvZHlBID0gYy5iaTsKICAgICAgYy5iajsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBudW1Db250YWN0czsgaSsrKSB7CiAgICAgICAgYyA9IHRoaXMucmVzdWx0W3RoaXMucmVzdWx0Lmxlbmd0aCAtIDEgLSBpXTsKCiAgICAgICAgaWYgKGMuYmkgIT09IGJvZHlBKSB7CiAgICAgICAgICBhdmVyYWdlTm9ybWFsLnZhZGQoYy5uaSwgYXZlcmFnZU5vcm1hbCk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50QS52YWRkKGMucmksIGF2ZXJhZ2VDb250YWN0UG9pbnRBKTsKICAgICAgICAgIGF2ZXJhZ2VDb250YWN0UG9pbnRCLnZhZGQoYy5yaiwgYXZlcmFnZUNvbnRhY3RQb2ludEIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhdmVyYWdlTm9ybWFsLnZzdWIoYy5uaSwgYXZlcmFnZU5vcm1hbCk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50QS52YWRkKGMucmosIGF2ZXJhZ2VDb250YWN0UG9pbnRBKTsKICAgICAgICAgIGF2ZXJhZ2VDb250YWN0UG9pbnRCLnZhZGQoYy5yaSwgYXZlcmFnZUNvbnRhY3RQb2ludEIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3QgaW52TnVtQ29udGFjdHMgPSAxIC8gbnVtQ29udGFjdHM7CiAgICAgIGF2ZXJhZ2VDb250YWN0UG9pbnRBLnNjYWxlKGludk51bUNvbnRhY3RzLCBmMS5yaSk7CiAgICAgIGF2ZXJhZ2VDb250YWN0UG9pbnRCLnNjYWxlKGludk51bUNvbnRhY3RzLCBmMS5yaik7CiAgICAgIGYyLnJpLmNvcHkoZjEucmkpOyAvLyBTaG91bGQgYmUgdGhlIHNhbWUKCiAgICAgIGYyLnJqLmNvcHkoZjEucmopOwogICAgICBhdmVyYWdlTm9ybWFsLm5vcm1hbGl6ZSgpOwogICAgICBhdmVyYWdlTm9ybWFsLnRhbmdlbnRzKGYxLnQsIGYyLnQpOyAvLyByZXR1cm4gZXE7CiAgICB9CiAgICAvKioKICAgICAqIEdlbmVyYXRlIGFsbCBjb250YWN0cyBiZXR3ZWVuIGEgbGlzdCBvZiBib2R5IHBhaXJzCiAgICAgKiBAcGFyYW0gcDEgQXJyYXkgb2YgYm9keSBpbmRpY2VzCiAgICAgKiBAcGFyYW0gcDIgQXJyYXkgb2YgYm9keSBpbmRpY2VzCiAgICAgKiBAcGFyYW0gcmVzdWx0IEFycmF5IHRvIHN0b3JlIGdlbmVyYXRlZCBjb250YWN0cwogICAgICogQHBhcmFtIG9sZGNvbnRhY3RzIE9wdGlvbmFsLiBBcnJheSBvZiByZXVzYWJsZSBjb250YWN0IG9iamVjdHMKICAgICAqLwoKCiAgICBnZXRDb250YWN0cyhwMSwgcDIsIHdvcmxkLCByZXN1bHQsIG9sZGNvbnRhY3RzLCBmcmljdGlvblJlc3VsdCwgZnJpY3Rpb25Qb29sKSB7CiAgICAgIC8vIFNhdmUgb2xkIGNvbnRhY3Qgb2JqZWN0cwogICAgICB0aGlzLmNvbnRhY3RQb2ludFBvb2wgPSBvbGRjb250YWN0czsKICAgICAgdGhpcy5mcmljdGlvbkVxdWF0aW9uUG9vbCA9IGZyaWN0aW9uUG9vbDsKICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgIHRoaXMuZnJpY3Rpb25SZXN1bHQgPSBmcmljdGlvblJlc3VsdDsKICAgICAgY29uc3QgcWkgPSB0bXBRdWF0MTsKICAgICAgY29uc3QgcWogPSB0bXBRdWF0MjsKICAgICAgY29uc3QgeGkgPSB0bXBWZWMxOwogICAgICBjb25zdCB4aiA9IHRtcFZlYzI7CgogICAgICBmb3IgKGxldCBrID0gMCwgTiA9IHAxLmxlbmd0aDsgayAhPT0gTjsgaysrKSB7CiAgICAgICAgLy8gR2V0IGN1cnJlbnQgY29sbGlzaW9uIGJvZGllcwogICAgICAgIGNvbnN0IGJpID0gcDFba107CiAgICAgICAgY29uc3QgYmogPSBwMltrXTsgLy8gR2V0IGNvbnRhY3QgbWF0ZXJpYWwKCiAgICAgICAgbGV0IGJvZHlDb250YWN0TWF0ZXJpYWwgPSBudWxsOwoKICAgICAgICBpZiAoYmkubWF0ZXJpYWwgJiYgYmoubWF0ZXJpYWwpIHsKICAgICAgICAgIGJvZHlDb250YWN0TWF0ZXJpYWwgPSB3b3JsZC5nZXRDb250YWN0TWF0ZXJpYWwoYmkubWF0ZXJpYWwsIGJqLm1hdGVyaWFsKSB8fCBudWxsOwogICAgICAgIH0KCiAgICAgICAgY29uc3QganVzdFRlc3QgPSBiaS50eXBlICYgQm9keS5LSU5FTUFUSUMgJiYgYmoudHlwZSAmIEJvZHkuU1RBVElDIHx8IGJpLnR5cGUgJiBCb2R5LlNUQVRJQyAmJiBiai50eXBlICYgQm9keS5LSU5FTUFUSUMgfHwgYmkudHlwZSAmIEJvZHkuS0lORU1BVElDICYmIGJqLnR5cGUgJiBCb2R5LktJTkVNQVRJQzsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaS5zaGFwZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGJpLnF1YXRlcm5pb24ubXVsdChiaS5zaGFwZU9yaWVudGF0aW9uc1tpXSwgcWkpOwogICAgICAgICAgYmkucXVhdGVybmlvbi52bXVsdChiaS5zaGFwZU9mZnNldHNbaV0sIHhpKTsKICAgICAgICAgIHhpLnZhZGQoYmkucG9zaXRpb24sIHhpKTsKICAgICAgICAgIGNvbnN0IHNpID0gYmkuc2hhcGVzW2ldOwoKICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgYmouc2hhcGVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIC8vIENvbXB1dGUgd29ybGQgdHJhbnNmb3JtIG9mIHNoYXBlcwogICAgICAgICAgICBiai5xdWF0ZXJuaW9uLm11bHQoYmouc2hhcGVPcmllbnRhdGlvbnNbal0sIHFqKTsKICAgICAgICAgICAgYmoucXVhdGVybmlvbi52bXVsdChiai5zaGFwZU9mZnNldHNbal0sIHhqKTsKICAgICAgICAgICAgeGoudmFkZChiai5wb3NpdGlvbiwgeGopOwogICAgICAgICAgICBjb25zdCBzaiA9IGJqLnNoYXBlc1tqXTsKCiAgICAgICAgICAgIGlmICghKHNpLmNvbGxpc2lvbkZpbHRlck1hc2sgJiBzai5jb2xsaXNpb25GaWx0ZXJHcm91cCAmJiBzai5jb2xsaXNpb25GaWx0ZXJNYXNrICYgc2kuY29sbGlzaW9uRmlsdGVyR3JvdXApKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh4aS5kaXN0YW5jZVRvKHhqKSA+IHNpLmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgc2ouYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfSAvLyBHZXQgY29sbGlzaW9uIG1hdGVyaWFsCgoKICAgICAgICAgICAgbGV0IHNoYXBlQ29udGFjdE1hdGVyaWFsID0gbnVsbDsKCiAgICAgICAgICAgIGlmIChzaS5tYXRlcmlhbCAmJiBzai5tYXRlcmlhbCkgewogICAgICAgICAgICAgIHNoYXBlQ29udGFjdE1hdGVyaWFsID0gd29ybGQuZ2V0Q29udGFjdE1hdGVyaWFsKHNpLm1hdGVyaWFsLCBzai5tYXRlcmlhbCkgfHwgbnVsbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy5jdXJyZW50Q29udGFjdE1hdGVyaWFsID0gc2hhcGVDb250YWN0TWF0ZXJpYWwgfHwgYm9keUNvbnRhY3RNYXRlcmlhbCB8fCB3b3JsZC5kZWZhdWx0Q29udGFjdE1hdGVyaWFsOyAvLyBHZXQgY29udGFjdHMKCiAgICAgICAgICAgIGNvbnN0IHJlc29sdmVySW5kZXggPSBzaS50eXBlIHwgc2oudHlwZTsKICAgICAgICAgICAgY29uc3QgcmVzb2x2ZXIgPSB0aGlzW3Jlc29sdmVySW5kZXhdOwoKICAgICAgICAgICAgaWYgKHJlc29sdmVyKSB7CiAgICAgICAgICAgICAgbGV0IHJldHZhbCA9IGZhbHNlOyAvLyBUTyBETzogaW52ZXN0aWdhdGUgd2h5IHNwaGVyZVBhcnRpY2xlIGFuZCBjb252ZXhQYXJ0aWNsZQogICAgICAgICAgICAgIC8vIHJlc29sdmVycyBleHBlY3Qgc2kgYW5kIHNqIHNoYXBlcyB0byBiZSBpbiByZXZlcnNlIG9yZGVyCiAgICAgICAgICAgICAgLy8gKGkuZS4gbGFyZ2VyIGludGVnZXIgdmFsdWUgdHlwZSBmaXJzdCBpbnN0ZWFkIG9mIHNtYWxsZXIgZmlyc3QpCgogICAgICAgICAgICAgIGlmIChzaS50eXBlIDwgc2oudHlwZSkgewogICAgICAgICAgICAgICAgcmV0dmFsID0gcmVzb2x2ZXIuY2FsbCh0aGlzLCBzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHNpLCBzaiwganVzdFRlc3QpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR2YWwgPSByZXNvbHZlci5jYWxsKHRoaXMsIHNqLCBzaSwgeGosIHhpLCBxaiwgcWksIGJqLCBiaSwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAocmV0dmFsICYmIGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICAvLyBSZWdpc3RlciBvdmVybGFwCiAgICAgICAgICAgICAgICB3b3JsZC5zaGFwZU92ZXJsYXBLZWVwZXIuc2V0KHNpLmlkLCBzai5pZCk7CiAgICAgICAgICAgICAgICB3b3JsZC5ib2R5T3ZlcmxhcEtlZXBlci5zZXQoYmkuaWQsIGJqLmlkKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzcGhlcmVTcGhlcmUoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgcmV0dXJuIHhpLmRpc3RhbmNlU3F1YXJlZCh4aikgPCAoc2kucmFkaXVzICsgc2oucmFkaXVzKSAqKiAyOwogICAgICB9IC8vIFdlIHdpbGwgaGF2ZSBvbmx5IG9uZSBjb250YWN0IGluIHRoaXMgY2FzZQoKCiAgICAgIGNvbnN0IGNvbnRhY3RFcSA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7IC8vIENvbnRhY3Qgbm9ybWFsCgogICAgICB4ai52c3ViKHhpLCBjb250YWN0RXEubmkpOwogICAgICBjb250YWN0RXEubmkubm9ybWFsaXplKCk7IC8vIENvbnRhY3QgcG9pbnQgbG9jYXRpb25zCgogICAgICBjb250YWN0RXEucmkuY29weShjb250YWN0RXEubmkpOwogICAgICBjb250YWN0RXEucmouY29weShjb250YWN0RXEubmkpOwogICAgICBjb250YWN0RXEucmkuc2NhbGUoc2kucmFkaXVzLCBjb250YWN0RXEucmkpOwogICAgICBjb250YWN0RXEucmouc2NhbGUoLXNqLnJhZGl1cywgY29udGFjdEVxLnJqKTsKICAgICAgY29udGFjdEVxLnJpLnZhZGQoeGksIGNvbnRhY3RFcS5yaSk7CiAgICAgIGNvbnRhY3RFcS5yaS52c3ViKGJpLnBvc2l0aW9uLCBjb250YWN0RXEucmkpOwogICAgICBjb250YWN0RXEucmoudmFkZCh4aiwgY29udGFjdEVxLnJqKTsKICAgICAgY29udGFjdEVxLnJqLnZzdWIoYmoucG9zaXRpb24sIGNvbnRhY3RFcS5yaik7CiAgICAgIHRoaXMucmVzdWx0LnB1c2goY29udGFjdEVxKTsKICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KGNvbnRhY3RFcSwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICB9CgogICAgc3BoZXJlUGxhbmUoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgLy8gV2Ugd2lsbCBoYXZlIG9uZSBjb250YWN0IGluIHRoaXMgY2FzZQogICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsgLy8gQ29udGFjdCBub3JtYWwKCiAgICAgIHIubmkuc2V0KDAsIDAsIDEpOwogICAgICBxai52bXVsdChyLm5pLCByLm5pKTsKICAgICAgci5uaS5uZWdhdGUoci5uaSk7IC8vIGJvZHkgaSBpcyB0aGUgc3BoZXJlLCBmbGlwIG5vcm1hbAoKICAgICAgci5uaS5ub3JtYWxpemUoKTsgLy8gTmVlZGVkPwogICAgICAvLyBWZWN0b3IgZnJvbSBzcGhlcmUgY2VudGVyIHRvIGNvbnRhY3QgcG9pbnQKCiAgICAgIHIubmkuc2NhbGUoc2kucmFkaXVzLCByLnJpKTsgLy8gUHJvamVjdCBkb3duIHNwaGVyZSBvbiBwbGFuZQoKICAgICAgeGkudnN1Yih4aiwgcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlKTsKICAgICAgci5uaS5zY2FsZShyLm5pLmRvdChwb2ludF9vbl9wbGFuZV90b19zcGhlcmUpLCBwbGFuZV90b19zcGhlcmVfb3J0aG8pOwogICAgICBwb2ludF9vbl9wbGFuZV90b19zcGhlcmUudnN1YihwbGFuZV90b19zcGhlcmVfb3J0aG8sIHIucmopOyAvLyBUaGUgc3BoZXJlIHBvc2l0aW9uIHByb2plY3RlZCB0byBwbGFuZQoKICAgICAgaWYgKC1wb2ludF9vbl9wbGFuZV90b19zcGhlcmUuZG90KHIubmkpIDw9IHNpLnJhZGl1cykgewogICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSAvLyBNYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSBib2R5CgoKICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgY29uc3QgcmogPSByLnJqOwogICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgICAgICByaS52c3ViKGJpLnBvc2l0aW9uLCByaSk7CiAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgfQogICAgfQoKICAgIGJveEJveChzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24ubWF0ZXJpYWwgPSBzaS5tYXRlcmlhbDsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2oubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICBzai5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uY29sbGlzaW9uUmVzcG9uc2UgPSBzai5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4Q29udmV4KHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbiwgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBzcGhlcmVCb3goc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgY29uc3QgdjNwb29sID0gdGhpcy52M3Bvb2w7IC8vIHdlIHJlZmVyIHRvIHRoZSBib3ggYXMgYm9keSBqCgogICAgICBjb25zdCBzaWRlcyA9IHNwaGVyZUJveF9zaWRlczsKICAgICAgeGkudnN1Yih4aiwgYm94X3RvX3NwaGVyZSk7CiAgICAgIHNqLmdldFNpZGVOb3JtYWxzKHNpZGVzLCBxaik7CiAgICAgIGNvbnN0IFIgPSBzaS5yYWRpdXM7CiAgICAgIGxldCBmb3VuZCA9IGZhbHNlOyAvLyBTdG9yZSB0aGUgcmVzdWx0aW5nIHNpZGUgcGVuZXRyYXRpb24gaW5mbwoKICAgICAgY29uc3Qgc2lkZV9ucyA9IHNwaGVyZUJveF9zaWRlX25zOwogICAgICBjb25zdCBzaWRlX25zMSA9IHNwaGVyZUJveF9zaWRlX25zMTsKICAgICAgY29uc3Qgc2lkZV9uczIgPSBzcGhlcmVCb3hfc2lkZV9uczI7CiAgICAgIGxldCBzaWRlX2ggPSBudWxsOwogICAgICBsZXQgc2lkZV9wZW5ldHJhdGlvbnMgPSAwOwogICAgICBsZXQgc2lkZV9kb3QxID0gMDsKICAgICAgbGV0IHNpZGVfZG90MiA9IDA7CiAgICAgIGxldCBzaWRlX2Rpc3RhbmNlID0gbnVsbDsKCiAgICAgIGZvciAobGV0IGlkeCA9IDAsIG5zaWRlcyA9IHNpZGVzLmxlbmd0aDsgaWR4ICE9PSBuc2lkZXMgJiYgZm91bmQgPT09IGZhbHNlOyBpZHgrKykgewogICAgICAgIC8vIEdldCB0aGUgcGxhbmUgc2lkZSBub3JtYWwgKG5zKQogICAgICAgIGNvbnN0IG5zID0gc3BoZXJlQm94X25zOwogICAgICAgIG5zLmNvcHkoc2lkZXNbaWR4XSk7CiAgICAgICAgY29uc3QgaCA9IG5zLmxlbmd0aCgpOwogICAgICAgIG5zLm5vcm1hbGl6ZSgpOyAvLyBUaGUgbm9ybWFsL2Rpc3RhbmNlIGRvdCBwcm9kdWN0IHRlbGxzIHdoaWNoIHNpZGUgb2YgdGhlIHBsYW5lIHdlIGFyZQoKICAgICAgICBjb25zdCBkb3QgPSBib3hfdG9fc3BoZXJlLmRvdChucyk7CgogICAgICAgIGlmIChkb3QgPCBoICsgUiAmJiBkb3QgPiAwKSB7CiAgICAgICAgICAvLyBJbnRlcnNlY3RzIHBsYW5lLiBOb3cgY2hlY2sgdGhlIG90aGVyIHR3byBkaW1lbnNpb25zCiAgICAgICAgICBjb25zdCBuczEgPSBzcGhlcmVCb3hfbnMxOwogICAgICAgICAgY29uc3QgbnMyID0gc3BoZXJlQm94X25zMjsKICAgICAgICAgIG5zMS5jb3B5KHNpZGVzWyhpZHggKyAxKSAlIDNdKTsKICAgICAgICAgIG5zMi5jb3B5KHNpZGVzWyhpZHggKyAyKSAlIDNdKTsKICAgICAgICAgIGNvbnN0IGgxID0gbnMxLmxlbmd0aCgpOwogICAgICAgICAgY29uc3QgaDIgPSBuczIubGVuZ3RoKCk7CiAgICAgICAgICBuczEubm9ybWFsaXplKCk7CiAgICAgICAgICBuczIubm9ybWFsaXplKCk7CiAgICAgICAgICBjb25zdCBkb3QxID0gYm94X3RvX3NwaGVyZS5kb3QobnMxKTsKICAgICAgICAgIGNvbnN0IGRvdDIgPSBib3hfdG9fc3BoZXJlLmRvdChuczIpOwoKICAgICAgICAgIGlmIChkb3QxIDwgaDEgJiYgZG90MSA+IC1oMSAmJiBkb3QyIDwgaDIgJiYgZG90MiA+IC1oMikgewogICAgICAgICAgICBjb25zdCBkaXN0ID0gTWF0aC5hYnMoZG90IC0gaCAtIFIpOwoKICAgICAgICAgICAgaWYgKHNpZGVfZGlzdGFuY2UgPT09IG51bGwgfHwgZGlzdCA8IHNpZGVfZGlzdGFuY2UpIHsKICAgICAgICAgICAgICBzaWRlX2Rpc3RhbmNlID0gZGlzdDsKICAgICAgICAgICAgICBzaWRlX2RvdDEgPSBkb3QxOwogICAgICAgICAgICAgIHNpZGVfZG90MiA9IGRvdDI7CiAgICAgICAgICAgICAgc2lkZV9oID0gaDsKICAgICAgICAgICAgICBzaWRlX25zLmNvcHkobnMpOwogICAgICAgICAgICAgIHNpZGVfbnMxLmNvcHkobnMxKTsKICAgICAgICAgICAgICBzaWRlX25zMi5jb3B5KG5zMik7CiAgICAgICAgICAgICAgc2lkZV9wZW5ldHJhdGlvbnMrKzsKCiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChzaWRlX3BlbmV0cmF0aW9ucykgewogICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICBzaWRlX25zLnNjYWxlKC1SLCByLnJpKTsgLy8gU3BoZXJlIHIKCiAgICAgICAgci5uaS5jb3B5KHNpZGVfbnMpOwogICAgICAgIHIubmkubmVnYXRlKHIubmkpOyAvLyBOb3JtYWwgc2hvdWxkIGJlIG91dCBvZiBzcGhlcmUKCiAgICAgICAgc2lkZV9ucy5zY2FsZShzaWRlX2gsIHNpZGVfbnMpOwogICAgICAgIHNpZGVfbnMxLnNjYWxlKHNpZGVfZG90MSwgc2lkZV9uczEpOwogICAgICAgIHNpZGVfbnMudmFkZChzaWRlX25zMSwgc2lkZV9ucyk7CiAgICAgICAgc2lkZV9uczIuc2NhbGUoc2lkZV9kb3QyLCBzaWRlX25zMik7CiAgICAgICAgc2lkZV9ucy52YWRkKHNpZGVfbnMyLCByLnJqKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgci5yaS52YWRkKHhpLCByLnJpKTsKICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgIHIucmoudmFkZCh4aiwgci5yaik7CiAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsKICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgfSAvLyBDaGVjayBjb3JuZXJzCgoKICAgICAgbGV0IHJqID0gdjNwb29sLmdldCgpOwogICAgICBjb25zdCBzcGhlcmVfdG9fY29ybmVyID0gc3BoZXJlQm94X3NwaGVyZV90b19jb3JuZXI7CgogICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gMiAmJiAhZm91bmQ7IGorKykgewogICAgICAgIGZvciAobGV0IGsgPSAwOyBrICE9PSAyICYmICFmb3VuZDsgaysrKSB7CiAgICAgICAgICBmb3IgKGxldCBsID0gMDsgbCAhPT0gMiAmJiAhZm91bmQ7IGwrKykgewogICAgICAgICAgICByai5zZXQoMCwgMCwgMCk7CgogICAgICAgICAgICBpZiAoaikgewogICAgICAgICAgICAgIHJqLnZhZGQoc2lkZXNbMF0sIHJqKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByai52c3ViKHNpZGVzWzBdLCByaik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChrKSB7CiAgICAgICAgICAgICAgcmoudmFkZChzaWRlc1sxXSwgcmopOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJqLnZzdWIoc2lkZXNbMV0sIHJqKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGwpIHsKICAgICAgICAgICAgICByai52YWRkKHNpZGVzWzJdLCByaik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmoudnN1YihzaWRlc1syXSwgcmopOwogICAgICAgICAgICB9IC8vIFdvcmxkIHBvc2l0aW9uIG9mIGNvcm5lcgoKCiAgICAgICAgICAgIHhqLnZhZGQocmosIHNwaGVyZV90b19jb3JuZXIpOwogICAgICAgICAgICBzcGhlcmVfdG9fY29ybmVyLnZzdWIoeGksIHNwaGVyZV90b19jb3JuZXIpOwoKICAgICAgICAgICAgaWYgKHNwaGVyZV90b19jb3JuZXIubGVuZ3RoU3F1YXJlZCgpIDwgUiAqIFIpIHsKICAgICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgICAgIHIucmkuY29weShzcGhlcmVfdG9fY29ybmVyKTsKICAgICAgICAgICAgICByLnJpLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICAgIHIubmkuY29weShyLnJpKTsKICAgICAgICAgICAgICByLnJpLnNjYWxlKFIsIHIucmkpOwogICAgICAgICAgICAgIHIucmouY29weShyaik7IC8vIE1ha2UgcmVsYXRpdmUgdG8gYm9kaWVzCgogICAgICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICAgICAgci5yaS52c3ViKGJpLnBvc2l0aW9uLCByLnJpKTsKICAgICAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgICAgIHIucmoudnN1Yihiai5wb3NpdGlvbiwgci5yaik7CiAgICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHYzcG9vbC5yZWxlYXNlKHJqKTsKICAgICAgcmogPSBudWxsOyAvLyBDaGVjayBlZGdlcwoKICAgICAgY29uc3QgZWRnZVRhbmdlbnQgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IGVkZ2VDZW50ZXIgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IHIgPSB2M3Bvb2wuZ2V0KCk7IC8vIHIgPSBlZGdlIGNlbnRlciB0byBzcGhlcmUgY2VudGVyCgogICAgICBjb25zdCBvcnRob2dvbmFsID0gdjNwb29sLmdldCgpOwogICAgICBjb25zdCBkaXN0ID0gdjNwb29sLmdldCgpOwogICAgICBjb25zdCBOc2lkZXMgPSBzaWRlcy5sZW5ndGg7CgogICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gTnNpZGVzICYmICFmb3VuZDsgaisrKSB7CiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgIT09IE5zaWRlcyAmJiAhZm91bmQ7IGsrKykgewogICAgICAgICAgaWYgKGogJSAzICE9PSBrICUgMykgewogICAgICAgICAgICAvLyBHZXQgZWRnZSB0YW5nZW50CiAgICAgICAgICAgIHNpZGVzW2tdLmNyb3NzKHNpZGVzW2pdLCBlZGdlVGFuZ2VudCk7CiAgICAgICAgICAgIGVkZ2VUYW5nZW50Lm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBzaWRlc1tqXS52YWRkKHNpZGVzW2tdLCBlZGdlQ2VudGVyKTsKICAgICAgICAgICAgci5jb3B5KHhpKTsKICAgICAgICAgICAgci52c3ViKGVkZ2VDZW50ZXIsIHIpOwogICAgICAgICAgICByLnZzdWIoeGosIHIpOwogICAgICAgICAgICBjb25zdCBvcnRob25vcm0gPSByLmRvdChlZGdlVGFuZ2VudCk7IC8vIGRpc3RhbmNlIGZyb20gZWRnZSBjZW50ZXIgdG8gc3BoZXJlIGNlbnRlciBpbiB0aGUgdGFuZ2VudCBkaXJlY3Rpb24KCiAgICAgICAgICAgIGVkZ2VUYW5nZW50LnNjYWxlKG9ydGhvbm9ybSwgb3J0aG9nb25hbCk7IC8vIFZlY3RvciBmcm9tIGVkZ2UgY2VudGVyIHRvIHNwaGVyZSBjZW50ZXIgaW4gdGhlIHRhbmdlbnQgZGlyZWN0aW9uCiAgICAgICAgICAgIC8vIEZpbmQgdGhlIHRoaXJkIHNpZGUgb3J0aG9nb25hbCB0byB0aGlzIG9uZQoKICAgICAgICAgICAgbGV0IGwgPSAwOwoKICAgICAgICAgICAgd2hpbGUgKGwgPT09IGogJSAzIHx8IGwgPT09IGsgJSAzKSB7CiAgICAgICAgICAgICAgbCsrOwogICAgICAgICAgICB9IC8vIHZlYyBmcm9tIGVkZ2UgY2VudGVyIHRvIHNwaGVyZSBwcm9qZWN0ZWQgdG8gdGhlIHBsYW5lIG9ydGhvZ29uYWwgdG8gdGhlIGVkZ2UgdGFuZ2VudAoKCiAgICAgICAgICAgIGRpc3QuY29weSh4aSk7CiAgICAgICAgICAgIGRpc3QudnN1YihvcnRob2dvbmFsLCBkaXN0KTsKICAgICAgICAgICAgZGlzdC52c3ViKGVkZ2VDZW50ZXIsIGRpc3QpOwogICAgICAgICAgICBkaXN0LnZzdWIoeGosIGRpc3QpOyAvLyBEaXN0YW5jZXMgaW4gdGFuZ2VudCBkaXJlY3Rpb24gYW5kIGRpc3RhbmNlIGluIHRoZSBwbGFuZSBvcnRob2dvbmFsIHRvIGl0CgogICAgICAgICAgICBjb25zdCB0ZGlzdCA9IE1hdGguYWJzKG9ydGhvbm9ybSk7CiAgICAgICAgICAgIGNvbnN0IG5kaXN0ID0gZGlzdC5sZW5ndGgoKTsKCiAgICAgICAgICAgIGlmICh0ZGlzdCA8IHNpZGVzW2xdLmxlbmd0aCgpICYmIG5kaXN0IDwgUikgewogICAgICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgY29uc3QgcmVzID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICAgICAgICBlZGdlQ2VudGVyLnZhZGQob3J0aG9nb25hbCwgcmVzLnJqKTsgLy8gYm94IHJqCgogICAgICAgICAgICAgIHJlcy5yai5jb3B5KHJlcy5yaik7CiAgICAgICAgICAgICAgZGlzdC5uZWdhdGUocmVzLm5pKTsKICAgICAgICAgICAgICByZXMubmkubm9ybWFsaXplKCk7CiAgICAgICAgICAgICAgcmVzLnJpLmNvcHkocmVzLnJqKTsKICAgICAgICAgICAgICByZXMucmkudmFkZCh4aiwgcmVzLnJpKTsKICAgICAgICAgICAgICByZXMucmkudnN1Yih4aSwgcmVzLnJpKTsKICAgICAgICAgICAgICByZXMucmkubm9ybWFsaXplKCk7CiAgICAgICAgICAgICAgcmVzLnJpLnNjYWxlKFIsIHJlcy5yaSk7IC8vIE1ha2UgcmVsYXRpdmUgdG8gYm9kaWVzCgogICAgICAgICAgICAgIHJlcy5yaS52YWRkKHhpLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yaS52c3ViKGJpLnBvc2l0aW9uLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yai52YWRkKHhqLCByZXMucmopOwogICAgICAgICAgICAgIHJlcy5yai52c3ViKGJqLnBvc2l0aW9uLCByZXMucmopOwogICAgICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocmVzKTsKICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QocmVzLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdjNwb29sLnJlbGVhc2UoZWRnZVRhbmdlbnQsIGVkZ2VDZW50ZXIsIHIsIG9ydGhvZ29uYWwsIGRpc3QpOwogICAgfQoKICAgIHBsYW5lQm94KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5tYXRlcmlhbCA9IHNqLm1hdGVyaWFsOwogICAgICBzai5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uY29sbGlzaW9uUmVzcG9uc2UgPSBzai5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLmlkID0gc2ouaWQ7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lQ29udmV4KHNpLCBzai5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHNpLCBzaiwganVzdFRlc3QpOwogICAgfQoKICAgIGNvbnZleENvbnZleChzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCwgZmFjZUxpc3RBLCBmYWNlTGlzdEIpIHsKICAgICAgY29uc3Qgc2VwQXhpcyA9IGNvbnZleENvbnZleF9zZXBBeGlzOwoKICAgICAgaWYgKHhpLmRpc3RhbmNlVG8oeGopID4gc2kuYm91bmRpbmdTcGhlcmVSYWRpdXMgKyBzai5ib3VuZGluZ1NwaGVyZVJhZGl1cykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHNpLmZpbmRTZXBhcmF0aW5nQXhpcyhzaiwgeGksIHFpLCB4aiwgcWosIHNlcEF4aXMsIGZhY2VMaXN0QSwgZmFjZUxpc3RCKSkgewogICAgICAgIGNvbnN0IHJlcyA9IFtdOwogICAgICAgIGNvbnN0IHEgPSBjb252ZXhDb252ZXhfcTsKICAgICAgICBzaS5jbGlwQWdhaW5zdEh1bGwoeGksIHFpLCBzaiwgeGosIHFqLCBzZXBBeGlzLCAtMTAwLCAxMDAsIHJlcyk7CiAgICAgICAgbGV0IG51bUNvbnRhY3RzID0gMDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IHJlcy5sZW5ndGg7IGorKykgewogICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgY29uc3QgcmkgPSByLnJpOwogICAgICAgICAgY29uc3QgcmogPSByLnJqOwogICAgICAgICAgc2VwQXhpcy5uZWdhdGUoci5uaSk7CiAgICAgICAgICByZXNbal0ubm9ybWFsLm5lZ2F0ZShxKTsKICAgICAgICAgIHEuc2NhbGUocmVzW2pdLmRlcHRoLCBxKTsKICAgICAgICAgIHJlc1tqXS5wb2ludC52YWRkKHEsIHJpKTsKICAgICAgICAgIHJqLmNvcHkocmVzW2pdLnBvaW50KTsgLy8gQ29udGFjdCBwb2ludHMgYXJlIGluIHdvcmxkIGNvb3JkaW5hdGVzLiBUcmFuc2Zvcm0gYmFjayB0byByZWxhdGl2ZQoKICAgICAgICAgIHJpLnZzdWIoeGksIHJpKTsKICAgICAgICAgIHJqLnZzdWIoeGosIHJqKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgICByaS52YWRkKHhpLCByaSk7CiAgICAgICAgICByaS52c3ViKGJpLnBvc2l0aW9uLCByaSk7CiAgICAgICAgICByai52YWRkKHhqLCByaik7CiAgICAgICAgICByai52c3ViKGJqLnBvc2l0aW9uLCByaik7CiAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgbnVtQ29udGFjdHMrKzsKCiAgICAgICAgICBpZiAoIXRoaXMuZW5hYmxlRnJpY3Rpb25SZWR1Y3Rpb24pIHsKICAgICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuZW5hYmxlRnJpY3Rpb25SZWR1Y3Rpb24gJiYgbnVtQ29udGFjdHMpIHsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25Gcm9tQXZlcmFnZShudW1Db250YWN0cyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgc3BoZXJlQ29udmV4KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IHYzcG9vbCA9IHRoaXMudjNwb29sOwogICAgICB4aS52c3ViKHhqLCBjb252ZXhfdG9fc3BoZXJlKTsKICAgICAgY29uc3Qgbm9ybWFscyA9IHNqLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBmYWNlcyA9IHNqLmZhY2VzOwogICAgICBjb25zdCB2ZXJ0cyA9IHNqLnZlcnRpY2VzOwogICAgICBjb25zdCBSID0gc2kucmFkaXVzOyAvLyAgICAgcmV0dXJuOwogICAgICAvLyB9CgogICAgICBsZXQgZm91bmQgPSBmYWxzZTsgLy8gQ2hlY2sgY29ybmVycwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IHZlcnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgdiA9IHZlcnRzW2ldOyAvLyBXb3JsZCBwb3NpdGlvbiBvZiBjb3JuZXIKCiAgICAgICAgY29uc3Qgd29ybGRDb3JuZXIgPSBzcGhlcmVDb252ZXhfd29ybGRDb3JuZXI7CiAgICAgICAgcWoudm11bHQodiwgd29ybGRDb3JuZXIpOwogICAgICAgIHhqLnZhZGQod29ybGRDb3JuZXIsIHdvcmxkQ29ybmVyKTsKICAgICAgICBjb25zdCBzcGhlcmVfdG9fY29ybmVyID0gc3BoZXJlQ29udmV4X3NwaGVyZVRvQ29ybmVyOwogICAgICAgIHdvcmxkQ29ybmVyLnZzdWIoeGksIHNwaGVyZV90b19jb3JuZXIpOwoKICAgICAgICBpZiAoc3BoZXJlX3RvX2Nvcm5lci5sZW5ndGhTcXVhcmVkKCkgPCBSICogUikgewogICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgci5yaS5jb3B5KHNwaGVyZV90b19jb3JuZXIpOwogICAgICAgICAgci5yaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHIubmkuY29weShyLnJpKTsKICAgICAgICAgIHIucmkuc2NhbGUoUiwgci5yaSk7CiAgICAgICAgICB3b3JsZENvcm5lci52c3ViKHhqLCByLnJqKTsgLy8gU2hvdWxkIGJlIHJlbGF0aXZlIHRvIHRoZSBib2R5LgoKICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOyAvLyBTaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJvZHkuCgogICAgICAgICAgci5yai52YWRkKHhqLCByLnJqKTsKICAgICAgICAgIHIucmoudnN1Yihiai5wb3NpdGlvbiwgci5yaik7CiAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfSAvLyBDaGVjayBzaWRlIChwbGFuZSkgaW50ZXJzZWN0aW9ucwoKCiAgICAgIGZvciAobGV0IGkgPSAwLCBuZmFjZXMgPSBmYWNlcy5sZW5ndGg7IGkgIT09IG5mYWNlcyAmJiBmb3VuZCA9PT0gZmFsc2U7IGkrKykgewogICAgICAgIGNvbnN0IG5vcm1hbCA9IG5vcm1hbHNbaV07CiAgICAgICAgY29uc3QgZmFjZSA9IGZhY2VzW2ldOyAvLyBHZXQgd29ybGQtdHJhbnNmb3JtZWQgbm9ybWFsIG9mIHRoZSBmYWNlCgogICAgICAgIGNvbnN0IHdvcmxkTm9ybWFsID0gc3BoZXJlQ29udmV4X3dvcmxkTm9ybWFsOwogICAgICAgIHFqLnZtdWx0KG5vcm1hbCwgd29ybGROb3JtYWwpOyAvLyBHZXQgYSB3b3JsZCB2ZXJ0ZXggZnJvbSB0aGUgZmFjZQoKICAgICAgICBjb25zdCB3b3JsZFBvaW50ID0gc3BoZXJlQ29udmV4X3dvcmxkUG9pbnQ7CiAgICAgICAgcWoudm11bHQodmVydHNbZmFjZVswXV0sIHdvcmxkUG9pbnQpOwogICAgICAgIHdvcmxkUG9pbnQudmFkZCh4aiwgd29ybGRQb2ludCk7IC8vIEdldCBhIHBvaW50IG9uIHRoZSBzcGhlcmUsIGNsb3Nlc3QgdG8gdGhlIGZhY2Ugbm9ybWFsCgogICAgICAgIGNvbnN0IHdvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZSA9IHNwaGVyZUNvbnZleF93b3JsZFNwaGVyZVBvaW50Q2xvc2VzdFRvUGxhbmU7CiAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLVIsIHdvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZSk7CiAgICAgICAgeGkudmFkZCh3b3JsZFNwaGVyZVBvaW50Q2xvc2VzdFRvUGxhbmUsIHdvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZSk7IC8vIFZlY3RvciBmcm9tIGEgZmFjZSBwb2ludCB0byB0aGUgY2xvc2VzdCBwb2ludCBvbiB0aGUgc3BoZXJlCgogICAgICAgIGNvbnN0IHBlbmV0cmF0aW9uVmVjID0gc3BoZXJlQ29udmV4X3BlbmV0cmF0aW9uVmVjOwogICAgICAgIHdvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZS52c3ViKHdvcmxkUG9pbnQsIHBlbmV0cmF0aW9uVmVjKTsgLy8gVGhlIHBlbmV0cmF0aW9uLiBOZWdhdGl2ZSB2YWx1ZSBtZWFucyBvdmVybGFwLgoKICAgICAgICBjb25zdCBwZW5ldHJhdGlvbiA9IHBlbmV0cmF0aW9uVmVjLmRvdCh3b3JsZE5vcm1hbCk7CiAgICAgICAgY29uc3Qgd29ybGRQb2ludFRvU3BoZXJlID0gc3BoZXJlQ29udmV4X3NwaGVyZVRvV29ybGRQb2ludDsKICAgICAgICB4aS52c3ViKHdvcmxkUG9pbnQsIHdvcmxkUG9pbnRUb1NwaGVyZSk7CgogICAgICAgIGlmIChwZW5ldHJhdGlvbiA8IDAgJiYgd29ybGRQb2ludFRvU3BoZXJlLmRvdCh3b3JsZE5vcm1hbCkgPiAwKSB7CiAgICAgICAgICAvLyBJbnRlcnNlY3RzIHBsYW5lLiBOb3cgY2hlY2sgaWYgdGhlIHNwaGVyZSBpcyBpbnNpZGUgdGhlIGZhY2UgcG9seWdvbgogICAgICAgICAgY29uc3QgZmFjZVZlcnRzID0gW107IC8vIEZhY2UgdmVydGljZXMsIGluIHdvcmxkIGNvb3JkcwoKICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOdmVydHMgPSBmYWNlLmxlbmd0aDsgaiAhPT0gTnZlcnRzOyBqKyspIHsKICAgICAgICAgICAgY29uc3Qgd29ybGRWZXJ0ZXggPSB2M3Bvb2wuZ2V0KCk7CiAgICAgICAgICAgIHFqLnZtdWx0KHZlcnRzW2ZhY2Vbal1dLCB3b3JsZFZlcnRleCk7CiAgICAgICAgICAgIHhqLnZhZGQod29ybGRWZXJ0ZXgsIHdvcmxkVmVydGV4KTsKICAgICAgICAgICAgZmFjZVZlcnRzLnB1c2god29ybGRWZXJ0ZXgpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChwb2ludEluUG9seWdvbihmYWNlVmVydHMsIHdvcmxkTm9ybWFsLCB4aSkpIHsKICAgICAgICAgICAgLy8gSXMgdGhlIHNwaGVyZSBjZW50ZXIgaW4gdGhlIGZhY2UgcG9seWdvbj8KICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICAgIHdvcmxkTm9ybWFsLnNjYWxlKC1SLCByLnJpKTsgLy8gQ29udGFjdCBvZmZzZXQsIGZyb20gc3BoZXJlIGNlbnRlciB0byBjb250YWN0CgogICAgICAgICAgICB3b3JsZE5vcm1hbC5uZWdhdGUoci5uaSk7IC8vIE5vcm1hbCBwb2ludGluZyBvdXQgb2Ygc3BoZXJlCgogICAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvblZlYzIgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgICAgICAgIHdvcmxkTm9ybWFsLnNjYWxlKC1wZW5ldHJhdGlvbiwgcGVuZXRyYXRpb25WZWMyKTsKICAgICAgICAgICAgY29uc3QgcGVuZXRyYXRpb25TcGhlcmVQb2ludCA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLVIsIHBlbmV0cmF0aW9uU3BoZXJlUG9pbnQpOyAvL3hpLnZzdWIoeGopLnZhZGQocGVuZXRyYXRpb25TcGhlcmVQb2ludCkudmFkZChwZW5ldHJhdGlvblZlYzIgLCByLnJqKTsKCiAgICAgICAgICAgIHhpLnZzdWIoeGosIHIucmopOwogICAgICAgICAgICByLnJqLnZhZGQocGVuZXRyYXRpb25TcGhlcmVQb2ludCwgci5yaik7CiAgICAgICAgICAgIHIucmoudmFkZChwZW5ldHJhdGlvblZlYzIsIHIucmopOyAvLyBTaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJvZHkuCgogICAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgICByLnJqLnZzdWIoYmoucG9zaXRpb24sIHIucmopOyAvLyBTaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJvZHkuCgogICAgICAgICAgICByLnJpLnZhZGQoeGksIHIucmkpOwogICAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgICB2M3Bvb2wucmVsZWFzZShwZW5ldHJhdGlvblZlYzIpOwogICAgICAgICAgICB2M3Bvb2wucmVsZWFzZShwZW5ldHJhdGlvblNwaGVyZVBvaW50KTsKICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOyAvLyBSZWxlYXNlIHdvcmxkIHZlcnRpY2VzCgogICAgICAgICAgICBmb3IgKGxldCBqID0gMCwgTmZhY2V2ZXJ0cyA9IGZhY2VWZXJ0cy5sZW5ndGg7IGogIT09IE5mYWNldmVydHM7IGorKykgewogICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKGZhY2VWZXJ0c1tqXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybjsgLy8gV2Ugb25seSBleHBlY3QgKm9uZSogZmFjZSBjb250YWN0CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBFZGdlPwogICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gZmFjZS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgIC8vIEdldCB0d28gd29ybGQgdHJhbnNmb3JtZWQgdmVydGljZXMKICAgICAgICAgICAgICBjb25zdCB2MSA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgICBjb25zdCB2MiA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgICBxai52bXVsdCh2ZXJ0c1tmYWNlWyhqICsgMSkgJSBmYWNlLmxlbmd0aF1dLCB2MSk7CiAgICAgICAgICAgICAgcWoudm11bHQodmVydHNbZmFjZVsoaiArIDIpICUgZmFjZS5sZW5ndGhdXSwgdjIpOwogICAgICAgICAgICAgIHhqLnZhZGQodjEsIHYxKTsKICAgICAgICAgICAgICB4ai52YWRkKHYyLCB2Mik7IC8vIENvbnN0cnVjdCBlZGdlIHZlY3RvcgoKICAgICAgICAgICAgICBjb25zdCBlZGdlID0gc3BoZXJlQ29udmV4X2VkZ2U7CiAgICAgICAgICAgICAgdjIudnN1Yih2MSwgZWRnZSk7IC8vIENvbnN0cnVjdCB0aGUgc2FtZSB2ZWN0b3IsIGJ1dCBub3JtYWxpemVkCgogICAgICAgICAgICAgIGNvbnN0IGVkZ2VVbml0ID0gc3BoZXJlQ29udmV4X2VkZ2VVbml0OwogICAgICAgICAgICAgIGVkZ2UudW5pdChlZGdlVW5pdCk7IC8vIHAgaXMgeGkgcHJvamVjdGVkIG9udG8gdGhlIGVkZ2UKCiAgICAgICAgICAgICAgY29uc3QgcCA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgICBjb25zdCB2MV90b194aSA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgICB4aS52c3ViKHYxLCB2MV90b194aSk7CiAgICAgICAgICAgICAgY29uc3QgZG90ID0gdjFfdG9feGkuZG90KGVkZ2VVbml0KTsKICAgICAgICAgICAgICBlZGdlVW5pdC5zY2FsZShkb3QsIHApOwogICAgICAgICAgICAgIHAudmFkZCh2MSwgcCk7IC8vIENvbXB1dGUgYSB2ZWN0b3IgZnJvbSBwIHRvIHRoZSBjZW50ZXIgb2YgdGhlIHNwaGVyZQoKICAgICAgICAgICAgICBjb25zdCB4aV90b19wID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIHAudnN1Yih4aSwgeGlfdG9fcCk7IC8vIENvbGxpc2lvbiBpZiB0aGUgZWRnZS1zcGhlcmUgZGlzdGFuY2UgaXMgbGVzcyB0aGFuIHRoZSByYWRpdXMKICAgICAgICAgICAgICAvLyBBTkQgaWYgcCBpcyBpbiBiZXR3ZWVuIHYxIGFuZCB2MgoKICAgICAgICAgICAgICBpZiAoZG90ID4gMCAmJiBkb3QgKiBkb3QgPCBlZGdlLmxlbmd0aFNxdWFyZWQoKSAmJiB4aV90b19wLmxlbmd0aFNxdWFyZWQoKSA8IFIgKiBSKSB7CiAgICAgICAgICAgICAgICAvLyBDb2xsaXNpb24gaWYgdGhlIGVkZ2Utc3BoZXJlIGRpc3RhbmNlIGlzIGxlc3MgdGhhbiB0aGUgcmFkaXVzCiAgICAgICAgICAgICAgICAvLyBFZGdlIGNvbnRhY3QhCiAgICAgICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICAgICAgICBwLnZzdWIoeGosIHIucmopOwogICAgICAgICAgICAgICAgcC52c3ViKHhpLCByLm5pKTsKICAgICAgICAgICAgICAgIHIubmkubm9ybWFsaXplKCk7CiAgICAgICAgICAgICAgICByLm5pLnNjYWxlKFIsIHIucmkpOyAvLyBTaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJvZHkuCgogICAgICAgICAgICAgICAgci5yai52YWRkKHhqLCByLnJqKTsKICAgICAgICAgICAgICAgIHIucmoudnN1Yihiai5wb3NpdGlvbiwgci5yaik7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgICAgICByLnJpLnZhZGQoeGksIHIucmkpOwogICAgICAgICAgICAgICAgci5yaS52c3ViKGJpLnBvc2l0aW9uLCByLnJpKTsKICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7IC8vIFJlbGVhc2Ugd29ybGQgdmVydGljZXMKCiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMCwgTmZhY2V2ZXJ0cyA9IGZhY2VWZXJ0cy5sZW5ndGg7IGogIT09IE5mYWNldmVydHM7IGorKykgewogICAgICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZShmYWNlVmVydHNbal0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxKTsKICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYyKTsKICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHApOwogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoeGlfdG9fcCk7CiAgICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh2MV90b194aSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh2MSk7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjIpOwogICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHApOwogICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHhpX3RvX3ApOwogICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxX3RvX3hpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSAvLyBSZWxlYXNlIHdvcmxkIHZlcnRpY2VzCgoKICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOZmFjZXZlcnRzID0gZmFjZVZlcnRzLmxlbmd0aDsgaiAhPT0gTmZhY2V2ZXJ0czsgaisrKSB7CiAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKGZhY2VWZXJ0c1tqXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcGxhbmVDb252ZXgocGxhbmVTaGFwZSwgY29udmV4U2hhcGUsIHBsYW5lUG9zaXRpb24sIGNvbnZleFBvc2l0aW9uLCBwbGFuZVF1YXQsIGNvbnZleFF1YXQsIHBsYW5lQm9keSwgY29udmV4Qm9keSwgc2ksIHNqLCBqdXN0VGVzdCkgewogICAgICAvLyBTaW1wbHkgcmV0dXJuIHRoZSBwb2ludHMgYmVoaW5kIHRoZSBwbGFuZS4KICAgICAgY29uc3Qgd29ybGRWZXJ0ZXggPSBwbGFuZUNvbnZleF92OwogICAgICBjb25zdCB3b3JsZE5vcm1hbCA9IHBsYW5lQ29udmV4X25vcm1hbDsKICAgICAgd29ybGROb3JtYWwuc2V0KDAsIDAsIDEpOwogICAgICBwbGFuZVF1YXQudm11bHQod29ybGROb3JtYWwsIHdvcmxkTm9ybWFsKTsgLy8gVHVybiBub3JtYWwgYWNjb3JkaW5nIHRvIHBsYW5lIG9yaWVudGF0aW9uCgogICAgICBsZXQgbnVtQ29udGFjdHMgPSAwOwogICAgICBjb25zdCByZWxwb3MgPSBwbGFuZUNvbnZleF9yZWxwb3M7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gY29udmV4U2hhcGUudmVydGljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBHZXQgd29ybGQgY29udmV4IHZlcnRleAogICAgICAgIHdvcmxkVmVydGV4LmNvcHkoY29udmV4U2hhcGUudmVydGljZXNbaV0pOwogICAgICAgIGNvbnZleFF1YXQudm11bHQod29ybGRWZXJ0ZXgsIHdvcmxkVmVydGV4KTsKICAgICAgICBjb252ZXhQb3NpdGlvbi52YWRkKHdvcmxkVmVydGV4LCB3b3JsZFZlcnRleCk7CiAgICAgICAgd29ybGRWZXJ0ZXgudnN1YihwbGFuZVBvc2l0aW9uLCByZWxwb3MpOwogICAgICAgIGNvbnN0IGRvdCA9IHdvcmxkTm9ybWFsLmRvdChyZWxwb3MpOwoKICAgICAgICBpZiAoZG90IDw9IDAuMCkgewogICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihwbGFuZUJvZHksIGNvbnZleEJvZHksIHBsYW5lU2hhcGUsIGNvbnZleFNoYXBlLCBzaSwgc2opOyAvLyBHZXQgdmVydGV4IHBvc2l0aW9uIHByb2plY3RlZCBvbiBwbGFuZQoKICAgICAgICAgIGNvbnN0IHByb2plY3RlZCA9IHBsYW5lQ29udmV4X3Byb2plY3RlZDsKICAgICAgICAgIHdvcmxkTm9ybWFsLnNjYWxlKHdvcmxkTm9ybWFsLmRvdChyZWxwb3MpLCBwcm9qZWN0ZWQpOwogICAgICAgICAgd29ybGRWZXJ0ZXgudnN1Yihwcm9qZWN0ZWQsIHByb2plY3RlZCk7CiAgICAgICAgICBwcm9qZWN0ZWQudnN1YihwbGFuZVBvc2l0aW9uLCByLnJpKTsgLy8gRnJvbSBwbGFuZSB0byB2ZXJ0ZXggcHJvamVjdGVkIG9uIHBsYW5lCgogICAgICAgICAgci5uaS5jb3B5KHdvcmxkTm9ybWFsKTsgLy8gQ29udGFjdCBub3JtYWwgaXMgdGhlIHBsYW5lIG5vcm1hbCBvdXQgZnJvbSBwbGFuZQogICAgICAgICAgLy8gcmogaXMgbm93IGp1c3QgdGhlIHZlY3RvciBmcm9tIHRoZSBjb252ZXggY2VudGVyIHRvIHRoZSB2ZXJ0ZXgKCiAgICAgICAgICB3b3JsZFZlcnRleC52c3ViKGNvbnZleFBvc2l0aW9uLCByLnJqKTsgLy8gTWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgYm9keQoKICAgICAgICAgIHIucmkudmFkZChwbGFuZVBvc2l0aW9uLCByLnJpKTsKICAgICAgICAgIHIucmkudnN1YihwbGFuZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yai52YWRkKGNvbnZleFBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgIHIucmoudnN1Yihjb252ZXhCb2R5LnBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICBudW1Db250YWN0cysrOwoKICAgICAgICAgIGlmICghdGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbikgewogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbiAmJiBudW1Db250YWN0cykgewogICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25Gcm9tQXZlcmFnZShudW1Db250YWN0cyk7CiAgICAgIH0KICAgIH0KCiAgICBib3hDb252ZXgoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXgoc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlSGVpZ2h0ZmllbGQoc3BoZXJlU2hhcGUsIGhmU2hhcGUsIHNwaGVyZVBvcywgaGZQb3MsIHNwaGVyZVF1YXQsIGhmUXVhdCwgc3BoZXJlQm9keSwgaGZCb2R5LCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgY29uc3QgZGF0YSA9IGhmU2hhcGUuZGF0YTsKICAgICAgY29uc3QgcmFkaXVzID0gc3BoZXJlU2hhcGUucmFkaXVzOwogICAgICBjb25zdCB3ID0gaGZTaGFwZS5lbGVtZW50U2l6ZTsKICAgICAgY29uc3Qgd29ybGRQaWxsYXJPZmZzZXQgPSBzcGhlcmVIZWlnaHRmaWVsZF90bXAyOyAvLyBHZXQgc3BoZXJlIHBvc2l0aW9uIHRvIGhlaWdodGZpZWxkIGxvY2FsIQoKICAgICAgY29uc3QgbG9jYWxTcGhlcmVQb3MgPSBzcGhlcmVIZWlnaHRmaWVsZF90bXAxOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUoaGZQb3MsIGhmUXVhdCwgc3BoZXJlUG9zLCBsb2NhbFNwaGVyZVBvcyk7IC8vIEdldCB0aGUgaW5kZXggb2YgdGhlIGRhdGEgcG9pbnRzIHRvIHRlc3QgYWdhaW5zdAoKICAgICAgbGV0IGlNaW5YID0gTWF0aC5mbG9vcigobG9jYWxTcGhlcmVQb3MueCAtIHJhZGl1cykgLyB3KSAtIDE7CiAgICAgIGxldCBpTWF4WCA9IE1hdGguY2VpbCgobG9jYWxTcGhlcmVQb3MueCArIHJhZGl1cykgLyB3KSArIDE7CiAgICAgIGxldCBpTWluWSA9IE1hdGguZmxvb3IoKGxvY2FsU3BoZXJlUG9zLnkgLSByYWRpdXMpIC8gdykgLSAxOwogICAgICBsZXQgaU1heFkgPSBNYXRoLmNlaWwoKGxvY2FsU3BoZXJlUG9zLnkgKyByYWRpdXMpIC8gdykgKyAxOyAvLyBCYWlsIG91dCBpZiB3ZSBhcmUgb3V0IG9mIHRoZSB0ZXJyYWluCgogICAgICBpZiAoaU1heFggPCAwIHx8IGlNYXhZIDwgMCB8fCBpTWluWCA+IGRhdGEubGVuZ3RoIHx8IGlNaW5ZID4gZGF0YVswXS5sZW5ndGgpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gQ2xhbXAgaW5kZXggdG8gZWRnZXMKCgogICAgICBpZiAoaU1pblggPCAwKSB7CiAgICAgICAgaU1pblggPSAwOwogICAgICB9CgogICAgICBpZiAoaU1heFggPCAwKSB7CiAgICAgICAgaU1heFggPSAwOwogICAgICB9CgogICAgICBpZiAoaU1pblkgPCAwKSB7CiAgICAgICAgaU1pblkgPSAwOwogICAgICB9CgogICAgICBpZiAoaU1heFkgPCAwKSB7CiAgICAgICAgaU1heFkgPSAwOwogICAgICB9CgogICAgICBpZiAoaU1pblggPj0gZGF0YS5sZW5ndGgpIHsKICAgICAgICBpTWluWCA9IGRhdGEubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNYXhYID49IGRhdGEubGVuZ3RoKSB7CiAgICAgICAgaU1heFggPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WSA+PSBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIGlNYXhZID0gZGF0YVswXS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1pblkgPj0gZGF0YVswXS5sZW5ndGgpIHsKICAgICAgICBpTWluWSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgY29uc3QgbWluTWF4ID0gW107CiAgICAgIGhmU2hhcGUuZ2V0UmVjdE1pbk1heChpTWluWCwgaU1pblksIGlNYXhYLCBpTWF4WSwgbWluTWF4KTsKICAgICAgY29uc3QgbWluID0gbWluTWF4WzBdOwogICAgICBjb25zdCBtYXggPSBtaW5NYXhbMV07IC8vIEJhaWwgb3V0IGlmIHdlIGNhbid0IHRvdWNoIHRoZSBib3VuZGluZyBoZWlnaHQgYm94CgogICAgICBpZiAobG9jYWxTcGhlcmVQb3MueiAtIHJhZGl1cyA+IG1heCB8fCBsb2NhbFNwaGVyZVBvcy56ICsgcmFkaXVzIDwgbWluKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJlc3VsdDsKCiAgICAgIGZvciAobGV0IGkgPSBpTWluWDsgaSA8IGlNYXhYOyBpKyspIHsKICAgICAgICBmb3IgKGxldCBqID0gaU1pblk7IGogPCBpTWF4WTsgaisrKSB7CiAgICAgICAgICBjb25zdCBudW1Db250YWN0c0JlZm9yZSA9IHJlc3VsdC5sZW5ndGg7CiAgICAgICAgICBsZXQgaW50ZXJzZWN0aW5nID0gZmFsc2U7IC8vIExvd2VyIHRyaWFuZ2xlCgogICAgICAgICAgaGZTaGFwZS5nZXRDb252ZXhUcmlhbmdsZVBpbGxhcihpLCBqLCBmYWxzZSk7CiAgICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUoaGZQb3MsIGhmUXVhdCwgaGZTaGFwZS5waWxsYXJPZmZzZXQsIHdvcmxkUGlsbGFyT2Zmc2V0KTsKCiAgICAgICAgICBpZiAoc3BoZXJlUG9zLmRpc3RhbmNlVG8od29ybGRQaWxsYXJPZmZzZXQpIDwgaGZTaGFwZS5waWxsYXJDb252ZXguYm91bmRpbmdTcGhlcmVSYWRpdXMgKyBzcGhlcmVTaGFwZS5ib3VuZGluZ1NwaGVyZVJhZGl1cykgewogICAgICAgICAgICBpbnRlcnNlY3RpbmcgPSB0aGlzLnNwaGVyZUNvbnZleChzcGhlcmVTaGFwZSwgaGZTaGFwZS5waWxsYXJDb252ZXgsIHNwaGVyZVBvcywgd29ybGRQaWxsYXJPZmZzZXQsIHNwaGVyZVF1YXQsIGhmUXVhdCwgc3BoZXJlQm9keSwgaGZCb2R5LCBzcGhlcmVTaGFwZSwgaGZTaGFwZSwganVzdFRlc3QpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChqdXN0VGVzdCAmJiBpbnRlcnNlY3RpbmcpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9IC8vIFVwcGVyIHRyaWFuZ2xlCgoKICAgICAgICAgIGhmU2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgdHJ1ZSk7CiAgICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUoaGZQb3MsIGhmUXVhdCwgaGZTaGFwZS5waWxsYXJPZmZzZXQsIHdvcmxkUGlsbGFyT2Zmc2V0KTsKCiAgICAgICAgICBpZiAoc3BoZXJlUG9zLmRpc3RhbmNlVG8od29ybGRQaWxsYXJPZmZzZXQpIDwgaGZTaGFwZS5waWxsYXJDb252ZXguYm91bmRpbmdTcGhlcmVSYWRpdXMgKyBzcGhlcmVTaGFwZS5ib3VuZGluZ1NwaGVyZVJhZGl1cykgewogICAgICAgICAgICBpbnRlcnNlY3RpbmcgPSB0aGlzLnNwaGVyZUNvbnZleChzcGhlcmVTaGFwZSwgaGZTaGFwZS5waWxsYXJDb252ZXgsIHNwaGVyZVBvcywgd29ybGRQaWxsYXJPZmZzZXQsIHNwaGVyZVF1YXQsIGhmUXVhdCwgc3BoZXJlQm9keSwgaGZCb2R5LCBzcGhlcmVTaGFwZSwgaGZTaGFwZSwganVzdFRlc3QpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChqdXN0VGVzdCAmJiBpbnRlcnNlY3RpbmcpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgbnVtQ29udGFjdHMgPSByZXN1bHQubGVuZ3RoIC0gbnVtQ29udGFjdHNCZWZvcmU7CgogICAgICAgICAgaWYgKG51bUNvbnRhY3RzID4gMikgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICAvKgogICAgICAgICAgICAvLyBTa2lwIGFsbCBidXQgMQogICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IG51bUNvbnRhY3RzIC0gMTsgaysrKSB7CiAgICAgICAgICAgICAgICByZXN1bHQucG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICovCgogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGJveEhlaWdodGZpZWxkKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5tYXRlcmlhbCA9IHNpLm1hdGVyaWFsOwogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uY29sbGlzaW9uUmVzcG9uc2UgPSBzaS5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4SGVpZ2h0ZmllbGQoc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgY29udmV4SGVpZ2h0ZmllbGQoY29udmV4U2hhcGUsIGhmU2hhcGUsIGNvbnZleFBvcywgaGZQb3MsIGNvbnZleFF1YXQsIGhmUXVhdCwgY29udmV4Qm9keSwgaGZCb2R5LCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgY29uc3QgZGF0YSA9IGhmU2hhcGUuZGF0YTsKICAgICAgY29uc3QgdyA9IGhmU2hhcGUuZWxlbWVudFNpemU7CiAgICAgIGNvbnN0IHJhZGl1cyA9IGNvbnZleFNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzOwogICAgICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IGNvbnZleEhlaWdodGZpZWxkX3RtcDI7CiAgICAgIGNvbnN0IGZhY2VMaXN0ID0gY29udmV4SGVpZ2h0ZmllbGRfZmFjZUxpc3Q7IC8vIEdldCBzcGhlcmUgcG9zaXRpb24gdG8gaGVpZ2h0ZmllbGQgbG9jYWwhCgogICAgICBjb25zdCBsb2NhbENvbnZleFBvcyA9IGNvbnZleEhlaWdodGZpZWxkX3RtcDE7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShoZlBvcywgaGZRdWF0LCBjb252ZXhQb3MsIGxvY2FsQ29udmV4UG9zKTsgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CgogICAgICBsZXQgaU1pblggPSBNYXRoLmZsb29yKChsb2NhbENvbnZleFBvcy54IC0gcmFkaXVzKSAvIHcpIC0gMTsKICAgICAgbGV0IGlNYXhYID0gTWF0aC5jZWlsKChsb2NhbENvbnZleFBvcy54ICsgcmFkaXVzKSAvIHcpICsgMTsKICAgICAgbGV0IGlNaW5ZID0gTWF0aC5mbG9vcigobG9jYWxDb252ZXhQb3MueSAtIHJhZGl1cykgLyB3KSAtIDE7CiAgICAgIGxldCBpTWF4WSA9IE1hdGguY2VpbCgobG9jYWxDb252ZXhQb3MueSArIHJhZGl1cykgLyB3KSArIDE7IC8vIEJhaWwgb3V0IGlmIHdlIGFyZSBvdXQgb2YgdGhlIHRlcnJhaW4KCiAgICAgIGlmIChpTWF4WCA8IDAgfHwgaU1heFkgPCAwIHx8IGlNaW5YID4gZGF0YS5sZW5ndGggfHwgaU1pblkgPiBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBDbGFtcCBpbmRleCB0byBlZGdlcwoKCiAgICAgIGlmIChpTWluWCA8IDApIHsKICAgICAgICBpTWluWCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WCA8IDApIHsKICAgICAgICBpTWF4WCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA8IDApIHsKICAgICAgICBpTWluWSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WSA8IDApIHsKICAgICAgICBpTWF4WSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWCA+PSBkYXRhLmxlbmd0aCkgewogICAgICAgIGlNaW5YID0gZGF0YS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1heFggPj0gZGF0YS5sZW5ndGgpIHsKICAgICAgICBpTWF4WCA9IGRhdGEubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNYXhZID49IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgaU1heFkgPSBkYXRhWzBdLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA+PSBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIGlNaW5ZID0gZGF0YVswXS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBjb25zdCBtaW5NYXggPSBbXTsKICAgICAgaGZTaGFwZS5nZXRSZWN0TWluTWF4KGlNaW5YLCBpTWluWSwgaU1heFgsIGlNYXhZLCBtaW5NYXgpOwogICAgICBjb25zdCBtaW4gPSBtaW5NYXhbMF07CiAgICAgIGNvbnN0IG1heCA9IG1pbk1heFsxXTsgLy8gQmFpbCBvdXQgaWYgd2UncmUgY2FudCB0b3VjaCB0aGUgYm91bmRpbmcgaGVpZ2h0IGJveAoKICAgICAgaWYgKGxvY2FsQ29udmV4UG9zLnogLSByYWRpdXMgPiBtYXggfHwgbG9jYWxDb252ZXhQb3MueiArIHJhZGl1cyA8IG1pbikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IGlNaW5YOyBpIDwgaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8IGlNYXhZOyBqKyspIHsKICAgICAgICAgIGxldCBpbnRlcnNlY3RpbmcgPSBmYWxzZTsgLy8gTG93ZXIgdHJpYW5nbGUKCiAgICAgICAgICBoZlNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChjb252ZXhQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIGNvbnZleFNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuY29udmV4Q29udmV4KGNvbnZleFNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgY29udmV4UG9zLCB3b3JsZFBpbGxhck9mZnNldCwgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIG51bGwsIG51bGwsIGp1c3RUZXN0LCBmYWNlTGlzdCwgbnVsbCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgaGZTaGFwZS5nZXRDb252ZXhUcmlhbmdsZVBpbGxhcihpLCBqLCB0cnVlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChjb252ZXhQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIGNvbnZleFNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuY29udmV4Q29udmV4KGNvbnZleFNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgY29udmV4UG9zLCB3b3JsZFBpbGxhck9mZnNldCwgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIG51bGwsIG51bGwsIGp1c3RUZXN0LCBmYWNlTGlzdCwgbnVsbCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzcGhlcmVQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICAvLyBUaGUgbm9ybWFsIGlzIHRoZSB1bml0IHZlY3RvciBmcm9tIHNwaGVyZSBjZW50ZXIgdG8gcGFydGljbGUgY2VudGVyCiAgICAgIGNvbnN0IG5vcm1hbCA9IHBhcnRpY2xlU3BoZXJlX25vcm1hbDsKICAgICAgbm9ybWFsLnNldCgwLCAwLCAxKTsKICAgICAgeGkudnN1Yih4aiwgbm9ybWFsKTsKICAgICAgY29uc3QgbGVuZ3RoU3F1YXJlZCA9IG5vcm1hbC5sZW5ndGhTcXVhcmVkKCk7CgogICAgICBpZiAobGVuZ3RoU3F1YXJlZCA8PSBzai5yYWRpdXMgKiBzai5yYWRpdXMpIHsKICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgbm9ybWFsLm5vcm1hbGl6ZSgpOwogICAgICAgIHIucmouY29weShub3JtYWwpOwogICAgICAgIHIucmouc2NhbGUoc2oucmFkaXVzLCByLnJqKTsKICAgICAgICByLm5pLmNvcHkobm9ybWFsKTsgLy8gQ29udGFjdCBub3JtYWwKCiAgICAgICAgci5uaS5uZWdhdGUoci5uaSk7CiAgICAgICAgci5yaS5zZXQoMCwgMCwgMCk7IC8vIENlbnRlciBvZiBwYXJ0aWNsZQoKICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgfQogICAgfQoKICAgIHBsYW5lUGFydGljbGUoc2osIHNpLCB4aiwgeGksIHFqLCBxaSwgYmosIGJpLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgY29uc3Qgbm9ybWFsID0gcGFydGljbGVQbGFuZV9ub3JtYWw7CiAgICAgIG5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIGJqLnF1YXRlcm5pb24udm11bHQobm9ybWFsLCBub3JtYWwpOyAvLyBUdXJuIG5vcm1hbCBhY2NvcmRpbmcgdG8gcGxhbmUgb3JpZW50YXRpb24KCiAgICAgIGNvbnN0IHJlbHBvcyA9IHBhcnRpY2xlUGxhbmVfcmVscG9zOwogICAgICB4aS52c3ViKGJqLnBvc2l0aW9uLCByZWxwb3MpOwogICAgICBjb25zdCBkb3QgPSBub3JtYWwuZG90KHJlbHBvcyk7CgogICAgICBpZiAoZG90IDw9IDAuMCkgewogICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICByLm5pLmNvcHkobm9ybWFsKTsgLy8gQ29udGFjdCBub3JtYWwgaXMgdGhlIHBsYW5lIG5vcm1hbAoKICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgICAgICByLnJpLnNldCgwLCAwLCAwKTsgLy8gQ2VudGVyIG9mIHBhcnRpY2xlCiAgICAgICAgLy8gR2V0IHBhcnRpY2xlIHBvc2l0aW9uIHByb2plY3RlZCBvbiBwbGFuZQoKICAgICAgICBjb25zdCBwcm9qZWN0ZWQgPSBwYXJ0aWNsZVBsYW5lX3Byb2plY3RlZDsKICAgICAgICBub3JtYWwuc2NhbGUobm9ybWFsLmRvdCh4aSksIHByb2plY3RlZCk7CiAgICAgICAgeGkudnN1Yihwcm9qZWN0ZWQsIHByb2plY3RlZCk7IC8vcHJvamVjdGVkLnZhZGQoYmoucG9zaXRpb24scHJvamVjdGVkKTsKICAgICAgICAvLyByaiBpcyBub3cgdGhlIHByb2plY3RlZCB3b3JsZCBwb3NpdGlvbiBtaW51cyBwbGFuZSBwb3NpdGlvbgoKICAgICAgICByLnJqLmNvcHkocHJvamVjdGVkKTsKICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgfQogICAgfQoKICAgIGJveFBhcnRpY2xlKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5tYXRlcmlhbCA9IHNpLm1hdGVyaWFsOwogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uY29sbGlzaW9uUmVzcG9uc2UgPSBzaS5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4UGFydGljbGUoc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgY29udmV4UGFydGljbGUoc2osIHNpLCB4aiwgeGksIHFqLCBxaSwgYmosIGJpLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgbGV0IHBlbmV0cmF0ZWRGYWNlSW5kZXggPSAtMTsKICAgICAgY29uc3QgcGVuZXRyYXRlZEZhY2VOb3JtYWwgPSBjb252ZXhQYXJ0aWNsZV9wZW5ldHJhdGVkRmFjZU5vcm1hbDsKICAgICAgY29uc3Qgd29ybGRQZW5ldHJhdGlvblZlYyA9IGNvbnZleFBhcnRpY2xlX3dvcmxkUGVuZXRyYXRpb25WZWM7CiAgICAgIGxldCBtaW5QZW5ldHJhdGlvbiA9IG51bGw7CiAgICAgIGNvbnN0IGxvY2FsID0gY29udmV4UGFydGljbGVfbG9jYWw7CiAgICAgIGxvY2FsLmNvcHkoeGkpOwogICAgICBsb2NhbC52c3ViKHhqLCBsb2NhbCk7IC8vIENvbnZlcnQgcG9zaXRpb24gdG8gcmVsYXRpdmUgdGhlIGNvbnZleCBvcmlnaW4KCiAgICAgIHFqLmNvbmp1Z2F0ZShjcWopOwogICAgICBjcWoudm11bHQobG9jYWwsIGxvY2FsKTsKCiAgICAgIGlmIChzai5wb2ludElzSW5zaWRlKGxvY2FsKSkgewogICAgICAgIGlmIChzai53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUpIHsKICAgICAgICAgIHNqLmNvbXB1dGVXb3JsZFZlcnRpY2VzKHhqLCBxaik7CiAgICAgICAgfQoKICAgICAgICBpZiAoc2oud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlKSB7CiAgICAgICAgICBzai5jb21wdXRlV29ybGRGYWNlTm9ybWFscyhxaik7CiAgICAgICAgfSAvLyBGb3IgZWFjaCB3b3JsZCBwb2x5Z29uIGluIHRoZSBwb2x5aGVkcmEKCgogICAgICAgIGZvciAobGV0IGkgPSAwLCBuZmFjZXMgPSBzai5mYWNlcy5sZW5ndGg7IGkgIT09IG5mYWNlczsgaSsrKSB7CiAgICAgICAgICAvLyBDb25zdHJ1Y3Qgd29ybGQgZmFjZSB2ZXJ0aWNlcwogICAgICAgICAgY29uc3QgdmVydHMgPSBbc2oud29ybGRWZXJ0aWNlc1tzai5mYWNlc1tpXVswXV1dOwogICAgICAgICAgY29uc3Qgbm9ybWFsID0gc2oud29ybGRGYWNlTm9ybWFsc1tpXTsgLy8gQ2hlY2sgaG93IG11Y2ggdGhlIHBhcnRpY2xlIHBlbmV0cmF0ZXMgdGhlIHBvbHlnb24gcGxhbmUuCgogICAgICAgICAgeGkudnN1Yih2ZXJ0c1swXSwgY29udmV4UGFydGljbGVfdmVydGV4VG9QYXJ0aWNsZSk7CiAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvbiA9IC1ub3JtYWwuZG90KGNvbnZleFBhcnRpY2xlX3ZlcnRleFRvUGFydGljbGUpOwoKICAgICAgICAgIGlmIChtaW5QZW5ldHJhdGlvbiA9PT0gbnVsbCB8fCBNYXRoLmFicyhwZW5ldHJhdGlvbikgPCBNYXRoLmFicyhtaW5QZW5ldHJhdGlvbikpIHsKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1pblBlbmV0cmF0aW9uID0gcGVuZXRyYXRpb247CiAgICAgICAgICAgIHBlbmV0cmF0ZWRGYWNlSW5kZXggPSBpOwogICAgICAgICAgICBwZW5ldHJhdGVkRmFjZU5vcm1hbC5jb3B5KG5vcm1hbCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAocGVuZXRyYXRlZEZhY2VJbmRleCAhPT0gLTEpIHsKICAgICAgICAgIC8vIFNldHVwIGNvbnRhY3QKICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwuc2NhbGUobWluUGVuZXRyYXRpb24sIHdvcmxkUGVuZXRyYXRpb25WZWMpOyAvLyByaiBpcyB0aGUgcGFydGljbGUgcG9zaXRpb24gcHJvamVjdGVkIHRvIHRoZSBmYWNlCgogICAgICAgICAgd29ybGRQZW5ldHJhdGlvblZlYy52YWRkKHhpLCB3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIHdvcmxkUGVuZXRyYXRpb25WZWMudnN1Yih4aiwgd29ybGRQZW5ldHJhdGlvblZlYyk7CiAgICAgICAgICByLnJqLmNvcHkod29ybGRQZW5ldHJhdGlvblZlYyk7IC8vY29uc3QgcHJvamVjdGVkVG9GYWNlID0geGkudnN1Yih4aikudmFkZCh3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIC8vcHJvamVjdGVkVG9GYWNlLmNvcHkoci5yaik7CiAgICAgICAgICAvL3FqLnZtdWx0KHIucmosci5yaik7CgogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwubmVnYXRlKHIubmkpOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgICAgIHIucmkuc2V0KDAsIDAsIDApOyAvLyBDZW50ZXIgb2YgcGFydGljbGUKCiAgICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgICBjb25zdCByaiA9IHIucmo7IC8vIE1ha2UgcmVsYXRpdmUgdG8gYm9kaWVzCgogICAgICAgICAgcmkudmFkZCh4aSwgcmkpOwogICAgICAgICAgcmkudnN1YihiaS5wb3NpdGlvbiwgcmkpOwogICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgICAgICAgcmoudnN1Yihiai5wb3NpdGlvbiwgcmopOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS53YXJuKCdQb2ludCBmb3VuZCBpbnNpZGUgY29udmV4LCBidXQgZGlkIG5vdCBmaW5kIHBlbmV0cmF0aW5nIGZhY2UhJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcihoZlNoYXBlLCBjb252ZXhTaGFwZSwgaGZQb3MsIGNvbnZleFBvcywgaGZRdWF0LCBjb252ZXhRdWF0LCBoZkJvZHksIGNvbnZleEJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhIZWlnaHRmaWVsZChjb252ZXhTaGFwZSwgaGZTaGFwZSwgY29udmV4UG9zLCBoZlBvcywgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgcGFydGljbGVDeWxpbmRlcihzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlVHJpbWVzaChzcGhlcmVTaGFwZSwgdHJpbWVzaFNoYXBlLCBzcGhlcmVQb3MsIHRyaW1lc2hQb3MsIHNwaGVyZVF1YXQsIHRyaW1lc2hRdWF0LCBzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IGVkZ2VWZXJ0ZXhBID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QTsKICAgICAgY29uc3QgZWRnZVZlcnRleEIgPSBzcGhlcmVUcmltZXNoX2VkZ2VWZXJ0ZXhCOwogICAgICBjb25zdCBlZGdlVmVjdG9yID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yOwogICAgICBjb25zdCBlZGdlVmVjdG9yVW5pdCA9IHNwaGVyZVRyaW1lc2hfZWRnZVZlY3RvclVuaXQ7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlUG9zID0gc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZVBvczsKICAgICAgY29uc3QgdG1wID0gc3BoZXJlVHJpbWVzaF90bXA7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlQUFCQiA9IHNwaGVyZVRyaW1lc2hfbG9jYWxTcGhlcmVBQUJCOwogICAgICBjb25zdCB2MiA9IHNwaGVyZVRyaW1lc2hfdjI7CiAgICAgIGNvbnN0IHJlbHBvcyA9IHNwaGVyZVRyaW1lc2hfcmVscG9zOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBzcGhlcmVUcmltZXNoX3RyaWFuZ2xlczsgLy8gQ29udmVydCBzcGhlcmUgcG9zaXRpb24gdG8gbG9jYWwgaW4gdGhlIHRyaW1lc2gKCiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgc3BoZXJlUG9zLCBsb2NhbFNwaGVyZVBvcyk7IC8vIEdldCB0aGUgYWFiYiBvZiB0aGUgc3BoZXJlIGxvY2FsbHkgaW4gdGhlIHRyaW1lc2gKCiAgICAgIGNvbnN0IHNwaGVyZVJhZGl1cyA9IHNwaGVyZVNoYXBlLnJhZGl1czsKICAgICAgbG9jYWxTcGhlcmVBQUJCLmxvd2VyQm91bmQuc2V0KGxvY2FsU3BoZXJlUG9zLnggLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnkgLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnogLSBzcGhlcmVSYWRpdXMpOwogICAgICBsb2NhbFNwaGVyZUFBQkIudXBwZXJCb3VuZC5zZXQobG9jYWxTcGhlcmVQb3MueCArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueSArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueiArIHNwaGVyZVJhZGl1cyk7CiAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZXNJbkFBQkIobG9jYWxTcGhlcmVBQUJCLCB0cmlhbmdsZXMpOyAvL2ZvciAobGV0IGkgPSAwOyBpIDwgdHJpbWVzaFNoYXBlLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB0cmlhbmdsZXMucHVzaChpKTsgLy8gQWxsCiAgICAgIC8vIFZlcnRpY2VzCgogICAgICBjb25zdCB2ID0gc3BoZXJlVHJpbWVzaF92OwogICAgICBjb25zdCByYWRpdXNTcXVhcmVkID0gc3BoZXJlU2hhcGUucmFkaXVzICogc3BoZXJlU2hhcGUucmFkaXVzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmlhbmdsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgdHJpbWVzaFNoYXBlLmdldFZlcnRleCh0cmltZXNoU2hhcGUuaW5kaWNlc1t0cmlhbmdsZXNbaV0gKiAzICsgal0sIHYpOyAvLyBDaGVjayB2ZXJ0ZXggb3ZlcmxhcCBpbiBzcGhlcmUKCiAgICAgICAgICB2LnZzdWIobG9jYWxTcGhlcmVQb3MsIHJlbHBvcyk7CgogICAgICAgICAgaWYgKHJlbHBvcy5sZW5ndGhTcXVhcmVkKCkgPD0gcmFkaXVzU3F1YXJlZCkgewogICAgICAgICAgICAvLyBTYWZlIHVwCiAgICAgICAgICAgIHYyLmNvcHkodik7CiAgICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOwogICAgICAgICAgICB2LnZzdWIoc3BoZXJlUG9zLCByZWxwb3MpOwoKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oc3BoZXJlQm9keSwgdHJpbWVzaEJvZHksIHNwaGVyZVNoYXBlLCB0cmltZXNoU2hhcGUsIHJzaSwgcnNqKTsKICAgICAgICAgICAgci5uaS5jb3B5KHJlbHBvcyk7CiAgICAgICAgICAgIHIubmkubm9ybWFsaXplKCk7IC8vIHJpIGlzIHRoZSB2ZWN0b3IgZnJvbSBzcGhlcmUgY2VudGVyIHRvIHRoZSBzcGhlcmUgc3VyZmFjZQoKICAgICAgICAgICAgci5yaS5jb3B5KHIubmkpOwogICAgICAgICAgICByLnJpLnNjYWxlKHNwaGVyZVNoYXBlLnJhZGl1cywgci5yaSk7CiAgICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgIHIucmouY29weSh2KTsKICAgICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIENoZWNrIGFsbCBlZGdlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJpYW5nbGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgIHRyaW1lc2hTaGFwZS5nZXRWZXJ0ZXgodHJpbWVzaFNoYXBlLmluZGljZXNbdHJpYW5nbGVzW2ldICogMyArIGpdLCBlZGdlVmVydGV4QSk7CiAgICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KHRyaW1lc2hTaGFwZS5pbmRpY2VzW3RyaWFuZ2xlc1tpXSAqIDMgKyAoaiArIDEpICUgM10sIGVkZ2VWZXJ0ZXhCKTsKICAgICAgICAgIGVkZ2VWZXJ0ZXhCLnZzdWIoZWRnZVZlcnRleEEsIGVkZ2VWZWN0b3IpOyAvLyBQcm9qZWN0IHNwaGVyZSBwb3NpdGlvbiB0byB0aGUgZWRnZQoKICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEIsIHRtcCk7CiAgICAgICAgICBjb25zdCBwb3NpdGlvbkFsb25nRWRnZUIgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwogICAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1YihlZGdlVmVydGV4QSwgdG1wKTsKICAgICAgICAgIGxldCBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwoKICAgICAgICAgIGlmIChwb3NpdGlvbkFsb25nRWRnZUEgPiAwICYmIHBvc2l0aW9uQWxvbmdFZGdlQiA8IDApIHsKICAgICAgICAgICAgLy8gTm93IGNoZWNrIHRoZSBvcnRob2dvbmFsIGRpc3RhbmNlIGZyb20gZWRnZSB0byBzcGhlcmUgY2VudGVyCiAgICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEEsIHRtcCk7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0LmNvcHkoZWRnZVZlY3Rvcik7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0Lm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3JVbml0KTsKICAgICAgICAgICAgZWRnZVZlY3RvclVuaXQuc2NhbGUocG9zaXRpb25BbG9uZ0VkZ2VBLCB0bXApOwogICAgICAgICAgICB0bXAudmFkZChlZGdlVmVydGV4QSwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIGNlbnRlciBwb3NpdGlvbiBwcm9qZWN0ZWQgdG8gdGhlIGVkZ2UsIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgdHJpbWVzaCBmcmFtZQoKICAgICAgICAgICAgY29uc3QgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgICAgIGlmIChkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgICAgIHRtcC52c3ViKGxvY2FsU3BoZXJlUG9zLCByLm5pKTsKICAgICAgICAgICAgICByLm5pLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZhZGQoc3BoZXJlUG9zLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICAgICAgdG1wLnZzdWIodHJpbWVzaEJvZHkucG9zaXRpb24sIHIucmopOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIubmksIHIubmkpOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIFRyaWFuZ2xlIGZhY2VzCgoKICAgICAgY29uc3QgdmEgPSBzcGhlcmVUcmltZXNoX3ZhOwogICAgICBjb25zdCB2YiA9IHNwaGVyZVRyaW1lc2hfdmI7CiAgICAgIGNvbnN0IHZjID0gc3BoZXJlVHJpbWVzaF92YzsKICAgICAgY29uc3Qgbm9ybWFsID0gc3BoZXJlVHJpbWVzaF9ub3JtYWw7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IHRyaWFuZ2xlcy5sZW5ndGg7IGkgIT09IE47IGkrKykgewogICAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZVZlcnRpY2VzKHRyaWFuZ2xlc1tpXSwgdmEsIHZiLCB2Yyk7CiAgICAgICAgdHJpbWVzaFNoYXBlLmdldE5vcm1hbCh0cmlhbmdsZXNbaV0sIG5vcm1hbCk7CiAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1Yih2YSwgdG1wKTsKICAgICAgICBsZXQgZGlzdCA9IHRtcC5kb3Qobm9ybWFsKTsKICAgICAgICBub3JtYWwuc2NhbGUoZGlzdCwgdG1wKTsKICAgICAgICBsb2NhbFNwaGVyZVBvcy52c3ViKHRtcCwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIHBvc2l0aW9uIHByb2plY3RlZCB0byB0aGUgdHJpYW5nbGUgcGxhbmUKCiAgICAgICAgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgaWYgKFJheS5wb2ludEluVHJpYW5nbGUodG1wLCB2YSwgdmIsIHZjKSAmJiBkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgbGV0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgdG1wLnZzdWIobG9jYWxTcGhlcmVQb3MsIHIubmkpOwogICAgICAgICAgci5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgci5yaS52c3ViKHNwaGVyZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICB0bXAudnN1Yih0cmltZXNoQm9keS5wb3NpdGlvbiwgci5yaik7CiAgICAgICAgICBUcmFuc2Zvcm0udmVjdG9yVG9Xb3JsZEZyYW1lKHRyaW1lc2hRdWF0LCByLm5pLCByLm5pKTsKICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRyaWFuZ2xlcy5sZW5ndGggPSAwOwogICAgfQoKICAgIHBsYW5lVHJpbWVzaChwbGFuZVNoYXBlLCB0cmltZXNoU2hhcGUsIHBsYW5lUG9zLCB0cmltZXNoUG9zLCBwbGFuZVF1YXQsIHRyaW1lc2hRdWF0LCBwbGFuZUJvZHksIHRyaW1lc2hCb2R5LCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgLy8gTWFrZSBjb250YWN0cyEKICAgICAgY29uc3QgdiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IG5vcm1hbCA9IHBsYW5lVHJpbWVzaF9ub3JtYWw7CiAgICAgIG5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIHBsYW5lUXVhdC52bXVsdChub3JtYWwsIG5vcm1hbCk7IC8vIFR1cm4gbm9ybWFsIGFjY29yZGluZyB0byBwbGFuZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmltZXNoU2hhcGUudmVydGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy8gR2V0IHdvcmxkIHZlcnRleCBmcm9tIHRyaW1lc2gKICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KGksIHYpOyAvLyBTYWZlIHVwCgogICAgICAgIGNvbnN0IHYyID0gbmV3IFZlYzMoKTsKICAgICAgICB2Mi5jb3B5KHYpOwogICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOyAvLyBDaGVjayBwbGFuZSBzaWRlCgogICAgICAgIGNvbnN0IHJlbHBvcyA9IHBsYW5lVHJpbWVzaF9yZWxwb3M7CiAgICAgICAgdi52c3ViKHBsYW5lUG9zLCByZWxwb3MpOwogICAgICAgIGNvbnN0IGRvdCA9IG5vcm1hbC5kb3QocmVscG9zKTsKCiAgICAgICAgaWYgKGRvdCA8PSAwLjApIHsKICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24ocGxhbmVCb2R5LCB0cmltZXNoQm9keSwgcGxhbmVTaGFwZSwgdHJpbWVzaFNoYXBlLCByc2ksIHJzaik7CiAgICAgICAgICByLm5pLmNvcHkobm9ybWFsKTsgLy8gQ29udGFjdCBub3JtYWwgaXMgdGhlIHBsYW5lIG5vcm1hbAogICAgICAgICAgLy8gR2V0IHZlcnRleCBwb3NpdGlvbiBwcm9qZWN0ZWQgb24gcGxhbmUKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWQgPSBwbGFuZVRyaW1lc2hfcHJvamVjdGVkOwogICAgICAgICAgbm9ybWFsLnNjYWxlKHJlbHBvcy5kb3Qobm9ybWFsKSwgcHJvamVjdGVkKTsKICAgICAgICAgIHYudnN1Yihwcm9qZWN0ZWQsIHByb2plY3RlZCk7IC8vIHJpIGlzIHRoZSBwcm9qZWN0ZWQgd29ybGQgcG9zaXRpb24gbWludXMgcGxhbmUgcG9zaXRpb24KCiAgICAgICAgICByLnJpLmNvcHkocHJvamVjdGVkKTsKICAgICAgICAgIHIucmkudnN1YihwbGFuZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yai5jb3B5KHYpOwogICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gLy8gY29udmV4VHJpbWVzaCgKICAgIC8vICAgc2k6IENvbnZleFBvbHloZWRyb24sIHNqOiBUcmltZXNoLCB4aTogVmVjMywgeGo6IFZlYzMsIHFpOiBRdWF0ZXJuaW9uLCBxajogUXVhdGVybmlvbiwKICAgIC8vICAgYmk6IEJvZHksIGJqOiBCb2R5LCByc2k/OiBTaGFwZSB8IG51bGwsIHJzaj86IFNoYXBlIHwgbnVsbCwKICAgIC8vICAgZmFjZUxpc3RBPzogbnVtYmVyW10gfCBudWxsLCBmYWNlTGlzdEI/OiBudW1iZXJbXSB8IG51bGwsCiAgICAvLyApIHsKICAgIC8vICAgY29uc3Qgc2VwQXhpcyA9IGNvbnZleENvbnZleF9zZXBBeGlzOwogICAgLy8gICBpZih4aS5kaXN0YW5jZVRvKHhqKSA+IHNpLmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgc2ouYm91bmRpbmdTcGhlcmVSYWRpdXMpewogICAgLy8gICAgICAgcmV0dXJuOwogICAgLy8gICB9CiAgICAvLyAgIC8vIENvbnN0cnVjdCBhIHRlbXAgaHVsbCBmb3IgZWFjaCB0cmlhbmdsZQogICAgLy8gICBjb25zdCBodWxsQiA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAvLyAgIGh1bGxCLmZhY2VzID0gW1swLDEsMl1dOwogICAgLy8gICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgICAvLyAgIGNvbnN0IHZiID0gbmV3IFZlYzMoKTsKICAgIC8vICAgY29uc3QgdmMgPSBuZXcgVmVjMygpOwogICAgLy8gICBodWxsQi52ZXJ0aWNlcyA9IFsKICAgIC8vICAgICAgIHZhLAogICAgLy8gICAgICAgdmIsCiAgICAvLyAgICAgICB2YwogICAgLy8gICBdOwogICAgLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IHNqLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAvLyAgICAgICBjb25zdCB0cmlhbmdsZU5vcm1hbCA9IG5ldyBWZWMzKCk7CiAgICAvLyAgICAgICBzai5nZXROb3JtYWwoaSwgdHJpYW5nbGVOb3JtYWwpOwogICAgLy8gICAgICAgaHVsbEIuZmFjZU5vcm1hbHMgPSBbdHJpYW5nbGVOb3JtYWxdOwogICAgLy8gICAgICAgc2ouZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCB2YSwgdmIsIHZjKTsKICAgIC8vICAgICAgIGxldCBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICBpZighZCl7CiAgICAvLyAgICAgICAgICAgdHJpYW5nbGVOb3JtYWwuc2NhbGUoLTEsIHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICAgICAgaWYoIWQpewogICAgLy8gICAgICAgICAgICAgICBjb250aW51ZTsKICAgIC8vICAgICAgICAgICB9CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgICBjb25zdCByZXM6IENvbnZleFBvbHloZWRyb25Db250YWN0UG9pbnRbXSA9IFtdOwogICAgLy8gICAgICAgY29uc3QgcSA9IGNvbnZleENvbnZleF9xOwogICAgLy8gICAgICAgc2kuY2xpcEFnYWluc3RIdWxsKHhpLHFpLGh1bGxCLHhqLHFqLHRyaWFuZ2xlTm9ybWFsLC0xMDAsMTAwLHJlcyk7CiAgICAvLyAgICAgICBmb3IobGV0IGogPSAwOyBqICE9PSByZXMubGVuZ3RoOyBqKyspewogICAgLy8gICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSxiaixzaSxzaixyc2kscnNqKSwKICAgIC8vICAgICAgICAgICAgICAgcmkgPSByLnJpLAogICAgLy8gICAgICAgICAgICAgICByaiA9IHIucmo7CiAgICAvLyAgICAgICAgICAgci5uaS5jb3B5KHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgIC8vICAgICAgICAgICByZXNbal0ubm9ybWFsLm5lZ2F0ZShxKTsKICAgIC8vICAgICAgICAgICBxLm11bHQocmVzW2pdLmRlcHRoLCBxKTsKICAgIC8vICAgICAgICAgICByZXNbal0ucG9pbnQudmFkZChxLCByaSk7CiAgICAvLyAgICAgICAgICAgcmouY29weShyZXNbal0ucG9pbnQpOwogICAgLy8gICAgICAgICAgIC8vIENvbnRhY3QgcG9pbnRzIGFyZSBpbiB3b3JsZCBjb29yZGluYXRlcy4gVHJhbnNmb3JtIGJhY2sgdG8gcmVsYXRpdmUKICAgIC8vICAgICAgICAgICByaS52c3ViKHhpLHJpKTsKICAgIC8vICAgICAgICAgICByai52c3ViKHhqLHJqKTsKICAgIC8vICAgICAgICAgICAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwogICAgLy8gICAgICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgIC8vICAgICAgICAgICByaS52c3ViKGJpLnBvc2l0aW9uLCByaSk7CiAgICAvLyAgICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgLy8gICAgICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgIC8vICAgICAgICAgICByZXN1bHQucHVzaChyKTsKICAgIC8vICAgICAgIH0KICAgIC8vICAgfQogICAgLy8gfQoKCiAgfQoKICBjb25zdCBhdmVyYWdlTm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBhdmVyYWdlQ29udGFjdFBvaW50QSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXZlcmFnZUNvbnRhY3RQb2ludEIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFF1YXQxID0gbmV3IFF1YXRlcm5pb24oKTsKICBjb25zdCB0bXBRdWF0MiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3JlbHBvcyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX3YgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdjIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfZWRnZVZlcnRleEEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfZWRnZVZlcnRleEIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfZWRnZVZlY3RvciA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yVW5pdCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZVBvcyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF90bXAgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdmEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdmIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdmMgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfbG9jYWxTcGhlcmVBQUJCID0gbmV3IEFBQkIoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX3RyaWFuZ2xlcyA9IFtdOwogIGNvbnN0IHBvaW50X29uX3BsYW5lX3RvX3NwaGVyZSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVfdG9fc3BoZXJlX29ydGhvID0gbmV3IFZlYzMoKTsgLy8gU2VlIGh0dHA6Ly9idWxsZXRwaHlzaWNzLmNvbS9CdWxsZXQvQnVsbGV0RnVsbC9TcGhlcmVUcmlhbmdsZURldGVjdG9yXzhjcHBfc291cmNlLmh0bWwKCiAgY29uc3QgcG9pbnRJblBvbHlnb25fZWRnZSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcG9pbnRJblBvbHlnb25fZWRnZV94X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcG9pbnRJblBvbHlnb25fdnRwID0gbmV3IFZlYzMoKTsKCiAgZnVuY3Rpb24gcG9pbnRJblBvbHlnb24odmVydHMsIG5vcm1hbCwgcCkgewogICAgbGV0IHBvc2l0aXZlUmVzdWx0ID0gbnVsbDsKICAgIGNvbnN0IE4gPSB2ZXJ0cy5sZW5ndGg7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICBjb25zdCB2ID0gdmVydHNbaV07IC8vIEdldCBlZGdlIHRvIHRoZSBuZXh0IHZlcnRleAoKICAgICAgY29uc3QgZWRnZSA9IHBvaW50SW5Qb2x5Z29uX2VkZ2U7CiAgICAgIHZlcnRzWyhpICsgMSkgJSBOXS52c3ViKHYsIGVkZ2UpOyAvLyBHZXQgY3Jvc3MgcHJvZHVjdCBiZXR3ZWVuIHBvbHlnb24gbm9ybWFsIGFuZCB0aGUgZWRnZQoKICAgICAgY29uc3QgZWRnZV94X25vcm1hbCA9IHBvaW50SW5Qb2x5Z29uX2VkZ2VfeF9ub3JtYWw7IC8vY29uc3QgZWRnZV94X25vcm1hbCA9IG5ldyBWZWMzKCk7CgogICAgICBlZGdlLmNyb3NzKG5vcm1hbCwgZWRnZV94X25vcm1hbCk7IC8vIEdldCB2ZWN0b3IgYmV0d2VlbiBwb2ludCBhbmQgY3VycmVudCB2ZXJ0ZXgKCiAgICAgIGNvbnN0IHZlcnRleF90b19wID0gcG9pbnRJblBvbHlnb25fdnRwOwogICAgICBwLnZzdWIodiwgdmVydGV4X3RvX3ApOyAvLyBUaGlzIGRvdCBwcm9kdWN0IGRldGVybWluZXMgd2hpY2ggc2lkZSBvZiB0aGUgZWRnZSB0aGUgcG9pbnQgaXMKCiAgICAgIGNvbnN0IHIgPSBlZGdlX3hfbm9ybWFsLmRvdCh2ZXJ0ZXhfdG9fcCk7IC8vIElmIGFsbCBzdWNoIGRvdCBwcm9kdWN0cyBoYXZlIHNhbWUgc2lnbiwgd2UgYXJlIGluc2lkZSB0aGUgcG9seWdvbi4KCiAgICAgIGlmIChwb3NpdGl2ZVJlc3VsdCA9PT0gbnVsbCB8fCByID4gMCAmJiBwb3NpdGl2ZVJlc3VsdCA9PT0gdHJ1ZSB8fCByIDw9IDAgJiYgcG9zaXRpdmVSZXN1bHQgPT09IGZhbHNlKSB7CiAgICAgICAgaWYgKHBvc2l0aXZlUmVzdWx0ID09PSBudWxsKSB7CiAgICAgICAgICBwb3NpdGl2ZVJlc3VsdCA9IHIgPiAwOwogICAgICAgIH0KCiAgICAgICAgY29udGludWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBFbmNvdW50ZXJlZCBzb21lIG90aGVyIHNpZ24uIEV4aXQuCiAgICAgIH0KICAgIH0gLy8gSWYgd2UgZ290IGhlcmUsIGFsbCBkb3QgcHJvZHVjdHMgd2VyZSBvZiB0aGUgc2FtZSBzaWduLgoKCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGNvbnN0IGJveF90b19zcGhlcmUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUJveF9ucyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQm94X25zMSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQm94X25zMiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQm94X3NpZGVzID0gW25ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCldOwogIGNvbnN0IHNwaGVyZUJveF9zcGhlcmVfdG9fY29ybmVyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZV9ucyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQm94X3NpZGVfbnMxID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZV9uczIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleF90b19zcGhlcmUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9lZGdlID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVDb252ZXhfZWRnZVVuaXQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9zcGhlcmVUb0Nvcm5lciA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3dvcmxkQ29ybmVyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVDb252ZXhfd29ybGROb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF93b3JsZFBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVDb252ZXhfd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVDb252ZXhfcGVuZXRyYXRpb25WZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9zcGhlcmVUb1dvcmxkUG9pbnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X3YgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVDb252ZXhfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwbGFuZUNvbnZleF9wcm9qZWN0ZWQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleENvbnZleF9zZXBBeGlzID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhDb252ZXhfcSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVQbGFuZV9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBhcnRpY2xlUGxhbmVfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwYXJ0aWNsZVBsYW5lX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVTcGhlcmVfbm9ybWFsID0gbmV3IFZlYzMoKTsgLy8gV0lQCgogIGNvbnN0IGNxaiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgY29uc3QgY29udmV4UGFydGljbGVfbG9jYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleFBhcnRpY2xlX3BlbmV0cmF0ZWRGYWNlTm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhQYXJ0aWNsZV92ZXJ0ZXhUb1BhcnRpY2xlID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhQYXJ0aWNsZV93b3JsZFBlbmV0cmF0aW9uVmVjID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhIZWlnaHRmaWVsZF90bXAxID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhIZWlnaHRmaWVsZF90bXAyID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhIZWlnaHRmaWVsZF9mYWNlTGlzdCA9IFswXTsKICBjb25zdCBzcGhlcmVIZWlnaHRmaWVsZF90bXAxID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVIZWlnaHRmaWVsZF90bXAyID0gbmV3IFZlYzMoKTsKCiAgY2xhc3MgT3ZlcmxhcEtlZXBlciB7CiAgICAvKioKICAgICAqIEB0b2RvIFJlbW92ZSB1c2VsZXNzIGNvbnN0cnVjdG9yCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLmN1cnJlbnQgPSB2b2lkIDA7CiAgICAgIHRoaXMucHJldmlvdXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuY3VycmVudCA9IFtdOwogICAgICB0aGlzLnByZXZpb3VzID0gW107CiAgICB9CiAgICAvKioKICAgICAqIGdldEtleQogICAgICovCgoKICAgIGdldEtleShpLCBqKSB7CiAgICAgIGlmIChqIDwgaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gaSA8PCAxNiB8IGo7CiAgICB9CiAgICAvKioKICAgICAqIHNldAogICAgICovCgoKICAgIHNldChpLCBqKSB7CiAgICAgIC8vIEluc2VydGlvbiBzb3J0LiBUaGlzIHdheSB0aGUgZGlmZiB3aWxsIGhhdmUgbGluZWFyIGNvbXBsZXhpdHkuCiAgICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0S2V5KGksIGopOwogICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5jdXJyZW50OwogICAgICBsZXQgaW5kZXggPSAwOwoKICAgICAgd2hpbGUgKGtleSA+IGN1cnJlbnRbaW5kZXhdKSB7CiAgICAgICAgaW5kZXgrKzsKICAgICAgfQoKICAgICAgaWYgKGtleSA9PT0gY3VycmVudFtpbmRleF0pIHsKICAgICAgICByZXR1cm47IC8vIFBhaXIgd2FzIGFscmVhZHkgYWRkZWQKICAgICAgfQoKICAgICAgZm9yIChsZXQgaiA9IGN1cnJlbnQubGVuZ3RoIC0gMTsgaiA+PSBpbmRleDsgai0tKSB7CiAgICAgICAgY3VycmVudFtqICsgMV0gPSBjdXJyZW50W2pdOwogICAgICB9CgogICAgICBjdXJyZW50W2luZGV4XSA9IGtleTsKICAgIH0KICAgIC8qKgogICAgICogdGljawogICAgICovCgoKICAgIHRpY2soKSB7CiAgICAgIGNvbnN0IHRtcCA9IHRoaXMuY3VycmVudDsKICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5wcmV2aW91czsKICAgICAgdGhpcy5wcmV2aW91cyA9IHRtcDsKICAgICAgdGhpcy5jdXJyZW50Lmxlbmd0aCA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIGdldERpZmYKICAgICAqLwoKCiAgICBnZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpIHsKICAgICAgY29uc3QgYSA9IHRoaXMuY3VycmVudDsKICAgICAgY29uc3QgYiA9IHRoaXMucHJldmlvdXM7CiAgICAgIGNvbnN0IGFsID0gYS5sZW5ndGg7CiAgICAgIGNvbnN0IGJsID0gYi5sZW5ndGg7CiAgICAgIGxldCBqID0gMDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWw7IGkrKykgewogICAgICAgIGxldCBmb3VuZCA9IGZhbHNlOwogICAgICAgIGNvbnN0IGtleUEgPSBhW2ldOwoKICAgICAgICB3aGlsZSAoa2V5QSA+IGJbal0pIHsKICAgICAgICAgIGorKzsKICAgICAgICB9CgogICAgICAgIGZvdW5kID0ga2V5QSA9PT0gYltqXTsKCiAgICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgdW5wYWNrQW5kUHVzaChhZGRpdGlvbnMsIGtleUEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaiA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJsOyBpKyspIHsKICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKICAgICAgICBjb25zdCBrZXlCID0gYltpXTsKCiAgICAgICAgd2hpbGUgKGtleUIgPiBhW2pdKSB7CiAgICAgICAgICBqKys7CiAgICAgICAgfQoKICAgICAgICBmb3VuZCA9IGFbal0gPT09IGtleUI7CgogICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgIHVucGFja0FuZFB1c2gocmVtb3ZhbHMsIGtleUIpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICB9CgogIGZ1bmN0aW9uIHVucGFja0FuZFB1c2goYXJyYXksIGtleSkgewogICAgYXJyYXkucHVzaCgoa2V5ICYgMHhmZmZmMDAwMCkgPj4gMTYsIGtleSAmIDB4MDAwMGZmZmYpOwogIH0KICAvKioKICAgKiBUdXBsZURpY3Rpb25hcnkKICAgKi8KCgogIGNsYXNzIFR1cGxlRGljdGlvbmFyeSB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5kYXRhID0gewogICAgICAgIGtleXM6IFtdCiAgICAgIH07CiAgICB9CiAgICAvKiogZ2V0ICovCgoKICAgIGdldChpLCBqKSB7CiAgICAgIGlmIChpID4gaikgewogICAgICAgIC8vIHN3YXAKICAgICAgICBjb25zdCB0ZW1wID0gajsKICAgICAgICBqID0gaTsKICAgICAgICBpID0gdGVtcDsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuZGF0YVtpICsgIi0iICsgal07CiAgICB9CiAgICAvKiogc2V0ICovCgoKICAgIHNldChpLCBqLCB2YWx1ZSkgewogICAgICBpZiAoaSA+IGopIHsKICAgICAgICBjb25zdCB0ZW1wID0gajsKICAgICAgICBqID0gaTsKICAgICAgICBpID0gdGVtcDsKICAgICAgfQoKICAgICAgY29uc3Qga2V5ID0gaSArICItIiArIGo7IC8vIENoZWNrIGlmIGtleSBhbHJlYWR5IGV4aXN0cwoKICAgICAgaWYgKCF0aGlzLmdldChpLCBqKSkgewogICAgICAgIHRoaXMuZGF0YS5rZXlzLnB1c2goa2V5KTsKICAgICAgfQoKICAgICAgdGhpcy5kYXRhW2tleV0gPSB2YWx1ZTsKICAgIH0KICAgIC8qKiByZXNldCAqLwoKCiAgICByZXNldCgpIHsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgY29uc3Qga2V5cyA9IGRhdGEua2V5czsKCiAgICAgIHdoaWxlIChrZXlzLmxlbmd0aCA+IDApIHsKICAgICAgICBjb25zdCBrZXkgPSBrZXlzLnBvcCgpOwogICAgICAgIGRlbGV0ZSBkYXRhW2tleV07CiAgICAgIH0KICAgIH0KCiAgfQogIC8qKgogICAqIFRoZSBwaHlzaWNzIHdvcmxkCiAgICovCgoKICBjbGFzcyBXb3JsZCBleHRlbmRzIEV2ZW50VGFyZ2V0IHsKICAgIC8qKgogICAgICogQ3VycmVudGx5IC8gbGFzdCB1c2VkIHRpbWVzdGVwLiBJcyBzZXQgdG8gLTEgaWYgbm90IGF2YWlsYWJsZS4gVGhpcyB2YWx1ZSBpcyB1cGRhdGVkIGJlZm9yZSBlYWNoIGludGVybmFsIHN0ZXAsIHdoaWNoIG1lYW5zIHRoYXQgaXQgaXMgImZyZXNoIiBpbnNpZGUgZXZlbnQgY2FsbGJhY2tzLgogICAgICovCgogICAgLyoqCiAgICAgKiBNYWtlcyBib2RpZXMgZ28gdG8gc2xlZXAgd2hlbiB0aGV5J3ZlIGJlZW4gaW5hY3RpdmUuCiAgICAgKiBAZGVmYXVsdCBmYWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgdGhlIGN1cnJlbnQgY29udGFjdHMgKGluc3RhbmNlcyBvZiBDb250YWN0RXF1YXRpb24pIGluIHRoZSB3b3JsZC4KICAgICAqLwoKICAgIC8qKgogICAgICogSG93IG9mdGVuIHRvIG5vcm1hbGl6ZSBxdWF0ZXJuaW9ucy4gU2V0IHRvIDAgZm9yIGV2ZXJ5IHN0ZXAsIDEgZm9yIGV2ZXJ5IHNlY29uZCBldGMuLiBBIGxhcmdlciB2YWx1ZSBpbmNyZWFzZXMgcGVyZm9ybWFuY2UuIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBhIHNtYWxsZXIgdmFsdWUgKHplcm8gdG8gYmUgc3VyZSBub3RoaW5nIGNhbiBnbyB3cm9uZykuCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byB0cnVlIHRvIHVzZSBmYXN0IHF1YXRlcm5pb24gbm9ybWFsaXphdGlvbi4gSXQgaXMgb2Z0ZW4gZW5vdWdoIGFjY3VyYXRlIHRvIHVzZS4KICAgICAqIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBmYWxzZS4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSB3YWxsLWNsb2NrIHRpbWUgc2luY2Ugc2ltdWxhdGlvbiBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogTnVtYmVyIG9mIHRpbWVzdGVwcyB0YWtlbiBzaW5jZSBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogRGVmYXVsdCBhbmQgbGFzdCB0aW1lc3RlcCBzaXplcy4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGdyYXZpdHkgb2YgdGhlIHdvcmxkLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgYnJvYWRwaGFzZSBhbGdvcml0aG0gdG8gdXNlLgogICAgICogQGRlZmF1bHQgTmFpdmVCcm9hZHBoYXNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFsbCBib2RpZXMgaW4gdGhpcyB3b3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBUcnVlIGlmIGFueSBib2RpZXMgYXJlIG5vdCBzbGVlcGluZywgZmFsc2UgaWYgZXZlcnkgYm9keSBpcyBzbGVlcGluZy4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHNvbHZlciBhbGdvcml0aG0gdG8gdXNlLgogICAgICogQGRlZmF1bHQgR1NTb2x2ZXIKICAgICAqLwoKICAgIC8qKgogICAgICogY29sbGlzaW9uTWF0cml4CiAgICAgKi8KCiAgICAvKioKICAgICAqIENvbGxpc2lvbk1hdHJpeCBmcm9tIHRoZSBwcmV2aW91cyBzdGVwLgogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgYWRkZWQgbWF0ZXJpYWxzLgogICAgICogQGRlcHJlY2F0ZWQKICAgICAqIEB0b2RvIFJlbW92ZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgYWRkZWQgY29udGFjdG1hdGVyaWFscy4KICAgICAqLwoKICAgIC8qKgogICAgICogVXNlZCB0byBsb29rIHVwIGEgQ29udGFjdE1hdGVyaWFsIGdpdmVuIHR3byBpbnN0YW5jZXMgb2YgTWF0ZXJpYWwuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBkZWZhdWx0IG1hdGVyaWFsIG9mIHRoZSBib2RpZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoaXMgY29udGFjdCBtYXRlcmlhbCBpcyB1c2VkIGlmIG5vIHN1aXRhYmxlIGNvbnRhY3RtYXRlcmlhbCBpcyBmb3VuZCBmb3IgYSBjb250YWN0LgogICAgICovCgogICAgLyoqCiAgICAgKiBUaW1lIGFjY3VtdWxhdG9yIGZvciBpbnRlcnBvbGF0aW9uLgogICAgICogQHNlZSBodHRwczovL2dhZmZlcm9uZ2FtZXMuY29tL2dhbWUtcGh5c2ljcy9maXgteW91ci10aW1lc3RlcC8KICAgICAqLwoKICAgIC8qKgogICAgICogRGlzcGF0Y2hlZCBhZnRlciBhIGJvZHkgaGFzIGJlZW4gYWRkZWQgdG8gdGhlIHdvcmxkLgogICAgICovCgogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIGEgYm9keSBoYXMgYmVlbiByZW1vdmVkIGZyb20gdGhlIHdvcmxkLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHsKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5kdCA9IHZvaWQgMDsKICAgICAgdGhpcy5hbGxvd1NsZWVwID0gdm9pZCAwOwogICAgICB0aGlzLmNvbnRhY3RzID0gdm9pZCAwOwogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zID0gdm9pZCAwOwogICAgICB0aGlzLnF1YXROb3JtYWxpemVTa2lwID0gdm9pZCAwOwogICAgICB0aGlzLnF1YXROb3JtYWxpemVGYXN0ID0gdm9pZCAwOwogICAgICB0aGlzLnRpbWUgPSB2b2lkIDA7CiAgICAgIHRoaXMuc3RlcG51bWJlciA9IHZvaWQgMDsKICAgICAgdGhpcy5kZWZhdWx0X2R0ID0gdm9pZCAwOwogICAgICB0aGlzLm5leHRJZCA9IHZvaWQgMDsKICAgICAgdGhpcy5ncmF2aXR5ID0gdm9pZCAwOwogICAgICB0aGlzLmJyb2FkcGhhc2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuYm9kaWVzID0gdm9pZCAwOwogICAgICB0aGlzLmhhc0FjdGl2ZUJvZGllcyA9IHZvaWQgMDsKICAgICAgdGhpcy5zb2x2ZXIgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29uc3RyYWludHMgPSB2b2lkIDA7CiAgICAgIHRoaXMubmFycm93cGhhc2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29sbGlzaW9uTWF0cml4ID0gdm9pZCAwOwogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeFByZXZpb3VzID0gdm9pZCAwOwogICAgICB0aGlzLmJvZHlPdmVybGFwS2VlcGVyID0gdm9pZCAwOwogICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlciA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXRlcmlhbHMgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29udGFjdG1hdGVyaWFscyA9IHZvaWQgMDsKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZSA9IHZvaWQgMDsKICAgICAgdGhpcy5kZWZhdWx0TWF0ZXJpYWwgPSB2b2lkIDA7CiAgICAgIHRoaXMuZGVmYXVsdENvbnRhY3RNYXRlcmlhbCA9IHZvaWQgMDsKICAgICAgdGhpcy5kb1Byb2ZpbGluZyA9IHZvaWQgMDsKICAgICAgdGhpcy5wcm9maWxlID0gdm9pZCAwOwogICAgICB0aGlzLmFjY3VtdWxhdG9yID0gdm9pZCAwOwogICAgICB0aGlzLnN1YnN5c3RlbXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuYWRkQm9keUV2ZW50ID0gdm9pZCAwOwogICAgICB0aGlzLnJlbW92ZUJvZHlFdmVudCA9IHZvaWQgMDsKICAgICAgdGhpcy5pZFRvQm9keU1hcCA9IHZvaWQgMDsKICAgICAgdGhpcy5kdCA9IC0xOwogICAgICB0aGlzLmFsbG93U2xlZXAgPSAhIW9wdGlvbnMuYWxsb3dTbGVlcDsKICAgICAgdGhpcy5jb250YWN0cyA9IFtdOwogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zID0gW107CiAgICAgIHRoaXMucXVhdE5vcm1hbGl6ZVNraXAgPSBvcHRpb25zLnF1YXROb3JtYWxpemVTa2lwICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnF1YXROb3JtYWxpemVTa2lwIDogMDsKICAgICAgdGhpcy5xdWF0Tm9ybWFsaXplRmFzdCA9IG9wdGlvbnMucXVhdE5vcm1hbGl6ZUZhc3QgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMucXVhdE5vcm1hbGl6ZUZhc3QgOiBmYWxzZTsKICAgICAgdGhpcy50aW1lID0gMC4wOwogICAgICB0aGlzLnN0ZXBudW1iZXIgPSAwOwogICAgICB0aGlzLmRlZmF1bHRfZHQgPSAxIC8gNjA7CiAgICAgIHRoaXMubmV4dElkID0gMDsKICAgICAgdGhpcy5ncmF2aXR5ID0gbmV3IFZlYzMoKTsKCiAgICAgIGlmIChvcHRpb25zLmdyYXZpdHkpIHsKICAgICAgICB0aGlzLmdyYXZpdHkuY29weShvcHRpb25zLmdyYXZpdHkpOwogICAgICB9CgogICAgICB0aGlzLmJyb2FkcGhhc2UgPSBvcHRpb25zLmJyb2FkcGhhc2UgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuYnJvYWRwaGFzZSA6IG5ldyBOYWl2ZUJyb2FkcGhhc2UoKTsKICAgICAgdGhpcy5ib2RpZXMgPSBbXTsKICAgICAgdGhpcy5oYXNBY3RpdmVCb2RpZXMgPSBmYWxzZTsKICAgICAgdGhpcy5zb2x2ZXIgPSBvcHRpb25zLnNvbHZlciAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5zb2x2ZXIgOiBuZXcgR1NTb2x2ZXIoKTsKICAgICAgdGhpcy5jb25zdHJhaW50cyA9IFtdOwogICAgICB0aGlzLm5hcnJvd3BoYXNlID0gbmV3IE5hcnJvd3BoYXNlKHRoaXMpOwogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeCA9IG5ldyBBcnJheUNvbGxpc2lvbk1hdHJpeCgpOwogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeFByZXZpb3VzID0gbmV3IEFycmF5Q29sbGlzaW9uTWF0cml4KCk7CiAgICAgIHRoaXMuYm9keU92ZXJsYXBLZWVwZXIgPSBuZXcgT3ZlcmxhcEtlZXBlcigpOwogICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlciA9IG5ldyBPdmVybGFwS2VlcGVyKCk7CiAgICAgIHRoaXMubWF0ZXJpYWxzID0gW107CiAgICAgIHRoaXMuY29udGFjdG1hdGVyaWFscyA9IFtdOwogICAgICB0aGlzLmNvbnRhY3RNYXRlcmlhbFRhYmxlID0gbmV3IFR1cGxlRGljdGlvbmFyeSgpOwogICAgICB0aGlzLmRlZmF1bHRNYXRlcmlhbCA9IG5ldyBNYXRlcmlhbCgnZGVmYXVsdCcpOwogICAgICB0aGlzLmRlZmF1bHRDb250YWN0TWF0ZXJpYWwgPSBuZXcgQ29udGFjdE1hdGVyaWFsKHRoaXMuZGVmYXVsdE1hdGVyaWFsLCB0aGlzLmRlZmF1bHRNYXRlcmlhbCwgewogICAgICAgIGZyaWN0aW9uOiAwLjMsCiAgICAgICAgcmVzdGl0dXRpb246IDAuMAogICAgICB9KTsKICAgICAgdGhpcy5kb1Byb2ZpbGluZyA9IGZhbHNlOwogICAgICB0aGlzLnByb2ZpbGUgPSB7CiAgICAgICAgc29sdmU6IDAsCiAgICAgICAgbWFrZUNvbnRhY3RDb25zdHJhaW50czogMCwKICAgICAgICBicm9hZHBoYXNlOiAwLAogICAgICAgIGludGVncmF0ZTogMCwKICAgICAgICBuYXJyb3dwaGFzZTogMAogICAgICB9OwogICAgICB0aGlzLmFjY3VtdWxhdG9yID0gMDsKICAgICAgdGhpcy5zdWJzeXN0ZW1zID0gW107CiAgICAgIHRoaXMuYWRkQm9keUV2ZW50ID0gewogICAgICAgIHR5cGU6ICdhZGRCb2R5JywKICAgICAgICBib2R5OiBudWxsCiAgICAgIH07CiAgICAgIHRoaXMucmVtb3ZlQm9keUV2ZW50ID0gewogICAgICAgIHR5cGU6ICdyZW1vdmVCb2R5JywKICAgICAgICBib2R5OiBudWxsCiAgICAgIH07CiAgICAgIHRoaXMuaWRUb0JvZHlNYXAgPSB7fTsKICAgICAgdGhpcy5icm9hZHBoYXNlLnNldFdvcmxkKHRoaXMpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGNvbnRhY3QgbWF0ZXJpYWwgYmV0d2VlbiBtYXRlcmlhbHMgbTEgYW5kIG0yCiAgICAgKiBAcmV0dXJuIFRoZSBjb250YWN0IG1hdGVyaWFsIGlmIGl0IHdhcyBmb3VuZC4KICAgICAqLwoKCiAgICBnZXRDb250YWN0TWF0ZXJpYWwobTEsIG0yKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnRhY3RNYXRlcmlhbFRhYmxlLmdldChtMS5pZCwgbTIuaWQpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgbnVtYmVyIG9mIG9iamVjdHMgaW4gdGhlIHdvcmxkLgogICAgICogQGRlcHJlY2F0ZWQKICAgICAqLwoKCiAgICBudW1PYmplY3RzKCkgewogICAgICByZXR1cm4gdGhpcy5ib2RpZXMubGVuZ3RoOwogICAgfQogICAgLyoqCiAgICAgKiBTdG9yZSBvbGQgY29sbGlzaW9uIHN0YXRlIGluZm8KICAgICAqLwoKCiAgICBjb2xsaXNpb25NYXRyaXhUaWNrKCkgewogICAgICBjb25zdCB0ZW1wID0gdGhpcy5jb2xsaXNpb25NYXRyaXhQcmV2aW91czsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXhQcmV2aW91cyA9IHRoaXMuY29sbGlzaW9uTWF0cml4OwogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeCA9IHRlbXA7CiAgICAgIHRoaXMuY29sbGlzaW9uTWF0cml4LnJlc2V0KCk7CiAgICAgIHRoaXMuYm9keU92ZXJsYXBLZWVwZXIudGljaygpOwogICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci50aWNrKCk7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIGNvbnN0cmFpbnQgdG8gdGhlIHNpbXVsYXRpb24uCiAgICAgKi8KCgogICAgYWRkQ29uc3RyYWludChjKSB7CiAgICAgIHRoaXMuY29uc3RyYWludHMucHVzaChjKTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlcyBhIGNvbnN0cmFpbnQKICAgICAqLwoKCiAgICByZW1vdmVDb25zdHJhaW50KGMpIHsKICAgICAgY29uc3QgaWR4ID0gdGhpcy5jb25zdHJhaW50cy5pbmRleE9mKGMpOwoKICAgICAgaWYgKGlkeCAhPT0gLTEpIHsKICAgICAgICB0aGlzLmNvbnN0cmFpbnRzLnNwbGljZShpZHgsIDEpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFJheWNhc3QgdGVzdAogICAgICogQGRlcHJlY2F0ZWQgVXNlIC5yYXljYXN0QWxsLCAucmF5Y2FzdENsb3Nlc3Qgb3IgLnJheWNhc3RBbnkgaW5zdGVhZC4KICAgICAqLwoKCiAgICByYXlUZXN0KGZyb20sIHRvLCByZXN1bHQpIHsKICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIFJheWNhc3RSZXN1bHQpIHsKICAgICAgICAvLyBEbyByYXljYXN0Q2xvc2VzdAogICAgICAgIHRoaXMucmF5Y2FzdENsb3Nlc3QoZnJvbSwgdG8sIHsKICAgICAgICAgIHNraXBCYWNrZmFjZXM6IHRydWUKICAgICAgICB9LCByZXN1bHQpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIERvIHJheWNhc3RBbGwKICAgICAgICB0aGlzLnJheWNhc3RBbGwoZnJvbSwgdG8sIHsKICAgICAgICAgIHNraXBCYWNrZmFjZXM6IHRydWUKICAgICAgICB9LCByZXN1bHQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFJheSBjYXN0IGFnYWluc3QgYWxsIGJvZGllcy4gVGhlIHByb3ZpZGVkIGNhbGxiYWNrIHdpbGwgYmUgZXhlY3V0ZWQgZm9yIGVhY2ggaGl0IHdpdGggYSBSYXljYXN0UmVzdWx0IGFzIHNpbmdsZSBhcmd1bWVudC4KICAgICAqIEByZXR1cm4gVHJ1ZSBpZiBhbnkgYm9keSB3YXMgaGl0LgogICAgICovCgoKICAgIHJheWNhc3RBbGwoZnJvbSwgdG8sIG9wdGlvbnMgPSB7fSwgY2FsbGJhY2spIHsKICAgICAgb3B0aW9ucy5tb2RlID0gUmF5LkFMTDsKICAgICAgb3B0aW9ucy5mcm9tID0gZnJvbTsKICAgICAgb3B0aW9ucy50byA9IHRvOwogICAgICBvcHRpb25zLmNhbGxiYWNrID0gY2FsbGJhY2s7CiAgICAgIHJldHVybiB0bXBSYXkuaW50ZXJzZWN0V29ybGQodGhpcywgb3B0aW9ucyk7CiAgICB9CiAgICAvKioKICAgICAqIFJheSBjYXN0LCBhbmQgc3RvcCBhdCB0aGUgZmlyc3QgcmVzdWx0LiBOb3RlIHRoYXQgdGhlIG9yZGVyIGlzIHJhbmRvbSAtIGJ1dCB0aGUgbWV0aG9kIGlzIGZhc3QuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0QW55KGZyb20sIHRvLCBvcHRpb25zID0ge30sIHJlc3VsdCkgewogICAgICBvcHRpb25zLm1vZGUgPSBSYXkuQU5ZOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMucmVzdWx0ID0gcmVzdWx0OwogICAgICByZXR1cm4gdG1wUmF5LmludGVyc2VjdFdvcmxkKHRoaXMsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiBSYXkgY2FzdCwgYW5kIHJldHVybiBpbmZvcm1hdGlvbiBvZiB0aGUgY2xvc2VzdCBoaXQuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0Q2xvc2VzdChmcm9tLCB0bywgb3B0aW9ucyA9IHt9LCByZXN1bHQpIHsKICAgICAgb3B0aW9ucy5tb2RlID0gUmF5LkNMT1NFU1Q7CiAgICAgIG9wdGlvbnMuZnJvbSA9IGZyb207CiAgICAgIG9wdGlvbnMudG8gPSB0bzsKICAgICAgb3B0aW9ucy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgIHJldHVybiB0bXBSYXkuaW50ZXJzZWN0V29ybGQodGhpcywgb3B0aW9ucyk7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIHJpZ2lkIGJvZHkgdG8gdGhlIHNpbXVsYXRpb24uCiAgICAgKiBAdG9kbyBJZiB0aGUgc2ltdWxhdGlvbiBoYXMgbm90IHlldCBzdGFydGVkLCB3aHkgcmVjcmV0ZSBhbmQgY29weSBhcnJheXMgZm9yIGVhY2ggYm9keT8gQWNjdW11bGF0ZSBpbiBkeW5hbWljIGFycmF5cyBpbiB0aGlzIGNhc2UuCiAgICAgKiBAdG9kbyBBZGRpbmcgYW4gYXJyYXkgb2YgYm9kaWVzIHNob3VsZCBiZSBwb3NzaWJsZS4gVGhpcyB3b3VsZCBzYXZlIHNvbWUgbG9vcHMgdG9vCiAgICAgKi8KCgogICAgYWRkQm9keShib2R5KSB7CiAgICAgIGlmICh0aGlzLmJvZGllcy5pbmNsdWRlcyhib2R5KSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgYm9keS5pbmRleCA9IHRoaXMuYm9kaWVzLmxlbmd0aDsKICAgICAgdGhpcy5ib2RpZXMucHVzaChib2R5KTsKICAgICAgYm9keS53b3JsZCA9IHRoaXM7CiAgICAgIGJvZHkuaW5pdFBvc2l0aW9uLmNvcHkoYm9keS5wb3NpdGlvbik7CiAgICAgIGJvZHkuaW5pdFZlbG9jaXR5LmNvcHkoYm9keS52ZWxvY2l0eSk7CiAgICAgIGJvZHkudGltZUxhc3RTbGVlcHkgPSB0aGlzLnRpbWU7CgogICAgICBpZiAoYm9keSBpbnN0YW5jZW9mIEJvZHkpIHsKICAgICAgICBib2R5LmluaXRBbmd1bGFyVmVsb2NpdHkuY29weShib2R5LmFuZ3VsYXJWZWxvY2l0eSk7CiAgICAgICAgYm9keS5pbml0UXVhdGVybmlvbi5jb3B5KGJvZHkucXVhdGVybmlvbik7CiAgICAgIH0KCiAgICAgIHRoaXMuY29sbGlzaW9uTWF0cml4LnNldE51bU9iamVjdHModGhpcy5ib2RpZXMubGVuZ3RoKTsKICAgICAgdGhpcy5hZGRCb2R5RXZlbnQuYm9keSA9IGJvZHk7CiAgICAgIHRoaXMuaWRUb0JvZHlNYXBbYm9keS5pZF0gPSBib2R5OwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5hZGRCb2R5RXZlbnQpOwogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgYSByaWdpZCBib2R5IGZyb20gdGhlIHNpbXVsYXRpb24uCiAgICAgKi8KCgogICAgcmVtb3ZlQm9keShib2R5KSB7CiAgICAgIGJvZHkud29ybGQgPSBudWxsOwogICAgICBjb25zdCBuID0gdGhpcy5ib2RpZXMubGVuZ3RoIC0gMTsKICAgICAgY29uc3QgYm9kaWVzID0gdGhpcy5ib2RpZXM7CiAgICAgIGNvbnN0IGlkeCA9IGJvZGllcy5pbmRleE9mKGJvZHkpOwoKICAgICAgaWYgKGlkeCAhPT0gLTEpIHsKICAgICAgICBib2RpZXMuc3BsaWNlKGlkeCwgMSk7IC8vIFRvZG86IHNob3VsZCB1c2UgYSBnYXJiYWdlIGZyZWUgbWV0aG9kCiAgICAgICAgLy8gUmVjb21wdXRlIGluZGV4CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBib2RpZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGJvZGllc1tpXS5pbmRleCA9IGk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXROdW1PYmplY3RzKG4pOwogICAgICAgIHRoaXMucmVtb3ZlQm9keUV2ZW50LmJvZHkgPSBib2R5OwogICAgICAgIGRlbGV0ZSB0aGlzLmlkVG9Cb2R5TWFwW2JvZHkuaWRdOwogICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCh0aGlzLnJlbW92ZUJvZHlFdmVudCk7CiAgICAgIH0KICAgIH0KCiAgICBnZXRCb2R5QnlJZChpZCkgewogICAgICByZXR1cm4gdGhpcy5pZFRvQm9keU1hcFtpZF07CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIE1ha2UgYSBmYXN0ZXIgbWFwCiAgICAgKi8KCgogICAgZ2V0U2hhcGVCeUlkKGlkKSB7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYm9kaWVzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2RpZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBzaGFwZXMgPSBib2RpZXNbaV0uc2hhcGVzOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHNoYXBlcy5sZW5ndGg7IGorKykgewogICAgICAgICAgY29uc3Qgc2hhcGUgPSBzaGFwZXNbal07CgogICAgICAgICAgaWYgKHNoYXBlLmlkID09PSBpZCkgewogICAgICAgICAgICByZXR1cm4gc2hhcGU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIC8qKgogICAgICogQWRkcyBhIG1hdGVyaWFsIHRvIHRoZSBXb3JsZC4KICAgICAqIEBkZXByZWNhdGVkCiAgICAgKiBAdG9kbyBSZW1vdmUKICAgICAqLwoKCiAgICBhZGRNYXRlcmlhbChtKSB7CiAgICAgIHRoaXMubWF0ZXJpYWxzLnB1c2gobSk7CiAgICB9CiAgICAvKioKICAgICAqIEFkZHMgYSBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBXb3JsZAogICAgICovCgoKICAgIGFkZENvbnRhY3RNYXRlcmlhbChjbWF0KSB7CiAgICAgIC8vIEFkZCBjb250YWN0IG1hdGVyaWFsCiAgICAgIHRoaXMuY29udGFjdG1hdGVyaWFscy5wdXNoKGNtYXQpOyAvLyBBZGQgY3VycmVudCBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBtYXRlcmlhbCB0YWJsZQoKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZS5zZXQoY21hdC5tYXRlcmlhbHNbMF0uaWQsIGNtYXQubWF0ZXJpYWxzWzFdLmlkLCBjbWF0KTsKICAgIH0KICAgIC8qKgogICAgICogU3RlcCB0aGUgcGh5c2ljcyB3b3JsZCBmb3J3YXJkIGluIHRpbWUuCiAgICAgKgogICAgICogVGhlcmUgYXJlIHR3byBtb2Rlcy4gVGhlIHNpbXBsZSBtb2RlIGlzIGZpeGVkIHRpbWVzdGVwcGluZyB3aXRob3V0IGludGVycG9sYXRpb24uIEluIHRoaXMgY2FzZSB5b3Ugb25seSB1c2UgdGhlIGZpcnN0IGFyZ3VtZW50LiBUaGUgc2Vjb25kIGNhc2UgdXNlcyBpbnRlcnBvbGF0aW9uLiBJbiB0aGF0IHlvdSBhbHNvIHByb3ZpZGUgdGhlIHRpbWUgc2luY2UgdGhlIGZ1bmN0aW9uIHdhcyBsYXN0IHVzZWQsIGFzIHdlbGwgYXMgdGhlIG1heGltdW0gZml4ZWQgdGltZXN0ZXBzIHRvIHRha2UuCiAgICAgKgogICAgICogQHBhcmFtIGR0IFRoZSBmaXhlZCB0aW1lIHN0ZXAgc2l6ZSB0byB1c2UuCiAgICAgKiBAcGFyYW0gdGltZVNpbmNlTGFzdENhbGxlZCBUaGUgdGltZSBlbGFwc2VkIHNpbmNlIHRoZSBmdW5jdGlvbiB3YXMgbGFzdCBjYWxsZWQuCiAgICAgKiBAcGFyYW0gbWF4U3ViU3RlcHMgTWF4aW11bSBudW1iZXIgb2YgZml4ZWQgc3RlcHMgdG8gdGFrZSBwZXIgZnVuY3Rpb24gY2FsbC4KICAgICAqIEBzZWUgaHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwNDI2MTU0NTMxL2h0dHA6Ly9idWxsZXRwaHlzaWNzLm9yZy9tZWRpYXdpa2ktMS41LjgvaW5kZXgucGhwL1N0ZXBwaW5nX1RoZV9Xb3JsZCNXaGF0X2RvX3RoZV9wYXJhbWV0ZXJzX3RvX2J0RHluYW1pY3NXb3JsZDo6c3RlcFNpbXVsYXRpb25fbWVhbi4zRgogICAgICogQGV4YW1wbGUKICAgICAqICAgICAvLyBmaXhlZCB0aW1lc3RlcHBpbmcgd2l0aG91dCBpbnRlcnBvbGF0aW9uCiAgICAgKiAgICAgd29ybGQuc3RlcCgxIC8gNjApCiAgICAgKi8KCgogICAgc3RlcChkdCwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMgPSAxMCkgewogICAgICBpZiAodGltZVNpbmNlTGFzdENhbGxlZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8gRml4ZWQsIHNpbXBsZSBzdGVwcGluZwogICAgICAgIHRoaXMuaW50ZXJuYWxTdGVwKGR0KTsgLy8gSW5jcmVtZW50IHRpbWUKCiAgICAgICAgdGhpcy50aW1lICs9IGR0OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYWNjdW11bGF0b3IgKz0gdGltZVNpbmNlTGFzdENhbGxlZDsKICAgICAgICBjb25zdCB0MCA9IHBlcmZvcm1hbmNlJDEubm93KCk7CiAgICAgICAgbGV0IHN1YnN0ZXBzID0gMDsKCiAgICAgICAgd2hpbGUgKHRoaXMuYWNjdW11bGF0b3IgPj0gZHQgJiYgc3Vic3RlcHMgPCBtYXhTdWJTdGVwcykgewogICAgICAgICAgLy8gRG8gZml4ZWQgc3RlcHMgdG8gY2F0Y2ggdXAKICAgICAgICAgIHRoaXMuaW50ZXJuYWxTdGVwKGR0KTsKICAgICAgICAgIHRoaXMuYWNjdW11bGF0b3IgLT0gZHQ7CiAgICAgICAgICBzdWJzdGVwcysrOwoKICAgICAgICAgIGlmIChwZXJmb3JtYW5jZSQxLm5vdygpIC0gdDAgPiBkdCAqIDEwMDApIHsKICAgICAgICAgICAgLy8gVGhlIGZyYW1lcmF0ZSBpcyBub3QgaW50ZXJhY3RpdmUgYW55bW9yZS4KICAgICAgICAgICAgLy8gV2UgYXJlIGJlbG93IHRoZSB0YXJnZXQgZnJhbWVyYXRlLgogICAgICAgICAgICAvLyBCZXR0ZXIgYmFpbCBvdXQuCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0gLy8gUmVtb3ZlIHRoZSBleGNlc3MgYWNjdW11bGF0b3IsIHNpbmNlIHdlIG1heSBub3QKICAgICAgICAvLyBoYXZlIGhhZCBlbm91Z2ggc3Vic3RlcHMgYXZhaWxhYmxlIHRvIGNhdGNoIHVwCgoKICAgICAgICB0aGlzLmFjY3VtdWxhdG9yID0gdGhpcy5hY2N1bXVsYXRvciAlIGR0OwogICAgICAgIGNvbnN0IHQgPSB0aGlzLmFjY3VtdWxhdG9yIC8gZHQ7CgogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSB0aGlzLmJvZGllcy5sZW5ndGg7IGorKykgewogICAgICAgICAgY29uc3QgYiA9IHRoaXMuYm9kaWVzW2pdOwogICAgICAgICAgYi5wcmV2aW91c1Bvc2l0aW9uLmxlcnAoYi5wb3NpdGlvbiwgdCwgYi5pbnRlcnBvbGF0ZWRQb3NpdGlvbik7CiAgICAgICAgICBiLnByZXZpb3VzUXVhdGVybmlvbi5zbGVycChiLnF1YXRlcm5pb24sIHQsIGIuaW50ZXJwb2xhdGVkUXVhdGVybmlvbik7CiAgICAgICAgICBiLnByZXZpb3VzUXVhdGVybmlvbi5ub3JtYWxpemUoKTsKICAgICAgICB9CgogICAgICAgIHRoaXMudGltZSArPSB0aW1lU2luY2VMYXN0Q2FsbGVkOwogICAgICB9CiAgICB9CgogICAgaW50ZXJuYWxTdGVwKGR0KSB7CiAgICAgIHRoaXMuZHQgPSBkdDsKICAgICAgY29uc3QgY29udGFjdHMgPSB0aGlzLmNvbnRhY3RzOwogICAgICBjb25zdCBwMSA9IFdvcmxkX3N0ZXBfcDE7CiAgICAgIGNvbnN0IHAyID0gV29ybGRfc3RlcF9wMjsKICAgICAgY29uc3QgTiA9IHRoaXMubnVtT2JqZWN0cygpOwogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmJvZGllczsKICAgICAgY29uc3Qgc29sdmVyID0gdGhpcy5zb2x2ZXI7CiAgICAgIGNvbnN0IGdyYXZpdHkgPSB0aGlzLmdyYXZpdHk7CiAgICAgIGNvbnN0IGRvUHJvZmlsaW5nID0gdGhpcy5kb1Byb2ZpbGluZzsKICAgICAgY29uc3QgcHJvZmlsZSA9IHRoaXMucHJvZmlsZTsKICAgICAgY29uc3QgRFlOQU1JQyA9IEJvZHkuRFlOQU1JQzsKICAgICAgbGV0IHByb2ZpbGluZ1N0YXJ0ID0gLUluZmluaXR5OwogICAgICBjb25zdCBjb25zdHJhaW50cyA9IHRoaXMuY29uc3RyYWludHM7CiAgICAgIGNvbnN0IGZyaWN0aW9uRXF1YXRpb25Qb29sID0gV29ybGRfc3RlcF9mcmljdGlvbkVxdWF0aW9uUG9vbDsKICAgICAgZ3Jhdml0eS5sZW5ndGgoKTsKICAgICAgY29uc3QgZ3ggPSBncmF2aXR5Lng7CiAgICAgIGNvbnN0IGd5ID0gZ3Jhdml0eS55OwogICAgICBjb25zdCBneiA9IGdyYXZpdHkuejsKICAgICAgbGV0IGkgPSAwOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsaW5nU3RhcnQgPSBwZXJmb3JtYW5jZSQxLm5vdygpOwogICAgICB9IC8vIEFkZCBncmF2aXR5IHRvIGFsbCBvYmplY3RzCgoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBib2RpZXNbaV07CgogICAgICAgIGlmIChiaS50eXBlID09PSBEWU5BTUlDKSB7CiAgICAgICAgICAvLyBPbmx5IGZvciBkeW5hbWljIGJvZGllcwogICAgICAgICAgY29uc3QgZiA9IGJpLmZvcmNlOwogICAgICAgICAgY29uc3QgbSA9IGJpLm1hc3M7CiAgICAgICAgICBmLnggKz0gbSAqIGd4OwogICAgICAgICAgZi55ICs9IG0gKiBneTsKICAgICAgICAgIGYueiArPSBtICogZ3o7CiAgICAgICAgfQogICAgICB9IC8vIFVwZGF0ZSBzdWJzeXN0ZW1zCgoKICAgICAgZm9yIChsZXQgaSA9IDAsIE5zdWJzeXN0ZW1zID0gdGhpcy5zdWJzeXN0ZW1zLmxlbmd0aDsgaSAhPT0gTnN1YnN5c3RlbXM7IGkrKykgewogICAgICAgIHRoaXMuc3Vic3lzdGVtc1tpXS51cGRhdGUoKTsKICAgICAgfSAvLyBDb2xsaXNpb24gZGV0ZWN0aW9uCgoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsaW5nU3RhcnQgPSBwZXJmb3JtYW5jZSQxLm5vdygpOwogICAgICB9CgogICAgICBwMS5sZW5ndGggPSAwOyAvLyBDbGVhbiB1cCBwYWlyIGFycmF5cyBmcm9tIGxhc3Qgc3RlcAoKICAgICAgcDIubGVuZ3RoID0gMDsKICAgICAgdGhpcy5icm9hZHBoYXNlLmNvbGxpc2lvblBhaXJzKHRoaXMsIHAxLCBwMik7CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxlLmJyb2FkcGhhc2UgPSBwZXJmb3JtYW5jZSQxLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGNvbnN0cmFpbmVkIHBhaXJzIHdpdGggY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZQoKCiAgICAgIGxldCBOY29uc3RyYWludHMgPSBjb25zdHJhaW50cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOY29uc3RyYWludHM7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBjb25zdHJhaW50c1tpXTsKCiAgICAgICAgaWYgKCFjLmNvbGxpZGVDb25uZWN0ZWQpIHsKICAgICAgICAgIGZvciAobGV0IGogPSBwMS5sZW5ndGggLSAxOyBqID49IDA7IGogLT0gMSkgewogICAgICAgICAgICBpZiAoYy5ib2R5QSA9PT0gcDFbal0gJiYgYy5ib2R5QiA9PT0gcDJbal0gfHwgYy5ib2R5QiA9PT0gcDFbal0gJiYgYy5ib2R5QSA9PT0gcDJbal0pIHsKICAgICAgICAgICAgICBwMS5zcGxpY2UoaiwgMSk7CiAgICAgICAgICAgICAgcDIuc3BsaWNlKGosIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeFRpY2soKTsgLy8gR2VuZXJhdGUgY29udGFjdHMKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2UkMS5ub3coKTsKICAgICAgfQoKICAgICAgY29uc3Qgb2xkY29udGFjdHMgPSBXb3JsZF9zdGVwX29sZENvbnRhY3RzOwogICAgICBjb25zdCBOb2xkQ29udGFjdHMgPSBjb250YWN0cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOb2xkQ29udGFjdHM7IGkrKykgewogICAgICAgIG9sZGNvbnRhY3RzLnB1c2goY29udGFjdHNbaV0pOwogICAgICB9CgogICAgICBjb250YWN0cy5sZW5ndGggPSAwOyAvLyBUcmFuc2ZlciBGcmljdGlvbkVxdWF0aW9uIGZyb20gY3VycmVudCBsaXN0IHRvIHRoZSBwb29sIGZvciByZXVzZQoKICAgICAgY29uc3QgTm9sZEZyaWN0aW9uRXF1YXRpb25zID0gdGhpcy5mcmljdGlvbkVxdWF0aW9ucy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOb2xkRnJpY3Rpb25FcXVhdGlvbnM7IGkrKykgewogICAgICAgIGZyaWN0aW9uRXF1YXRpb25Qb29sLnB1c2godGhpcy5mcmljdGlvbkVxdWF0aW9uc1tpXSk7CiAgICAgIH0KCiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoID0gMDsKICAgICAgdGhpcy5uYXJyb3dwaGFzZS5nZXRDb250YWN0cyhwMSwgcDIsIHRoaXMsIGNvbnRhY3RzLCBvbGRjb250YWN0cywgLy8gVG8gYmUgcmV1c2VkCiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMsIGZyaWN0aW9uRXF1YXRpb25Qb29sKTsKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGUubmFycm93cGhhc2UgPSBwZXJmb3JtYW5jZSQxLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gTG9vcCBvdmVyIGFsbCBjb2xsaXNpb25zCgoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsaW5nU3RhcnQgPSBwZXJmb3JtYW5jZSQxLm5vdygpOwogICAgICB9IC8vIEFkZCBhbGwgZnJpY3Rpb24gZXFzCgoKICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBzb2x2ZXIuYWRkRXF1YXRpb24odGhpcy5mcmljdGlvbkVxdWF0aW9uc1tpXSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5jb250YWN0cyA9IGNvbnRhY3RzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGsgPSAwOyBrICE9PSBuY29udGFjdHM7IGsrKykgewogICAgICAgIC8vIEN1cnJlbnQgY29udGFjdAogICAgICAgIGNvbnN0IGMgPSBjb250YWN0c1trXTsgLy8gR2V0IGN1cnJlbnQgY29sbGlzaW9uIGluZGVjZXMKCiAgICAgICAgY29uc3QgYmkgPSBjLmJpOwogICAgICAgIGNvbnN0IGJqID0gYy5iajsKICAgICAgICBjb25zdCBzaSA9IGMuc2k7CiAgICAgICAgY29uc3Qgc2ogPSBjLnNqOyAvLyBHZXQgY29sbGlzaW9uIHByb3BlcnRpZXMKCiAgICAgICAgbGV0IGNtOwoKICAgICAgICBpZiAoYmkubWF0ZXJpYWwgJiYgYmoubWF0ZXJpYWwpIHsKICAgICAgICAgIGNtID0gdGhpcy5nZXRDb250YWN0TWF0ZXJpYWwoYmkubWF0ZXJpYWwsIGJqLm1hdGVyaWFsKSB8fCB0aGlzLmRlZmF1bHRDb250YWN0TWF0ZXJpYWw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNtID0gdGhpcy5kZWZhdWx0Q29udGFjdE1hdGVyaWFsOwogICAgICAgIH0gLy8gYy5lbmFibGVkID0gYmkuY29sbGlzaW9uUmVzcG9uc2UgJiYgYmouY29sbGlzaW9uUmVzcG9uc2UgJiYgc2kuY29sbGlzaW9uUmVzcG9uc2UgJiYgc2ouY29sbGlzaW9uUmVzcG9uc2U7CgoKICAgICAgICBjbS5mcmljdGlvbjsgLy8gYy5yZXN0aXR1dGlvbiA9IGNtLnJlc3RpdHV0aW9uOwogICAgICAgIC8vIElmIGZyaWN0aW9uIG9yIHJlc3RpdHV0aW9uIHdlcmUgc3BlY2lmaWVkIGluIHRoZSBtYXRlcmlhbCwgdXNlIHRoZW0KCiAgICAgICAgaWYgKGJpLm1hdGVyaWFsICYmIGJqLm1hdGVyaWFsKSB7CiAgICAgICAgICBpZiAoYmkubWF0ZXJpYWwuZnJpY3Rpb24gPj0gMCAmJiBiai5tYXRlcmlhbC5mcmljdGlvbiA+PSAwKSB7CiAgICAgICAgICAgIGJpLm1hdGVyaWFsLmZyaWN0aW9uICogYmoubWF0ZXJpYWwuZnJpY3Rpb247CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGJpLm1hdGVyaWFsLnJlc3RpdHV0aW9uID49IDAgJiYgYmoubWF0ZXJpYWwucmVzdGl0dXRpb24gPj0gMCkgewogICAgICAgICAgICBjLnJlc3RpdHV0aW9uID0gYmkubWF0ZXJpYWwucmVzdGl0dXRpb24gKiBiai5tYXRlcmlhbC5yZXN0aXR1dGlvbjsKICAgICAgICAgIH0KICAgICAgICB9IC8vIGMuc2V0U3Bvb2tQYXJhbXMoCiAgICAgICAgLy8gICAgICAgICAgIGNtLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzcywKICAgICAgICAvLyAgICAgICAgICAgY20uY29udGFjdEVxdWF0aW9uUmVsYXhhdGlvbiwKICAgICAgICAvLyAgICAgICAgICAgZHQKICAgICAgICAvLyAgICAgICApOwoKCiAgICAgICAgc29sdmVyLmFkZEVxdWF0aW9uKGMpOyAvLyAvLyBBZGQgZnJpY3Rpb24gY29uc3RyYWludCBlcXVhdGlvbgogICAgICAgIC8vIGlmKG11ID4gMCl7CiAgICAgICAgLy8gCS8vIENyZWF0ZSAyIHRhbmdlbnQgZXF1YXRpb25zCiAgICAgICAgLy8gCWNvbnN0IG11ZyA9IG11ICogZ25vcm07CiAgICAgICAgLy8gCWNvbnN0IHJlZHVjZWRNYXNzID0gKGJpLmludk1hc3MgKyBiai5pbnZNYXNzKTsKICAgICAgICAvLyAJaWYocmVkdWNlZE1hc3MgPiAwKXsKICAgICAgICAvLyAJCXJlZHVjZWRNYXNzID0gMS9yZWR1Y2VkTWFzczsKICAgICAgICAvLyAJfQogICAgICAgIC8vIAljb25zdCBwb29sID0gZnJpY3Rpb25FcXVhdGlvblBvb2w7CiAgICAgICAgLy8gCWNvbnN0IGMxID0gcG9vbC5sZW5ndGggPyBwb29sLnBvcCgpIDogbmV3IEZyaWN0aW9uRXF1YXRpb24oYmksYmosbXVnKnJlZHVjZWRNYXNzKTsKICAgICAgICAvLyAJY29uc3QgYzIgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihiaSxiaixtdWcqcmVkdWNlZE1hc3MpOwogICAgICAgIC8vIAl0aGlzLmZyaWN0aW9uRXF1YXRpb25zLnB1c2goYzEsIGMyKTsKICAgICAgICAvLyAJYzEuYmkgPSBjMi5iaSA9IGJpOwogICAgICAgIC8vIAljMS5iaiA9IGMyLmJqID0gYmo7CiAgICAgICAgLy8gCWMxLm1pbkZvcmNlID0gYzIubWluRm9yY2UgPSAtbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAljMS5tYXhGb3JjZSA9IGMyLm1heEZvcmNlID0gbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAkvLyBDb3B5IG92ZXIgdGhlIHJlbGF0aXZlIHZlY3RvcnMKICAgICAgICAvLyAJYzEucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzEucmouY29weShjLnJqKTsKICAgICAgICAvLyAJYzIucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzIucmouY29weShjLnJqKTsKICAgICAgICAvLyAJLy8gQ29uc3RydWN0IHRhbmdlbnRzCiAgICAgICAgLy8gCWMubmkudGFuZ2VudHMoYzEudCwgYzIudCk7CiAgICAgICAgLy8gICAgICAgICAgIC8vIFNldCBzcG9vayBwYXJhbXMKICAgICAgICAvLyAgICAgICAgICAgYzEuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzIuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzEuZW5hYmxlZCA9IGMyLmVuYWJsZWQgPSBjLmVuYWJsZWQ7CiAgICAgICAgLy8gCS8vIEFkZCBlcXVhdGlvbnMgdG8gc29sdmVyCiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMSk7CiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMik7CiAgICAgICAgLy8gfQoKICAgICAgICBpZiAoYmkuYWxsb3dTbGVlcCAmJiBiaS50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmkuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiai5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJqLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRCID0gYmoudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmouYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQiA9IGJqLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRCID49IHNwZWVkTGltaXRTcXVhcmVkQiAqIDIpIHsKICAgICAgICAgICAgYmkud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoYmouYWxsb3dTbGVlcCAmJiBiai50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmouc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiaS5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJpLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRBID0gYmkudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmkuYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQSA9IGJpLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRBID49IHNwZWVkTGltaXRTcXVhcmVkQSAqIDIpIHsKICAgICAgICAgICAgYmoud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBOb3cgd2Uga25vdyB0aGF0IGkgYW5kIGogYXJlIGluIGNvbnRhY3QuIFNldCBjb2xsaXNpb24gbWF0cml4IHN0YXRlCgoKICAgICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXQoYmksIGJqLCB0cnVlKTsKCiAgICAgICAgaWYgKCF0aGlzLmNvbGxpc2lvbk1hdHJpeFByZXZpb3VzLmdldChiaSwgYmopKSB7CiAgICAgICAgICAvLyBGaXJzdCBjb250YWN0IQogICAgICAgICAgLy8gV2UgcmV1c2UgdGhlIGNvbGxpZGVFdmVudCBvYmplY3QsIG90aGVyd2lzZSB3ZSB3aWxsIGVuZCB1cCBjcmVhdGluZyBuZXcgb2JqZWN0cyBmb3IgZWFjaCBuZXcgY29udGFjdCwgZXZlbiBpZiB0aGVyZSdzIG5vIGV2ZW50IGxpc3RlbmVyIGF0dGFjaGVkLgogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuYm9keSA9IGJqOwogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuY29udGFjdCA9IGM7CiAgICAgICAgICBiaS5kaXNwYXRjaEV2ZW50KFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50KTsKICAgICAgICAgIFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50LmJvZHkgPSBiaTsKICAgICAgICAgIGJqLmRpc3BhdGNoRXZlbnQoV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5zZXQoYmkuaWQsIGJqLmlkKTsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5zZXQoc2kuaWQsIHNqLmlkKTsKICAgICAgfQoKICAgICAgdGhpcy5lbWl0Q29udGFjdEV2ZW50cygpOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5tYWtlQ29udGFjdENvbnN0cmFpbnRzID0gcGVyZm9ybWFuY2UkMS5ub3coKSAtIHByb2ZpbGluZ1N0YXJ0OwogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2UkMS5ub3coKTsKICAgICAgfSAvLyBXYWtlIHVwIGJvZGllcwoKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGJpID0gYm9kaWVzW2ldOwoKICAgICAgICBpZiAoYmkud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSkgewogICAgICAgICAgYmkud2FrZVVwKCk7CiAgICAgICAgICBiaS53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9IC8vIEFkZCB1c2VyLWFkZGVkIGNvbnN0cmFpbnRzCgoKICAgICAgTmNvbnN0cmFpbnRzID0gY29uc3RyYWludHMubGVuZ3RoOwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTmNvbnN0cmFpbnRzOyBpKyspIHsKICAgICAgICBjb25zdCBjID0gY29uc3RyYWludHNbaV07CiAgICAgICAgYy51cGRhdGUoKTsKCiAgICAgICAgZm9yIChsZXQgaiA9IDAsIE5lcSA9IGMuZXF1YXRpb25zLmxlbmd0aDsgaiAhPT0gTmVxOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGVxID0gYy5lcXVhdGlvbnNbal07CiAgICAgICAgICBzb2x2ZXIuYWRkRXF1YXRpb24oZXEpOwogICAgICAgIH0KICAgICAgfSAvLyBTb2x2ZSB0aGUgY29uc3RyYWluZWQgc3lzdGVtCgoKICAgICAgc29sdmVyLnNvbHZlKGR0LCB0aGlzKTsKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGUuc29sdmUgPSBwZXJmb3JtYW5jZSQxLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGFsbCBjb250YWN0cyBmcm9tIHNvbHZlcgoKCiAgICAgIHNvbHZlci5yZW1vdmVBbGxFcXVhdGlvbnMoKTsgLy8gQXBwbHkgZGFtcGluZywgc2VlIGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9idWxsZXQvaXNzdWVzL2RldGFpbD9pZD03NCBmb3IgZGV0YWlscwoKICAgICAgY29uc3QgcG93ID0gTWF0aC5wb3c7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgaWYgKGJpLnR5cGUgJiBEWU5BTUlDKSB7CiAgICAgICAgICAvLyBPbmx5IGZvciBkeW5hbWljIGJvZGllcwogICAgICAgICAgY29uc3QgbGQgPSBwb3coMS4wIC0gYmkubGluZWFyRGFtcGluZywgZHQpOwogICAgICAgICAgY29uc3QgdiA9IGJpLnZlbG9jaXR5OwogICAgICAgICAgdi5zY2FsZShsZCwgdik7CiAgICAgICAgICBjb25zdCBhdiA9IGJpLmFuZ3VsYXJWZWxvY2l0eTsKCiAgICAgICAgICBpZiAoYXYpIHsKICAgICAgICAgICAgY29uc3QgYWQgPSBwb3coMS4wIC0gYmkuYW5ndWxhckRhbXBpbmcsIGR0KTsKICAgICAgICAgICAgYXYuc2NhbGUoYWQsIGF2KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChXb3JsZF9zdGVwX3ByZVN0ZXBFdmVudCk7IC8vIEludm9rZSBwcmUtc3RlcCBjYWxsYmFja3MKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGJpID0gYm9kaWVzW2ldOwoKICAgICAgICBpZiAoYmkucHJlU3RlcCkgewogICAgICAgICAgYmkucHJlU3RlcC5jYWxsKGJpKTsKICAgICAgICB9CiAgICAgIH0gLy8gTGVhcCBmcm9nCiAgICAgIC8vIHZuZXcgPSB2ICsgaCpmL20KICAgICAgLy8geG5ldyA9IHggKyBoKnZuZXcKCgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlJDEubm93KCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHN0ZXBudW1iZXIgPSB0aGlzLnN0ZXBudW1iZXI7CiAgICAgIGNvbnN0IHF1YXROb3JtYWxpemUgPSBzdGVwbnVtYmVyICUgKHRoaXMucXVhdE5vcm1hbGl6ZVNraXAgKyAxKSA9PT0gMDsKICAgICAgY29uc3QgcXVhdE5vcm1hbGl6ZUZhc3QgPSB0aGlzLnF1YXROb3JtYWxpemVGYXN0OwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgYm9kaWVzW2ldLmludGVncmF0ZShkdCwgcXVhdE5vcm1hbGl6ZSwgcXVhdE5vcm1hbGl6ZUZhc3QpOwogICAgICB9CgogICAgICB0aGlzLmNsZWFyRm9yY2VzKCk7CiAgICAgIHRoaXMuYnJvYWRwaGFzZS5kaXJ0eSA9IHRydWU7CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxlLmludGVncmF0ZSA9IHBlcmZvcm1hbmNlJDEubm93KCkgLSBwcm9maWxpbmdTdGFydDsKICAgICAgfSAvLyBVcGRhdGUgc3RlcCBudW1iZXIKCgogICAgICB0aGlzLnN0ZXBudW1iZXIgKz0gMTsKICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFdvcmxkX3N0ZXBfcG9zdFN0ZXBFdmVudCk7IC8vIEludm9rZSBwb3N0LXN0ZXAgY2FsbGJhY2tzCgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKICAgICAgICBjb25zdCBwb3N0U3RlcCA9IGJpLnBvc3RTdGVwOwoKICAgICAgICBpZiAocG9zdFN0ZXApIHsKICAgICAgICAgIHBvc3RTdGVwLmNhbGwoYmkpOwogICAgICAgIH0KICAgICAgfSAvLyBTbGVlcGluZyB1cGRhdGUKCgogICAgICBsZXQgaGFzQWN0aXZlQm9kaWVzID0gdHJ1ZTsKCiAgICAgIGlmICh0aGlzLmFsbG93U2xlZXApIHsKICAgICAgICBoYXNBY3RpdmVCb2RpZXMgPSBmYWxzZTsKCiAgICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKICAgICAgICAgIGJpLnNsZWVwVGljayh0aGlzLnRpbWUpOwoKICAgICAgICAgIGlmIChiaS5zbGVlcFN0YXRlICE9PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgICAgIGhhc0FjdGl2ZUJvZGllcyA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmhhc0FjdGl2ZUJvZGllcyA9IGhhc0FjdGl2ZUJvZGllczsKICAgIH0KCiAgICBlbWl0Q29udGFjdEV2ZW50cygpIHsKICAgICAgY29uc3QgaGFzQmVnaW5Db250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdiZWdpbkNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignZW5kQ29udGFjdCcpOwoKICAgICAgaWYgKGhhc0JlZ2luQ29udGFjdCB8fCBoYXNFbmRDb250YWN0KSB7CiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5Db250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBhZGRpdGlvbnMubGVuZ3RoOyBpIDwgbDsgaSArPSAyKSB7CiAgICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IHRoaXMuZ2V0Qm9keUJ5SWQoYWRkaXRpb25zW2ldKTsKICAgICAgICAgIGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gdGhpcy5nZXRCb2R5QnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChiZWdpbkNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKGhhc0VuZENvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHJlbW92YWxzLmxlbmd0aDsgaSA8IGw7IGkgKz0gMikgewogICAgICAgICAgZW5kQ29udGFjdEV2ZW50LmJvZHlBID0gdGhpcy5nZXRCb2R5QnlJZChyZW1vdmFsc1tpXSk7CiAgICAgICAgICBlbmRDb250YWN0RXZlbnQuYm9keUIgPSB0aGlzLmdldEJvZHlCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZW5kQ29udGFjdEV2ZW50KTsKICAgICAgICB9CgogICAgICAgIGVuZENvbnRhY3RFdmVudC5ib2R5QSA9IGVuZENvbnRhY3RFdmVudC5ib2R5QiA9IG51bGw7CiAgICAgIH0KCiAgICAgIGFkZGl0aW9ucy5sZW5ndGggPSByZW1vdmFscy5sZW5ndGggPSAwOwogICAgICBjb25zdCBoYXNCZWdpblNoYXBlQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignYmVnaW5TaGFwZUNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kU2hhcGVDb250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdlbmRTaGFwZUNvbnRhY3QnKTsKCiAgICAgIGlmIChoYXNCZWdpblNoYXBlQ29udGFjdCB8fCBoYXNFbmRTaGFwZUNvbnRhY3QpIHsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5TaGFwZUNvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGFkZGl0aW9ucy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKGFkZGl0aW9uc1tpXSk7CiAgICAgICAgICBjb25zdCBzaGFwZUIgPSB0aGlzLmdldFNoYXBlQnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gc2hhcGVBOwogICAgICAgICAgYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gc2hhcGVBLmJvZHk7CiAgICAgICAgICBpZiAoc2hhcGVCKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gc2hhcGVCLmJvZHk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoYmVnaW5TaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5ib2R5QiA9IGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBudWxsOwogICAgICB9CgogICAgICBpZiAoaGFzRW5kU2hhcGVDb250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSByZW1vdmFscy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2ldKTsKICAgICAgICAgIGNvbnN0IHNoYXBlQiA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUEgPSBzaGFwZUE7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IHNoYXBlQS5ib2R5OwogICAgICAgICAgaWYgKHNoYXBlQikgZW5kU2hhcGVDb250YWN0RXZlbnQuYm9keUIgPSBzaGFwZUIuYm9keTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlbmRTaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IGVuZFNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVCID0gbnVsbDsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBib2R5IGZvcmNlcyBpbiB0aGUgd29ybGQgdG8gemVyby4KICAgICAqLwoKCiAgICBjbGVhckZvcmNlcygpIHsKICAgICAgY29uc3QgYm9kaWVzID0gdGhpcy5ib2RpZXM7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGIgPSBib2RpZXNbaV07CiAgICAgICAgYi5mb3JjZTsKICAgICAgICBiLnRvcnF1ZTsKICAgICAgICBiLmZvcmNlLnNldCgwLCAwLCAwKTsKICAgICAgICBiLnRvcnF1ZS5zZXQoMCwgMCwgMCk7CiAgICAgIH0KICAgIH0KCiAgfSAvLyBUZW1wIHN0dWZmCgoKICBuZXcgQUFCQigpOwogIGNvbnN0IHRtcFJheSA9IG5ldyBSYXkoKTsgLy8gcGVyZm9ybWFuY2Uubm93KCkgZmFsbGJhY2sgb24gRGF0ZS5ub3coKQoKICBjb25zdCBwZXJmb3JtYW5jZSQxID0gZ2xvYmFsVGhpcy5wZXJmb3JtYW5jZSB8fCB7fTsKCiAgaWYgKCFwZXJmb3JtYW5jZSQxLm5vdykgewogICAgbGV0IG5vd09mZnNldCA9IERhdGUubm93KCk7CgogICAgaWYgKHBlcmZvcm1hbmNlJDEudGltaW5nICYmIHBlcmZvcm1hbmNlJDEudGltaW5nLm5hdmlnYXRpb25TdGFydCkgewogICAgICBub3dPZmZzZXQgPSBwZXJmb3JtYW5jZSQxLnRpbWluZy5uYXZpZ2F0aW9uU3RhcnQ7CiAgICB9CgogICAgcGVyZm9ybWFuY2UkMS5ub3cgPSAoKSA9PiBEYXRlLm5vdygpIC0gbm93T2Zmc2V0OwogIH0gLy8gUmV1c2FibGUgZXZlbnQgb2JqZWN0cyB0byBzYXZlIG1lbW9yeS4KCgogIGNvbnN0IFdvcmxkX3N0ZXBfcG9zdFN0ZXBFdmVudCA9IHsKICAgIHR5cGU6ICdwb3N0U3RlcCcKICB9OyAvLyBEaXNwYXRjaGVkIGJlZm9yZSB0aGUgd29ybGQgc3RlcHMgZm9yd2FyZCBpbiB0aW1lLgoKICBjb25zdCBXb3JsZF9zdGVwX3ByZVN0ZXBFdmVudCA9IHsKICAgIHR5cGU6ICdwcmVTdGVwJwogIH07CiAgY29uc3QgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQgPSB7CiAgICB0eXBlOiBCb2R5LkNPTExJREVfRVZFTlRfTkFNRSwKICAgIGJvZHk6IG51bGwsCiAgICBjb250YWN0OiBudWxsCiAgfTsgLy8gUG9vbHMgZm9yIHVudXNlZCBvYmplY3RzCgogIGNvbnN0IFdvcmxkX3N0ZXBfb2xkQ29udGFjdHMgPSBbXTsKICBjb25zdCBXb3JsZF9zdGVwX2ZyaWN0aW9uRXF1YXRpb25Qb29sID0gW107IC8vIFJldXNhYmxlIGFycmF5cyBmb3IgY29sbGlzaW9uIHBhaXJzCgogIGNvbnN0IFdvcmxkX3N0ZXBfcDEgPSBbXTsKICBjb25zdCBXb3JsZF9zdGVwX3AyID0gW107IC8vIFN0dWZmIGZvciBlbWl0Q29udGFjdEV2ZW50cwoKICBjb25zdCBhZGRpdGlvbnMgPSBbXTsKICBjb25zdCByZW1vdmFscyA9IFtdOwogIGNvbnN0IGJlZ2luQ29udGFjdEV2ZW50ID0gewogICAgdHlwZTogJ2JlZ2luQ29udGFjdCcsCiAgICBib2R5QTogbnVsbCwKICAgIGJvZHlCOiBudWxsCiAgfTsKICBjb25zdCBlbmRDb250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnZW5kQ29udGFjdCcsCiAgICBib2R5QTogbnVsbCwKICAgIGJvZHlCOiBudWxsCiAgfTsKICBjb25zdCBiZWdpblNoYXBlQ29udGFjdEV2ZW50ID0gewogICAgdHlwZTogJ2JlZ2luU2hhcGVDb250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwsCiAgICBzaGFwZUE6IG51bGwsCiAgICBzaGFwZUI6IG51bGwKICB9OwogIGNvbnN0IGVuZFNoYXBlQ29udGFjdEV2ZW50ID0gewogICAgdHlwZTogJ2VuZFNoYXBlQ29udGFjdCcsCiAgICBib2R5QTogbnVsbCwKICAgIGJvZHlCOiBudWxsLAogICAgc2hhcGVBOiBudWxsLAogICAgc2hhcGVCOiBudWxsCiAgfTsKCiAgY29uc3QgbWFrZVZlYzMgPSAoW3gsIHksIHpdKSA9PiBuZXcgVmVjMyh4LCB5LCB6KTsKCiAgY29uc3QgcHJlcGFyZVNwaGVyZSA9IGFyZ3MgPT4gQXJyYXkuaXNBcnJheShhcmdzKSA/IGFyZ3MgOiBbYXJnc107CgogIGNvbnN0IHByZXBhcmVDb252ZXhQb2x5aGVkcm9uID0gKFt2LCBmYWNlcywgbiwgYSwgYm91bmRpbmdTcGhlcmVSYWRpdXNdKSA9PiBbewogICAgdmVydGljZXM6IHYgPyB2Lm1hcChtYWtlVmVjMykgOiB1bmRlZmluZWQsCiAgICBmYWNlcywKICAgIG5vcm1hbHM6IG4gPyBuLm1hcChtYWtlVmVjMykgOiB1bmRlZmluZWQsCiAgICBheGVzOiBhID8gYS5tYXAobWFrZVZlYzMpIDogdW5kZWZpbmVkLAogICAgYm91bmRpbmdTcGhlcmVSYWRpdXMKICB9XTsKCiAgZnVuY3Rpb24gY3JlYXRlU2hhcGUodHlwZSwgYXJncykgewogICAgc3dpdGNoICh0eXBlKSB7CiAgICAgIGNhc2UgJ0JveCc6CiAgICAgICAgcmV0dXJuIG5ldyBCb3gobmV3IFZlYzMoLi4uYXJncy5tYXAodiA9PiB2IC8gMikpKTsKICAgICAgLy8gZXh0ZW50cyA9PiBoYWxmRXh0ZW50cwoKICAgICAgY2FzZSAnQ29udmV4UG9seWhlZHJvbic6CiAgICAgICAgcmV0dXJuIG5ldyBDb252ZXhQb2x5aGVkcm9uKC4uLnByZXBhcmVDb252ZXhQb2x5aGVkcm9uKGFyZ3MpKTsKCiAgICAgIGNhc2UgJ0N5bGluZGVyJzoKICAgICAgICByZXR1cm4gbmV3IEN5bGluZGVyKC4uLmFyZ3MpOwogICAgICAvLyBbIHJhZGl1c1RvcCwgcmFkaXVzQm90dG9tLCBoZWlnaHQsIG51bVNlZ21lbnRzIF0gPSBhcmdzCgogICAgICBjYXNlICdIZWlnaHRmaWVsZCc6CiAgICAgICAgcmV0dXJuIG5ldyBIZWlnaHRmaWVsZCguLi5hcmdzKTsKICAgICAgLy8gWyBBcnJheSBkYXRhLCBvcHRpb25zOiB7bWluVmFsdWUsIG1heFZhbHVlLCBlbGVtZW50U2l6ZX0gIF0gPSBhcmdzCgogICAgICBjYXNlICdQYXJ0aWNsZSc6CiAgICAgICAgcmV0dXJuIG5ldyBQYXJ0aWNsZSgpOwogICAgICAvLyBubyBhcmdzCgogICAgICBjYXNlICdQbGFuZSc6CiAgICAgICAgcmV0dXJuIG5ldyBQbGFuZSgpOwogICAgICAvLyBubyBhcmdzLCBpbmZpbml0ZSB4IGFuZCB5CgogICAgICBjYXNlICdTcGhlcmUnOgogICAgICAgIHJldHVybiBuZXcgU3BoZXJlKC4uLnByZXBhcmVTcGhlcmUoYXJncykpOwogICAgICAvLyByYWRpdXMgPSBhcmdzCgogICAgICBjYXNlICdUcmltZXNoJzoKICAgICAgICByZXR1cm4gbmV3IFRyaW1lc2goLi4uYXJncyk7CiAgICAgIC8vIFt2ZXJ0aWNlcywgaW5kaWNlc10gPSBhcmdzCiAgICB9CiAgfQogIC8qKgogICAqCiAgICogQHBhcmFtIHV1aWQge3N0cmluZ30KICAgKiBAcGFyYW0gcHJvcHMge0JvZHlQcm9wc30KICAgKiBAcGFyYW0gdHlwZSB7Qm9keVNoYXBlVHlwZX0KICAgKiBAcmV0dXJuIHttb2R1bGU6b2JqZWN0cy9Cb2R5LkJvZHl9CiAgICovCgoKICBjb25zdCBwcm9wc1RvQm9keSA9ICh1dWlkLCBwcm9wcywgdHlwZSkgPT4gewogICAgY29uc3QgewogICAgICBhcmdzID0gW10sCiAgICAgIHBvc2l0aW9uID0gWzAsIDAsIDBdLAogICAgICByb3RhdGlvbiA9IFswLCAwLCAwXSwKICAgICAgdmVsb2NpdHkgPSBbMCwgMCwgMF0sCiAgICAgIGFuZ3VsYXJWZWxvY2l0eSA9IFswLCAwLCAwXSwKICAgICAgbGluZWFyRmFjdG9yID0gWzEsIDEsIDFdLAogICAgICBhbmd1bGFyRmFjdG9yID0gWzEsIDEsIDFdLAogICAgICB0eXBlOiBib2R5VHlwZSwKICAgICAgbWFzcywKICAgICAgbWF0ZXJpYWwsCiAgICAgIHNoYXBlcywKICAgICAgb25Db2xsaWRlLAogICAgICBjb2xsaXNpb25SZXNwb25zZSwKICAgICAgLi4uZXh0cmEKICAgIH0gPSBwcm9wczsKICAgIGNvbnN0IGJvZHkgPSBuZXcgQm9keSh7IC4uLmV4dHJhLAogICAgICBtYXNzOiBib2R5VHlwZSA9PT0gJ1N0YXRpYycgPyAwIDogbWFzcywKICAgICAgdHlwZTogYm9keVR5cGUgPyBCb2R5W2JvZHlUeXBlLnRvVXBwZXJDYXNlKCldIDogdW5kZWZpbmVkLAogICAgICBtYXRlcmlhbDogbWF0ZXJpYWwgPyBuZXcgTWF0ZXJpYWwobWF0ZXJpYWwpIDogdW5kZWZpbmVkCiAgICB9KTsKICAgIGJvZHkudXVpZCA9IHV1aWQ7CgogICAgaWYgKGNvbGxpc2lvblJlc3BvbnNlICE9PSB1bmRlZmluZWQpIHsKICAgICAgYm9keS5jb2xsaXNpb25SZXNwb25zZSA9IGNvbGxpc2lvblJlc3BvbnNlOwogICAgfQoKICAgIGlmICh0eXBlID09PSAnQ29tcG91bmQnKSB7CiAgICAgIHNoYXBlcy5mb3JFYWNoKCh7CiAgICAgICAgdHlwZSwKICAgICAgICBhcmdzLAogICAgICAgIHBvc2l0aW9uLAogICAgICAgIHJvdGF0aW9uLAogICAgICAgIG1hdGVyaWFsLAogICAgICAgIC4uLmV4dHJhCiAgICAgIH0pID0+IHsKICAgICAgICBjb25zdCBzaGFwZUJvZHkgPSBib2R5LmFkZFNoYXBlKGNyZWF0ZVNoYXBlKHR5cGUsIGFyZ3MpLCBwb3NpdGlvbiA/IG5ldyBWZWMzKC4uLnBvc2l0aW9uKSA6IHVuZGVmaW5lZCwgcm90YXRpb24gPyBuZXcgUXVhdGVybmlvbigpLnNldEZyb21FdWxlciguLi5yb3RhdGlvbikgOiB1bmRlZmluZWQpOwogICAgICAgIGlmIChtYXRlcmlhbCkgc2hhcGVCb2R5Lm1hdGVyaWFsID0gbmV3IE1hdGVyaWFsKG1hdGVyaWFsKTsKICAgICAgICBPYmplY3QuYXNzaWduKHNoYXBlQm9keSwgZXh0cmEpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGJvZHkuYWRkU2hhcGUoY3JlYXRlU2hhcGUodHlwZSwgYXJncykpOwogICAgfQoKICAgIGJvZHkucG9zaXRpb24uc2V0KHBvc2l0aW9uWzBdLCBwb3NpdGlvblsxXSwgcG9zaXRpb25bMl0pOwogICAgYm9keS5xdWF0ZXJuaW9uLnNldEZyb21FdWxlcihyb3RhdGlvblswXSwgcm90YXRpb25bMV0sIHJvdGF0aW9uWzJdKTsKICAgIGJvZHkudmVsb2NpdHkuc2V0KHZlbG9jaXR5WzBdLCB2ZWxvY2l0eVsxXSwgdmVsb2NpdHlbMl0pOwogICAgYm9keS5hbmd1bGFyVmVsb2NpdHkuc2V0KGFuZ3VsYXJWZWxvY2l0eVswXSwgYW5ndWxhclZlbG9jaXR5WzFdLCBhbmd1bGFyVmVsb2NpdHlbMl0pOwogICAgYm9keS5saW5lYXJGYWN0b3Iuc2V0KGxpbmVhckZhY3RvclswXSwgbGluZWFyRmFjdG9yWzFdLCBsaW5lYXJGYWN0b3JbMl0pOwogICAgYm9keS5hbmd1bGFyRmFjdG9yLnNldChhbmd1bGFyRmFjdG9yWzBdLCBhbmd1bGFyRmFjdG9yWzFdLCBhbmd1bGFyRmFjdG9yWzJdKTsKICAgIHJldHVybiBib2R5OwogIH07CgogIGNvbnN0IHN0YXRlID0gewogICAgYm9kaWVzOiB7fSwKICAgIHZlaGljbGVzOiB7fSwKICAgIHNwcmluZ3M6IHt9LAogICAgc3ByaW5nSW5zdGFuY2VzOiB7fSwKICAgIHJheXM6IHt9LAogICAgd29ybGQ6IG5ldyBXb3JsZCgpLAogICAgY29uZmlnOiB7CiAgICAgIHN0ZXA6IDEgLyA2MAogICAgfSwKICAgIHN1YnNjcmlwdGlvbnM6IHt9LAogICAgdGVtcFZlY3RvcjogbmV3IFZlYzMoKSwKICAgIGJvZGllc05lZWRTeW5jaW5nOiBmYWxzZSwKICAgIGxhc3RDYWxsVGltZTogdW5kZWZpbmVkCiAgfTsKCiAgZnVuY3Rpb24gc3luY0JvZGllcygpIHsKICAgIHN0YXRlLmJvZGllc05lZWRTeW5jaW5nID0gdHJ1ZTsKICAgIHN0YXRlLmJvZGllcyA9IHN0YXRlLndvcmxkLmJvZGllcy5yZWR1Y2UoKGFjYywgYm9keSkgPT4gKHsgLi4uYWNjLAogICAgICBbYm9keS51dWlkXTogYm9keQogICAgfSksIHt9KTsKICB9CgogIGZ1bmN0aW9uIGVtaXRCZWdpbkNvbnRhY3QoewogICAgYm9keUEsCiAgICBib2R5QgogIH0pIHsKICAgIGlmICghYm9keUEgfHwgIWJvZHlCKSByZXR1cm47CiAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgb3A6ICdldmVudCcsCiAgICAgIHR5cGU6ICdjb2xsaWRlQmVnaW4nLAogICAgICBib2R5QTogYm9keUEudXVpZCwKICAgICAgYm9keUI6IGJvZHlCLnV1aWQKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gZW1pdEVuZENvbnRhY3QoewogICAgYm9keUEsCiAgICBib2R5QgogIH0pIHsKICAgIGlmICghYm9keUEgfHwgIWJvZHlCKSByZXR1cm47CiAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgb3A6ICdldmVudCcsCiAgICAgIHR5cGU6ICdjb2xsaWRlRW5kJywKICAgICAgYm9keUE6IGJvZHlBLnV1aWQsCiAgICAgIGJvZHlCOiBib2R5Qi51dWlkCiAgICB9KTsKICB9CgogIHNlbGYub25tZXNzYWdlID0gZSA9PiB7CiAgICBjb25zdCB7CiAgICAgIG9wLAogICAgICB1dWlkLAogICAgICB0eXBlLAogICAgICBwb3NpdGlvbnMsCiAgICAgIHF1YXRlcm5pb25zLAogICAgICBwcm9wcwogICAgfSA9IGUuZGF0YTsKICAgIGNvbnN0IGJyb2FkcGhhc2VzID0gewogICAgICBOYWl2ZUJyb2FkcGhhc2UsCiAgICAgIFNBUEJyb2FkcGhhc2UKICAgIH07CgogICAgc3dpdGNoIChvcCkgewogICAgICBjYXNlICdpbml0JzoKICAgICAgICB7CiAgICAgICAgICBjb25zdCB7CiAgICAgICAgICAgIGdyYXZpdHksCiAgICAgICAgICAgIHRvbGVyYW5jZSwKICAgICAgICAgICAgc3RlcCwKICAgICAgICAgICAgaXRlcmF0aW9ucywKICAgICAgICAgICAgYWxsb3dTbGVlcCwKICAgICAgICAgICAgYnJvYWRwaGFzZSwKICAgICAgICAgICAgYXhpc0luZGV4LAogICAgICAgICAgICBkZWZhdWx0Q29udGFjdE1hdGVyaWFsLAogICAgICAgICAgICBxdWF0Tm9ybWFsaXplRmFzdCwKICAgICAgICAgICAgcXVhdE5vcm1hbGl6ZVNraXAsCiAgICAgICAgICAgIHNvbHZlcgogICAgICAgICAgfSA9IHByb3BzOwogICAgICAgICAgc3RhdGUud29ybGQuYWxsb3dTbGVlcCA9IGFsbG93U2xlZXA7CiAgICAgICAgICBzdGF0ZS53b3JsZC5ncmF2aXR5LnNldChncmF2aXR5WzBdLCBncmF2aXR5WzFdLCBncmF2aXR5WzJdKTsKICAgICAgICAgIHN0YXRlLndvcmxkLnF1YXROb3JtYWxpemVGYXN0ID0gcXVhdE5vcm1hbGl6ZUZhc3Q7CiAgICAgICAgICBzdGF0ZS53b3JsZC5xdWF0Tm9ybWFsaXplU2tpcCA9IHF1YXROb3JtYWxpemVTa2lwOwoKICAgICAgICAgIGlmIChzb2x2ZXIgPT09ICdTcGxpdCcpIHsKICAgICAgICAgICAgc3RhdGUud29ybGQuc29sdmVyID0gbmV3IFNwbGl0U29sdmVyKG5ldyBHU1NvbHZlcigpKTsKICAgICAgICAgIH0KCiAgICAgICAgICBzdGF0ZS53b3JsZC5zb2x2ZXIudG9sZXJhbmNlID0gdG9sZXJhbmNlOwogICAgICAgICAgc3RhdGUud29ybGQuc29sdmVyLml0ZXJhdGlvbnMgPSBpdGVyYXRpb25zOwogICAgICAgICAgc3RhdGUud29ybGQuYnJvYWRwaGFzZSA9IG5ldyAoYnJvYWRwaGFzZXNbYnJvYWRwaGFzZSArICdCcm9hZHBoYXNlJ10gfHwgTmFpdmVCcm9hZHBoYXNlKShzdGF0ZS53b3JsZCk7CiAgICAgICAgICBzdGF0ZS53b3JsZC5icm9hZHBoYXNlLmF4aXNJbmRleCA9IGF4aXNJbmRleCA9PT0gdW5kZWZpbmVkIHx8IGF4aXNJbmRleCA9PT0gbnVsbCA/IDAgOiBheGlzSW5kZXg7CiAgICAgICAgICBzdGF0ZS53b3JsZC5hZGRFdmVudExpc3RlbmVyKCdiZWdpbkNvbnRhY3QnLCBlbWl0QmVnaW5Db250YWN0KTsKICAgICAgICAgIHN0YXRlLndvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ2VuZENvbnRhY3QnLCBlbWl0RW5kQ29udGFjdCk7CiAgICAgICAgICBPYmplY3QuYXNzaWduKHN0YXRlLndvcmxkLmRlZmF1bHRDb250YWN0TWF0ZXJpYWwsIGRlZmF1bHRDb250YWN0TWF0ZXJpYWwpOwogICAgICAgICAgc3RhdGUuY29uZmlnLnN0ZXAgPSBzdGVwOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAnc3RlcCc6CiAgICAgICAgewogICAgICAgICAgY29uc3Qgbm93ID0gcGVyZm9ybWFuY2Uubm93KCkgLyAxMDAwOwoKICAgICAgICAgIGlmICghc3RhdGUubGFzdENhbGxUaW1lKSB7CiAgICAgICAgICAgIHN0YXRlLndvcmxkLnN0ZXAoc3RhdGUuY29uZmlnLnN0ZXApOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3QgdGltZVNpbmNlTGFzdENhbGwgPSBub3cgLSBzdGF0ZS5sYXN0Q2FsbFRpbWU7CiAgICAgICAgICAgIHN0YXRlLndvcmxkLnN0ZXAoc3RhdGUuY29uZmlnLnN0ZXAsIHRpbWVTaW5jZUxhc3RDYWxsKTsKICAgICAgICAgIH0KCiAgICAgICAgICBzdGF0ZS5sYXN0Q2FsbFRpbWUgPSBub3c7CiAgICAgICAgICBjb25zdCBudW1iZXJPZkJvZGllcyA9IHN0YXRlLndvcmxkLmJvZGllcy5sZW5ndGg7CgogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1iZXJPZkJvZGllczsgaSsrKSB7CiAgICAgICAgICAgIGxldCBiID0gc3RhdGUud29ybGQuYm9kaWVzW2ldLAogICAgICAgICAgICAgICAgcCA9IGIucG9zaXRpb24sCiAgICAgICAgICAgICAgICBxID0gYi5xdWF0ZXJuaW9uOwogICAgICAgICAgICBwb3NpdGlvbnNbMyAqIGkgKyAwXSA9IHAueDsKICAgICAgICAgICAgcG9zaXRpb25zWzMgKiBpICsgMV0gPSBwLnk7CiAgICAgICAgICAgIHBvc2l0aW9uc1szICogaSArIDJdID0gcC56OwogICAgICAgICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDBdID0gcS54OwogICAgICAgICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDFdID0gcS55OwogICAgICAgICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDJdID0gcS56OwogICAgICAgICAgICBxdWF0ZXJuaW9uc1s0ICogaSArIDNdID0gcS53OwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IG9ic2VydmF0aW9ucyA9IFtdOwoKICAgICAgICAgIGZvciAoY29uc3QgaWQgb2YgT2JqZWN0LmtleXMoc3RhdGUuc3Vic2NyaXB0aW9ucykpIHsKICAgICAgICAgICAgbGV0IFt1dWlkLCB0eXBlLCB0YXJnZXQgPSAnYm9kaWVzJ10gPSBzdGF0ZS5zdWJzY3JpcHRpb25zW2lkXTsKICAgICAgICAgICAgbGV0IG9iamVjdCA9IHN0YXRlW3RhcmdldF07CiAgICAgICAgICAgIGlmICghb2JqZWN0IHx8ICFvYmplY3RbdXVpZF0pIGNvbnRpbnVlOwogICAgICAgICAgICBsZXQgdmFsdWUgPSBvYmplY3RbdXVpZF1bdHlwZV07CiAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFZlYzMpIHZhbHVlID0gdmFsdWUudG9BcnJheSgpO2Vsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgUXVhdGVybmlvbikgewogICAgICAgICAgICAgIHZhbHVlLnRvRXVsZXIoc3RhdGUudGVtcFZlY3Rvcik7CiAgICAgICAgICAgICAgdmFsdWUgPSBzdGF0ZS50ZW1wVmVjdG9yLnRvQXJyYXkoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBvYnNlcnZhdGlvbnMucHVzaChbaWQsIHZhbHVlXSk7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgbWVzc2FnZSA9IHsKICAgICAgICAgICAgb3A6ICdmcmFtZScsCiAgICAgICAgICAgIHBvc2l0aW9ucywKICAgICAgICAgICAgcXVhdGVybmlvbnMsCiAgICAgICAgICAgIG9ic2VydmF0aW9ucywKICAgICAgICAgICAgYWN0aXZlOiBzdGF0ZS53b3JsZC5oYXNBY3RpdmVCb2RpZXMKICAgICAgICAgIH07CgogICAgICAgICAgaWYgKHN0YXRlLmJvZGllc05lZWRTeW5jaW5nKSB7CiAgICAgICAgICAgIG1lc3NhZ2UuYm9kaWVzID0gc3RhdGUud29ybGQuYm9kaWVzLm1hcChib2R5ID0+IGJvZHkudXVpZCk7CiAgICAgICAgICAgIHN0YXRlLmJvZGllc05lZWRTeW5jaW5nID0gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZShtZXNzYWdlLCBbcG9zaXRpb25zLmJ1ZmZlciwgcXVhdGVybmlvbnMuYnVmZmVyXSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICdhZGRCb2RpZXMnOgogICAgICAgIHsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXVpZC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBjb25zdCBib2R5ID0gcHJvcHNUb0JvZHkodXVpZFtpXSwgcHJvcHNbaV0sIHR5cGUpOwogICAgICAgICAgICBzdGF0ZS53b3JsZC5hZGRCb2R5KGJvZHkpOwogICAgICAgICAgICBpZiAocHJvcHNbaV0ub25Db2xsaWRlKSBib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NvbGxpZGUnLCAoewogICAgICAgICAgICAgIHR5cGUsCiAgICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgICB0YXJnZXQsCiAgICAgICAgICAgICAgY29udGFjdAogICAgICAgICAgICB9KSA9PiB7CiAgICAgICAgICAgICAgY29uc3QgewogICAgICAgICAgICAgICAgbmksCiAgICAgICAgICAgICAgICByaSwKICAgICAgICAgICAgICAgIHJqLAogICAgICAgICAgICAgICAgYmksCiAgICAgICAgICAgICAgICBiaiwKICAgICAgICAgICAgICAgIGlkCiAgICAgICAgICAgICAgfSA9IGNvbnRhY3Q7CiAgICAgICAgICAgICAgY29uc3QgY29udGFjdFBvaW50ID0gYmkucG9zaXRpb24udmFkZChyaSk7CiAgICAgICAgICAgICAgY29uc3QgY29udGFjdE5vcm1hbCA9IGJpID09PSBib2R5ID8gbmkgOiBuaS5zY2FsZSgtMSk7CiAgICAgICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgICBvcDogJ2V2ZW50JywKICAgICAgICAgICAgICAgIHR5cGUsCiAgICAgICAgICAgICAgICBib2R5OiBib2R5LnV1aWQsCiAgICAgICAgICAgICAgICB0YXJnZXQ6IHRhcmdldC51dWlkLAogICAgICAgICAgICAgICAgY29udGFjdDogewogICAgICAgICAgICAgICAgICBuaTogbmkudG9BcnJheSgpLAogICAgICAgICAgICAgICAgICByaTogcmkudG9BcnJheSgpLAogICAgICAgICAgICAgICAgICByajogcmoudG9BcnJheSgpLAogICAgICAgICAgICAgICAgICBiaTogYmkudXVpZCwKICAgICAgICAgICAgICAgICAgYmo6IGJqLnV1aWQsCiAgICAgICAgICAgICAgICAgIGltcGFjdFZlbG9jaXR5OiBjb250YWN0LmdldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWwoKSwKICAgICAgICAgICAgICAgICAgLy8gV29ybGQgcG9zaXRpb24gb2YgdGhlIGNvbnRhY3QKICAgICAgICAgICAgICAgICAgY29udGFjdFBvaW50OiBjb250YWN0UG9pbnQudG9BcnJheSgpLAogICAgICAgICAgICAgICAgICAvLyBOb3JtYWwgb2YgdGhlIGNvbnRhY3QsIHJlbGF0aXZlIHRvIHRoZSBjb2xsaWRpbmcgYm9keQogICAgICAgICAgICAgICAgICBjb250YWN0Tm9ybWFsOiBjb250YWN0Tm9ybWFsLnRvQXJyYXkoKSwKICAgICAgICAgICAgICAgICAgaWQKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBjb2xsaXNpb25GaWx0ZXJzOiB7CiAgICAgICAgICAgICAgICAgIGJvZHlGaWx0ZXJHcm91cDogYm9keS5jb2xsaXNpb25GaWx0ZXJHcm91cCwKICAgICAgICAgICAgICAgICAgYm9keUZpbHRlck1hc2s6IGJvZHkuY29sbGlzaW9uRmlsdGVyTWFzaywKICAgICAgICAgICAgICAgICAgdGFyZ2V0RmlsdGVyR3JvdXA6IHRhcmdldC5jb2xsaXNpb25GaWx0ZXJHcm91cCwKICAgICAgICAgICAgICAgICAgdGFyZ2V0RmlsdGVyTWFzazogdGFyZ2V0LmNvbGxpc2lvbkZpbHRlck1hc2sKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgc3luY0JvZGllcygpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAncmVtb3ZlQm9kaWVzJzoKICAgICAgICB7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHV1aWQubGVuZ3RoOyBpKyspIHN0YXRlLndvcmxkLnJlbW92ZUJvZHkoc3RhdGUuYm9kaWVzW3V1aWRbaV1dKTsKCiAgICAgICAgICBzeW5jQm9kaWVzKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICdzdWJzY3JpYmUnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgaWQsCiAgICAgICAgICAgIHR5cGUsCiAgICAgICAgICAgIHRhcmdldAogICAgICAgICAgfSA9IHByb3BzOwogICAgICAgICAgc3RhdGUuc3Vic2NyaXB0aW9uc1tpZF0gPSBbdXVpZCwgdHlwZSwgdGFyZ2V0XTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICB7CiAgICAgICAgICBkZWxldGUgc3RhdGUuc3Vic2NyaXB0aW9uc1twcm9wc107CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICdzZXRQb3NpdGlvbic6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLnBvc2l0aW9uLnNldChwcm9wc1swXSwgcHJvcHNbMV0sIHByb3BzWzJdKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldFF1YXRlcm5pb24nOgogICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5xdWF0ZXJuaW9uLnNldEZyb21FdWxlcihwcm9wc1swXSwgcHJvcHNbMV0sIHByb3BzWzJdKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldFZlbG9jaXR5JzoKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0udmVsb2NpdHkuc2V0KHByb3BzWzBdLCBwcm9wc1sxXSwgcHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0QW5ndWxhclZlbG9jaXR5JzoKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0uYW5ndWxhclZlbG9jaXR5LnNldChwcm9wc1swXSwgcHJvcHNbMV0sIHByb3BzWzJdKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldExpbmVhckZhY3Rvcic6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLmxpbmVhckZhY3Rvci5zZXQocHJvcHNbMF0sIHByb3BzWzFdLCBwcm9wc1syXSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRBbmd1bGFyRmFjdG9yJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0uYW5ndWxhckZhY3Rvci5zZXQocHJvcHNbMF0sIHByb3BzWzFdLCBwcm9wc1syXSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRNYXNzJzoKICAgICAgICAvLyBhc3N1bWUgdGhhdCBhbiB1cGRhdGUgZnJvbSB6ZXJvLW1hc3MgaW1wbGllcyBhIG5lZWQgZm9yIGR5bmFtaWNzIG9uIHN0YXRpYyBvYmouCiAgICAgICAgaWYgKHByb3BzICE9PSAwICYmIHN0YXRlLmJvZGllc1t1dWlkXS50eXBlID09PSAwKSBzdGF0ZS5ib2RpZXNbdXVpZF0udHlwZSA9IDE7CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLm1hc3MgPSBwcm9wczsKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0udXBkYXRlTWFzc1Byb3BlcnRpZXMoKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldExpbmVhckRhbXBpbmcnOgogICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5saW5lYXJEYW1waW5nID0gcHJvcHM7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRBbmd1bGFyRGFtcGluZyc6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLmFuZ3VsYXJEYW1waW5nID0gcHJvcHM7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRBbGxvd1NsZWVwJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0uYWxsb3dTbGVlcCA9IHByb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0U2xlZXBTcGVlZExpbWl0JzoKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0uc2xlZXBTcGVlZExpbWl0ID0gcHJvcHM7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRTbGVlcFRpbWVMaW1pdCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLnNsZWVwVGltZUxpbWl0ID0gcHJvcHM7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRDb2xsaXNpb25GaWx0ZXJHcm91cCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLmNvbGxpc2lvbkZpbHRlckdyb3VwID0gcHJvcHM7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRDb2xsaXNpb25GaWx0ZXJNYXNrJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0uY29sbGlzaW9uRmlsdGVyTWFzayA9IHByb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0Q29sbGlzaW9uUmVzcG9uc2UnOgogICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5jb2xsaXNpb25SZXNwb25zZSA9IHByb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0Rml4ZWRSb3RhdGlvbic6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLmZpeGVkUm90YXRpb24gPSBwcm9wczsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldElzVHJpZ2dlcic6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLmlzVHJpZ2dlciA9IHByb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0R3Jhdml0eSc6CiAgICAgICAgc3RhdGUud29ybGQuZ3Jhdml0eS5zZXQocHJvcHNbMF0sIHByb3BzWzFdLCBwcm9wc1syXSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRUb2xlcmFuY2UnOgogICAgICAgIHN0YXRlLndvcmxkLnNvbHZlci50b2xlcmFuY2UgPSBwcm9wczsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldFN0ZXAnOgogICAgICAgIHN0YXRlLmNvbmZpZy5zdGVwID0gcHJvcHM7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRJdGVyYXRpb25zJzoKICAgICAgICBzdGF0ZS53b3JsZC5zb2x2ZXIuaXRlcmF0aW9ucyA9IHByb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0QnJvYWRwaGFzZSc6CiAgICAgICAgc3RhdGUud29ybGQuYnJvYWRwaGFzZSA9IG5ldyAoYnJvYWRwaGFzZXNbcHJvcHMgKyAnQnJvYWRwaGFzZSddIHx8IE5haXZlQnJvYWRwaGFzZSkoc3RhdGUud29ybGQpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0QXhpc0luZGV4JzoKICAgICAgICBzdGF0ZS53b3JsZC5icm9hZHBoYXNlLmF4aXNJbmRleCA9IHByb3BzID09PSB1bmRlZmluZWQgfHwgcHJvcHMgPT09IG51bGwgPyAwIDogcHJvcHM7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdhcHBseUZvcmNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0uYXBwbHlGb3JjZShuZXcgVmVjMyguLi5wcm9wc1swXSksIG5ldyBWZWMzKC4uLnByb3BzWzFdKSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdhcHBseUltcHVsc2UnOgogICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5hcHBseUltcHVsc2UobmV3IFZlYzMoLi4ucHJvcHNbMF0pLCBuZXcgVmVjMyguLi5wcm9wc1sxXSkpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnYXBwbHlMb2NhbEZvcmNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0uYXBwbHlMb2NhbEZvcmNlKG5ldyBWZWMzKC4uLnByb3BzWzBdKSwgbmV3IFZlYzMoLi4ucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ2FwcGx5TG9jYWxJbXB1bHNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0uYXBwbHlMb2NhbEltcHVsc2UobmV3IFZlYzMoLi4ucHJvcHNbMF0pLCBuZXcgVmVjMyguLi5wcm9wc1sxXSkpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnYXBwbHlUb3JxdWUnOgogICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5hcHBseVRvcnF1ZShuZXcgVmVjMyguLi5wcm9wc1swXSkpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnYWRkQ29uc3RyYWludCc6CiAgICAgICAgewogICAgICAgICAgY29uc3QgW2JvZHlBLCBib2R5Qiwgb3B0bnNdID0gcHJvcHM7CiAgICAgICAgICBsZXQgewogICAgICAgICAgICBwaXZvdEEsCiAgICAgICAgICAgIHBpdm90QiwKICAgICAgICAgICAgYXhpc0EsCiAgICAgICAgICAgIGF4aXNCLAogICAgICAgICAgICAuLi5vcHRpb25zCiAgICAgICAgICB9ID0gb3B0bnM7IC8vIGlzIHRoZXJlIGEgYmV0dGVyIHdheSB0byBlbmZvcmNlIGRlZmF1bHRzPwoKICAgICAgICAgIHBpdm90QSA9IEFycmF5LmlzQXJyYXkocGl2b3RBKSA/IG5ldyBWZWMzKC4uLnBpdm90QSkgOiB1bmRlZmluZWQ7CiAgICAgICAgICBwaXZvdEIgPSBBcnJheS5pc0FycmF5KHBpdm90QikgPyBuZXcgVmVjMyguLi5waXZvdEIpIDogdW5kZWZpbmVkOwogICAgICAgICAgYXhpc0EgPSBBcnJheS5pc0FycmF5KGF4aXNBKSA/IG5ldyBWZWMzKC4uLmF4aXNBKSA6IHVuZGVmaW5lZDsKICAgICAgICAgIGF4aXNCID0gQXJyYXkuaXNBcnJheShheGlzQikgPyBuZXcgVmVjMyguLi5heGlzQikgOiB1bmRlZmluZWQ7CiAgICAgICAgICBsZXQgY29uc3RyYWludDsKCiAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICAgICAgY2FzZSAnUG9pbnRUb1BvaW50JzoKICAgICAgICAgICAgICBjb25zdHJhaW50ID0gbmV3IFBvaW50VG9Qb2ludENvbnN0cmFpbnQoc3RhdGUuYm9kaWVzW2JvZHlBXSwgcGl2b3RBLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCBwaXZvdEIsIG9wdG5zLm1heEZvcmNlKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgJ0NvbmVUd2lzdCc6CiAgICAgICAgICAgICAgY29uc3RyYWludCA9IG5ldyBDb25lVHdpc3RDb25zdHJhaW50KHN0YXRlLmJvZGllc1tib2R5QV0sIHN0YXRlLmJvZGllc1tib2R5Ql0sIHsKICAgICAgICAgICAgICAgIHBpdm90QSwKICAgICAgICAgICAgICAgIHBpdm90QiwKICAgICAgICAgICAgICAgIGF4aXNBLAogICAgICAgICAgICAgICAgYXhpc0IsCiAgICAgICAgICAgICAgICAuLi5vcHRpb25zCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICdIaW5nZSc6CiAgICAgICAgICAgICAgY29uc3RyYWludCA9IG5ldyBIaW5nZUNvbnN0cmFpbnQoc3RhdGUuYm9kaWVzW2JvZHlBXSwgc3RhdGUuYm9kaWVzW2JvZHlCXSwgewogICAgICAgICAgICAgICAgcGl2b3RBLAogICAgICAgICAgICAgICAgcGl2b3RCLAogICAgICAgICAgICAgICAgYXhpc0EsCiAgICAgICAgICAgICAgICBheGlzQiwKICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgJ0Rpc3RhbmNlJzoKICAgICAgICAgICAgICBjb25zdHJhaW50ID0gbmV3IERpc3RhbmNlQ29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCBvcHRucy5kaXN0YW5jZSwgb3B0bnMubWF4Rm9yY2UpOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAnTG9jayc6CiAgICAgICAgICAgICAgY29uc3RyYWludCA9IG5ldyBMb2NrQ29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCBvcHRucyk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgQ29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCBvcHRucyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3RyYWludC51dWlkID0gdXVpZDsKICAgICAgICAgIHN0YXRlLndvcmxkLmFkZENvbnN0cmFpbnQoY29uc3RyYWludCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICdyZW1vdmVDb25zdHJhaW50JzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoKHsKICAgICAgICAgIHV1aWQ6IHRoaXNJZAogICAgICAgIH0pID0+IHRoaXNJZCA9PT0gdXVpZCkubWFwKGMgPT4gc3RhdGUud29ybGQucmVtb3ZlQ29uc3RyYWludChjKSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdlbmFibGVDb25zdHJhaW50JzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoKHsKICAgICAgICAgIHV1aWQ6IHRoaXNJZAogICAgICAgIH0pID0+IHRoaXNJZCA9PT0gdXVpZCkubWFwKGMgPT4gYy5lbmFibGUoKSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdkaXNhYmxlQ29uc3RyYWludCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKCh7CiAgICAgICAgICB1dWlkOiB0aGlzSWQKICAgICAgICB9KSA9PiB0aGlzSWQgPT09IHV1aWQpLm1hcChjID0+IGMuZGlzYWJsZSgpKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ2VuYWJsZUNvbnN0cmFpbnRNb3Rvcic6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKCh7CiAgICAgICAgICB1dWlkOiB0aGlzSWQKICAgICAgICB9KSA9PiB0aGlzSWQgPT09IHV1aWQpLm1hcChjID0+IGMuZW5hYmxlTW90b3IoKSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdkaXNhYmxlQ29uc3RyYWludE1vdG9yJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoKHsKICAgICAgICAgIHV1aWQ6IHRoaXNJZAogICAgICAgIH0pID0+IHRoaXNJZCA9PT0gdXVpZCkubWFwKGMgPT4gYy5kaXNhYmxlTW90b3IoKSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRDb25zdHJhaW50TW90b3JTcGVlZCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKCh7CiAgICAgICAgICB1dWlkOiB0aGlzSWQKICAgICAgICB9KSA9PiB0aGlzSWQgPT09IHV1aWQpLm1hcChjID0+IGMuc2V0TW90b3JTcGVlZChwcm9wcykpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0Q29uc3RyYWludE1vdG9yTWF4Rm9yY2UnOgogICAgICAgIHN0YXRlLndvcmxkLmNvbnN0cmFpbnRzLmZpbHRlcigoewogICAgICAgICAgdXVpZDogdGhpc0lkCiAgICAgICAgfSkgPT4gdGhpc0lkID09PSB1dWlkKS5tYXAoYyA9PiBjLnNldE1vdG9yTWF4Rm9yY2UocHJvcHMpKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ2FkZFNwcmluZyc6CiAgICAgICAgewogICAgICAgICAgY29uc3QgW2JvZHlBLCBib2R5Qiwgb3B0bnNdID0gcHJvcHM7CiAgICAgICAgICBsZXQgewogICAgICAgICAgICB3b3JsZEFuY2hvckEsCiAgICAgICAgICAgIHdvcmxkQW5jaG9yQiwKICAgICAgICAgICAgbG9jYWxBbmNob3JBLAogICAgICAgICAgICBsb2NhbEFuY2hvckIsCiAgICAgICAgICAgIHJlc3RMZW5ndGgsCiAgICAgICAgICAgIHN0aWZmbmVzcywKICAgICAgICAgICAgZGFtcGluZwogICAgICAgICAgfSA9IG9wdG5zOwogICAgICAgICAgd29ybGRBbmNob3JBID0gQXJyYXkuaXNBcnJheSh3b3JsZEFuY2hvckEpID8gbmV3IFZlYzMoLi4ud29ybGRBbmNob3JBKSA6IHVuZGVmaW5lZDsKICAgICAgICAgIHdvcmxkQW5jaG9yQiA9IEFycmF5LmlzQXJyYXkod29ybGRBbmNob3JCKSA/IG5ldyBWZWMzKC4uLndvcmxkQW5jaG9yQikgOiB1bmRlZmluZWQ7CiAgICAgICAgICBsb2NhbEFuY2hvckEgPSBBcnJheS5pc0FycmF5KGxvY2FsQW5jaG9yQSkgPyBuZXcgVmVjMyguLi5sb2NhbEFuY2hvckEpIDogdW5kZWZpbmVkOwogICAgICAgICAgbG9jYWxBbmNob3JCID0gQXJyYXkuaXNBcnJheShsb2NhbEFuY2hvckIpID8gbmV3IFZlYzMoLi4ubG9jYWxBbmNob3JCKSA6IHVuZGVmaW5lZDsKICAgICAgICAgIGxldCBzcHJpbmcgPSBuZXcgU3ByaW5nKHN0YXRlLmJvZGllc1tib2R5QV0sIHN0YXRlLmJvZGllc1tib2R5Ql0sIHsKICAgICAgICAgICAgd29ybGRBbmNob3JBLAogICAgICAgICAgICB3b3JsZEFuY2hvckIsCiAgICAgICAgICAgIGxvY2FsQW5jaG9yQSwKICAgICAgICAgICAgbG9jYWxBbmNob3JCLAogICAgICAgICAgICByZXN0TGVuZ3RoLAogICAgICAgICAgICBzdGlmZm5lc3MsCiAgICAgICAgICAgIGRhbXBpbmcKICAgICAgICAgIH0pOwogICAgICAgICAgc3ByaW5nLnV1aWQgPSB1dWlkOwoKICAgICAgICAgIGxldCBwb3N0U3RlcFNwcmluZyA9ICgpID0+IHNwcmluZy5hcHBseUZvcmNlKCk7CgogICAgICAgICAgc3RhdGUuc3ByaW5nc1t1dWlkXSA9IHBvc3RTdGVwU3ByaW5nOwogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW3V1aWRdID0gc3ByaW5nOyAvLyBDb21wdXRlIHRoZSBmb3JjZSBhZnRlciBlYWNoIHN0ZXAKCiAgICAgICAgICBzdGF0ZS53b3JsZC5hZGRFdmVudExpc3RlbmVyKCdwb3N0U3RlcCcsIHN0YXRlLnNwcmluZ3NbdXVpZF0pOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAnc2V0U3ByaW5nU3RpZmZuZXNzJzoKICAgICAgICB7CiAgICAgICAgICBzdGF0ZS5zcHJpbmdJbnN0YW5jZXNbdXVpZF0uc3RpZmZuZXNzID0gcHJvcHM7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICdzZXRTcHJpbmdSZXN0TGVuZ3RoJzoKICAgICAgICB7CiAgICAgICAgICBzdGF0ZS5zcHJpbmdJbnN0YW5jZXNbdXVpZF0ucmVzdExlbmd0aCA9IHByb3BzOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAnc2V0U3ByaW5nRGFtcGluZyc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW3V1aWRdLmRhbXBpbmcgPSBwcm9wczsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ3JlbW92ZVNwcmluZyc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS5zcHJpbmdzW3V1aWRdKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ2FkZFJheSc6CiAgICAgICAgewogICAgICAgICAgY29uc3QgewogICAgICAgICAgICBmcm9tLAogICAgICAgICAgICB0bywKICAgICAgICAgICAgLi4ub3B0aW9ucwogICAgICAgICAgfSA9IHByb3BzOwogICAgICAgICAgY29uc3QgcmF5ID0gbmV3IFJheShmcm9tID8gbmV3IFZlYzMoLi4uZnJvbSkgOiB1bmRlZmluZWQsIHRvID8gbmV3IFZlYzMoLi4udG8pIDogdW5kZWZpbmVkKTsKICAgICAgICAgIG9wdGlvbnMubW9kZSA9IFJheVtvcHRpb25zLm1vZGUudG9VcHBlckNhc2UoKV07CiAgICAgICAgICBvcHRpb25zLnJlc3VsdCA9IG5ldyBSYXljYXN0UmVzdWx0KCk7CgogICAgICAgICAgc3RhdGUucmF5c1t1dWlkXSA9ICgpID0+IHsKICAgICAgICAgICAgcmF5LmludGVyc2VjdFdvcmxkKHN0YXRlLndvcmxkLCBvcHRpb25zKTsKICAgICAgICAgICAgY29uc3QgewogICAgICAgICAgICAgIGJvZHksCiAgICAgICAgICAgICAgc2hhcGUsCiAgICAgICAgICAgICAgcmF5RnJvbVdvcmxkLAogICAgICAgICAgICAgIHJheVRvV29ybGQsCiAgICAgICAgICAgICAgaGl0Tm9ybWFsV29ybGQsCiAgICAgICAgICAgICAgaGl0UG9pbnRXb3JsZCwKICAgICAgICAgICAgICAuLi5yZXN0CiAgICAgICAgICAgIH0gPSBvcHRpb25zLnJlc3VsdDsKICAgICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgb3A6ICdldmVudCcsCiAgICAgICAgICAgICAgdHlwZTogJ3JheWhpdCcsCiAgICAgICAgICAgICAgcmF5OiB7CiAgICAgICAgICAgICAgICBmcm9tLAogICAgICAgICAgICAgICAgdG8sCiAgICAgICAgICAgICAgICBkaXJlY3Rpb246IHJheS5kaXJlY3Rpb24udG9BcnJheSgpLAogICAgICAgICAgICAgICAgY29sbGlzaW9uRmlsdGVyR3JvdXA6IHJheS5jb2xsaXNpb25GaWx0ZXJHcm91cCwKICAgICAgICAgICAgICAgIGNvbGxpc2lvbkZpbHRlck1hc2s6IHJheS5jb2xsaXNpb25GaWx0ZXJNYXNrLAogICAgICAgICAgICAgICAgdXVpZAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgYm9keTogYm9keSA/IGJvZHkudXVpZCA6IG51bGwsCiAgICAgICAgICAgICAgc2hhcGU6IHNoYXBlID8geyAuLi5zaGFwZSwKICAgICAgICAgICAgICAgIGJvZHk6IGJvZHkudXVpZAogICAgICAgICAgICAgIH0gOiBudWxsLAogICAgICAgICAgICAgIHJheUZyb21Xb3JsZDogcmF5RnJvbVdvcmxkLnRvQXJyYXkoKSwKICAgICAgICAgICAgICByYXlUb1dvcmxkOiByYXlUb1dvcmxkLnRvQXJyYXkoKSwKICAgICAgICAgICAgICBoaXROb3JtYWxXb3JsZDogaGl0Tm9ybWFsV29ybGQudG9BcnJheSgpLAogICAgICAgICAgICAgIGhpdFBvaW50V29ybGQ6IGhpdFBvaW50V29ybGQudG9BcnJheSgpLAogICAgICAgICAgICAgIC4uLnJlc3QKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHN0YXRlLndvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS5yYXlzW3V1aWRdKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ3JlbW92ZVJheSc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHN0YXRlLnJheXNbdXVpZF0pOwogICAgICAgICAgZGVsZXRlIHN0YXRlLnJheXNbdXVpZF07CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICdhZGRSYXljYXN0VmVoaWNsZSc6CiAgICAgICAgewogICAgICAgICAgY29uc3QgW2NoYXNzaXNCb2R5LCB3aGVlbHMsIHdoZWVsSW5mb3MsIGluZGV4Rm9yd2FyZEF4aXMsIGluZGV4UmlnaHRBeGlzLCBpbmRleFVwQXhpc10gPSBwcm9wczsKICAgICAgICAgIGNvbnN0IHZlaGljbGUgPSBuZXcgUmF5Y2FzdFZlaGljbGUoewogICAgICAgICAgICBjaGFzc2lzQm9keTogc3RhdGUuYm9kaWVzW2NoYXNzaXNCb2R5XSwKICAgICAgICAgICAgaW5kZXhGb3J3YXJkQXhpczogaW5kZXhGb3J3YXJkQXhpcywKICAgICAgICAgICAgaW5kZXhSaWdodEF4aXM6IGluZGV4UmlnaHRBeGlzLAogICAgICAgICAgICBpbmRleFVwQXhpczogaW5kZXhVcEF4aXMKICAgICAgICAgIH0pOwogICAgICAgICAgdmVoaWNsZS53b3JsZCA9IHN0YXRlLndvcmxkOwoKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2hlZWxJbmZvcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBjb25zdCB3aGVlbEluZm8gPSB3aGVlbEluZm9zW2ldOwogICAgICAgICAgICB3aGVlbEluZm8uZGlyZWN0aW9uTG9jYWwgPSBuZXcgVmVjMyguLi53aGVlbEluZm8uZGlyZWN0aW9uTG9jYWwpOwogICAgICAgICAgICB3aGVlbEluZm8uY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludExvY2FsID0gbmV3IFZlYzMoLi4ud2hlZWxJbmZvLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbCk7CiAgICAgICAgICAgIHdoZWVsSW5mby5heGxlTG9jYWwgPSBuZXcgVmVjMyguLi53aGVlbEluZm8uYXhsZUxvY2FsKTsKICAgICAgICAgICAgdmVoaWNsZS5hZGRXaGVlbCh3aGVlbEluZm8pOwogICAgICAgICAgfQoKICAgICAgICAgIHZlaGljbGUucHJlU3RlcCA9ICgpID0+IHsKICAgICAgICAgICAgc3RhdGUudmVoaWNsZXNbdXVpZF0udXBkYXRlVmVoaWNsZShzdGF0ZS53b3JsZC5kdCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHZlaGljbGUucG9zdFN0ZXAgPSAoKSA9PiB7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RhdGUudmVoaWNsZXNbdXVpZF0ud2hlZWxJbmZvcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIHN0YXRlLnZlaGljbGVzW3V1aWRdLnVwZGF0ZVdoZWVsVHJhbnNmb3JtKGkpOwogICAgICAgICAgICAgIGNvbnN0IHQgPSBzdGF0ZS52ZWhpY2xlc1t1dWlkXS53aGVlbEluZm9zW2ldLndvcmxkVHJhbnNmb3JtOwogICAgICAgICAgICAgIGNvbnN0IHdoZWVsQm9keSA9IHN0YXRlLmJvZGllc1t3aGVlbHNbaV1dOwogICAgICAgICAgICAgIHdoZWVsQm9keS5wb3NpdGlvbi5jb3B5KHQucG9zaXRpb24pOwogICAgICAgICAgICAgIHdoZWVsQm9keS5xdWF0ZXJuaW9uLmNvcHkodC5xdWF0ZXJuaW9uKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgc3RhdGUudmVoaWNsZXNbdXVpZF0gPSB2ZWhpY2xlOwogICAgICAgICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHN0YXRlLnZlaGljbGVzW3V1aWRdLnByZVN0ZXApOwogICAgICAgICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1t1dWlkXS5wb3N0U3RlcCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICdyZW1vdmVSYXljYXN0VmVoaWNsZSc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHN0YXRlLnZlaGljbGVzW3V1aWRdLnByZVN0ZXApOwogICAgICAgICAgc3RhdGUud29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1t1dWlkXS5wb3N0U3RlcCk7CiAgICAgICAgICBzdGF0ZS52ZWhpY2xlc1t1dWlkXS53b3JsZCA9IG51bGw7CiAgICAgICAgICBkZWxldGUgc3RhdGUudmVoaWNsZXNbdXVpZF07CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICdzZXRSYXljYXN0VmVoaWNsZVN0ZWVyaW5nVmFsdWUnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFt2YWx1ZSwgd2hlZWxJbmRleF0gPSBwcm9wczsKICAgICAgICAgIHN0YXRlLnZlaGljbGVzW3V1aWRdLnNldFN0ZWVyaW5nVmFsdWUodmFsdWUsIHdoZWVsSW5kZXgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAnYXBwbHlSYXljYXN0VmVoaWNsZUVuZ2luZUZvcmNlJzoKICAgICAgICB7CiAgICAgICAgICBjb25zdCBbdmFsdWUsIHdoZWVsSW5kZXhdID0gcHJvcHM7CiAgICAgICAgICBzdGF0ZS52ZWhpY2xlc1t1dWlkXS5hcHBseUVuZ2luZUZvcmNlKHZhbHVlLCB3aGVlbEluZGV4KTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ3NldFJheWNhc3RWZWhpY2xlQnJha2UnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFticmFrZSwgd2hlZWxJbmRleF0gPSBwcm9wczsKICAgICAgICAgIHN0YXRlLnZlaGljbGVzW3V1aWRdLnNldEJyYWtlKGJyYWtlLCB3aGVlbEluZGV4KTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ3dha2VVcCc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLndha2VVcCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAnc2xlZXAnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5zbGVlcCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQogIH07Cgp9KCkpOwoK",null,!1);var A=new a.Vector3,m=new a.Vector3(1,1,1),v=new a.Quaternion,b=new a.Matrix4;function y(e,t,n){return void 0!==e?(b.compose(A.fromArray(t.positions,3*e),v.fromArray(t.quaternions,4*e),n?n.scale:m),n&&(n.matrixAutoUpdate=!1,n.matrix.copy(b)),b):b.identity()}function B(t){var n=t.children,s=t.shouldInvalidate,u=void 0===s||s,l=t.step,c=void 0===l?1/60:l,g=t.gravity,d=void 0===g?[0,-10,0]:g,I=t.tolerance,h=void 0===I?.001:I,f=t.iterations,A=void 0===f?5:f,m=t.allowSleep,v=void 0!==m&&m,b=t.broadphase,B=void 0===b?"Naive":b,G=t.axisIndex,Z=void 0===G?0:G,w=t.quatNormalizeFast,_=void 0!==w&&w,x=t.quatNormalizeSkip,S=void 0===x?0:x,R=t.solver,M=void 0===R?"GS":R,W=t.defaultContactMaterial,k=void 0===W?{contactEquationStiffness:1e6}:W,V=t.size,F=void 0===V?1e3:V,E=(0,o.useThree)().invalidate,X=(0,e.useState)((function(){return new p})),H=(0,i.Z)(X,1)[0],L=(0,e.useState)({}),z=(0,i.Z)(L,1)[0],N=(0,e.useState)((function(){return{positions:new Float32Array(3*F),quaternions:new Float32Array(4*F)}})),Y=(0,i.Z)(N,1)[0],T=(0,e.useState)({}),K=(0,i.Z)(T,1)[0],D=(0,e.useState)({}),P=(0,i.Z)(D,1)[0],U=(0,e.useRef)({}),O=(0,e.useCallback)((function(){0!==Y.positions.byteLength&&0!==Y.quaternions.byteLength&&H.postMessage((0,r.Z)({op:"step"},Y),[Y.positions.buffer,Y.quaternions.buffer])}),[]);(0,o.useFrame)(O),(0,e.useLayoutEffect)((function(){H.postMessage({op:"init",props:{gravity:d,tolerance:h,step:c,iterations:A,broadphase:B,allowSleep:v,axisIndex:Z,defaultContactMaterial:k,quatNormalizeFast:_,quatNormalizeSkip:S,solver:M}});var e,t=0;return H.onmessage=function(n){switch(n.data.op){case"frame":if(Y.positions=n.data.positions,Y.quaternions=n.data.quaternions,n.data.bodies)for(t=0;t<n.data.bodies.length;t++)e=n.data.bodies[t],U.current[e]=n.data.bodies.indexOf(e);if(n.data.observations.forEach((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];P[n]&&P[n](r)})),n.data.active){for(var o=0,s=Object.values(z);o<s.length;o++){var l=s[o];if(l instanceof a.InstancedMesh)for(var c=0;c<l.count;c++){var g=U.current["".concat(l.uuid,"/").concat(c)];void 0!==g&&l.setMatrixAt(c,y(g,Y)),l.instanceMatrix.needsUpdate=!0}else y(U.current[l.uuid],Y,l)}u&&E()}break;case"event":switch(n.data.type){case"collide":K[n.data.target]((0,r.Z)((0,r.Z)({},n.data),{},{target:z[n.data.target],body:z[n.data.body],contact:(0,r.Z)((0,r.Z)({},n.data.contact),{},{bi:z[n.data.contact.bi],bj:z[n.data.contact.bj]})}));break;case"collideBegin":K[n.data.bodyA]&&K[n.data.bodyA]({op:"event",type:"collideBegin",target:z[n.data.bodyA],body:z[n.data.bodyB]}),K[n.data.bodyB]&&K[n.data.bodyB]({op:"event",type:"collideBegin",target:z[n.data.bodyB],body:z[n.data.bodyA]});break;case"collideEnd":K[n.data.bodyA]&&K[n.data.bodyA]({op:"event",type:"collideEnd",target:z[n.data.bodyA],body:z[n.data.bodyB]}),K[n.data.bodyB]&&K[n.data.bodyB]({op:"event",type:"collideEnd",target:z[n.data.bodyB],body:z[n.data.bodyA]});break;case"rayhit":if(!K[n.data.ray.uuid])break;K[n.data.ray.uuid]((0,r.Z)((0,r.Z)({},n.data),{},{body:n.data.body?z[n.data.body]:null}))}}},function(){return H.terminate()}}),[]),function(t){var n=t.worker,r=t.gravity,i=t.tolerance,a=t.step,o=t.iterations,s=t.broadphase,u=t.axisIndex;(0,e.useEffect)((function(){n.postMessage({op:"setGravity",props:r})}),[r]),(0,e.useEffect)((function(){n.postMessage({op:"setTolerance",props:i})}),[i]),(0,e.useEffect)((function(){n.postMessage({op:"setStep",props:a})}),[a]),(0,e.useEffect)((function(){n.postMessage({op:"setIterations",props:o})}),[o]),(0,e.useEffect)((function(){n.postMessage({op:"setBroadphase",props:s})}),[s]),(0,e.useEffect)((function(){n.postMessage({op:"setAxisIndex",props:u})}),[u])}({worker:H,axisIndex:Z,broadphase:B,gravity:d,iterations:A,step:c,tolerance:h});var J=(0,e.useMemo)((function(){return{worker:H,bodies:U,refs:z,buffers:Y,events:K,subscriptions:P}}),[H,U,z,Y,K,P]);return e.createElement(C.Provider,{value:J},n)}var G=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0,0,0,0,0,0,0];(0,g.Z)(this,e),this.elements=void 0,this.elements=t}return(0,d.Z)(e,[{key:"identity",value:function(){var e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}},{key:"setZero",value:function(){var e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}},{key:"setTrace",value:function(e){var t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}},{key:"getTrace",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new w,t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}},{key:"vmult",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w,n=this.elements,r=e.x,i=e.y,a=e.z;return t.x=n[0]*r+n[1]*i+n[2]*a,t.y=n[3]*r+n[4]*i+n[5]*a,t.z=n[6]*r+n[7]*i+n[8]*a,t}},{key:"smult",value:function(e){for(var t=0;t<this.elements.length;t++)this.elements[t]*=e}},{key:"mmult",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=this.elements,i=t.elements,a=n.elements,o=r[0],s=r[1],u=r[2],l=r[3],c=r[4],g=r[5],d=r[6],I=r[7],C=r[8],h=i[0],f=i[1],p=i[2],A=i[3],m=i[4],v=i[5],b=i[6],y=i[7],B=i[8];return a[0]=o*h+s*A+u*b,a[1]=o*f+s*m+u*y,a[2]=o*p+s*v+u*B,a[3]=l*h+c*A+g*b,a[4]=l*f+c*m+g*y,a[5]=l*p+c*v+g*B,a[6]=d*h+I*A+C*b,a[7]=d*f+I*m+C*y,a[8]=d*p+I*v+C*B,n}},{key:"scale",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=this.elements,i=n.elements,a=0;3!==a;a++)i[3*a+0]=t.x*r[3*a+0],i[3*a+1]=t.y*r[3*a+1],i[3*a+2]=t.z*r[3*a+2];return n}},{key:"solve",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w,i=3,a=4,o=[];for(t=0;t<i*a;t++)o.push(0);for(t=0;t<3;t++)for(n=0;n<3;n++)o[t+a*n]=this.elements[t+3*n];o[3]=e.x,o[7]=e.y,o[11]=e.z;var s,u,l=3,c=l,g=4;do{if(0===o[(t=c-l)+a*t])for(n=t+1;n<c;n++)if(0!==o[t+a*n]){s=g;do{o[(u=g-s)+a*t]+=o[u+a*n]}while(--s);break}if(0!==o[t+a*t])for(n=t+1;n<c;n++){var d=o[t+a*n]/o[t+a*t];s=g;do{o[(u=g-s)+a*n]=u<=t?0:o[u+a*n]-o[u+a*t]*d}while(--s)}}while(--l);if(r.z=o[2*a+3]/o[2*a+2],r.y=(o[1*a+3]-o[1*a+2]*r.z)/o[1*a+1],r.x=(o[0*a+3]-o[0*a+2]*r.z-o[0*a+1]*r.y)/o[0*a+0],isNaN(r.x)||isNaN(r.y)||isNaN(r.z)||r.x===1/0||r.y===1/0||r.z===1/0)throw"Could not solve equation! Got x=["+r.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return r}},{key:"e",value:function(e,t,n){if(void 0===n)return this.elements[t+3*e];this.elements[t+3*e]=n}},{key:"copy",value:function(e){for(var t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}},{key:"toString",value:function(){for(var e="",t=0;t<9;t++)e+=this.elements[t]+",";return e}},{key:"reverse",value:function(){var t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e,i=3,a=6,o=Z;for(t=0;t<3;t++)for(n=0;n<3;n++)o[t+a*n]=this.elements[t+3*n];o[3]=1,o[9]=0,o[15]=0,o[4]=0,o[10]=1,o[16]=0,o[5]=0,o[11]=0,o[17]=1;var s,u,l=3,c=l,g=a;do{if(0===o[(t=c-l)+a*t])for(n=t+1;n<c;n++)if(0!==o[t+a*n]){s=g;do{o[(u=g-s)+a*t]+=o[u+a*n]}while(--s);break}if(0!==o[t+a*t])for(n=t+1;n<c;n++){var d=o[t+a*n]/o[t+a*t];s=g;do{o[(u=g-s)+a*n]=u<=t?0:o[u+a*n]-o[u+a*t]*d}while(--s)}}while(--l);t=2;do{n=t-1;do{var I=o[t+a*n]/o[t+a*t];s=a;do{o[(u=a-s)+a*n]=o[u+a*n]-o[u+a*t]*I}while(--s)}while(n--)}while(--t);t=2;do{var C=1/o[t+a*t];s=a;do{o[(u=a-s)+a*t]=o[u+a*t]*C}while(--s)}while(t--);t=2;do{n=2;do{if(u=o[i+n+a*t],isNaN(u)||u===1/0)throw"Could not reverse! A=["+this.toString()+"]";r.e(t,n,u)}while(n--)}while(t--);return r}},{key:"setRotationFromQuaternion",value:function(e){var t=e.x,n=e.y,r=e.z,i=e.w,a=t+t,o=n+n,s=r+r,u=t*a,l=t*o,c=t*s,g=n*o,d=n*s,I=r*s,C=i*a,h=i*o,f=i*s,p=this.elements;return p[0]=1-(g+I),p[1]=l-f,p[2]=c+h,p[3]=l+f,p[4]=1-(u+I),p[5]=d-C,p[6]=c-h,p[7]=d+C,p[8]=1-(u+g),this}},{key:"transpose",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e,r=this.elements,i=n.elements;return i[0]=r[0],i[4]=r[4],i[8]=r[8],t=r[1],i[1]=r[3],i[3]=t,t=r[2],i[2]=r[6],i[6]=t,t=r[5],i[5]=r[7],i[7]=t,n}}]),e}(),Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,g.Z)(this,e),this.x=void 0,this.y=void 0,this.z=void 0,this.x=t,this.y=n,this.z=r}return(0,d.Z)(e,[{key:"cross",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=t.x,i=t.y,a=t.z,o=this.x,s=this.y,u=this.z;return n.x=s*a-u*i,n.y=u*r-o*a,n.z=o*i-s*r,n}},{key:"set",value:function(e,t,n){return this.x=e,this.y=t,this.z=n,this}},{key:"setZero",value:function(){this.x=this.y=this.z=0}},{key:"vadd",value:function(t,n){if(!n)return new e(this.x+t.x,this.y+t.y,this.z+t.z);n.x=t.x+this.x,n.y=t.y+this.y,n.z=t.z+this.z}},{key:"vsub",value:function(t,n){if(!n)return new e(this.x-t.x,this.y-t.y,this.z-t.z);n.x=this.x-t.x,n.y=this.y-t.y,n.z=this.z-t.z}},{key:"crossmat",value:function(){return new G([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}},{key:"normalize",value:function(){var e=this.x,t=this.y,n=this.z,r=Math.sqrt(e*e+t*t+n*n);if(r>0){var i=1/r;this.x*=i,this.y*=i,this.z*=i}else this.x=0,this.y=0,this.z=0;return r}},{key:"unit",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e,n=this.x,r=this.y,i=this.z,a=Math.sqrt(n*n+r*r+i*i);return a>0?(a=1/a,t.x=n*a,t.y=r*a,t.z=i*a):(t.x=1,t.y=0,t.z=0),t}},{key:"length",value:function(){var e=this.x,t=this.y,n=this.z;return Math.sqrt(e*e+t*t+n*n)}},{key:"lengthSquared",value:function(){return this.dot(this)}},{key:"distanceTo",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z;return Math.sqrt((i-t)*(i-t)+(a-n)*(a-n)+(o-r)*(o-r))}},{key:"distanceSquared",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z;return(i-t)*(i-t)+(a-n)*(a-n)+(o-r)*(o-r)}},{key:"scale",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=this.x,i=this.y,a=this.z;return n.x=t*r,n.y=t*i,n.z=t*a,n}},{key:"vmul",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return n.x=t.x*this.x,n.y=t.y*this.y,n.z=t.z*this.z,n}},{key:"addScaledVector",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e;return r.x=this.x+t*n.x,r.y=this.y+t*n.y,r.z=this.z+t*n.z,r}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"isZero",value:function(){return 0===this.x&&0===this.y&&0===this.z}},{key:"negate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e;return t.x=-this.x,t.y=-this.y,t.z=-this.z,t}},{key:"tangents",value:function(e,t){var n=this.length();if(n>0){var r=_,i=1/n;r.set(this.x*i,this.y*i,this.z*i);var a=x;Math.abs(r.x)<.9?(a.set(1,0,0),r.cross(a,e)):(a.set(0,1,0),r.cross(a,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}},{key:"toString",value:function(){return this.x+","+this.y+","+this.z}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"lerp",value:function(e,t,n){var r=this.x,i=this.y,a=this.z;n.x=r+(e.x-r)*t,n.y=i+(e.y-i)*t,n.z=a+(e.z-a)*t}},{key:"almostEquals",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-6;return!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}},{key:"almostZero",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e-6;return!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}},{key:"isAntiparallelTo",value:function(e,t){return this.negate(S),S.almostEquals(e,t)}},{key:"clone",value:function(){return new e(this.x,this.y,this.z)}}]),e}();w.ZERO=void 0,w.UNIT_X=void 0,w.UNIT_Y=void 0,w.UNIT_Z=void 0,w.ZERO=new w(0,0,0),w.UNIT_X=new w(1,0,0),w.UNIT_Y=new w(0,1,0),w.UNIT_Z=new w(0,0,1);var _=new w,x=new w,S=new w,R=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,g.Z)(this,e),this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new w,this.upperBound=new w,t.lowerBound&&this.lowerBound.copy(t.lowerBound),t.upperBound&&this.upperBound.copy(t.upperBound)}return(0,d.Z)(e,[{key:"setFromPoints",value:function(e,t,n,r){var i=this.lowerBound,a=this.upperBound,o=n;i.copy(e[0]),o&&o.vmult(i,i),a.copy(i);for(var s=1;s<e.length;s++){var u=e[s];o&&(o.vmult(u,M),u=M),u.x>a.x&&(a.x=u.x),u.x<i.x&&(i.x=u.x),u.y>a.y&&(a.y=u.y),u.y<i.y&&(i.y=u.y),u.z>a.z&&(a.z=u.z),u.z<i.z&&(i.z=u.z)}return t&&(t.vadd(i,i),t.vadd(a,a)),r&&(i.x-=r,i.y-=r,i.z-=r,a.x+=r,a.y+=r,a.z+=r),this}},{key:"copy",value:function(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}},{key:"clone",value:function(){return(new e).copy(this)}},{key:"extend",value:function(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}},{key:"overlaps",value:function(e){var t=this.lowerBound,n=this.upperBound,r=e.lowerBound,i=e.upperBound,a=r.x<=n.x&&n.x<=i.x||t.x<=i.x&&i.x<=n.x,o=r.y<=n.y&&n.y<=i.y||t.y<=i.y&&i.y<=n.y,s=r.z<=n.z&&n.z<=i.z||t.z<=i.z&&i.z<=n.z;return a&&o&&s}},{key:"volume",value:function(){var e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}},{key:"contains",value:function(e){var t=this.lowerBound,n=this.upperBound,r=e.lowerBound,i=e.upperBound;return t.x<=r.x&&n.x>=i.x&&t.y<=r.y&&n.y>=i.y&&t.z<=r.z&&n.z>=i.z}},{key:"getCorners",value:function(e,t,n,r,i,a,o,s){var u=this.lowerBound,l=this.upperBound;e.copy(u),t.set(l.x,u.y,u.z),n.set(l.x,l.y,u.z),r.set(u.x,l.y,l.z),i.set(l.x,u.y,l.z),a.set(u.x,l.y,u.z),o.set(u.x,u.y,l.z),s.copy(l)}},{key:"toLocalFrame",value:function(e,t){var n=W,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=n[5],l=n[6],c=n[7];this.getCorners(r,i,a,o,s,u,l,c);for(var g=0;8!==g;g++){var d=n[g];e.pointToLocal(d,d)}return t.setFromPoints(n)}},{key:"toWorldFrame",value:function(e,t){var n=W,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=n[5],l=n[6],c=n[7];this.getCorners(r,i,a,o,s,u,l,c);for(var g=0;8!==g;g++){var d=n[g];e.pointToWorld(d,d)}return t.setFromPoints(n)}},{key:"overlapsRay",value:function(e){var t=e.direction,n=e.from,r=1/t.x,i=1/t.y,a=1/t.z,o=(this.lowerBound.x-n.x)*r,s=(this.upperBound.x-n.x)*r,u=(this.lowerBound.y-n.y)*i,l=(this.upperBound.y-n.y)*i,c=(this.lowerBound.z-n.z)*a,g=(this.upperBound.z-n.z)*a,d=Math.max(Math.max(Math.min(o,s),Math.min(u,l)),Math.min(c,g)),I=Math.min(Math.min(Math.max(o,s),Math.max(u,l)),Math.max(c,g));return!(I<0)&&!(d>I)}}]),e}(),M=new w,W=[new w,new w,new w,new w,new w,new w,new w,new w],k=function(){function e(){(0,g.Z)(this,e),this._listeners=void 0}return(0,d.Z)(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;return void 0===n[e]&&(n[e]=[]),n[e].includes(t)||n[e].push(t),this}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return!(void 0===n[e]||!n[e].includes(t))}},{key:"hasAnyEventListener",value:function(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}},{key:"removeEventListener",value:function(e,t){if(void 0===this._listeners)return this;var n=this._listeners;if(void 0===n[e])return this;var r=n[e].indexOf(t);return-1!==r&&n[e].splice(r,1),this}},{key:"dispatchEvent",value:function(e){if(void 0===this._listeners)return this;var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=0,r=t.length;n<r;n++)t[n].call(this,e)}return this}}]),e}(),V=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,g.Z)(this,e),this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=t,this.y=n,this.z=r,this.w=i}return(0,d.Z)(e,[{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"toString",value:function(){return this.x+","+this.y+","+this.z+","+this.w}},{key:"toArray",value:function(){return[this.x,this.y,this.z,this.w]}},{key:"setFromAxisAngle",value:function(e,t){var n=Math.sin(.5*t);return this.x=e.x*n,this.y=e.y*n,this.z=e.z*n,this.w=Math.cos(.5*t),this}},{key:"toAxisAngle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new w;this.normalize();var t=2*Math.acos(this.w),n=Math.sqrt(1-this.w*this.w);return n<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/n,e.y=this.y/n,e.z=this.z/n),[e,t]}},{key:"setFromVectors",value:function(e,t){if(e.isAntiparallelTo(t)){var n=F,r=E;e.tangents(n,r),this.setFromAxisAngle(n,Math.PI)}else{var i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(Math.pow(e.length(),2)*Math.pow(t.length(),2))+e.dot(t),this.normalize()}return this}},{key:"mult",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=this.x,i=this.y,a=this.z,o=this.w,s=t.x,u=t.y,l=t.z,c=t.w;return n.x=r*c+o*s+i*l-a*u,n.y=i*c+o*u+a*s-r*l,n.z=a*c+o*l+r*u-i*s,n.w=o*c-r*s-i*u-a*l,n}},{key:"inverse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e,n=this.x,r=this.y,i=this.z,a=this.w;this.conjugate(t);var o=1/(n*n+r*r+i*i+a*a);return t.x*=o,t.y*=o,t.z*=o,t.w*=o,t}},{key:"conjugate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e;return t.x=-this.x,t.y=-this.y,t.z=-this.z,t.w=this.w,t}},{key:"normalize",value:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}},{key:"normalizeFast",value:function(){var e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}},{key:"vmult",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w,n=e.x,r=e.y,i=e.z,a=this.x,o=this.y,s=this.z,u=this.w,l=u*n+o*i-s*r,c=u*r+s*n-a*i,g=u*i+a*r-o*n,d=-a*n-o*r-s*i;return t.x=l*u+d*-a+c*-s-g*-o,t.y=c*u+d*-o+g*-a-l*-s,t.z=g*u+d*-s+l*-o-c*-a,t}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}},{key:"toEuler",value:function(e){var t,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YZX",a=this.x,o=this.y,s=this.z,u=this.w;if("YZX"!==i)throw new Error("Euler order "+i+" not supported yet.");var l=a*o+s*u;if(l>.499&&(t=2*Math.atan2(a,u),n=Math.PI/2,r=0),l<-.499&&(t=-2*Math.atan2(a,u),n=-Math.PI/2,r=0),void 0===t){var c=a*a,g=o*o,d=s*s;t=Math.atan2(2*o*u-2*a*s,1-2*g-2*d),n=Math.asin(2*l),r=Math.atan2(2*a*u-2*o*s,1-2*c-2*d)}e.y=t,e.z=n,e.x=r}},{key:"setFromEuler",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"XYZ",i=Math.cos(e/2),a=Math.cos(t/2),o=Math.cos(n/2),s=Math.sin(e/2),u=Math.sin(t/2),l=Math.sin(n/2);return"XYZ"===r?(this.x=s*a*o+i*u*l,this.y=i*u*o-s*a*l,this.z=i*a*l+s*u*o,this.w=i*a*o-s*u*l):"YXZ"===r?(this.x=s*a*o+i*u*l,this.y=i*u*o-s*a*l,this.z=i*a*l-s*u*o,this.w=i*a*o+s*u*l):"ZXY"===r?(this.x=s*a*o-i*u*l,this.y=i*u*o+s*a*l,this.z=i*a*l+s*u*o,this.w=i*a*o-s*u*l):"ZYX"===r?(this.x=s*a*o-i*u*l,this.y=i*u*o+s*a*l,this.z=i*a*l-s*u*o,this.w=i*a*o+s*u*l):"YZX"===r?(this.x=s*a*o+i*u*l,this.y=i*u*o+s*a*l,this.z=i*a*l-s*u*o,this.w=i*a*o-s*u*l):"XZY"===r&&(this.x=s*a*o-i*u*l,this.y=i*u*o-s*a*l,this.z=i*a*l+s*u*o,this.w=i*a*o+s*u*l),this}},{key:"clone",value:function(){return new e(this.x,this.y,this.z,this.w)}},{key:"slerp",value:function(t,n){var r,i,a,o,s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e,l=this.x,c=this.y,g=this.z,d=this.w,I=t.x,C=t.y,h=t.z,f=t.w;return(i=l*I+c*C+g*h+d*f)<0&&(i=-i,I=-I,C=-C,h=-h,f=-f),1-i>1e-6?(r=Math.acos(i),a=Math.sin(r),o=Math.sin((1-n)*r)/a,s=Math.sin(n*r)/a):(o=1-n,s=n),u.x=o*l+s*I,u.y=o*c+s*C,u.z=o*g+s*h,u.w=o*d+s*f,u}},{key:"integrate",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new e,a=t.x*r.x,o=t.y*r.y,s=t.z*r.z,u=this.x,l=this.y,c=this.z,g=this.w,d=.5*n;return i.x+=d*(a*g+o*c-s*l),i.y+=d*(o*g+s*u-a*c),i.z+=d*(s*g+a*l-o*u),i.w+=d*(-a*u-o*l-s*c),i}}]),e}(),F=new w,E=new w,X=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,g.Z)(this,e),this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=e.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}return(0,d.Z)(e,[{key:"updateBoundingSphereRadius",value:function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}},{key:"volume",value:function(){throw"volume() not implemented for shape type "+this.type}},{key:"calculateLocalInertia",value:function(e,t){throw"calculateLocalInertia() not implemented for shape type "+this.type}},{key:"calculateWorldAABB",value:function(e,t,n,r){throw"calculateWorldAABB() not implemented for shape type "+this.type}}]),e}();X.idCounter=0,X.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};var H=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,g.Z)(this,e),this.position=void 0,this.quaternion=void 0,this.position=new w,this.quaternion=new V,t.position&&this.position.copy(t.position),t.quaternion&&this.quaternion.copy(t.quaternion)}return(0,d.Z)(e,[{key:"pointToLocal",value:function(t,n){return e.pointToLocalFrame(this.position,this.quaternion,t,n)}},{key:"pointToWorld",value:function(t,n){return e.pointToWorldFrame(this.position,this.quaternion,t,n)}},{key:"vectorToWorldFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w;return this.quaternion.vmult(e,t),t}}],[{key:"pointToLocalFrame",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new w;return n.vsub(e,r),t.conjugate(L),L.vmult(r,r),r}},{key:"pointToWorldFrame",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new w;return t.vmult(n,r),r.vadd(e,r),r}},{key:"vectorToWorldFrame",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new w;return e.vmult(t,n),n}},{key:"vectorToLocalFrame",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new w;return t.w*=-1,t.vmult(n,r),t.w*=-1,r}}]),e}(),L=new V,z=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,g.Z)(this,n);var i=r.vertices,a=void 0===i?[]:i,o=r.faces,s=void 0===o?[]:o,u=r.normals,l=void 0===u?[]:u,c=r.axes,d=r.boundingSphereRadius;return(e=t.call(this,{type:X.types.CONVEXPOLYHEDRON})).vertices=void 0,e.faces=void 0,e.faceNormals=void 0,e.worldVertices=void 0,e.worldVerticesNeedsUpdate=void 0,e.worldFaceNormals=void 0,e.worldFaceNormalsNeedsUpdate=void 0,e.uniqueAxes=void 0,e.uniqueEdges=void 0,e.vertices=a,e.faces=s,e.faceNormals=l,0===e.faceNormals.length&&e.computeNormals(),d?e.boundingSphereRadius=d:e.updateBoundingSphereRadius(),e.worldVertices=[],e.worldVerticesNeedsUpdate=!0,e.worldFaceNormals=[],e.worldFaceNormalsNeedsUpdate=!0,e.uniqueAxes=c?c.slice():null,e.uniqueEdges=[],e.computeEdges(),e}return(0,d.Z)(n,[{key:"computeEdges",value:function(){var e=this.faces,t=this.vertices,n=this.uniqueEdges;n.length=0;for(var r=new w,i=0;i!==e.length;i++)for(var a=e[i],o=a.length,s=0;s!==o;s++){var u=(s+1)%o;t[a[s]].vsub(t[a[u]],r),r.normalize();for(var l=!1,c=0;c!==n.length;c++)if(n[c].almostEquals(r)||n[c].almostEquals(r)){l=!0;break}l||n.push(r.clone())}}},{key:"computeNormals",value:function(){this.faceNormals.length=this.faces.length;for(var e=0;e<this.faces.length;e++){for(var t=0;t<this.faces[e].length;t++)if(!this.vertices[this.faces[e][t]])throw new Error("Vertex "+this.faces[e][t]+" not found!");var n=this.faceNormals[e]||new w;this.getFaceNormal(e,n),n.negate(n),this.faceNormals[e]=n;var r=this.vertices[this.faces[e][0]];if(n.dot(r)<0){console.error(".faceNormals["+e+"] = Vec3("+n.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(var i=0;i<this.faces[e].length;i++)console.warn(".vertices["+this.faces[e][i]+"] = Vec3("+this.vertices[this.faces[e][i]].toString()+")")}}}},{key:"getFaceNormal",value:function(e,t){var r=this.faces[e],i=this.vertices[r[0]],a=this.vertices[r[1]],o=this.vertices[r[2]];n.computeNormal(i,a,o,t)}},{key:"clipAgainstHull",value:function(e,t,n,r,i,a,o,s,u){for(var l=new w,c=-1,g=-Number.MAX_VALUE,d=0;d<n.faces.length;d++){l.copy(n.faceNormals[d]),i.vmult(l,l);var I=l.dot(a);I>g&&(g=I,c=d)}for(var C=[],h=0;h<n.faces[c].length;h++){var f=n.vertices[n.faces[c][h]],p=new w;p.copy(f),i.vmult(p,p),r.vadd(p,p),C.push(p)}c>=0&&this.clipFaceAgainstHull(a,e,t,C,o,s,u)}},{key:"findSeparatingAxis",value:function(e,t,n,r,i,a,o,s){var u=new w,l=new w,c=new w,g=new w,d=new w,I=new w,C=Number.MAX_VALUE,h=this;if(h.uniqueAxes)for(var f=0;f!==h.uniqueAxes.length;f++){n.vmult(h.uniqueAxes[f],u);var p=h.testSepAxis(u,e,t,n,r,i);if(!1===p)return!1;p<C&&(C=p,a.copy(u))}else for(var A=o?o.length:h.faces.length,m=0;m<A;m++){var v=o?o[m]:m;u.copy(h.faceNormals[v]),n.vmult(u,u);var b=h.testSepAxis(u,e,t,n,r,i);if(!1===b)return!1;b<C&&(C=b,a.copy(u))}if(e.uniqueAxes)for(var y=0;y!==e.uniqueAxes.length;y++){i.vmult(e.uniqueAxes[y],l);var B=h.testSepAxis(l,e,t,n,r,i);if(!1===B)return!1;B<C&&(C=B,a.copy(l))}else for(var G=s?s.length:e.faces.length,Z=0;Z<G;Z++){var _=s?s[Z]:Z;l.copy(e.faceNormals[_]),i.vmult(l,l);var x=h.testSepAxis(l,e,t,n,r,i);if(!1===x)return!1;x<C&&(C=x,a.copy(l))}for(var S=0;S!==h.uniqueEdges.length;S++){n.vmult(h.uniqueEdges[S],g);for(var R=0;R!==e.uniqueEdges.length;R++)if(i.vmult(e.uniqueEdges[R],d),g.cross(d,I),!I.almostZero()){I.normalize();var M=h.testSepAxis(I,e,t,n,r,i);if(!1===M)return!1;M<C&&(C=M,a.copy(I))}}return r.vsub(t,c),c.dot(a)>0&&a.negate(a),!0}},{key:"testSepAxis",value:function(e,t,r,i,a,o){n.project(this,e,r,i,N),n.project(t,e,a,o,Y);var s=N[0],u=N[1],l=Y[0],c=Y[1];if(s<c||l<u)return!1;var g=s-c,d=l-u;return g<d?g:d}},{key:"calculateLocalInertia",value:function(e,t){var n=new w,r=new w;this.computeLocalAABB(r,n);var i=n.x-r.x,a=n.y-r.y,o=n.z-r.z;t.x=1/12*e*(2*a*2*a+2*o*2*o),t.y=1/12*e*(2*i*2*i+2*o*2*o),t.z=1/12*e*(2*a*2*a+2*i*2*i)}},{key:"getPlaneConstantOfFace",value:function(e){var t=this.faces[e],n=this.faceNormals[e],r=this.vertices[t[0]];return-n.dot(r)}},{key:"clipFaceAgainstHull",value:function(e,t,n,r,i,a,o){for(var s=new w,u=new w,l=new w,c=new w,g=new w,d=new w,I=new w,C=new w,h=this,f=r,p=[],A=-1,m=Number.MAX_VALUE,v=0;v<h.faces.length;v++){s.copy(h.faceNormals[v]),n.vmult(s,s);var b=s.dot(e);b<m&&(m=b,A=v)}if(!(A<0)){var y=h.faces[A];y.connectedFaces=[];for(var B=0;B<h.faces.length;B++)for(var G=0;G<h.faces[B].length;G++)-1!==y.indexOf(h.faces[B][G])&&B!==A&&-1===y.connectedFaces.indexOf(B)&&y.connectedFaces.push(B);for(var Z=y.length,_=0;_<Z;_++){var x=h.vertices[y[_]],S=h.vertices[y[(_+1)%Z]];x.vsub(S,u),l.copy(u),n.vmult(l,l),t.vadd(l,l),c.copy(this.faceNormals[A]),n.vmult(c,c),t.vadd(c,c),l.cross(c,g),g.negate(g),d.copy(x),n.vmult(d,d),t.vadd(d,d);var R=y.connectedFaces[_];I.copy(this.faceNormals[R]);var M=this.getPlaneConstantOfFace(R);C.copy(I),n.vmult(C,C);var W=M-C.dot(t);for(this.clipFaceAgainstPlane(f,p,C,W);f.length;)f.shift();for(;p.length;)f.push(p.shift())}I.copy(this.faceNormals[A]);var k=this.getPlaneConstantOfFace(A);C.copy(I),n.vmult(C,C);for(var V=k-C.dot(t),F=0;F<f.length;F++){var E=C.dot(f[F])+V;if(E<=i&&(console.log("clamped: depth="+E+" to minDist="+i),E=i),E<=a){var X=f[F];if(E<=1e-6){var H={point:X,normal:C,depth:E};o.push(H)}}}}}},{key:"clipFaceAgainstPlane",value:function(e,t,n,r){var i,a,o=e.length;if(o<2)return t;var s=e[e.length-1],u=e[0];i=n.dot(s)+r;for(var l=0;l<o;l++){if(u=e[l],a=n.dot(u)+r,i<0)if(a<0){var c=new w;c.copy(u),t.push(c)}else{var g=new w;s.lerp(u,i/(i-a),g),t.push(g)}else if(a<0){var d=new w;s.lerp(u,i/(i-a),d),t.push(d),t.push(u)}s=u,i=a}return t}},{key:"computeWorldVertices",value:function(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new w);for(var n=this.vertices,r=this.worldVertices,i=0;i!==this.vertices.length;i++)t.vmult(n[i],r[i]),e.vadd(r[i],r[i]);this.worldVerticesNeedsUpdate=!1}},{key:"computeLocalAABB",value:function(e,t){var n=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var r=0;r<this.vertices.length;r++){var i=n[r];i.x<e.x?e.x=i.x:i.x>t.x&&(t.x=i.x),i.y<e.y?e.y=i.y:i.y>t.y&&(t.y=i.y),i.z<e.z?e.z=i.z:i.z>t.z&&(t.z=i.z)}}},{key:"computeWorldFaceNormals",value:function(e){for(var t=this.faceNormals.length;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new w);for(var n=this.faceNormals,r=this.worldFaceNormals,i=0;i!==t;i++)e.vmult(n[i],r[i]);this.worldFaceNormalsNeedsUpdate=!1}},{key:"updateBoundingSphereRadius",value:function(){for(var e=0,t=this.vertices,n=0;n!==t.length;n++){var r=t[n].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}},{key:"calculateWorldAABB",value:function(e,t,n,r){for(var i,a,o,s,u,l,c=this.vertices,g=new w,d=0;d<c.length;d++){g.copy(c[d]),t.vmult(g,g),e.vadd(g,g);var I=g;(void 0===i||I.x<i)&&(i=I.x),(void 0===s||I.x>s)&&(s=I.x),(void 0===a||I.y<a)&&(a=I.y),(void 0===u||I.y>u)&&(u=I.y),(void 0===o||I.z<o)&&(o=I.z),(void 0===l||I.z>l)&&(l=I.z)}n.set(i,a,o),r.set(s,u,l)}},{key:"volume",value:function(){return 4*Math.PI*this.boundingSphereRadius/3}},{key:"getAveragePointLocal",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new w,t=this.vertices,n=0;n<t.length;n++)e.vadd(t[n],e);return e.scale(1/t.length,e),e}},{key:"transformAllPoints",value:function(e,t){var n=this.vertices.length,r=this.vertices;if(t){for(var i=0;i<n;i++){var a=r[i];t.vmult(a,a)}for(var o=0;o<this.faceNormals.length;o++){var s=this.faceNormals[o];t.vmult(s,s)}}if(e)for(var u=0;u<n;u++){var l=r[u];l.vadd(e,l)}}},{key:"pointIsInside",value:function(e){var t=this.vertices,n=this.faces,r=this.faceNormals,i=new w;this.getAveragePointLocal(i);for(var a=0;a<this.faces.length;a++){var o=r[a],s=t[n[a][0]],u=new w;e.vsub(s,u);var l=o.dot(u),c=new w;i.vsub(s,c);var g=o.dot(c);if(l<0&&g>0||l>0&&g<0)return!1}return-1}}],[{key:"computeNormal",value:function(e,t,n,r){var i=new w,a=new w;t.vsub(e,a),n.vsub(t,i),i.cross(a,r),r.isZero()||r.normalize()}},{key:"project",value:function(e,t,n,r,i){var a=e.vertices.length,o=T,s=0,u=0,l=K,c=e.vertices;l.setZero(),H.vectorToLocalFrame(n,r,t,o),H.pointToLocalFrame(n,r,l,l);var g=l.dot(o);u=s=c[0].dot(o);for(var d=1;d<a;d++){var I=c[d].dot(o);I>s&&(s=I),I<u&&(u=I)}if((u-=g)>(s-=g)){var C=u;u=s,s=C}i[0]=s,i[1]=u}}]),n}(X),N=[],Y=[],T=new w,K=new w,D=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,g.Z)(this,n),(r=t.call(this,{type:X.types.BOX})).halfExtents=void 0,r.convexPolyhedronRepresentation=void 0,r.halfExtents=e,r.convexPolyhedronRepresentation=null,r.updateConvexPolyhedronRepresentation(),r.updateBoundingSphereRadius(),r}return(0,d.Z)(n,[{key:"updateConvexPolyhedronRepresentation",value:function(){var e=this.halfExtents.x,t=this.halfExtents.y,n=this.halfExtents.z,r=w,i=[new r(-e,-t,-n),new r(e,-t,-n),new r(e,t,-n),new r(-e,t,-n),new r(-e,-t,n),new r(e,-t,n),new r(e,t,n),new r(-e,t,n)],a=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],o=new z({vertices:i,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=o,o.material=this.material}},{key:"calculateLocalInertia",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w;return n.calculateInertia(this.halfExtents,e,t),t}},{key:"getSideNormals",value:function(e,t){var n=e,r=this.halfExtents;if(n[0].set(r.x,0,0),n[1].set(0,r.y,0),n[2].set(0,0,r.z),n[3].set(-r.x,0,0),n[4].set(0,-r.y,0),n[5].set(0,0,-r.z),void 0!==t)for(var i=0;i!==n.length;i++)t.vmult(n[i],n[i]);return n}},{key:"volume",value:function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}},{key:"updateBoundingSphereRadius",value:function(){this.boundingSphereRadius=this.halfExtents.length()}},{key:"forEachWorldCorner",value:function(e,t,n){for(var r=this.halfExtents,i=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]],a=0;a<i.length;a++)P.set(i[a][0],i[a][1],i[a][2]),t.vmult(P,P),e.vadd(P,P),n(P.x,P.y,P.z)}},{key:"calculateWorldAABB",value:function(e,t,n,r){var i=this.halfExtents;U[0].set(i.x,i.y,i.z),U[1].set(-i.x,i.y,i.z),U[2].set(-i.x,-i.y,i.z),U[3].set(-i.x,-i.y,-i.z),U[4].set(i.x,-i.y,-i.z),U[5].set(i.x,i.y,-i.z),U[6].set(-i.x,i.y,-i.z),U[7].set(i.x,-i.y,i.z);var a=U[0];t.vmult(a,a),e.vadd(a,a),r.copy(a),n.copy(a);for(var o=1;o<8;o++){var s=U[o];t.vmult(s,s),e.vadd(s,s);var u=s.x,l=s.y,c=s.z;u>r.x&&(r.x=u),l>r.y&&(r.y=l),c>r.z&&(r.z=c),u<n.x&&(n.x=u),l<n.y&&(n.y=l),c<n.z&&(n.z=c)}}}],[{key:"calculateInertia",value:function(e,t,n){var r=e;n.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),n.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),n.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}}]),n}(X),P=new w,U=[new w,new w,new w,new w,new w,new w,new w,new w],O=1,J=2,Q=4,j=0,q=1,$=2,ee=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,g.Z)(this,n),(e=t.call(this)).id=void 0,e.index=void 0,e.world=void 0,e.preStep=void 0,e.postStep=void 0,e.vlambda=void 0,e.collisionFilterGroup=void 0,e.collisionFilterMask=void 0,e.collisionResponse=void 0,e.position=void 0,e.previousPosition=void 0,e.interpolatedPosition=void 0,e.initPosition=void 0,e.velocity=void 0,e.initVelocity=void 0,e.force=void 0,e.mass=void 0,e.invMass=void 0,e.material=void 0,e.linearDamping=void 0,e.type=void 0,e.allowSleep=void 0,e.sleepState=void 0,e.sleepSpeedLimit=void 0,e.sleepTimeLimit=void 0,e.timeLastSleepy=void 0,e.wakeUpAfterNarrowphase=void 0,e.torque=void 0,e.quaternion=void 0,e.initQuaternion=void 0,e.previousQuaternion=void 0,e.interpolatedQuaternion=void 0,e.angularVelocity=void 0,e.initAngularVelocity=void 0,e.shapes=void 0,e.shapeOffsets=void 0,e.shapeOrientations=void 0,e.inertia=void 0,e.invInertia=void 0,e.invInertiaWorld=void 0,e.invMassSolve=void 0,e.invInertiaSolve=void 0,e.invInertiaWorldSolve=void 0,e.fixedRotation=void 0,e.angularDamping=void 0,e.linearFactor=void 0,e.angularFactor=void 0,e.aabb=void 0,e.aabbNeedsUpdate=void 0,e.boundingRadius=void 0,e.wlambda=void 0,e.isTrigger=void 0,e.id=n.idCounter++,e.index=-1,e.world=null,e.preStep=null,e.postStep=null,e.vlambda=new w,e.collisionFilterGroup="number"===typeof r.collisionFilterGroup?r.collisionFilterGroup:1,e.collisionFilterMask="number"===typeof r.collisionFilterMask?r.collisionFilterMask:-1,e.collisionResponse="boolean"!==typeof r.collisionResponse||r.collisionResponse,e.position=new w,e.previousPosition=new w,e.interpolatedPosition=new w,e.initPosition=new w,r.position&&(e.position.copy(r.position),e.previousPosition.copy(r.position),e.interpolatedPosition.copy(r.position),e.initPosition.copy(r.position)),e.velocity=new w,r.velocity&&e.velocity.copy(r.velocity),e.initVelocity=new w,e.force=new w;var i="number"===typeof r.mass?r.mass:0;return e.mass=i,e.invMass=i>0?1/i:0,e.material=r.material||null,e.linearDamping="number"===typeof r.linearDamping?r.linearDamping:.01,e.type=i<=0?n.STATIC:n.DYNAMIC,typeof r.type===typeof n.STATIC&&(e.type=r.type),e.allowSleep="undefined"===typeof r.allowSleep||r.allowSleep,e.sleepState=n.AWAKE,e.sleepSpeedLimit="undefined"!==typeof r.sleepSpeedLimit?r.sleepSpeedLimit:.1,e.sleepTimeLimit="undefined"!==typeof r.sleepTimeLimit?r.sleepTimeLimit:1,e.timeLastSleepy=0,e.wakeUpAfterNarrowphase=!1,e.torque=new w,e.quaternion=new V,e.initQuaternion=new V,e.previousQuaternion=new V,e.interpolatedQuaternion=new V,r.quaternion&&(e.quaternion.copy(r.quaternion),e.initQuaternion.copy(r.quaternion),e.previousQuaternion.copy(r.quaternion),e.interpolatedQuaternion.copy(r.quaternion)),e.angularVelocity=new w,r.angularVelocity&&e.angularVelocity.copy(r.angularVelocity),e.initAngularVelocity=new w,e.shapes=[],e.shapeOffsets=[],e.shapeOrientations=[],e.inertia=new w,e.invInertia=new w,e.invInertiaWorld=new G,e.invMassSolve=0,e.invInertiaSolve=new w,e.invInertiaWorldSolve=new G,e.fixedRotation="undefined"!==typeof r.fixedRotation&&r.fixedRotation,e.angularDamping="undefined"!==typeof r.angularDamping?r.angularDamping:.01,e.linearFactor=new w(1,1,1),r.linearFactor&&e.linearFactor.copy(r.linearFactor),e.angularFactor=new w(1,1,1),r.angularFactor&&e.angularFactor.copy(r.angularFactor),e.aabb=new R,e.aabbNeedsUpdate=!0,e.boundingRadius=0,e.wlambda=new w,e.isTrigger=Boolean(r.isTrigger),r.shape&&e.addShape(r.shape),e.updateMassProperties(),e}return(0,d.Z)(n,[{key:"wakeUp",value:function(){var e=this.sleepState;this.sleepState=n.AWAKE,this.wakeUpAfterNarrowphase=!1,e===n.SLEEPING&&this.dispatchEvent(n.wakeupEvent)}},{key:"sleep",value:function(){this.sleepState=n.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}},{key:"sleepTick",value:function(e){if(this.allowSleep){var t=this.sleepState,r=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),i=Math.pow(this.sleepSpeedLimit,2);t===n.AWAKE&&r<i?(this.sleepState=n.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(n.sleepyEvent)):t===n.SLEEPY&&r>i?this.wakeUp():t===n.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(n.sleepEvent))}}},{key:"updateSolveMassProperties",value:function(){this.sleepState===n.SLEEPING||this.type===n.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}},{key:"pointToLocalFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w;return e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}},{key:"vectorToLocalFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w;return this.quaternion.conjugate().vmult(e,t),t}},{key:"pointToWorldFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w;return this.quaternion.vmult(e,t),t.vadd(this.position,t),t}},{key:"vectorToWorldFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w;return this.quaternion.vmult(e,t),t}},{key:"addShape",value:function(e,t,n){var r=new w,i=new V;return t&&r.copy(t),n&&i.copy(n),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(i),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}},{key:"removeShape",value:function(e){var t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}},{key:"updateBoundingRadius",value:function(){for(var e=this.shapes,t=this.shapeOffsets,n=e.length,r=0,i=0;i!==n;i++){var a=e[i];a.updateBoundingSphereRadius();var o=t[i].length(),s=a.boundingSphereRadius;o+s>r&&(r=o+s)}this.boundingRadius=r}},{key:"updateAABB",value:function(){for(var e=this.shapes,t=this.shapeOffsets,n=this.shapeOrientations,r=e.length,i=te,a=ne,o=this.quaternion,s=this.aabb,u=re,l=0;l!==r;l++){var c=e[l];o.vmult(t[l],i),i.vadd(this.position,i),o.mult(n[l],a),c.calculateWorldAABB(i,a,u.lowerBound,u.upperBound),0===l?s.copy(u):s.extend(u)}this.aabbNeedsUpdate=!1}},{key:"updateInertiaWorld",value:function(e){var t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){var n=ie,r=ae;n.setRotationFromQuaternion(this.quaternion),n.transpose(r),n.scale(t,n),n.mmult(r,this.invInertiaWorld)}else;}},{key:"applyForce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w;if(this.type===n.DYNAMIC){this.sleepState===n.SLEEPING&&this.wakeUp();var r=oe;t.cross(e,r),this.force.vadd(e,this.force),this.torque.vadd(r,this.torque)}}},{key:"applyLocalForce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w;if(this.type===n.DYNAMIC){var r=se,i=ue;this.vectorToWorldFrame(e,r),this.vectorToWorldFrame(t,i),this.applyForce(r,i)}}},{key:"applyTorque",value:function(e){this.type===n.DYNAMIC&&(this.sleepState===n.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}},{key:"applyImpulse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w;if(this.type===n.DYNAMIC){this.sleepState===n.SLEEPING&&this.wakeUp();var r=t,i=le;i.copy(e),i.scale(this.invMass,i),this.velocity.vadd(i,this.velocity);var a=ce;r.cross(e,a),this.invInertiaWorld.vmult(a,a),this.angularVelocity.vadd(a,this.angularVelocity)}}},{key:"applyLocalImpulse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w;if(this.type===n.DYNAMIC){var r=ge,i=de;this.vectorToWorldFrame(e,r),this.vectorToWorldFrame(t,i),this.applyImpulse(r,i)}}},{key:"updateMassProperties",value:function(){var e=Ie;this.invMass=this.mass>0?1/this.mass:0;var t=this.inertia,n=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),D.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!n?1/t.x:0,t.y>0&&!n?1/t.y:0,t.z>0&&!n?1/t.z:0),this.updateInertiaWorld(!0)}},{key:"getVelocityAtWorldPoint",value:function(e,t){var n=new w;return e.vsub(this.position,n),this.angularVelocity.cross(n,t),this.velocity.vadd(t,t),t}},{key:"integrate",value:function(e,t,r){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),(this.type===n.DYNAMIC||this.type===n.KINEMATIC)&&this.sleepState!==n.SLEEPING){var i=this.velocity,a=this.angularVelocity,o=this.position,s=this.force,u=this.torque,l=this.quaternion,c=this.invMass,g=this.invInertiaWorld,d=this.linearFactor,I=c*e;i.x+=s.x*I*d.x,i.y+=s.y*I*d.y,i.z+=s.z*I*d.z;var C=g.elements,h=this.angularFactor,f=u.x*h.x,p=u.y*h.y,A=u.z*h.z;a.x+=e*(C[0]*f+C[1]*p+C[2]*A),a.y+=e*(C[3]*f+C[4]*p+C[5]*A),a.z+=e*(C[6]*f+C[7]*p+C[8]*A),o.x+=i.x*e,o.y+=i.y*e,o.z+=i.z*e,l.integrate(this.angularVelocity,e,this.angularFactor,l),t&&(r?l.normalizeFast():l.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}}]),n}(k);ee.idCounter=0,ee.COLLIDE_EVENT_NAME="collide",ee.DYNAMIC=O,ee.STATIC=J,ee.KINEMATIC=Q,ee.AWAKE=j,ee.SLEEPY=q,ee.SLEEPING=$,ee.wakeupEvent={type:"wakeup"},ee.sleepyEvent={type:"sleepy"},ee.sleepEvent={type:"sleep"};var te=new w,ne=new V,re=new R,ie=new G,ae=new G,oe=new w,se=new w,ue=new w,le=new w,ce=new w,ge=new w,de=new w,Ie=new w;new w,new w;var Ce=function(){function e(){(0,g.Z)(this,e),this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new w,this.rayToWorld=new w,this.hitNormalWorld=new w,this.hitPointWorld=new w,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}return(0,d.Z)(e,[{key:"reset",value:function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}},{key:"abort",value:function(){this.shouldStop=!0}},{key:"set",value:function(e,t,n,r,i,a,o){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(n),this.hitPointWorld.copy(r),this.shape=i,this.body=a,this.distance=o}}]),e}(),he=1,fe=2,pe=4,Ae=function(e,t,n,r,i,a,o){function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new w,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w;(0,g.Z)(this,s),this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=e.clone(),this.to=t.clone(),this.direction=new w,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=s.ANY,this.result=new Ce,this.hasHit=!1,this.callback=function(e){}}return(0,d.Z)(s,[{key:e,get:function(){return this._intersectSphere}},{key:t,get:function(){return this._intersectPlane}},{key:n,get:function(){return this._intersectBox}},{key:r,get:function(){return this._intersectConvex}},{key:i,get:function(){return this._intersectConvex}},{key:a,get:function(){return this._intersectHeightfield}},{key:o,get:function(){return this._intersectTrimesh}},{key:"intersectWorld",value:function(e,t){return this.mode=t.mode||s.ANY,this.result=t.result||new Ce,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask="undefined"!==typeof t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup="undefined"!==typeof t.collisionFilterGroup?t.collisionFilterGroup:-1,this.checkCollisionResponse="undefined"===typeof t.checkCollisionResponse||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||function(){},this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(me),ve.length=0,e.broadphase.aabbQuery(e,me,ve),this.intersectBodies(ve),this.hasHit}},{key:"intersectBody",value:function(e,t){t&&(this.result=t,this.updateDirection());var n=this.checkCollisionResponse;if((!n||e.collisionResponse)&&0!==(this.collisionFilterGroup&e.collisionFilterMask)&&0!==(e.collisionFilterGroup&this.collisionFilterMask))for(var r=Be,i=Ge,a=0,o=e.shapes.length;a<o;a++){var s=e.shapes[a];if((!n||s.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[a],i),e.quaternion.vmult(e.shapeOffsets[a],r),r.vadd(e.position,r),this.intersectShape(s,i,r,e),this.result.shouldStop))break}}},{key:"intersectBodies",value:function(e,t){t&&(this.result=t,this.updateDirection());for(var n=0,r=e.length;!this.result.shouldStop&&n<r;n++)this.intersectBody(e[n])}},{key:"updateDirection",value:function(){this.to.vsub(this.from,this.direction),this.direction.normalize()}},{key:"intersectShape",value:function(e,t,n,r){var i=function(e,t,n){n.vsub(e,De);var r=De.dot(t);return t.scale(r,Pe),Pe.vadd(e,Pe),n.distanceTo(Pe)}(this.from,this.direction,n);if(!(i>e.boundingSphereRadius)){var a=this[e.type];a&&a.call(this,e,t,n,r,e)}}},{key:"_intersectBox",value:function(e,t,n,r,i){return this._intersectConvex(e.convexPolyhedronRepresentation,t,n,r,i)}},{key:"_intersectPlane",value:function(e,t,n,r,i){var a=this.from,o=this.to,s=this.direction,u=new w(0,0,1);t.vmult(u,u);var l=new w;a.vsub(n,l);var c=l.dot(u);if(o.vsub(n,l),!(c*l.dot(u)>0)&&!(a.distanceTo(o)<c)){var g=u.dot(s);if(!(Math.abs(g)<this.precision)){var d=new w,I=new w,C=new w;a.vsub(n,d);var h=-u.dot(d)/g;s.scale(h,I),a.vadd(I,C),this.reportIntersection(u,C,i,r,-1)}}}},{key:"getAABB",value:function(e){var t=e.lowerBound,n=e.upperBound,r=this.to,i=this.from;t.x=Math.min(r.x,i.x),t.y=Math.min(r.y,i.y),t.z=Math.min(r.z,i.z),n.x=Math.max(r.x,i.x),n.y=Math.max(r.y,i.y),n.z=Math.max(r.z,i.z)}},{key:"_intersectHeightfield",value:function(e,t,n,r,i){e.data,e.elementSize;var a=Me;a.from.copy(this.from),a.to.copy(this.to),H.pointToLocalFrame(n,t,a.from,a.from),H.pointToLocalFrame(n,t,a.to,a.to),a.updateDirection();var o,s,u,l,c=We;o=s=0,u=l=e.data.length-1;var g=new R;a.getAABB(g),e.getIndexOfPosition(g.lowerBound.x,g.lowerBound.y,c,!0),o=Math.max(o,c[0]),s=Math.max(s,c[1]),e.getIndexOfPosition(g.upperBound.x,g.upperBound.y,c,!0),u=Math.min(u,c[0]+1),l=Math.min(l,c[1]+1);for(var d=o;d<u;d++)for(var I=s;I<l;I++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(d,I,g),g.overlapsRay(a)){if(e.getConvexTrianglePillar(d,I,!1),H.pointToWorldFrame(n,t,e.pillarOffset,Re),this._intersectConvex(e.pillarConvex,t,Re,r,i,Se),this.result.shouldStop)return;e.getConvexTrianglePillar(d,I,!0),H.pointToWorldFrame(n,t,e.pillarOffset,Re),this._intersectConvex(e.pillarConvex,t,Re,r,i,Se)}}}},{key:"_intersectSphere",value:function(e,t,n,r,i){var a=this.from,o=this.to,s=e.radius,u=Math.pow(o.x-a.x,2)+Math.pow(o.y-a.y,2)+Math.pow(o.z-a.z,2),l=2*((o.x-a.x)*(a.x-n.x)+(o.y-a.y)*(a.y-n.y)+(o.z-a.z)*(a.z-n.z)),c=Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2)+Math.pow(a.z-n.z,2)-Math.pow(s,2),g=Math.pow(l,2)-4*u*c,d=ke,I=Ve;if(!(g<0))if(0===g)a.lerp(o,g,d),d.vsub(n,I),I.normalize(),this.reportIntersection(I,d,i,r,-1);else{var C=(-l-Math.sqrt(g))/(2*u),h=(-l+Math.sqrt(g))/(2*u);if(C>=0&&C<=1&&(a.lerp(o,C,d),d.vsub(n,I),I.normalize(),this.reportIntersection(I,d,i,r,-1)),this.result.shouldStop)return;h>=0&&h<=1&&(a.lerp(o,h,d),d.vsub(n,I),I.normalize(),this.reportIntersection(I,d,i,r,-1))}}},{key:"_intersectConvex",value:function(e,t,n,r,i,a){for(var o=Fe,u=Ee,l=a&&a.faceList||null,c=e.faces,g=e.vertices,d=e.faceNormals,I=this.direction,C=this.from,h=this.to,f=C.distanceTo(h),p=l?l.length:c.length,A=this.result,m=0;!A.shouldStop&&m<p;m++){var v=l?l[m]:m,b=c[v],y=d[v],B=t,G=n;u.copy(g[b[0]]),B.vmult(u,u),u.vadd(G,u),u.vsub(C,u),B.vmult(y,o);var Z=I.dot(o);if(!(Math.abs(Z)<this.precision)){var w=o.dot(u)/Z;if(!(w<0)){I.scale(w,Ze),Ze.vadd(C,Ze),we.copy(g[b[0]]),B.vmult(we,we),G.vadd(we,we);for(var _=1;!A.shouldStop&&_<b.length-1;_++){_e.copy(g[b[_]]),xe.copy(g[b[_+1]]),B.vmult(_e,_e),B.vmult(xe,xe),G.vadd(_e,_e),G.vadd(xe,xe);var x=Ze.distanceTo(C);!s.pointInTriangle(Ze,we,_e,xe)&&!s.pointInTriangle(Ze,_e,we,xe)||x>f||this.reportIntersection(o,Ze,i,r,v)}}}}}},{key:"_intersectTrimesh",value:function(e,t,n,r,i,a){var o=Xe,u=Te,l=Ke,c=Ee,g=He,d=Le,I=ze,C=Ye,h=Ne,f=e.indices;e.vertices;var p=this.from,A=this.to,m=this.direction;l.position.copy(n),l.quaternion.copy(t),H.vectorToLocalFrame(n,t,m,g),H.pointToLocalFrame(n,t,p,d),H.pointToLocalFrame(n,t,A,I),I.x*=e.scale.x,I.y*=e.scale.y,I.z*=e.scale.z,d.x*=e.scale.x,d.y*=e.scale.y,d.z*=e.scale.z,I.vsub(d,g),g.normalize();var v=d.distanceSquared(I);e.tree.rayQuery(this,l,u);for(var b=0,y=u.length;!this.result.shouldStop&&b!==y;b++){var B=u[b];e.getNormal(B,o),e.getVertex(f[3*B],we),we.vsub(d,c);var G=g.dot(o),Z=o.dot(c)/G;if(!(Z<0)){g.scale(Z,Ze),Ze.vadd(d,Ze),e.getVertex(f[3*B+1],_e),e.getVertex(f[3*B+2],xe);var w=Ze.distanceSquared(d);!s.pointInTriangle(Ze,_e,we,xe)&&!s.pointInTriangle(Ze,we,_e,xe)||w>v||(H.vectorToWorldFrame(t,o,h),H.pointToWorldFrame(n,t,Ze,C),this.reportIntersection(h,C,i,r,B))}}u.length=0}},{key:"reportIntersection",value:function(e,t,n,r,i){var a=this.from,o=this.to,u=a.distanceTo(t),l=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(l.hitFaceIndex="undefined"!==typeof i?i:-1,this.mode){case s.ALL:this.hasHit=!0,l.set(a,o,e,t,n,r,u),l.hasHit=!0,this.callback(l);break;case s.CLOSEST:(u<l.distance||!l.hasHit)&&(this.hasHit=!0,l.hasHit=!0,l.set(a,o,e,t,n,r,u));break;case s.ANY:this.hasHit=!0,l.hasHit=!0,l.set(a,o,e,t,n,r,u),l.shouldStop=!0}}}],[{key:"pointInTriangle",value:function(e,t,n,r){r.vsub(t,De),n.vsub(t,be),e.vsub(t,ye);var i,a,o=De.dot(De),s=De.dot(be),u=De.dot(ye),l=be.dot(be),c=be.dot(ye);return(i=l*u-s*c)>=0&&(a=o*c-s*u)>=0&&i+a<o*l-s*s}}]),s}(X.types.SPHERE,X.types.PLANE,X.types.BOX,X.types.CYLINDER,X.types.CONVEXPOLYHEDRON,X.types.HEIGHTFIELD,X.types.TRIMESH);Ae.CLOSEST=he,Ae.ANY=fe,Ae.ALL=pe;var me=new R,ve=[],be=new w,ye=new w,Be=new w,Ge=new V,Ze=new w,we=new w,_e=new w,xe=new w,Se={faceList:[0]},Re=new w,Me=new Ae,We=[],ke=new w,Ve=new w,Fe=new w,Ee=new w,Xe=new w,He=new w,Le=new w,ze=new w,Ne=new w,Ye=new w;new R;var Te=[],Ke=new H,De=new w,Pe=new w;new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w;var Ue=(0,d.Z)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,g.Z)(this,e),this.name=void 0,this.id=void 0,this.friction=void 0,this.restitution=void 0;var n="";"string"===typeof t&&(n=t,t={}),this.name=n,this.id=e.idCounter++,this.friction="undefined"!==typeof t.friction?t.friction:-1,this.restitution="undefined"!==typeof t.restitution?t.restitution:-1}));Ue.idCounter=0,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new Ae,new w,new w,new w(1,0,0),new w(0,1,0),new w(0,0,1),new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w;new w,new w,new w,new w,new w,new w,new w,new w,new w;new w,new w,new w,new w,new w,new w,new w,new w,new w,new w;new w,new R,new w,new R,new w,new w,new w,new w,new w,new w,new w,new R,new w,new H,new R;X.types.SPHERE,X.types.SPHERE,X.types.PLANE,X.types.BOX,X.types.BOX,X.types.SPHERE,X.types.BOX,X.types.PLANE,X.types.BOX,X.types.CONVEXPOLYHEDRON,X.types.SPHERE,X.types.CONVEXPOLYHEDRON,X.types.PLANE,X.types.CONVEXPOLYHEDRON,X.types.BOX,X.types.CONVEXPOLYHEDRON,X.types.SPHERE,X.types.HEIGHTFIELD,X.types.BOX,X.types.HEIGHTFIELD,X.types.CONVEXPOLYHEDRON,X.types.HEIGHTFIELD,X.types.PARTICLE,X.types.SPHERE,X.types.PLANE,X.types.PARTICLE,X.types.BOX,X.types.PARTICLE,X.types.PARTICLE,X.types.CONVEXPOLYHEDRON,X.types.CYLINDER,X.types.SPHERE,X.types.CYLINDER,X.types.PLANE,X.types.CYLINDER,X.types.BOX,X.types.CYLINDER,X.types.CONVEXPOLYHEDRON,X.types.CYLINDER,X.types.HEIGHTFIELD,X.types.CYLINDER,X.types.PARTICLE,X.types.CYLINDER,X.types.SPHERE,X.types.TRIMESH,X.types.PLANE,X.types.TRIMESH,new w,new w,new w,new w,new w,new V,new V,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new R,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new w,new V,new w,new w,new w,new w,new w,new w,new w,new w,new R,new Ae;var Oe=globalThis.performance||{};if(!Oe.now){var Je=Date.now();Oe.timing&&Oe.timing.navigationStart&&(Je=Oe.timing.navigationStart),Oe.now=function(){return Date.now()-Je}}new a.Vector3,new a.Vector3(1,1,1),new a.Quaternion;var Qe=new a.Object3D;function je(e,t){return e+t.charAt(0).toUpperCase()+t.slice(1)}function qe(e,t){return void 0!==t?"".concat(e.current.uuid,"/").concat(t):e.current.uuid}function $e(e,t,n,r,i){return e.current&&t.postMessage({op:n,uuid:qe(e,r),props:i})}function et(e,t,n,r,i,a){return function(o){var s=rt++;return n[s]=o,$e(e,t,"subscribe",i,{id:s,type:r,target:void 0===a||null===a?"bodies":a}),function(){delete n[s],t.postMessage({op:"unsubscribe",props:s})}}}function tt(e,t){var n,r;e.userData=t.userData||{},(n=e.position).set.apply(n,(0,u.Z)(t.position||[0,0,0])),(r=e.rotation).set.apply(r,(0,u.Z)(t.rotation||[0,0,0])),e.updateMatrix()}function nt(e,t,n){var r=t.onCollide,i=t.onCollideBegin,a=t.onCollideEnd;(r||i||a)&&(e[n]=function(e){switch(e.type){case"collide":r&&r(e);break;case"collideBegin":i&&i(e);break;case"collideEnd":a&&a(e)}})}var rt=0;function it(t,n,i,o){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],l=(0,e.useRef)(null),c=o||l,g=(0,e.useContext)(C),d=g.worker,f=g.refs,p=g.events,A=g.subscriptions,m=(0,e.useContext)(h);(0,e.useLayoutEffect)((function(){c.current||(c.current=new a.Object3D);var e=c.current,o=d,u=e instanceof a.InstancedMesh?(e.instanceMatrix.setUsage(a.DynamicDrawUsage),e.count):1,l=e instanceof a.InstancedMesh?new Array(u).fill(0).map((function(t,n){return"".concat(e.uuid,"/").concat(n)})):[e.uuid],g=e instanceof a.InstancedMesh?l.map((function(a,o){var s=n(o);return tt(Qe,s),e.setMatrixAt(o,Qe.matrix),e.instanceMatrix.needsUpdate=!0,f[a]=e,m&&m.add(a,s,t),nt(p,s,a),(0,r.Z)((0,r.Z)({},s),{},{args:i(s.args)})})):l.map((function(a,o){var s=n(o);return tt(e,s),f[a]=e,m&&m.add(a,s,t),nt(p,s,a),(0,r.Z)((0,r.Z)({},s),{},{args:i(s.args)})}));return o.postMessage({op:"addBodies",type:t,uuid:l,props:g.map((function(e){var t=e.onCollide,n=(e.onCollideBegin,e.onCollideEnd,(0,s.Z)(e,I));return(0,r.Z)({onCollide:Boolean(t)},n)}))}),function(){l.forEach((function(e){delete f[e],m&&m.remove(e),delete p[e]})),o.postMessage({op:"removeBodies",uuid:l})}}),u);var v=(0,e.useMemo)((function(){var e=function(e,t){return{set:function(n,r,i){return $e(c,d,je("set",e),t,[n,r,i])},copy:function(n){var r=n.x,i=n.y,a=n.z;return $e(c,d,je("set",e),t,[r,i,a])},subscribe:et(c,d,A,e,t)}},t=function(e,t){return{set:function(n){return $e(c,d,je("set",e),t,n)},subscribe:et(c,d,A,e,t)}};function n(n){return{position:e("position",n),rotation:e("quaternion",n),velocity:e("velocity",n),angularVelocity:e("angularVelocity",n),linearFactor:e("linearFactor",n),angularFactor:e("angularFactor",n),mass:t("mass",n),linearDamping:t("linearDamping",n),angularDamping:t("angularDamping",n),allowSleep:t("allowSleep",n),sleepSpeedLimit:t("sleepSpeedLimit",n),sleepTimeLimit:t("sleepTimeLimit",n),collisionFilterGroup:t("collisionFilterGroup",n),collisionFilterMask:t("collisionFilterMask",n),collisionResponse:t("collisionResponse",n),fixedRotation:t("fixedRotation",n),userData:t("userData",n),isTrigger:t("isTrigger",n),applyForce:function(e,t){$e(c,d,"applyForce",n,[e,t])},applyImpulse:function(e,t){$e(c,d,"applyImpulse",n,[e,t])},applyLocalForce:function(e,t){$e(c,d,"applyLocalForce",n,[e,t])},applyLocalImpulse:function(e,t){$e(c,d,"applyLocalImpulse",n,[e,t])},applyTorque:function(e){$e(c,d,"applyTorque",n,[e])},wakeUp:function(){$e(c,d,"wakeUp",n)},sleep:function(){$e(c,d,"sleep",n)}}}var i={};return(0,r.Z)((0,r.Z)({},n(void 0)),{},{at:function(e){return i[e]||(i[e]=n(e))}})}),[]);return[c,v]}function at(t){return e.createElement(e.Suspense,{fallback:null},e.createElement(B,t))}var ot=n(5514),st=n(1539),ut=n(2556),lt=n(4580);function ct(e){var t,n,a=it("Plane",(function(){return(0,r.Z)({rotation:[-Math.PI/2,0,0],position:[0,-1,0]},e)}),(function(){return[]}),t,n),o=(0,i.Z)(a,1)[0];return(0,ut.jsxs)("mesh",{ref:o,receiveShadow:!0,castShadow:!0,children:[(0,ut.jsx)("planeBufferGeometry",{args:[3,3]}),(0,ut.jsx)("meshStandardMaterial",{color:"lightblue"})]})}function gt(){var t=function(e,t,n){var r=[1,1,1];return it("Box",e,(function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:r}),t,n)}((function(){return{mass:1,args:[.1,.1,.1],position:[Math.random()-.5,1*Math.random(),Math.random()-.5]}})),n=(0,i.Z)(t,2),r=n[0],s=n[1],u=(0,e.useMemo)((function(){for(var e=new Float32Array(150),t=new a.Color,n=0;n<50;n+=1)t.set(lt[8][Math.floor(5*Math.random())]).convertSRGBToLinear().toArray(e,3*n);return e}),[50]);return(0,o.useFrame)((function(){return s.at(Math.floor(50*Math.random())).position.set(0,2*Math.random(),0)})),(0,ut.jsxs)("instancedMesh",{receiveShadow:!0,castShadow:!0,ref:r,args:[null,null,50],children:[(0,ut.jsx)("boxBufferGeometry",{args:[.1,.1,.1],children:(0,ut.jsx)("instancedBufferAttribute",{attachObject:["attributes","color"],args:[u,3]})}),(0,ut.jsx)("meshLambertMaterial",{attach:"material",vertexColors:!0})]})}function dt(){var t,n,r=it("Sphere",(function(){return{mass:1,args:.1,position:[Math.random()-.5,1*Math.random(),Math.random()-.5]}}),(function(){return[arguments.length>0&&void 0!==arguments[0]?arguments[0]:1]}),t,n),s=(0,i.Z)(r,2),u=s[0],l=s[1],c=(0,e.useMemo)((function(){for(var e=new Float32Array(150),t=new a.Color,n=0;n<50;n+=1)t.set(lt[8][Math.floor(5*Math.random())]).convertSRGBToLinear().toArray(e,3*n);return e}),[50]);return(0,o.useFrame)((function(){return l.at(Math.floor(50*Math.random())).position.set(0,2*Math.random(),0)})),(0,ut.jsxs)("instancedMesh",{receiveShadow:!0,castShadow:!0,ref:u,args:[null,null,50],children:[(0,ut.jsx)("sphereBufferGeometry",{args:[.1,.1,.1],children:(0,ut.jsx)("instancedBufferAttribute",{attachObject:["attributes","color"],args:[c,3]})}),(0,ut.jsx)("meshLambertMaterial",{attach:"material",vertexColors:!0})]})}var It=function(){var t=(0,e.useState)(!0),n=(0,i.Z)(t,2),r=n[0],o=n[1];return(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(e.Suspense,{fallback:(0,ut.jsx)(st.V,{children:"Loading..."}),children:(0,ut.jsxs)(ot.ZapparCanvas,{shadows:!0,children:[(0,ut.jsx)(ot.ZapparCamera,{}),(0,ut.jsx)(ot.InstantTracker,{placementCameraOffset:new a.Vector3(0,0,-10),placementMode:r,children:(0,ut.jsxs)(at,{children:[(0,ut.jsx)(ct,{}),(0,ut.jsx)(gt,{}),(0,ut.jsx)(dt,{})]})}),(0,ut.jsx)("ambientLight",{intensity:.6}),(0,ut.jsx)("directionalLight",{position:[0,8,5],intensity:.5,castShadow:!0})]})}),(0,ut.jsxs)("div",{id:"zappar-button",role:"button",onKeyPress:function(){o((function(e){return!e}))},tabIndex:0,onClick:function(){o((function(e){return!e}))},children:["Tap here to",r?" place ":" pick up ","the object"]})]})},Ct=function(e){e&&e instanceof Function&&n.e(529).then(n.bind(n,4529)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),i(e),a(e),o(e)}))};t.render((0,ut.jsx)(e.StrictMode,{children:(0,ut.jsx)(It,{})}),document.getElementById("root")),Ct()}()}();
//# sourceMappingURL=main.a7980a40.js.map